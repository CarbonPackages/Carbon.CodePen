{
  "version": 3,
  "sources": ["../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/browser/outlineModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplaceCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/diffEditorBreadcrumbs/browser/contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/inspectTokens/inspectTokens.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/editor.main.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/_.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/css/css.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/html/html.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/ini/ini.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/javascript/javascript.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/less/less.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/markdown/markdown.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/php/php.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/scss/scss.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/typescript/typescript.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/xml/xml.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/basic-languages/yaml/yaml.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/language/css/monaco.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/language/html/monaco.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/language/json/monaco.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/browser/widget/diffEditor/diffEditor.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/anchorSelect/browser/anchorSelect.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/bracketMatching/browser/bracketMatching.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/caretOperations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/moveCaretCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/transpose.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/clipboard/browser/clipboard.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/copyPasteController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/common/dataTransfer.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/common/uuid.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/browser/dnd.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/dnd/browser/dnd.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetParser.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/edit.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineProgress/browser/inlineProgress.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/postEditWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/message/browser/messageController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionContributions.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionCommands.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeAction.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/common/types.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionKeybindingResolver.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionMenu.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/symbolIcons/browser/symbolIcons.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/lightBulbWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/actionWidget/browser/actionWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/actionWidget/browser/actionList.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelensController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelens.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codeLensCache.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelensWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorContributions.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorDetector.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/color.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/defaultDocumentColorProvider.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorHoverParticipant.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorPickerModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorPickerWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hover.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/peekView/browser/peekView.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/browser/widget/embeddedCodeEditorWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/zoneWidget/browser/zoneWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHover.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverOperation.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverTypes.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/browser/ui/resizable/resizable.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/resizableContentWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHover.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markdownHoverParticipant.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/getHover.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markerHoverParticipant.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/severityIcon/browser/severityIcon.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionsHintsWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/commandIds.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/standaloneColorPickerActions.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/standaloneColorPickerWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/comment.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/blockCommentCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/lineCommentCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/contextmenu/browser/contextmenu.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/browser/cursorUndo.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dnd/browser/dnd.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dnd/browser/dragAndDropCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/copyPasteContribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/defaultProviders.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/dropIntoEditorContribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/dropIntoEditorController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findDecorations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/replaceAllCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/common/search.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/replacePattern.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findOptionsWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findState.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/replaceInput.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/history/browser/contextScopedHistoryWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/history/browser/historyWidgetKeybindingHint.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/folding.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingRanges.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/hiddenRangeModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/indentRangeProvider.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingDecorations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/syntaxRangeProvider.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/browser/documentSymbols.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletions.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/commands.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionContextKeys.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionsController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostTextWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/ghostText.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/utils.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionsModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionsSource.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/provideInlineCompletions.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/common/model/bracketPairsTextModelPart/fixBrackets.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/singleTextEdit.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetController2.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggest.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetSession.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/common/labels.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetVariables.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/suggestWidgetInlineCompletionProvider.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestMemory.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordContextKey.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestAlternatives.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestCommitCharacters.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordDistance.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/bracketSelections.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/completionModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestOvertypingCapturer.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetStatus.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetDetails.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetRenderer.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/files/common/files.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/hoverParticipant.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentation.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentUtils.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsContribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHints.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsHover.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/editor.all.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/lineSelection/browser/lineSelection.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/linesOperations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/common/commands/trimTrailingWhitespaceCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/copyLinesCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/moveLinesCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/sortLinesCommand.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/linkedEditing/browser/linkedEditing.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/links/browser/links.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/links/browser/getLinks.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/longLinesHelper/browser/longLinesHelper.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/browser/multicursor.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/highlightDecorations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEdit.contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/commands.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/commandIds.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEditController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/ghostTextWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEditHintsWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/hoverParticipant.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHints.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHintsModel.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/provideSignatureHelp.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHintsWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/rename.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/renameInputField.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/documentSemanticTokens.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/getSemanticTokens.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/semanticTokensConfig.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/viewportSemanticTokens.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/smartSelect.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/wordSelections.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollContribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollActions.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/action/common/actionCommonCategories.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollProvider.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollModelProvider.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollElement.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestInlineCompletions.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/tokenization/browser/tokenization.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/toggleTabFocusMode/browser/toggleTabFocusMode.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/unicodeHighlighter/browser/unicodeHighlighter.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/unicodeHighlighter/browser/bannerController.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/opener/browser/link.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/unusualLineTerminators/browser/unusualLineTerminators.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/wordHighlighter.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/wordOperations/browser/wordOperations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/wordPartOperations/browser/wordPartOperations.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/readOnlyMessage/browser/contribution.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/iPadShowKeyboard/iPadShowKeyboard.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/edcore.main.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneHelpQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/quickinput/browser/helpQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/editorNavigationQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneGotoLineQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/common/fuzzyScorer.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneGotoSymbolQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneCommandsQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/commandsQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/common/errorMessage.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/quickinput/browser/commandsQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/base/common/tfIdf.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/platform/quickinput/browser/pickerQuickAccess.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/referenceSearch/standaloneReferenceSearch.js", "../../Private/Plugin/node_modules/.pnpm/monaco-editor@0.47.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/toggleHighContrast/toggleHighContrast.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/monaco.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/markerSeverity.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/markerTag.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/range.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/relatedInformation.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/markerData.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/command.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/color.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/colorInformation.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/completionTriggerKind.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/completionContext.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/completionItemKind.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/completionItemTag.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/markdownString.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/singleEditOperation.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/completionItem.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/completionList.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/hover.js", "../../Private/Plugin/node_modules/.pnpm/monaco-languageserver-types@0.2.3/node_modules/monaco-languageserver-types/lib/position.js", "../../Private/Plugin/node_modules/.pnpm/monaco-marker-data-provider@1.1.1_monaco-editor@0.47.0/node_modules/monaco-marker-data-provider/index.js", "../../Private/Plugin/node_modules/.pnpm/monaco-worker-manager@2.0.1_monaco-editor@0.47.0/node_modules/monaco-worker-manager/index.js", "../../Private/Plugin/node_modules/.pnpm/@ctrl+tinycolor@3.6.1/node_modules/@ctrl/tinycolor/dist/module/util.js", "../../Private/Plugin/node_modules/.pnpm/@ctrl+tinycolor@3.6.1/node_modules/@ctrl/tinycolor/dist/module/conversion.js", "../../Private/Plugin/node_modules/.pnpm/@ctrl+tinycolor@3.6.1/node_modules/@ctrl/tinycolor/dist/module/css-color-names.js", "../../Private/Plugin/node_modules/.pnpm/@ctrl+tinycolor@3.6.1/node_modules/@ctrl/tinycolor/dist/module/format-input.js", "../../Private/Plugin/node_modules/.pnpm/@ctrl+tinycolor@3.6.1/node_modules/@ctrl/tinycolor/dist/module/index.js", "../../Private/Plugin/node_modules/.pnpm/@ctrl+tinycolor@3.6.1/node_modules/@ctrl/tinycolor/dist/module/from-ratio.js", "../../Private/Plugin/node_modules/.pnpm/monaco-tailwindcss@0.6.0_monaco-editor@0.47.0/node_modules/monaco-tailwindcss/src/index.ts", "../../Private/Plugin/node_modules/.pnpm/monaco-tailwindcss@0.6.0_monaco-editor@0.47.0/node_modules/monaco-tailwindcss/src/languageFeatures.ts", "../../Private/Plugin/node_modules/.pnpm/monaco-tailwindcss@0.6.0_monaco-editor@0.47.0/node_modules/monaco-tailwindcss/src/cssData.ts", "../../Private/Plugin/node_modules/.pnpm/emmet-monaco-es@5.3.2_monaco-editor@0.47.0/node_modules/emmet-monaco-es/dist/emmet-monaco.esm.js", "../../Private/Plugin/src/services/registerDocumentationForFusionObjects.ts", "../../Private/Plugin/node_modules/.pnpm/emmet-monaco-es@5.3.2_monaco-editor@0.47.0/node_modules/emmet-monaco-es/src/abbreviationActions.ts", "../../Private/Plugin/src/services/registerCompletionForFusionObjects.ts", "../../Private/Plugin/src/services/initializeMonaco.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { equals } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class TreeElement {\n    remove() {\n        var _a;\n        (_a = this.parent) === null || _a === void 0 ? void 0 : _a.children.delete(this.id);\n    }\n    static findId(candidate, container) {\n        // complex id-computation which contains the origin/extension,\n        // the parent path, and some dedupe logic when names collide\n        let candidateId;\n        if (typeof candidate === 'string') {\n            candidateId = `${container.id}/${candidate}`;\n        }\n        else {\n            candidateId = `${container.id}/${candidate.name}`;\n            if (container.children.get(candidateId) !== undefined) {\n                candidateId = `${container.id}/${candidate.name}_${candidate.range.startLineNumber}_${candidate.range.startColumn}`;\n            }\n        }\n        let id = candidateId;\n        for (let i = 0; container.children.get(id) !== undefined; i++) {\n            id = `${candidateId}_${i}`;\n        }\n        return id;\n    }\n    static empty(element) {\n        return element.children.size === 0;\n    }\n}\nexport class OutlineElement extends TreeElement {\n    constructor(id, parent, symbol) {\n        super();\n        this.id = id;\n        this.parent = parent;\n        this.symbol = symbol;\n        this.children = new Map();\n    }\n}\nexport class OutlineGroup extends TreeElement {\n    constructor(id, parent, label, order) {\n        super();\n        this.id = id;\n        this.parent = parent;\n        this.label = label;\n        this.order = order;\n        this.children = new Map();\n    }\n}\nexport class OutlineModel extends TreeElement {\n    static create(registry, textModel, token) {\n        const cts = new CancellationTokenSource(token);\n        const result = new OutlineModel(textModel.uri);\n        const provider = registry.ordered(textModel);\n        const promises = provider.map((provider, index) => {\n            var _a;\n            const id = TreeElement.findId(`provider_${index}`, result);\n            const group = new OutlineGroup(id, result, (_a = provider.displayName) !== null && _a !== void 0 ? _a : 'Unknown Outline Provider', index);\n            return Promise.resolve(provider.provideDocumentSymbols(textModel, cts.token)).then(result => {\n                for (const info of result || []) {\n                    OutlineModel._makeOutlineElement(info, group);\n                }\n                return group;\n            }, err => {\n                onUnexpectedExternalError(err);\n                return group;\n            }).then(group => {\n                if (!TreeElement.empty(group)) {\n                    result._groups.set(id, group);\n                }\n                else {\n                    group.remove();\n                }\n            });\n        });\n        const listener = registry.onDidChange(() => {\n            const newProvider = registry.ordered(textModel);\n            if (!equals(newProvider, provider)) {\n                cts.cancel();\n            }\n        });\n        return Promise.all(promises).then(() => {\n            if (cts.token.isCancellationRequested && !token.isCancellationRequested) {\n                return OutlineModel.create(registry, textModel, token);\n            }\n            else {\n                return result._compact();\n            }\n        }).finally(() => {\n            cts.dispose();\n            listener.dispose();\n            cts.dispose();\n        });\n    }\n    static _makeOutlineElement(info, container) {\n        const id = TreeElement.findId(info, container);\n        const res = new OutlineElement(id, container, info);\n        if (info.children) {\n            for (const childInfo of info.children) {\n                OutlineModel._makeOutlineElement(childInfo, res);\n            }\n        }\n        container.children.set(res.id, res);\n    }\n    constructor(uri) {\n        super();\n        this.uri = uri;\n        this.id = 'root';\n        this.parent = undefined;\n        this._groups = new Map();\n        this.children = new Map();\n        this.id = 'root';\n        this.parent = undefined;\n    }\n    _compact() {\n        let count = 0;\n        for (const [key, group] of this._groups) {\n            if (group.children.size === 0) { // empty\n                this._groups.delete(key);\n            }\n            else {\n                count += 1;\n            }\n        }\n        if (count !== 1) {\n            //\n            this.children = this._groups;\n        }\n        else {\n            // adopt all elements of the first group\n            const group = Iterable.first(this._groups.values());\n            for (const [, child] of group.children) {\n                child.parent = this;\n                this.children.set(child.id, child);\n            }\n        }\n        return this;\n    }\n    getTopLevelSymbols() {\n        const roots = [];\n        for (const child of this.children.values()) {\n            if (child instanceof OutlineElement) {\n                roots.push(child.symbol);\n            }\n            else {\n                roots.push(...Iterable.map(child.children.values(), child => child.symbol));\n            }\n        }\n        return roots.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n    }\n    asListOfDocumentSymbols() {\n        const roots = this.getTopLevelSymbols();\n        const bucket = [];\n        OutlineModel._flattenDocumentSymbols(bucket, roots, '');\n        return bucket.sort((a, b) => Position.compare(Range.getStartPosition(a.range), Range.getStartPosition(b.range)) || Position.compare(Range.getEndPosition(b.range), Range.getEndPosition(a.range)));\n    }\n    static _flattenDocumentSymbols(bucket, entries, overrideContainerLabel) {\n        for (const entry of entries) {\n            bucket.push({\n                kind: entry.kind,\n                tags: entry.tags,\n                name: entry.name,\n                detail: entry.detail,\n                containerName: entry.containerName || overrideContainerLabel,\n                range: entry.range,\n                selectionRange: entry.selectionRange,\n                children: undefined, // we flatten it...\n            });\n            // Recurse over children\n            if (entry.children) {\n                OutlineModel._flattenDocumentSymbols(bucket, entry.children, entry.name);\n            }\n        }\n    }\n}\nexport const IOutlineModelService = createDecorator('IOutlineModelService');\nlet OutlineModelService = class OutlineModelService {\n    constructor(_languageFeaturesService, debounces, modelService) {\n        this._languageFeaturesService = _languageFeaturesService;\n        this._disposables = new DisposableStore();\n        this._cache = new LRUCache(10, 0.7);\n        this._debounceInformation = debounces.for(_languageFeaturesService.documentSymbolProvider, 'DocumentSymbols', { min: 350 });\n        // don't cache outline models longer than their text model\n        this._disposables.add(modelService.onModelRemoved(textModel => {\n            this._cache.delete(textModel.id);\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    async getOrCreate(textModel, token) {\n        const registry = this._languageFeaturesService.documentSymbolProvider;\n        const provider = registry.ordered(textModel);\n        let data = this._cache.get(textModel.id);\n        if (!data || data.versionId !== textModel.getVersionId() || !equals(data.provider, provider)) {\n            const source = new CancellationTokenSource();\n            data = {\n                versionId: textModel.getVersionId(),\n                provider,\n                promiseCnt: 0,\n                source,\n                promise: OutlineModel.create(registry, textModel, source.token),\n                model: undefined,\n            };\n            this._cache.set(textModel.id, data);\n            const now = Date.now();\n            data.promise.then(outlineModel => {\n                data.model = outlineModel;\n                this._debounceInformation.update(textModel, Date.now() - now);\n            }).catch(_err => {\n                this._cache.delete(textModel.id);\n            });\n        }\n        if (data.model) {\n            // resolved -> return data\n            return data.model;\n        }\n        // increase usage counter\n        data.promiseCnt += 1;\n        const listener = token.onCancellationRequested(() => {\n            // last -> cancel provider request, remove cached promise\n            if (--data.promiseCnt === 0) {\n                data.source.cancel();\n                this._cache.delete(textModel.id);\n            }\n        });\n        try {\n            return await data.promise;\n        }\n        finally {\n            listener.dispose();\n        }\n    }\n};\nOutlineModelService = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, ILanguageFeatureDebounceService),\n    __param(2, IModelService)\n], OutlineModelService);\nexport { OutlineModelService };\nregisterSingleton(IOutlineModelService, OutlineModelService, 1 /* InstantiationType.Delayed */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Selection } from '../../../common/core/selection.js';\nexport class InPlaceReplaceCommand {\n    constructor(editRange, originalSelection, text) {\n        this._editRange = editRange;\n        this._originalSelection = originalSelection;\n        this._text = text;\n    }\n    getEditOperations(model, builder) {\n        builder.addTrackedEditOperation(this._editRange, this._text);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        const srcRange = inverseEditOperations[0].range;\n        if (!this._originalSelection.isEmpty()) {\n            // Preserve selection and extends to typed text\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\n        }\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InPlaceReplaceController_1;\nimport { createCancelablePromise, timeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { EditorState } from '../../editorState/browser/editorState.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport * as nls from '../../../../nls.js';\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\nimport './inPlaceReplace.css';\nlet InPlaceReplaceController = InPlaceReplaceController_1 = class InPlaceReplaceController {\n    static get(editor) {\n        return editor.getContribution(InPlaceReplaceController_1.ID);\n    }\n    constructor(editor, editorWorkerService) {\n        this.editor = editor;\n        this.editorWorkerService = editorWorkerService;\n        this.decorations = this.editor.createDecorationsCollection();\n    }\n    dispose() {\n    }\n    run(source, up) {\n        var _a;\n        // cancel any pending request\n        (_a = this.currentRequest) === null || _a === void 0 ? void 0 : _a.cancel();\n        const editorSelection = this.editor.getSelection();\n        const model = this.editor.getModel();\n        if (!model || !editorSelection) {\n            return undefined;\n        }\n        let selection = editorSelection;\n        if (selection.startLineNumber !== selection.endLineNumber) {\n            // Can't accept multiline selection\n            return undefined;\n        }\n        const state = new EditorState(this.editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const modelURI = model.uri;\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\n            return Promise.resolve(undefined);\n        }\n        this.currentRequest = createCancelablePromise(token => this.editorWorkerService.navigateValueSet(modelURI, selection, up));\n        return this.currentRequest.then(result => {\n            var _a;\n            if (!result || !result.range || !result.value) {\n                // No proper result\n                return;\n            }\n            if (!state.validate(this.editor)) {\n                // state has changed\n                return;\n            }\n            // Selection\n            const editRange = Range.lift(result.range);\n            let highlightRange = result.range;\n            const diff = result.value.length - (selection.endColumn - selection.startColumn);\n            // highlight\n            highlightRange = {\n                startLineNumber: highlightRange.startLineNumber,\n                startColumn: highlightRange.startColumn,\n                endLineNumber: highlightRange.endLineNumber,\n                endColumn: highlightRange.startColumn + result.value.length\n            };\n            if (diff > 1) {\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\n            }\n            // Insert new text\n            const command = new InPlaceReplaceCommand(editRange, selection, result.value);\n            this.editor.pushUndoStop();\n            this.editor.executeCommand(source, command);\n            this.editor.pushUndoStop();\n            // add decoration\n            this.decorations.set([{\n                    range: highlightRange,\n                    options: InPlaceReplaceController_1.DECORATION\n                }]);\n            // remove decoration after delay\n            (_a = this.decorationRemover) === null || _a === void 0 ? void 0 : _a.cancel();\n            this.decorationRemover = timeout(350);\n            this.decorationRemover.then(() => this.decorations.clear()).catch(onUnexpectedError);\n        }).catch(onUnexpectedError);\n    }\n};\nInPlaceReplaceController.ID = 'editor.contrib.inPlaceReplaceController';\nInPlaceReplaceController.DECORATION = ModelDecorationOptions.register({\n    description: 'in-place-replace',\n    className: 'valueSetReplacement'\n});\nInPlaceReplaceController = InPlaceReplaceController_1 = __decorate([\n    __param(1, IEditorWorkerService)\n], InPlaceReplaceController);\nclass InPlaceReplaceUp extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.up',\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\n            alias: 'Replace with Previous Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 87 /* KeyCode.Comma */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, false);\n    }\n}\nclass InPlaceReplaceDown extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.down',\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\n            alias: 'Replace with Next Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 89 /* KeyCode.Period */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, true);\n    }\n}\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(InPlaceReplaceUp);\nregisterEditorAction(InPlaceReplaceDown);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { reverseOrder, compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { observableValue, observableSignalFromEvent, autorunWithStore } from '../../../../base/common/observable.js';\nimport { HideUnchangedRegionsFeature } from '../../../browser/widget/diffEditor/features/hideUnchangedRegionsFeature.js';\nimport { DisposableCancellationTokenSource } from '../../../browser/widget/diffEditor/utils.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IOutlineModelService } from '../../documentSymbols/browser/outlineModel.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Event } from '../../../../base/common/event.js';\nlet DiffEditorBreadcrumbsSource = class DiffEditorBreadcrumbsSource extends Disposable {\n    constructor(_textModel, _languageFeaturesService, _outlineModelService) {\n        super();\n        this._textModel = _textModel;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._outlineModelService = _outlineModelService;\n        this._currentModel = observableValue(this, undefined);\n        const documentSymbolProviderChanged = observableSignalFromEvent('documentSymbolProvider.onDidChange', this._languageFeaturesService.documentSymbolProvider.onDidChange);\n        const textModelChanged = observableSignalFromEvent('_textModel.onDidChangeContent', Event.debounce(e => this._textModel.onDidChangeContent(e), () => undefined, 100));\n        this._register(autorunWithStore(async (reader, store) => {\n            documentSymbolProviderChanged.read(reader);\n            textModelChanged.read(reader);\n            const src = store.add(new DisposableCancellationTokenSource());\n            const model = await this._outlineModelService.getOrCreate(this._textModel, src.token);\n            if (store.isDisposed) {\n                return;\n            }\n            this._currentModel.set(model, undefined);\n        }));\n    }\n    getBreadcrumbItems(startRange, reader) {\n        const m = this._currentModel.read(reader);\n        if (!m) {\n            return [];\n        }\n        const symbols = m.asListOfDocumentSymbols()\n            .filter(s => startRange.contains(s.range.startLineNumber) && !startRange.contains(s.range.endLineNumber));\n        symbols.sort(reverseOrder(compareBy(s => s.range.endLineNumber - s.range.startLineNumber, numberComparator)));\n        return symbols.map(s => ({ name: s.name, kind: s.kind, startLineNumber: s.range.startLineNumber }));\n    }\n};\nDiffEditorBreadcrumbsSource = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IOutlineModelService)\n], DiffEditorBreadcrumbsSource);\nHideUnchangedRegionsFeature.setBreadcrumbsSourceFactory((textModel, instantiationService) => {\n    return instantiationService.createInstance(DiffEditorBreadcrumbsSource, textModel);\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InspectTokensController_1;\nimport './inspectTokens.css';\nimport { $, append, reset } from '../../../../base/browser/dom.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { TokenMetadata } from '../../../common/encodedTokenAttributes.js';\nimport { NullState, nullTokenize, nullTokenizeEncoded } from '../../../common/languages/nullTokenize.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { IStandaloneThemeService } from '../../common/standaloneTheme.js';\nimport { InspectTokensNLS } from '../../../common/standaloneStrings.js';\nlet InspectTokensController = InspectTokensController_1 = class InspectTokensController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(InspectTokensController_1.ID);\n    }\n    constructor(editor, standaloneColorService, languageService) {\n        super();\n        this._editor = editor;\n        this._languageService = languageService;\n        this._widget = null;\n        this._register(this._editor.onDidChangeModel((e) => this.stop()));\n        this._register(this._editor.onDidChangeModelLanguage((e) => this.stop()));\n        this._register(TokenizationRegistry.onDidChange((e) => this.stop()));\n        this._register(this._editor.onKeyUp((e) => e.keyCode === 9 /* KeyCode.Escape */ && this.stop()));\n    }\n    dispose() {\n        this.stop();\n        super.dispose();\n    }\n    launch() {\n        if (this._widget) {\n            return;\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._widget = new InspectTokensWidget(this._editor, this._languageService);\n    }\n    stop() {\n        if (this._widget) {\n            this._widget.dispose();\n            this._widget = null;\n        }\n    }\n};\nInspectTokensController.ID = 'editor.contrib.inspectTokens';\nInspectTokensController = InspectTokensController_1 = __decorate([\n    __param(1, IStandaloneThemeService),\n    __param(2, ILanguageService)\n], InspectTokensController);\nclass InspectTokens extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inspectTokens',\n            label: InspectTokensNLS.inspectTokensAction,\n            alias: 'Developer: Inspect Tokens',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const controller = InspectTokensController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.launch();\n    }\n}\nfunction renderTokenText(tokenText) {\n    let result = '';\n    for (let charIndex = 0, len = tokenText.length; charIndex < len; charIndex++) {\n        const charCode = tokenText.charCodeAt(charIndex);\n        switch (charCode) {\n            case 9 /* CharCode.Tab */:\n                result += '\\u2192'; // &rarr;\n                break;\n            case 32 /* CharCode.Space */:\n                result += '\\u00B7'; // &middot;\n                break;\n            default:\n                result += String.fromCharCode(charCode);\n        }\n    }\n    return result;\n}\nfunction getSafeTokenizationSupport(languageIdCodec, languageId) {\n    const tokenizationSupport = TokenizationRegistry.get(languageId);\n    if (tokenizationSupport) {\n        return tokenizationSupport;\n    }\n    const encodedLanguageId = languageIdCodec.encodeLanguageId(languageId);\n    return {\n        getInitialState: () => NullState,\n        tokenize: (line, hasEOL, state) => nullTokenize(languageId, state),\n        tokenizeEncoded: (line, hasEOL, state) => nullTokenizeEncoded(encodedLanguageId, state)\n    };\n}\nclass InspectTokensWidget extends Disposable {\n    constructor(editor, languageService) {\n        super();\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this._editor = editor;\n        this._languageService = languageService;\n        this._model = this._editor.getModel();\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'tokens-inspect-widget';\n        this._tokenizationSupport = getSafeTokenizationSupport(this._languageService.languageIdCodec, this._model.getLanguageId());\n        this._compute(this._editor.getPosition());\n        this._register(this._editor.onDidChangeCursorPosition((e) => this._compute(this._editor.getPosition())));\n        this._editor.addContentWidget(this);\n    }\n    dispose() {\n        this._editor.removeContentWidget(this);\n        super.dispose();\n    }\n    getId() {\n        return InspectTokensWidget._ID;\n    }\n    _compute(position) {\n        const data = this._getTokensAtLine(position.lineNumber);\n        let token1Index = 0;\n        for (let i = data.tokens1.length - 1; i >= 0; i--) {\n            const t = data.tokens1[i];\n            if (position.column - 1 >= t.offset) {\n                token1Index = i;\n                break;\n            }\n        }\n        let token2Index = 0;\n        for (let i = (data.tokens2.length >>> 1); i >= 0; i--) {\n            if (position.column - 1 >= data.tokens2[(i << 1)]) {\n                token2Index = i;\n                break;\n            }\n        }\n        const lineContent = this._model.getLineContent(position.lineNumber);\n        let tokenText = '';\n        if (token1Index < data.tokens1.length) {\n            const tokenStartIndex = data.tokens1[token1Index].offset;\n            const tokenEndIndex = token1Index + 1 < data.tokens1.length ? data.tokens1[token1Index + 1].offset : lineContent.length;\n            tokenText = lineContent.substring(tokenStartIndex, tokenEndIndex);\n        }\n        reset(this._domNode, $('h2.tm-token', undefined, renderTokenText(tokenText), $('span.tm-token-length', undefined, `${tokenText.length} ${tokenText.length === 1 ? 'char' : 'chars'}`)));\n        append(this._domNode, $('hr.tokens-inspect-separator', { 'style': 'clear:both' }));\n        const metadata = (token2Index << 1) + 1 < data.tokens2.length ? this._decodeMetadata(data.tokens2[(token2Index << 1) + 1]) : null;\n        append(this._domNode, $('table.tm-metadata-table', undefined, $('tbody', undefined, $('tr', undefined, $('td.tm-metadata-key', undefined, 'language'), $('td.tm-metadata-value', undefined, `${metadata ? metadata.languageId : '-?-'}`)), $('tr', undefined, $('td.tm-metadata-key', undefined, 'token type'), $('td.tm-metadata-value', undefined, `${metadata ? this._tokenTypeToString(metadata.tokenType) : '-?-'}`)), $('tr', undefined, $('td.tm-metadata-key', undefined, 'font style'), $('td.tm-metadata-value', undefined, `${metadata ? this._fontStyleToString(metadata.fontStyle) : '-?-'}`)), $('tr', undefined, $('td.tm-metadata-key', undefined, 'foreground'), $('td.tm-metadata-value', undefined, `${metadata ? Color.Format.CSS.formatHex(metadata.foreground) : '-?-'}`)), $('tr', undefined, $('td.tm-metadata-key', undefined, 'background'), $('td.tm-metadata-value', undefined, `${metadata ? Color.Format.CSS.formatHex(metadata.background) : '-?-'}`)))));\n        append(this._domNode, $('hr.tokens-inspect-separator'));\n        if (token1Index < data.tokens1.length) {\n            append(this._domNode, $('span.tm-token-type', undefined, data.tokens1[token1Index].type));\n        }\n        this._editor.layoutContentWidget(this);\n    }\n    _decodeMetadata(metadata) {\n        const colorMap = TokenizationRegistry.getColorMap();\n        const languageId = TokenMetadata.getLanguageId(metadata);\n        const tokenType = TokenMetadata.getTokenType(metadata);\n        const fontStyle = TokenMetadata.getFontStyle(metadata);\n        const foreground = TokenMetadata.getForeground(metadata);\n        const background = TokenMetadata.getBackground(metadata);\n        return {\n            languageId: this._languageService.languageIdCodec.decodeLanguageId(languageId),\n            tokenType: tokenType,\n            fontStyle: fontStyle,\n            foreground: colorMap[foreground],\n            background: colorMap[background]\n        };\n    }\n    _tokenTypeToString(tokenType) {\n        switch (tokenType) {\n            case 0 /* StandardTokenType.Other */: return 'Other';\n            case 1 /* StandardTokenType.Comment */: return 'Comment';\n            case 2 /* StandardTokenType.String */: return 'String';\n            case 3 /* StandardTokenType.RegEx */: return 'RegEx';\n            default: return '??';\n        }\n    }\n    _fontStyleToString(fontStyle) {\n        let r = '';\n        if (fontStyle & 1 /* FontStyle.Italic */) {\n            r += 'italic ';\n        }\n        if (fontStyle & 2 /* FontStyle.Bold */) {\n            r += 'bold ';\n        }\n        if (fontStyle & 4 /* FontStyle.Underline */) {\n            r += 'underline ';\n        }\n        if (fontStyle & 8 /* FontStyle.Strikethrough */) {\n            r += 'strikethrough ';\n        }\n        if (r.length === 0) {\n            r = '---';\n        }\n        return r;\n    }\n    _getTokensAtLine(lineNumber) {\n        const stateBeforeLine = this._getStateBeforeLine(lineNumber);\n        const tokenizationResult1 = this._tokenizationSupport.tokenize(this._model.getLineContent(lineNumber), true, stateBeforeLine);\n        const tokenizationResult2 = this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(lineNumber), true, stateBeforeLine);\n        return {\n            startState: stateBeforeLine,\n            tokens1: tokenizationResult1.tokens,\n            tokens2: tokenizationResult2.tokens,\n            endState: tokenizationResult1.endState\n        };\n    }\n    _getStateBeforeLine(lineNumber) {\n        let state = this._tokenizationSupport.getInitialState();\n        for (let i = 1; i < lineNumber; i++) {\n            const tokenizationResult = this._tokenizationSupport.tokenize(this._model.getLineContent(i), true, state);\n            state = tokenizationResult.endState;\n        }\n        return state;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            position: this._editor.getPosition(),\n            preference: [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n}\nInspectTokensWidget._ID = 'editor.contrib.inspectTokensWidget';\nregisterEditorContribution(InspectTokensController.ID, InspectTokensController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(InspectTokens);\n", "import '../basic-languages/monaco.contribution';\nimport '../language/css/monaco.contribution';\nimport '../language/html/monaco.contribution';\nimport '../language/json/monaco.contribution';\nimport '../language/typescript/monaco.contribution';\n\nexport * from './edcore.main';", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __reExport = (target, mod, secondTarget) => (__copyProps(target, mod, \"default\"), secondTarget && __copyProps(secondTarget, mod, \"default\"));\n\n// src/fillers/monaco-editor-core.ts\nvar monaco_editor_core_exports = {};\n__reExport(monaco_editor_core_exports, monaco_editor_core_star);\nimport * as monaco_editor_core_star from \"../editor/editor.api.js\";\n\n// src/basic-languages/_.contribution.ts\nvar languageDefinitions = {};\nvar lazyLanguageLoaders = {};\nvar LazyLanguageLoader = class _LazyLanguageLoader {\n  static getOrCreate(languageId) {\n    if (!lazyLanguageLoaders[languageId]) {\n      lazyLanguageLoaders[languageId] = new _LazyLanguageLoader(languageId);\n    }\n    return lazyLanguageLoaders[languageId];\n  }\n  constructor(languageId) {\n    this._languageId = languageId;\n    this._loadingTriggered = false;\n    this._lazyLoadPromise = new Promise((resolve, reject) => {\n      this._lazyLoadPromiseResolve = resolve;\n      this._lazyLoadPromiseReject = reject;\n    });\n  }\n  load() {\n    if (!this._loadingTriggered) {\n      this._loadingTriggered = true;\n      languageDefinitions[this._languageId].loader().then(\n        (mod) => this._lazyLoadPromiseResolve(mod),\n        (err) => this._lazyLoadPromiseReject(err)\n      );\n    }\n    return this._lazyLoadPromise;\n  }\n};\nasync function loadLanguage(languageId) {\n  await LazyLanguageLoader.getOrCreate(languageId).load();\n  const model = monaco_editor_core_exports.editor.createModel(\"\", languageId);\n  model.dispose();\n}\nfunction registerLanguage(def) {\n  const languageId = def.id;\n  languageDefinitions[languageId] = def;\n  monaco_editor_core_exports.languages.register(def);\n  const lazyLanguageLoader = LazyLanguageLoader.getOrCreate(languageId);\n  monaco_editor_core_exports.languages.registerTokensProviderFactory(languageId, {\n    create: async () => {\n      const mod = await lazyLanguageLoader.load();\n      return mod.language;\n    }\n  });\n  monaco_editor_core_exports.languages.onLanguageEncountered(languageId, async () => {\n    const mod = await lazyLanguageLoader.load();\n    monaco_editor_core_exports.languages.setLanguageConfiguration(languageId, mod.conf);\n  });\n}\nexport {\n  loadLanguage,\n  registerLanguage\n};\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/css/css.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"css\",\n  extensions: [\".css\"],\n  aliases: [\"CSS\", \"css\"],\n  mimetypes: [\"text/css\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/css/css\"], resolve, reject);\n      });\n    } else {\n      return import(\"./css.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/html/html.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"html\",\n  extensions: [\".html\", \".htm\", \".shtml\", \".xhtml\", \".mdoc\", \".jsp\", \".asp\", \".aspx\", \".jshtm\"],\n  aliases: [\"HTML\", \"htm\", \"html\", \"xhtml\"],\n  mimetypes: [\"text/html\", \"text/x-jshtm\", \"text/template\", \"text/ng-template\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/html/html\"], resolve, reject);\n      });\n    } else {\n      return import(\"./html.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/ini/ini.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"ini\",\n  extensions: [\".ini\", \".properties\", \".gitconfig\"],\n  filenames: [\"config\", \".gitattributes\", \".gitconfig\", \".editorconfig\"],\n  aliases: [\"Ini\", \"ini\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/ini/ini\"], resolve, reject);\n      });\n    } else {\n      return import(\"./ini.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/javascript/javascript.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"javascript\",\n  extensions: [\".js\", \".es6\", \".jsx\", \".mjs\", \".cjs\"],\n  firstLine: \"^#!.*\\\\bnode\",\n  filenames: [\"jakefile\"],\n  aliases: [\"JavaScript\", \"javascript\", \"js\"],\n  mimetypes: [\"text/javascript\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/javascript/javascript\"], resolve, reject);\n      });\n    } else {\n      return import(\"./javascript.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/less/less.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"less\",\n  extensions: [\".less\"],\n  aliases: [\"Less\", \"less\"],\n  mimetypes: [\"text/x-less\", \"text/less\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/less/less\"], resolve, reject);\n      });\n    } else {\n      return import(\"./less.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/markdown/markdown.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"markdown\",\n  extensions: [\".md\", \".markdown\", \".mdown\", \".mkdn\", \".mkd\", \".mdwn\", \".mdtxt\", \".mdtext\"],\n  aliases: [\"Markdown\", \"markdown\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/markdown/markdown\"], resolve, reject);\n      });\n    } else {\n      return import(\"./markdown.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/php/php.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"php\",\n  extensions: [\".php\", \".php4\", \".php5\", \".phtml\", \".ctp\"],\n  aliases: [\"PHP\", \"php\"],\n  mimetypes: [\"application/x-php\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/php/php\"], resolve, reject);\n      });\n    } else {\n      return import(\"./php.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/scss/scss.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"scss\",\n  extensions: [\".scss\"],\n  aliases: [\"Sass\", \"sass\", \"scss\"],\n  mimetypes: [\"text/x-scss\", \"text/scss\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/scss/scss\"], resolve, reject);\n      });\n    } else {\n      return import(\"./scss.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/typescript/typescript.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"typescript\",\n  extensions: [\".ts\", \".tsx\", \".cts\", \".mts\"],\n  aliases: [\"TypeScript\", \"ts\", \"typescript\"],\n  mimetypes: [\"text/typescript\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/typescript/typescript\"], resolve, reject);\n      });\n    } else {\n      return import(\"./typescript.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/xml/xml.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"xml\",\n  extensions: [\n    \".xml\",\n    \".xsd\",\n    \".dtd\",\n    \".ascx\",\n    \".csproj\",\n    \".config\",\n    \".props\",\n    \".targets\",\n    \".wxi\",\n    \".wxl\",\n    \".wxs\",\n    \".xaml\",\n    \".svg\",\n    \".svgz\",\n    \".opf\",\n    \".xslt\",\n    \".xsl\"\n  ],\n  firstLine: \"(\\\\<\\\\?xml.*)|(\\\\<svg)|(\\\\<\\\\!doctype\\\\s+svg)\",\n  aliases: [\"XML\", \"xml\"],\n  mimetypes: [\"text/xml\", \"application/xml\", \"application/xaml+xml\", \"application/xml-dtd\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/xml/xml\"], resolve, reject);\n      });\n    } else {\n      return import(\"./xml.js\");\n    }\n  }\n});\n", "/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/basic-languages/yaml/yaml.contribution.ts\nimport { registerLanguage } from \"../_.contribution.js\";\nregisterLanguage({\n  id: \"yaml\",\n  extensions: [\".yaml\", \".yml\"],\n  aliases: [\"YAML\", \"yaml\", \"YML\", \"yml\"],\n  mimetypes: [\"application/x-yaml\", \"text/x-yaml\"],\n  loader: () => {\n    if (false) {\n      return new Promise((resolve, reject) => {\n        __require([\"vs/basic-languages/yaml/yaml\"], resolve, reject);\n      });\n    } else {\n      return import(\"./yaml.js\");\n    }\n  }\n});\n", "import '../../editor/editor.api.js';\n/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __reExport = (target, mod, secondTarget) => (__copyProps(target, mod, \"default\"), secondTarget && __copyProps(secondTarget, mod, \"default\"));\n\n// src/fillers/monaco-editor-core.ts\nvar monaco_editor_core_exports = {};\n__reExport(monaco_editor_core_exports, monaco_editor_core_star);\nimport * as monaco_editor_core_star from \"../../editor/editor.api.js\";\n\n// src/language/css/monaco.contribution.ts\nvar LanguageServiceDefaultsImpl = class {\n  constructor(languageId, options, modeConfiguration) {\n    this._onDidChange = new monaco_editor_core_exports.Emitter();\n    this._languageId = languageId;\n    this.setOptions(options);\n    this.setModeConfiguration(modeConfiguration);\n  }\n  get onDidChange() {\n    return this._onDidChange.event;\n  }\n  get languageId() {\n    return this._languageId;\n  }\n  get modeConfiguration() {\n    return this._modeConfiguration;\n  }\n  get diagnosticsOptions() {\n    return this.options;\n  }\n  get options() {\n    return this._options;\n  }\n  setOptions(options) {\n    this._options = options || /* @__PURE__ */ Object.create(null);\n    this._onDidChange.fire(this);\n  }\n  setDiagnosticsOptions(options) {\n    this.setOptions(options);\n  }\n  setModeConfiguration(modeConfiguration) {\n    this._modeConfiguration = modeConfiguration || /* @__PURE__ */ Object.create(null);\n    this._onDidChange.fire(this);\n  }\n};\nvar optionsDefault = {\n  validate: true,\n  lint: {\n    compatibleVendorPrefixes: \"ignore\",\n    vendorPrefix: \"warning\",\n    duplicateProperties: \"warning\",\n    emptyRules: \"warning\",\n    importStatement: \"ignore\",\n    boxModel: \"ignore\",\n    universalSelector: \"ignore\",\n    zeroUnits: \"ignore\",\n    fontFaceProperties: \"warning\",\n    hexColorLength: \"error\",\n    argumentsInColorFunction: \"error\",\n    unknownProperties: \"warning\",\n    ieHack: \"ignore\",\n    unknownVendorSpecificProperties: \"ignore\",\n    propertyIgnoredDueToDisplay: \"warning\",\n    important: \"ignore\",\n    float: \"ignore\",\n    idSelector: \"ignore\"\n  },\n  data: { useDefaultDataProvider: true },\n  format: {\n    newlineBetweenSelectors: true,\n    newlineBetweenRules: true,\n    spaceAroundSelectorSeparator: false,\n    braceStyle: \"collapse\",\n    maxPreserveNewLines: void 0,\n    preserveNewLines: true\n  }\n};\nvar modeConfigurationDefault = {\n  completionItems: true,\n  hovers: true,\n  documentSymbols: true,\n  definitions: true,\n  references: true,\n  documentHighlights: true,\n  rename: true,\n  colors: true,\n  foldingRanges: true,\n  diagnostics: true,\n  selectionRanges: true,\n  documentFormattingEdits: true,\n  documentRangeFormattingEdits: true\n};\nvar cssDefaults = new LanguageServiceDefaultsImpl(\n  \"css\",\n  optionsDefault,\n  modeConfigurationDefault\n);\nvar scssDefaults = new LanguageServiceDefaultsImpl(\n  \"scss\",\n  optionsDefault,\n  modeConfigurationDefault\n);\nvar lessDefaults = new LanguageServiceDefaultsImpl(\n  \"less\",\n  optionsDefault,\n  modeConfigurationDefault\n);\nmonaco_editor_core_exports.languages.css = { cssDefaults, lessDefaults, scssDefaults };\nfunction getMode() {\n  if (false) {\n    return new Promise((resolve, reject) => {\n      __require([\"vs/language/css/cssMode\"], resolve, reject);\n    });\n  } else {\n    return import(\"./cssMode.js\");\n  }\n}\nmonaco_editor_core_exports.languages.onLanguage(\"less\", () => {\n  getMode().then((mode) => mode.setupMode(lessDefaults));\n});\nmonaco_editor_core_exports.languages.onLanguage(\"scss\", () => {\n  getMode().then((mode) => mode.setupMode(scssDefaults));\n});\nmonaco_editor_core_exports.languages.onLanguage(\"css\", () => {\n  getMode().then((mode) => mode.setupMode(cssDefaults));\n});\nexport {\n  cssDefaults,\n  lessDefaults,\n  scssDefaults\n};\n", "import '../../editor/editor.api.js';\n/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __reExport = (target, mod, secondTarget) => (__copyProps(target, mod, \"default\"), secondTarget && __copyProps(secondTarget, mod, \"default\"));\n\n// src/fillers/monaco-editor-core.ts\nvar monaco_editor_core_exports = {};\n__reExport(monaco_editor_core_exports, monaco_editor_core_star);\nimport * as monaco_editor_core_star from \"../../editor/editor.api.js\";\n\n// src/language/html/monaco.contribution.ts\nvar LanguageServiceDefaultsImpl = class {\n  constructor(languageId, options, modeConfiguration) {\n    this._onDidChange = new monaco_editor_core_exports.Emitter();\n    this._languageId = languageId;\n    this.setOptions(options);\n    this.setModeConfiguration(modeConfiguration);\n  }\n  get onDidChange() {\n    return this._onDidChange.event;\n  }\n  get languageId() {\n    return this._languageId;\n  }\n  get options() {\n    return this._options;\n  }\n  get modeConfiguration() {\n    return this._modeConfiguration;\n  }\n  setOptions(options) {\n    this._options = options || /* @__PURE__ */ Object.create(null);\n    this._onDidChange.fire(this);\n  }\n  setModeConfiguration(modeConfiguration) {\n    this._modeConfiguration = modeConfiguration || /* @__PURE__ */ Object.create(null);\n    this._onDidChange.fire(this);\n  }\n};\nvar formatDefaults = {\n  tabSize: 4,\n  insertSpaces: false,\n  wrapLineLength: 120,\n  unformatted: 'default\": \"a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',\n  contentUnformatted: \"pre\",\n  indentInnerHtml: false,\n  preserveNewLines: true,\n  maxPreserveNewLines: void 0,\n  indentHandlebars: false,\n  endWithNewline: false,\n  extraLiners: \"head, body, /html\",\n  wrapAttributes: \"auto\"\n};\nvar optionsDefault = {\n  format: formatDefaults,\n  suggest: {},\n  data: { useDefaultDataProvider: true }\n};\nfunction getConfigurationDefault(languageId) {\n  return {\n    completionItems: true,\n    hovers: true,\n    documentSymbols: true,\n    links: true,\n    documentHighlights: true,\n    rename: true,\n    colors: true,\n    foldingRanges: true,\n    selectionRanges: true,\n    diagnostics: languageId === htmlLanguageId,\n    // turned off for Razor and Handlebar\n    documentFormattingEdits: languageId === htmlLanguageId,\n    // turned off for Razor and Handlebar\n    documentRangeFormattingEdits: languageId === htmlLanguageId\n    // turned off for Razor and Handlebar\n  };\n}\nvar htmlLanguageId = \"html\";\nvar handlebarsLanguageId = \"handlebars\";\nvar razorLanguageId = \"razor\";\nvar htmlLanguageService = registerHTMLLanguageService(\n  htmlLanguageId,\n  optionsDefault,\n  getConfigurationDefault(htmlLanguageId)\n);\nvar htmlDefaults = htmlLanguageService.defaults;\nvar handlebarLanguageService = registerHTMLLanguageService(\n  handlebarsLanguageId,\n  optionsDefault,\n  getConfigurationDefault(handlebarsLanguageId)\n);\nvar handlebarDefaults = handlebarLanguageService.defaults;\nvar razorLanguageService = registerHTMLLanguageService(\n  razorLanguageId,\n  optionsDefault,\n  getConfigurationDefault(razorLanguageId)\n);\nvar razorDefaults = razorLanguageService.defaults;\nmonaco_editor_core_exports.languages.html = {\n  htmlDefaults,\n  razorDefaults,\n  handlebarDefaults,\n  htmlLanguageService,\n  handlebarLanguageService,\n  razorLanguageService,\n  registerHTMLLanguageService\n};\nfunction getMode() {\n  if (false) {\n    return new Promise((resolve, reject) => {\n      __require([\"vs/language/html/htmlMode\"], resolve, reject);\n    });\n  } else {\n    return import(\"./htmlMode.js\");\n  }\n}\nfunction registerHTMLLanguageService(languageId, options = optionsDefault, modeConfiguration = getConfigurationDefault(languageId)) {\n  const defaults = new LanguageServiceDefaultsImpl(languageId, options, modeConfiguration);\n  let mode;\n  const onLanguageListener = monaco_editor_core_exports.languages.onLanguage(languageId, async () => {\n    mode = (await getMode()).setupMode(defaults);\n  });\n  return {\n    defaults,\n    dispose() {\n      onLanguageListener.dispose();\n      mode?.dispose();\n      mode = void 0;\n    }\n  };\n}\nexport {\n  handlebarDefaults,\n  handlebarLanguageService,\n  htmlDefaults,\n  htmlLanguageService,\n  razorDefaults,\n  razorLanguageService,\n  registerHTMLLanguageService\n};\n", "import '../../editor/editor.api.js';\n/*!-----------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.47.0(69991d66135e4a1fc1cf0b1ac4ad25d429866a0d)\n * Released under the MIT license\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\n *-----------------------------------------------------------------------------*/\n\n\n// src/language/json/monaco.contribution.ts\nimport { Emitter, languages } from \"../../editor/editor.api.js\";\nvar LanguageServiceDefaultsImpl = class {\n  constructor(languageId, diagnosticsOptions, modeConfiguration) {\n    this._onDidChange = new Emitter();\n    this._languageId = languageId;\n    this.setDiagnosticsOptions(diagnosticsOptions);\n    this.setModeConfiguration(modeConfiguration);\n  }\n  get onDidChange() {\n    return this._onDidChange.event;\n  }\n  get languageId() {\n    return this._languageId;\n  }\n  get modeConfiguration() {\n    return this._modeConfiguration;\n  }\n  get diagnosticsOptions() {\n    return this._diagnosticsOptions;\n  }\n  setDiagnosticsOptions(options) {\n    this._diagnosticsOptions = options || /* @__PURE__ */ Object.create(null);\n    this._onDidChange.fire(this);\n  }\n  setModeConfiguration(modeConfiguration) {\n    this._modeConfiguration = modeConfiguration || /* @__PURE__ */ Object.create(null);\n    this._onDidChange.fire(this);\n  }\n};\nvar diagnosticDefault = {\n  validate: true,\n  allowComments: true,\n  schemas: [],\n  enableSchemaRequest: false,\n  schemaRequest: \"warning\",\n  schemaValidation: \"warning\",\n  comments: \"error\",\n  trailingCommas: \"error\"\n};\nvar modeConfigurationDefault = {\n  documentFormattingEdits: true,\n  documentRangeFormattingEdits: true,\n  completionItems: true,\n  hovers: true,\n  documentSymbols: true,\n  tokens: true,\n  colors: true,\n  foldingRanges: true,\n  diagnostics: true,\n  selectionRanges: true\n};\nvar jsonDefaults = new LanguageServiceDefaultsImpl(\n  \"json\",\n  diagnosticDefault,\n  modeConfigurationDefault\n);\nvar getWorker = () => getMode().then((mode) => mode.getWorker());\nlanguages.json = { jsonDefaults, getWorker };\nfunction getMode() {\n  if (false) {\n    return new Promise((resolve, reject) => {\n      __require([\"vs/language/json/jsonMode\"], resolve, reject);\n    });\n  } else {\n    return import(\"./jsonMode.js\");\n  }\n}\nlanguages.register({\n  id: \"json\",\n  extensions: [\".json\", \".bowerrc\", \".jshintrc\", \".jscsrc\", \".eslintrc\", \".babelrc\", \".har\"],\n  aliases: [\"JSON\", \"json\"],\n  mimetypes: [\"application/json\"]\n});\nlanguages.onLanguage(\"json\", () => {\n  getMode().then((mode) => mode.setupMode(jsonDefaults));\n});\nexport {\n  getWorker,\n  jsonDefaults\n};\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getActiveElement } from '../../../../base/browser/dom.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { EditorAction2 } from '../../editorExtensions.js';\nimport { ICodeEditorService } from '../../services/codeEditorService.js';\nimport { DiffEditorWidget } from './diffEditorWidget.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Action2, MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyEqualsExpr, ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport './registrations.contribution.js';\nexport class ToggleCollapseUnchangedRegions extends Action2 {\n    constructor() {\n        super({\n            id: 'diffEditor.toggleCollapseUnchangedRegions',\n            title: localize2('toggleCollapseUnchangedRegions', 'Toggle Collapse Unchanged Regions'),\n            icon: Codicon.map,\n            toggled: ContextKeyExpr.has('config.diffEditor.hideUnchangedRegions.enabled'),\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n            menu: {\n                when: ContextKeyExpr.has('isInDiffEditor'),\n                id: MenuId.EditorTitle,\n                order: 22,\n                group: 'navigation',\n            },\n        });\n    }\n    run(accessor, ...args) {\n        const configurationService = accessor.get(IConfigurationService);\n        const newValue = !configurationService.getValue('diffEditor.hideUnchangedRegions.enabled');\n        configurationService.updateValue('diffEditor.hideUnchangedRegions.enabled', newValue);\n    }\n}\nregisterAction2(ToggleCollapseUnchangedRegions);\nexport class ToggleShowMovedCodeBlocks extends Action2 {\n    constructor() {\n        super({\n            id: 'diffEditor.toggleShowMovedCodeBlocks',\n            title: localize2('toggleShowMovedCodeBlocks', 'Toggle Show Moved Code Blocks'),\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n        });\n    }\n    run(accessor, ...args) {\n        const configurationService = accessor.get(IConfigurationService);\n        const newValue = !configurationService.getValue('diffEditor.experimental.showMoves');\n        configurationService.updateValue('diffEditor.experimental.showMoves', newValue);\n    }\n}\nregisterAction2(ToggleShowMovedCodeBlocks);\nexport class ToggleUseInlineViewWhenSpaceIsLimited extends Action2 {\n    constructor() {\n        super({\n            id: 'diffEditor.toggleUseInlineViewWhenSpaceIsLimited',\n            title: localize2('toggleUseInlineViewWhenSpaceIsLimited', 'Toggle Use Inline View When Space Is Limited'),\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n        });\n    }\n    run(accessor, ...args) {\n        const configurationService = accessor.get(IConfigurationService);\n        const newValue = !configurationService.getValue('diffEditor.useInlineViewWhenSpaceIsLimited');\n        configurationService.updateValue('diffEditor.useInlineViewWhenSpaceIsLimited', newValue);\n    }\n}\nregisterAction2(ToggleUseInlineViewWhenSpaceIsLimited);\nMenuRegistry.appendMenuItem(MenuId.EditorTitle, {\n    command: {\n        id: new ToggleUseInlineViewWhenSpaceIsLimited().desc.id,\n        title: localize('useInlineViewWhenSpaceIsLimited', \"Use Inline View When Space Is Limited\"),\n        toggled: ContextKeyExpr.has('config.diffEditor.useInlineViewWhenSpaceIsLimited'),\n        precondition: ContextKeyExpr.has('isInDiffEditor'),\n    },\n    order: 11,\n    group: '1_diff',\n    when: ContextKeyExpr.and(EditorContextKeys.diffEditorRenderSideBySideInlineBreakpointReached, ContextKeyExpr.has('isInDiffEditor')),\n});\nMenuRegistry.appendMenuItem(MenuId.EditorTitle, {\n    command: {\n        id: new ToggleShowMovedCodeBlocks().desc.id,\n        title: localize('showMoves', \"Show Moved Code Blocks\"),\n        icon: Codicon.move,\n        toggled: ContextKeyEqualsExpr.create('config.diffEditor.experimental.showMoves', true),\n        precondition: ContextKeyExpr.has('isInDiffEditor'),\n    },\n    order: 10,\n    group: '1_diff',\n    when: ContextKeyExpr.has('isInDiffEditor'),\n});\nconst diffEditorCategory = localize2('diffEditor', \"Diff Editor\");\nexport class SwitchSide extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'diffEditor.switchSide',\n            title: localize2('switchSide', 'Switch Side'),\n            icon: Codicon.arrowSwap,\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n            f1: true,\n            category: diffEditorCategory,\n        });\n    }\n    runEditorCommand(accessor, editor, arg) {\n        const diffEditor = findFocusedDiffEditor(accessor);\n        if (diffEditor instanceof DiffEditorWidget) {\n            if (arg && arg.dryRun) {\n                return { destinationSelection: diffEditor.mapToOtherSide().destinationSelection };\n            }\n            else {\n                diffEditor.switchSide();\n            }\n        }\n        return undefined;\n    }\n}\nregisterAction2(SwitchSide);\nexport class ExitCompareMove extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'diffEditor.exitCompareMove',\n            title: localize2('exitCompareMove', 'Exit Compare Move'),\n            icon: Codicon.close,\n            precondition: EditorContextKeys.comparingMovedCode,\n            f1: false,\n            category: diffEditorCategory,\n            keybinding: {\n                weight: 10000,\n                primary: 9 /* KeyCode.Escape */,\n            }\n        });\n    }\n    runEditorCommand(accessor, editor, ...args) {\n        const diffEditor = findFocusedDiffEditor(accessor);\n        if (diffEditor instanceof DiffEditorWidget) {\n            diffEditor.exitCompareMove();\n        }\n    }\n}\nregisterAction2(ExitCompareMove);\nexport class CollapseAllUnchangedRegions extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'diffEditor.collapseAllUnchangedRegions',\n            title: localize2('collapseAllUnchangedRegions', 'Collapse All Unchanged Regions'),\n            icon: Codicon.fold,\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n            f1: true,\n            category: diffEditorCategory,\n        });\n    }\n    runEditorCommand(accessor, editor, ...args) {\n        const diffEditor = findFocusedDiffEditor(accessor);\n        if (diffEditor instanceof DiffEditorWidget) {\n            diffEditor.collapseAllUnchangedRegions();\n        }\n    }\n}\nregisterAction2(CollapseAllUnchangedRegions);\nexport class ShowAllUnchangedRegions extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'diffEditor.showAllUnchangedRegions',\n            title: localize2('showAllUnchangedRegions', 'Show All Unchanged Regions'),\n            icon: Codicon.unfold,\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n            f1: true,\n            category: diffEditorCategory,\n        });\n    }\n    runEditorCommand(accessor, editor, ...args) {\n        const diffEditor = findFocusedDiffEditor(accessor);\n        if (diffEditor instanceof DiffEditorWidget) {\n            diffEditor.showAllUnchangedRegions();\n        }\n    }\n}\nregisterAction2(ShowAllUnchangedRegions);\nconst accessibleDiffViewerCategory = localize2('accessibleDiffViewer', \"Accessible Diff Viewer\");\nexport class AccessibleDiffViewerNext extends Action2 {\n    constructor() {\n        super({\n            id: AccessibleDiffViewerNext.id,\n            title: localize2('editor.action.accessibleDiffViewer.next', 'Go to Next Difference'),\n            category: accessibleDiffViewerCategory,\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n            keybinding: {\n                primary: 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            f1: true,\n        });\n    }\n    run(accessor) {\n        const diffEditor = findFocusedDiffEditor(accessor);\n        diffEditor === null || diffEditor === void 0 ? void 0 : diffEditor.accessibleDiffViewerNext();\n    }\n}\nAccessibleDiffViewerNext.id = 'editor.action.accessibleDiffViewer.next';\nMenuRegistry.appendMenuItem(MenuId.EditorTitle, {\n    command: {\n        id: AccessibleDiffViewerNext.id,\n        title: localize('Open Accessible Diff Viewer', \"Open Accessible Diff Viewer\"),\n        precondition: ContextKeyExpr.has('isInDiffEditor'),\n    },\n    order: 10,\n    group: '2_diff',\n    when: ContextKeyExpr.and(EditorContextKeys.accessibleDiffViewerVisible.negate(), ContextKeyExpr.has('isInDiffEditor')),\n});\nexport class AccessibleDiffViewerPrev extends Action2 {\n    constructor() {\n        super({\n            id: AccessibleDiffViewerPrev.id,\n            title: localize2('editor.action.accessibleDiffViewer.prev', 'Go to Previous Difference'),\n            category: accessibleDiffViewerCategory,\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\n            keybinding: {\n                primary: 1024 /* KeyMod.Shift */ | 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            f1: true,\n        });\n    }\n    run(accessor) {\n        const diffEditor = findFocusedDiffEditor(accessor);\n        diffEditor === null || diffEditor === void 0 ? void 0 : diffEditor.accessibleDiffViewerPrev();\n    }\n}\nAccessibleDiffViewerPrev.id = 'editor.action.accessibleDiffViewer.prev';\nexport function findFocusedDiffEditor(accessor) {\n    const codeEditorService = accessor.get(ICodeEditorService);\n    const diffEditors = codeEditorService.listDiffEditors();\n    const activeElement = getActiveElement();\n    if (activeElement) {\n        for (const d of diffEditors) {\n            const container = d.getContainerDomNode();\n            if (isElementOrParentOf(container, activeElement)) {\n                return d;\n            }\n        }\n    }\n    return null;\n}\nfunction isElementOrParentOf(elementOrParent, element) {\n    let e = element;\n    while (e) {\n        if (e === elementOrParent) {\n            return true;\n        }\n        e = e.parentElement;\n    }\n    return false;\n}\nCommandsRegistry.registerCommandAlias('editor.action.diffReview.next', AccessibleDiffViewerNext.id);\nregisterAction2(AccessibleDiffViewerNext);\nCommandsRegistry.registerCommandAlias('editor.action.diffReview.prev', AccessibleDiffViewerPrev.id);\nregisterAction2(AccessibleDiffViewerPrev);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SelectionAnchorController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport './anchorSelect.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const SelectionAnchorSet = new RawContextKey('selectionAnchorSet', false);\nlet SelectionAnchorController = SelectionAnchorController_1 = class SelectionAnchorController {\n    static get(editor) {\n        return editor.getContribution(SelectionAnchorController_1.ID);\n    }\n    constructor(editor, contextKeyService) {\n        this.editor = editor;\n        this.selectionAnchorSetContextKey = SelectionAnchorSet.bindTo(contextKeyService);\n        this.modelChangeListener = editor.onDidChangeModel(() => this.selectionAnchorSetContextKey.reset());\n    }\n    setSelectionAnchor() {\n        if (this.editor.hasModel()) {\n            const position = this.editor.getPosition();\n            this.editor.changeDecorations((accessor) => {\n                if (this.decorationId) {\n                    accessor.removeDecoration(this.decorationId);\n                }\n                this.decorationId = accessor.addDecoration(Selection.fromPositions(position, position), {\n                    description: 'selection-anchor',\n                    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n                    hoverMessage: new MarkdownString().appendText(localize('selectionAnchor', \"Selection Anchor\")),\n                    className: 'selection-anchor'\n                });\n            });\n            this.selectionAnchorSetContextKey.set(!!this.decorationId);\n            alert(localize('anchorSet', \"Anchor set at {0}:{1}\", position.lineNumber, position.column));\n        }\n    }\n    goToSelectionAnchor() {\n        if (this.editor.hasModel() && this.decorationId) {\n            const anchorPosition = this.editor.getModel().getDecorationRange(this.decorationId);\n            if (anchorPosition) {\n                this.editor.setPosition(anchorPosition.getStartPosition());\n            }\n        }\n    }\n    selectFromAnchorToCursor() {\n        if (this.editor.hasModel() && this.decorationId) {\n            const start = this.editor.getModel().getDecorationRange(this.decorationId);\n            if (start) {\n                const end = this.editor.getPosition();\n                this.editor.setSelection(Selection.fromPositions(start.getStartPosition(), end));\n                this.cancelSelectionAnchor();\n            }\n        }\n    }\n    cancelSelectionAnchor() {\n        if (this.decorationId) {\n            const decorationId = this.decorationId;\n            this.editor.changeDecorations((accessor) => {\n                accessor.removeDecoration(decorationId);\n                this.decorationId = undefined;\n            });\n            this.selectionAnchorSetContextKey.set(false);\n        }\n    }\n    dispose() {\n        this.cancelSelectionAnchor();\n        this.modelChangeListener.dispose();\n    }\n};\nSelectionAnchorController.ID = 'editor.contrib.selectionAnchorController';\nSelectionAnchorController = SelectionAnchorController_1 = __decorate([\n    __param(1, IContextKeyService)\n], SelectionAnchorController);\nclass SetSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.setSelectionAnchor',\n            label: localize('setSelectionAnchor', \"Set Selection Anchor\"),\n            alias: 'Set Selection Anchor',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 32 /* KeyCode.KeyB */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(_accessor, editor) {\n        var _a;\n        (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.setSelectionAnchor();\n    }\n}\nclass GoToSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.goToSelectionAnchor',\n            label: localize('goToSelectionAnchor', \"Go to Selection Anchor\"),\n            alias: 'Go to Selection Anchor',\n            precondition: SelectionAnchorSet,\n        });\n    }\n    async run(_accessor, editor) {\n        var _a;\n        (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.goToSelectionAnchor();\n    }\n}\nclass SelectFromAnchorToCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectFromAnchorToCursor',\n            label: localize('selectFromAnchorToCursor', \"Select from Anchor to Cursor\"),\n            alias: 'Select from Anchor to Cursor',\n            precondition: SelectionAnchorSet,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(_accessor, editor) {\n        var _a;\n        (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.selectFromAnchorToCursor();\n    }\n}\nclass CancelSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.cancelSelectionAnchor',\n            label: localize('cancelSelectionAnchor', \"Cancel Selection Anchor\"),\n            alias: 'Cancel Selection Anchor',\n            precondition: SelectionAnchorSet,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 9 /* KeyCode.Escape */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(_accessor, editor) {\n        var _a;\n        (_a = SelectionAnchorController.get(editor)) === null || _a === void 0 ? void 0 : _a.cancelSelectionAnchor();\n    }\n}\nregisterEditorContribution(SelectionAnchorController.ID, SelectionAnchorController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(SetSelectionAnchor);\nregisterEditorAction(GoToSelectionAnchor);\nregisterEditorAction(SelectFromAnchorToCursor);\nregisterEditorAction(CancelSelectionAnchor);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport './bracketMatching.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst overviewRulerBracketMatchForeground = registerColor('editorOverviewRuler.bracketMatchForeground', { dark: '#A0A0A0', light: '#A0A0A0', hcDark: '#A0A0A0', hcLight: '#A0A0A0' }, nls.localize('overviewRulerBracketMatchForeground', 'Overview ruler marker color for matching brackets.'));\nclass JumpToBracketAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.jumpToBracket',\n            label: nls.localize('smartSelect.jumpBracket', \"Go to Bracket\"),\n            alias: 'Go to Bracket',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 93 /* KeyCode.Backslash */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        var _a;\n        (_a = BracketMatchingController.get(editor)) === null || _a === void 0 ? void 0 : _a.jumpToBracket();\n    }\n}\nclass SelectToBracketAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectToBracket',\n            label: nls.localize('smartSelect.selectToBracket', \"Select to Bracket\"),\n            alias: 'Select to Bracket',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('smartSelect.selectToBracketDescription', \"Select the text inside and including the brackets or curly braces\"),\n                args: [{\n                        name: 'args',\n                        schema: {\n                            type: 'object',\n                            properties: {\n                                'selectBrackets': {\n                                    type: 'boolean',\n                                    default: true\n                                }\n                            },\n                        }\n                    }]\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        var _a;\n        let selectBrackets = true;\n        if (args && args.selectBrackets === false) {\n            selectBrackets = false;\n        }\n        (_a = BracketMatchingController.get(editor)) === null || _a === void 0 ? void 0 : _a.selectToBracket(selectBrackets);\n    }\n}\nclass RemoveBracketsAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.removeBrackets',\n            label: nls.localize('smartSelect.removeBrackets', \"Remove Brackets\"),\n            alias: 'Remove Brackets',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        var _a;\n        (_a = BracketMatchingController.get(editor)) === null || _a === void 0 ? void 0 : _a.removeBrackets(this.id);\n    }\n}\nclass BracketsData {\n    constructor(position, brackets, options) {\n        this.position = position;\n        this.brackets = brackets;\n        this.options = options;\n    }\n}\nexport class BracketMatchingController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(BracketMatchingController.ID);\n    }\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._lastBracketsData = [];\n        this._lastVersionId = 0;\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateBracketsSoon = this._register(new RunOnceScheduler(() => this._updateBrackets(), 50));\n        this._matchBrackets = this._editor.getOption(72 /* EditorOption.matchBrackets */);\n        this._updateBracketsSoon.schedule();\n        this._register(editor.onDidChangeCursorPosition((e) => {\n            if (this._matchBrackets === 'never') {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this._lastBracketsData = [];\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModelLanguageConfiguration((e) => {\n            this._lastBracketsData = [];\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(72 /* EditorOption.matchBrackets */)) {\n                this._matchBrackets = this._editor.getOption(72 /* EditorOption.matchBrackets */);\n                this._decorations.clear();\n                this._lastBracketsData = [];\n                this._lastVersionId = 0;\n                this._updateBracketsSoon.schedule();\n            }\n        }));\n        this._register(editor.onDidBlurEditorWidget(() => {\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidFocusEditorWidget(() => {\n            this._updateBracketsSoon.schedule();\n        }));\n    }\n    jumpToBracket() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const newSelections = this._editor.getSelections().map(selection => {\n            const position = selection.getStartPosition();\n            // find matching brackets if position is on a bracket\n            const brackets = model.bracketPairs.matchBracket(position);\n            let newCursorPosition = null;\n            if (brackets) {\n                if (brackets[0].containsPosition(position) && !brackets[1].containsPosition(position)) {\n                    newCursorPosition = brackets[1].getStartPosition();\n                }\n                else if (brackets[1].containsPosition(position)) {\n                    newCursorPosition = brackets[0].getStartPosition();\n                }\n            }\n            else {\n                // find the enclosing brackets if the position isn't on a matching bracket\n                const enclosingBrackets = model.bracketPairs.findEnclosingBrackets(position);\n                if (enclosingBrackets) {\n                    newCursorPosition = enclosingBrackets[1].getStartPosition();\n                }\n                else {\n                    // no enclosing brackets, try the very first next bracket\n                    const nextBracket = model.bracketPairs.findNextBracket(position);\n                    if (nextBracket && nextBracket.range) {\n                        newCursorPosition = nextBracket.range.getStartPosition();\n                    }\n                }\n            }\n            if (newCursorPosition) {\n                return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\n            }\n            return new Selection(position.lineNumber, position.column, position.lineNumber, position.column);\n        });\n        this._editor.setSelections(newSelections);\n        this._editor.revealRange(newSelections[0]);\n    }\n    selectToBracket(selectBrackets) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const newSelections = [];\n        this._editor.getSelections().forEach(selection => {\n            const position = selection.getStartPosition();\n            let brackets = model.bracketPairs.matchBracket(position);\n            if (!brackets) {\n                brackets = model.bracketPairs.findEnclosingBrackets(position);\n                if (!brackets) {\n                    const nextBracket = model.bracketPairs.findNextBracket(position);\n                    if (nextBracket && nextBracket.range) {\n                        brackets = model.bracketPairs.matchBracket(nextBracket.range.getStartPosition());\n                    }\n                }\n            }\n            let selectFrom = null;\n            let selectTo = null;\n            if (brackets) {\n                brackets.sort(Range.compareRangesUsingStarts);\n                const [open, close] = brackets;\n                selectFrom = selectBrackets ? open.getStartPosition() : open.getEndPosition();\n                selectTo = selectBrackets ? close.getEndPosition() : close.getStartPosition();\n                if (close.containsPosition(position)) {\n                    // select backwards if the cursor was on the closing bracket\n                    const tmp = selectFrom;\n                    selectFrom = selectTo;\n                    selectTo = tmp;\n                }\n            }\n            if (selectFrom && selectTo) {\n                newSelections.push(new Selection(selectFrom.lineNumber, selectFrom.column, selectTo.lineNumber, selectTo.column));\n            }\n        });\n        if (newSelections.length > 0) {\n            this._editor.setSelections(newSelections);\n            this._editor.revealRange(newSelections[0]);\n        }\n    }\n    removeBrackets(editSource) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        this._editor.getSelections().forEach((selection) => {\n            const position = selection.getPosition();\n            let brackets = model.bracketPairs.matchBracket(position);\n            if (!brackets) {\n                brackets = model.bracketPairs.findEnclosingBrackets(position);\n            }\n            if (brackets) {\n                this._editor.pushUndoStop();\n                this._editor.executeEdits(editSource, [\n                    { range: brackets[0], text: '' },\n                    { range: brackets[1], text: '' }\n                ]);\n                this._editor.pushUndoStop();\n            }\n        });\n    }\n    _updateBrackets() {\n        if (this._matchBrackets === 'never') {\n            return;\n        }\n        this._recomputeBrackets();\n        const newDecorations = [];\n        let newDecorationsLen = 0;\n        for (const bracketData of this._lastBracketsData) {\n            const brackets = bracketData.brackets;\n            if (brackets) {\n                newDecorations[newDecorationsLen++] = { range: brackets[0], options: bracketData.options };\n                newDecorations[newDecorationsLen++] = { range: brackets[1], options: bracketData.options };\n            }\n        }\n        this._decorations.set(newDecorations);\n    }\n    _recomputeBrackets() {\n        if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n            // no model or no focus => no brackets!\n            this._lastBracketsData = [];\n            this._lastVersionId = 0;\n            return;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length > 100) {\n            // no bracket matching for high numbers of selections\n            this._lastBracketsData = [];\n            this._lastVersionId = 0;\n            return;\n        }\n        const model = this._editor.getModel();\n        const versionId = model.getVersionId();\n        let previousData = [];\n        if (this._lastVersionId === versionId) {\n            // use the previous data only if the model is at the same version id\n            previousData = this._lastBracketsData;\n        }\n        const positions = [];\n        let positionsLen = 0;\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            if (selection.isEmpty()) {\n                // will bracket match a cursor only if the selection is collapsed\n                positions[positionsLen++] = selection.getStartPosition();\n            }\n        }\n        // sort positions for `previousData` cache hits\n        if (positions.length > 1) {\n            positions.sort(Position.compare);\n        }\n        const newData = [];\n        let newDataLen = 0;\n        let previousIndex = 0;\n        const previousLen = previousData.length;\n        for (let i = 0, len = positions.length; i < len; i++) {\n            const position = positions[i];\n            while (previousIndex < previousLen && previousData[previousIndex].position.isBefore(position)) {\n                previousIndex++;\n            }\n            if (previousIndex < previousLen && previousData[previousIndex].position.equals(position)) {\n                newData[newDataLen++] = previousData[previousIndex];\n            }\n            else {\n                let brackets = model.bracketPairs.matchBracket(position, 20 /* give at most 20ms to compute */);\n                let options = BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;\n                if (!brackets && this._matchBrackets === 'always') {\n                    brackets = model.bracketPairs.findEnclosingBrackets(position, 20 /* give at most 20ms to compute */);\n                    options = BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER;\n                }\n                newData[newDataLen++] = new BracketsData(position, brackets, options);\n            }\n        }\n        this._lastBracketsData = newData;\n        this._lastVersionId = versionId;\n    }\n}\nBracketMatchingController.ID = 'editor.contrib.bracketMatchingController';\nBracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER = ModelDecorationOptions.register({\n    description: 'bracket-match-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'bracket-match',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerBracketMatchForeground),\n        position: OverviewRulerLane.Center\n    }\n});\nBracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER = ModelDecorationOptions.register({\n    description: 'bracket-match-no-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'bracket-match'\n});\nregisterEditorContribution(BracketMatchingController.ID, BracketMatchingController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(SelectToBracketAction);\nregisterEditorAction(JumpToBracketAction);\nregisterEditorAction(RemoveBracketsAction);\n// Go to menu\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\n    group: '5_infile_nav',\n    command: {\n        id: 'editor.action.jumpToBracket',\n        title: nls.localize({ key: 'miGoToBracket', comment: ['&& denotes a mnemonic'] }, \"Go to &&Bracket\")\n    },\n    order: 2\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { MoveCaretCommand } from './moveCaretCommand.js';\nimport * as nls from '../../../../nls.js';\nclass MoveCaretAction extends EditorAction {\n    constructor(left, opts) {\n        super(opts);\n        this.left = left;\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            commands.push(new MoveCaretCommand(selection, this.left));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass MoveCaretLeftAction extends MoveCaretAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.moveCarretLeftAction',\n            label: nls.localize('caret.moveLeft', \"Move Selected Text Left\"),\n            alias: 'Move Selected Text Left',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nclass MoveCaretRightAction extends MoveCaretAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.moveCarretRightAction',\n            label: nls.localize('caret.moveRight', \"Move Selected Text Right\"),\n            alias: 'Move Selected Text Right',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nregisterEditorAction(MoveCaretLeftAction);\nregisterEditorAction(MoveCaretRightAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class MoveCaretCommand {\n    constructor(selection, isMovingLeft) {\n        this._selection = selection;\n        this._isMovingLeft = isMovingLeft;\n    }\n    getEditOperations(model, builder) {\n        if (this._selection.startLineNumber !== this._selection.endLineNumber || this._selection.isEmpty()) {\n            return;\n        }\n        const lineNumber = this._selection.startLineNumber;\n        const startColumn = this._selection.startColumn;\n        const endColumn = this._selection.endColumn;\n        if (this._isMovingLeft && startColumn === 1) {\n            return;\n        }\n        if (!this._isMovingLeft && endColumn === model.getLineMaxColumn(lineNumber)) {\n            return;\n        }\n        if (this._isMovingLeft) {\n            const rangeBefore = new Range(lineNumber, startColumn - 1, lineNumber, startColumn);\n            const charBefore = model.getValueInRange(rangeBefore);\n            builder.addEditOperation(rangeBefore, null);\n            builder.addEditOperation(new Range(lineNumber, endColumn, lineNumber, endColumn), charBefore);\n        }\n        else {\n            const rangeAfter = new Range(lineNumber, endColumn, lineNumber, endColumn + 1);\n            const charAfter = model.getValueInRange(rangeAfter);\n            builder.addEditOperation(rangeAfter, null);\n            builder.addEditOperation(new Range(lineNumber, startColumn, lineNumber, startColumn), charAfter);\n        }\n    }\n    computeCursorState(model, helper) {\n        if (this._isMovingLeft) {\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn - 1, this._selection.endLineNumber, this._selection.endColumn - 1);\n        }\n        else {\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn + 1, this._selection.endLineNumber, this._selection.endColumn + 1);\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand } from '../../../common/commands/replaceCommand.js';\nimport { MoveOperations } from '../../../common/cursor/cursorMoveOperations.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nclass TransposeLettersAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.transposeLetters',\n            label: nls.localize('transposeLetters.label', \"Transpose Letters\"),\n            alias: 'Transpose Letters',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: {\n                    primary: 256 /* KeyMod.WinCtrl */ | 50 /* KeyCode.KeyT */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            if (!selection.isEmpty()) {\n                continue;\n            }\n            const lineNumber = selection.startLineNumber;\n            const column = selection.startColumn;\n            const lastColumn = model.getLineMaxColumn(lineNumber);\n            if (lineNumber === 1 && (column === 1 || (column === 2 && lastColumn === 2))) {\n                // at beginning of file, nothing to do\n                continue;\n            }\n            // handle special case: when at end of line, transpose left two chars\n            // otherwise, transpose left and right chars\n            const endPosition = (column === lastColumn) ?\n                selection.getPosition() :\n                MoveOperations.rightPosition(model, selection.getPosition().lineNumber, selection.getPosition().column);\n            const middlePosition = MoveOperations.leftPosition(model, endPosition);\n            const beginPosition = MoveOperations.leftPosition(model, middlePosition);\n            const leftChar = model.getValueInRange(Range.fromPositions(beginPosition, middlePosition));\n            const rightChar = model.getValueInRange(Range.fromPositions(middlePosition, endPosition));\n            const replaceRange = Range.fromPositions(beginPosition, endPosition);\n            commands.push(new ReplaceCommand(replaceRange, rightChar + leftChar));\n        }\n        if (commands.length > 0) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, commands);\n            editor.pushUndoStop();\n        }\n    }\n}\nregisterEditorAction(TransposeLettersAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../../base/browser/browser.js';\nimport { getActiveDocument } from '../../../../base/browser/dom.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { CopyOptions, InMemoryClipboardMetadataManager } from '../../../browser/controller/textAreaInput.js';\nimport { EditorAction, MultiCommand, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CopyPasteController } from '../../dropOrPasteInto/browser/copyPasteController.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nconst CLIPBOARD_CONTEXT_MENU_GROUP = '9_cutcopypaste';\nconst supportsCut = (platform.isNative || document.queryCommandSupported('cut'));\nconst supportsCopy = (platform.isNative || document.queryCommandSupported('copy'));\n// Firefox only supports navigator.clipboard.readText() in browser extensions.\n// See https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/readText#Browser_compatibility\n// When loading over http, navigator.clipboard can be undefined. See https://github.com/microsoft/monaco-editor/issues/2313\nconst supportsPaste = (typeof navigator.clipboard === 'undefined' || browser.isFirefox) ? document.queryCommandSupported('paste') : true;\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport const CutAction = supportsCut ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardCutAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind cut keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */, secondary: [1024 /* KeyMod.Shift */ | 20 /* KeyCode.Delete */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miCut', comment: ['&& denotes a mnemonic'] }, \"Cu&&t\"),\n            order: 1\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            when: EditorContextKeys.writable,\n            order: 1,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            when: EditorContextKeys.writable,\n            order: 1,\n        }]\n})) : undefined;\nexport const CopyAction = supportsCopy ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardCopyAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind copy keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */, secondary: [2048 /* KeyMod.CtrlCmd */ | 19 /* KeyCode.Insert */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miCopy', comment: ['&& denotes a mnemonic'] }, \"&&Copy\"),\n            order: 2\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 2,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 2,\n        }]\n})) : undefined;\nMenuRegistry.appendMenuItem(MenuId.MenubarEditMenu, { submenu: MenuId.MenubarCopy, title: nls.localize2('copy as', \"Copy As\"), group: '2_ccp', order: 3 });\nMenuRegistry.appendMenuItem(MenuId.EditorContext, { submenu: MenuId.EditorContextCopy, title: nls.localize2('copy as', \"Copy As\"), group: CLIPBOARD_CONTEXT_MENU_GROUP, order: 3 });\nMenuRegistry.appendMenuItem(MenuId.EditorContext, { submenu: MenuId.EditorContextShare, title: nls.localize2('share', \"Share\"), group: '11_share', order: -1, when: ContextKeyExpr.and(ContextKeyExpr.notEquals('resourceScheme', 'output'), EditorContextKeys.editorTextFocus) });\nMenuRegistry.appendMenuItem(MenuId.EditorTitleContext, { submenu: MenuId.EditorTitleContextShare, title: nls.localize2('share', \"Share\"), group: '11_share', order: -1 });\nMenuRegistry.appendMenuItem(MenuId.ExplorerContext, { submenu: MenuId.ExplorerContextShare, title: nls.localize2('share', \"Share\"), group: '11_share', order: -1 });\nexport const PasteAction = supportsPaste ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardPasteAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind paste keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */, secondary: [1024 /* KeyMod.Shift */ | 19 /* KeyCode.Insert */] },\n        linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */, secondary: [1024 /* KeyMod.Shift */ | 19 /* KeyCode.Insert */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miPaste', comment: ['&& denotes a mnemonic'] }, \"&&Paste\"),\n            order: 4\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            when: EditorContextKeys.writable,\n            order: 4,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            when: EditorContextKeys.writable,\n            order: 4,\n        }]\n})) : undefined;\nclass ExecCommandCopyWithSyntaxHighlightingAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.clipboardCopyWithSyntaxHighlightingAction',\n            label: nls.localize('actions.clipboard.copyWithSyntaxHighlightingLabel', \"Copy With Syntax Highlighting\"),\n            alias: 'Copy With Syntax Highlighting',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const emptySelectionClipboard = editor.getOption(37 /* EditorOption.emptySelectionClipboard */);\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\n            return;\n        }\n        CopyOptions.forceCopyWithSyntaxHighlighting = true;\n        editor.focus();\n        editor.getContainerDomNode().ownerDocument.execCommand('copy');\n        CopyOptions.forceCopyWithSyntaxHighlighting = false;\n    }\n}\nfunction registerExecCommandImpl(target, browserCommand) {\n    if (!target) {\n        return;\n    }\n    // 1. handle case when focus is in editor.\n    target.addImplementation(10000, 'code-editor', (accessor, args) => {\n        // Only if editor text focus (i.e. not if editor has widget focus).\n        const focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\n            // Do not execute if there is no selection and empty selection clipboard is off\n            const emptySelectionClipboard = focusedEditor.getOption(37 /* EditorOption.emptySelectionClipboard */);\n            const selection = focusedEditor.getSelection();\n            if (selection && selection.isEmpty() && !emptySelectionClipboard) {\n                return true;\n            }\n            focusedEditor.getContainerDomNode().ownerDocument.execCommand(browserCommand);\n            return true;\n        }\n        return false;\n    });\n    // 2. (default) handle case when focus is somewhere else.\n    target.addImplementation(0, 'generic-dom', (accessor, args) => {\n        getActiveDocument().execCommand(browserCommand);\n        return true;\n    });\n}\nregisterExecCommandImpl(CutAction, 'cut');\nregisterExecCommandImpl(CopyAction, 'copy');\nif (PasteAction) {\n    // 1. Paste: handle case when focus is in editor.\n    PasteAction.addImplementation(10000, 'code-editor', (accessor, args) => {\n        var _a, _b;\n        const codeEditorService = accessor.get(ICodeEditorService);\n        const clipboardService = accessor.get(IClipboardService);\n        // Only if editor text focus (i.e. not if editor has widget focus).\n        const focusedEditor = codeEditorService.getFocusedCodeEditor();\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\n            const result = focusedEditor.getContainerDomNode().ownerDocument.execCommand('paste');\n            if (result) {\n                return (_b = (_a = CopyPasteController.get(focusedEditor)) === null || _a === void 0 ? void 0 : _a.finishedPaste()) !== null && _b !== void 0 ? _b : Promise.resolve();\n            }\n            else if (platform.isWeb) {\n                // Use the clipboard service if document.execCommand('paste') was not successful\n                return (async () => {\n                    const clipboardText = await clipboardService.readText();\n                    if (clipboardText !== '') {\n                        const metadata = InMemoryClipboardMetadataManager.INSTANCE.get(clipboardText);\n                        let pasteOnNewLine = false;\n                        let multicursorText = null;\n                        let mode = null;\n                        if (metadata) {\n                            pasteOnNewLine = (focusedEditor.getOption(37 /* EditorOption.emptySelectionClipboard */) && !!metadata.isFromEmptySelection);\n                            multicursorText = (typeof metadata.multicursorText !== 'undefined' ? metadata.multicursorText : null);\n                            mode = metadata.mode;\n                        }\n                        focusedEditor.trigger('keyboard', \"paste\" /* Handler.Paste */, {\n                            text: clipboardText,\n                            pasteOnNewLine,\n                            multicursorText,\n                            mode\n                        });\n                    }\n                })();\n            }\n            return true;\n        }\n        return false;\n    });\n    // 2. Paste: (default) handle case when focus is somewhere else.\n    PasteAction.addImplementation(0, 'generic-dom', (accessor, args) => {\n        getActiveDocument().execCommand('paste');\n        return true;\n    });\n}\nif (supportsCopy) {\n    registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CopyPasteController_1;\nimport { addDisposableListener, getActiveDocument } from '../../../../base/browser/dom.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { UriList, createStringDataTransferItem, matchesMimeType } from '../../../../base/common/dataTransfer.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../base/common/mime.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ClipboardEventUtils } from '../../../browser/controller/textAreaInput.js';\nimport { toExternalVSDataTransfer, toVSDataTransfer } from '../../../browser/dnd.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { createCombinedWorkspaceEdit, sortEditsByYieldTo } from './edit.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { InlineProgressManager } from '../../inlineProgress/browser/inlineProgress.js';\nimport { localize } from '../../../../nls.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IProgressService } from '../../../../platform/progress/common/progress.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { PostEditWidgetManager } from './postEditWidget.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nexport const changePasteTypeCommandId = 'editor.changePasteType';\nexport const pasteWidgetVisibleCtx = new RawContextKey('pasteWidgetVisible', false, localize('pasteWidgetVisible', \"Whether the paste widget is showing\"));\nconst vscodeClipboardMime = 'application/vnd.code.copyMetadata';\nlet CopyPasteController = CopyPasteController_1 = class CopyPasteController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(CopyPasteController_1.ID);\n    }\n    constructor(editor, instantiationService, _bulkEditService, _clipboardService, _languageFeaturesService, _quickInputService, _progressService) {\n        super();\n        this._bulkEditService = _bulkEditService;\n        this._clipboardService = _clipboardService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._quickInputService = _quickInputService;\n        this._progressService = _progressService;\n        this._editor = editor;\n        const container = editor.getContainerDomNode();\n        this._register(addDisposableListener(container, 'copy', e => this.handleCopy(e)));\n        this._register(addDisposableListener(container, 'cut', e => this.handleCopy(e)));\n        this._register(addDisposableListener(container, 'paste', e => this.handlePaste(e), true));\n        this._pasteProgressManager = this._register(new InlineProgressManager('pasteIntoEditor', editor, instantiationService));\n        this._postPasteWidgetManager = this._register(instantiationService.createInstance(PostEditWidgetManager, 'pasteIntoEditor', editor, pasteWidgetVisibleCtx, { id: changePasteTypeCommandId, label: localize('postPasteWidgetTitle', \"Show paste options...\") }));\n    }\n    changePasteType() {\n        this._postPasteWidgetManager.tryShowSelector();\n    }\n    pasteAs(preferredId) {\n        this._editor.focus();\n        try {\n            this._pasteAsActionContext = { preferredId };\n            getActiveDocument().execCommand('paste');\n        }\n        finally {\n            this._pasteAsActionContext = undefined;\n        }\n    }\n    isPasteAsEnabled() {\n        return this._editor.getOption(85 /* EditorOption.pasteAs */).enabled\n            && !this._editor.getOption(91 /* EditorOption.readOnly */);\n    }\n    async finishedPaste() {\n        await this._currentPasteOperation;\n    }\n    handleCopy(e) {\n        var _a, _b;\n        if (!this._editor.hasTextFocus()) {\n            return;\n        }\n        if (platform.isWeb) {\n            // Explicitly clear the web resources clipboard.\n            // This is needed because on web, the browser clipboard is faked out using an in-memory store.\n            // This means the resources clipboard is not properly updated when copying from the editor.\n            this._clipboardService.writeResources([]);\n        }\n        if (!e.clipboardData || !this.isPasteAsEnabled()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const selections = this._editor.getSelections();\n        if (!model || !(selections === null || selections === void 0 ? void 0 : selections.length)) {\n            return;\n        }\n        const enableEmptySelectionClipboard = this._editor.getOption(37 /* EditorOption.emptySelectionClipboard */);\n        let ranges = selections;\n        const wasFromEmptySelection = selections.length === 1 && selections[0].isEmpty();\n        if (wasFromEmptySelection) {\n            if (!enableEmptySelectionClipboard) {\n                return;\n            }\n            ranges = [new Range(ranges[0].startLineNumber, 1, ranges[0].startLineNumber, 1 + model.getLineLength(ranges[0].startLineNumber))];\n        }\n        const toCopy = (_a = this._editor._getViewModel()) === null || _a === void 0 ? void 0 : _a.getPlainTextToCopy(selections, enableEmptySelectionClipboard, platform.isWindows);\n        const multicursorText = Array.isArray(toCopy) ? toCopy : null;\n        const defaultPastePayload = {\n            multicursorText,\n            pasteOnNewLine: wasFromEmptySelection,\n            mode: null\n        };\n        const providers = this._languageFeaturesService.documentPasteEditProvider\n            .ordered(model)\n            .filter(x => !!x.prepareDocumentPaste);\n        if (!providers.length) {\n            this.setCopyMetadata(e.clipboardData, { defaultPastePayload });\n            return;\n        }\n        const dataTransfer = toVSDataTransfer(e.clipboardData);\n        const providerCopyMimeTypes = providers.flatMap(x => { var _a; return (_a = x.copyMimeTypes) !== null && _a !== void 0 ? _a : []; });\n        // Save off a handle pointing to data that VS Code maintains.\n        const handle = generateUuid();\n        this.setCopyMetadata(e.clipboardData, {\n            id: handle,\n            providerCopyMimeTypes,\n            defaultPastePayload\n        });\n        const promise = createCancelablePromise(async (token) => {\n            const results = coalesce(await Promise.all(providers.map(async (provider) => {\n                try {\n                    return await provider.prepareDocumentPaste(model, ranges, dataTransfer, token);\n                }\n                catch (err) {\n                    console.error(err);\n                    return undefined;\n                }\n            })));\n            // Values from higher priority providers should overwrite values from lower priority ones.\n            // Reverse the array to so that the calls to `replace` below will do this\n            results.reverse();\n            for (const result of results) {\n                for (const [mime, value] of result) {\n                    dataTransfer.replace(mime, value);\n                }\n            }\n            return dataTransfer;\n        });\n        (_b = this._currentCopyOperation) === null || _b === void 0 ? void 0 : _b.dataTransferPromise.cancel();\n        this._currentCopyOperation = { handle: handle, dataTransferPromise: promise };\n    }\n    async handlePaste(e) {\n        var _a, _b, _c, _d, _e;\n        if (!e.clipboardData || !this._editor.hasTextFocus()) {\n            return;\n        }\n        (_a = MessageController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.closeMessage();\n        (_b = this._currentPasteOperation) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._currentPasteOperation = undefined;\n        const model = this._editor.getModel();\n        const selections = this._editor.getSelections();\n        if (!(selections === null || selections === void 0 ? void 0 : selections.length) || !model) {\n            return;\n        }\n        if (!this.isPasteAsEnabled()\n            && !this._pasteAsActionContext // Still enable if paste as was explicitly requested\n        ) {\n            return;\n        }\n        const metadata = this.fetchCopyMetadata(e);\n        const dataTransfer = toExternalVSDataTransfer(e.clipboardData);\n        dataTransfer.delete(vscodeClipboardMime);\n        const allPotentialMimeTypes = [\n            ...e.clipboardData.types,\n            ...(_c = metadata === null || metadata === void 0 ? void 0 : metadata.providerCopyMimeTypes) !== null && _c !== void 0 ? _c : [],\n            // TODO: always adds `uri-list` because this get set if there are resources in the system clipboard.\n            // However we can only check the system clipboard async. For this early check, just add it in.\n            // We filter providers again once we have the final dataTransfer we will use.\n            Mimes.uriList,\n        ];\n        const allProviders = this._languageFeaturesService.documentPasteEditProvider\n            .ordered(model)\n            .filter(provider => {\n            var _a, _b;\n            if ((_a = this._pasteAsActionContext) === null || _a === void 0 ? void 0 : _a.preferredId) {\n                if (this._pasteAsActionContext.preferredId !== provider.id) {\n                    return false;\n                }\n            }\n            return (_b = provider.pasteMimeTypes) === null || _b === void 0 ? void 0 : _b.some(type => matchesMimeType(type, allPotentialMimeTypes));\n        });\n        if (!allProviders.length) {\n            if ((_d = this._pasteAsActionContext) === null || _d === void 0 ? void 0 : _d.preferredId) {\n                this.showPasteAsNoEditMessage(selections, (_e = this._pasteAsActionContext) === null || _e === void 0 ? void 0 : _e.preferredId);\n            }\n            return;\n        }\n        // Prevent the editor's default paste handler from running.\n        // Note that after this point, we are fully responsible for handling paste.\n        // If we can't provider a paste for any reason, we need to explicitly delegate pasting back to the editor.\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        if (this._pasteAsActionContext) {\n            this.showPasteAsPick(this._pasteAsActionContext.preferredId, allProviders, selections, dataTransfer, metadata, { trigger: 'explicit', only: this._pasteAsActionContext.preferredId });\n        }\n        else {\n            this.doPasteInline(allProviders, selections, dataTransfer, metadata, { trigger: 'implicit' });\n        }\n    }\n    showPasteAsNoEditMessage(selections, editId) {\n        var _a;\n        (_a = MessageController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.showMessage(localize('pasteAsError', \"No paste edits for '{0}' found\", editId), selections[0].getStartPosition());\n    }\n    doPasteInline(allProviders, selections, dataTransfer, metadata, context) {\n        const p = createCancelablePromise(async (token) => {\n            const editor = this._editor;\n            if (!editor.hasModel()) {\n                return;\n            }\n            const model = editor.getModel();\n            const tokenSource = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */, undefined, token);\n            try {\n                await this.mergeInDataFromCopy(dataTransfer, metadata, tokenSource.token);\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                // Filter out any providers the don't match the full data transfer we will send them.\n                const supportedProviders = allProviders.filter(provider => isSupportedPasteProvider(provider, dataTransfer));\n                if (!supportedProviders.length\n                    || (supportedProviders.length === 1 && supportedProviders[0].id === 'text') // Only our default text provider is active\n                ) {\n                    await this.applyDefaultPasteHandler(dataTransfer, metadata, tokenSource.token);\n                    return;\n                }\n                const providerEdits = await this.getPasteEdits(supportedProviders, dataTransfer, model, selections, context, tokenSource.token);\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                // If the only edit returned is a text edit, use the default paste handler\n                if (providerEdits.length === 1 && providerEdits[0].providerId === 'text') {\n                    await this.applyDefaultPasteHandler(dataTransfer, metadata, tokenSource.token);\n                    return;\n                }\n                if (providerEdits.length) {\n                    const canShowWidget = editor.getOption(85 /* EditorOption.pasteAs */).showPasteSelector === 'afterPaste';\n                    return this._postPasteWidgetManager.applyEditAndShowIfNeeded(selections, { activeEditIndex: 0, allEdits: providerEdits }, canShowWidget, tokenSource.token);\n                }\n                await this.applyDefaultPasteHandler(dataTransfer, metadata, tokenSource.token);\n            }\n            finally {\n                tokenSource.dispose();\n                if (this._currentPasteOperation === p) {\n                    this._currentPasteOperation = undefined;\n                }\n            }\n        });\n        this._pasteProgressManager.showWhile(selections[0].getEndPosition(), localize('pasteIntoEditorProgress', \"Running paste handlers. Click to cancel\"), p);\n        this._currentPasteOperation = p;\n    }\n    showPasteAsPick(preferredId, allProviders, selections, dataTransfer, metadata, context) {\n        const p = createCancelablePromise(async (token) => {\n            const editor = this._editor;\n            if (!editor.hasModel()) {\n                return;\n            }\n            const model = editor.getModel();\n            const tokenSource = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */, undefined, token);\n            try {\n                await this.mergeInDataFromCopy(dataTransfer, metadata, tokenSource.token);\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                // Filter out any providers the don't match the full data transfer we will send them.\n                let supportedProviders = allProviders.filter(provider => isSupportedPasteProvider(provider, dataTransfer));\n                if (preferredId) {\n                    // We are looking for a specific edit\n                    supportedProviders = supportedProviders.filter(edit => edit.id === preferredId);\n                }\n                const providerEdits = await this.getPasteEdits(supportedProviders, dataTransfer, model, selections, context, tokenSource.token);\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                if (!providerEdits.length) {\n                    if (context.only) {\n                        this.showPasteAsNoEditMessage(selections, context.only);\n                    }\n                    return;\n                }\n                let pickedEdit;\n                if (preferredId) {\n                    pickedEdit = providerEdits.at(0);\n                }\n                else {\n                    const selected = await this._quickInputService.pick(providerEdits.map((edit) => ({\n                        label: edit.label,\n                        description: edit.providerId,\n                        detail: edit.detail,\n                        edit,\n                    })), {\n                        placeHolder: localize('pasteAsPickerPlaceholder', \"Select Paste Action\"),\n                    });\n                    pickedEdit = selected === null || selected === void 0 ? void 0 : selected.edit;\n                }\n                if (!pickedEdit) {\n                    return;\n                }\n                const combinedWorkspaceEdit = createCombinedWorkspaceEdit(model.uri, selections, pickedEdit);\n                await this._bulkEditService.apply(combinedWorkspaceEdit, { editor: this._editor });\n            }\n            finally {\n                tokenSource.dispose();\n                if (this._currentPasteOperation === p) {\n                    this._currentPasteOperation = undefined;\n                }\n            }\n        });\n        this._progressService.withProgress({\n            location: 10 /* ProgressLocation.Window */,\n            title: localize('pasteAsProgress', \"Running paste handlers\"),\n        }, () => p);\n    }\n    setCopyMetadata(dataTransfer, metadata) {\n        dataTransfer.setData(vscodeClipboardMime, JSON.stringify(metadata));\n    }\n    fetchCopyMetadata(e) {\n        var _a;\n        if (!e.clipboardData) {\n            return;\n        }\n        // Prefer using the clipboard data we saved off\n        const rawMetadata = e.clipboardData.getData(vscodeClipboardMime);\n        if (rawMetadata) {\n            try {\n                return JSON.parse(rawMetadata);\n            }\n            catch (_b) {\n                return undefined;\n            }\n        }\n        // Otherwise try to extract the generic text editor metadata\n        const [_, metadata] = ClipboardEventUtils.getTextData(e.clipboardData);\n        if (metadata) {\n            return {\n                defaultPastePayload: {\n                    mode: metadata.mode,\n                    multicursorText: (_a = metadata.multicursorText) !== null && _a !== void 0 ? _a : null,\n                    pasteOnNewLine: !!metadata.isFromEmptySelection,\n                },\n            };\n        }\n        return undefined;\n    }\n    async mergeInDataFromCopy(dataTransfer, metadata, token) {\n        var _a;\n        if ((metadata === null || metadata === void 0 ? void 0 : metadata.id) && ((_a = this._currentCopyOperation) === null || _a === void 0 ? void 0 : _a.handle) === metadata.id) {\n            const toMergeDataTransfer = await this._currentCopyOperation.dataTransferPromise;\n            if (token.isCancellationRequested) {\n                return;\n            }\n            for (const [key, value] of toMergeDataTransfer) {\n                dataTransfer.replace(key, value);\n            }\n        }\n        if (!dataTransfer.has(Mimes.uriList)) {\n            const resources = await this._clipboardService.readResources();\n            if (token.isCancellationRequested) {\n                return;\n            }\n            if (resources.length) {\n                dataTransfer.append(Mimes.uriList, createStringDataTransferItem(UriList.create(resources)));\n            }\n        }\n    }\n    async getPasteEdits(providers, dataTransfer, model, selections, context, token) {\n        const results = await raceCancellation(Promise.all(providers.map(async (provider) => {\n            var _a;\n            try {\n                const edit = await ((_a = provider.provideDocumentPasteEdits) === null || _a === void 0 ? void 0 : _a.call(provider, model, selections, dataTransfer, context, token));\n                if (edit) {\n                    return { ...edit, providerId: provider.id };\n                }\n            }\n            catch (err) {\n                console.error(err);\n            }\n            return undefined;\n        })), token);\n        const edits = coalesce(results !== null && results !== void 0 ? results : []);\n        return sortEditsByYieldTo(edits);\n    }\n    async applyDefaultPasteHandler(dataTransfer, metadata, token) {\n        var _a, _b, _c;\n        const textDataTransfer = (_a = dataTransfer.get(Mimes.text)) !== null && _a !== void 0 ? _a : dataTransfer.get('text');\n        if (!textDataTransfer) {\n            return;\n        }\n        const text = await textDataTransfer.asString();\n        if (token.isCancellationRequested) {\n            return;\n        }\n        const payload = {\n            text,\n            pasteOnNewLine: (_b = metadata === null || metadata === void 0 ? void 0 : metadata.defaultPastePayload.pasteOnNewLine) !== null && _b !== void 0 ? _b : false,\n            multicursorText: (_c = metadata === null || metadata === void 0 ? void 0 : metadata.defaultPastePayload.multicursorText) !== null && _c !== void 0 ? _c : null,\n            mode: null,\n        };\n        this._editor.trigger('keyboard', \"paste\" /* Handler.Paste */, payload);\n    }\n};\nCopyPasteController.ID = 'editor.contrib.copyPasteActionController';\nCopyPasteController = CopyPasteController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IBulkEditService),\n    __param(3, IClipboardService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IQuickInputService),\n    __param(6, IProgressService)\n], CopyPasteController);\nexport { CopyPasteController };\nfunction isSupportedPasteProvider(provider, dataTransfer) {\n    var _a;\n    return Boolean((_a = provider.pasteMimeTypes) === null || _a === void 0 ? void 0 : _a.some(type => dataTransfer.matches(type)));\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { distinct } from './arrays.js';\nimport { Iterable } from './iterator.js';\nimport { generateUuid } from './uuid.js';\nexport function createStringDataTransferItem(stringOrPromise) {\n    return {\n        asString: async () => stringOrPromise,\n        asFile: () => undefined,\n        value: typeof stringOrPromise === 'string' ? stringOrPromise : undefined,\n    };\n}\nexport function createFileDataTransferItem(fileName, uri, data) {\n    const file = { id: generateUuid(), name: fileName, uri, data };\n    return {\n        asString: async () => '',\n        asFile: () => file,\n        value: undefined,\n    };\n}\nexport class VSDataTransfer {\n    constructor() {\n        this._entries = new Map();\n    }\n    get size() {\n        let size = 0;\n        for (const _ of this._entries) {\n            size++;\n        }\n        return size;\n    }\n    has(mimeType) {\n        return this._entries.has(this.toKey(mimeType));\n    }\n    matches(pattern) {\n        const mimes = [...this._entries.keys()];\n        if (Iterable.some(this, ([_, item]) => item.asFile())) {\n            mimes.push('files');\n        }\n        return matchesMimeType_normalized(normalizeMimeType(pattern), mimes);\n    }\n    get(mimeType) {\n        var _a;\n        return (_a = this._entries.get(this.toKey(mimeType))) === null || _a === void 0 ? void 0 : _a[0];\n    }\n    /**\n     * Add a new entry to this data transfer.\n     *\n     * This does not replace existing entries for `mimeType`.\n     */\n    append(mimeType, value) {\n        const existing = this._entries.get(mimeType);\n        if (existing) {\n            existing.push(value);\n        }\n        else {\n            this._entries.set(this.toKey(mimeType), [value]);\n        }\n    }\n    /**\n     * Set the entry for a given mime type.\n     *\n     * This replaces all existing entries for `mimeType`.\n     */\n    replace(mimeType, value) {\n        this._entries.set(this.toKey(mimeType), [value]);\n    }\n    /**\n     * Remove all entries for `mimeType`.\n     */\n    delete(mimeType) {\n        this._entries.delete(this.toKey(mimeType));\n    }\n    /**\n     * Iterate over all `[mime, item]` pairs in this data transfer.\n     *\n     * There may be multiple entries for each mime type.\n     */\n    *[Symbol.iterator]() {\n        for (const [mine, items] of this._entries) {\n            for (const item of items) {\n                yield [mine, item];\n            }\n        }\n    }\n    toKey(mimeType) {\n        return normalizeMimeType(mimeType);\n    }\n}\nfunction normalizeMimeType(mimeType) {\n    return mimeType.toLowerCase();\n}\nexport function matchesMimeType(pattern, mimeTypes) {\n    return matchesMimeType_normalized(normalizeMimeType(pattern), mimeTypes.map(normalizeMimeType));\n}\nfunction matchesMimeType_normalized(normalizedPattern, normalizedMimeTypes) {\n    // Anything wildcard\n    if (normalizedPattern === '*/*') {\n        return normalizedMimeTypes.length > 0;\n    }\n    // Exact match\n    if (normalizedMimeTypes.includes(normalizedPattern)) {\n        return true;\n    }\n    // Wildcard, such as `image/*`\n    const wildcard = normalizedPattern.match(/^([a-z]+)\\/([a-z]+|\\*)$/i);\n    if (!wildcard) {\n        return false;\n    }\n    const [_, type, subtype] = wildcard;\n    if (subtype === '*') {\n        return normalizedMimeTypes.some(mime => mime.startsWith(type + '/'));\n    }\n    return false;\n}\nexport const UriList = Object.freeze({\n    // http://amundsen.com/hypermedia/urilist/\n    create: (entries) => {\n        return distinct(entries.map(x => x.toString())).join('\\r\\n');\n    },\n    split: (str) => {\n        return str.split('\\r\\n');\n    },\n    parse: (str) => {\n        return UriList.split(str).filter(value => !value.startsWith('#'));\n    }\n});\n", "export const generateUuid = (function () {\n    // use `randomUUID` if possible\n    if (typeof crypto === 'object' && typeof crypto.randomUUID === 'function') {\n        return crypto.randomUUID.bind(crypto);\n    }\n    // use `randomValues` if possible\n    let getRandomValues;\n    if (typeof crypto === 'object' && typeof crypto.getRandomValues === 'function') {\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    else {\n        getRandomValues = function (bucket) {\n            for (let i = 0; i < bucket.length; i++) {\n                bucket[i] = Math.floor(Math.random() * 256);\n            }\n            return bucket;\n        };\n    }\n    // prep-work\n    const _data = new Uint8Array(16);\n    const _hex = [];\n    for (let i = 0; i < 256; i++) {\n        _hex.push(i.toString(16).padStart(2, '0'));\n    }\n    return function generateUuid() {\n        // get data\n        getRandomValues(_data);\n        // set version bits\n        _data[6] = (_data[6] & 0x0f) | 0x40;\n        _data[8] = (_data[8] & 0x3f) | 0x80;\n        // print as string\n        let i = 0;\n        let result = '';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += '-';\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        result += _hex[_data[i++]];\n        return result;\n    };\n})();\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DataTransfers } from '../../base/browser/dnd.js';\nimport { createFileDataTransferItem, createStringDataTransferItem, UriList, VSDataTransfer } from '../../base/common/dataTransfer.js';\nimport { Mimes } from '../../base/common/mime.js';\nimport { URI } from '../../base/common/uri.js';\nimport { CodeDataTransfers } from '../../platform/dnd/browser/dnd.js';\nexport function toVSDataTransfer(dataTransfer) {\n    const vsDataTransfer = new VSDataTransfer();\n    for (const item of dataTransfer.items) {\n        const type = item.type;\n        if (item.kind === 'string') {\n            const asStringValue = new Promise(resolve => item.getAsString(resolve));\n            vsDataTransfer.append(type, createStringDataTransferItem(asStringValue));\n        }\n        else if (item.kind === 'file') {\n            const file = item.getAsFile();\n            if (file) {\n                vsDataTransfer.append(type, createFileDataTransferItemFromFile(file));\n            }\n        }\n    }\n    return vsDataTransfer;\n}\nfunction createFileDataTransferItemFromFile(file) {\n    const uri = file.path ? URI.parse(file.path) : undefined;\n    return createFileDataTransferItem(file.name, uri, async () => {\n        return new Uint8Array(await file.arrayBuffer());\n    });\n}\nconst INTERNAL_DND_MIME_TYPES = Object.freeze([\n    CodeDataTransfers.EDITORS,\n    CodeDataTransfers.FILES,\n    DataTransfers.RESOURCES,\n    DataTransfers.INTERNAL_URI_LIST,\n]);\nexport function toExternalVSDataTransfer(sourceDataTransfer, overwriteUriList = false) {\n    const vsDataTransfer = toVSDataTransfer(sourceDataTransfer);\n    // Try to expose the internal uri-list type as the standard type\n    const uriList = vsDataTransfer.get(DataTransfers.INTERNAL_URI_LIST);\n    if (uriList) {\n        vsDataTransfer.replace(Mimes.uriList, uriList);\n    }\n    else {\n        if (overwriteUriList || !vsDataTransfer.has(Mimes.uriList)) {\n            // Otherwise, fallback to adding dragged resources to the uri list\n            const editorData = [];\n            for (const item of sourceDataTransfer.items) {\n                const file = item.getAsFile();\n                if (file) {\n                    const path = file.path;\n                    try {\n                        if (path) {\n                            editorData.push(URI.file(path).toString());\n                        }\n                        else {\n                            editorData.push(URI.parse(file.name, true).toString());\n                        }\n                    }\n                    catch (_a) {\n                        // Parsing failed. Leave out from list\n                    }\n                }\n            }\n            if (editorData.length) {\n                vsDataTransfer.replace(Mimes.uriList, createStringDataTransferItem(UriList.create(editorData)));\n            }\n        }\n    }\n    for (const internal of INTERNAL_DND_MIME_TYPES) {\n        vsDataTransfer.delete(internal);\n    }\n    return vsDataTransfer;\n}\n", "import { Registry } from '../../registry/common/platform.js';\n//#region Editor / Resources DND\nexport const CodeDataTransfers = {\n    EDITORS: 'CodeEditors',\n    FILES: 'CodeFiles'\n};\nclass DragAndDropContributionRegistry {\n}\nexport const Extensions = {\n    DragAndDropContribution: 'workbench.contributions.dragAndDrop'\n};\nRegistry.add(Extensions.DragAndDropContribution, new DragAndDropContributionRegistry());\n//#endregion\n//#region DND Utilities\n/**\n * A singleton to store transfer data during drag & drop operations that are only valid within the application.\n */\nexport class LocalSelectionTransfer {\n    constructor() {\n        // protect against external instantiation\n    }\n    static getInstance() {\n        return LocalSelectionTransfer.INSTANCE;\n    }\n    hasData(proto) {\n        return proto && proto === this.proto;\n    }\n    getData(proto) {\n        if (this.hasData(proto)) {\n            return this.data;\n        }\n        return undefined;\n    }\n}\nLocalSelectionTransfer.INSTANCE = new LocalSelectionTransfer();\n//#endregion\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class Scanner {\n    constructor() {\n        this.value = '';\n        this.pos = 0;\n    }\n    static isDigitCharacter(ch) {\n        return ch >= 48 /* CharCode.Digit0 */ && ch <= 57 /* CharCode.Digit9 */;\n    }\n    static isVariableCharacter(ch) {\n        return ch === 95 /* CharCode.Underline */\n            || (ch >= 97 /* CharCode.a */ && ch <= 122 /* CharCode.z */)\n            || (ch >= 65 /* CharCode.A */ && ch <= 90 /* CharCode.Z */);\n    }\n    text(value) {\n        this.value = value;\n        this.pos = 0;\n    }\n    tokenText(token) {\n        return this.value.substr(token.pos, token.len);\n    }\n    next() {\n        if (this.pos >= this.value.length) {\n            return { type: 14 /* TokenType.EOF */, pos: this.pos, len: 0 };\n        }\n        const pos = this.pos;\n        let len = 0;\n        let ch = this.value.charCodeAt(pos);\n        let type;\n        // static types\n        type = Scanner._table[ch];\n        if (typeof type === 'number') {\n            this.pos += 1;\n            return { type, pos, len: 1 };\n        }\n        // number\n        if (Scanner.isDigitCharacter(ch)) {\n            type = 8 /* TokenType.Int */;\n            do {\n                len += 1;\n                ch = this.value.charCodeAt(pos + len);\n            } while (Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // variable name\n        if (Scanner.isVariableCharacter(ch)) {\n            type = 9 /* TokenType.VariableName */;\n            do {\n                ch = this.value.charCodeAt(pos + (++len));\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // format\n        type = 10 /* TokenType.Format */;\n        do {\n            len += 1;\n            ch = this.value.charCodeAt(pos + len);\n        } while (!isNaN(ch)\n            && typeof Scanner._table[ch] === 'undefined' // not static token\n            && !Scanner.isDigitCharacter(ch) // not number\n            && !Scanner.isVariableCharacter(ch) // not variable\n        );\n        this.pos += len;\n        return { type, pos, len };\n    }\n}\nScanner._table = {\n    [36 /* CharCode.DollarSign */]: 0 /* TokenType.Dollar */,\n    [58 /* CharCode.Colon */]: 1 /* TokenType.Colon */,\n    [44 /* CharCode.Comma */]: 2 /* TokenType.Comma */,\n    [123 /* CharCode.OpenCurlyBrace */]: 3 /* TokenType.CurlyOpen */,\n    [125 /* CharCode.CloseCurlyBrace */]: 4 /* TokenType.CurlyClose */,\n    [92 /* CharCode.Backslash */]: 5 /* TokenType.Backslash */,\n    [47 /* CharCode.Slash */]: 6 /* TokenType.Forwardslash */,\n    [124 /* CharCode.Pipe */]: 7 /* TokenType.Pipe */,\n    [43 /* CharCode.Plus */]: 11 /* TokenType.Plus */,\n    [45 /* CharCode.Dash */]: 12 /* TokenType.Dash */,\n    [63 /* CharCode.QuestionMark */]: 13 /* TokenType.QuestionMark */,\n};\nexport class Marker {\n    constructor() {\n        this._children = [];\n    }\n    appendChild(child) {\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\n            // this and previous child are text -> merge them\n            this._children[this._children.length - 1].value += child.value;\n        }\n        else {\n            // normal adoption of child\n            child.parent = this;\n            this._children.push(child);\n        }\n        return this;\n    }\n    replace(child, others) {\n        const { parent } = child;\n        const idx = parent.children.indexOf(child);\n        const newChildren = parent.children.slice(0);\n        newChildren.splice(idx, 1, ...others);\n        parent._children = newChildren;\n        (function _fixParent(children, parent) {\n            for (const child of children) {\n                child.parent = parent;\n                _fixParent(child.children, child);\n            }\n        })(others, parent);\n    }\n    get children() {\n        return this._children;\n    }\n    get rightMostDescendant() {\n        if (this._children.length > 0) {\n            return this._children[this._children.length - 1].rightMostDescendant;\n        }\n        return this;\n    }\n    get snippet() {\n        let candidate = this;\n        while (true) {\n            if (!candidate) {\n                return undefined;\n            }\n            if (candidate instanceof TextmateSnippet) {\n                return candidate;\n            }\n            candidate = candidate.parent;\n        }\n    }\n    toString() {\n        return this.children.reduce((prev, cur) => prev + cur.toString(), '');\n    }\n    len() {\n        return 0;\n    }\n}\nexport class Text extends Marker {\n    constructor(value) {\n        super();\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n    len() {\n        return this.value.length;\n    }\n    clone() {\n        return new Text(this.value);\n    }\n}\nexport class TransformableMarker extends Marker {\n}\nexport class Placeholder extends TransformableMarker {\n    static compareByIndex(a, b) {\n        if (a.index === b.index) {\n            return 0;\n        }\n        else if (a.isFinalTabstop) {\n            return 1;\n        }\n        else if (b.isFinalTabstop) {\n            return -1;\n        }\n        else if (a.index < b.index) {\n            return -1;\n        }\n        else if (a.index > b.index) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    constructor(index) {\n        super();\n        this.index = index;\n    }\n    get isFinalTabstop() {\n        return this.index === 0;\n    }\n    get choice() {\n        return this._children.length === 1 && this._children[0] instanceof Choice\n            ? this._children[0]\n            : undefined;\n    }\n    clone() {\n        const ret = new Placeholder(this.index);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class Choice extends Marker {\n    constructor() {\n        super(...arguments);\n        this.options = [];\n    }\n    appendChild(marker) {\n        if (marker instanceof Text) {\n            marker.parent = this;\n            this.options.push(marker);\n        }\n        return this;\n    }\n    toString() {\n        return this.options[0].value;\n    }\n    len() {\n        return this.options[0].len();\n    }\n    clone() {\n        const ret = new Choice();\n        this.options.forEach(ret.appendChild, ret);\n        return ret;\n    }\n}\nexport class Transform extends Marker {\n    constructor() {\n        super(...arguments);\n        this.regexp = new RegExp('');\n    }\n    resolve(value) {\n        const _this = this;\n        let didMatch = false;\n        let ret = value.replace(this.regexp, function () {\n            didMatch = true;\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\n        });\n        // when the regex didn't match and when the transform has\n        // else branches, then run those\n        if (!didMatch && this._children.some(child => child instanceof FormatString && Boolean(child.elseValue))) {\n            ret = this._replace([]);\n        }\n        return ret;\n    }\n    _replace(groups) {\n        let ret = '';\n        for (const marker of this._children) {\n            if (marker instanceof FormatString) {\n                let value = groups[marker.index] || '';\n                value = marker.resolve(value);\n                ret += value;\n            }\n            else {\n                ret += marker.toString();\n            }\n        }\n        return ret;\n    }\n    toString() {\n        return '';\n    }\n    clone() {\n        const ret = new Transform();\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class FormatString extends Marker {\n    constructor(index, shorthandName, ifValue, elseValue) {\n        super();\n        this.index = index;\n        this.shorthandName = shorthandName;\n        this.ifValue = ifValue;\n        this.elseValue = elseValue;\n    }\n    resolve(value) {\n        if (this.shorthandName === 'upcase') {\n            return !value ? '' : value.toLocaleUpperCase();\n        }\n        else if (this.shorthandName === 'downcase') {\n            return !value ? '' : value.toLocaleLowerCase();\n        }\n        else if (this.shorthandName === 'capitalize') {\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\n        }\n        else if (this.shorthandName === 'pascalcase') {\n            return !value ? '' : this._toPascalCase(value);\n        }\n        else if (this.shorthandName === 'camelcase') {\n            return !value ? '' : this._toCamelCase(value);\n        }\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\n            return this.ifValue;\n        }\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\n            return this.elseValue;\n        }\n        else {\n            return value || '';\n        }\n    }\n    _toPascalCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map(word => {\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    _toCamelCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map((word, index) => {\n            if (index === 0) {\n                return word.charAt(0).toLowerCase() + word.substr(1);\n            }\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    clone() {\n        const ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\n        return ret;\n    }\n}\nexport class Variable extends TransformableMarker {\n    constructor(name) {\n        super();\n        this.name = name;\n    }\n    resolve(resolver) {\n        let value = resolver.resolve(this);\n        if (this.transform) {\n            value = this.transform.resolve(value || '');\n        }\n        if (value !== undefined) {\n            this._children = [new Text(value)];\n            return true;\n        }\n        return false;\n    }\n    clone() {\n        const ret = new Variable(this.name);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nfunction walk(marker, visitor) {\n    const stack = [...marker];\n    while (stack.length > 0) {\n        const marker = stack.shift();\n        const recurse = visitor(marker);\n        if (!recurse) {\n            break;\n        }\n        stack.unshift(...marker.children);\n    }\n}\nexport class TextmateSnippet extends Marker {\n    get placeholderInfo() {\n        if (!this._placeholders) {\n            // fill in placeholders\n            const all = [];\n            let last;\n            this.walk(function (candidate) {\n                if (candidate instanceof Placeholder) {\n                    all.push(candidate);\n                    last = !last || last.index < candidate.index ? candidate : last;\n                }\n                return true;\n            });\n            this._placeholders = { all, last };\n        }\n        return this._placeholders;\n    }\n    get placeholders() {\n        const { all } = this.placeholderInfo;\n        return all;\n    }\n    offset(marker) {\n        let pos = 0;\n        let found = false;\n        this.walk(candidate => {\n            if (candidate === marker) {\n                found = true;\n                return false;\n            }\n            pos += candidate.len();\n            return true;\n        });\n        if (!found) {\n            return -1;\n        }\n        return pos;\n    }\n    fullLen(marker) {\n        let ret = 0;\n        walk([marker], marker => {\n            ret += marker.len();\n            return true;\n        });\n        return ret;\n    }\n    enclosingPlaceholders(placeholder) {\n        const ret = [];\n        let { parent } = placeholder;\n        while (parent) {\n            if (parent instanceof Placeholder) {\n                ret.push(parent);\n            }\n            parent = parent.parent;\n        }\n        return ret;\n    }\n    resolveVariables(resolver) {\n        this.walk(candidate => {\n            if (candidate instanceof Variable) {\n                if (candidate.resolve(resolver)) {\n                    this._placeholders = undefined;\n                }\n            }\n            return true;\n        });\n        return this;\n    }\n    appendChild(child) {\n        this._placeholders = undefined;\n        return super.appendChild(child);\n    }\n    replace(child, others) {\n        this._placeholders = undefined;\n        return super.replace(child, others);\n    }\n    clone() {\n        const ret = new TextmateSnippet();\n        this._children = this.children.map(child => child.clone());\n        return ret;\n    }\n    walk(visitor) {\n        walk(this.children, visitor);\n    }\n}\nexport class SnippetParser {\n    constructor() {\n        this._scanner = new Scanner();\n        this._token = { type: 14 /* TokenType.EOF */, pos: 0, len: 0 };\n    }\n    static escape(value) {\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\n    }\n    static guessNeedsClipboard(template) {\n        return /\\${?CLIPBOARD/.test(template);\n    }\n    parse(value, insertFinalTabstop, enforceFinalTabstop) {\n        const snippet = new TextmateSnippet();\n        this.parseFragment(value, snippet);\n        this.ensureFinalTabstop(snippet, enforceFinalTabstop !== null && enforceFinalTabstop !== void 0 ? enforceFinalTabstop : false, insertFinalTabstop !== null && insertFinalTabstop !== void 0 ? insertFinalTabstop : false);\n        return snippet;\n    }\n    parseFragment(value, snippet) {\n        const offset = snippet.children.length;\n        this._scanner.text(value);\n        this._token = this._scanner.next();\n        while (this._parse(snippet)) {\n            // nothing\n        }\n        // fill in values for placeholders. the first placeholder of an index\n        // that has a value defines the value for all placeholders with that index\n        const placeholderDefaultValues = new Map();\n        const incompletePlaceholders = [];\n        snippet.walk(marker => {\n            if (marker instanceof Placeholder) {\n                if (marker.isFinalTabstop) {\n                    placeholderDefaultValues.set(0, undefined);\n                }\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\n                    placeholderDefaultValues.set(marker.index, marker.children);\n                }\n                else {\n                    incompletePlaceholders.push(marker);\n                }\n            }\n            return true;\n        });\n        const fillInIncompletePlaceholder = (placeholder, stack) => {\n            const defaultValues = placeholderDefaultValues.get(placeholder.index);\n            if (!defaultValues) {\n                return;\n            }\n            const clone = new Placeholder(placeholder.index);\n            clone.transform = placeholder.transform;\n            for (const child of defaultValues) {\n                const newChild = child.clone();\n                clone.appendChild(newChild);\n                // \"recurse\" on children that are again placeholders\n                if (newChild instanceof Placeholder && placeholderDefaultValues.has(newChild.index) && !stack.has(newChild.index)) {\n                    stack.add(newChild.index);\n                    fillInIncompletePlaceholder(newChild, stack);\n                    stack.delete(newChild.index);\n                }\n            }\n            snippet.replace(placeholder, [clone]);\n        };\n        const stack = new Set();\n        for (const placeholder of incompletePlaceholders) {\n            fillInIncompletePlaceholder(placeholder, stack);\n        }\n        return snippet.children.slice(offset);\n    }\n    ensureFinalTabstop(snippet, enforceFinalTabstop, insertFinalTabstop) {\n        if (enforceFinalTabstop || insertFinalTabstop && snippet.placeholders.length > 0) {\n            const finalTabstop = snippet.placeholders.find(p => p.index === 0);\n            if (!finalTabstop) {\n                // the snippet uses placeholders but has no\n                // final tabstop defined -> insert at the end\n                snippet.appendChild(new Placeholder(0));\n            }\n        }\n    }\n    _accept(type, value) {\n        if (type === undefined || this._token.type === type) {\n            const ret = !value ? true : this._scanner.tokenText(this._token);\n            this._token = this._scanner.next();\n            return ret;\n        }\n        return false;\n    }\n    _backTo(token) {\n        this._scanner.pos = token.pos + token.len;\n        this._token = token;\n        return false;\n    }\n    _until(type) {\n        const start = this._token;\n        while (this._token.type !== type) {\n            if (this._token.type === 14 /* TokenType.EOF */) {\n                return false;\n            }\n            else if (this._token.type === 5 /* TokenType.Backslash */) {\n                const nextToken = this._scanner.next();\n                if (nextToken.type !== 0 /* TokenType.Dollar */\n                    && nextToken.type !== 4 /* TokenType.CurlyClose */\n                    && nextToken.type !== 5 /* TokenType.Backslash */) {\n                    return false;\n                }\n            }\n            this._token = this._scanner.next();\n        }\n        const value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\n        this._token = this._scanner.next();\n        return value;\n    }\n    _parse(marker) {\n        return this._parseEscaped(marker)\n            || this._parseTabstopOrVariableName(marker)\n            || this._parseComplexPlaceholder(marker)\n            || this._parseComplexVariable(marker)\n            || this._parseAnything(marker);\n    }\n    // \\$, \\\\, \\} -> just text\n    _parseEscaped(marker) {\n        let value;\n        if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n            // saw a backslash, append escaped token or that backslash\n            value = this._accept(0 /* TokenType.Dollar */, true)\n                || this._accept(4 /* TokenType.CurlyClose */, true)\n                || this._accept(5 /* TokenType.Backslash */, true)\n                || value;\n            marker.appendChild(new Text(value));\n            return true;\n        }\n        return false;\n    }\n    // $foo -> variable, $1 -> tabstop\n    _parseTabstopOrVariableName(parent) {\n        let value;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && (value = this._accept(9 /* TokenType.VariableName */, true) || this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        parent.appendChild(/^\\d+$/.test(value)\n            ? new Placeholder(Number(value))\n            : new Variable(value));\n        return true;\n    }\n    // ${1:<children>}, ${1} -> placeholder\n    _parseComplexPlaceholder(parent) {\n        let index;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (index = this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const placeholder = new Placeholder(Number(index));\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${1:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(placeholder);\n                    return true;\n                }\n                if (this._parse(placeholder)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + index + ':'));\n                placeholder.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (placeholder.index > 0 && this._accept(7 /* TokenType.Pipe */)) {\n            // ${1|one,two,three|}\n            const choice = new Choice();\n            while (true) {\n                if (this._parseChoiceElement(choice)) {\n                    if (this._accept(2 /* TokenType.Comma */)) {\n                        // opt, -> more\n                        continue;\n                    }\n                    if (this._accept(7 /* TokenType.Pipe */)) {\n                        placeholder.appendChild(choice);\n                        if (this._accept(4 /* TokenType.CurlyClose */)) {\n                            // ..|} -> done\n                            parent.appendChild(placeholder);\n                            return true;\n                        }\n                    }\n                }\n                this._backTo(token);\n                return false;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1/<regex>/<format>/<options>}\n            if (this._parseTransform(placeholder)) {\n                parent.appendChild(placeholder);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(placeholder);\n            return true;\n        }\n        else {\n            // ${1 <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseChoiceElement(parent) {\n        const token = this._token;\n        const values = [];\n        while (true) {\n            if (this._token.type === 2 /* TokenType.Comma */ || this._token.type === 7 /* TokenType.Pipe */) {\n                break;\n            }\n            let value;\n            if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n                // \\, \\|, or \\\\\n                value = this._accept(2 /* TokenType.Comma */, true)\n                    || this._accept(7 /* TokenType.Pipe */, true)\n                    || this._accept(5 /* TokenType.Backslash */, true)\n                    || value;\n            }\n            else {\n                value = this._accept(undefined, true);\n            }\n            if (!value) {\n                // EOF\n                this._backTo(token);\n                return false;\n            }\n            values.push(value);\n        }\n        if (values.length === 0) {\n            this._backTo(token);\n            return false;\n        }\n        parent.appendChild(new Text(values.join('')));\n        return true;\n    }\n    // ${foo:<children>}, ${foo} -> variable\n    _parseComplexVariable(parent) {\n        let name;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (name = this._accept(9 /* TokenType.VariableName */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const variable = new Variable(name);\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${foo:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(variable);\n                    return true;\n                }\n                if (this._parse(variable)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + name + ':'));\n                variable.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${foo/<regex>/<format>/<options>}\n            if (this._parseTransform(variable)) {\n                parent.appendChild(variable);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${foo}\n            parent.appendChild(variable);\n            return true;\n        }\n        else {\n            // ${foo <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseTransform(parent) {\n        // ...<regex>/<format>/<options>}\n        const transform = new Transform();\n        let regexValue = '';\n        let regexOptions = '';\n        // (1) /regex\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                regexValue += escaped;\n                continue;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexValue += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        // (2) /format\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(5 /* TokenType.Backslash */, true) || this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                transform.appendChild(new Text(escaped));\n                continue;\n            }\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\n                continue;\n            }\n            return false;\n        }\n        // (3) /option\n        while (true) {\n            if (this._accept(4 /* TokenType.CurlyClose */)) {\n                break;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexOptions += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        try {\n            transform.regexp = new RegExp(regexValue, regexOptions);\n        }\n        catch (e) {\n            // invalid regexp\n            return false;\n        }\n        parent.transform = transform;\n        return true;\n    }\n    _parseFormatString(parent) {\n        const token = this._token;\n        if (!this._accept(0 /* TokenType.Dollar */)) {\n            return false;\n        }\n        let complex = false;\n        if (this._accept(3 /* TokenType.CurlyOpen */)) {\n            complex = true;\n        }\n        const index = this._accept(8 /* TokenType.Int */, true);\n        if (!index) {\n            this._backTo(token);\n            return false;\n        }\n        else if (!complex) {\n            // $1\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (!this._accept(1 /* TokenType.Colon */)) {\n            this._backTo(token);\n            return false;\n        }\n        if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1:/upcase}\n            const shorthand = this._accept(9 /* TokenType.VariableName */, true);\n            if (!shorthand || !this._accept(4 /* TokenType.CurlyClose */)) {\n                this._backTo(token);\n                return false;\n            }\n            else {\n                parent.appendChild(new FormatString(Number(index), shorthand));\n                return true;\n            }\n        }\n        else if (this._accept(11 /* TokenType.Plus */)) {\n            // ${1:+<if>}\n            const ifValue = this._until(4 /* TokenType.CurlyClose */);\n            if (ifValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\n                return true;\n            }\n        }\n        else if (this._accept(12 /* TokenType.Dash */)) {\n            // ${2:-<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        else if (this._accept(13 /* TokenType.QuestionMark */)) {\n            // ${2:?<if>:<else>}\n            const ifValue = this._until(1 /* TokenType.Colon */);\n            if (ifValue) {\n                const elseValue = this._until(4 /* TokenType.CurlyClose */);\n                if (elseValue) {\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\n                    return true;\n                }\n            }\n        }\n        else {\n            // ${1:<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        this._backTo(token);\n        return false;\n    }\n    _parseAnything(marker) {\n        if (this._token.type !== 14 /* TokenType.EOF */) {\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\n            this._accept(undefined);\n            return true;\n        }\n        return false;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ResourceTextEdit } from '../../../browser/services/bulkEditService.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\n/**\n * Given a {@link DropOrPasteEdit} and set of ranges, creates a {@link WorkspaceEdit} that applies the insert text from\n * the {@link DropOrPasteEdit} at each range plus any additional edits.\n */\nexport function createCombinedWorkspaceEdit(uri, ranges, edit) {\n    var _a, _b, _c, _d;\n    // If the edit insert text is empty, skip applying at each range\n    if (typeof edit.insertText === 'string' ? edit.insertText === '' : edit.insertText.snippet === '') {\n        return {\n            edits: (_b = (_a = edit.additionalEdit) === null || _a === void 0 ? void 0 : _a.edits) !== null && _b !== void 0 ? _b : []\n        };\n    }\n    return {\n        edits: [\n            ...ranges.map(range => new ResourceTextEdit(uri, { range, text: typeof edit.insertText === 'string' ? SnippetParser.escape(edit.insertText) + '$0' : edit.insertText.snippet, insertAsSnippet: true })),\n            ...((_d = (_c = edit.additionalEdit) === null || _c === void 0 ? void 0 : _c.edits) !== null && _d !== void 0 ? _d : [])\n        ]\n    };\n}\nexport function sortEditsByYieldTo(edits) {\n    var _a;\n    function yieldsTo(yTo, other) {\n        return ('providerId' in yTo && yTo.providerId === other.providerId)\n            || ('mimeType' in yTo && yTo.mimeType === other.handledMimeType);\n    }\n    // Build list of nodes each node yields to\n    const yieldsToMap = new Map();\n    for (const edit of edits) {\n        for (const yTo of (_a = edit.yieldTo) !== null && _a !== void 0 ? _a : []) {\n            for (const other of edits) {\n                if (other === edit) {\n                    continue;\n                }\n                if (yieldsTo(yTo, other)) {\n                    let arr = yieldsToMap.get(edit);\n                    if (!arr) {\n                        arr = [];\n                        yieldsToMap.set(edit, arr);\n                    }\n                    arr.push(other);\n                }\n            }\n        }\n    }\n    if (!yieldsToMap.size) {\n        return Array.from(edits);\n    }\n    // Topological sort\n    const visited = new Set();\n    const tempStack = [];\n    function visit(nodes) {\n        if (!nodes.length) {\n            return [];\n        }\n        const node = nodes[0];\n        if (tempStack.includes(node)) {\n            console.warn(`Yield to cycle detected for ${node.providerId}`);\n            return nodes;\n        }\n        if (visited.has(node)) {\n            return visit(nodes.slice(1));\n        }\n        let pre = [];\n        const yTo = yieldsToMap.get(node);\n        if (yTo) {\n            tempStack.push(node);\n            pre = visit(yTo);\n            tempStack.pop();\n        }\n        visited.add(node);\n        return [...pre, node, ...visit(nodes.slice(1))];\n    }\n    return visit(Array.from(edits));\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { disposableTimeout } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { noBreakWhitespace } from '../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './inlineProgressWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nconst inlineProgressDecoration = ModelDecorationOptions.register({\n    description: 'inline-progress-widget',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    showIfCollapsed: true,\n    after: {\n        content: noBreakWhitespace,\n        inlineClassName: 'inline-editor-progress-decoration',\n        inlineClassNameAffectsLetterSpacing: true,\n    }\n});\nclass InlineProgressWidget extends Disposable {\n    constructor(typeId, editor, range, title, delegate) {\n        super();\n        this.typeId = typeId;\n        this.editor = editor;\n        this.range = range;\n        this.delegate = delegate;\n        this.allowEditorOverflow = false;\n        this.suppressMouseDown = true;\n        this.create(title);\n        this.editor.addContentWidget(this);\n        this.editor.layoutContentWidget(this);\n    }\n    create(title) {\n        this.domNode = dom.$('.inline-progress-widget');\n        this.domNode.role = 'button';\n        this.domNode.title = title;\n        const iconElement = dom.$('span.icon');\n        this.domNode.append(iconElement);\n        iconElement.classList.add(...ThemeIcon.asClassNameArray(Codicon.loading), 'codicon-modifier-spin');\n        const updateSize = () => {\n            const lineHeight = this.editor.getOption(67 /* EditorOption.lineHeight */);\n            this.domNode.style.height = `${lineHeight}px`;\n            this.domNode.style.width = `${Math.ceil(0.8 * lineHeight)}px`;\n        };\n        updateSize();\n        this._register(this.editor.onDidChangeConfiguration(c => {\n            if (c.hasChanged(52 /* EditorOption.fontSize */) || c.hasChanged(67 /* EditorOption.lineHeight */)) {\n                updateSize();\n            }\n        }));\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.CLICK, e => {\n            this.delegate.cancel();\n        }));\n    }\n    getId() {\n        return InlineProgressWidget.baseId + '.' + this.typeId;\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    getPosition() {\n        return {\n            position: { lineNumber: this.range.startLineNumber, column: this.range.startColumn },\n            preference: [0 /* ContentWidgetPositionPreference.EXACT */]\n        };\n    }\n    dispose() {\n        super.dispose();\n        this.editor.removeContentWidget(this);\n    }\n}\nInlineProgressWidget.baseId = 'editor.widget.inlineProgressWidget';\nlet InlineProgressManager = class InlineProgressManager extends Disposable {\n    constructor(id, _editor, _instantiationService) {\n        super();\n        this.id = id;\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        /** Delay before showing the progress widget */\n        this._showDelay = 500; // ms\n        this._showPromise = this._register(new MutableDisposable());\n        this._currentWidget = new MutableDisposable();\n        this._operationIdPool = 0;\n        this._currentDecorations = _editor.createDecorationsCollection();\n    }\n    async showWhile(position, title, promise) {\n        const operationId = this._operationIdPool++;\n        this._currentOperation = operationId;\n        this.clear();\n        this._showPromise.value = disposableTimeout(() => {\n            const range = Range.fromPositions(position);\n            const decorationIds = this._currentDecorations.set([{\n                    range: range,\n                    options: inlineProgressDecoration,\n                }]);\n            if (decorationIds.length > 0) {\n                this._currentWidget.value = this._instantiationService.createInstance(InlineProgressWidget, this.id, this._editor, range, title, promise);\n            }\n        }, this._showDelay);\n        try {\n            return await promise;\n        }\n        finally {\n            if (this._currentOperation === operationId) {\n                this.clear();\n                this._currentOperation = undefined;\n            }\n        }\n    }\n    clear() {\n        this._showPromise.clear();\n        this._currentDecorations.clear();\n        this._currentWidget.clear();\n    }\n};\nInlineProgressManager = __decorate([\n    __param(2, IInstantiationService)\n], InlineProgressManager);\nexport { InlineProgressManager };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar PostEditWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Button } from '../../../../base/browser/ui/button/button.js';\nimport { toAction } from '../../../../base/common/actions.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport './postEditWidget.css';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { createCombinedWorkspaceEdit } from './edit.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nlet PostEditWidget = PostEditWidget_1 = class PostEditWidget extends Disposable {\n    constructor(typeId, editor, visibleContext, showCommand, range, edits, onSelectNewEdit, _contextMenuService, contextKeyService, _keybindingService) {\n        super();\n        this.typeId = typeId;\n        this.editor = editor;\n        this.showCommand = showCommand;\n        this.range = range;\n        this.edits = edits;\n        this.onSelectNewEdit = onSelectNewEdit;\n        this._contextMenuService = _contextMenuService;\n        this._keybindingService = _keybindingService;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = true;\n        this.create();\n        this.visibleContext = visibleContext.bindTo(contextKeyService);\n        this.visibleContext.set(true);\n        this._register(toDisposable(() => this.visibleContext.reset()));\n        this.editor.addContentWidget(this);\n        this.editor.layoutContentWidget(this);\n        this._register(toDisposable((() => this.editor.removeContentWidget(this))));\n        this._register(this.editor.onDidChangeCursorPosition(e => {\n            if (!range.containsPosition(e.position)) {\n                this.dispose();\n            }\n        }));\n        this._register(Event.runAndSubscribe(_keybindingService.onDidUpdateKeybindings, () => {\n            this._updateButtonTitle();\n        }));\n    }\n    _updateButtonTitle() {\n        var _a;\n        const binding = (_a = this._keybindingService.lookupKeybinding(this.showCommand.id)) === null || _a === void 0 ? void 0 : _a.getLabel();\n        this.button.element.title = this.showCommand.label + (binding ? ` (${binding})` : '');\n    }\n    create() {\n        this.domNode = dom.$('.post-edit-widget');\n        this.button = this._register(new Button(this.domNode, {\n            supportIcons: true,\n        }));\n        this.button.label = '$(insert)';\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.CLICK, () => this.showSelector()));\n    }\n    getId() {\n        return PostEditWidget_1.baseId + '.' + this.typeId;\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    getPosition() {\n        return {\n            position: this.range.getEndPosition(),\n            preference: [2 /* ContentWidgetPositionPreference.BELOW */]\n        };\n    }\n    showSelector() {\n        this._contextMenuService.showContextMenu({\n            getAnchor: () => {\n                const pos = dom.getDomNodePagePosition(this.button.element);\n                return { x: pos.left + pos.width, y: pos.top + pos.height };\n            },\n            getActions: () => {\n                return this.edits.allEdits.map((edit, i) => toAction({\n                    id: '',\n                    label: edit.label,\n                    checked: i === this.edits.activeEditIndex,\n                    run: () => {\n                        if (i !== this.edits.activeEditIndex) {\n                            return this.onSelectNewEdit(i);\n                        }\n                    },\n                }));\n            }\n        });\n    }\n};\nPostEditWidget.baseId = 'editor.widget.postEditWidget';\nPostEditWidget = PostEditWidget_1 = __decorate([\n    __param(7, IContextMenuService),\n    __param(8, IContextKeyService),\n    __param(9, IKeybindingService)\n], PostEditWidget);\nlet PostEditWidgetManager = class PostEditWidgetManager extends Disposable {\n    constructor(_id, _editor, _visibleContext, _showCommand, _instantiationService, _bulkEditService) {\n        super();\n        this._id = _id;\n        this._editor = _editor;\n        this._visibleContext = _visibleContext;\n        this._showCommand = _showCommand;\n        this._instantiationService = _instantiationService;\n        this._bulkEditService = _bulkEditService;\n        this._currentWidget = this._register(new MutableDisposable());\n        this._register(Event.any(_editor.onDidChangeModel, _editor.onDidChangeModelContent)(() => this.clear()));\n    }\n    async applyEditAndShowIfNeeded(ranges, edits, canShowWidget, token) {\n        const model = this._editor.getModel();\n        if (!model || !ranges.length) {\n            return;\n        }\n        const edit = edits.allEdits[edits.activeEditIndex];\n        if (!edit) {\n            return;\n        }\n        const combinedWorkspaceEdit = createCombinedWorkspaceEdit(model.uri, ranges, edit);\n        // Use a decoration to track edits around the trigger range\n        const primaryRange = ranges[0];\n        const editTrackingDecoration = model.deltaDecorations([], [{\n                range: primaryRange,\n                options: { description: 'paste-line-suffix', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */ }\n            }]);\n        let editResult;\n        let editRange;\n        try {\n            editResult = await this._bulkEditService.apply(combinedWorkspaceEdit, { editor: this._editor, token });\n            editRange = model.getDecorationRange(editTrackingDecoration[0]);\n        }\n        finally {\n            model.deltaDecorations(editTrackingDecoration, []);\n        }\n        if (canShowWidget && editResult.isApplied && edits.allEdits.length > 1) {\n            this.show(editRange !== null && editRange !== void 0 ? editRange : primaryRange, edits, async (newEditIndex) => {\n                const model = this._editor.getModel();\n                if (!model) {\n                    return;\n                }\n                await model.undo();\n                this.applyEditAndShowIfNeeded(ranges, { activeEditIndex: newEditIndex, allEdits: edits.allEdits }, canShowWidget, token);\n            });\n        }\n    }\n    show(range, edits, onDidSelectEdit) {\n        this.clear();\n        if (this._editor.hasModel()) {\n            this._currentWidget.value = this._instantiationService.createInstance(PostEditWidget, this._id, this._editor, this._visibleContext, this._showCommand, range, edits, onDidSelectEdit);\n        }\n    }\n    clear() {\n        this._currentWidget.clear();\n    }\n    tryShowSelector() {\n        var _a;\n        (_a = this._currentWidget.value) === null || _a === void 0 ? void 0 : _a.showSelector();\n    }\n};\nPostEditWidgetManager = __decorate([\n    __param(4, IInstantiationService),\n    __param(5, IBulkEditService)\n], PostEditWidgetManager);\nexport { PostEditWidgetManager };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MessageController_1;\nimport { renderMarkdown } from '../../../../base/browser/markdownRenderer.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { isMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport './messageController.css';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { openLinkFromMarkdown } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport * as dom from '../../../../base/browser/dom.js';\nlet MessageController = MessageController_1 = class MessageController {\n    static get(editor) {\n        return editor.getContribution(MessageController_1.ID);\n    }\n    constructor(editor, contextKeyService, _openerService) {\n        this._openerService = _openerService;\n        this._messageWidget = new MutableDisposable();\n        this._messageListeners = new DisposableStore();\n        this._mouseOverMessage = false;\n        this._editor = editor;\n        this._visible = MessageController_1.MESSAGE_VISIBLE.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a;\n        (_a = this._message) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._messageListeners.dispose();\n        this._messageWidget.dispose();\n        this._visible.reset();\n    }\n    showMessage(message, position) {\n        alert(isMarkdownString(message) ? message.value : message);\n        this._visible.set(true);\n        this._messageWidget.clear();\n        this._messageListeners.clear();\n        this._message = isMarkdownString(message) ? renderMarkdown(message, {\n            actionHandler: {\n                callback: (url) => {\n                    this.closeMessage();\n                    openLinkFromMarkdown(this._openerService, url, isMarkdownString(message) ? message.isTrusted : undefined);\n                },\n                disposables: this._messageListeners\n            },\n        }) : undefined;\n        this._messageWidget.value = new MessageWidget(this._editor, position, typeof message === 'string' ? message : this._message.element);\n        // close on blur (debounced to allow to tab into the message), cursor, model change, dispose\n        this._messageListeners.add(Event.debounce(this._editor.onDidBlurEditorText, (last, event) => event, 0)(() => {\n            if (this._mouseOverMessage) {\n                return; // override when mouse over message\n            }\n            if (this._messageWidget.value && dom.isAncestor(dom.getActiveElement(), this._messageWidget.value.getDomNode())) {\n                return; // override when focus is inside the message\n            }\n            this.closeMessage();\n        }));\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidDispose(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidChangeModel(() => this.closeMessage()));\n        this._messageListeners.add(dom.addDisposableListener(this._messageWidget.value.getDomNode(), dom.EventType.MOUSE_ENTER, () => this._mouseOverMessage = true, true));\n        this._messageListeners.add(dom.addDisposableListener(this._messageWidget.value.getDomNode(), dom.EventType.MOUSE_LEAVE, () => this._mouseOverMessage = false, true));\n        // close on mouse move\n        let bounds;\n        this._messageListeners.add(this._editor.onMouseMove(e => {\n            // outside the text area\n            if (!e.target.position) {\n                return;\n            }\n            if (!bounds) {\n                // define bounding box around position and first mouse occurance\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\n            }\n            else if (!bounds.containsPosition(e.target.position)) {\n                // check if position is still in bounds\n                this.closeMessage();\n            }\n        }));\n    }\n    closeMessage() {\n        this._visible.reset();\n        this._messageListeners.clear();\n        if (this._messageWidget.value) {\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\n        }\n    }\n};\nMessageController.ID = 'editor.contrib.messageController';\nMessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false, nls.localize('messageVisible', 'Whether the editor is currently showing an inline message'));\nMessageController = MessageController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IOpenerService)\n], MessageController);\nexport { MessageController };\nconst MessageCommand = EditorCommand.bindToContribution(MessageController.get);\nregisterEditorCommand(new MessageCommand({\n    id: 'leaveEditorMessage',\n    precondition: MessageController.MESSAGE_VISIBLE,\n    handler: c => c.closeMessage(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        primary: 9 /* KeyCode.Escape */\n    }\n}));\nclass MessageWidget {\n    static fadeOut(messageWidget) {\n        const dispose = () => {\n            messageWidget.dispose();\n            clearTimeout(handle);\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\n        };\n        const handle = setTimeout(dispose, 110);\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\n        messageWidget.getDomNode().classList.add('fadeOut');\n        return { dispose };\n    }\n    constructor(editor, { lineNumber, column }, text) {\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._editor = editor;\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* ScrollType.Smooth */);\n        this._position = { lineNumber, column };\n        this._domNode = document.createElement('div');\n        this._domNode.classList.add('monaco-editor-overlaymessage');\n        this._domNode.style.marginLeft = '-6px';\n        const anchorTop = document.createElement('div');\n        anchorTop.classList.add('anchor', 'top');\n        this._domNode.appendChild(anchorTop);\n        const message = document.createElement('div');\n        if (typeof text === 'string') {\n            message.classList.add('message');\n            message.textContent = text;\n        }\n        else {\n            text.classList.add('message');\n            message.appendChild(text);\n        }\n        this._domNode.appendChild(message);\n        const anchorBottom = document.createElement('div');\n        anchorBottom.classList.add('anchor', 'below');\n        this._domNode.appendChild(anchorBottom);\n        this._editor.addContentWidget(this);\n        this._domNode.classList.add('fadeIn');\n    }\n    dispose() {\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return 'messageoverlay';\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            position: this._position,\n            preference: [\n                1 /* ContentWidgetPositionPreference.ABOVE */,\n                2 /* ContentWidgetPositionPreference.BELOW */,\n            ],\n            positionAffinity: 1 /* PositionAffinity.Right */,\n        };\n    }\n    afterRender(position) {\n        this._domNode.classList.toggle('below', position === 2 /* ContentWidgetPositionPreference.BELOW */);\n    }\n}\nregisterEditorContribution(MessageController.ID, MessageController, 4 /* EditorContributionInstantiation.Lazy */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { editorConfigurationBaseNode } from '../../../common/config/editorConfigurationSchema.js';\nimport { AutoFixAction, CodeActionCommand, FixAllAction, OrganizeImportsAction, QuickFixAction, RefactorAction, SourceAction } from './codeActionCommands.js';\nimport { CodeActionController } from './codeActionController.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nregisterEditorContribution(CodeActionController.ID, CodeActionController, 3 /* EditorContributionInstantiation.Eventually */);\nregisterEditorContribution(LightBulbWidget.ID, LightBulbWidget, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(QuickFixAction);\nregisterEditorAction(RefactorAction);\nregisterEditorAction(SourceAction);\nregisterEditorAction(OrganizeImportsAction);\nregisterEditorAction(AutoFixAction);\nregisterEditorAction(FixAllAction);\nregisterEditorCommand(new CodeActionCommand());\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    ...editorConfigurationBaseNode,\n    properties: {\n        'editor.codeActionWidget.showHeaders': {\n            type: 'boolean',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('showCodeActionHeaders', \"Enable/disable showing group headers in the Code Action menu.\"),\n            default: true,\n        },\n    }\n});\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    ...editorConfigurationBaseNode,\n    properties: {\n        'editor.codeActionWidget.includeNearbyQuickFixes': {\n            type: 'boolean',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('includeNearbyQuickFixes', \"Enable/disable showing nearest Quick Fix within a line when not currently on a diagnostic.\"),\n            default: true,\n        },\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { autoFixCommandId, codeActionCommandId, fixAllCommandId, organizeImportsCommandId, quickFixCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { CodeActionCommandArgs, CodeActionKind, CodeActionTriggerSource } from '../common/types.js';\nimport { CodeActionController } from './codeActionController.js';\nimport { SUPPORTED_CODE_ACTIONS } from './codeActionModel.js';\nfunction contextKeyForSupportedActions(kind) {\n    return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0], new RegExp('(\\\\s|^)' + escapeRegExpCharacters(kind.value) + '\\\\b'));\n}\nconst argsSchema = {\n    type: 'object',\n    defaultSnippets: [{ body: { kind: '' } }],\n    properties: {\n        'kind': {\n            type: 'string',\n            description: nls.localize('args.schema.kind', \"Kind of the code action to run.\"),\n        },\n        'apply': {\n            type: 'string',\n            description: nls.localize('args.schema.apply', \"Controls when the returned actions are applied.\"),\n            default: \"ifSingle\" /* CodeActionAutoApply.IfSingle */,\n            enum: [\"first\" /* CodeActionAutoApply.First */, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, \"never\" /* CodeActionAutoApply.Never */],\n            enumDescriptions: [\n                nls.localize('args.schema.apply.first', \"Always apply the first returned code action.\"),\n                nls.localize('args.schema.apply.ifSingle', \"Apply the first returned code action if it is the only one.\"),\n                nls.localize('args.schema.apply.never', \"Do not apply the returned code actions.\"),\n            ]\n        },\n        'preferred': {\n            type: 'boolean',\n            default: false,\n            description: nls.localize('args.schema.preferred', \"Controls if only preferred code actions should be returned.\"),\n        }\n    }\n};\nfunction triggerCodeActionsForEditorSelection(editor, notAvailableMessage, filter, autoApply, triggerAction = CodeActionTriggerSource.Default) {\n    if (editor.hasModel()) {\n        const controller = CodeActionController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply);\n    }\n}\nexport class QuickFixAction extends EditorAction {\n    constructor() {\n        super({\n            id: quickFixCommandId,\n            label: nls.localize('quickfix.trigger.label', \"Quick Fix...\"),\n            alias: 'Quick Fix...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.quickFix.noneMessage', \"No code actions available\"), undefined, undefined, CodeActionTriggerSource.QuickFix);\n    }\n}\nexport class CodeActionCommand extends EditorCommand {\n    constructor() {\n        super({\n            id: codeActionCommandId,\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            metadata: {\n                description: 'Trigger a code action',\n                args: [{ name: 'args', schema: argsSchema, }]\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: CodeActionKind.Empty,\n            apply: \"ifSingle\" /* CodeActionAutoApply.IfSingle */,\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred.kind', \"No preferred code actions for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.codeAction.noneMessage.kind', \"No code actions for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred', \"No preferred code actions available\")\n                : nls.localize('editor.action.codeAction.noneMessage', \"No code actions available\"), {\n            include: args.kind,\n            includeSourceActions: true,\n            onlyIncludePreferredActions: args.preferred,\n        }, args.apply);\n    }\n}\nexport class RefactorAction extends EditorAction {\n    constructor() {\n        super({\n            id: refactorCommandId,\n            label: nls.localize('refactor.label', \"Refactor...\"),\n            alias: 'Refactor...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 48 /* KeyCode.KeyR */,\n                mac: {\n                    primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 48 /* KeyCode.KeyR */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 2,\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Refactor)),\n            },\n            metadata: {\n                description: 'Refactor...',\n                args: [{ name: 'args', schema: argsSchema }]\n            }\n        });\n    }\n    run(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: CodeActionKind.Refactor,\n            apply: \"never\" /* CodeActionAutoApply.Never */\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.refactor.noneMessage.preferred.kind', \"No preferred refactorings for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.refactor.noneMessage.kind', \"No refactorings for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.refactor.noneMessage.preferred', \"No preferred refactorings available\")\n                : nls.localize('editor.action.refactor.noneMessage', \"No refactorings available\"), {\n            include: CodeActionKind.Refactor.contains(args.kind) ? args.kind : CodeActionKind.None,\n            onlyIncludePreferredActions: args.preferred\n        }, args.apply, CodeActionTriggerSource.Refactor);\n    }\n}\nexport class SourceAction extends EditorAction {\n    constructor() {\n        super({\n            id: sourceActionCommandId,\n            label: nls.localize('source.label', \"Source Action...\"),\n            alias: 'Source Action...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 2.1,\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Source)),\n            },\n            metadata: {\n                description: 'Source Action...',\n                args: [{ name: 'args', schema: argsSchema }]\n            }\n        });\n    }\n    run(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: CodeActionKind.Source,\n            apply: \"never\" /* CodeActionAutoApply.Never */\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.source.noneMessage.preferred.kind', \"No preferred source actions for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.source.noneMessage.kind', \"No source actions for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.source.noneMessage.preferred', \"No preferred source actions available\")\n                : nls.localize('editor.action.source.noneMessage', \"No source actions available\"), {\n            include: CodeActionKind.Source.contains(args.kind) ? args.kind : CodeActionKind.None,\n            includeSourceActions: true,\n            onlyIncludePreferredActions: args.preferred,\n        }, args.apply, CodeActionTriggerSource.SourceAction);\n    }\n}\nexport class OrganizeImportsAction extends EditorAction {\n    constructor() {\n        super({\n            id: organizeImportsCommandId,\n            label: nls.localize('organizeImports.label', \"Organize Imports\"),\n            alias: 'Organize Imports',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 45 /* KeyCode.KeyO */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.organize.noneMessage', \"No organize imports action available\"), { include: CodeActionKind.SourceOrganizeImports, includeSourceActions: true }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, CodeActionTriggerSource.OrganizeImports);\n    }\n}\nexport class FixAllAction extends EditorAction {\n    constructor() {\n        super({\n            id: fixAllCommandId,\n            label: nls.localize('fixAll.label', \"Fix All\"),\n            alias: 'Fix All',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceFixAll))\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('fixAll.noneMessage', \"No fix all action available\"), { include: CodeActionKind.SourceFixAll, includeSourceActions: true }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, CodeActionTriggerSource.FixAll);\n    }\n}\nexport class AutoFixAction extends EditorAction {\n    constructor() {\n        super({\n            id: autoFixCommandId,\n            label: nls.localize('autoFix.label', \"Auto Fix...\"),\n            alias: 'Auto Fix...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.QuickFix)),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 89 /* KeyCode.Period */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 89 /* KeyCode.Period */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.autoFix.noneMessage', \"No auto fixes available\"), {\n            include: CodeActionKind.QuickFix,\n            onlyIncludePreferredActions: true\n        }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, CodeActionTriggerSource.AutoFix);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce, equals, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CodeActionItem, CodeActionKind, CodeActionTriggerSource, filtersAction, mayIncludeActionsOfKind } from '../common/types.js';\nexport const codeActionCommandId = 'editor.action.codeAction';\nexport const quickFixCommandId = 'editor.action.quickFix';\nexport const autoFixCommandId = 'editor.action.autoFix';\nexport const refactorCommandId = 'editor.action.refactor';\nexport const sourceActionCommandId = 'editor.action.sourceAction';\nexport const organizeImportsCommandId = 'editor.action.organizeImports';\nexport const fixAllCommandId = 'editor.action.fixAll';\nclass ManagedCodeActionSet extends Disposable {\n    static codeActionsPreferredComparator(a, b) {\n        if (a.isPreferred && !b.isPreferred) {\n            return -1;\n        }\n        else if (!a.isPreferred && b.isPreferred) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    static codeActionsComparator({ action: a }, { action: b }) {\n        if (a.isAI && !b.isAI) {\n            return 1;\n        }\n        else if (!a.isAI && b.isAI) {\n            return -1;\n        }\n        if (isNonEmptyArray(a.diagnostics)) {\n            return isNonEmptyArray(b.diagnostics) ? ManagedCodeActionSet.codeActionsPreferredComparator(a, b) : -1;\n        }\n        else if (isNonEmptyArray(b.diagnostics)) {\n            return 1;\n        }\n        else {\n            return ManagedCodeActionSet.codeActionsPreferredComparator(a, b); // both have no diagnostics\n        }\n    }\n    constructor(actions, documentation, disposables) {\n        super();\n        this.documentation = documentation;\n        this._register(disposables);\n        this.allActions = [...actions].sort(ManagedCodeActionSet.codeActionsComparator);\n        this.validActions = this.allActions.filter(({ action }) => !action.disabled);\n    }\n    get hasAutoFix() {\n        return this.validActions.some(({ action: fix }) => !!fix.kind && CodeActionKind.QuickFix.contains(new CodeActionKind(fix.kind)) && !!fix.isPreferred);\n    }\n    get hasAIFix() {\n        return this.validActions.some(({ action: fix }) => !!fix.isAI);\n    }\n    get allAIFixes() {\n        return this.validActions.every(({ action: fix }) => !!fix.isAI);\n    }\n}\nconst emptyCodeActionsResponse = { actions: [], documentation: undefined };\nexport async function getCodeActions(registry, model, rangeOrSelection, trigger, progress, token) {\n    var _a;\n    const filter = trigger.filter || {};\n    const notebookFilter = {\n        ...filter,\n        excludes: [...(filter.excludes || []), CodeActionKind.Notebook],\n    };\n    const codeActionContext = {\n        only: (_a = filter.include) === null || _a === void 0 ? void 0 : _a.value,\n        trigger: trigger.type,\n    };\n    const cts = new TextModelCancellationTokenSource(model, token);\n    // if the trigger is auto (autosave, lightbulb, etc), we should exclude notebook codeActions\n    const excludeNotebookCodeActions = (trigger.type === 2 /* languages.CodeActionTriggerType.Auto */);\n    const providers = getCodeActionProviders(registry, model, (excludeNotebookCodeActions) ? notebookFilter : filter);\n    const disposables = new DisposableStore();\n    const promises = providers.map(async (provider) => {\n        try {\n            progress.report(provider);\n            const providedCodeActions = await provider.provideCodeActions(model, rangeOrSelection, codeActionContext, cts.token);\n            if (providedCodeActions) {\n                disposables.add(providedCodeActions);\n            }\n            if (cts.token.isCancellationRequested) {\n                return emptyCodeActionsResponse;\n            }\n            const filteredActions = ((providedCodeActions === null || providedCodeActions === void 0 ? void 0 : providedCodeActions.actions) || []).filter(action => action && filtersAction(filter, action));\n            const documentation = getDocumentationFromProvider(provider, filteredActions, filter.include);\n            return {\n                actions: filteredActions.map(action => new CodeActionItem(action, provider)),\n                documentation\n            };\n        }\n        catch (err) {\n            if (isCancellationError(err)) {\n                throw err;\n            }\n            onUnexpectedExternalError(err);\n            return emptyCodeActionsResponse;\n        }\n    });\n    const listener = registry.onDidChange(() => {\n        const newProviders = registry.all(model);\n        if (!equals(newProviders, providers)) {\n            cts.cancel();\n        }\n    });\n    try {\n        const actions = await Promise.all(promises);\n        const allActions = actions.map(x => x.actions).flat();\n        const allDocumentation = [\n            ...coalesce(actions.map(x => x.documentation)),\n            ...getAdditionalDocumentationForShowingActions(registry, model, trigger, allActions)\n        ];\n        return new ManagedCodeActionSet(allActions, allDocumentation, disposables);\n    }\n    finally {\n        listener.dispose();\n        cts.dispose();\n    }\n}\nfunction getCodeActionProviders(registry, model, filter) {\n    return registry.all(model)\n        // Don't include providers that we know will not return code actions of interest\n        .filter(provider => {\n        if (!provider.providedCodeActionKinds) {\n            // We don't know what type of actions this provider will return.\n            return true;\n        }\n        return provider.providedCodeActionKinds.some(kind => mayIncludeActionsOfKind(filter, new CodeActionKind(kind)));\n    });\n}\nfunction* getAdditionalDocumentationForShowingActions(registry, model, trigger, actionsToShow) {\n    var _a, _b, _c;\n    if (model && actionsToShow.length) {\n        for (const provider of registry.all(model)) {\n            if (provider._getAdditionalMenuItems) {\n                yield* (_a = provider._getAdditionalMenuItems) === null || _a === void 0 ? void 0 : _a.call(provider, { trigger: trigger.type, only: (_c = (_b = trigger.filter) === null || _b === void 0 ? void 0 : _b.include) === null || _c === void 0 ? void 0 : _c.value }, actionsToShow.map(item => item.action));\n            }\n        }\n    }\n}\nfunction getDocumentationFromProvider(provider, providedCodeActions, only) {\n    if (!provider.documentation) {\n        return undefined;\n    }\n    const documentation = provider.documentation.map(entry => ({ kind: new CodeActionKind(entry.kind), command: entry.command }));\n    if (only) {\n        let currentBest;\n        for (const entry of documentation) {\n            if (entry.kind.contains(only)) {\n                if (!currentBest) {\n                    currentBest = entry;\n                }\n                else {\n                    // Take best match\n                    if (currentBest.kind.contains(entry.kind)) {\n                        currentBest = entry;\n                    }\n                }\n            }\n        }\n        if (currentBest) {\n            return currentBest === null || currentBest === void 0 ? void 0 : currentBest.command;\n        }\n    }\n    // Otherwise, check to see if any of the provided actions match.\n    for (const action of providedCodeActions) {\n        if (!action.kind) {\n            continue;\n        }\n        for (const entry of documentation) {\n            if (entry.kind.contains(new CodeActionKind(action.kind))) {\n                return entry.command;\n            }\n        }\n    }\n    return undefined;\n}\nexport var ApplyCodeActionReason;\n(function (ApplyCodeActionReason) {\n    ApplyCodeActionReason[\"OnSave\"] = \"onSave\";\n    ApplyCodeActionReason[\"FromProblemsView\"] = \"fromProblemsView\";\n    ApplyCodeActionReason[\"FromCodeActions\"] = \"fromCodeActions\";\n    ApplyCodeActionReason[\"FromAILightbulb\"] = \"fromAILightbulb\"; // direct invocation when clicking on the AI lightbulb\n})(ApplyCodeActionReason || (ApplyCodeActionReason = {}));\nexport async function applyCodeAction(accessor, item, codeActionReason, options, token = CancellationToken.None) {\n    var _a;\n    const bulkEditService = accessor.get(IBulkEditService);\n    const commandService = accessor.get(ICommandService);\n    const telemetryService = accessor.get(ITelemetryService);\n    const notificationService = accessor.get(INotificationService);\n    telemetryService.publicLog2('codeAction.applyCodeAction', {\n        codeActionTitle: item.action.title,\n        codeActionKind: item.action.kind,\n        codeActionIsPreferred: !!item.action.isPreferred,\n        reason: codeActionReason,\n    });\n    await item.resolve(token);\n    if (token.isCancellationRequested) {\n        return;\n    }\n    if ((_a = item.action.edit) === null || _a === void 0 ? void 0 : _a.edits.length) {\n        const result = await bulkEditService.apply(item.action.edit, {\n            editor: options === null || options === void 0 ? void 0 : options.editor,\n            label: item.action.title,\n            quotableLabel: item.action.title,\n            code: 'undoredo.codeAction',\n            respectAutoSaveConfig: codeActionReason !== ApplyCodeActionReason.OnSave,\n            showPreview: options === null || options === void 0 ? void 0 : options.preview,\n        });\n        if (!result.isApplied) {\n            return;\n        }\n    }\n    if (item.action.command) {\n        try {\n            await commandService.executeCommand(item.action.command.id, ...(item.action.command.arguments || []));\n        }\n        catch (err) {\n            const message = asMessage(err);\n            notificationService.error(typeof message === 'string'\n                ? message\n                : nls.localize('applyCodeActionFailed', \"An unknown error occurred while applying the code action\"));\n        }\n    }\n}\nfunction asMessage(err) {\n    if (typeof err === 'string') {\n        return err;\n    }\n    else if (err instanceof Error && typeof err.message === 'string') {\n        return err.message;\n    }\n    else {\n        return undefined;\n    }\n}\nCommandsRegistry.registerCommand('_executeCodeActionProvider', async function (accessor, resource, rangeOrSelection, kind, itemResolveCount) {\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const { codeActionProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const validatedRangeOrSelection = Selection.isISelection(rangeOrSelection)\n        ? Selection.liftSelection(rangeOrSelection)\n        : Range.isIRange(rangeOrSelection)\n            ? model.validateRange(rangeOrSelection)\n            : undefined;\n    if (!validatedRangeOrSelection) {\n        throw illegalArgument();\n    }\n    const include = typeof kind === 'string' ? new CodeActionKind(kind) : undefined;\n    const codeActionSet = await getCodeActions(codeActionProvider, model, validatedRangeOrSelection, { type: 1 /* languages.CodeActionTriggerType.Invoke */, triggerAction: CodeActionTriggerSource.Default, filter: { includeSourceActions: true, include } }, Progress.None, CancellationToken.None);\n    const resolving = [];\n    const resolveCount = Math.min(codeActionSet.validActions.length, typeof itemResolveCount === 'number' ? itemResolveCount : 0);\n    for (let i = 0; i < resolveCount; i++) {\n        resolving.push(codeActionSet.validActions[i].resolve(CancellationToken.None));\n    }\n    try {\n        await Promise.all(resolving);\n        return codeActionSet.validActions.map(item => item.action);\n    }\n    finally {\n        setTimeout(() => codeActionSet.dispose(), 100);\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nexport class CodeActionKind {\n    constructor(value) {\n        this.value = value;\n    }\n    equals(other) {\n        return this.value === other.value;\n    }\n    contains(other) {\n        return this.equals(other) || this.value === '' || other.value.startsWith(this.value + CodeActionKind.sep);\n    }\n    intersects(other) {\n        return this.contains(other) || other.contains(this);\n    }\n    append(part) {\n        return new CodeActionKind(this.value + CodeActionKind.sep + part);\n    }\n}\nCodeActionKind.sep = '.';\nCodeActionKind.None = new CodeActionKind('@@none@@'); // Special code action that contains nothing\nCodeActionKind.Empty = new CodeActionKind('');\nCodeActionKind.QuickFix = new CodeActionKind('quickfix');\nCodeActionKind.Refactor = new CodeActionKind('refactor');\nCodeActionKind.RefactorExtract = CodeActionKind.Refactor.append('extract');\nCodeActionKind.RefactorInline = CodeActionKind.Refactor.append('inline');\nCodeActionKind.RefactorMove = CodeActionKind.Refactor.append('move');\nCodeActionKind.RefactorRewrite = CodeActionKind.Refactor.append('rewrite');\nCodeActionKind.Notebook = new CodeActionKind('notebook');\nCodeActionKind.Source = new CodeActionKind('source');\nCodeActionKind.SourceOrganizeImports = CodeActionKind.Source.append('organizeImports');\nCodeActionKind.SourceFixAll = CodeActionKind.Source.append('fixAll');\nCodeActionKind.SurroundWith = CodeActionKind.Refactor.append('surround');\nexport var CodeActionTriggerSource;\n(function (CodeActionTriggerSource) {\n    CodeActionTriggerSource[\"Refactor\"] = \"refactor\";\n    CodeActionTriggerSource[\"RefactorPreview\"] = \"refactor preview\";\n    CodeActionTriggerSource[\"Lightbulb\"] = \"lightbulb\";\n    CodeActionTriggerSource[\"Default\"] = \"other (default)\";\n    CodeActionTriggerSource[\"SourceAction\"] = \"source action\";\n    CodeActionTriggerSource[\"QuickFix\"] = \"quick fix action\";\n    CodeActionTriggerSource[\"FixAll\"] = \"fix all\";\n    CodeActionTriggerSource[\"OrganizeImports\"] = \"organize imports\";\n    CodeActionTriggerSource[\"AutoFix\"] = \"auto fix\";\n    CodeActionTriggerSource[\"QuickFixHover\"] = \"quick fix hover window\";\n    CodeActionTriggerSource[\"OnSave\"] = \"save participants\";\n    CodeActionTriggerSource[\"ProblemsView\"] = \"problems view\";\n})(CodeActionTriggerSource || (CodeActionTriggerSource = {}));\nexport function mayIncludeActionsOfKind(filter, providedKind) {\n    // A provided kind may be a subset or superset of our filtered kind.\n    if (filter.include && !filter.include.intersects(providedKind)) {\n        return false;\n    }\n    if (filter.excludes) {\n        if (filter.excludes.some(exclude => excludesAction(providedKind, exclude, filter.include))) {\n            return false;\n        }\n    }\n    // Don't return source actions unless they are explicitly requested\n    if (!filter.includeSourceActions && CodeActionKind.Source.contains(providedKind)) {\n        return false;\n    }\n    return true;\n}\nexport function filtersAction(filter, action) {\n    const actionKind = action.kind ? new CodeActionKind(action.kind) : undefined;\n    // Filter out actions by kind\n    if (filter.include) {\n        if (!actionKind || !filter.include.contains(actionKind)) {\n            return false;\n        }\n    }\n    if (filter.excludes) {\n        if (actionKind && filter.excludes.some(exclude => excludesAction(actionKind, exclude, filter.include))) {\n            return false;\n        }\n    }\n    // Don't return source actions unless they are explicitly requested\n    if (!filter.includeSourceActions) {\n        if (actionKind && CodeActionKind.Source.contains(actionKind)) {\n            return false;\n        }\n    }\n    if (filter.onlyIncludePreferredActions) {\n        if (!action.isPreferred) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction excludesAction(providedKind, exclude, include) {\n    if (!exclude.contains(providedKind)) {\n        return false;\n    }\n    if (include && exclude.contains(include)) {\n        // The include is more specific, don't filter out\n        return false;\n    }\n    return true;\n}\nexport class CodeActionCommandArgs {\n    static fromUser(arg, defaults) {\n        if (!arg || typeof arg !== 'object') {\n            return new CodeActionCommandArgs(defaults.kind, defaults.apply, false);\n        }\n        return new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(arg, defaults.kind), CodeActionCommandArgs.getApplyFromUser(arg, defaults.apply), CodeActionCommandArgs.getPreferredUser(arg));\n    }\n    static getApplyFromUser(arg, defaultAutoApply) {\n        switch (typeof arg.apply === 'string' ? arg.apply.toLowerCase() : '') {\n            case 'first': return \"first\" /* CodeActionAutoApply.First */;\n            case 'never': return \"never\" /* CodeActionAutoApply.Never */;\n            case 'ifsingle': return \"ifSingle\" /* CodeActionAutoApply.IfSingle */;\n            default: return defaultAutoApply;\n        }\n    }\n    static getKindFromUser(arg, defaultKind) {\n        return typeof arg.kind === 'string'\n            ? new CodeActionKind(arg.kind)\n            : defaultKind;\n    }\n    static getPreferredUser(arg) {\n        return typeof arg.preferred === 'boolean'\n            ? arg.preferred\n            : false;\n    }\n    constructor(kind, apply, preferred) {\n        this.kind = kind;\n        this.apply = apply;\n        this.preferred = preferred;\n    }\n}\nexport class CodeActionItem {\n    constructor(action, provider, highlightRange) {\n        this.action = action;\n        this.provider = provider;\n        this.highlightRange = highlightRange;\n    }\n    async resolve(token) {\n        var _a;\n        if (((_a = this.provider) === null || _a === void 0 ? void 0 : _a.resolveCodeAction) && !this.action.edit) {\n            let action;\n            try {\n                action = await this.provider.resolveCodeAction(this.action, token);\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n            if (action) {\n                this.action.edit = action.edit;\n            }\n        }\n        return this;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CodeActionController_1;\nimport { getDomNodePagePosition } from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ApplyCodeActionReason, applyCodeAction } from './codeAction.js';\nimport { CodeActionKeybindingResolver } from './codeActionKeybindingResolver.js';\nimport { toMenuItems } from './codeActionMenu.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { localize } from '../../../../nls.js';\nimport { IActionWidgetService } from '../../../../platform/actionWidget/browser/actionWidget.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { editorFindMatchHighlight, editorFindMatchHighlightBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { CodeActionTriggerSource } from '../common/types.js';\nimport { CodeActionModel } from './codeActionModel.js';\nconst DECORATION_CLASS_NAME = 'quickfix-edit-highlight';\nlet CodeActionController = CodeActionController_1 = class CodeActionController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(CodeActionController_1.ID);\n    }\n    constructor(editor, markerService, contextKeyService, instantiationService, languageFeaturesService, progressService, _commandService, _configurationService, _actionWidgetService, _instantiationService) {\n        super();\n        this._commandService = _commandService;\n        this._configurationService = _configurationService;\n        this._actionWidgetService = _actionWidgetService;\n        this._instantiationService = _instantiationService;\n        this._activeCodeActions = this._register(new MutableDisposable());\n        this._showDisabled = false;\n        this._disposed = false;\n        this._editor = editor;\n        this._model = this._register(new CodeActionModel(this._editor, languageFeaturesService.codeActionProvider, markerService, contextKeyService, progressService, _configurationService));\n        this._register(this._model.onDidChangeState(newState => this.update(newState)));\n        this._lightBulbWidget = new Lazy(() => {\n            const widget = this._editor.getContribution(LightBulbWidget.ID);\n            if (widget) {\n                this._register(widget.onClick(e => this.showCodeActionsFromLightbulb(e.actions, e)));\n            }\n            return widget;\n        });\n        this._resolver = instantiationService.createInstance(CodeActionKeybindingResolver);\n        this._register(this._editor.onDidLayoutChange(() => this._actionWidgetService.hide()));\n    }\n    dispose() {\n        this._disposed = true;\n        super.dispose();\n    }\n    async showCodeActionsFromLightbulb(actions, at) {\n        if (actions.allAIFixes && actions.validActions.length === 1) {\n            const actionItem = actions.validActions[0];\n            const command = actionItem.action.command;\n            if (command && command.id === 'inlineChat.start') {\n                if (command.arguments && command.arguments.length >= 1) {\n                    command.arguments[0] = { ...command.arguments[0], autoSend: false };\n                }\n            }\n            await this._applyCodeAction(actionItem, false, false, ApplyCodeActionReason.FromAILightbulb);\n            return;\n        }\n        await this.showCodeActionList(actions, at, { includeDisabledActions: false, fromLightbulb: true });\n    }\n    showCodeActions(_trigger, actions, at) {\n        return this.showCodeActionList(actions, at, { includeDisabledActions: false, fromLightbulb: false });\n    }\n    manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        (_a = MessageController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.closeMessage();\n        const triggerPosition = this._editor.getPosition();\n        this._trigger({ type: 1 /* CodeActionTriggerType.Invoke */, triggerAction, filter, autoApply, context: { notAvailableMessage, position: triggerPosition } });\n    }\n    _trigger(trigger) {\n        return this._model.trigger(trigger);\n    }\n    async _applyCodeAction(action, retrigger, preview, actionReason) {\n        try {\n            await this._instantiationService.invokeFunction(applyCodeAction, action, actionReason, { preview, editor: this._editor });\n        }\n        finally {\n            if (retrigger) {\n                this._trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.QuickFix, filter: {} });\n            }\n        }\n    }\n    async update(newState) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        if (newState.type !== 1 /* CodeActionsState.Type.Triggered */) {\n            (_a = this._lightBulbWidget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\n            return;\n        }\n        let actions;\n        try {\n            actions = await newState.actions;\n        }\n        catch (e) {\n            onUnexpectedError(e);\n            return;\n        }\n        if (this._disposed) {\n            return;\n        }\n        (_b = this._lightBulbWidget.value) === null || _b === void 0 ? void 0 : _b.update(actions, newState.trigger, newState.position);\n        if (newState.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n            if ((_c = newState.trigger.filter) === null || _c === void 0 ? void 0 : _c.include) { // Triggered for specific scope\n                // Check to see if we want to auto apply.\n                const validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\n                if (validActionToApply) {\n                    try {\n                        (_d = this._lightBulbWidget.value) === null || _d === void 0 ? void 0 : _d.hide();\n                        await this._applyCodeAction(validActionToApply, false, false, ApplyCodeActionReason.FromCodeActions);\n                    }\n                    finally {\n                        actions.dispose();\n                    }\n                    return;\n                }\n                // Check to see if there is an action that we would have applied were it not invalid\n                if (newState.trigger.context) {\n                    const invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\n                    if (invalidAction && invalidAction.action.disabled) {\n                        (_e = MessageController.get(this._editor)) === null || _e === void 0 ? void 0 : _e.showMessage(invalidAction.action.disabled, newState.trigger.context.position);\n                        actions.dispose();\n                        return;\n                    }\n                }\n            }\n            const includeDisabledActions = !!((_f = newState.trigger.filter) === null || _f === void 0 ? void 0 : _f.include);\n            if (newState.trigger.context) {\n                if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\n                    (_g = MessageController.get(this._editor)) === null || _g === void 0 ? void 0 : _g.showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\n                    this._activeCodeActions.value = actions;\n                    actions.dispose();\n                    return;\n                }\n            }\n            this._activeCodeActions.value = actions;\n            this.showCodeActionList(actions, this.toCoords(newState.position), { includeDisabledActions, fromLightbulb: false });\n        }\n        else {\n            // auto magically triggered\n            if (this._actionWidgetService.isVisible) {\n                // TODO: Figure out if we should update the showing menu?\n                actions.dispose();\n            }\n            else {\n                this._activeCodeActions.value = actions;\n            }\n        }\n    }\n    getInvalidActionThatWouldHaveBeenApplied(trigger, actions) {\n        if (!actions.allActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length === 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.allActions.length === 1)) {\n            return actions.allActions.find(({ action }) => action.disabled);\n        }\n        return undefined;\n    }\n    tryGetValidActionToApply(trigger, actions) {\n        if (!actions.validActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length > 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.validActions.length === 1)) {\n            return actions.validActions[0];\n        }\n        return undefined;\n    }\n    async showCodeActionList(actions, at, options) {\n        const currentDecorations = this._editor.createDecorationsCollection();\n        const editorDom = this._editor.getDomNode();\n        if (!editorDom) {\n            return;\n        }\n        const actionsToShow = options.includeDisabledActions && (this._showDisabled || actions.validActions.length === 0) ? actions.allActions : actions.validActions;\n        if (!actionsToShow.length) {\n            return;\n        }\n        const anchor = Position.isIPosition(at) ? this.toCoords(at) : at;\n        const delegate = {\n            onSelect: async (action, preview) => {\n                this._applyCodeAction(action, /* retrigger */ true, !!preview, ApplyCodeActionReason.FromCodeActions);\n                this._actionWidgetService.hide();\n                currentDecorations.clear();\n            },\n            onHide: () => {\n                var _a;\n                (_a = this._editor) === null || _a === void 0 ? void 0 : _a.focus();\n                currentDecorations.clear();\n            },\n            onHover: async (action, token) => {\n                var _a;\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                return { canPreview: !!((_a = action.action.edit) === null || _a === void 0 ? void 0 : _a.edits.length) };\n            },\n            onFocus: (action) => {\n                var _a, _b;\n                if (action && action.action) {\n                    const ranges = action.action.ranges;\n                    const diagnostics = action.action.diagnostics;\n                    currentDecorations.clear();\n                    if (ranges && ranges.length > 0) {\n                        // Handles case for `fix all` where there are multiple diagnostics.\n                        const decorations = (diagnostics && (diagnostics === null || diagnostics === void 0 ? void 0 : diagnostics.length) > 1)\n                            ? diagnostics.map(diagnostic => ({ range: diagnostic, options: CodeActionController_1.DECORATION }))\n                            : ranges.map(range => ({ range, options: CodeActionController_1.DECORATION }));\n                        currentDecorations.set(decorations);\n                    }\n                    else if (diagnostics && diagnostics.length > 0) {\n                        const decorations = diagnostics.map(diagnostic => ({ range: diagnostic, options: CodeActionController_1.DECORATION }));\n                        currentDecorations.set(decorations);\n                        const diagnostic = diagnostics[0];\n                        if (diagnostic.startLineNumber && diagnostic.startColumn) {\n                            const selectionText = (_b = (_a = this._editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition({ lineNumber: diagnostic.startLineNumber, column: diagnostic.startColumn })) === null || _b === void 0 ? void 0 : _b.word;\n                            aria.status(localize('editingNewSelection', \"Context: {0} at line {1} and column {2}.\", selectionText, diagnostic.startLineNumber, diagnostic.startColumn));\n                        }\n                    }\n                }\n                else {\n                    currentDecorations.clear();\n                }\n            }\n        };\n        this._actionWidgetService.show('codeActionWidget', true, toMenuItems(actionsToShow, this._shouldShowHeaders(), this._resolver.getResolver()), delegate, anchor, editorDom, this._getActionBarActions(actions, at, options));\n    }\n    toCoords(position) {\n        if (!this._editor.hasModel()) {\n            return { x: 0, y: 0 };\n        }\n        this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n        this._editor.render();\n        // Translate to absolute editor position\n        const cursorCoords = this._editor.getScrolledVisiblePosition(position);\n        const editorCoords = getDomNodePagePosition(this._editor.getDomNode());\n        const x = editorCoords.left + cursorCoords.left;\n        const y = editorCoords.top + cursorCoords.top + cursorCoords.height;\n        return { x, y };\n    }\n    _shouldShowHeaders() {\n        var _a;\n        const model = (_a = this._editor) === null || _a === void 0 ? void 0 : _a.getModel();\n        return this._configurationService.getValue('editor.codeActionWidget.showHeaders', { resource: model === null || model === void 0 ? void 0 : model.uri });\n    }\n    _getActionBarActions(actions, at, options) {\n        if (options.fromLightbulb) {\n            return [];\n        }\n        const resultActions = actions.documentation.map((command) => {\n            var _a;\n            return ({\n                id: command.id,\n                label: command.title,\n                tooltip: (_a = command.tooltip) !== null && _a !== void 0 ? _a : '',\n                class: undefined,\n                enabled: true,\n                run: () => { var _a; return this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : [])); },\n            });\n        });\n        if (options.includeDisabledActions && actions.validActions.length > 0 && actions.allActions.length !== actions.validActions.length) {\n            resultActions.push(this._showDisabled ? {\n                id: 'hideMoreActions',\n                label: localize('hideMoreActions', 'Hide Disabled'),\n                enabled: true,\n                tooltip: '',\n                class: undefined,\n                run: () => {\n                    this._showDisabled = false;\n                    return this.showCodeActionList(actions, at, options);\n                }\n            } : {\n                id: 'showMoreActions',\n                label: localize('showMoreActions', 'Show Disabled'),\n                enabled: true,\n                tooltip: '',\n                class: undefined,\n                run: () => {\n                    this._showDisabled = true;\n                    return this.showCodeActionList(actions, at, options);\n                }\n            });\n        }\n        return resultActions;\n    }\n};\nCodeActionController.ID = 'editor.contrib.codeActionController';\nCodeActionController.DECORATION = ModelDecorationOptions.register({\n    description: 'quickfix-highlight',\n    className: DECORATION_CLASS_NAME\n});\nCodeActionController = CodeActionController_1 = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IContextKeyService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IEditorProgressService),\n    __param(6, ICommandService),\n    __param(7, IConfigurationService),\n    __param(8, IActionWidgetService),\n    __param(9, IInstantiationService)\n], CodeActionController);\nexport { CodeActionController };\nregisterThemingParticipant((theme, collector) => {\n    const addBackgroundColorRule = (selector, color) => {\n        if (color) {\n            collector.addRule(`.monaco-editor ${selector} { background-color: ${color}; }`);\n        }\n    };\n    addBackgroundColorRule('.quickfix-edit-highlight', theme.getColor(editorFindMatchHighlight));\n    const findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\n    if (findMatchHighlightBorder) {\n        collector.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${isHighContrast(theme.type) ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CodeActionKeybindingResolver_1;\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { codeActionCommandId, fixAllCommandId, organizeImportsCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\nimport { CodeActionCommandArgs, CodeActionKind } from '../common/types.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nlet CodeActionKeybindingResolver = CodeActionKeybindingResolver_1 = class CodeActionKeybindingResolver {\n    constructor(keybindingService) {\n        this.keybindingService = keybindingService;\n    }\n    getResolver() {\n        // Lazy since we may not actually ever read the value\n        const allCodeActionBindings = new Lazy(() => this.keybindingService.getKeybindings()\n            .filter(item => CodeActionKeybindingResolver_1.codeActionCommands.indexOf(item.command) >= 0)\n            .filter(item => item.resolvedKeybinding)\n            .map((item) => {\n            // Special case these commands since they come built-in with VS Code and don't use 'commandArgs'\n            let commandArgs = item.commandArgs;\n            if (item.command === organizeImportsCommandId) {\n                commandArgs = { kind: CodeActionKind.SourceOrganizeImports.value };\n            }\n            else if (item.command === fixAllCommandId) {\n                commandArgs = { kind: CodeActionKind.SourceFixAll.value };\n            }\n            return {\n                resolvedKeybinding: item.resolvedKeybinding,\n                ...CodeActionCommandArgs.fromUser(commandArgs, {\n                    kind: CodeActionKind.None,\n                    apply: \"never\" /* CodeActionAutoApply.Never */\n                })\n            };\n        }));\n        return (action) => {\n            if (action.kind) {\n                const binding = this.bestKeybindingForCodeAction(action, allCodeActionBindings.value);\n                return binding === null || binding === void 0 ? void 0 : binding.resolvedKeybinding;\n            }\n            return undefined;\n        };\n    }\n    bestKeybindingForCodeAction(action, candidates) {\n        if (!action.kind) {\n            return undefined;\n        }\n        const kind = new CodeActionKind(action.kind);\n        return candidates\n            .filter(candidate => candidate.kind.contains(kind))\n            .filter(candidate => {\n            if (candidate.preferred) {\n                // If the candidate keybinding only applies to preferred actions, the this action must also be preferred\n                return action.isPreferred;\n            }\n            return true;\n        })\n            .reduceRight((currentBest, candidate) => {\n            if (!currentBest) {\n                return candidate;\n            }\n            // Select the more specific binding\n            return currentBest.kind.contains(candidate.kind) ? candidate : currentBest;\n        }, undefined);\n    }\n};\nCodeActionKeybindingResolver.codeActionCommands = [\n    refactorCommandId,\n    codeActionCommandId,\n    sourceActionCommandId,\n    organizeImportsCommandId,\n    fixAllCommandId\n];\nCodeActionKeybindingResolver = CodeActionKeybindingResolver_1 = __decorate([\n    __param(0, IKeybindingService)\n], CodeActionKeybindingResolver);\nexport { CodeActionKeybindingResolver };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { CodeActionKind } from '../common/types.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport { localize } from '../../../../nls.js';\nconst uncategorizedCodeActionGroup = Object.freeze({ kind: CodeActionKind.Empty, title: localize('codeAction.widget.id.more', 'More Actions...') });\nconst codeActionGroups = Object.freeze([\n    { kind: CodeActionKind.QuickFix, title: localize('codeAction.widget.id.quickfix', 'Quick Fix') },\n    { kind: CodeActionKind.RefactorExtract, title: localize('codeAction.widget.id.extract', 'Extract'), icon: Codicon.wrench },\n    { kind: CodeActionKind.RefactorInline, title: localize('codeAction.widget.id.inline', 'Inline'), icon: Codicon.wrench },\n    { kind: CodeActionKind.RefactorRewrite, title: localize('codeAction.widget.id.convert', 'Rewrite'), icon: Codicon.wrench },\n    { kind: CodeActionKind.RefactorMove, title: localize('codeAction.widget.id.move', 'Move'), icon: Codicon.wrench },\n    { kind: CodeActionKind.SurroundWith, title: localize('codeAction.widget.id.surround', 'Surround With'), icon: Codicon.surroundWith },\n    { kind: CodeActionKind.Source, title: localize('codeAction.widget.id.source', 'Source Action'), icon: Codicon.symbolFile },\n    uncategorizedCodeActionGroup,\n]);\nexport function toMenuItems(inputCodeActions, showHeaders, keybindingResolver) {\n    if (!showHeaders) {\n        return inputCodeActions.map((action) => {\n            var _a;\n            return {\n                kind: \"action\" /* ActionListItemKind.Action */,\n                item: action,\n                group: uncategorizedCodeActionGroup,\n                disabled: !!action.action.disabled,\n                label: action.action.disabled || action.action.title,\n                canPreview: !!((_a = action.action.edit) === null || _a === void 0 ? void 0 : _a.edits.length),\n            };\n        });\n    }\n    // Group code actions\n    const menuEntries = codeActionGroups.map(group => ({ group, actions: [] }));\n    for (const action of inputCodeActions) {\n        const kind = action.action.kind ? new CodeActionKind(action.action.kind) : CodeActionKind.None;\n        for (const menuEntry of menuEntries) {\n            if (menuEntry.group.kind.contains(kind)) {\n                menuEntry.actions.push(action);\n                break;\n            }\n        }\n    }\n    const allMenuItems = [];\n    for (const menuEntry of menuEntries) {\n        if (menuEntry.actions.length) {\n            allMenuItems.push({ kind: \"header\" /* ActionListItemKind.Header */, group: menuEntry.group });\n            for (const action of menuEntry.actions) {\n                const group = menuEntry.group;\n                allMenuItems.push({\n                    kind: \"action\" /* ActionListItemKind.Action */,\n                    item: action,\n                    group: action.action.isAI ? { title: group.title, kind: group.kind, icon: Codicon.sparkle } : group,\n                    label: action.action.title,\n                    disabled: !!action.action.disabled,\n                    keybinding: keybindingResolver(action.action),\n                });\n            }\n        }\n    }\n    return allMenuItems;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './symbolIcons.css';\nimport { localize } from '../../../../nls.js';\nimport { foreground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nexport const SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground,\n}, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', {\n    dark: foreground,\n    light: foreground,\n    hcDark: foreground,\n    hcLight: foreground\n}, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC',\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar LightBulbWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Gesture } from '../../../../base/browser/touch.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './lightBulbWidget.css';\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { autoFixCommandId, quickFixCommandId } from './codeAction.js';\nimport * as nls from '../../../../nls.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nvar LightBulbState;\n(function (LightBulbState) {\n    LightBulbState.Hidden = { type: 0 /* Type.Hidden */ };\n    class Showing {\n        constructor(actions, trigger, editorPosition, widgetPosition) {\n            this.actions = actions;\n            this.trigger = trigger;\n            this.editorPosition = editorPosition;\n            this.widgetPosition = widgetPosition;\n            this.type = 1 /* Type.Showing */;\n        }\n    }\n    LightBulbState.Showing = Showing;\n})(LightBulbState || (LightBulbState = {}));\nlet LightBulbWidget = LightBulbWidget_1 = class LightBulbWidget extends Disposable {\n    constructor(_editor, _keybindingService, commandService) {\n        super();\n        this._editor = _editor;\n        this._keybindingService = _keybindingService;\n        this._onClick = this._register(new Emitter());\n        this.onClick = this._onClick.event;\n        this._state = LightBulbState.Hidden;\n        this._iconClasses = [];\n        this._domNode = dom.$('div.lightBulbWidget');\n        this._register(Gesture.ignoreTarget(this._domNode));\n        this._editor.addContentWidget(this);\n        this._register(this._editor.onDidChangeModelContent(_ => {\n            // cancel when the line in question has been removed\n            const editorModel = this._editor.getModel();\n            if (this.state.type !== 1 /* LightBulbState.Type.Showing */ || !editorModel || this.state.editorPosition.lineNumber >= editorModel.getLineCount()) {\n                this.hide();\n            }\n        }));\n        this._register(dom.addStandardDisposableGenericMouseDownListener(this._domNode, e => {\n            if (this.state.type !== 1 /* LightBulbState.Type.Showing */) {\n                return;\n            }\n            // Make sure that focus / cursor location is not lost when clicking widget icon\n            this._editor.focus();\n            e.preventDefault();\n            // a bit of extra work to make sure the menu\n            // doesn't cover the line-text\n            const { top, height } = dom.getDomNodePagePosition(this._domNode);\n            const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n            let pad = Math.floor(lineHeight / 3);\n            if (this.state.widgetPosition.position !== null && this.state.widgetPosition.position.lineNumber < this.state.editorPosition.lineNumber) {\n                pad += lineHeight;\n            }\n            this._onClick.fire({\n                x: e.posx,\n                y: top + height + pad,\n                actions: this.state.actions,\n                trigger: this.state.trigger,\n            });\n        }));\n        this._register(dom.addDisposableListener(this._domNode, 'mouseenter', (e) => {\n            if ((e.buttons & 1) !== 1) {\n                return;\n            }\n            // mouse enters lightbulb while the primary/left button\n            // is being pressed -> hide the lightbulb\n            this.hide();\n        }));\n        this._register(Event.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings, () => {\n            var _a, _b, _c, _d;\n            this._preferredKbLabel = (_b = (_a = this._keybindingService.lookupKeybinding(autoFixCommandId)) === null || _a === void 0 ? void 0 : _a.getLabel()) !== null && _b !== void 0 ? _b : undefined;\n            this._quickFixKbLabel = (_d = (_c = this._keybindingService.lookupKeybinding(quickFixCommandId)) === null || _c === void 0 ? void 0 : _c.getLabel()) !== null && _d !== void 0 ? _d : undefined;\n            this._updateLightBulbTitleAndIcon();\n        }));\n    }\n    dispose() {\n        super.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return 'LightBulbWidget';\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return this._state.type === 1 /* LightBulbState.Type.Showing */ ? this._state.widgetPosition : null;\n    }\n    update(actions, trigger, atPosition) {\n        if (actions.validActions.length <= 0) {\n            return this.hide();\n        }\n        const options = this._editor.getOptions();\n        if (!options.get(65 /* EditorOption.lightbulb */).enabled) {\n            return this.hide();\n        }\n        const model = this._editor.getModel();\n        if (!model) {\n            return this.hide();\n        }\n        const { lineNumber, column } = model.validatePosition(atPosition);\n        const tabSize = model.getOptions().tabSize;\n        const fontInfo = this._editor.getOptions().get(50 /* EditorOption.fontInfo */);\n        const lineContent = model.getLineContent(lineNumber);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        const lineHasSpace = fontInfo.spaceWidth * indent > 22;\n        const isFolded = (lineNumber) => {\n            return lineNumber > 2 && this._editor.getTopForLineNumber(lineNumber) === this._editor.getTopForLineNumber(lineNumber - 1);\n        };\n        let effectiveLineNumber = lineNumber;\n        let effectiveColumnNumber = 1;\n        if (!lineHasSpace) {\n            if (lineNumber > 1 && !isFolded(lineNumber - 1)) {\n                effectiveLineNumber -= 1;\n            }\n            else if ((lineNumber < model.getLineCount()) && !isFolded(lineNumber + 1)) {\n                effectiveLineNumber += 1;\n            }\n            else if (column * fontInfo.spaceWidth < 22) {\n                // cannot show lightbulb above/below and showing\n                // it inline would overlay the cursor...\n                return this.hide();\n            }\n            effectiveColumnNumber = /^\\S\\s*$/.test(model.getLineContent(effectiveLineNumber)) ? 2 : 1;\n        }\n        this.state = new LightBulbState.Showing(actions, trigger, atPosition, {\n            position: { lineNumber: effectiveLineNumber, column: effectiveColumnNumber },\n            preference: LightBulbWidget_1._posPref\n        });\n        this._editor.layoutContentWidget(this);\n    }\n    hide() {\n        if (this.state === LightBulbState.Hidden) {\n            return;\n        }\n        this.state = LightBulbState.Hidden;\n        this._editor.layoutContentWidget(this);\n    }\n    get state() { return this._state; }\n    set state(value) {\n        this._state = value;\n        this._updateLightBulbTitleAndIcon();\n    }\n    _updateLightBulbTitleAndIcon() {\n        this._domNode.classList.remove(...this._iconClasses);\n        this._iconClasses = [];\n        if (this.state.type !== 1 /* LightBulbState.Type.Showing */) {\n            return;\n        }\n        let icon;\n        let autoRun = false;\n        if (this.state.actions.allAIFixes) {\n            icon = Codicon.sparkleFilled;\n            if (this.state.actions.validActions.length === 1) {\n                autoRun = true;\n            }\n        }\n        else if (this.state.actions.hasAutoFix) {\n            if (this.state.actions.hasAIFix) {\n                icon = Codicon.lightbulbSparkleAutofix;\n            }\n            else {\n                icon = Codicon.lightbulbAutofix;\n            }\n        }\n        else if (this.state.actions.hasAIFix) {\n            icon = Codicon.lightbulbSparkle;\n        }\n        else {\n            icon = Codicon.lightBulb;\n        }\n        this._updateLightbulbTitle(this.state.actions.hasAutoFix, autoRun);\n        this._iconClasses = ThemeIcon.asClassNameArray(icon);\n        this._domNode.classList.add(...this._iconClasses);\n    }\n    _updateLightbulbTitle(autoFix, autoRun) {\n        if (this.state.type !== 1 /* LightBulbState.Type.Showing */) {\n            return;\n        }\n        if (autoRun) {\n            this.title = nls.localize('codeActionAutoRun', \"Run: {0}\", this.state.actions.validActions[0].action.title);\n        }\n        else if (autoFix && this._preferredKbLabel) {\n            this.title = nls.localize('preferredcodeActionWithKb', \"Show Code Actions. Preferred Quick Fix Available ({0})\", this._preferredKbLabel);\n        }\n        else if (!autoFix && this._quickFixKbLabel) {\n            this.title = nls.localize('codeActionWithKb', \"Show Code Actions ({0})\", this._quickFixKbLabel);\n        }\n        else if (!autoFix) {\n            this.title = nls.localize('codeAction', \"Show Code Actions\");\n        }\n    }\n    set title(value) {\n        this._domNode.title = value;\n    }\n};\nLightBulbWidget.ID = 'editor.contrib.lightbulbWidget';\nLightBulbWidget._posPref = [0 /* ContentWidgetPositionPreference.EXACT */];\nLightBulbWidget = LightBulbWidget_1 = __decorate([\n    __param(1, IKeybindingService),\n    __param(2, ICommandService)\n], LightBulbWidget);\nexport { LightBulbWidget };\n", "var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../base/browser/dom.js';\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport './actionWidget.css';\nimport { localize, localize2 } from '../../../nls.js';\nimport { acceptSelectedActionCommand, ActionList, previewSelectedActionCommand } from './actionList.js';\nimport { Action2, registerAction2 } from '../../actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../contextkey/common/contextkey.js';\nimport { IContextViewService } from '../../contextview/browser/contextView.js';\nimport { registerSingleton } from '../../instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { inputActiveOptionBackground, registerColor } from '../../theme/common/colorRegistry.js';\nregisterColor('actionBar.toggledBackground', { dark: inputActiveOptionBackground, light: inputActiveOptionBackground, hcDark: inputActiveOptionBackground, hcLight: inputActiveOptionBackground, }, localize('actionBar.toggledBackground', 'Background color for toggled action items in action bar.'));\nconst ActionWidgetContextKeys = {\n    Visible: new RawContextKey('codeActionMenuVisible', false, localize('codeActionMenuVisible', \"Whether the action widget list is visible\"))\n};\nexport const IActionWidgetService = createDecorator('actionWidgetService');\nlet ActionWidgetService = class ActionWidgetService extends Disposable {\n    get isVisible() {\n        return ActionWidgetContextKeys.Visible.getValue(this._contextKeyService) || false;\n    }\n    constructor(_contextViewService, _contextKeyService, _instantiationService) {\n        super();\n        this._contextViewService = _contextViewService;\n        this._contextKeyService = _contextKeyService;\n        this._instantiationService = _instantiationService;\n        this._list = this._register(new MutableDisposable());\n    }\n    show(user, supportsPreview, items, delegate, anchor, container, actionBarActions) {\n        const visibleContext = ActionWidgetContextKeys.Visible.bindTo(this._contextKeyService);\n        const list = this._instantiationService.createInstance(ActionList, user, supportsPreview, items, delegate);\n        this._contextViewService.showContextView({\n            getAnchor: () => anchor,\n            render: (container) => {\n                visibleContext.set(true);\n                return this._renderWidget(container, list, actionBarActions !== null && actionBarActions !== void 0 ? actionBarActions : []);\n            },\n            onHide: (didCancel) => {\n                visibleContext.reset();\n                this._onWidgetClosed(didCancel);\n            },\n        }, container, false);\n    }\n    acceptSelected(preview) {\n        var _a;\n        (_a = this._list.value) === null || _a === void 0 ? void 0 : _a.acceptSelected(preview);\n    }\n    focusPrevious() {\n        var _a, _b;\n        (_b = (_a = this._list) === null || _a === void 0 ? void 0 : _a.value) === null || _b === void 0 ? void 0 : _b.focusPrevious();\n    }\n    focusNext() {\n        var _a, _b;\n        (_b = (_a = this._list) === null || _a === void 0 ? void 0 : _a.value) === null || _b === void 0 ? void 0 : _b.focusNext();\n    }\n    hide() {\n        var _a;\n        (_a = this._list.value) === null || _a === void 0 ? void 0 : _a.hide();\n        this._list.clear();\n    }\n    _renderWidget(element, list, actionBarActions) {\n        var _a;\n        const widget = document.createElement('div');\n        widget.classList.add('action-widget');\n        element.appendChild(widget);\n        this._list.value = list;\n        if (this._list.value) {\n            widget.appendChild(this._list.value.domNode);\n        }\n        else {\n            throw new Error('List has no value');\n        }\n        const renderDisposables = new DisposableStore();\n        // Invisible div to block mouse interaction in the rest of the UI\n        const menuBlock = document.createElement('div');\n        const block = element.appendChild(menuBlock);\n        block.classList.add('context-view-block');\n        renderDisposables.add(dom.addDisposableListener(block, dom.EventType.MOUSE_DOWN, e => e.stopPropagation()));\n        // Invisible div to block mouse interaction with the menu\n        const pointerBlockDiv = document.createElement('div');\n        const pointerBlock = element.appendChild(pointerBlockDiv);\n        pointerBlock.classList.add('context-view-pointerBlock');\n        // Removes block on click INSIDE widget or ANY mouse movement\n        renderDisposables.add(dom.addDisposableListener(pointerBlock, dom.EventType.POINTER_MOVE, () => pointerBlock.remove()));\n        renderDisposables.add(dom.addDisposableListener(pointerBlock, dom.EventType.MOUSE_DOWN, () => pointerBlock.remove()));\n        // Action bar\n        let actionBarWidth = 0;\n        if (actionBarActions.length) {\n            const actionBar = this._createActionBar('.action-widget-action-bar', actionBarActions);\n            if (actionBar) {\n                widget.appendChild(actionBar.getContainer().parentElement);\n                renderDisposables.add(actionBar);\n                actionBarWidth = actionBar.getContainer().offsetWidth;\n            }\n        }\n        const width = (_a = this._list.value) === null || _a === void 0 ? void 0 : _a.layout(actionBarWidth);\n        widget.style.width = `${width}px`;\n        const focusTracker = renderDisposables.add(dom.trackFocus(element));\n        renderDisposables.add(focusTracker.onDidBlur(() => this.hide()));\n        return renderDisposables;\n    }\n    _createActionBar(className, actions) {\n        if (!actions.length) {\n            return undefined;\n        }\n        const container = dom.$(className);\n        const actionBar = new ActionBar(container);\n        actionBar.push(actions, { icon: false, label: true });\n        return actionBar;\n    }\n    _onWidgetClosed(didCancel) {\n        var _a;\n        (_a = this._list.value) === null || _a === void 0 ? void 0 : _a.hide(didCancel);\n    }\n};\nActionWidgetService = __decorate([\n    __param(0, IContextViewService),\n    __param(1, IContextKeyService),\n    __param(2, IInstantiationService)\n], ActionWidgetService);\nregisterSingleton(IActionWidgetService, ActionWidgetService, 1 /* InstantiationType.Delayed */);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 1000;\nregisterAction2(class extends Action2 {\n    constructor() {\n        super({\n            id: 'hideCodeActionWidget',\n            title: localize2('hideCodeActionWidget.title', \"Hide action widget\"),\n            precondition: ActionWidgetContextKeys.Visible,\n            keybinding: {\n                weight,\n                primary: 9 /* KeyCode.Escape */,\n                secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n            },\n        });\n    }\n    run(accessor) {\n        accessor.get(IActionWidgetService).hide();\n    }\n});\nregisterAction2(class extends Action2 {\n    constructor() {\n        super({\n            id: 'selectPrevCodeAction',\n            title: localize2('selectPrevCodeAction.title', \"Select previous action\"),\n            precondition: ActionWidgetContextKeys.Visible,\n            keybinding: {\n                weight,\n                primary: 16 /* KeyCode.UpArrow */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n                mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] },\n            }\n        });\n    }\n    run(accessor) {\n        const widgetService = accessor.get(IActionWidgetService);\n        if (widgetService instanceof ActionWidgetService) {\n            widgetService.focusPrevious();\n        }\n    }\n});\nregisterAction2(class extends Action2 {\n    constructor() {\n        super({\n            id: 'selectNextCodeAction',\n            title: localize2('selectNextCodeAction.title', \"Select next action\"),\n            precondition: ActionWidgetContextKeys.Visible,\n            keybinding: {\n                weight,\n                primary: 18 /* KeyCode.DownArrow */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n                mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n            }\n        });\n    }\n    run(accessor) {\n        const widgetService = accessor.get(IActionWidgetService);\n        if (widgetService instanceof ActionWidgetService) {\n            widgetService.focusNext();\n        }\n    }\n});\nregisterAction2(class extends Action2 {\n    constructor() {\n        super({\n            id: acceptSelectedActionCommand,\n            title: localize2('acceptSelected.title', \"Accept selected action\"),\n            precondition: ActionWidgetContextKeys.Visible,\n            keybinding: {\n                weight,\n                primary: 3 /* KeyCode.Enter */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */],\n            }\n        });\n    }\n    run(accessor) {\n        const widgetService = accessor.get(IActionWidgetService);\n        if (widgetService instanceof ActionWidgetService) {\n            widgetService.acceptSelected();\n        }\n    }\n});\nregisterAction2(class extends Action2 {\n    constructor() {\n        super({\n            id: previewSelectedActionCommand,\n            title: localize2('previewSelected.title', \"Preview selected action\"),\n            precondition: ActionWidgetContextKeys.Visible,\n            keybinding: {\n                weight,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n            }\n        });\n    }\n    run(accessor) {\n        const widgetService = accessor.get(IActionWidgetService);\n        if (widgetService instanceof ActionWidgetService) {\n            widgetService.acceptSelected(true);\n        }\n    }\n});\n", "var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../base/browser/dom.js';\nimport { KeybindingLabel } from '../../../base/browser/ui/keybindingLabel/keybindingLabel.js';\nimport { List } from '../../../base/browser/ui/list/listWidget.js';\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\nimport { Codicon } from '../../../base/common/codicons.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { OS } from '../../../base/common/platform.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport './actionWidget.css';\nimport { localize } from '../../../nls.js';\nimport { IContextViewService } from '../../contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\nimport { defaultListStyles } from '../../theme/browser/defaultStyles.js';\nimport { asCssVariable } from '../../theme/common/colorRegistry.js';\nexport const acceptSelectedActionCommand = 'acceptSelectedCodeAction';\nexport const previewSelectedActionCommand = 'previewSelectedCodeAction';\nclass HeaderRenderer {\n    get templateId() { return \"header\" /* ActionListItemKind.Header */; }\n    renderTemplate(container) {\n        container.classList.add('group-header');\n        const text = document.createElement('span');\n        container.append(text);\n        return { container, text };\n    }\n    renderElement(element, _index, templateData) {\n        var _a, _b;\n        templateData.text.textContent = (_b = (_a = element.group) === null || _a === void 0 ? void 0 : _a.title) !== null && _b !== void 0 ? _b : '';\n    }\n    disposeTemplate(_templateData) {\n        // noop\n    }\n}\nlet ActionItemRenderer = class ActionItemRenderer {\n    get templateId() { return \"action\" /* ActionListItemKind.Action */; }\n    constructor(_supportsPreview, _keybindingService) {\n        this._supportsPreview = _supportsPreview;\n        this._keybindingService = _keybindingService;\n    }\n    renderTemplate(container) {\n        container.classList.add(this.templateId);\n        const icon = document.createElement('div');\n        icon.className = 'icon';\n        container.append(icon);\n        const text = document.createElement('span');\n        text.className = 'title';\n        container.append(text);\n        const keybinding = new KeybindingLabel(container, OS);\n        return { container, icon, text, keybinding };\n    }\n    renderElement(element, _index, data) {\n        var _a, _b, _c;\n        if ((_a = element.group) === null || _a === void 0 ? void 0 : _a.icon) {\n            data.icon.className = ThemeIcon.asClassName(element.group.icon);\n            if (element.group.icon.color) {\n                data.icon.style.color = asCssVariable(element.group.icon.color.id);\n            }\n        }\n        else {\n            data.icon.className = ThemeIcon.asClassName(Codicon.lightBulb);\n            data.icon.style.color = 'var(--vscode-editorLightBulb-foreground)';\n        }\n        if (!element.item || !element.label) {\n            return;\n        }\n        data.text.textContent = stripNewlines(element.label);\n        data.keybinding.set(element.keybinding);\n        dom.setVisibility(!!element.keybinding, data.keybinding.element);\n        const actionTitle = (_b = this._keybindingService.lookupKeybinding(acceptSelectedActionCommand)) === null || _b === void 0 ? void 0 : _b.getLabel();\n        const previewTitle = (_c = this._keybindingService.lookupKeybinding(previewSelectedActionCommand)) === null || _c === void 0 ? void 0 : _c.getLabel();\n        data.container.classList.toggle('option-disabled', element.disabled);\n        if (element.disabled) {\n            data.container.title = element.label;\n        }\n        else if (actionTitle && previewTitle) {\n            if (this._supportsPreview && element.canPreview) {\n                data.container.title = localize({ key: 'label-preview', comment: ['placeholders are keybindings, e.g \"F2 to apply, Shift+F2 to preview\"'] }, \"{0} to apply, {1} to preview\", actionTitle, previewTitle);\n            }\n            else {\n                data.container.title = localize({ key: 'label', comment: ['placeholder is a keybinding, e.g \"F2 to apply\"'] }, \"{0} to apply\", actionTitle);\n            }\n        }\n        else {\n            data.container.title = '';\n        }\n    }\n    disposeTemplate(_templateData) {\n        // noop\n    }\n};\nActionItemRenderer = __decorate([\n    __param(1, IKeybindingService)\n], ActionItemRenderer);\nclass AcceptSelectedEvent extends UIEvent {\n    constructor() { super('acceptSelectedAction'); }\n}\nclass PreviewSelectedEvent extends UIEvent {\n    constructor() { super('previewSelectedAction'); }\n}\nfunction getKeyboardNavigationLabel(item) {\n    // Filter out header vs. action\n    if (item.kind === 'action') {\n        return item.label;\n    }\n    return undefined;\n}\nlet ActionList = class ActionList extends Disposable {\n    constructor(user, preview, items, _delegate, _contextViewService, _keybindingService) {\n        super();\n        this._delegate = _delegate;\n        this._contextViewService = _contextViewService;\n        this._keybindingService = _keybindingService;\n        this._actionLineHeight = 24;\n        this._headerLineHeight = 26;\n        this.cts = this._register(new CancellationTokenSource());\n        this.domNode = document.createElement('div');\n        this.domNode.classList.add('actionList');\n        const virtualDelegate = {\n            getHeight: element => element.kind === \"header\" /* ActionListItemKind.Header */ ? this._headerLineHeight : this._actionLineHeight,\n            getTemplateId: element => element.kind\n        };\n        this._list = this._register(new List(user, this.domNode, virtualDelegate, [\n            new ActionItemRenderer(preview, this._keybindingService),\n            new HeaderRenderer(),\n        ], {\n            keyboardSupport: false,\n            typeNavigationEnabled: true,\n            keyboardNavigationLabelProvider: { getKeyboardNavigationLabel },\n            accessibilityProvider: {\n                getAriaLabel: element => {\n                    if (element.kind === \"action\" /* ActionListItemKind.Action */) {\n                        let label = element.label ? stripNewlines(element === null || element === void 0 ? void 0 : element.label) : '';\n                        if (element.disabled) {\n                            label = localize({ key: 'customQuickFixWidget.labels', comment: [`Action widget labels for accessibility.`] }, \"{0}, Disabled Reason: {1}\", label, element.disabled);\n                        }\n                        return label;\n                    }\n                    return null;\n                },\n                getWidgetAriaLabel: () => localize({ key: 'customQuickFixWidget', comment: [`An action widget option`] }, \"Action Widget\"),\n                getRole: (e) => e.kind === \"action\" /* ActionListItemKind.Action */ ? 'option' : 'separator',\n                getWidgetRole: () => 'listbox',\n            },\n        }));\n        this._list.style(defaultListStyles);\n        this._register(this._list.onMouseClick(e => this.onListClick(e)));\n        this._register(this._list.onMouseOver(e => this.onListHover(e)));\n        this._register(this._list.onDidChangeFocus(() => this.onFocus()));\n        this._register(this._list.onDidChangeSelection(e => this.onListSelection(e)));\n        this._allMenuItems = items;\n        this._list.splice(0, this._list.length, this._allMenuItems);\n        if (this._list.length) {\n            this.focusNext();\n        }\n    }\n    focusCondition(element) {\n        return !element.disabled && element.kind === \"action\" /* ActionListItemKind.Action */;\n    }\n    hide(didCancel) {\n        this._delegate.onHide(didCancel);\n        this.cts.cancel();\n        this._contextViewService.hideContextView();\n    }\n    layout(minWidth) {\n        // Updating list height, depending on how many separators and headers there are.\n        const numHeaders = this._allMenuItems.filter(item => item.kind === 'header').length;\n        const itemsHeight = this._allMenuItems.length * this._actionLineHeight;\n        const heightWithHeaders = itemsHeight + numHeaders * this._headerLineHeight - numHeaders * this._actionLineHeight;\n        this._list.layout(heightWithHeaders);\n        let maxWidth = minWidth;\n        if (this._allMenuItems.length >= 50) {\n            maxWidth = 380;\n        }\n        else {\n            // For finding width dynamically (not using resize observer)\n            const itemWidths = this._allMenuItems.map((_, index) => {\n                const element = this.domNode.ownerDocument.getElementById(this._list.getElementID(index));\n                if (element) {\n                    element.style.width = 'auto';\n                    const width = element.getBoundingClientRect().width;\n                    element.style.width = '';\n                    return width;\n                }\n                return 0;\n            });\n            // resize observer - can be used in the future since list widget supports dynamic height but not width\n            maxWidth = Math.max(...itemWidths, minWidth);\n        }\n        const maxVhPrecentage = 0.7;\n        const height = Math.min(heightWithHeaders, this.domNode.ownerDocument.body.clientHeight * maxVhPrecentage);\n        this._list.layout(height, maxWidth);\n        this.domNode.style.height = `${height}px`;\n        this._list.domFocus();\n        return maxWidth;\n    }\n    focusPrevious() {\n        this._list.focusPrevious(1, true, undefined, this.focusCondition);\n    }\n    focusNext() {\n        this._list.focusNext(1, true, undefined, this.focusCondition);\n    }\n    acceptSelected(preview) {\n        const focused = this._list.getFocus();\n        if (focused.length === 0) {\n            return;\n        }\n        const focusIndex = focused[0];\n        const element = this._list.element(focusIndex);\n        if (!this.focusCondition(element)) {\n            return;\n        }\n        const event = preview ? new PreviewSelectedEvent() : new AcceptSelectedEvent();\n        this._list.setSelection([focusIndex], event);\n    }\n    onListSelection(e) {\n        if (!e.elements.length) {\n            return;\n        }\n        const element = e.elements[0];\n        if (element.item && this.focusCondition(element)) {\n            this._delegate.onSelect(element.item, e.browserEvent instanceof PreviewSelectedEvent);\n        }\n        else {\n            this._list.setSelection([]);\n        }\n    }\n    onFocus() {\n        var _a, _b;\n        const focused = this._list.getFocus();\n        if (focused.length === 0) {\n            return;\n        }\n        const focusIndex = focused[0];\n        const element = this._list.element(focusIndex);\n        (_b = (_a = this._delegate).onFocus) === null || _b === void 0 ? void 0 : _b.call(_a, element.item);\n    }\n    async onListHover(e) {\n        const element = e.element;\n        if (element && element.item && this.focusCondition(element)) {\n            if (this._delegate.onHover && !element.disabled && element.kind === \"action\" /* ActionListItemKind.Action */) {\n                const result = await this._delegate.onHover(element.item, this.cts.token);\n                element.canPreview = result ? result.canPreview : undefined;\n            }\n            if (e.index) {\n                this._list.splice(e.index, 1, [element]);\n            }\n        }\n        this._list.setFocus(typeof e.index === 'number' ? [e.index] : []);\n    }\n    onListClick(e) {\n        if (e.element && this.focusCondition(e.element)) {\n            this._list.setFocus([]);\n        }\n    }\n};\nActionList = __decorate([\n    __param(4, IContextViewService),\n    __param(5, IKeybindingService)\n], ActionList);\nexport { ActionList };\nfunction stripNewlines(str) {\n    return str.replace(/\\r\\n|\\r|\\n/g, ' ');\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createCancelablePromise, TimeoutTimer } from '../../../../base/common/async.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { ShowLightbulbIconMode } from '../../../common/config/editorOptions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../common/types.js';\nimport { getCodeActions } from './codeAction.js';\nexport const SUPPORTED_CODE_ACTIONS = new RawContextKey('supportedCodeAction', '');\nexport const APPLY_FIX_ALL_COMMAND_ID = '_typescript.applyFixAllCodeAction';\nclass CodeActionOracle extends Disposable {\n    constructor(_editor, _markerService, _signalChange, _delay = 250) {\n        super();\n        this._editor = _editor;\n        this._markerService = _markerService;\n        this._signalChange = _signalChange;\n        this._delay = _delay;\n        this._autoTriggerTimer = this._register(new TimeoutTimer());\n        this._register(this._markerService.onMarkerChanged(e => this._onMarkerChanges(e)));\n        this._register(this._editor.onDidChangeCursorPosition(() => this._tryAutoTrigger()));\n    }\n    trigger(trigger) {\n        const selection = this._getRangeOfSelectionUnlessWhitespaceEnclosed(trigger);\n        this._signalChange(selection ? { trigger, selection } : undefined);\n    }\n    _onMarkerChanges(resources) {\n        const model = this._editor.getModel();\n        if (model && resources.some(resource => isEqual(resource, model.uri))) {\n            this._tryAutoTrigger();\n        }\n    }\n    _tryAutoTrigger() {\n        this._autoTriggerTimer.cancelAndSet(() => {\n            this.trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.Default });\n        }, this._delay);\n    }\n    _getRangeOfSelectionUnlessWhitespaceEnclosed(trigger) {\n        if (!this._editor.hasModel()) {\n            return undefined;\n        }\n        const selection = this._editor.getSelection();\n        if (trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n            return selection;\n        }\n        const enabled = this._editor.getOption(65 /* EditorOption.lightbulb */).enabled;\n        if (enabled === ShowLightbulbIconMode.Off) {\n            return undefined;\n        }\n        else if (enabled === ShowLightbulbIconMode.On) {\n            return selection;\n        }\n        else if (enabled === ShowLightbulbIconMode.OnCode) {\n            const isSelectionEmpty = selection.isEmpty();\n            if (!isSelectionEmpty) {\n                return selection;\n            }\n            const model = this._editor.getModel();\n            const { lineNumber, column } = selection.getPosition();\n            const line = model.getLineContent(lineNumber);\n            if (line.length === 0) {\n                // empty line\n                return undefined;\n            }\n            else if (column === 1) {\n                // look only right\n                if (/\\s/.test(line[0])) {\n                    return undefined;\n                }\n            }\n            else if (column === model.getLineMaxColumn(lineNumber)) {\n                // look only left\n                if (/\\s/.test(line[line.length - 1])) {\n                    return undefined;\n                }\n            }\n            else {\n                // look left and right\n                if (/\\s/.test(line[column - 2]) && /\\s/.test(line[column - 1])) {\n                    return undefined;\n                }\n            }\n        }\n        return selection;\n    }\n}\nexport var CodeActionsState;\n(function (CodeActionsState) {\n    CodeActionsState.Empty = { type: 0 /* Type.Empty */ };\n    class Triggered {\n        constructor(trigger, position, _cancellablePromise) {\n            this.trigger = trigger;\n            this.position = position;\n            this._cancellablePromise = _cancellablePromise;\n            this.type = 1 /* Type.Triggered */;\n            this.actions = _cancellablePromise.catch((e) => {\n                if (isCancellationError(e)) {\n                    return emptyCodeActionSet;\n                }\n                throw e;\n            });\n        }\n        cancel() {\n            this._cancellablePromise.cancel();\n        }\n    }\n    CodeActionsState.Triggered = Triggered;\n})(CodeActionsState || (CodeActionsState = {}));\nconst emptyCodeActionSet = Object.freeze({\n    allActions: [],\n    validActions: [],\n    dispose: () => { },\n    documentation: [],\n    hasAutoFix: false,\n    hasAIFix: false,\n    allAIFixes: false,\n});\nexport class CodeActionModel extends Disposable {\n    constructor(_editor, _registry, _markerService, contextKeyService, _progressService, _configurationService) {\n        super();\n        this._editor = _editor;\n        this._registry = _registry;\n        this._markerService = _markerService;\n        this._progressService = _progressService;\n        this._configurationService = _configurationService;\n        this._codeActionOracle = this._register(new MutableDisposable());\n        this._state = CodeActionsState.Empty;\n        this._onDidChangeState = this._register(new Emitter());\n        this.onDidChangeState = this._onDidChangeState.event;\n        this._disposed = false;\n        this._supportedCodeActions = SUPPORTED_CODE_ACTIONS.bindTo(contextKeyService);\n        this._register(this._editor.onDidChangeModel(() => this._update()));\n        this._register(this._editor.onDidChangeModelLanguage(() => this._update()));\n        this._register(this._registry.onDidChange(() => this._update()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(65 /* EditorOption.lightbulb */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        if (this._disposed) {\n            return;\n        }\n        this._disposed = true;\n        super.dispose();\n        this.setState(CodeActionsState.Empty, true);\n    }\n    _settingEnabledNearbyQuickfixes() {\n        var _a;\n        const model = (_a = this._editor) === null || _a === void 0 ? void 0 : _a.getModel();\n        return this._configurationService ? this._configurationService.getValue('editor.codeActionWidget.includeNearbyQuickFixes', { resource: model === null || model === void 0 ? void 0 : model.uri }) : false;\n    }\n    _update() {\n        if (this._disposed) {\n            return;\n        }\n        this._codeActionOracle.value = undefined;\n        this.setState(CodeActionsState.Empty);\n        const model = this._editor.getModel();\n        if (model\n            && this._registry.has(model)\n            && !this._editor.getOption(91 /* EditorOption.readOnly */)) {\n            const supportedActions = this._registry.all(model).flatMap(provider => { var _a; return (_a = provider.providedCodeActionKinds) !== null && _a !== void 0 ? _a : []; });\n            this._supportedCodeActions.set(supportedActions.join(' '));\n            this._codeActionOracle.value = new CodeActionOracle(this._editor, this._markerService, trigger => {\n                var _a;\n                if (!trigger) {\n                    this.setState(CodeActionsState.Empty);\n                    return;\n                }\n                const startPosition = trigger.selection.getStartPosition();\n                const actions = createCancelablePromise(async (token) => {\n                    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n                    if (this._settingEnabledNearbyQuickfixes() && trigger.trigger.type === 1 /* CodeActionTriggerType.Invoke */ && (trigger.trigger.triggerAction === CodeActionTriggerSource.QuickFix || ((_b = (_a = trigger.trigger.filter) === null || _a === void 0 ? void 0 : _a.include) === null || _b === void 0 ? void 0 : _b.contains(CodeActionKind.QuickFix)))) {\n                        const codeActionSet = await getCodeActions(this._registry, model, trigger.selection, trigger.trigger, Progress.None, token);\n                        const allCodeActions = [...codeActionSet.allActions];\n                        if (token.isCancellationRequested) {\n                            return emptyCodeActionSet;\n                        }\n                        // Search for quickfixes in the curret code action set.\n                        const foundQuickfix = (_c = codeActionSet.validActions) === null || _c === void 0 ? void 0 : _c.some(action => action.action.kind ? CodeActionKind.QuickFix.contains(new CodeActionKind(action.action.kind)) : false);\n                        const allMarkers = this._markerService.read({ resource: model.uri });\n                        if (foundQuickfix) {\n                            for (const action of codeActionSet.validActions) {\n                                if ((_e = (_d = action.action.command) === null || _d === void 0 ? void 0 : _d.arguments) === null || _e === void 0 ? void 0 : _e.some(arg => typeof arg === 'string' && arg.includes(APPLY_FIX_ALL_COMMAND_ID))) {\n                                    action.action.diagnostics = [...allMarkers.filter(marker => marker.relatedInformation)];\n                                }\n                            }\n                            return { validActions: codeActionSet.validActions, allActions: allCodeActions, documentation: codeActionSet.documentation, hasAutoFix: codeActionSet.hasAutoFix, hasAIFix: codeActionSet.hasAIFix, allAIFixes: codeActionSet.allAIFixes, dispose: () => { codeActionSet.dispose(); } };\n                        }\n                        else if (!foundQuickfix) {\n                            // If markers exists, and there are no quickfixes found or length is zero, check for quickfixes on that line.\n                            if (allMarkers.length > 0) {\n                                const currPosition = trigger.selection.getPosition();\n                                let trackedPosition = currPosition;\n                                let distance = Number.MAX_VALUE;\n                                const currentActions = [...codeActionSet.validActions];\n                                for (const marker of allMarkers) {\n                                    const col = marker.endColumn;\n                                    const row = marker.endLineNumber;\n                                    const startRow = marker.startLineNumber;\n                                    // Found quickfix on the same line and check relative distance to other markers\n                                    if ((row === currPosition.lineNumber || startRow === currPosition.lineNumber)) {\n                                        trackedPosition = new Position(row, col);\n                                        const newCodeActionTrigger = {\n                                            type: trigger.trigger.type,\n                                            triggerAction: trigger.trigger.triggerAction,\n                                            filter: { include: ((_f = trigger.trigger.filter) === null || _f === void 0 ? void 0 : _f.include) ? (_g = trigger.trigger.filter) === null || _g === void 0 ? void 0 : _g.include : CodeActionKind.QuickFix },\n                                            autoApply: trigger.trigger.autoApply,\n                                            context: { notAvailableMessage: ((_h = trigger.trigger.context) === null || _h === void 0 ? void 0 : _h.notAvailableMessage) || '', position: trackedPosition }\n                                        };\n                                        const selectionAsPosition = new Selection(trackedPosition.lineNumber, trackedPosition.column, trackedPosition.lineNumber, trackedPosition.column);\n                                        const actionsAtMarker = await getCodeActions(this._registry, model, selectionAsPosition, newCodeActionTrigger, Progress.None, token);\n                                        if (actionsAtMarker.validActions.length !== 0) {\n                                            for (const action of actionsAtMarker.validActions) {\n                                                if ((_k = (_j = action.action.command) === null || _j === void 0 ? void 0 : _j.arguments) === null || _k === void 0 ? void 0 : _k.some(arg => typeof arg === 'string' && arg.includes(APPLY_FIX_ALL_COMMAND_ID))) {\n                                                    action.action.diagnostics = [...allMarkers.filter(marker => marker.relatedInformation)];\n                                                }\n                                            }\n                                            if (codeActionSet.allActions.length === 0) {\n                                                allCodeActions.push(...actionsAtMarker.allActions);\n                                            }\n                                            // Already filtered through to only get quickfixes, so no need to filter again.\n                                            if (Math.abs(currPosition.column - col) < distance) {\n                                                currentActions.unshift(...actionsAtMarker.validActions);\n                                            }\n                                            else {\n                                                currentActions.push(...actionsAtMarker.validActions);\n                                            }\n                                        }\n                                        distance = Math.abs(currPosition.column - col);\n                                    }\n                                }\n                                const filteredActions = currentActions.filter((action, index, self) => self.findIndex((a) => a.action.title === action.action.title) === index);\n                                filteredActions.sort((a, b) => {\n                                    if (a.action.isPreferred && !b.action.isPreferred) {\n                                        return -1;\n                                    }\n                                    else if (!a.action.isPreferred && b.action.isPreferred) {\n                                        return 1;\n                                    }\n                                    else if (a.action.isAI && !b.action.isAI) {\n                                        return 1;\n                                    }\n                                    else if (!a.action.isAI && b.action.isAI) {\n                                        return -1;\n                                    }\n                                    else {\n                                        return 0;\n                                    }\n                                });\n                                // Only retriggers if actually found quickfix on the same line as cursor\n                                return { validActions: filteredActions, allActions: allCodeActions, documentation: codeActionSet.documentation, hasAutoFix: codeActionSet.hasAutoFix, hasAIFix: codeActionSet.hasAIFix, allAIFixes: codeActionSet.allAIFixes, dispose: () => { codeActionSet.dispose(); } };\n                            }\n                        }\n                    }\n                    // temporarilly hiding here as this is enabled/disabled behind a setting.\n                    return getCodeActions(this._registry, model, trigger.selection, trigger.trigger, Progress.None, token);\n                });\n                if (trigger.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n                    (_a = this._progressService) === null || _a === void 0 ? void 0 : _a.showWhile(actions, 250);\n                }\n                this.setState(new CodeActionsState.Triggered(trigger.trigger, startPosition, actions));\n            }, undefined);\n            this._codeActionOracle.value.trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.Default });\n        }\n        else {\n            this._supportedCodeActions.reset();\n        }\n    }\n    trigger(trigger) {\n        var _a;\n        (_a = this._codeActionOracle.value) === null || _a === void 0 ? void 0 : _a.trigger(trigger);\n    }\n    setState(newState, skipNotify) {\n        if (newState === this._state) {\n            return;\n        }\n        // Cancel old request\n        if (this._state.type === 1 /* CodeActionsState.Type.Triggered */) {\n            this._state.cancel();\n        }\n        this._state = newState;\n        if (!skipNotify && !this._disposed) {\n            this._onDidChangeState.fire(newState);\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, disposableTimeout, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { getCodeLensModel } from './codelens.js';\nimport { ICodeLensCache } from './codeLensCache.js';\nimport { CodeLensHelper, CodeLensWidget } from './codelensWidget.js';\nimport { localize } from '../../../../nls.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nlet CodeLensContribution = class CodeLensContribution {\n    constructor(_editor, _languageFeaturesService, debounceService, _commandService, _notificationService, _codeLensCache) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._codeLensCache = _codeLensCache;\n        this._disposables = new DisposableStore();\n        this._localToDispose = new DisposableStore();\n        this._lenses = [];\n        this._oldCodeLensModels = new DisposableStore();\n        this._provideCodeLensDebounce = debounceService.for(_languageFeaturesService.codeLensProvider, 'CodeLensProvide', { min: 250 });\n        this._resolveCodeLensesDebounce = debounceService.for(_languageFeaturesService.codeLensProvider, 'CodeLensResolve', { min: 250, salt: 'resolve' });\n        this._resolveCodeLensesScheduler = new RunOnceScheduler(() => this._resolveCodeLensesInViewport(), this._resolveCodeLensesDebounce.default());\n        this._disposables.add(this._editor.onDidChangeModel(() => this._onModelChange()));\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => this._onModelChange()));\n        this._disposables.add(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */) || e.hasChanged(19 /* EditorOption.codeLensFontSize */) || e.hasChanged(18 /* EditorOption.codeLensFontFamily */)) {\n                this._updateLensStyle();\n            }\n            if (e.hasChanged(17 /* EditorOption.codeLens */)) {\n                this._onModelChange();\n            }\n        }));\n        this._disposables.add(_languageFeaturesService.codeLensProvider.onDidChange(this._onModelChange, this));\n        this._onModelChange();\n        this._updateLensStyle();\n    }\n    dispose() {\n        var _a;\n        this._localDispose();\n        this._disposables.dispose();\n        this._oldCodeLensModels.dispose();\n        (_a = this._currentCodeLensModel) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n    _getLayoutInfo() {\n        const lineHeightFactor = Math.max(1.3, this._editor.getOption(67 /* EditorOption.lineHeight */) / this._editor.getOption(52 /* EditorOption.fontSize */));\n        let fontSize = this._editor.getOption(19 /* EditorOption.codeLensFontSize */);\n        if (!fontSize || fontSize < 5) {\n            fontSize = (this._editor.getOption(52 /* EditorOption.fontSize */) * .9) | 0;\n        }\n        return {\n            fontSize,\n            codeLensHeight: (fontSize * lineHeightFactor) | 0,\n        };\n    }\n    _updateLensStyle() {\n        const { codeLensHeight, fontSize } = this._getLayoutInfo();\n        const fontFamily = this._editor.getOption(18 /* EditorOption.codeLensFontFamily */);\n        const editorFontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const { style } = this._editor.getContainerDomNode();\n        style.setProperty('--vscode-editorCodeLens-lineHeight', `${codeLensHeight}px`);\n        style.setProperty('--vscode-editorCodeLens-fontSize', `${fontSize}px`);\n        style.setProperty('--vscode-editorCodeLens-fontFeatureSettings', editorFontInfo.fontFeatureSettings);\n        if (fontFamily) {\n            style.setProperty('--vscode-editorCodeLens-fontFamily', fontFamily);\n            style.setProperty('--vscode-editorCodeLens-fontFamilyDefault', EDITOR_FONT_DEFAULTS.fontFamily);\n        }\n        //\n        this._editor.changeViewZones(accessor => {\n            for (const lens of this._lenses) {\n                lens.updateHeight(codeLensHeight, accessor);\n            }\n        });\n    }\n    _localDispose() {\n        var _a, _b, _c;\n        (_a = this._getCodeLensModelPromise) === null || _a === void 0 ? void 0 : _a.cancel();\n        this._getCodeLensModelPromise = undefined;\n        (_b = this._resolveCodeLensesPromise) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._resolveCodeLensesPromise = undefined;\n        this._localToDispose.clear();\n        this._oldCodeLensModels.clear();\n        (_c = this._currentCodeLensModel) === null || _c === void 0 ? void 0 : _c.dispose();\n    }\n    _onModelChange() {\n        this._localDispose();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (!this._editor.getOption(17 /* EditorOption.codeLens */) || model.isTooLargeForTokenization()) {\n            return;\n        }\n        const cachedLenses = this._codeLensCache.get(model);\n        if (cachedLenses) {\n            this._renderCodeLensSymbols(cachedLenses);\n        }\n        if (!this._languageFeaturesService.codeLensProvider.has(model)) {\n            // no provider -> return but check with\n            // cached lenses. they expire after 30 seconds\n            if (cachedLenses) {\n                disposableTimeout(() => {\n                    const cachedLensesNow = this._codeLensCache.get(model);\n                    if (cachedLenses === cachedLensesNow) {\n                        this._codeLensCache.delete(model);\n                        this._onModelChange();\n                    }\n                }, 30 * 1000, this._localToDispose);\n            }\n            return;\n        }\n        for (const provider of this._languageFeaturesService.codeLensProvider.all(model)) {\n            if (typeof provider.onDidChange === 'function') {\n                const registration = provider.onDidChange(() => scheduler.schedule());\n                this._localToDispose.add(registration);\n            }\n        }\n        const scheduler = new RunOnceScheduler(() => {\n            var _a;\n            const t1 = Date.now();\n            (_a = this._getCodeLensModelPromise) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._getCodeLensModelPromise = createCancelablePromise(token => getCodeLensModel(this._languageFeaturesService.codeLensProvider, model, token));\n            this._getCodeLensModelPromise.then(result => {\n                if (this._currentCodeLensModel) {\n                    this._oldCodeLensModels.add(this._currentCodeLensModel);\n                }\n                this._currentCodeLensModel = result;\n                // cache model to reduce flicker\n                this._codeLensCache.put(model, result);\n                // update moving average\n                const newDelay = this._provideCodeLensDebounce.update(model, Date.now() - t1);\n                scheduler.delay = newDelay;\n                // render lenses\n                this._renderCodeLensSymbols(result);\n                // dom.scheduleAtNextAnimationFrame(() => this._resolveCodeLensesInViewport());\n                this._resolveCodeLensesInViewportSoon();\n            }, onUnexpectedError);\n        }, this._provideCodeLensDebounce.get(model));\n        this._localToDispose.add(scheduler);\n        this._localToDispose.add(toDisposable(() => this._resolveCodeLensesScheduler.cancel()));\n        this._localToDispose.add(this._editor.onDidChangeModelContent(() => {\n            var _a;\n            this._editor.changeDecorations(decorationsAccessor => {\n                this._editor.changeViewZones(viewZonesAccessor => {\n                    const toDispose = [];\n                    let lastLensLineNumber = -1;\n                    this._lenses.forEach((lens) => {\n                        if (!lens.isValid() || lastLensLineNumber === lens.getLineNumber()) {\n                            // invalid -> lens collapsed, attach range doesn't exist anymore\n                            // line_number -> lenses should never be on the same line\n                            toDispose.push(lens);\n                        }\n                        else {\n                            lens.update(viewZonesAccessor);\n                            lastLensLineNumber = lens.getLineNumber();\n                        }\n                    });\n                    const helper = new CodeLensHelper();\n                    toDispose.forEach((l) => {\n                        l.dispose(helper, viewZonesAccessor);\n                        this._lenses.splice(this._lenses.indexOf(l), 1);\n                    });\n                    helper.commit(decorationsAccessor);\n                });\n            });\n            // Ask for all references again\n            scheduler.schedule();\n            // Cancel pending and active resolve requests\n            this._resolveCodeLensesScheduler.cancel();\n            (_a = this._resolveCodeLensesPromise) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._resolveCodeLensesPromise = undefined;\n        }));\n        this._localToDispose.add(this._editor.onDidFocusEditorWidget(() => {\n            scheduler.schedule();\n        }));\n        this._localToDispose.add(this._editor.onDidBlurEditorText(() => {\n            scheduler.cancel();\n        }));\n        this._localToDispose.add(this._editor.onDidScrollChange(e => {\n            if (e.scrollTopChanged && this._lenses.length > 0) {\n                this._resolveCodeLensesInViewportSoon();\n            }\n        }));\n        this._localToDispose.add(this._editor.onDidLayoutChange(() => {\n            this._resolveCodeLensesInViewportSoon();\n        }));\n        this._localToDispose.add(toDisposable(() => {\n            if (this._editor.getModel()) {\n                const scrollState = StableEditorScrollState.capture(this._editor);\n                this._editor.changeDecorations(decorationsAccessor => {\n                    this._editor.changeViewZones(viewZonesAccessor => {\n                        this._disposeAllLenses(decorationsAccessor, viewZonesAccessor);\n                    });\n                });\n                scrollState.restore(this._editor);\n            }\n            else {\n                // No accessors available\n                this._disposeAllLenses(undefined, undefined);\n            }\n        }));\n        this._localToDispose.add(this._editor.onMouseDown(e => {\n            if (e.target.type !== 9 /* MouseTargetType.CONTENT_WIDGET */) {\n                return;\n            }\n            let target = e.target.element;\n            if ((target === null || target === void 0 ? void 0 : target.tagName) === 'SPAN') {\n                target = target.parentElement;\n            }\n            if ((target === null || target === void 0 ? void 0 : target.tagName) === 'A') {\n                for (const lens of this._lenses) {\n                    const command = lens.getCommand(target);\n                    if (command) {\n                        this._commandService.executeCommand(command.id, ...(command.arguments || [])).catch(err => this._notificationService.error(err));\n                        break;\n                    }\n                }\n            }\n        }));\n        scheduler.schedule();\n    }\n    _disposeAllLenses(decChangeAccessor, viewZoneChangeAccessor) {\n        const helper = new CodeLensHelper();\n        for (const lens of this._lenses) {\n            lens.dispose(helper, viewZoneChangeAccessor);\n        }\n        if (decChangeAccessor) {\n            helper.commit(decChangeAccessor);\n        }\n        this._lenses.length = 0;\n    }\n    _renderCodeLensSymbols(symbols) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const maxLineNumber = this._editor.getModel().getLineCount();\n        const groups = [];\n        let lastGroup;\n        for (const symbol of symbols.lenses) {\n            const line = symbol.symbol.range.startLineNumber;\n            if (line < 1 || line > maxLineNumber) {\n                // invalid code lens\n                continue;\n            }\n            else if (lastGroup && lastGroup[lastGroup.length - 1].symbol.range.startLineNumber === line) {\n                // on same line as previous\n                lastGroup.push(symbol);\n            }\n            else {\n                // on later line as previous\n                lastGroup = [symbol];\n                groups.push(lastGroup);\n            }\n        }\n        if (!groups.length && !this._lenses.length) {\n            // Nothing to change\n            return;\n        }\n        const scrollState = StableEditorScrollState.capture(this._editor);\n        const layoutInfo = this._getLayoutInfo();\n        this._editor.changeDecorations(decorationsAccessor => {\n            this._editor.changeViewZones(viewZoneAccessor => {\n                const helper = new CodeLensHelper();\n                let codeLensIndex = 0;\n                let groupsIndex = 0;\n                while (groupsIndex < groups.length && codeLensIndex < this._lenses.length) {\n                    const symbolsLineNumber = groups[groupsIndex][0].symbol.range.startLineNumber;\n                    const codeLensLineNumber = this._lenses[codeLensIndex].getLineNumber();\n                    if (codeLensLineNumber < symbolsLineNumber) {\n                        this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n                        this._lenses.splice(codeLensIndex, 1);\n                    }\n                    else if (codeLensLineNumber === symbolsLineNumber) {\n                        this._lenses[codeLensIndex].updateCodeLensSymbols(groups[groupsIndex], helper);\n                        groupsIndex++;\n                        codeLensIndex++;\n                    }\n                    else {\n                        this._lenses.splice(codeLensIndex, 0, new CodeLensWidget(groups[groupsIndex], this._editor, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n                        codeLensIndex++;\n                        groupsIndex++;\n                    }\n                }\n                // Delete extra code lenses\n                while (codeLensIndex < this._lenses.length) {\n                    this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n                    this._lenses.splice(codeLensIndex, 1);\n                }\n                // Create extra symbols\n                while (groupsIndex < groups.length) {\n                    this._lenses.push(new CodeLensWidget(groups[groupsIndex], this._editor, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n                    groupsIndex++;\n                }\n                helper.commit(decorationsAccessor);\n            });\n        });\n        scrollState.restore(this._editor);\n    }\n    _resolveCodeLensesInViewportSoon() {\n        const model = this._editor.getModel();\n        if (model) {\n            this._resolveCodeLensesScheduler.schedule();\n        }\n    }\n    _resolveCodeLensesInViewport() {\n        var _a;\n        (_a = this._resolveCodeLensesPromise) === null || _a === void 0 ? void 0 : _a.cancel();\n        this._resolveCodeLensesPromise = undefined;\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        const toResolve = [];\n        const lenses = [];\n        this._lenses.forEach((lens) => {\n            const request = lens.computeIfNecessary(model);\n            if (request) {\n                toResolve.push(request);\n                lenses.push(lens);\n            }\n        });\n        if (toResolve.length === 0) {\n            return;\n        }\n        const t1 = Date.now();\n        const resolvePromise = createCancelablePromise(token => {\n            const promises = toResolve.map((request, i) => {\n                const resolvedSymbols = new Array(request.length);\n                const promises = request.map((request, i) => {\n                    if (!request.symbol.command && typeof request.provider.resolveCodeLens === 'function') {\n                        return Promise.resolve(request.provider.resolveCodeLens(model, request.symbol, token)).then(symbol => {\n                            resolvedSymbols[i] = symbol;\n                        }, onUnexpectedExternalError);\n                    }\n                    else {\n                        resolvedSymbols[i] = request.symbol;\n                        return Promise.resolve(undefined);\n                    }\n                });\n                return Promise.all(promises).then(() => {\n                    if (!token.isCancellationRequested && !lenses[i].isDisposed()) {\n                        lenses[i].updateCommands(resolvedSymbols);\n                    }\n                });\n            });\n            return Promise.all(promises);\n        });\n        this._resolveCodeLensesPromise = resolvePromise;\n        this._resolveCodeLensesPromise.then(() => {\n            // update moving average\n            const newDelay = this._resolveCodeLensesDebounce.update(model, Date.now() - t1);\n            this._resolveCodeLensesScheduler.delay = newDelay;\n            if (this._currentCodeLensModel) { // update the cached state with new resolved items\n                this._codeLensCache.put(model, this._currentCodeLensModel);\n            }\n            this._oldCodeLensModels.clear(); // dispose old models once we have updated the UI with the current model\n            if (resolvePromise === this._resolveCodeLensesPromise) {\n                this._resolveCodeLensesPromise = undefined;\n            }\n        }, err => {\n            onUnexpectedError(err); // can also be cancellation!\n            if (resolvePromise === this._resolveCodeLensesPromise) {\n                this._resolveCodeLensesPromise = undefined;\n            }\n        });\n    }\n    async getModel() {\n        var _a;\n        await this._getCodeLensModelPromise;\n        await this._resolveCodeLensesPromise;\n        return !((_a = this._currentCodeLensModel) === null || _a === void 0 ? void 0 : _a.isDisposed)\n            ? this._currentCodeLensModel\n            : undefined;\n    }\n};\nCodeLensContribution.ID = 'css.editor.codeLens';\nCodeLensContribution = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, ICommandService),\n    __param(4, INotificationService),\n    __param(5, ICodeLensCache)\n], CodeLensContribution);\nexport { CodeLensContribution };\nregisterEditorContribution(CodeLensContribution.ID, CodeLensContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(class ShowLensesInCurrentLine extends EditorAction {\n    constructor() {\n        super({\n            id: 'codelens.showLensesInCurrentLine',\n            precondition: EditorContextKeys.hasCodeLensProvider,\n            label: localize('showLensOnLine', \"Show CodeLens Commands For Current Line\"),\n            alias: 'Show CodeLens Commands For Current Line',\n        });\n    }\n    async run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const quickInputService = accessor.get(IQuickInputService);\n        const commandService = accessor.get(ICommandService);\n        const notificationService = accessor.get(INotificationService);\n        const lineNumber = editor.getSelection().positionLineNumber;\n        const codelensController = editor.getContribution(CodeLensContribution.ID);\n        if (!codelensController) {\n            return;\n        }\n        const model = await codelensController.getModel();\n        if (!model) {\n            // nothing\n            return;\n        }\n        const items = [];\n        for (const lens of model.lenses) {\n            if (lens.symbol.command && lens.symbol.range.startLineNumber === lineNumber) {\n                items.push({\n                    label: lens.symbol.command.title,\n                    command: lens.symbol.command\n                });\n            }\n        }\n        if (items.length === 0) {\n            // We dont want an empty picker\n            return;\n        }\n        const item = await quickInputService.pick(items, {\n            canPickMany: false,\n            placeHolder: localize('placeHolder', \"Select a command\")\n        });\n        if (!item) {\n            // Nothing picked\n            return;\n        }\n        let command = item.command;\n        if (model.isDisposed) {\n            // try to find the same command again in-case the model has been re-created in the meantime\n            // this is a best attempt approach which shouldn't be needed because eager model re-creates\n            // shouldn't happen due to focus in/out anymore\n            const newModel = await codelensController.getModel();\n            const newLens = newModel === null || newModel === void 0 ? void 0 : newModel.lenses.find(lens => { var _a; return lens.symbol.range.startLineNumber === lineNumber && ((_a = lens.symbol.command) === null || _a === void 0 ? void 0 : _a.title) === command.title; });\n            if (!newLens || !newLens.symbol.command) {\n                return;\n            }\n            command = newLens.symbol.command;\n        }\n        try {\n            await commandService.executeCommand(command.id, ...(command.arguments || []));\n        }\n        catch (err) {\n            notificationService.error(err);\n        }\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class CodeLensModel {\n    constructor() {\n        this.lenses = [];\n        this._disposables = new DisposableStore();\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    get isDisposed() {\n        return this._disposables.isDisposed;\n    }\n    add(list, provider) {\n        this._disposables.add(list);\n        for (const symbol of list.lenses) {\n            this.lenses.push({ symbol, provider });\n        }\n    }\n}\nexport async function getCodeLensModel(registry, model, token) {\n    const provider = registry.ordered(model);\n    const providerRanks = new Map();\n    const result = new CodeLensModel();\n    const promises = provider.map(async (provider, i) => {\n        providerRanks.set(provider, i);\n        try {\n            const list = await Promise.resolve(provider.provideCodeLenses(model, token));\n            if (list) {\n                result.add(list, provider);\n            }\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n        }\n    });\n    await Promise.all(promises);\n    result.lenses = result.lenses.sort((a, b) => {\n        // sort by lineNumber, provider-rank, and column\n        if (a.symbol.range.startLineNumber < b.symbol.range.startLineNumber) {\n            return -1;\n        }\n        else if (a.symbol.range.startLineNumber > b.symbol.range.startLineNumber) {\n            return 1;\n        }\n        else if ((providerRanks.get(a.provider)) < (providerRanks.get(b.provider))) {\n            return -1;\n        }\n        else if ((providerRanks.get(a.provider)) > (providerRanks.get(b.provider))) {\n            return 1;\n        }\n        else if (a.symbol.range.startColumn < b.symbol.range.startColumn) {\n            return -1;\n        }\n        else if (a.symbol.range.startColumn > b.symbol.range.startColumn) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    });\n    return result;\n}\nCommandsRegistry.registerCommand('_executeCodeLensProvider', function (accessor, ...args) {\n    let [uri, itemResolveCount] = args;\n    assertType(URI.isUri(uri));\n    assertType(typeof itemResolveCount === 'number' || !itemResolveCount);\n    const { codeLensProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const result = [];\n    const disposables = new DisposableStore();\n    return getCodeLensModel(codeLensProvider, model, CancellationToken.None).then(value => {\n        disposables.add(value);\n        const resolve = [];\n        for (const item of value.lenses) {\n            if (itemResolveCount === undefined || itemResolveCount === null || Boolean(item.symbol.command)) {\n                result.push(item.symbol);\n            }\n            else if (itemResolveCount-- > 0 && item.provider.resolveCodeLens) {\n                resolve.push(Promise.resolve(item.provider.resolveCodeLens(model, item.symbol, CancellationToken.None)).then(symbol => result.push(symbol || item.symbol)));\n            }\n        }\n        return Promise.all(resolve);\n    }).then(() => {\n        return result;\n    }).finally(() => {\n        // make sure to return results, then (on next tick)\n        // dispose the results\n        setTimeout(() => disposables.dispose(), 100);\n    });\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Event } from '../../../../base/common/event.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { Range } from '../../../common/core/range.js';\nimport { CodeLensModel } from './codelens.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { runWhenWindowIdle } from '../../../../base/browser/dom.js';\nexport const ICodeLensCache = createDecorator('ICodeLensCache');\nclass CacheItem {\n    constructor(lineCount, data) {\n        this.lineCount = lineCount;\n        this.data = data;\n    }\n}\nlet CodeLensCache = class CodeLensCache {\n    constructor(storageService) {\n        this._fakeProvider = new class {\n            provideCodeLenses() {\n                throw new Error('not supported');\n            }\n        };\n        this._cache = new LRUCache(20, 0.75);\n        // remove old data\n        const oldkey = 'codelens/cache';\n        runWhenWindowIdle(mainWindow, () => storageService.remove(oldkey, 1 /* StorageScope.WORKSPACE */));\n        // restore lens data on start\n        const key = 'codelens/cache2';\n        const raw = storageService.get(key, 1 /* StorageScope.WORKSPACE */, '{}');\n        this._deserialize(raw);\n        // store lens data on shutdown\n        Event.once(storageService.onWillSaveState)(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                storageService.store(key, this._serialize(), 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n            }\n        });\n    }\n    put(model, data) {\n        // create a copy of the model that is without command-ids\n        // but with comand-labels\n        const copyItems = data.lenses.map(item => {\n            var _a;\n            return {\n                range: item.symbol.range,\n                command: item.symbol.command && { id: '', title: (_a = item.symbol.command) === null || _a === void 0 ? void 0 : _a.title },\n            };\n        });\n        const copyModel = new CodeLensModel();\n        copyModel.add({ lenses: copyItems, dispose: () => { } }, this._fakeProvider);\n        const item = new CacheItem(model.getLineCount(), copyModel);\n        this._cache.set(model.uri.toString(), item);\n    }\n    get(model) {\n        const item = this._cache.get(model.uri.toString());\n        return item && item.lineCount === model.getLineCount() ? item.data : undefined;\n    }\n    delete(model) {\n        this._cache.delete(model.uri.toString());\n    }\n    // --- persistence\n    _serialize() {\n        const data = Object.create(null);\n        for (const [key, value] of this._cache) {\n            const lines = new Set();\n            for (const d of value.data.lenses) {\n                lines.add(d.symbol.range.startLineNumber);\n            }\n            data[key] = {\n                lineCount: value.lineCount,\n                lines: [...lines.values()]\n            };\n        }\n        return JSON.stringify(data);\n    }\n    _deserialize(raw) {\n        try {\n            const data = JSON.parse(raw);\n            for (const key in data) {\n                const element = data[key];\n                const lenses = [];\n                for (const line of element.lines) {\n                    lenses.push({ range: new Range(line, 1, line, 11) });\n                }\n                const model = new CodeLensModel();\n                model.add({ lenses, dispose() { } }, this._fakeProvider);\n                this._cache.set(key, new CacheItem(element.lineCount, model));\n            }\n        }\n        catch (_a) {\n            // ignore...\n        }\n    }\n};\nCodeLensCache = __decorate([\n    __param(0, IStorageService)\n], CodeLensCache);\nexport { CodeLensCache };\nregisterSingleton(ICodeLensCache, CodeLensCache, 1 /* InstantiationType.Delayed */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { renderLabelWithIcons } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport './codelensWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nclass CodeLensViewZone {\n    constructor(afterLineNumber, heightInPx, onHeight) {\n        /**\n         * We want that this view zone, which reserves space for a code lens appears\n         * as close as possible to the next line, so we use a very large value here.\n         */\n        this.afterColumn = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        this.afterLineNumber = afterLineNumber;\n        this.heightInPx = heightInPx;\n        this._onHeight = onHeight;\n        this.suppressMouseDown = true;\n        this.domNode = document.createElement('div');\n    }\n    onComputedHeight(height) {\n        if (this._lastHeight === undefined) {\n            this._lastHeight = height;\n        }\n        else if (this._lastHeight !== height) {\n            this._lastHeight = height;\n            this._onHeight();\n        }\n    }\n    isVisible() {\n        return this._lastHeight !== 0\n            && this.domNode.hasAttribute('monaco-visible-view-zone');\n    }\n}\nclass CodeLensContentWidget {\n    constructor(editor, line) {\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = false;\n        this.suppressMouseDown = true;\n        this._commands = new Map();\n        this._isEmpty = true;\n        this._editor = editor;\n        this._id = `codelens.widget-${(CodeLensContentWidget._idPool++)}`;\n        this.updatePosition(line);\n        this._domNode = document.createElement('span');\n        this._domNode.className = `codelens-decoration`;\n    }\n    withCommands(lenses, animate) {\n        this._commands.clear();\n        const children = [];\n        let hasSymbol = false;\n        for (let i = 0; i < lenses.length; i++) {\n            const lens = lenses[i];\n            if (!lens) {\n                continue;\n            }\n            hasSymbol = true;\n            if (lens.command) {\n                const title = renderLabelWithIcons(lens.command.title.trim());\n                if (lens.command.id) {\n                    const id = `c${(CodeLensContentWidget._idPool++)}`;\n                    children.push(dom.$('a', { id, title: lens.command.tooltip, role: 'button' }, ...title));\n                    this._commands.set(id, lens.command);\n                }\n                else {\n                    children.push(dom.$('span', { title: lens.command.tooltip }, ...title));\n                }\n                if (i + 1 < lenses.length) {\n                    children.push(dom.$('span', undefined, '\\u00a0|\\u00a0'));\n                }\n            }\n        }\n        if (!hasSymbol) {\n            // symbols but no commands\n            dom.reset(this._domNode, dom.$('span', undefined, 'no commands'));\n        }\n        else {\n            // symbols and commands\n            dom.reset(this._domNode, ...children);\n            if (this._isEmpty && animate) {\n                this._domNode.classList.add('fadein');\n            }\n            this._isEmpty = false;\n        }\n    }\n    getCommand(link) {\n        return link.parentElement === this._domNode\n            ? this._commands.get(link.id)\n            : undefined;\n    }\n    getId() {\n        return this._id;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    updatePosition(line) {\n        const column = this._editor.getModel().getLineFirstNonWhitespaceColumn(line);\n        this._widgetPosition = {\n            position: { lineNumber: line, column: column },\n            preference: [1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    getPosition() {\n        return this._widgetPosition || null;\n    }\n}\nCodeLensContentWidget._idPool = 0;\nexport class CodeLensHelper {\n    constructor() {\n        this._removeDecorations = [];\n        this._addDecorations = [];\n        this._addDecorationsCallbacks = [];\n    }\n    addDecoration(decoration, callback) {\n        this._addDecorations.push(decoration);\n        this._addDecorationsCallbacks.push(callback);\n    }\n    removeDecoration(decorationId) {\n        this._removeDecorations.push(decorationId);\n    }\n    commit(changeAccessor) {\n        const resultingDecorations = changeAccessor.deltaDecorations(this._removeDecorations, this._addDecorations);\n        for (let i = 0, len = resultingDecorations.length; i < len; i++) {\n            this._addDecorationsCallbacks[i](resultingDecorations[i]);\n        }\n    }\n}\nconst codeLensDecorationOptions = ModelDecorationOptions.register({\n    collapseOnReplaceEdit: true,\n    description: 'codelens'\n});\nexport class CodeLensWidget {\n    constructor(data, editor, helper, viewZoneChangeAccessor, heightInPx, updateCallback) {\n        this._isDisposed = false;\n        this._editor = editor;\n        this._data = data;\n        // create combined range, track all ranges with decorations,\n        // check if there is already something to render\n        this._decorationIds = [];\n        let range;\n        const lenses = [];\n        this._data.forEach((codeLensData, i) => {\n            if (codeLensData.symbol.command) {\n                lenses.push(codeLensData.symbol);\n            }\n            helper.addDecoration({\n                range: codeLensData.symbol.range,\n                options: codeLensDecorationOptions\n            }, id => this._decorationIds[i] = id);\n            // the range contains all lenses on this line\n            if (!range) {\n                range = Range.lift(codeLensData.symbol.range);\n            }\n            else {\n                range = Range.plusRange(range, codeLensData.symbol.range);\n            }\n        });\n        this._viewZone = new CodeLensViewZone(range.startLineNumber - 1, heightInPx, updateCallback);\n        this._viewZoneId = viewZoneChangeAccessor.addZone(this._viewZone);\n        if (lenses.length > 0) {\n            this._createContentWidgetIfNecessary();\n            this._contentWidget.withCommands(lenses, false);\n        }\n    }\n    _createContentWidgetIfNecessary() {\n        if (!this._contentWidget) {\n            this._contentWidget = new CodeLensContentWidget(this._editor, this._viewZone.afterLineNumber + 1);\n            this._editor.addContentWidget(this._contentWidget);\n        }\n        else {\n            this._editor.layoutContentWidget(this._contentWidget);\n        }\n    }\n    dispose(helper, viewZoneChangeAccessor) {\n        this._decorationIds.forEach(helper.removeDecoration, helper);\n        this._decorationIds = [];\n        viewZoneChangeAccessor === null || viewZoneChangeAccessor === void 0 ? void 0 : viewZoneChangeAccessor.removeZone(this._viewZoneId);\n        if (this._contentWidget) {\n            this._editor.removeContentWidget(this._contentWidget);\n            this._contentWidget = undefined;\n        }\n        this._isDisposed = true;\n    }\n    isDisposed() {\n        return this._isDisposed;\n    }\n    isValid() {\n        return this._decorationIds.some((id, i) => {\n            const range = this._editor.getModel().getDecorationRange(id);\n            const symbol = this._data[i].symbol;\n            return !!(range && Range.isEmpty(symbol.range) === range.isEmpty());\n        });\n    }\n    updateCodeLensSymbols(data, helper) {\n        this._decorationIds.forEach(helper.removeDecoration, helper);\n        this._decorationIds = [];\n        this._data = data;\n        this._data.forEach((codeLensData, i) => {\n            helper.addDecoration({\n                range: codeLensData.symbol.range,\n                options: codeLensDecorationOptions\n            }, id => this._decorationIds[i] = id);\n        });\n    }\n    updateHeight(height, viewZoneChangeAccessor) {\n        this._viewZone.heightInPx = height;\n        viewZoneChangeAccessor.layoutZone(this._viewZoneId);\n        if (this._contentWidget) {\n            this._editor.layoutContentWidget(this._contentWidget);\n        }\n    }\n    computeIfNecessary(model) {\n        if (!this._viewZone.isVisible()) {\n            return null;\n        }\n        // Read editor current state\n        for (let i = 0; i < this._decorationIds.length; i++) {\n            const range = model.getDecorationRange(this._decorationIds[i]);\n            if (range) {\n                this._data[i].symbol.range = range;\n            }\n        }\n        return this._data;\n    }\n    updateCommands(symbols) {\n        this._createContentWidgetIfNecessary();\n        this._contentWidget.withCommands(symbols, true);\n        for (let i = 0; i < this._data.length; i++) {\n            const resolved = symbols[i];\n            if (resolved) {\n                const { symbol } = this._data[i];\n                symbol.command = resolved.command || symbol.command;\n            }\n        }\n    }\n    getCommand(link) {\n        var _a;\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.getCommand(link);\n    }\n    getLineNumber() {\n        const range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n        if (range) {\n            return range.startLineNumber;\n        }\n        return -1;\n    }\n    update(viewZoneChangeAccessor) {\n        if (this.isValid()) {\n            const range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n            if (range) {\n                this._viewZone.afterLineNumber = range.startLineNumber - 1;\n                viewZoneChangeAccessor.layoutZone(this._viewZoneId);\n                if (this._contentWidget) {\n                    this._contentWidget.updatePosition(range.startLineNumber);\n                    this._editor.layoutContentWidget(this._contentWidget);\n                }\n            }\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ColorDecorationInjectedTextMarker } from './colorDetector.js';\nimport { ColorHoverParticipant } from './colorHoverParticipant.js';\nimport { HoverController } from '../../hover/browser/hover.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nexport class ColorContribution extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._register(_editor.onMouseDown((e) => this.onMouseDown(e)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    onMouseDown(mouseEvent) {\n        const colorDecoratorsActivatedOn = this._editor.getOption(147 /* EditorOption.colorDecoratorsActivatedOn */);\n        if (colorDecoratorsActivatedOn !== 'click' && colorDecoratorsActivatedOn !== 'clickAndHover') {\n            return;\n        }\n        const target = mouseEvent.target;\n        if (target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return;\n        }\n        if (!target.detail.injectedText) {\n            return;\n        }\n        if (target.detail.injectedText.options.attachedData !== ColorDecorationInjectedTextMarker) {\n            return;\n        }\n        if (!target.range) {\n            return;\n        }\n        const hoverController = this._editor.getContribution(HoverController.ID);\n        if (!hoverController) {\n            return;\n        }\n        if (!hoverController.isColorPickerVisible) {\n            const range = new Range(target.range.startLineNumber, target.range.startColumn + 1, target.range.endLineNumber, target.range.endColumn + 1);\n            hoverController.showContentHover(range, 1 /* HoverStartMode.Immediate */, 0 /* HoverStartSource.Mouse */, false, true);\n        }\n    }\n}\nColorContribution.ID = 'editor.contrib.colorContribution'; // ms\nregisterEditorContribution(ColorContribution.ID, ColorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nHoverParticipantRegistry.register(ColorHoverParticipant);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ColorDetector_1;\nimport { createCancelablePromise, TimeoutTimer } from '../../../../base/common/async.js';\nimport { RGBA } from '../../../../base/common/color.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { noBreakWhitespace } from '../../../../base/common/strings.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getColors } from './color.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport const ColorDecorationInjectedTextMarker = Object.create({});\nlet ColorDetector = ColorDetector_1 = class ColorDetector extends Disposable {\n    constructor(_editor, _configurationService, _languageFeaturesService, languageFeatureDebounceService) {\n        super();\n        this._editor = _editor;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._localToDispose = this._register(new DisposableStore());\n        this._decorationsIds = [];\n        this._colorDatas = new Map();\n        this._colorDecoratorIds = this._editor.createDecorationsCollection();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._decoratorLimitReporter = new DecoratorLimitReporter();\n        this._colorDecorationClassRefs = this._register(new DisposableStore());\n        this._debounceInformation = languageFeatureDebounceService.for(_languageFeaturesService.colorProvider, 'Document Colors', { min: ColorDetector_1.RECOMPUTE_TIME });\n        this._register(_editor.onDidChangeModel(() => {\n            this._isColorDecoratorsEnabled = this.isEnabled();\n            this.updateColors();\n        }));\n        this._register(_editor.onDidChangeModelLanguage(() => this.updateColors()));\n        this._register(_languageFeaturesService.colorProvider.onDidChange(() => this.updateColors()));\n        this._register(_editor.onDidChangeConfiguration((e) => {\n            const prevIsEnabled = this._isColorDecoratorsEnabled;\n            this._isColorDecoratorsEnabled = this.isEnabled();\n            this._isDefaultColorDecoratorsEnabled = this._editor.getOption(146 /* EditorOption.defaultColorDecorators */);\n            const updatedColorDecoratorsSetting = prevIsEnabled !== this._isColorDecoratorsEnabled || e.hasChanged(21 /* EditorOption.colorDecoratorsLimit */);\n            const updatedDefaultColorDecoratorsSetting = e.hasChanged(146 /* EditorOption.defaultColorDecorators */);\n            if (updatedColorDecoratorsSetting || updatedDefaultColorDecoratorsSetting) {\n                if (this._isColorDecoratorsEnabled) {\n                    this.updateColors();\n                }\n                else {\n                    this.removeAllDecorations();\n                }\n            }\n        }));\n        this._timeoutTimer = null;\n        this._computePromise = null;\n        this._isColorDecoratorsEnabled = this.isEnabled();\n        this._isDefaultColorDecoratorsEnabled = this._editor.getOption(146 /* EditorOption.defaultColorDecorators */);\n        this.updateColors();\n    }\n    isEnabled() {\n        const model = this._editor.getModel();\n        if (!model) {\n            return false;\n        }\n        const languageId = model.getLanguageId();\n        // handle deprecated settings. [languageId].colorDecorators.enable\n        const deprecatedConfig = this._configurationService.getValue(languageId);\n        if (deprecatedConfig && typeof deprecatedConfig === 'object') {\n            const colorDecorators = deprecatedConfig['colorDecorators']; // deprecatedConfig.valueOf('.colorDecorators.enable');\n            if (colorDecorators && colorDecorators['enable'] !== undefined && !colorDecorators['enable']) {\n                return colorDecorators['enable'];\n            }\n        }\n        return this._editor.getOption(20 /* EditorOption.colorDecorators */);\n    }\n    static get(editor) {\n        return editor.getContribution(this.ID);\n    }\n    dispose() {\n        this.stop();\n        this.removeAllDecorations();\n        super.dispose();\n    }\n    updateColors() {\n        this.stop();\n        if (!this._isColorDecoratorsEnabled) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.colorProvider.has(model)) {\n            return;\n        }\n        this._localToDispose.add(this._editor.onDidChangeModelContent(() => {\n            if (!this._timeoutTimer) {\n                this._timeoutTimer = new TimeoutTimer();\n                this._timeoutTimer.cancelAndSet(() => {\n                    this._timeoutTimer = null;\n                    this.beginCompute();\n                }, this._debounceInformation.get(model));\n            }\n        }));\n        this.beginCompute();\n    }\n    async beginCompute() {\n        this._computePromise = createCancelablePromise(async (token) => {\n            const model = this._editor.getModel();\n            if (!model) {\n                return [];\n            }\n            const sw = new StopWatch(false);\n            const colors = await getColors(this._languageFeaturesService.colorProvider, model, token, this._isDefaultColorDecoratorsEnabled);\n            this._debounceInformation.update(model, sw.elapsed());\n            return colors;\n        });\n        try {\n            const colors = await this._computePromise;\n            this.updateDecorations(colors);\n            this.updateColorDecorators(colors);\n            this._computePromise = null;\n        }\n        catch (e) {\n            onUnexpectedError(e);\n        }\n    }\n    stop() {\n        if (this._timeoutTimer) {\n            this._timeoutTimer.cancel();\n            this._timeoutTimer = null;\n        }\n        if (this._computePromise) {\n            this._computePromise.cancel();\n            this._computePromise = null;\n        }\n        this._localToDispose.clear();\n    }\n    updateDecorations(colorDatas) {\n        const decorations = colorDatas.map(c => ({\n            range: {\n                startLineNumber: c.colorInfo.range.startLineNumber,\n                startColumn: c.colorInfo.range.startColumn,\n                endLineNumber: c.colorInfo.range.endLineNumber,\n                endColumn: c.colorInfo.range.endColumn\n            },\n            options: ModelDecorationOptions.EMPTY\n        }));\n        this._editor.changeDecorations((changeAccessor) => {\n            this._decorationsIds = changeAccessor.deltaDecorations(this._decorationsIds, decorations);\n            this._colorDatas = new Map();\n            this._decorationsIds.forEach((id, i) => this._colorDatas.set(id, colorDatas[i]));\n        });\n    }\n    updateColorDecorators(colorData) {\n        this._colorDecorationClassRefs.clear();\n        const decorations = [];\n        const limit = this._editor.getOption(21 /* EditorOption.colorDecoratorsLimit */);\n        for (let i = 0; i < colorData.length && decorations.length < limit; i++) {\n            const { red, green, blue, alpha } = colorData[i].colorInfo.color;\n            const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n            const color = `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n            const ref = this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({\n                backgroundColor: color\n            }));\n            decorations.push({\n                range: {\n                    startLineNumber: colorData[i].colorInfo.range.startLineNumber,\n                    startColumn: colorData[i].colorInfo.range.startColumn,\n                    endLineNumber: colorData[i].colorInfo.range.endLineNumber,\n                    endColumn: colorData[i].colorInfo.range.endColumn\n                },\n                options: {\n                    description: 'colorDetector',\n                    before: {\n                        content: noBreakWhitespace,\n                        inlineClassName: `${ref.className} colorpicker-color-decoration`,\n                        inlineClassNameAffectsLetterSpacing: true,\n                        attachedData: ColorDecorationInjectedTextMarker\n                    }\n                }\n            });\n        }\n        const limited = limit < colorData.length ? limit : false;\n        this._decoratorLimitReporter.update(colorData.length, limited);\n        this._colorDecoratorIds.set(decorations);\n    }\n    removeAllDecorations() {\n        this._editor.removeDecorations(this._decorationsIds);\n        this._decorationsIds = [];\n        this._colorDecoratorIds.clear();\n        this._colorDecorationClassRefs.clear();\n    }\n    getColorData(position) {\n        const model = this._editor.getModel();\n        if (!model) {\n            return null;\n        }\n        const decorations = model\n            .getDecorationsInRange(Range.fromPositions(position, position))\n            .filter(d => this._colorDatas.has(d.id));\n        if (decorations.length === 0) {\n            return null;\n        }\n        return this._colorDatas.get(decorations[0].id);\n    }\n    isColorDecoration(decoration) {\n        return this._colorDecoratorIds.has(decoration);\n    }\n};\nColorDetector.ID = 'editor.contrib.colorDetector';\nColorDetector.RECOMPUTE_TIME = 1000; // ms\nColorDetector = ColorDetector_1 = __decorate([\n    __param(1, IConfigurationService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ILanguageFeatureDebounceService)\n], ColorDetector);\nexport { ColorDetector };\nexport class DecoratorLimitReporter {\n    constructor() {\n        this._onDidChange = new Emitter();\n        this._computed = 0;\n        this._limited = false;\n    }\n    update(computed, limited) {\n        if (computed !== this._computed || limited !== this._limited) {\n            this._computed = computed;\n            this._limited = limited;\n            this._onDidChange.fire();\n        }\n    }\n}\nregisterEditorContribution(ColorDetector.ID, ColorDetector, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DefaultDocumentColorProvider } from './defaultDocumentColorProvider.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport async function getColors(colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled = true) {\n    return _findColorData(new ColorDataCollector(), colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled);\n}\nexport function getColorPresentations(model, colorInfo, provider, token) {\n    return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\n}\nclass ColorDataCollector {\n    constructor() { }\n    async compute(provider, model, token, colors) {\n        const documentColors = await provider.provideDocumentColors(model, token);\n        if (Array.isArray(documentColors)) {\n            for (const colorInfo of documentColors) {\n                colors.push({ colorInfo, provider });\n            }\n        }\n        return Array.isArray(documentColors);\n    }\n}\nclass ExtColorDataCollector {\n    constructor() { }\n    async compute(provider, model, token, colors) {\n        const documentColors = await provider.provideDocumentColors(model, token);\n        if (Array.isArray(documentColors)) {\n            for (const colorInfo of documentColors) {\n                colors.push({ range: colorInfo.range, color: [colorInfo.color.red, colorInfo.color.green, colorInfo.color.blue, colorInfo.color.alpha] });\n            }\n        }\n        return Array.isArray(documentColors);\n    }\n}\nclass ColorPresentationsCollector {\n    constructor(colorInfo) {\n        this.colorInfo = colorInfo;\n    }\n    async compute(provider, model, _token, colors) {\n        const documentColors = await provider.provideColorPresentations(model, this.colorInfo, CancellationToken.None);\n        if (Array.isArray(documentColors)) {\n            colors.push(...documentColors);\n        }\n        return Array.isArray(documentColors);\n    }\n}\nasync function _findColorData(collector, colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled) {\n    let validDocumentColorProviderFound = false;\n    let defaultProvider;\n    const colorData = [];\n    const documentColorProviders = colorProviderRegistry.ordered(model);\n    for (let i = documentColorProviders.length - 1; i >= 0; i--) {\n        const provider = documentColorProviders[i];\n        if (provider instanceof DefaultDocumentColorProvider) {\n            defaultProvider = provider;\n        }\n        else {\n            try {\n                if (await collector.compute(provider, model, token, colorData)) {\n                    validDocumentColorProviderFound = true;\n                }\n            }\n            catch (e) {\n                onUnexpectedExternalError(e);\n            }\n        }\n    }\n    if (validDocumentColorProviderFound) {\n        return colorData;\n    }\n    if (defaultProvider && isDefaultColorDecoratorsEnabled) {\n        await collector.compute(defaultProvider, model, token, colorData);\n        return colorData;\n    }\n    return [];\n}\nfunction _setupColorCommand(accessor, resource) {\n    const { colorProvider: colorProviderRegistry } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const isDefaultColorDecoratorsEnabled = accessor.get(IConfigurationService).getValue('editor.defaultColorDecorators', { resource });\n    return { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled };\n}\nCommandsRegistry.registerCommand('_executeDocumentColorProvider', function (accessor, ...args) {\n    const [resource] = args;\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled } = _setupColorCommand(accessor, resource);\n    return _findColorData(new ExtColorDataCollector(), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});\nCommandsRegistry.registerCommand('_executeColorPresentationProvider', function (accessor, ...args) {\n    const [color, context] = args;\n    const { uri, range } = context;\n    if (!(uri instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\n        throw illegalArgument();\n    }\n    const { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled } = _setupColorCommand(accessor, uri);\n    const [red, green, blue, alpha] = color;\n    return _findColorData(new ColorPresentationsCollector({ range: range, color: { red, green, blue, alpha } }), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { EditorWorkerClient } from '../../../browser/services/editorWorkerService.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nexport class DefaultDocumentColorProvider {\n    constructor(modelService, languageConfigurationService) {\n        this._editorWorkerClient = new EditorWorkerClient(modelService, false, 'editorWorkerService', languageConfigurationService);\n    }\n    async provideDocumentColors(model, _token) {\n        return this._editorWorkerClient.computeDefaultDocumentColors(model.uri);\n    }\n    provideColorPresentations(_model, colorInfo, _token) {\n        const range = colorInfo.range;\n        const colorFromInfo = colorInfo.color;\n        const alpha = colorFromInfo.alpha;\n        const color = new Color(new RGBA(Math.round(255 * colorFromInfo.red), Math.round(255 * colorFromInfo.green), Math.round(255 * colorFromInfo.blue), alpha));\n        const rgb = alpha ? Color.Format.CSS.formatRGB(color) : Color.Format.CSS.formatRGBA(color);\n        const hsl = alpha ? Color.Format.CSS.formatHSL(color) : Color.Format.CSS.formatHSLA(color);\n        const hex = alpha ? Color.Format.CSS.formatHex(color) : Color.Format.CSS.formatHexA(color);\n        const colorPresentations = [];\n        colorPresentations.push({ label: rgb, textEdit: { range: range, text: rgb } });\n        colorPresentations.push({ label: hsl, textEdit: { range: range, text: hsl } });\n        colorPresentations.push({ label: hex, textEdit: { range: range, text: hex } });\n        return colorPresentations;\n    }\n}\nlet DefaultDocumentColorProviderFeature = class DefaultDocumentColorProviderFeature extends Disposable {\n    constructor(_modelService, _languageConfigurationService, _languageFeaturesService) {\n        super();\n        this._register(_languageFeaturesService.colorProvider.register('*', new DefaultDocumentColorProvider(_modelService, _languageConfigurationService)));\n    }\n};\nDefaultDocumentColorProviderFeature = __decorate([\n    __param(0, IModelService),\n    __param(1, ILanguageConfigurationService),\n    __param(2, ILanguageFeaturesService)\n], DefaultDocumentColorProviderFeature);\nregisterEditorFeature(DefaultDocumentColorProviderFeature);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getColorPresentations, getColors } from './color.js';\nimport { ColorDetector } from './colorDetector.js';\nimport { ColorPickerModel } from './colorPickerModel.js';\nimport { ColorPickerWidget } from './colorPickerWidget.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { Dimension } from '../../../../base/browser/dom.js';\nexport class ColorHover {\n    constructor(owner, range, model, provider) {\n        this.owner = owner;\n        this.range = range;\n        this.model = model;\n        this.provider = provider;\n        /**\n         * Force the hover to always be rendered at this specific range,\n         * even in the case of multiple hover parts.\n         */\n        this.forceShowAtRange = true;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet ColorHoverParticipant = class ColorHoverParticipant {\n    constructor(_editor, _themeService) {\n        this._editor = _editor;\n        this._themeService = _themeService;\n        this.hoverOrdinal = 2;\n    }\n    computeSync(_anchor, _lineDecorations) {\n        return [];\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        return AsyncIterableObject.fromPromise(this._computeAsync(anchor, lineDecorations, token));\n    }\n    async _computeAsync(_anchor, lineDecorations, _token) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        const colorDetector = ColorDetector.get(this._editor);\n        if (!colorDetector) {\n            return [];\n        }\n        for (const d of lineDecorations) {\n            if (!colorDetector.isColorDecoration(d)) {\n                continue;\n            }\n            const colorData = colorDetector.getColorData(d.range.getStartPosition());\n            if (colorData) {\n                const colorHover = await _createColorHover(this, this._editor.getModel(), colorData.colorInfo, colorData.provider);\n                return [colorHover];\n            }\n        }\n        return [];\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderHoverParts(this, this._editor, this._themeService, hoverParts, context);\n    }\n};\nColorHoverParticipant = __decorate([\n    __param(1, IThemeService)\n], ColorHoverParticipant);\nexport { ColorHoverParticipant };\nexport class StandaloneColorPickerHover {\n    constructor(owner, range, model, provider) {\n        this.owner = owner;\n        this.range = range;\n        this.model = model;\n        this.provider = provider;\n    }\n}\nlet StandaloneColorPickerParticipant = class StandaloneColorPickerParticipant {\n    constructor(_editor, _themeService) {\n        this._editor = _editor;\n        this._themeService = _themeService;\n        this._color = null;\n    }\n    async createColorHover(defaultColorInfo, defaultColorProvider, colorProviderRegistry) {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const colorDetector = ColorDetector.get(this._editor);\n        if (!colorDetector) {\n            return null;\n        }\n        const colors = await getColors(colorProviderRegistry, this._editor.getModel(), CancellationToken.None);\n        let foundColorInfo = null;\n        let foundColorProvider = null;\n        for (const colorData of colors) {\n            const colorInfo = colorData.colorInfo;\n            if (Range.containsRange(colorInfo.range, defaultColorInfo.range)) {\n                foundColorInfo = colorInfo;\n                foundColorProvider = colorData.provider;\n            }\n        }\n        const colorInfo = foundColorInfo !== null && foundColorInfo !== void 0 ? foundColorInfo : defaultColorInfo;\n        const colorProvider = foundColorProvider !== null && foundColorProvider !== void 0 ? foundColorProvider : defaultColorProvider;\n        const foundInEditor = !!foundColorInfo;\n        return { colorHover: await _createColorHover(this, this._editor.getModel(), colorInfo, colorProvider), foundInEditor: foundInEditor };\n    }\n    async updateEditorModel(colorHoverData) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const colorPickerModel = colorHoverData.model;\n        let range = new Range(colorHoverData.range.startLineNumber, colorHoverData.range.startColumn, colorHoverData.range.endLineNumber, colorHoverData.range.endColumn);\n        if (this._color) {\n            await _updateColorPresentations(this._editor.getModel(), colorPickerModel, this._color, range, colorHoverData);\n            range = _updateEditorModel(this._editor, range, colorPickerModel);\n        }\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderHoverParts(this, this._editor, this._themeService, hoverParts, context);\n    }\n    set color(color) {\n        this._color = color;\n    }\n    get color() {\n        return this._color;\n    }\n};\nStandaloneColorPickerParticipant = __decorate([\n    __param(1, IThemeService)\n], StandaloneColorPickerParticipant);\nexport { StandaloneColorPickerParticipant };\nasync function _createColorHover(participant, editorModel, colorInfo, provider) {\n    const originalText = editorModel.getValueInRange(colorInfo.range);\n    const { red, green, blue, alpha } = colorInfo.color;\n    const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n    const color = new Color(rgba);\n    const colorPresentations = await getColorPresentations(editorModel, colorInfo, provider, CancellationToken.None);\n    const model = new ColorPickerModel(color, [], 0);\n    model.colorPresentations = colorPresentations || [];\n    model.guessColorPresentation(color, originalText);\n    if (participant instanceof ColorHoverParticipant) {\n        return new ColorHover(participant, Range.lift(colorInfo.range), model, provider);\n    }\n    else {\n        return new StandaloneColorPickerHover(participant, Range.lift(colorInfo.range), model, provider);\n    }\n}\nfunction renderHoverParts(participant, editor, themeService, hoverParts, context) {\n    if (hoverParts.length === 0 || !editor.hasModel()) {\n        return Disposable.None;\n    }\n    if (context.setMinimumDimensions) {\n        const minimumHeight = editor.getOption(67 /* EditorOption.lineHeight */) + 8;\n        context.setMinimumDimensions(new Dimension(302, minimumHeight));\n    }\n    const disposables = new DisposableStore();\n    const colorHover = hoverParts[0];\n    const editorModel = editor.getModel();\n    const model = colorHover.model;\n    const widget = disposables.add(new ColorPickerWidget(context.fragment, model, editor.getOption(142 /* EditorOption.pixelRatio */), themeService, participant instanceof StandaloneColorPickerParticipant));\n    context.setColorPicker(widget);\n    let editorUpdatedByColorPicker = false;\n    let range = new Range(colorHover.range.startLineNumber, colorHover.range.startColumn, colorHover.range.endLineNumber, colorHover.range.endColumn);\n    if (participant instanceof StandaloneColorPickerParticipant) {\n        const color = hoverParts[0].model.color;\n        participant.color = color;\n        _updateColorPresentations(editorModel, model, color, range, colorHover);\n        disposables.add(model.onColorFlushed((color) => {\n            participant.color = color;\n        }));\n    }\n    else {\n        disposables.add(model.onColorFlushed(async (color) => {\n            await _updateColorPresentations(editorModel, model, color, range, colorHover);\n            editorUpdatedByColorPicker = true;\n            range = _updateEditorModel(editor, range, model);\n        }));\n    }\n    disposables.add(model.onDidChangeColor((color) => {\n        _updateColorPresentations(editorModel, model, color, range, colorHover);\n    }));\n    disposables.add(editor.onDidChangeModelContent((e) => {\n        if (editorUpdatedByColorPicker) {\n            editorUpdatedByColorPicker = false;\n        }\n        else {\n            context.hide();\n            editor.focus();\n        }\n    }));\n    return disposables;\n}\nfunction _updateEditorModel(editor, range, model) {\n    var _a, _b;\n    const textEdits = [];\n    const edit = (_a = model.presentation.textEdit) !== null && _a !== void 0 ? _a : { range, text: model.presentation.label, forceMoveMarkers: false };\n    textEdits.push(edit);\n    if (model.presentation.additionalTextEdits) {\n        textEdits.push(...model.presentation.additionalTextEdits);\n    }\n    const replaceRange = Range.lift(edit.range);\n    const trackedRange = editor.getModel()._setTrackedRange(null, replaceRange, 3 /* TrackedRangeStickiness.GrowsOnlyWhenTypingAfter */);\n    editor.executeEdits('colorpicker', textEdits);\n    editor.pushUndoStop();\n    return (_b = editor.getModel()._getTrackedRange(trackedRange)) !== null && _b !== void 0 ? _b : replaceRange;\n}\nasync function _updateColorPresentations(editorModel, colorPickerModel, color, range, colorHover) {\n    const colorPresentations = await getColorPresentations(editorModel, {\n        range: range,\n        color: {\n            red: color.rgba.r / 255,\n            green: color.rgba.g / 255,\n            blue: color.rgba.b / 255,\n            alpha: color.rgba.a\n        }\n    }, colorHover.provider, CancellationToken.None);\n    colorPickerModel.colorPresentations = colorPresentations || [];\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nexport class ColorPickerModel {\n    get color() {\n        return this._color;\n    }\n    set color(color) {\n        if (this._color.equals(color)) {\n            return;\n        }\n        this._color = color;\n        this._onDidChangeColor.fire(color);\n    }\n    get presentation() { return this.colorPresentations[this.presentationIndex]; }\n    get colorPresentations() {\n        return this._colorPresentations;\n    }\n    set colorPresentations(colorPresentations) {\n        this._colorPresentations = colorPresentations;\n        if (this.presentationIndex > colorPresentations.length - 1) {\n            this.presentationIndex = 0;\n        }\n        this._onDidChangePresentation.fire(this.presentation);\n    }\n    constructor(color, availableColorPresentations, presentationIndex) {\n        this.presentationIndex = presentationIndex;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        this._onDidChangeColor = new Emitter();\n        this.onDidChangeColor = this._onDidChangeColor.event;\n        this._onDidChangePresentation = new Emitter();\n        this.onDidChangePresentation = this._onDidChangePresentation.event;\n        this.originalColor = color;\n        this._color = color;\n        this._colorPresentations = availableColorPresentations;\n    }\n    selectNextColorPresentation() {\n        this.presentationIndex = (this.presentationIndex + 1) % this.colorPresentations.length;\n        this.flushColor();\n        this._onDidChangePresentation.fire(this.presentation);\n    }\n    guessColorPresentation(color, originalText) {\n        let presentationIndex = -1;\n        for (let i = 0; i < this.colorPresentations.length; i++) {\n            if (originalText.toLowerCase() === this.colorPresentations[i].label) {\n                presentationIndex = i;\n                break;\n            }\n        }\n        if (presentationIndex === -1) {\n            // check which color presentation text has same prefix as original text's prefix\n            const originalTextPrefix = originalText.split('(')[0].toLowerCase();\n            for (let i = 0; i < this.colorPresentations.length; i++) {\n                if (this.colorPresentations[i].label.toLowerCase().startsWith(originalTextPrefix)) {\n                    presentationIndex = i;\n                    break;\n                }\n            }\n        }\n        if (presentationIndex !== -1 && presentationIndex !== this.presentationIndex) {\n            this.presentationIndex = presentationIndex;\n            this._onDidChangePresentation.fire(this.presentation);\n        }\n    }\n    flushColor() {\n        this._onColorFlushed.fire(this._color);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PixelRatio } from '../../../../base/browser/pixelRatio.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { GlobalPointerMoveMonitor } from '../../../../base/browser/globalPointerMoveMonitor.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Color, HSVA, RGBA } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './colorPicker.css';\nimport { localize } from '../../../../nls.js';\nimport { editorHoverBackground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nconst $ = dom.$;\nexport class ColorPickerHeader extends Disposable {\n    constructor(container, model, themeService, showingStandaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this.showingStandaloneColorPicker = showingStandaloneColorPicker;\n        this._closeButton = null;\n        this._domNode = $('.colorpicker-header');\n        dom.append(container, this._domNode);\n        this._pickedColorNode = dom.append(this._domNode, $('.picked-color'));\n        dom.append(this._pickedColorNode, $('span.codicon.codicon-color-mode'));\n        this._pickedColorPresentation = dom.append(this._pickedColorNode, document.createElement('span'));\n        this._pickedColorPresentation.classList.add('picked-color-presentation');\n        const tooltip = localize('clickToToggleColorOptions', \"Click to toggle color options (rgb/hsl/hex)\");\n        this._pickedColorNode.setAttribute('title', tooltip);\n        this._originalColorNode = dom.append(this._domNode, $('.original-color'));\n        this._originalColorNode.style.backgroundColor = Color.Format.CSS.format(this.model.originalColor) || '';\n        this.backgroundColor = themeService.getColorTheme().getColor(editorHoverBackground) || Color.white;\n        this._register(themeService.onDidColorThemeChange(theme => {\n            this.backgroundColor = theme.getColor(editorHoverBackground) || Color.white;\n        }));\n        this._register(dom.addDisposableListener(this._pickedColorNode, dom.EventType.CLICK, () => this.model.selectNextColorPresentation()));\n        this._register(dom.addDisposableListener(this._originalColorNode, dom.EventType.CLICK, () => {\n            this.model.color = this.model.originalColor;\n            this.model.flushColor();\n        }));\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\n        this._register(model.onDidChangePresentation(this.onDidChangePresentation, this));\n        this._pickedColorNode.style.backgroundColor = Color.Format.CSS.format(model.color) || '';\n        this._pickedColorNode.classList.toggle('light', model.color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : model.color.isLighter());\n        this.onDidChangeColor(this.model.color);\n        // When the color picker widget is a standalone color picker widget, then add a close button\n        if (this.showingStandaloneColorPicker) {\n            this._domNode.classList.add('standalone-colorpicker');\n            this._closeButton = this._register(new CloseButton(this._domNode));\n        }\n    }\n    get closeButton() {\n        return this._closeButton;\n    }\n    get pickedColorNode() {\n        return this._pickedColorNode;\n    }\n    get originalColorNode() {\n        return this._originalColorNode;\n    }\n    onDidChangeColor(color) {\n        this._pickedColorNode.style.backgroundColor = Color.Format.CSS.format(color) || '';\n        this._pickedColorNode.classList.toggle('light', color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : color.isLighter());\n        this.onDidChangePresentation();\n    }\n    onDidChangePresentation() {\n        this._pickedColorPresentation.textContent = this.model.presentation ? this.model.presentation.label : '';\n    }\n}\nclass CloseButton extends Disposable {\n    constructor(container) {\n        super();\n        this._onClicked = this._register(new Emitter());\n        this.onClicked = this._onClicked.event;\n        this._button = document.createElement('div');\n        this._button.classList.add('close-button');\n        dom.append(container, this._button);\n        const innerDiv = document.createElement('div');\n        innerDiv.classList.add('close-button-inner-div');\n        dom.append(this._button, innerDiv);\n        const closeButton = dom.append(innerDiv, $('.button' + ThemeIcon.asCSSSelector(registerIcon('color-picker-close', Codicon.close, localize('closeIcon', 'Icon to close the color picker')))));\n        closeButton.classList.add('close-icon');\n        this._register(dom.addDisposableListener(this._button, dom.EventType.CLICK, () => {\n            this._onClicked.fire();\n        }));\n    }\n}\nexport class ColorPickerBody extends Disposable {\n    constructor(container, model, pixelRatio, isStandaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._insertButton = null;\n        this._domNode = $('.colorpicker-body');\n        dom.append(container, this._domNode);\n        this._saturationBox = new SaturationBox(this._domNode, this.model, this.pixelRatio);\n        this._register(this._saturationBox);\n        this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange, this));\n        this._register(this._saturationBox.onColorFlushed(this.flushColor, this));\n        this._opacityStrip = new OpacityStrip(this._domNode, this.model, isStandaloneColorPicker);\n        this._register(this._opacityStrip);\n        this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange, this));\n        this._register(this._opacityStrip.onColorFlushed(this.flushColor, this));\n        this._hueStrip = new HueStrip(this._domNode, this.model, isStandaloneColorPicker);\n        this._register(this._hueStrip);\n        this._register(this._hueStrip.onDidChange(this.onDidHueChange, this));\n        this._register(this._hueStrip.onColorFlushed(this.flushColor, this));\n        if (isStandaloneColorPicker) {\n            this._insertButton = this._register(new InsertButton(this._domNode));\n            this._domNode.classList.add('standalone-colorpicker');\n        }\n    }\n    flushColor() {\n        this.model.flushColor();\n    }\n    onDidSaturationValueChange({ s, v }) {\n        const hsva = this.model.color.hsva;\n        this.model.color = new Color(new HSVA(hsva.h, s, v, hsva.a));\n    }\n    onDidOpacityChange(a) {\n        const hsva = this.model.color.hsva;\n        this.model.color = new Color(new HSVA(hsva.h, hsva.s, hsva.v, a));\n    }\n    onDidHueChange(value) {\n        const hsva = this.model.color.hsva;\n        const h = (1 - value) * 360;\n        this.model.color = new Color(new HSVA(h === 360 ? 0 : h, hsva.s, hsva.v, hsva.a));\n    }\n    get domNode() {\n        return this._domNode;\n    }\n    get saturationBox() {\n        return this._saturationBox;\n    }\n    get enterButton() {\n        return this._insertButton;\n    }\n    layout() {\n        this._saturationBox.layout();\n        this._opacityStrip.layout();\n        this._hueStrip.layout();\n    }\n}\nclass SaturationBox extends Disposable {\n    constructor(container, model, pixelRatio) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        this._domNode = $('.saturation-wrap');\n        dom.append(container, this._domNode);\n        // Create canvas, draw selected color\n        this._canvas = document.createElement('canvas');\n        this._canvas.className = 'saturation-box';\n        dom.append(this._domNode, this._canvas);\n        // Add selection circle\n        this.selection = $('.saturation-selection');\n        dom.append(this._domNode, this.selection);\n        this.layout();\n        this._register(dom.addDisposableListener(this._domNode, dom.EventType.POINTER_DOWN, e => this.onPointerDown(e)));\n        this._register(this.model.onDidChangeColor(this.onDidChangeColor, this));\n        this.monitor = null;\n    }\n    get domNode() {\n        return this._domNode;\n    }\n    onPointerDown(e) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        this.monitor = this._register(new GlobalPointerMoveMonitor());\n        const origin = dom.getDomNodePagePosition(this._domNode);\n        if (e.target !== this.selection) {\n            this.onDidChangePosition(e.offsetX, e.offsetY);\n        }\n        this.monitor.startMonitoring(e.target, e.pointerId, e.buttons, event => this.onDidChangePosition(event.pageX - origin.left, event.pageY - origin.top), () => null);\n        const pointerUpListener = dom.addDisposableListener(e.target.ownerDocument, dom.EventType.POINTER_UP, () => {\n            this._onColorFlushed.fire();\n            pointerUpListener.dispose();\n            if (this.monitor) {\n                this.monitor.stopMonitoring(true);\n                this.monitor = null;\n            }\n        }, true);\n    }\n    onDidChangePosition(left, top) {\n        const s = Math.max(0, Math.min(1, left / this.width));\n        const v = Math.max(0, Math.min(1, 1 - (top / this.height)));\n        this.paintSelection(s, v);\n        this._onDidChange.fire({ s, v });\n    }\n    layout() {\n        this.width = this._domNode.offsetWidth;\n        this.height = this._domNode.offsetHeight;\n        this._canvas.width = this.width * this.pixelRatio;\n        this._canvas.height = this.height * this.pixelRatio;\n        this.paint();\n        const hsva = this.model.color.hsva;\n        this.paintSelection(hsva.s, hsva.v);\n    }\n    paint() {\n        const hsva = this.model.color.hsva;\n        const saturatedColor = new Color(new HSVA(hsva.h, 1, 1, 1));\n        const ctx = this._canvas.getContext('2d');\n        const whiteGradient = ctx.createLinearGradient(0, 0, this._canvas.width, 0);\n        whiteGradient.addColorStop(0, 'rgba(255, 255, 255, 1)');\n        whiteGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.5)');\n        whiteGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\n        const blackGradient = ctx.createLinearGradient(0, 0, 0, this._canvas.height);\n        blackGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\n        blackGradient.addColorStop(1, 'rgba(0, 0, 0, 1)');\n        ctx.rect(0, 0, this._canvas.width, this._canvas.height);\n        ctx.fillStyle = Color.Format.CSS.format(saturatedColor);\n        ctx.fill();\n        ctx.fillStyle = whiteGradient;\n        ctx.fill();\n        ctx.fillStyle = blackGradient;\n        ctx.fill();\n    }\n    paintSelection(s, v) {\n        this.selection.style.left = `${s * this.width}px`;\n        this.selection.style.top = `${this.height - v * this.height}px`;\n    }\n    onDidChangeColor(color) {\n        if (this.monitor && this.monitor.isMonitoring()) {\n            return;\n        }\n        this.paint();\n        const hsva = color.hsva;\n        this.paintSelection(hsva.s, hsva.v);\n    }\n}\nclass Strip extends Disposable {\n    constructor(container, model, showingStandaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        if (showingStandaloneColorPicker) {\n            this.domNode = dom.append(container, $('.standalone-strip'));\n            this.overlay = dom.append(this.domNode, $('.standalone-overlay'));\n        }\n        else {\n            this.domNode = dom.append(container, $('.strip'));\n            this.overlay = dom.append(this.domNode, $('.overlay'));\n        }\n        this.slider = dom.append(this.domNode, $('.slider'));\n        this.slider.style.top = `0px`;\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.POINTER_DOWN, e => this.onPointerDown(e)));\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\n        this.layout();\n    }\n    layout() {\n        this.height = this.domNode.offsetHeight - this.slider.offsetHeight;\n        const value = this.getValue(this.model.color);\n        this.updateSliderPosition(value);\n    }\n    onDidChangeColor(color) {\n        const value = this.getValue(color);\n        this.updateSliderPosition(value);\n    }\n    onPointerDown(e) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const monitor = this._register(new GlobalPointerMoveMonitor());\n        const origin = dom.getDomNodePagePosition(this.domNode);\n        this.domNode.classList.add('grabbing');\n        if (e.target !== this.slider) {\n            this.onDidChangeTop(e.offsetY);\n        }\n        monitor.startMonitoring(e.target, e.pointerId, e.buttons, event => this.onDidChangeTop(event.pageY - origin.top), () => null);\n        const pointerUpListener = dom.addDisposableListener(e.target.ownerDocument, dom.EventType.POINTER_UP, () => {\n            this._onColorFlushed.fire();\n            pointerUpListener.dispose();\n            monitor.stopMonitoring(true);\n            this.domNode.classList.remove('grabbing');\n        }, true);\n    }\n    onDidChangeTop(top) {\n        const value = Math.max(0, Math.min(1, 1 - (top / this.height)));\n        this.updateSliderPosition(value);\n        this._onDidChange.fire(value);\n    }\n    updateSliderPosition(value) {\n        this.slider.style.top = `${(1 - value) * this.height}px`;\n    }\n}\nclass OpacityStrip extends Strip {\n    constructor(container, model, showingStandaloneColorPicker = false) {\n        super(container, model, showingStandaloneColorPicker);\n        this.domNode.classList.add('opacity-strip');\n        this.onDidChangeColor(this.model.color);\n    }\n    onDidChangeColor(color) {\n        super.onDidChangeColor(color);\n        const { r, g, b } = color.rgba;\n        const opaque = new Color(new RGBA(r, g, b, 1));\n        const transparent = new Color(new RGBA(r, g, b, 0));\n        this.overlay.style.background = `linear-gradient(to bottom, ${opaque} 0%, ${transparent} 100%)`;\n    }\n    getValue(color) {\n        return color.hsva.a;\n    }\n}\nclass HueStrip extends Strip {\n    constructor(container, model, showingStandaloneColorPicker = false) {\n        super(container, model, showingStandaloneColorPicker);\n        this.domNode.classList.add('hue-strip');\n    }\n    getValue(color) {\n        return 1 - (color.hsva.h / 360);\n    }\n}\nexport class InsertButton extends Disposable {\n    constructor(container) {\n        super();\n        this._onClicked = this._register(new Emitter());\n        this.onClicked = this._onClicked.event;\n        this._button = dom.append(container, document.createElement('button'));\n        this._button.classList.add('insert-button');\n        this._button.textContent = 'Insert';\n        this._register(dom.addDisposableListener(this._button, dom.EventType.CLICK, () => {\n            this._onClicked.fire();\n        }));\n    }\n    get button() {\n        return this._button;\n    }\n}\nexport class ColorPickerWidget extends Widget {\n    constructor(container, model, pixelRatio, themeService, standaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._register(PixelRatio.getInstance(dom.getWindow(container)).onDidChange(() => this.layout()));\n        const element = $('.colorpicker-widget');\n        container.appendChild(element);\n        this.header = this._register(new ColorPickerHeader(element, this.model, themeService, standaloneColorPicker));\n        this.body = this._register(new ColorPickerBody(element, this.model, this.pixelRatio, standaloneColorPicker));\n    }\n    layout() {\n        this.body.layout();\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar HoverController_1;\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { GotoDefinitionAtPositionEditorContribution } from '../../gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport { ContentHoverWidget, ContentHoverController } from './contentHover.js';\nimport { MarginHoverWidget } from './marginHover.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { editorHoverBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { HoverParticipantRegistry } from './hoverTypes.js';\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\nimport { MarkerHoverParticipant } from './markerHoverParticipant.js';\nimport { InlineSuggestionHintsContentWidget } from '../../inlineCompletions/browser/inlineCompletionsHintsWidget.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport * as nls from '../../../../nls.js';\nimport './hover.css';\n// sticky hover widget which doesn't disappear on focus out and such\nconst _sticky = false;\nlet HoverController = HoverController_1 = class HoverController extends Disposable {\n    constructor(_editor, _instantiationService, _openerService, _languageService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._openerService = _openerService;\n        this._languageService = _languageService;\n        this._keybindingService = _keybindingService;\n        this._listenersStore = new DisposableStore();\n        this._hoverState = {\n            mouseDown: false,\n            contentHoverFocused: false,\n            activatedByDecoratorClick: false\n        };\n        this._reactToEditorMouseMoveRunner = this._register(new RunOnceScheduler(() => this._reactToEditorMouseMove(this._mouseMoveEvent), 0));\n        this._hookListeners();\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(60 /* EditorOption.hover */)) {\n                this._unhookListeners();\n                this._hookListeners();\n            }\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(HoverController_1.ID);\n    }\n    _hookListeners() {\n        const hoverOpts = this._editor.getOption(60 /* EditorOption.hover */);\n        this._hoverSettings = {\n            enabled: hoverOpts.enabled,\n            sticky: hoverOpts.sticky,\n            hidingDelay: hoverOpts.delay\n        };\n        if (hoverOpts.enabled) {\n            this._listenersStore.add(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n            this._listenersStore.add(this._editor.onMouseUp(() => this._onEditorMouseUp()));\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        else {\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        this._listenersStore.add(this._editor.onMouseLeave((e) => this._onEditorMouseLeave(e)));\n        this._listenersStore.add(this._editor.onDidChangeModel(() => {\n            this._cancelScheduler();\n            this._hideWidgets();\n        }));\n        this._listenersStore.add(this._editor.onDidChangeModelContent(() => this._cancelScheduler()));\n        this._listenersStore.add(this._editor.onDidScrollChange((e) => this._onEditorScrollChanged(e)));\n    }\n    _unhookListeners() {\n        this._listenersStore.clear();\n    }\n    _cancelScheduler() {\n        this._mouseMoveEvent = undefined;\n        this._reactToEditorMouseMoveRunner.cancel();\n    }\n    _onEditorScrollChanged(e) {\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\n            this._hideWidgets();\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        var _a;\n        this._hoverState.mouseDown = true;\n        const target = mouseEvent.target;\n        if (target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID) {\n            // mouse down on top of content hover widget\n            this._hoverState.contentHoverFocused = true;\n            return;\n        }\n        if (target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */ && target.detail === MarginHoverWidget.ID) {\n            // mouse down on top of margin hover widget\n            return;\n        }\n        if (target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */) {\n            this._hoverState.contentHoverFocused = false;\n        }\n        if ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.widget.isResizing) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _onEditorMouseUp() {\n        this._hoverState.mouseDown = false;\n    }\n    _onEditorMouseLeave(mouseEvent) {\n        var _a, _b;\n        this._cancelScheduler();\n        const targetElement = (mouseEvent.event.browserEvent.relatedTarget);\n        if (((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.widget.isResizing) || ((_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.containsNode(targetElement))) {\n            // When the content widget is resizing\n            // When the mouse is inside hover widget\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _isMouseOverWidget(mouseEvent) {\n        var _a, _b, _c, _d, _e;\n        const target = mouseEvent.target;\n        const sticky = this._hoverSettings.sticky;\n        if (sticky\n            && target.type === 9 /* MouseTargetType.CONTENT_WIDGET */\n            && target.detail === ContentHoverWidget.ID) {\n            // mouse moved on top of content hover widget\n            return true;\n        }\n        if (sticky\n            && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.containsNode((_b = mouseEvent.event.browserEvent.view) === null || _b === void 0 ? void 0 : _b.document.activeElement))\n            && !((_d = (_c = mouseEvent.event.browserEvent.view) === null || _c === void 0 ? void 0 : _c.getSelection()) === null || _d === void 0 ? void 0 : _d.isCollapsed)) {\n            // selected text within content hover widget\n            return true;\n        }\n        if (!sticky\n            && target.type === 9 /* MouseTargetType.CONTENT_WIDGET */\n            && target.detail === ContentHoverWidget.ID\n            && ((_e = this._contentWidget) === null || _e === void 0 ? void 0 : _e.isColorPickerVisible)) {\n            // though the hover is not sticky, the color picker is sticky\n            return true;\n        }\n        if (sticky\n            && target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */\n            && target.detail === MarginHoverWidget.ID) {\n            // mouse moved on top of overlay hover widget\n            return true;\n        }\n        return false;\n    }\n    _onEditorMouseMove(mouseEvent) {\n        var _a, _b, _c, _d;\n        this._mouseMoveEvent = mouseEvent;\n        if (((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isFocused) || ((_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.isResizing)) {\n            return;\n        }\n        if (this._hoverState.mouseDown && this._hoverState.contentHoverFocused) {\n            return;\n        }\n        const sticky = this._hoverSettings.sticky;\n        if (sticky && ((_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.isVisibleFromKeyboard)) {\n            // Sticky mode is on and the hover has been shown via keyboard\n            // so moving the mouse has no effect\n            return;\n        }\n        const mouseIsOverWidget = this._isMouseOverWidget(mouseEvent);\n        // If the mouse is over the widget and the hiding timeout is defined, then cancel it\n        if (mouseIsOverWidget) {\n            this._reactToEditorMouseMoveRunner.cancel();\n            return;\n        }\n        // If the mouse is not over the widget, and if sticky is on,\n        // then give it a grace period before reacting to the mouse event\n        const hidingDelay = this._hoverSettings.hidingDelay;\n        if (((_d = this._contentWidget) === null || _d === void 0 ? void 0 : _d.isVisible) && sticky && hidingDelay > 0) {\n            if (!this._reactToEditorMouseMoveRunner.isScheduled()) {\n                this._reactToEditorMouseMoveRunner.schedule(hidingDelay);\n            }\n            return;\n        }\n        this._reactToEditorMouseMove(mouseEvent);\n    }\n    _reactToEditorMouseMove(mouseEvent) {\n        var _a, _b, _c, _d;\n        if (!mouseEvent) {\n            return;\n        }\n        const target = mouseEvent.target;\n        const mouseOnDecorator = (_a = target.element) === null || _a === void 0 ? void 0 : _a.classList.contains('colorpicker-color-decoration');\n        const decoratorActivatedOn = this._editor.getOption(147 /* EditorOption.colorDecoratorsActivatedOn */);\n        const enabled = this._hoverSettings.enabled;\n        const activatedByDecoratorClick = this._hoverState.activatedByDecoratorClick;\n        if ((mouseOnDecorator && ((decoratorActivatedOn === 'click' && !activatedByDecoratorClick) ||\n            (decoratorActivatedOn === 'hover' && !enabled && !_sticky) ||\n            (decoratorActivatedOn === 'clickAndHover' && !enabled && !activatedByDecoratorClick))) || (!mouseOnDecorator && !enabled && !activatedByDecoratorClick)) {\n            this._hideWidgets();\n            return;\n        }\n        const contentWidget = this._getOrCreateContentWidget();\n        if (contentWidget.showsOrWillShow(mouseEvent)) {\n            (_b = this._glyphWidget) === null || _b === void 0 ? void 0 : _b.hide();\n            return;\n        }\n        if (target.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ && target.position && target.detail.glyphMarginLane) {\n            (_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.hide();\n            const glyphWidget = this._getOrCreateGlyphWidget();\n            glyphWidget.startShowingAt(target.position.lineNumber, target.detail.glyphMarginLane);\n            return;\n        }\n        if (target.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */ && target.position) {\n            (_d = this._contentWidget) === null || _d === void 0 ? void 0 : _d.hide();\n            const glyphWidget = this._getOrCreateGlyphWidget();\n            glyphWidget.startShowingAt(target.position.lineNumber, 'lineNo');\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _onKeyDown(e) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const resolvedKeyboardEvent = this._keybindingService.softDispatch(e, this._editor.getDomNode());\n        // If the beginning of a multi-chord keybinding is pressed,\n        // or the command aims to focus the hover,\n        // set the variable to true, otherwise false\n        const mightTriggerFocus = (resolvedKeyboardEvent.kind === 1 /* ResultKind.MoreChordsNeeded */ ||\n            (resolvedKeyboardEvent.kind === 2 /* ResultKind.KbFound */\n                && resolvedKeyboardEvent.commandId === 'editor.action.showHover'\n                && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isVisible)));\n        if (e.keyCode === 5 /* KeyCode.Ctrl */\n            || e.keyCode === 6 /* KeyCode.Alt */\n            || e.keyCode === 57 /* KeyCode.Meta */\n            || e.keyCode === 4 /* KeyCode.Shift */\n            || mightTriggerFocus) {\n            // Do not hide hover when a modifier key is pressed\n            return;\n        }\n        this._hideWidgets();\n    }\n    _hideWidgets() {\n        var _a, _b, _c;\n        if (_sticky) {\n            return;\n        }\n        if ((this._hoverState.mouseDown\n            && this._hoverState.contentHoverFocused\n            && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible))\n            || InlineSuggestionHintsContentWidget.dropDownVisible) {\n            return;\n        }\n        this._hoverState.activatedByDecoratorClick = false;\n        this._hoverState.contentHoverFocused = false;\n        (_b = this._glyphWidget) === null || _b === void 0 ? void 0 : _b.hide();\n        (_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.hide();\n    }\n    _getOrCreateContentWidget() {\n        if (!this._contentWidget) {\n            this._contentWidget = this._instantiationService.createInstance(ContentHoverController, this._editor);\n        }\n        return this._contentWidget;\n    }\n    _getOrCreateGlyphWidget() {\n        if (!this._glyphWidget) {\n            this._glyphWidget = new MarginHoverWidget(this._editor, this._languageService, this._openerService);\n        }\n        return this._glyphWidget;\n    }\n    showContentHover(range, mode, source, focus, activatedByColorDecoratorClick = false) {\n        this._hoverState.activatedByDecoratorClick = activatedByColorDecoratorClick;\n        this._getOrCreateContentWidget().startShowingAtRange(range, mode, source, focus);\n    }\n    focus() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n    scrollUp() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollUp();\n    }\n    scrollDown() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollDown();\n    }\n    scrollLeft() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollLeft();\n    }\n    scrollRight() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollRight();\n    }\n    pageUp() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.pageUp();\n    }\n    pageDown() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.pageDown();\n    }\n    goToTop() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.goToTop();\n    }\n    goToBottom() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.goToBottom();\n    }\n    get isColorPickerVisible() {\n        var _a;\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible;\n    }\n    get isHoverVisible() {\n        var _a;\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isVisible;\n    }\n    dispose() {\n        var _a, _b;\n        super.dispose();\n        this._unhookListeners();\n        this._listenersStore.dispose();\n        (_a = this._glyphWidget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.dispose();\n    }\n};\nHoverController.ID = 'editor.contrib.hover';\nHoverController = HoverController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageService),\n    __param(4, IKeybindingService)\n], HoverController);\nexport { HoverController };\nvar HoverFocusBehavior;\n(function (HoverFocusBehavior) {\n    HoverFocusBehavior[\"NoAutoFocus\"] = \"noAutoFocus\";\n    HoverFocusBehavior[\"FocusIfVisible\"] = \"focusIfVisible\";\n    HoverFocusBehavior[\"AutoFocusImmediately\"] = \"autoFocusImmediately\";\n})(HoverFocusBehavior || (HoverFocusBehavior = {}));\nclass ShowOrFocusHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showHover',\n            label: nls.localize({\n                key: 'showOrFocusHover',\n                comment: [\n                    'Label for action that will trigger the showing/focusing of a hover in the editor.',\n                    'If the hover is not visible, it will show the hover.',\n                    'This allows for users to show the hover without using the mouse.'\n                ]\n            }, \"Show or Focus Hover\"),\n            metadata: {\n                description: `Show or Focus Hover`,\n                args: [{\n                        name: 'args',\n                        schema: {\n                            type: 'object',\n                            properties: {\n                                'focus': {\n                                    description: 'Controls if and when the hover should take focus upon being triggered by this action.',\n                                    enum: [HoverFocusBehavior.NoAutoFocus, HoverFocusBehavior.FocusIfVisible, HoverFocusBehavior.AutoFocusImmediately],\n                                    enumDescriptions: [\n                                        nls.localize('showOrFocusHover.focus.noAutoFocus', 'The hover will not automatically take focus.'),\n                                        nls.localize('showOrFocusHover.focus.focusIfVisible', 'The hover will take focus only if it is already visible.'),\n                                        nls.localize('showOrFocusHover.focus.autoFocusImmediately', 'The hover will automatically take focus when it appears.'),\n                                    ],\n                                    default: HoverFocusBehavior.FocusIfVisible,\n                                }\n                            },\n                        }\n                    }]\n            },\n            alias: 'Show or Focus Hover',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const focusArgument = args === null || args === void 0 ? void 0 : args.focus;\n        let focusOption = HoverFocusBehavior.FocusIfVisible;\n        if (Object.values(HoverFocusBehavior).includes(focusArgument)) {\n            focusOption = focusArgument;\n        }\n        else if (typeof focusArgument === 'boolean' && focusArgument) {\n            focusOption = HoverFocusBehavior.AutoFocusImmediately;\n        }\n        const showContentHover = (focus) => {\n            const position = editor.getPosition();\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, 1 /* HoverStartSource.Keyboard */, focus);\n        };\n        const accessibilitySupportEnabled = editor.getOption(2 /* EditorOption.accessibilitySupport */) === 2 /* AccessibilitySupport.Enabled */;\n        if (controller.isHoverVisible) {\n            if (focusOption !== HoverFocusBehavior.NoAutoFocus) {\n                controller.focus();\n            }\n            else {\n                showContentHover(accessibilitySupportEnabled);\n            }\n        }\n        else {\n            showContentHover(accessibilitySupportEnabled || focusOption === HoverFocusBehavior.AutoFocusImmediately);\n        }\n    }\n}\nclass ShowDefinitionPreviewHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showDefinitionPreviewHover',\n            label: nls.localize({\n                key: 'showDefinitionPreviewHover',\n                comment: [\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\n                    'This allows for users to show the definition preview hover without using the mouse.'\n                ]\n            }, \"Show Definition Preview Hover\"),\n            alias: 'Show Definition Preview Hover',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const position = editor.getPosition();\n        if (!position) {\n            return;\n        }\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n        const goto = GotoDefinitionAtPositionEditorContribution.get(editor);\n        if (!goto) {\n            return;\n        }\n        const promise = goto.startFindDefinitionFromCursor(position);\n        promise.then(() => {\n            controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, 1 /* HoverStartSource.Keyboard */, true);\n        });\n    }\n}\nclass ScrollUpHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.scrollUpHover',\n            label: nls.localize({\n                key: 'scrollUpHover',\n                comment: [\n                    'Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Up Hover\"),\n            alias: 'Scroll Up Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 16 /* KeyCode.UpArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollUp();\n    }\n}\nclass ScrollDownHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.scrollDownHover',\n            label: nls.localize({\n                key: 'scrollDownHover',\n                comment: [\n                    'Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Down Hover\"),\n            alias: 'Scroll Down Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 18 /* KeyCode.DownArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollDown();\n    }\n}\nclass ScrollLeftHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.scrollLeftHover',\n            label: nls.localize({\n                key: 'scrollLeftHover',\n                comment: [\n                    'Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Left Hover\"),\n            alias: 'Scroll Left Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 15 /* KeyCode.LeftArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollLeft();\n    }\n}\nclass ScrollRightHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.scrollRightHover',\n            label: nls.localize({\n                key: 'scrollRightHover',\n                comment: [\n                    'Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Right Hover\"),\n            alias: 'Scroll Right Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 17 /* KeyCode.RightArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollRight();\n    }\n}\nclass PageUpHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.pageUpHover',\n            label: nls.localize({\n                key: 'pageUpHover',\n                comment: [\n                    'Action that allows to page up in the hover widget with the page up command when the hover widget is focused.'\n                ]\n            }, \"Page Up Hover\"),\n            alias: 'Page Up Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 11 /* KeyCode.PageUp */,\n                secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.pageUp();\n    }\n}\nclass PageDownHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.pageDownHover',\n            label: nls.localize({\n                key: 'pageDownHover',\n                comment: [\n                    'Action that allows to page down in the hover widget with the page down command when the hover widget is focused.'\n                ]\n            }, \"Page Down Hover\"),\n            alias: 'Page Down Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 12 /* KeyCode.PageDown */,\n                secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.pageDown();\n    }\n}\nclass GoToTopHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.goToTopHover',\n            label: nls.localize({\n                key: 'goToTopHover',\n                comment: [\n                    'Action that allows to go to the top of the hover widget with the home command when the hover widget is focused.'\n                ]\n            }, \"Go To Top Hover\"),\n            alias: 'Go To Bottom Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 14 /* KeyCode.Home */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.goToTop();\n    }\n}\nclass GoToBottomHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.goToBottomHover',\n            label: nls.localize({\n                key: 'goToBottomHover',\n                comment: [\n                    'Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused.'\n                ]\n            }, \"Go To Bottom Hover\"),\n            alias: 'Go To Bottom Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 13 /* KeyCode.End */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.goToBottom();\n    }\n}\nregisterEditorContribution(HoverController.ID, HoverController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(ShowOrFocusHoverAction);\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\nregisterEditorAction(ScrollUpHoverAction);\nregisterEditorAction(ScrollDownHoverAction);\nregisterEditorAction(ScrollLeftHoverAction);\nregisterEditorAction(ScrollRightHoverAction);\nregisterEditorAction(PageUpHoverAction);\nregisterEditorAction(PageDownHoverAction);\nregisterEditorAction(GoToTopHoverAction);\nregisterEditorAction(GoToBottomHoverAction);\nHoverParticipantRegistry.register(MarkdownHoverParticipant);\nHoverParticipantRegistry.register(MarkerHoverParticipant);\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const hoverBorder = theme.getColor(editorHoverBorder);\n    if (hoverBorder) {\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${hoverBorder.transparent(0.5)}; }`);\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar GotoDefinitionAtPositionEditorContribution_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nlet GotoDefinitionAtPositionEditorContribution = GotoDefinitionAtPositionEditorContribution_1 = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, keyboardEvent !== null && keyboardEvent !== void 0 ? keyboardEvent : undefined);\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier)\n                    .catch((error) => {\n                    onUnexpectedError(error);\n                })\n                    .finally(() => {\n                    this.removeLinkDecorations();\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution_1.ID);\n    }\n    async startFindDefinitionFromCursor(position) {\n        // For issue: https://github.com/microsoft/vscode/issues/46257\n        // equivalent to mouse move with meta/ctrl key\n        // First find the definition and add decorations\n        // to the editor to be shown with the content hover widget\n        await this.startFindDefinition(position);\n        // Add listeners for editor cursor move and key down events\n        // Dismiss the \"extended\" editor decorations when the user hides\n        // the hover widget. There is no event for the widget itself so these\n        // serve as a best effort. After removing the link decorations, the hover\n        // widget is clean and will only show declarations per next request.\n        this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            this.toUnhookForKeyboard.clear();\n        }));\n        this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n            if (e) {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }\n        }));\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    async startFindDefinition(position) {\n        var _a;\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\n        this.toUnhookForKeyboard.clear();\n        // Find word at mouse position\n        const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n        if (!word) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        // Return early if word at position is still the same\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n            return;\n        }\n        this.currentWordAtPosition = word;\n        // Find definition and decorate word if found\n        const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n        if (this.previousPromise) {\n            this.previousPromise.cancel();\n            this.previousPromise = null;\n        }\n        this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n        let results;\n        try {\n            results = await this.previousPromise;\n        }\n        catch (error) {\n            onUnexpectedError(error);\n            return;\n        }\n        if (!results || !results.length || !state.validate(this.editor)) {\n            this.removeLinkDecorations();\n            return;\n        }\n        const linkRange = results[0].originSelectionRange\n            ? Range.lift(results[0].originSelectionRange)\n            : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n        // Multiple results\n        if (results.length > 1) {\n            let combinedRange = linkRange;\n            for (const { originSelectionRange } of results) {\n                if (originSelectionRange) {\n                    combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n                }\n            }\n            this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n        }\n        else {\n            // Single result\n            const result = results[0];\n            if (!result.uri) {\n                return;\n            }\n            this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                if (!ref.object || !ref.object.textEditorModel) {\n                    ref.dispose();\n                    return;\n                }\n                const { object: { textEditorModel } } = ref;\n                const { startLineNumber } = result.range;\n                if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                    // invalid range\n                    ref.dispose();\n                    return;\n                }\n                const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n                ref.dispose();\n            });\n        }\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        var _a;\n        return this.editor.hasModel()\n            && mouseEvent.isLeftClick\n            && mouseEvent.isNoneOrSingleMouseDown\n            && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */\n            && !(((_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options) instanceof ModelDecorationInjectedTextOptions)\n            && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false))\n            && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(88 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n            return action.run(accessor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n        this.toUnhookForKeyboard.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = GotoDefinitionAtPositionEditorContribution_1 = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.isLeftClick = source.event.leftButton;\n        this.isMiddleClick = source.event.middleButton;\n        this.isRightClick = source.event.rightButton;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor, opts) {\n        var _a;\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._extractLineNumberFromMouseEvent = (_a = opts === null || opts === void 0 ? void 0 : opts.extractLineNumberFromMouseEvent) !== null && _a !== void 0 ? _a : ((e) => e.target.position ? e.target.position.lineNumber : 0);\n        this._opts = createOptions(this._editor.getOption(78 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(78 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(78 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = this._extractLineNumberFromMouseEvent(mouseEvent);\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = this._extractLineNumberFromMouseEvent(mouseEvent);\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport * as objects from '../../../../base/common/objects.js';\nimport './media/peekViewWidget.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { ZoneWidget } from '../../zoneWidget/browser/zoneWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { createActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { activeContrastBorder, contrastBorder, editorForeground, editorInfoForeground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nexport const IPeekViewService = createDecorator('IPeekViewService');\nregisterSingleton(IPeekViewService, class {\n    constructor() {\n        this._widgets = new Map();\n    }\n    addExclusiveWidget(editor, widget) {\n        const existing = this._widgets.get(editor);\n        if (existing) {\n            existing.listener.dispose();\n            existing.widget.dispose();\n        }\n        const remove = () => {\n            const data = this._widgets.get(editor);\n            if (data && data.widget === widget) {\n                data.listener.dispose();\n                this._widgets.delete(editor);\n            }\n        };\n        this._widgets.set(editor, { widget, listener: widget.onDidClose(remove) });\n    }\n}, 1 /* InstantiationType.Delayed */);\nexport var PeekContext;\n(function (PeekContext) {\n    PeekContext.inPeekEditor = new RawContextKey('inReferenceSearchEditor', true, nls.localize('inReferenceSearchEditor', \"Whether the current code editor is embedded inside peek\"));\n    PeekContext.notInPeekEditor = PeekContext.inPeekEditor.toNegated();\n})(PeekContext || (PeekContext = {}));\nlet PeekContextController = class PeekContextController {\n    constructor(editor, contextKeyService) {\n        if (editor instanceof EmbeddedCodeEditorWidget) {\n            PeekContext.inPeekEditor.bindTo(contextKeyService);\n        }\n    }\n    dispose() { }\n};\nPeekContextController.ID = 'editor.contrib.referenceController';\nPeekContextController = __decorate([\n    __param(1, IContextKeyService)\n], PeekContextController);\nregisterEditorContribution(PeekContextController.ID, PeekContextController, 0 /* EditorContributionInstantiation.Eager */); // eager because it needs to define a context key\nexport function getOuterEditor(accessor) {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (editor instanceof EmbeddedCodeEditorWidget) {\n        return editor.getParentEditor();\n    }\n    return editor;\n}\nconst defaultOptions = {\n    headerBackgroundColor: Color.white,\n    primaryHeadingColor: Color.fromHex('#333333'),\n    secondaryHeadingColor: Color.fromHex('#6c6c6cb3')\n};\nlet PeekViewWidget = class PeekViewWidget extends ZoneWidget {\n    constructor(editor, options, instantiationService) {\n        super(editor, options);\n        this.instantiationService = instantiationService;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        objects.mixin(this.options, defaultOptions, false);\n    }\n    dispose() {\n        if (!this.disposed) {\n            this.disposed = true; // prevent consumers who dispose on onDidClose from looping\n            super.dispose();\n            this._onDidClose.fire(this);\n        }\n    }\n    style(styles) {\n        const options = this.options;\n        if (styles.headerBackgroundColor) {\n            options.headerBackgroundColor = styles.headerBackgroundColor;\n        }\n        if (styles.primaryHeadingColor) {\n            options.primaryHeadingColor = styles.primaryHeadingColor;\n        }\n        if (styles.secondaryHeadingColor) {\n            options.secondaryHeadingColor = styles.secondaryHeadingColor;\n        }\n        super.style(styles);\n    }\n    _applyStyles() {\n        super._applyStyles();\n        const options = this.options;\n        if (this._headElement && options.headerBackgroundColor) {\n            this._headElement.style.backgroundColor = options.headerBackgroundColor.toString();\n        }\n        if (this._primaryHeading && options.primaryHeadingColor) {\n            this._primaryHeading.style.color = options.primaryHeadingColor.toString();\n        }\n        if (this._secondaryHeading && options.secondaryHeadingColor) {\n            this._secondaryHeading.style.color = options.secondaryHeadingColor.toString();\n        }\n        if (this._bodyElement && options.frameColor) {\n            this._bodyElement.style.borderColor = options.frameColor.toString();\n        }\n    }\n    _fillContainer(container) {\n        this.setCssClass('peekview-widget');\n        this._headElement = dom.$('.head');\n        this._bodyElement = dom.$('.body');\n        this._fillHead(this._headElement);\n        this._fillBody(this._bodyElement);\n        container.appendChild(this._headElement);\n        container.appendChild(this._bodyElement);\n    }\n    _fillHead(container, noCloseAction) {\n        this._titleElement = dom.$('.peekview-title');\n        if (this.options.supportOnTitleClick) {\n            this._titleElement.classList.add('clickable');\n            dom.addStandardDisposableListener(this._titleElement, 'click', event => this._onTitleClick(event));\n        }\n        dom.append(this._headElement, this._titleElement);\n        this._fillTitleIcon(this._titleElement);\n        this._primaryHeading = dom.$('span.filename');\n        this._secondaryHeading = dom.$('span.dirname');\n        this._metaHeading = dom.$('span.meta');\n        dom.append(this._titleElement, this._primaryHeading, this._secondaryHeading, this._metaHeading);\n        const actionsContainer = dom.$('.peekview-actions');\n        dom.append(this._headElement, actionsContainer);\n        const actionBarOptions = this._getActionBarOptions();\n        this._actionbarWidget = new ActionBar(actionsContainer, actionBarOptions);\n        this._disposables.add(this._actionbarWidget);\n        if (!noCloseAction) {\n            this._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), ThemeIcon.asClassName(Codicon.close), true, () => {\n                this.dispose();\n                return Promise.resolve();\n            }), { label: false, icon: true });\n        }\n    }\n    _fillTitleIcon(container) {\n    }\n    _getActionBarOptions() {\n        return {\n            actionViewItemProvider: createActionViewItem.bind(undefined, this.instantiationService),\n            orientation: 0 /* ActionsOrientation.HORIZONTAL */\n        };\n    }\n    _onTitleClick(event) {\n        // implement me if supportOnTitleClick option is set\n    }\n    setTitle(primaryHeading, secondaryHeading) {\n        if (this._primaryHeading && this._secondaryHeading) {\n            this._primaryHeading.innerText = primaryHeading;\n            this._primaryHeading.setAttribute('title', primaryHeading);\n            if (secondaryHeading) {\n                this._secondaryHeading.innerText = secondaryHeading;\n            }\n            else {\n                dom.clearNode(this._secondaryHeading);\n            }\n        }\n    }\n    setMetaTitle(value) {\n        if (this._metaHeading) {\n            if (value) {\n                this._metaHeading.innerText = value;\n                dom.show(this._metaHeading);\n            }\n            else {\n                dom.hide(this._metaHeading);\n            }\n        }\n    }\n    _doLayout(heightInPixel, widthInPixel) {\n        if (!this._isShowing && heightInPixel < 0) {\n            // Looks like the view zone got folded away!\n            this.dispose();\n            return;\n        }\n        const headHeight = Math.ceil(this.editor.getOption(67 /* EditorOption.lineHeight */) * 1.2);\n        const bodyHeight = Math.round(heightInPixel - (headHeight + 2 /* the border-top/bottom width*/));\n        this._doLayoutHead(headHeight, widthInPixel);\n        this._doLayoutBody(bodyHeight, widthInPixel);\n    }\n    _doLayoutHead(heightInPixel, widthInPixel) {\n        if (this._headElement) {\n            this._headElement.style.height = `${heightInPixel}px`;\n            this._headElement.style.lineHeight = this._headElement.style.height;\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        if (this._bodyElement) {\n            this._bodyElement.style.height = `${heightInPixel}px`;\n        }\n    }\n};\nPeekViewWidget = __decorate([\n    __param(2, IInstantiationService)\n], PeekViewWidget);\nexport { PeekViewWidget };\nexport const peekViewTitleBackground = registerColor('peekViewTitle.background', { dark: '#252526', light: '#F3F3F3', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewTitleBackground', 'Background color of the peek view title area.'));\nexport const peekViewTitleForeground = registerColor('peekViewTitleLabel.foreground', { dark: Color.white, light: Color.black, hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewTitleForeground', 'Color of the peek view title.'));\nexport const peekViewTitleInfoForeground = registerColor('peekViewTitleDescription.foreground', { dark: '#ccccccb3', light: '#616161', hcDark: '#FFFFFF99', hcLight: '#292929' }, nls.localize('peekViewTitleInfoForeground', 'Color of the peek view title info.'));\nexport const peekViewBorder = registerColor('peekView.border', { dark: editorInfoForeground, light: editorInfoForeground, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('peekViewBorder', 'Color of the peek view borders and arrow.'));\nexport const peekViewResultsBackground = registerColor('peekViewResult.background', { dark: '#252526', light: '#F3F3F3', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewResultsBackground', 'Background color of the peek view result list.'));\nexport const peekViewResultsMatchForeground = registerColor('peekViewResult.lineForeground', { dark: '#bbbbbb', light: '#646465', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsMatchForeground', 'Foreground color for line nodes in the peek view result list.'));\nexport const peekViewResultsFileForeground = registerColor('peekViewResult.fileForeground', { dark: Color.white, light: '#1E1E1E', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsFileForeground', 'Foreground color for file nodes in the peek view result list.'));\nexport const peekViewResultsSelectionBackground = registerColor('peekViewResult.selectionBackground', { dark: '#3399ff33', light: '#3399ff33', hcDark: null, hcLight: null }, nls.localize('peekViewResultsSelectionBackground', 'Background color of the selected entry in the peek view result list.'));\nexport const peekViewResultsSelectionForeground = registerColor('peekViewResult.selectionForeground', { dark: Color.white, light: '#6C6C6C', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsSelectionForeground', 'Foreground color of the selected entry in the peek view result list.'));\nexport const peekViewEditorBackground = registerColor('peekViewEditor.background', { dark: '#001F33', light: '#F2F8FC', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewEditorBackground', 'Background color of the peek view editor.'));\nexport const peekViewEditorGutterBackground = registerColor('peekViewEditorGutter.background', { dark: peekViewEditorBackground, light: peekViewEditorBackground, hcDark: peekViewEditorBackground, hcLight: peekViewEditorBackground }, nls.localize('peekViewEditorGutterBackground', 'Background color of the gutter in the peek view editor.'));\nexport const peekViewEditorStickyScrollBackground = registerColor('peekViewEditorStickyScroll.background', { dark: peekViewEditorBackground, light: peekViewEditorBackground, hcDark: peekViewEditorBackground, hcLight: peekViewEditorBackground }, nls.localize('peekViewEditorStickScrollBackground', 'Background color of sticky scroll in the peek view editor.'));\nexport const peekViewResultsMatchHighlight = registerColor('peekViewResult.matchHighlightBackground', { dark: '#ea5c004d', light: '#ea5c004d', hcDark: null, hcLight: null }, nls.localize('peekViewResultsMatchHighlight', 'Match highlight color in the peek view result list.'));\nexport const peekViewEditorMatchHighlight = registerColor('peekViewEditor.matchHighlightBackground', { dark: '#ff8f0099', light: '#f5d802de', hcDark: null, hcLight: null }, nls.localize('peekViewEditorMatchHighlight', 'Match highlight color in the peek view editor.'));\nexport const peekViewEditorMatchHighlightBorder = registerColor('peekViewEditor.matchHighlightBorder', { dark: null, light: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('peekViewEditorMatchHighlightBorder', 'Match highlight border in the peek view editor.'));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as objects from '../../../base/common/objects.js';\nimport { ICodeEditorService } from '../services/codeEditorService.js';\nimport { CodeEditorWidget } from './codeEditorWidget.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../common/services/languageFeatures.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nlet EmbeddedCodeEditorWidget = class EmbeddedCodeEditorWidget extends CodeEditorWidget {\n    constructor(domElement, options, codeEditorWidgetOptions, parentEditor, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService) {\n        super(domElement, { ...parentEditor.getRawOptions(), overflowWidgetsDomNode: parentEditor.getOverflowWidgetsDomNode() }, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService, languageConfigurationService, languageFeaturesService);\n        this._parentEditor = parentEditor;\n        this._overwriteOptions = options;\n        // Overwrite parent's options\n        super.updateOptions(this._overwriteOptions);\n        this._register(parentEditor.onDidChangeConfiguration((e) => this._onParentConfigurationChanged(e)));\n    }\n    getParentEditor() {\n        return this._parentEditor;\n    }\n    _onParentConfigurationChanged(e) {\n        super.updateOptions(this._parentEditor.getRawOptions());\n        super.updateOptions(this._overwriteOptions);\n    }\n    updateOptions(newOptions) {\n        objects.mixin(this._overwriteOptions, newOptions, true);\n        super.updateOptions(this._overwriteOptions);\n    }\n};\nEmbeddedCodeEditorWidget = __decorate([\n    __param(4, IInstantiationService),\n    __param(5, ICodeEditorService),\n    __param(6, ICommandService),\n    __param(7, IContextKeyService),\n    __param(8, IThemeService),\n    __param(9, INotificationService),\n    __param(10, IAccessibilityService),\n    __param(11, ILanguageConfigurationService),\n    __param(12, ILanguageFeaturesService)\n], EmbeddedCodeEditorWidget);\nexport { EmbeddedCodeEditorWidget };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Sash } from '../../../../base/browser/ui/sash/sash.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { IdGenerator } from '../../../../base/common/idGenerator.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as objects from '../../../../base/common/objects.js';\nimport './zoneWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nconst defaultColor = new Color(new RGBA(0, 122, 204));\nconst defaultOptions = {\n    showArrow: true,\n    showFrame: true,\n    className: '',\n    frameColor: defaultColor,\n    arrowColor: defaultColor,\n    keepEditorSelection: false\n};\nconst WIDGET_ID = 'vs.editor.contrib.zoneWidget';\nclass ViewZoneDelegate {\n    constructor(domNode, afterLineNumber, afterColumn, heightInLines, onDomNodeTop, onComputedHeight, showInHiddenAreas, ordinal) {\n        this.id = ''; // A valid zone id should be greater than 0\n        this.domNode = domNode;\n        this.afterLineNumber = afterLineNumber;\n        this.afterColumn = afterColumn;\n        this.heightInLines = heightInLines;\n        this.showInHiddenAreas = showInHiddenAreas;\n        this.ordinal = ordinal;\n        this._onDomNodeTop = onDomNodeTop;\n        this._onComputedHeight = onComputedHeight;\n    }\n    onDomNodeTop(top) {\n        this._onDomNodeTop(top);\n    }\n    onComputedHeight(height) {\n        this._onComputedHeight(height);\n    }\n}\nexport class OverlayWidgetDelegate {\n    constructor(id, domNode) {\n        this._id = id;\n        this._domNode = domNode;\n    }\n    getId() {\n        return this._id;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return null;\n    }\n}\nclass Arrow {\n    constructor(_editor) {\n        this._editor = _editor;\n        this._ruleName = Arrow._IdGenerator.nextId();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._color = null;\n        this._height = -1;\n    }\n    dispose() {\n        this.hide();\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n    }\n    set color(value) {\n        if (this._color !== value) {\n            this._color = value;\n            this._updateStyle();\n        }\n    }\n    set height(value) {\n        if (this._height !== value) {\n            this._height = value;\n            this._updateStyle();\n        }\n    }\n    _updateStyle() {\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n        dom.createCSSRule(`.monaco-editor ${this._ruleName}`, `border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `);\n    }\n    show(where) {\n        if (where.column === 1) {\n            // the arrow isn't pretty at column 1 and we need to push it out a little\n            where = { lineNumber: where.lineNumber, column: 2 };\n        }\n        this._decorations.set([{\n                range: Range.fromPositions(where),\n                options: {\n                    description: 'zone-widget-arrow',\n                    className: this._ruleName,\n                    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n                }\n            }]);\n    }\n    hide() {\n        this._decorations.clear();\n    }\n}\nArrow._IdGenerator = new IdGenerator('.arrow-decoration-');\nexport class ZoneWidget {\n    constructor(editor, options = {}) {\n        this._arrow = null;\n        this._overlayWidget = null;\n        this._resizeSash = null;\n        this._viewZone = null;\n        this._disposables = new DisposableStore();\n        this.container = null;\n        this._isShowing = false;\n        this.editor = editor;\n        this._positionMarkerId = this.editor.createDecorationsCollection();\n        this.options = objects.deepClone(options);\n        objects.mixin(this.options, defaultOptions, false);\n        this.domNode = document.createElement('div');\n        if (!this.options.isAccessible) {\n            this.domNode.setAttribute('aria-hidden', 'true');\n            this.domNode.setAttribute('role', 'presentation');\n        }\n        this._disposables.add(this.editor.onDidLayoutChange((info) => {\n            const width = this._getWidth(info);\n            this.domNode.style.width = width + 'px';\n            this.domNode.style.left = this._getLeft(info) + 'px';\n            this._onWidth(width);\n        }));\n    }\n    dispose() {\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        if (this._viewZone) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    accessor.removeZone(this._viewZone.id);\n                }\n                this._viewZone = null;\n            });\n        }\n        this._positionMarkerId.clear();\n        this._disposables.dispose();\n    }\n    create() {\n        this.domNode.classList.add('zone-widget');\n        if (this.options.className) {\n            this.domNode.classList.add(this.options.className);\n        }\n        this.container = document.createElement('div');\n        this.container.classList.add('zone-widget-container');\n        this.domNode.appendChild(this.container);\n        if (this.options.showArrow) {\n            this._arrow = new Arrow(this.editor);\n            this._disposables.add(this._arrow);\n        }\n        this._fillContainer(this.container);\n        this._initSash();\n        this._applyStyles();\n    }\n    style(styles) {\n        if (styles.frameColor) {\n            this.options.frameColor = styles.frameColor;\n        }\n        if (styles.arrowColor) {\n            this.options.arrowColor = styles.arrowColor;\n        }\n        this._applyStyles();\n    }\n    _applyStyles() {\n        if (this.container && this.options.frameColor) {\n            const frameColor = this.options.frameColor.toString();\n            this.container.style.borderTopColor = frameColor;\n            this.container.style.borderBottomColor = frameColor;\n        }\n        if (this._arrow && this.options.arrowColor) {\n            const arrowColor = this.options.arrowColor.toString();\n            this._arrow.color = arrowColor;\n        }\n    }\n    _getWidth(info) {\n        return info.width - info.minimap.minimapWidth - info.verticalScrollbarWidth;\n    }\n    _getLeft(info) {\n        // If minimap is to the left, we move beyond it\n        if (info.minimap.minimapWidth > 0 && info.minimap.minimapLeft === 0) {\n            return info.minimap.minimapWidth;\n        }\n        return 0;\n    }\n    _onViewZoneTop(top) {\n        this.domNode.style.top = top + 'px';\n    }\n    _onViewZoneHeight(height) {\n        var _a;\n        this.domNode.style.height = `${height}px`;\n        if (this.container) {\n            const containerHeight = height - this._decoratingElementsHeight();\n            this.container.style.height = `${containerHeight}px`;\n            const layoutInfo = this.editor.getLayoutInfo();\n            this._doLayout(containerHeight, this._getWidth(layoutInfo));\n        }\n        (_a = this._resizeSash) === null || _a === void 0 ? void 0 : _a.layout();\n    }\n    get position() {\n        const range = this._positionMarkerId.getRange(0);\n        if (!range) {\n            return undefined;\n        }\n        return range.getStartPosition();\n    }\n    show(rangeOrPos, heightInLines) {\n        const range = Range.isIRange(rangeOrPos) ? Range.lift(rangeOrPos) : Range.fromPositions(rangeOrPos);\n        this._isShowing = true;\n        this._showImpl(range, heightInLines);\n        this._isShowing = false;\n        this._positionMarkerId.set([{ range, options: ModelDecorationOptions.EMPTY }]);\n    }\n    hide() {\n        var _a;\n        if (this._viewZone) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    accessor.removeZone(this._viewZone.id);\n                }\n            });\n            this._viewZone = null;\n        }\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        (_a = this._arrow) === null || _a === void 0 ? void 0 : _a.hide();\n        this._positionMarkerId.clear();\n    }\n    _decoratingElementsHeight() {\n        const lineHeight = this.editor.getOption(67 /* EditorOption.lineHeight */);\n        let result = 0;\n        if (this.options.showArrow) {\n            const arrowHeight = Math.round(lineHeight / 3);\n            result += 2 * arrowHeight;\n        }\n        if (this.options.showFrame) {\n            const frameThickness = Math.round(lineHeight / 9);\n            result += 2 * frameThickness;\n        }\n        return result;\n    }\n    _showImpl(where, heightInLines) {\n        const position = where.getStartPosition();\n        const layoutInfo = this.editor.getLayoutInfo();\n        const width = this._getWidth(layoutInfo);\n        this.domNode.style.width = `${width}px`;\n        this.domNode.style.left = this._getLeft(layoutInfo) + 'px';\n        // Render the widget as zone (rendering) and widget (lifecycle)\n        const viewZoneDomNode = document.createElement('div');\n        viewZoneDomNode.style.overflow = 'hidden';\n        const lineHeight = this.editor.getOption(67 /* EditorOption.lineHeight */);\n        // adjust heightInLines to viewport\n        if (!this.options.allowUnlimitedHeight) {\n            const maxHeightInLines = Math.max(12, (this.editor.getLayoutInfo().height / lineHeight) * 0.8);\n            heightInLines = Math.min(heightInLines, maxHeightInLines);\n        }\n        let arrowHeight = 0;\n        let frameThickness = 0;\n        // Render the arrow one 1/3 of an editor line height\n        if (this._arrow && this.options.showArrow) {\n            arrowHeight = Math.round(lineHeight / 3);\n            this._arrow.height = arrowHeight;\n            this._arrow.show(position);\n        }\n        // Render the frame as 1/9 of an editor line height\n        if (this.options.showFrame) {\n            frameThickness = Math.round(lineHeight / 9);\n        }\n        // insert zone widget\n        this.editor.changeViewZones((accessor) => {\n            if (this._viewZone) {\n                accessor.removeZone(this._viewZone.id);\n            }\n            if (this._overlayWidget) {\n                this.editor.removeOverlayWidget(this._overlayWidget);\n                this._overlayWidget = null;\n            }\n            this.domNode.style.top = '-1000px';\n            this._viewZone = new ViewZoneDelegate(viewZoneDomNode, position.lineNumber, position.column, heightInLines, (top) => this._onViewZoneTop(top), (height) => this._onViewZoneHeight(height), this.options.showInHiddenAreas, this.options.ordinal);\n            this._viewZone.id = accessor.addZone(this._viewZone);\n            this._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + this._viewZone.id, this.domNode);\n            this.editor.addOverlayWidget(this._overlayWidget);\n        });\n        if (this.container && this.options.showFrame) {\n            const width = this.options.frameWidth ? this.options.frameWidth : frameThickness;\n            this.container.style.borderTopWidth = width + 'px';\n            this.container.style.borderBottomWidth = width + 'px';\n        }\n        const containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\n        if (this.container) {\n            this.container.style.top = arrowHeight + 'px';\n            this.container.style.height = containerHeight + 'px';\n            this.container.style.overflow = 'hidden';\n        }\n        this._doLayout(containerHeight, width);\n        if (!this.options.keepEditorSelection) {\n            this.editor.setSelection(where);\n        }\n        const model = this.editor.getModel();\n        if (model) {\n            const range = model.validateRange(new Range(where.startLineNumber, 1, where.endLineNumber + 1, 1));\n            this.revealRange(range, range.startLineNumber === model.getLineCount());\n        }\n    }\n    revealRange(range, isLastLine) {\n        if (isLastLine) {\n            this.editor.revealLineNearTop(range.endLineNumber, 0 /* ScrollType.Smooth */);\n        }\n        else {\n            this.editor.revealRange(range, 0 /* ScrollType.Smooth */);\n        }\n    }\n    setCssClass(className, classToReplace) {\n        if (!this.container) {\n            return;\n        }\n        if (classToReplace) {\n            this.container.classList.remove(classToReplace);\n        }\n        this.container.classList.add(className);\n    }\n    _onWidth(widthInPixel) {\n        // implement in subclass\n    }\n    _doLayout(heightInPixel, widthInPixel) {\n        // implement in subclass\n    }\n    _relayout(newHeightInLines) {\n        if (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    this._viewZone.heightInLines = newHeightInLines;\n                    accessor.layoutZone(this._viewZone.id);\n                }\n            });\n        }\n    }\n    // --- sash\n    _initSash() {\n        if (this._resizeSash) {\n            return;\n        }\n        this._resizeSash = this._disposables.add(new Sash(this.domNode, this, { orientation: 1 /* Orientation.HORIZONTAL */ }));\n        if (!this.options.isResizeable) {\n            this._resizeSash.state = 0 /* SashState.Disabled */;\n        }\n        let data;\n        this._disposables.add(this._resizeSash.onDidStart((e) => {\n            if (this._viewZone) {\n                data = {\n                    startY: e.startY,\n                    heightInLines: this._viewZone.heightInLines,\n                };\n            }\n        }));\n        this._disposables.add(this._resizeSash.onDidEnd(() => {\n            data = undefined;\n        }));\n        this._disposables.add(this._resizeSash.onDidChange((evt) => {\n            if (data) {\n                const lineDelta = (evt.currentY - data.startY) / this.editor.getOption(67 /* EditorOption.lineHeight */);\n                const roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\n                const newHeightInLines = data.heightInLines + roundedLineDelta;\n                if (newHeightInLines > 5 && newHeightInLines < 35) {\n                    this._relayout(newHeightInLines);\n                }\n            }\n        }));\n    }\n    getHorizontalSashLeft() {\n        return 0;\n    }\n    getHorizontalSashTop() {\n        return (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\n    }\n    getHorizontalSashWidth() {\n        const layoutInfo = this.editor.getLayoutInfo();\n        return layoutInfo.width - layoutInfo.minimap.minimapWidth;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { IsWebContext } from '../../../../platform/contextkey/common/contextkeys.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nexport class SymbolNavigationAnchor {\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction2 {\n    static all() {\n        return SymbolNavigationAction._allSymbolNavigationCommands.values();\n    }\n    static _patchConfig(opts) {\n        const result = { ...opts, f1: true };\n        // patch context menu when clause\n        if (result.menu) {\n            for (const item of Iterable.wrap(result.menu)) {\n                if (item.id === MenuId.EditorContext || item.id === MenuId.EditorContextPeek) {\n                    item.when = ContextKeyExpr.and(opts.precondition, item.when);\n                }\n            }\n        }\n        return result;\n    }\n    constructor(configuration, opts) {\n        super(SymbolNavigationAction._patchConfig(opts));\n        this.configuration = configuration;\n        SymbolNavigationAction._allSymbolNavigationCommands.set(opts.id, this);\n    }\n    runEditorCommand(accessor, editor, arg, range) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then(async (references) => {\n            var _j;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && SymbolNavigationAction._allSymbolNavigationCommands.has(altActionId)) {\n                    altAction = SymbolNavigationAction._allSymbolNavigationCommands.get(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_j = MessageController.get(editor)) === null || _j === void 0 ? void 0 : _j.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.desc.id);\n                instaService.invokeFunction((accessor) => altAction.runEditorCommand(accessor, editor, arg, range).finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.desc.id);\n                }));\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references, range);\n            }\n        }, (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    async _onResult(editorService, symbolNavService, editor, model, range) {\n        const gotoLocation = this._getGoToPreference(editor);\n        if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n            this._openInPeek(editor, model, range);\n        }\n        else {\n            const next = model.firstReference();\n            const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n            const targetEditor = await this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n            if (peek && targetEditor) {\n                this._openInPeek(targetEditor, model, range);\n            }\n            else {\n                model.dispose();\n            }\n            // keep remaining locations around when using\n            // 'goto'-mode\n            if (gotoLocation === 'goto') {\n                symbolNavService.put(next);\n            }\n        }\n    }\n    async _openReference(editor, editorService, reference, sideBySide, highlight) {\n        // range is the target-selection-range when we have one\n        // and the fallback is the 'full' range\n        let range = undefined;\n        if (isLocationLink(reference)) {\n            range = reference.targetSelectionRange;\n        }\n        if (!range) {\n            range = reference.range;\n        }\n        if (!range) {\n            return undefined;\n        }\n        const targetEditor = await editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n            }\n        }, editor, sideBySide);\n        if (!targetEditor) {\n            return undefined;\n        }\n        if (highlight) {\n            const modelNow = targetEditor.getModel();\n            const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n            setTimeout(() => {\n                if (targetEditor.getModel() === modelNow) {\n                    decorations.clear();\n                }\n            }, 350);\n        }\n        return targetEditor;\n    }\n    _openInPeek(target, model, range) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(range !== null && range !== void 0 ? range : target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\nSymbolNavigationAction._allSymbolNavigationCommands = new Map();\nSymbolNavigationAction._activeAlternativeCommands = new Set();\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, token), nls.localize('def.title', 'Definitions'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nregisterAction2((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _a.id,\n                title: {\n                    ...nls.localize2('actions.goToDecl.label', \"Go to Definition\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\"),\n                },\n                precondition: EditorContextKeys.hasDefinitionProvider,\n                keybinding: [{\n                        when: EditorContextKeys.editorTextFocus,\n                        primary: 70 /* KeyCode.F12 */,\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }, {\n                        when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                        primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }],\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.1\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 2,\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', _a.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterAction2((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _b.id,\n                title: nls.localize2('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                keybinding: [{\n                        when: EditorContextKeys.editorTextFocus,\n                        primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 70 /* KeyCode.F12 */),\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }, {\n                        when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                        primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */),\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', _b.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterAction2((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _c.id,\n                title: nls.localize2('actions.previewDecl.label', \"Peek Definition\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                    linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', _c.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, token), nls.localize('decl.title', 'Declarations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterAction2((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _d.id,\n                title: {\n                    ...nls.localize2('actions.goToDeclaration.label', \"Go to Declaration\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\"),\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.3\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }],\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterAction2(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            title: nls.localize2('actions.peekDecl.label', \"Peek Declaration\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterAction2((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _e.ID,\n                title: {\n                    ...nls.localize2('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\"),\n                },\n                precondition: EditorContextKeys.hasTypeDefinitionProvider,\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.4\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }]\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterAction2((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _f.ID,\n                title: nls.localize2('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, token), nls.localize('impl.title', 'Implementations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterAction2((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _g.ID,\n                title: {\n                    ...nls.localize2('actions.goToImplementation.label', \"Go to Implementations\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\"),\n                },\n                precondition: EditorContextKeys.hasImplementationProvider,\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.45\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 4,\n                    }]\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterAction2((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _h.ID,\n                title: nls.localize2('actions.peekImplementation.label', \"Peek Implementations\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterAction2(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            title: {\n                ...nls.localize2('goToReferences.label', \"Go to References\"),\n                mnemonicTitle: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\"),\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.45\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 5,\n                }]\n        });\n    }\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, token), nls.localize('ref.title', 'References'));\n    }\n});\nregisterAction2(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            title: nls.localize2('references.action.label', \"Peek References\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, token), nls.localize('ref.title', 'References'));\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            title: nls.localize2('label.generic', \"Go to Any Symbol\"),\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    async _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _j;\n        return (_j = this._gotoMultipleBehaviour) !== null && _j !== void 0 ? _j : editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    metadata: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: async (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = await editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    }\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    metadata: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`' },\n        ]\n    },\n    handler: async (accessor, resource, position, references, multiple) => {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    }\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ReferencesController_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nimport { EditorContextKeys } from '../../../../common/editorContextKeys.js';\nimport { InputFocusedContext } from '../../../../../platform/contextkey/common/contextkeys.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nlet ReferencesController = ReferencesController_1 = class ReferencesController {\n    static get(editor) {\n        return editor.getContribution(ReferencesController_1.ID);\n    }\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element, true);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(87 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    async goToNextOrPreviousReference(fwd) {\n        if (!this._editor.hasModel() || !this._model || !this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        const currentPosition = this._widget.position;\n        if (!currentPosition) {\n            return;\n        }\n        const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n        if (!source) {\n            return;\n        }\n        const target = this._model.nextOrPreviousReference(source, fwd);\n        const editorFocus = this._editor.hasTextFocus();\n        const previewEditorFocus = this._widget.isPreviewEditorFocused();\n        await this._widget.setSelection(target);\n        await this._gotoReference(target, false);\n        if (editorFocus) {\n            this._editor.focus();\n        }\n        else if (this._widget && previewEditorFocus) {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    async revealReference(reference) {\n        if (!this._editor.hasModel() || !this._model || !this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        await this._widget.revealReference(reference);\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref, pinned) {\n        var _a;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.hide();\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController_1.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = ReferencesController_1 = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nexport { ReferencesController };\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'), ContextKeyExpr.or(EditorContextKeys.editorTextFocus, InputFocusedContext.negate()))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"{0} in {1} on line {2} at column {3}\", preview.value, basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    async resolve(textModelResolverService) {\n        if (this._previews.size !== 0) {\n            return this;\n        }\n        for (const child of this.children) {\n            if (this._previews.has(child.uri)) {\n                continue;\n            }\n            try {\n                const ref = await textModelResolverService.createModelReference(child.uri);\n                this._previews.set(child.uri, new FilePreview(ref));\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n        }\n        return this;\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: true\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, {}, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    async revealReference(reference) {\n        await this._revealReference(reference, false);\n        this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n    }\n    async _revealReference(reference, revealParent) {\n        // check if there is anything to do...\n        if (this._revealedReference === reference) {\n            return;\n        }\n        this._revealedReference = reference;\n        // Update widget header\n        if (reference.uri.scheme !== Schemas.inMemory) {\n            this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n        }\n        else {\n            this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n        }\n        const promise = this._textModelResolverService.createModelReference(reference.uri);\n        if (this._tree.getInput() === reference.parent) {\n            this._tree.reveal(reference);\n        }\n        else {\n            if (revealParent) {\n                this._tree.reveal(reference.parent);\n            }\n            await this._tree.expand(reference.parent);\n            this._tree.reveal(reference);\n        }\n        const ref = await promise;\n        if (!this._model) {\n            // disposed\n            ref.dispose();\n            return;\n        }\n        dispose(this._previewModelReference);\n        // show in editor\n        const model = ref.object;\n        if (model) {\n            const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n            const sel = Range.lift(reference.range).collapseToStart();\n            this._previewModelReference = ref;\n            this._preview.setModel(model.textEditorModel);\n            this._preview.setSelection(sel);\n            this._preview.revealRangeInCenter(sel, scrollType);\n        }\n        else {\n            this._preview.setModel(this._previewNotAvailableMessage);\n            ref.dispose();\n        }\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar FileReferencesRenderer_1;\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { defaultCountBadgeStyles } from '../../../../../platform/theme/browser/defaultStyles.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nlet DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\nexport { DataSource };\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nlet StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport { StringRepresentationProvider };\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')), {}, defaultCountBadgeStyles);\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService)\n], FileReferencesTemplate);\nlet FileReferencesRenderer = FileReferencesRenderer_1 = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer_1.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = FileReferencesRenderer_1 = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\nexport { FileReferencesRenderer };\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate {\n    constructor(container) {\n        this.label = new HighlightedLabel(container);\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate() {\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, 1 /* InstantiationType.Delayed */);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ReferencesModel } from './referencesModel.js';\nasync function getLocationLinks(model, position, registry, provide) {\n    const provider = registry.ordered(model);\n    // get results\n    const promises = provider.map((provider) => {\n        return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n            onUnexpectedExternalError(err);\n            return undefined;\n        });\n    });\n    const values = await Promise.all(promises);\n    return coalesce(values.flat());\n}\nexport function getDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, token) {\n    return getLocationLinks(model, position, registry, async (provider, model, position) => {\n        const result = await provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = await provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    });\n}\n// -- API commands ----\nasync function _sortedAndDeduped(callback) {\n    const rawLinks = await callback();\n    const model = new ReferencesModel(rawLinks, '');\n    const modelLinks = model.references.map(ref => ref.link);\n    model.dispose();\n    return modelLinks;\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ContentHoverController_1, ContentHoverWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { HoverAction, HoverWidget, getHoverAccessibleViewHint } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverParticipantRegistry, HoverRangeAnchor } from './hoverTypes.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ResizableContentWidget } from './resizableContentWidget.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nconst $ = dom.$;\nlet ContentHoverController = ContentHoverController_1 = class ContentHoverController extends Disposable {\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._currentResult = null;\n        this._widget = this._register(this._instantiationService.createInstance(ContentHoverWidget, this._editor));\n        // Instantiate participants and sort them by `hoverOrdinal` which is relevant for rendering order.\n        this._participants = [];\n        for (const participant of HoverParticipantRegistry.getAll()) {\n            this._participants.push(this._instantiationService.createInstance(participant, this._editor));\n        }\n        this._participants.sort((p1, p2) => p1.hoverOrdinal - p2.hoverOrdinal);\n        this._computer = new ContentHoverComputer(this._editor, this._participants);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            if (!this._computer.anchor) {\n                // invalid state, ignore result\n                return;\n            }\n            const messages = (result.hasLoadingMessage ? this._addLoadingMessage(result.value) : result.value);\n            this._withResult(new HoverResult(this._computer.anchor, messages, result.isComplete));\n        }));\n        this._register(dom.addStandardDisposableListener(this._widget.getDomNode(), 'keydown', (e) => {\n            if (e.equals(9 /* KeyCode.Escape */)) {\n                this.hide();\n            }\n        }));\n        this._register(TokenizationRegistry.onDidChange(() => {\n            if (this._widget.position && this._currentResult) {\n                this._setCurrentResult(this._currentResult); // render again\n            }\n        }));\n    }\n    /**\n     * Returns true if the hover shows now or will show.\n     */\n    _startShowingOrUpdateHover(anchor, mode, source, focus, mouseEvent) {\n        if (!this._widget.position || !this._currentResult) {\n            // The hover is not visible\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n                return true;\n            }\n            return false;\n        }\n        // The hover is currently visible\n        const isHoverSticky = this._editor.getOption(60 /* EditorOption.hover */).sticky;\n        const isGettingCloser = (isHoverSticky\n            && mouseEvent\n            && this._widget.isMouseGettingCloser(mouseEvent.event.posx, mouseEvent.event.posy));\n        if (isGettingCloser) {\n            // The mouse is getting closer to the hover, so we will keep the hover untouched\n            // But we will kick off a hover update at the new anchor, insisting on keeping the hover visible.\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, true);\n            }\n            return true;\n        }\n        if (!anchor) {\n            this._setCurrentResult(null);\n            return false;\n        }\n        if (anchor && this._currentResult.anchor.equals(anchor)) {\n            // The widget is currently showing results for the exact same anchor, so no update is needed\n            return true;\n        }\n        if (!anchor.canAdoptVisibleHover(this._currentResult.anchor, this._widget.position)) {\n            // The new anchor is not compatible with the previous anchor\n            this._setCurrentResult(null);\n            this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n            return true;\n        }\n        // We aren't getting any closer to the hover, so we will filter existing results\n        // and keep those which also apply to the new anchor.\n        this._setCurrentResult(this._currentResult.filter(anchor));\n        this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n        return true;\n    }\n    _startHoverOperationIfNecessary(anchor, mode, source, focus, insistOnKeepingHoverVisible) {\n        if (this._computer.anchor && this._computer.anchor.equals(anchor)) {\n            // We have to start a hover operation at the exact same anchor as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this._computer.anchor = anchor;\n        this._computer.shouldFocus = focus;\n        this._computer.source = source;\n        this._computer.insistOnKeepingHoverVisible = insistOnKeepingHoverVisible;\n        this._hoverOperation.start(mode);\n    }\n    _setCurrentResult(hoverResult) {\n        if (this._currentResult === hoverResult) {\n            // avoid updating the DOM to avoid resetting the user selection\n            return;\n        }\n        if (hoverResult && hoverResult.messages.length === 0) {\n            hoverResult = null;\n        }\n        this._currentResult = hoverResult;\n        if (this._currentResult) {\n            this._renderMessages(this._currentResult.anchor, this._currentResult.messages);\n        }\n        else {\n            this._widget.hide();\n        }\n    }\n    _addLoadingMessage(result) {\n        if (this._computer.anchor) {\n            for (const participant of this._participants) {\n                if (participant.createLoadingMessage) {\n                    const loadingMessage = participant.createLoadingMessage(this._computer.anchor);\n                    if (loadingMessage) {\n                        return result.slice(0).concat([loadingMessage]);\n                    }\n                }\n            }\n        }\n        return result;\n    }\n    _withResult(hoverResult) {\n        if (this._widget.position && this._currentResult && this._currentResult.isComplete) {\n            // The hover is visible with a previous complete result.\n            if (!hoverResult.isComplete) {\n                // Instead of rendering the new partial result, we wait for the result to be complete.\n                return;\n            }\n            if (this._computer.insistOnKeepingHoverVisible && hoverResult.messages.length === 0) {\n                // The hover would now hide normally, so we'll keep the previous messages\n                return;\n            }\n        }\n        this._setCurrentResult(hoverResult);\n    }\n    _renderMessages(anchor, messages) {\n        const { showAtPosition, showAtSecondaryPosition, highlightRange } = ContentHoverController_1.computeHoverRanges(this._editor, anchor.range, messages);\n        const disposables = new DisposableStore();\n        const statusBar = disposables.add(new EditorHoverStatusBar(this._keybindingService));\n        const fragment = document.createDocumentFragment();\n        let colorPicker = null;\n        const context = {\n            fragment,\n            statusBar,\n            setColorPicker: (widget) => colorPicker = widget,\n            onContentsChanged: () => this._widget.onContentsChanged(),\n            setMinimumDimensions: (dimensions) => this._widget.setMinimumDimensions(dimensions),\n            hide: () => this.hide()\n        };\n        for (const participant of this._participants) {\n            const hoverParts = messages.filter(msg => msg.owner === participant);\n            if (hoverParts.length > 0) {\n                disposables.add(participant.renderHoverParts(context, hoverParts));\n            }\n        }\n        const isBeforeContent = messages.some(m => m.isBeforeContent);\n        if (statusBar.hasContent) {\n            fragment.appendChild(statusBar.hoverElement);\n        }\n        if (fragment.hasChildNodes()) {\n            if (highlightRange) {\n                const highlightDecoration = this._editor.createDecorationsCollection();\n                highlightDecoration.set([{\n                        range: highlightRange,\n                        options: ContentHoverController_1._DECORATION_OPTIONS\n                    }]);\n                disposables.add(toDisposable(() => {\n                    highlightDecoration.clear();\n                }));\n            }\n            this._widget.showAt(fragment, new ContentHoverVisibleData(anchor.initialMousePosX, anchor.initialMousePosY, colorPicker, showAtPosition, showAtSecondaryPosition, this._editor.getOption(60 /* EditorOption.hover */).above, this._computer.shouldFocus, this._computer.source, isBeforeContent, disposables));\n        }\n        else {\n            disposables.dispose();\n        }\n    }\n    static computeHoverRanges(editor, anchorRange, messages) {\n        let startColumnBoundary = 1;\n        if (editor.hasModel()) {\n            // Ensure the range is on the current view line\n            const viewModel = editor._getViewModel();\n            const coordinatesConverter = viewModel.coordinatesConverter;\n            const anchorViewRange = coordinatesConverter.convertModelRangeToViewRange(anchorRange);\n            const anchorViewRangeStart = new Position(anchorViewRange.startLineNumber, viewModel.getLineMinColumn(anchorViewRange.startLineNumber));\n            startColumnBoundary = coordinatesConverter.convertViewPositionToModelPosition(anchorViewRangeStart).column;\n        }\n        // The anchor range is always on a single line\n        const anchorLineNumber = anchorRange.startLineNumber;\n        let renderStartColumn = anchorRange.startColumn;\n        let highlightRange = messages[0].range;\n        let forceShowAtRange = null;\n        for (const msg of messages) {\n            highlightRange = Range.plusRange(highlightRange, msg.range);\n            if (msg.range.startLineNumber === anchorLineNumber && msg.range.endLineNumber === anchorLineNumber) {\n                // this message has a range that is completely sitting on the line of the anchor\n                renderStartColumn = Math.max(Math.min(renderStartColumn, msg.range.startColumn), startColumnBoundary);\n            }\n            if (msg.forceShowAtRange) {\n                forceShowAtRange = msg.range;\n            }\n        }\n        const showAtPosition = forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, anchorRange.startColumn);\n        const showAtSecondaryPosition = forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, renderStartColumn);\n        return {\n            showAtPosition,\n            showAtSecondaryPosition,\n            highlightRange\n        };\n    }\n    /**\n     * Returns true if the hover shows now or will show.\n     */\n    showsOrWillShow(mouseEvent) {\n        if (this._widget.isResizing) {\n            return true;\n        }\n        const anchorCandidates = [];\n        for (const participant of this._participants) {\n            if (participant.suggestHoverAnchor) {\n                const anchor = participant.suggestHoverAnchor(mouseEvent);\n                if (anchor) {\n                    anchorCandidates.push(anchor);\n                }\n            }\n        }\n        const target = mouseEvent.target;\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            const epsilon = this._editor.getOption(50 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth / 2;\n            if (!target.detail.isAfterLines\n                && typeof target.detail.horizontalDistanceToText === 'number'\n                && target.detail.horizontalDistanceToText < epsilon) {\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\n                anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n            }\n        }\n        if (anchorCandidates.length === 0) {\n            return this._startShowingOrUpdateHover(null, 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n        }\n        anchorCandidates.sort((a, b) => b.priority - a.priority);\n        return this._startShowingOrUpdateHover(anchorCandidates[0], 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n    }\n    startShowingAtRange(range, mode, source, focus) {\n        this._startShowingOrUpdateHover(new HoverRangeAnchor(0, range, undefined, undefined), mode, source, focus, null);\n    }\n    containsNode(node) {\n        return (node ? this._widget.getDomNode().contains(node) : false);\n    }\n    focus() {\n        this._widget.focus();\n    }\n    scrollUp() {\n        this._widget.scrollUp();\n    }\n    scrollDown() {\n        this._widget.scrollDown();\n    }\n    scrollLeft() {\n        this._widget.scrollLeft();\n    }\n    scrollRight() {\n        this._widget.scrollRight();\n    }\n    pageUp() {\n        this._widget.pageUp();\n    }\n    pageDown() {\n        this._widget.pageDown();\n    }\n    goToTop() {\n        this._widget.goToTop();\n    }\n    goToBottom() {\n        this._widget.goToBottom();\n    }\n    hide() {\n        this._computer.anchor = null;\n        this._hoverOperation.cancel();\n        this._setCurrentResult(null);\n    }\n    get isColorPickerVisible() {\n        return this._widget.isColorPickerVisible;\n    }\n    get isVisibleFromKeyboard() {\n        return this._widget.isVisibleFromKeyboard;\n    }\n    get isVisible() {\n        return this._widget.isVisible;\n    }\n    get isFocused() {\n        return this._widget.isFocused;\n    }\n    get isResizing() {\n        return this._widget.isResizing;\n    }\n    get widget() {\n        return this._widget;\n    }\n};\nContentHoverController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n    description: 'content-hover-highlight',\n    className: 'hoverHighlight'\n});\nContentHoverController = ContentHoverController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], ContentHoverController);\nexport { ContentHoverController };\nclass HoverResult {\n    constructor(anchor, messages, isComplete) {\n        this.anchor = anchor;\n        this.messages = messages;\n        this.isComplete = isComplete;\n    }\n    filter(anchor) {\n        const filteredMessages = this.messages.filter((m) => m.isValidForHoverAnchor(anchor));\n        if (filteredMessages.length === this.messages.length) {\n            return this;\n        }\n        return new FilteredHoverResult(this, this.anchor, filteredMessages, this.isComplete);\n    }\n}\nclass FilteredHoverResult extends HoverResult {\n    constructor(original, anchor, messages, isComplete) {\n        super(anchor, messages, isComplete);\n        this.original = original;\n    }\n    filter(anchor) {\n        return this.original.filter(anchor);\n    }\n}\nclass ContentHoverVisibleData {\n    constructor(initialMousePosX, initialMousePosY, colorPicker, showAtPosition, showAtSecondaryPosition, preferAbove, stoleFocus, source, isBeforeContent, disposables) {\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.colorPicker = colorPicker;\n        this.showAtPosition = showAtPosition;\n        this.showAtSecondaryPosition = showAtSecondaryPosition;\n        this.preferAbove = preferAbove;\n        this.stoleFocus = stoleFocus;\n        this.source = source;\n        this.isBeforeContent = isBeforeContent;\n        this.disposables = disposables;\n        this.closestMouseDistance = undefined;\n    }\n}\nconst HORIZONTAL_SCROLLING_BY = 30;\nconst SCROLLBAR_WIDTH = 10;\nconst CONTAINER_HEIGHT_PADDING = 6;\nlet ContentHoverWidget = ContentHoverWidget_1 = class ContentHoverWidget extends ResizableContentWidget {\n    get isColorPickerVisible() {\n        var _a;\n        return Boolean((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker);\n    }\n    get isVisibleFromKeyboard() {\n        var _a;\n        return (((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.source) === 1 /* HoverStartSource.Keyboard */);\n    }\n    get isVisible() {\n        var _a;\n        return (_a = this._hoverVisibleKey.get()) !== null && _a !== void 0 ? _a : false;\n    }\n    get isFocused() {\n        var _a;\n        return (_a = this._hoverFocusedKey.get()) !== null && _a !== void 0 ? _a : false;\n    }\n    constructor(editor, contextKeyService, _configurationService, _accessibilityService, _keybindingService) {\n        const minimumHeight = editor.getOption(67 /* EditorOption.lineHeight */) + 8;\n        const minimumWidth = 150;\n        const minimumSize = new dom.Dimension(minimumWidth, minimumHeight);\n        super(editor, minimumSize);\n        this._configurationService = _configurationService;\n        this._accessibilityService = _accessibilityService;\n        this._keybindingService = _keybindingService;\n        this._hover = this._register(new HoverWidget());\n        this._minimumSize = minimumSize;\n        this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(contextKeyService);\n        this._hoverFocusedKey = EditorContextKeys.hoverFocused.bindTo(contextKeyService);\n        dom.append(this._resizableNode.domNode, this._hover.containerDomNode);\n        this._resizableNode.domNode.style.zIndex = '50';\n        this._register(this._editor.onDidLayoutChange(() => {\n            if (this.isVisible) {\n                this._updateMaxDimensions();\n            }\n        }));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        const focusTracker = this._register(dom.trackFocus(this._resizableNode.domNode));\n        this._register(focusTracker.onDidFocus(() => {\n            this._hoverFocusedKey.set(true);\n        }));\n        this._register(focusTracker.onDidBlur(() => {\n            this._hoverFocusedKey.set(false);\n        }));\n        this._setHoverData(undefined);\n        this._editor.addContentWidget(this);\n    }\n    dispose() {\n        var _a;\n        super.dispose();\n        (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return ContentHoverWidget_1.ID;\n    }\n    static _applyDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.width = transformedWidth;\n        container.style.height = transformedHeight;\n    }\n    _setContentsDomNodeDimensions(width, height) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        return ContentHoverWidget_1._applyDimensions(contentsDomNode, width, height);\n    }\n    _setContainerDomNodeDimensions(width, height) {\n        const containerDomNode = this._hover.containerDomNode;\n        return ContentHoverWidget_1._applyDimensions(containerDomNode, width, height);\n    }\n    _setHoverWidgetDimensions(width, height) {\n        this._setContentsDomNodeDimensions(width, height);\n        this._setContainerDomNodeDimensions(width, height);\n        this._layoutContentWidget();\n    }\n    static _applyMaxDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.maxWidth = transformedWidth;\n        container.style.maxHeight = transformedHeight;\n    }\n    _setHoverWidgetMaxDimensions(width, height) {\n        ContentHoverWidget_1._applyMaxDimensions(this._hover.contentsDomNode, width, height);\n        ContentHoverWidget_1._applyMaxDimensions(this._hover.containerDomNode, width, height);\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-maxWidth', typeof width === 'number' ? `${width}px` : width);\n        this._layoutContentWidget();\n    }\n    _hasHorizontalScrollbar() {\n        const scrollDimensions = this._hover.scrollbar.getScrollDimensions();\n        const hasHorizontalScrollbar = scrollDimensions.scrollWidth > scrollDimensions.width;\n        return hasHorizontalScrollbar;\n    }\n    _adjustContentsBottomPadding() {\n        const contentsDomNode = this._hover.contentsDomNode;\n        const extraBottomPadding = `${this._hover.scrollbar.options.horizontalScrollbarSize}px`;\n        if (contentsDomNode.style.paddingBottom !== extraBottomPadding) {\n            contentsDomNode.style.paddingBottom = extraBottomPadding;\n        }\n    }\n    _setAdjustedHoverWidgetDimensions(size) {\n        this._setHoverWidgetMaxDimensions('none', 'none');\n        const width = size.width;\n        const height = size.height;\n        this._setHoverWidgetDimensions(width, height);\n        // measure if widget has horizontal scrollbar after setting the dimensions\n        if (this._hasHorizontalScrollbar()) {\n            this._adjustContentsBottomPadding();\n            this._setContentsDomNodeDimensions(width, height - SCROLLBAR_WIDTH);\n        }\n    }\n    _updateResizableNodeMaxDimensions() {\n        var _a, _b;\n        const maxRenderingWidth = (_a = this._findMaximumRenderingWidth()) !== null && _a !== void 0 ? _a : Infinity;\n        const maxRenderingHeight = (_b = this._findMaximumRenderingHeight()) !== null && _b !== void 0 ? _b : Infinity;\n        this._resizableNode.maxSize = new dom.Dimension(maxRenderingWidth, maxRenderingHeight);\n        this._setHoverWidgetMaxDimensions(maxRenderingWidth, maxRenderingHeight);\n    }\n    _resize(size) {\n        var _a, _b;\n        ContentHoverWidget_1._lastDimensions = new dom.Dimension(size.width, size.height);\n        this._setAdjustedHoverWidgetDimensions(size);\n        this._resizableNode.layout(size.height, size.width);\n        this._updateResizableNodeMaxDimensions();\n        this._hover.scrollbar.scanDomNode();\n        this._editor.layoutContentWidget(this);\n        (_b = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n    }\n    _findAvailableSpaceVertically() {\n        var _a;\n        const position = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition;\n        if (!position) {\n            return;\n        }\n        return this._positionPreference === 1 /* ContentWidgetPositionPreference.ABOVE */ ?\n            this._availableVerticalSpaceAbove(position)\n            : this._availableVerticalSpaceBelow(position);\n    }\n    _findMaximumRenderingHeight() {\n        const availableSpace = this._findAvailableSpaceVertically();\n        if (!availableSpace) {\n            return;\n        }\n        // Padding needed in order to stop the resizing down to a smaller height\n        let maximumHeight = CONTAINER_HEIGHT_PADDING;\n        Array.from(this._hover.contentsDomNode.children).forEach((hoverPart) => {\n            maximumHeight += hoverPart.clientHeight;\n        });\n        if (this._hasHorizontalScrollbar()) {\n            maximumHeight += SCROLLBAR_WIDTH;\n        }\n        return Math.min(availableSpace, maximumHeight);\n    }\n    _isHoverTextOverflowing() {\n        // To find out if the text is overflowing, we will disable wrapping, check the widths, and then re-enable wrapping\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-whiteSpace', 'nowrap');\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-sourceWhiteSpace', 'nowrap');\n        const overflowing = Array.from(this._hover.contentsDomNode.children).some((hoverElement) => {\n            return hoverElement.scrollWidth > hoverElement.clientWidth;\n        });\n        this._hover.containerDomNode.style.removeProperty('--vscode-hover-whiteSpace');\n        this._hover.containerDomNode.style.removeProperty('--vscode-hover-sourceWhiteSpace');\n        return overflowing;\n    }\n    _findMaximumRenderingWidth() {\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        const overflowing = this._isHoverTextOverflowing();\n        const initialWidth = (typeof this._contentWidth === 'undefined'\n            ? 0\n            : this._contentWidth - 2 // - 2 for the borders\n        );\n        if (overflowing || this._hover.containerDomNode.clientWidth < initialWidth) {\n            const bodyBoxWidth = dom.getClientArea(this._hover.containerDomNode.ownerDocument.body).width;\n            const horizontalPadding = 14;\n            return bodyBoxWidth - horizontalPadding;\n        }\n        else {\n            return this._hover.containerDomNode.clientWidth + 2;\n        }\n    }\n    isMouseGettingCloser(posx, posy) {\n        if (!this._visibleData) {\n            return false;\n        }\n        if (typeof this._visibleData.initialMousePosX === 'undefined'\n            || typeof this._visibleData.initialMousePosY === 'undefined') {\n            this._visibleData.initialMousePosX = posx;\n            this._visibleData.initialMousePosY = posy;\n            return false;\n        }\n        const widgetRect = dom.getDomNodePagePosition(this.getDomNode());\n        if (typeof this._visibleData.closestMouseDistance === 'undefined') {\n            this._visibleData.closestMouseDistance = computeDistanceFromPointToRectangle(this._visibleData.initialMousePosX, this._visibleData.initialMousePosY, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        }\n        const distance = computeDistanceFromPointToRectangle(posx, posy, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        if (distance > this._visibleData.closestMouseDistance + 4 /* tolerance of 4 pixels */) {\n            // The mouse is getting farther away\n            return false;\n        }\n        this._visibleData.closestMouseDistance = Math.min(this._visibleData.closestMouseDistance, distance);\n        return true;\n    }\n    _setHoverData(hoverData) {\n        var _a;\n        (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n        this._visibleData = hoverData;\n        this._hoverVisibleKey.set(!!hoverData);\n        this._hover.containerDomNode.classList.toggle('hidden', !hoverData);\n    }\n    _updateFont() {\n        const { fontSize, lineHeight } = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.fontSize = `${fontSize}px`;\n        contentsDomNode.style.lineHeight = `${lineHeight / fontSize}`;\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _updateContent(node) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.paddingBottom = '';\n        contentsDomNode.textContent = '';\n        contentsDomNode.appendChild(node);\n    }\n    _layoutContentWidget() {\n        this._editor.layoutContentWidget(this);\n        this._hover.onContentsChanged();\n    }\n    _updateMaxDimensions() {\n        const height = Math.max(this._editor.getLayoutInfo().height / 4, 250, ContentHoverWidget_1._lastDimensions.height);\n        const width = Math.max(this._editor.getLayoutInfo().width * 0.66, 500, ContentHoverWidget_1._lastDimensions.width);\n        this._setHoverWidgetMaxDimensions(width, height);\n    }\n    _render(node, hoverData) {\n        this._setHoverData(hoverData);\n        this._updateFont();\n        this._updateContent(node);\n        this._updateMaxDimensions();\n        this.onContentsChanged();\n        // Simply force a synchronous render on the editor\n        // such that the widget does not really render with left = '0px'\n        this._editor.render();\n    }\n    getPosition() {\n        var _a;\n        if (!this._visibleData) {\n            return null;\n        }\n        return {\n            position: this._visibleData.showAtPosition,\n            secondaryPosition: this._visibleData.showAtSecondaryPosition,\n            positionAffinity: this._visibleData.isBeforeContent ? 3 /* PositionAffinity.LeftOfInjectedText */ : undefined,\n            preference: [(_a = this._positionPreference) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    showAt(node, hoverData) {\n        var _a, _b, _c, _d;\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        this._render(node, hoverData);\n        const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n        const widgetPosition = hoverData.showAtPosition;\n        this._positionPreference = (_a = this._findPositionPreference(widgetHeight, widgetPosition)) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */;\n        // See https://github.com/microsoft/vscode/issues/140339\n        // TODO: Doing a second layout of the hover after force rendering the editor\n        this.onContentsChanged();\n        if (hoverData.stoleFocus) {\n            this._hover.containerDomNode.focus();\n        }\n        (_b = hoverData.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n        // The aria label overrides the label, so if we add to it, add the contents of the hover\n        const hoverFocused = this._hover.containerDomNode.ownerDocument.activeElement === this._hover.containerDomNode;\n        const accessibleViewHint = hoverFocused && getHoverAccessibleViewHint(this._configurationService.getValue('accessibility.verbosity.hover') === true && this._accessibilityService.isScreenReaderOptimized(), (_d = (_c = this._keybindingService.lookupKeybinding('editor.action.accessibleView')) === null || _c === void 0 ? void 0 : _c.getAriaLabel()) !== null && _d !== void 0 ? _d : '');\n        if (accessibleViewHint) {\n            this._hover.contentsDomNode.ariaLabel = this._hover.contentsDomNode.textContent + ', ' + accessibleViewHint;\n        }\n    }\n    hide() {\n        if (!this._visibleData) {\n            return;\n        }\n        const stoleFocus = this._visibleData.stoleFocus || this._hoverFocusedKey.get();\n        this._setHoverData(undefined);\n        this._resizableNode.maxSize = new dom.Dimension(Infinity, Infinity);\n        this._resizableNode.clearSashHoverState();\n        this._hoverFocusedKey.set(false);\n        this._editor.layoutContentWidget(this);\n        if (stoleFocus) {\n            this._editor.focus();\n        }\n    }\n    _removeConstraintsRenderNormally() {\n        // Added because otherwise the initial size of the hover content is smaller than should be\n        const layoutInfo = this._editor.getLayoutInfo();\n        this._resizableNode.layout(layoutInfo.height, layoutInfo.width);\n        this._setHoverWidgetDimensions('auto', 'auto');\n    }\n    _adjustHoverHeightForScrollbar(height) {\n        var _a;\n        const containerDomNode = this._hover.containerDomNode;\n        const contentsDomNode = this._hover.contentsDomNode;\n        const maxRenderingHeight = (_a = this._findMaximumRenderingHeight()) !== null && _a !== void 0 ? _a : Infinity;\n        this._setContainerDomNodeDimensions(dom.getTotalWidth(containerDomNode), Math.min(maxRenderingHeight, height));\n        this._setContentsDomNodeDimensions(dom.getTotalWidth(contentsDomNode), Math.min(maxRenderingHeight, height - SCROLLBAR_WIDTH));\n    }\n    setMinimumDimensions(dimensions) {\n        // We combine the new minimum dimensions with the previous ones\n        this._minimumSize = new dom.Dimension(Math.max(this._minimumSize.width, dimensions.width), Math.max(this._minimumSize.height, dimensions.height));\n        this._updateMinimumWidth();\n    }\n    _updateMinimumWidth() {\n        const width = (typeof this._contentWidth === 'undefined'\n            ? this._minimumSize.width\n            : Math.min(this._contentWidth, this._minimumSize.width));\n        // We want to avoid that the hover is artificially large, so we use the content width as minimum width\n        this._resizableNode.minSize = new dom.Dimension(width, this._minimumSize.height);\n    }\n    onContentsChanged() {\n        var _a;\n        this._removeConstraintsRenderNormally();\n        const containerDomNode = this._hover.containerDomNode;\n        let height = dom.getTotalHeight(containerDomNode);\n        let width = dom.getTotalWidth(containerDomNode);\n        this._resizableNode.layout(height, width);\n        this._setHoverWidgetDimensions(width, height);\n        height = dom.getTotalHeight(containerDomNode);\n        width = dom.getTotalWidth(containerDomNode);\n        this._contentWidth = width;\n        this._updateMinimumWidth();\n        this._resizableNode.layout(height, width);\n        if (this._hasHorizontalScrollbar()) {\n            this._adjustContentsBottomPadding();\n            this._adjustHoverHeightForScrollbar(height);\n        }\n        if ((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition) {\n            const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n            this._positionPreference = this._findPositionPreference(widgetHeight, this._visibleData.showAtPosition);\n        }\n        this._layoutContentWidget();\n    }\n    focus() {\n        this._hover.containerDomNode.focus();\n    }\n    scrollUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - fontInfo.lineHeight });\n    }\n    scrollDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + fontInfo.lineHeight });\n    }\n    scrollLeft() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft - HORIZONTAL_SCROLLING_BY });\n    }\n    scrollRight() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft + HORIZONTAL_SCROLLING_BY });\n    }\n    pageUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - scrollHeight });\n    }\n    pageDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + scrollHeight });\n    }\n    goToTop() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: 0 });\n    }\n    goToBottom() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: this._hover.scrollbar.getScrollDimensions().scrollHeight });\n    }\n};\nContentHoverWidget.ID = 'editor.contrib.resizableContentHoverWidget';\nContentHoverWidget._lastDimensions = new dom.Dimension(0, 0);\nContentHoverWidget = ContentHoverWidget_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IConfigurationService),\n    __param(3, IAccessibilityService),\n    __param(4, IKeybindingService)\n], ContentHoverWidget);\nexport { ContentHoverWidget };\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\n    get hasContent() {\n        return this._hasContent;\n    }\n    constructor(_keybindingService) {\n        super();\n        this._keybindingService = _keybindingService;\n        this._hasContent = false;\n        this.hoverElement = $('div.hover-row.status-bar');\n        this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\n    }\n    addAction(actionOptions) {\n        const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n        this._hasContent = true;\n        return this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\n    }\n    append(element) {\n        const result = dom.append(this.actionsElement, element);\n        this._hasContent = true;\n        return result;\n    }\n};\nEditorHoverStatusBar = __decorate([\n    __param(0, IKeybindingService)\n], EditorHoverStatusBar);\nexport { EditorHoverStatusBar };\nclass ContentHoverComputer {\n    get anchor() { return this._anchor; }\n    set anchor(value) { this._anchor = value; }\n    get shouldFocus() { return this._shouldFocus; }\n    set shouldFocus(value) { this._shouldFocus = value; }\n    get source() { return this._source; }\n    set source(value) { this._source = value; }\n    get insistOnKeepingHoverVisible() { return this._insistOnKeepingHoverVisible; }\n    set insistOnKeepingHoverVisible(value) { this._insistOnKeepingHoverVisible = value; }\n    constructor(_editor, _participants) {\n        this._editor = _editor;\n        this._participants = _participants;\n        this._anchor = null;\n        this._shouldFocus = false;\n        this._source = 0 /* HoverStartSource.Mouse */;\n        this._insistOnKeepingHoverVisible = false;\n    }\n    static _getLineDecorations(editor, anchor) {\n        if (anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n            return [];\n        }\n        const model = editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        if (lineNumber > model.getLineCount()) {\n            // invalid line\n            return [];\n        }\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        return editor.getLineDecorations(lineNumber).filter((d) => {\n            if (d.options.isWholeLine) {\n                return true;\n            }\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            if (d.options.showIfCollapsed) {\n                // Relax check around `showIfCollapsed` decorations to also include +/- 1 character\n                if (startColumn > anchor.range.startColumn + 1 || anchor.range.endColumn - 1 > endColumn) {\n                    return false;\n                }\n            }\n            else {\n                if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n    computeAsync(token) {\n        const anchor = this._anchor;\n        if (!this._editor.hasModel() || !anchor) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, anchor);\n        return AsyncIterableObject.merge(this._participants.map((participant) => {\n            if (!participant.computeAsync) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return participant.computeAsync(anchor, lineDecorations, token);\n        }));\n    }\n    computeSync() {\n        if (!this._editor.hasModel() || !this._anchor) {\n            return [];\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, this._anchor);\n        let result = [];\n        for (const participant of this._participants) {\n            result = result.concat(participant.computeSync(this._anchor, lineDecorations));\n        }\n        return coalesce(result);\n    }\n}\nfunction computeDistanceFromPointToRectangle(pointX, pointY, left, top, width, height) {\n    const x = (left + width / 2); // x center of rectangle\n    const y = (top + height / 2); // y center of rectangle\n    const dx = Math.max(Math.abs(pointX - x) - width / 2, 0);\n    const dy = Math.max(Math.abs(pointY - y) - height / 2, 0);\n    return Math.sqrt(dx * dx + dy * dy);\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createCancelableAsyncIterable, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nexport class HoverResult {\n    constructor(value, isComplete, hasLoadingMessage) {\n        this.value = value;\n        this.isComplete = isComplete;\n        this.hasLoadingMessage = hasLoadingMessage;\n    }\n}\n/**\n * Computing the hover is very fine tuned.\n *\n * Suppose the hover delay is 300ms (the default). Then, when resting the mouse at an anchor:\n * - at 150ms, the async computation is triggered (i.e. semantic hover)\n *   - if async results already come in, they are not rendered yet.\n * - at 300ms, the sync computation is triggered (i.e. decorations, markers)\n *   - if there are sync or async results, they are rendered.\n * - at 900ms, if the async computation hasn't finished, a \"Loading...\" result is added.\n */\nexport class HoverOperation extends Disposable {\n    constructor(_editor, _computer) {\n        super();\n        this._editor = _editor;\n        this._computer = _computer;\n        this._onResult = this._register(new Emitter());\n        this.onResult = this._onResult.event;\n        this._firstWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerAsyncComputation(), 0));\n        this._secondWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerSyncComputation(), 0));\n        this._loadingMessageScheduler = this._register(new RunOnceScheduler(() => this._triggerLoadingMessage(), 0));\n        this._state = 0 /* HoverOperationState.Idle */;\n        this._asyncIterable = null;\n        this._asyncIterableDone = false;\n        this._result = [];\n    }\n    dispose() {\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        super.dispose();\n    }\n    get _hoverTime() {\n        return this._editor.getOption(60 /* EditorOption.hover */).delay;\n    }\n    get _firstWaitTime() {\n        return this._hoverTime / 2;\n    }\n    get _secondWaitTime() {\n        return this._hoverTime - this._firstWaitTime;\n    }\n    get _loadingMessageTime() {\n        return 3 * this._hoverTime;\n    }\n    _setState(state, fireResult = true) {\n        this._state = state;\n        if (fireResult) {\n            this._fireResult();\n        }\n    }\n    _triggerAsyncComputation() {\n        this._setState(2 /* HoverOperationState.SecondWait */);\n        this._secondWaitScheduler.schedule(this._secondWaitTime);\n        if (this._computer.computeAsync) {\n            this._asyncIterableDone = false;\n            this._asyncIterable = createCancelableAsyncIterable(token => this._computer.computeAsync(token));\n            (async () => {\n                try {\n                    for await (const item of this._asyncIterable) {\n                        if (item) {\n                            this._result.push(item);\n                            this._fireResult();\n                        }\n                    }\n                    this._asyncIterableDone = true;\n                    if (this._state === 3 /* HoverOperationState.WaitingForAsync */ || this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */) {\n                        this._setState(0 /* HoverOperationState.Idle */);\n                    }\n                }\n                catch (e) {\n                    onUnexpectedError(e);\n                }\n            })();\n        }\n        else {\n            this._asyncIterableDone = true;\n        }\n    }\n    _triggerSyncComputation() {\n        if (this._computer.computeSync) {\n            this._result = this._result.concat(this._computer.computeSync());\n        }\n        this._setState(this._asyncIterableDone ? 0 /* HoverOperationState.Idle */ : 3 /* HoverOperationState.WaitingForAsync */);\n    }\n    _triggerLoadingMessage() {\n        if (this._state === 3 /* HoverOperationState.WaitingForAsync */) {\n            this._setState(4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        }\n    }\n    _fireResult() {\n        if (this._state === 1 /* HoverOperationState.FirstWait */ || this._state === 2 /* HoverOperationState.SecondWait */) {\n            // Do not send out results before the hover time\n            return;\n        }\n        const isComplete = (this._state === 0 /* HoverOperationState.Idle */);\n        const hasLoadingMessage = (this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        this._onResult.fire(new HoverResult(this._result.slice(0), isComplete, hasLoadingMessage));\n    }\n    start(mode) {\n        if (mode === 0 /* HoverStartMode.Delayed */) {\n            if (this._state === 0 /* HoverOperationState.Idle */) {\n                this._setState(1 /* HoverOperationState.FirstWait */);\n                this._firstWaitScheduler.schedule(this._firstWaitTime);\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime);\n            }\n        }\n        else {\n            switch (this._state) {\n                case 0 /* HoverOperationState.Idle */:\n                    this._triggerAsyncComputation();\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n                case 2 /* HoverOperationState.SecondWait */:\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n            }\n        }\n    }\n    cancel() {\n        this._firstWaitScheduler.cancel();\n        this._secondWaitScheduler.cancel();\n        this._loadingMessageScheduler.cancel();\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        this._result = [];\n        this._setState(0 /* HoverOperationState.Idle */, false);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class HoverRangeAnchor {\n    constructor(priority, range, initialMousePosX, initialMousePosY) {\n        this.priority = priority;\n        this.range = range;\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.type = 1 /* HoverAnchorType.Range */;\n    }\n    equals(other) {\n        return (other.type === 1 /* HoverAnchorType.Range */ && this.range.equalsRange(other.range));\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 1 /* HoverAnchorType.Range */ && showAtPosition.lineNumber === this.range.startLineNumber);\n    }\n}\nexport class HoverForeignElementAnchor {\n    constructor(priority, owner, range, initialMousePosX, initialMousePosY, supportsMarkerHover) {\n        this.priority = priority;\n        this.owner = owner;\n        this.range = range;\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.supportsMarkerHover = supportsMarkerHover;\n        this.type = 2 /* HoverAnchorType.ForeignElement */;\n    }\n    equals(other) {\n        return (other.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === other.owner);\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === lastAnchor.owner);\n    }\n}\nexport const HoverParticipantRegistry = (new class HoverParticipantRegistry {\n    constructor() {\n        this._participants = [];\n    }\n    register(ctor) {\n        this._participants.push(ctor);\n    }\n    getAll() {\n        return this._participants;\n    }\n}());\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Dimension } from '../../dom.js';\nimport { OrthogonalEdge, Sash } from '../sash/sash.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { DisposableStore } from '../../../common/lifecycle.js';\nexport class ResizableHTMLElement {\n    constructor() {\n        this._onDidWillResize = new Emitter();\n        this.onDidWillResize = this._onDidWillResize.event;\n        this._onDidResize = new Emitter();\n        this.onDidResize = this._onDidResize.event;\n        this._sashListener = new DisposableStore();\n        this._size = new Dimension(0, 0);\n        this._minSize = new Dimension(0, 0);\n        this._maxSize = new Dimension(Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER);\n        this.domNode = document.createElement('div');\n        this._eastSash = new Sash(this.domNode, { getVerticalSashLeft: () => this._size.width }, { orientation: 0 /* Orientation.VERTICAL */ });\n        this._westSash = new Sash(this.domNode, { getVerticalSashLeft: () => 0 }, { orientation: 0 /* Orientation.VERTICAL */ });\n        this._northSash = new Sash(this.domNode, { getHorizontalSashTop: () => 0 }, { orientation: 1 /* Orientation.HORIZONTAL */, orthogonalEdge: OrthogonalEdge.North });\n        this._southSash = new Sash(this.domNode, { getHorizontalSashTop: () => this._size.height }, { orientation: 1 /* Orientation.HORIZONTAL */, orthogonalEdge: OrthogonalEdge.South });\n        this._northSash.orthogonalStartSash = this._westSash;\n        this._northSash.orthogonalEndSash = this._eastSash;\n        this._southSash.orthogonalStartSash = this._westSash;\n        this._southSash.orthogonalEndSash = this._eastSash;\n        let currentSize;\n        let deltaY = 0;\n        let deltaX = 0;\n        this._sashListener.add(Event.any(this._northSash.onDidStart, this._eastSash.onDidStart, this._southSash.onDidStart, this._westSash.onDidStart)(() => {\n            if (currentSize === undefined) {\n                this._onDidWillResize.fire();\n                currentSize = this._size;\n                deltaY = 0;\n                deltaX = 0;\n            }\n        }));\n        this._sashListener.add(Event.any(this._northSash.onDidEnd, this._eastSash.onDidEnd, this._southSash.onDidEnd, this._westSash.onDidEnd)(() => {\n            if (currentSize !== undefined) {\n                currentSize = undefined;\n                deltaY = 0;\n                deltaX = 0;\n                this._onDidResize.fire({ dimension: this._size, done: true });\n            }\n        }));\n        this._sashListener.add(this._eastSash.onDidChange(e => {\n            if (currentSize) {\n                deltaX = e.currentX - e.startX;\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, east: true });\n            }\n        }));\n        this._sashListener.add(this._westSash.onDidChange(e => {\n            if (currentSize) {\n                deltaX = -(e.currentX - e.startX);\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, west: true });\n            }\n        }));\n        this._sashListener.add(this._northSash.onDidChange(e => {\n            if (currentSize) {\n                deltaY = -(e.currentY - e.startY);\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, north: true });\n            }\n        }));\n        this._sashListener.add(this._southSash.onDidChange(e => {\n            if (currentSize) {\n                deltaY = e.currentY - e.startY;\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\n                this._onDidResize.fire({ dimension: this._size, done: false, south: true });\n            }\n        }));\n        this._sashListener.add(Event.any(this._eastSash.onDidReset, this._westSash.onDidReset)(e => {\n            if (this._preferredSize) {\n                this.layout(this._size.height, this._preferredSize.width);\n                this._onDidResize.fire({ dimension: this._size, done: true });\n            }\n        }));\n        this._sashListener.add(Event.any(this._northSash.onDidReset, this._southSash.onDidReset)(e => {\n            if (this._preferredSize) {\n                this.layout(this._preferredSize.height, this._size.width);\n                this._onDidResize.fire({ dimension: this._size, done: true });\n            }\n        }));\n    }\n    dispose() {\n        this._northSash.dispose();\n        this._southSash.dispose();\n        this._eastSash.dispose();\n        this._westSash.dispose();\n        this._sashListener.dispose();\n        this._onDidResize.dispose();\n        this._onDidWillResize.dispose();\n        this.domNode.remove();\n    }\n    enableSashes(north, east, south, west) {\n        this._northSash.state = north ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n        this._eastSash.state = east ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n        this._southSash.state = south ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n        this._westSash.state = west ? 3 /* SashState.Enabled */ : 0 /* SashState.Disabled */;\n    }\n    layout(height = this.size.height, width = this.size.width) {\n        const { height: minHeight, width: minWidth } = this._minSize;\n        const { height: maxHeight, width: maxWidth } = this._maxSize;\n        height = Math.max(minHeight, Math.min(maxHeight, height));\n        width = Math.max(minWidth, Math.min(maxWidth, width));\n        const newSize = new Dimension(width, height);\n        if (!Dimension.equals(newSize, this._size)) {\n            this.domNode.style.height = height + 'px';\n            this.domNode.style.width = width + 'px';\n            this._size = newSize;\n            this._northSash.layout();\n            this._eastSash.layout();\n            this._southSash.layout();\n            this._westSash.layout();\n        }\n    }\n    clearSashHoverState() {\n        this._eastSash.clearSashHoverState();\n        this._westSash.clearSashHoverState();\n        this._northSash.clearSashHoverState();\n        this._southSash.clearSashHoverState();\n    }\n    get size() {\n        return this._size;\n    }\n    set maxSize(value) {\n        this._maxSize = value;\n    }\n    get maxSize() {\n        return this._maxSize;\n    }\n    set minSize(value) {\n        this._minSize = value;\n    }\n    get minSize() {\n        return this._minSize;\n    }\n    set preferredSize(value) {\n        this._preferredSize = value;\n    }\n    get preferredSize() {\n        return this._preferredSize;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport * as dom from '../../../../base/browser/dom.js';\nconst TOP_HEIGHT = 30;\nconst BOTTOM_HEIGHT = 24;\nexport class ResizableContentWidget extends Disposable {\n    constructor(_editor, minimumSize = new dom.Dimension(10, 10)) {\n        super();\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._resizableNode = this._register(new ResizableHTMLElement());\n        this._contentPosition = null;\n        this._isResizing = false;\n        this._resizableNode.domNode.style.position = 'absolute';\n        this._resizableNode.minSize = dom.Dimension.lift(minimumSize);\n        this._resizableNode.layout(minimumSize.height, minimumSize.width);\n        this._resizableNode.enableSashes(true, true, true, true);\n        this._register(this._resizableNode.onDidResize(e => {\n            this._resize(new dom.Dimension(e.dimension.width, e.dimension.height));\n            if (e.done) {\n                this._isResizing = false;\n            }\n        }));\n        this._register(this._resizableNode.onDidWillResize(() => {\n            this._isResizing = true;\n        }));\n    }\n    get isResizing() {\n        return this._isResizing;\n    }\n    getDomNode() {\n        return this._resizableNode.domNode;\n    }\n    getPosition() {\n        return this._contentPosition;\n    }\n    get position() {\n        var _a;\n        return ((_a = this._contentPosition) === null || _a === void 0 ? void 0 : _a.position) ? Position.lift(this._contentPosition.position) : undefined;\n    }\n    _availableVerticalSpaceAbove(position) {\n        const editorDomNode = this._editor.getDomNode();\n        const mouseBox = this._editor.getScrolledVisiblePosition(position);\n        if (!editorDomNode || !mouseBox) {\n            return;\n        }\n        const editorBox = dom.getDomNodePagePosition(editorDomNode);\n        return editorBox.top + mouseBox.top - TOP_HEIGHT;\n    }\n    _availableVerticalSpaceBelow(position) {\n        const editorDomNode = this._editor.getDomNode();\n        const mouseBox = this._editor.getScrolledVisiblePosition(position);\n        if (!editorDomNode || !mouseBox) {\n            return;\n        }\n        const editorBox = dom.getDomNodePagePosition(editorDomNode);\n        const bodyBox = dom.getClientArea(editorDomNode.ownerDocument.body);\n        const mouseBottom = editorBox.top + mouseBox.top + mouseBox.height;\n        return bodyBox.height - mouseBottom - BOTTOM_HEIGHT;\n    }\n    _findPositionPreference(widgetHeight, showAtPosition) {\n        var _a, _b;\n        const maxHeightBelow = Math.min((_a = this._availableVerticalSpaceBelow(showAtPosition)) !== null && _a !== void 0 ? _a : Infinity, widgetHeight);\n        const maxHeightAbove = Math.min((_b = this._availableVerticalSpaceAbove(showAtPosition)) !== null && _b !== void 0 ? _b : Infinity, widgetHeight);\n        const maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow), widgetHeight);\n        const height = Math.min(widgetHeight, maxHeight);\n        let renderingAbove;\n        if (this._editor.getOption(60 /* EditorOption.hover */).above) {\n            renderingAbove = height <= maxHeightAbove ? 1 /* ContentWidgetPositionPreference.ABOVE */ : 2 /* ContentWidgetPositionPreference.BELOW */;\n        }\n        else {\n            renderingAbove = height <= maxHeightBelow ? 2 /* ContentWidgetPositionPreference.BELOW */ : 1 /* ContentWidgetPositionPreference.ABOVE */;\n        }\n        if (renderingAbove === 1 /* ContentWidgetPositionPreference.ABOVE */) {\n            this._resizableNode.enableSashes(true, true, false, false);\n        }\n        else {\n            this._resizableNode.enableSashes(false, true, true, false);\n        }\n        return renderingAbove;\n    }\n    _resize(dimension) {\n        this._resizableNode.layout(dimension.height, dimension.width);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { isEmptyMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { GlyphMarginLane } from '../../../common/model.js';\nconst $ = dom.$;\nexport class MarginHoverWidget extends Disposable {\n    constructor(editor, languageService, openerService) {\n        super();\n        this._renderDisposeables = this._register(new DisposableStore());\n        this._editor = editor;\n        this._isVisible = false;\n        this._messages = [];\n        this._hover = this._register(new HoverWidget());\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        this._markdownRenderer = this._register(new MarkdownRenderer({ editor: this._editor }, languageService, openerService));\n        this._computer = new MarginHoverComputer(this._editor);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            this._withResult(result.value);\n        }));\n        this._register(this._editor.onDidChangeModelDecorations(() => this._onModelDecorationsChanged()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._editor.addOverlayWidget(this);\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    getId() {\n        return MarginHoverWidget.ID;\n    }\n    getDomNode() {\n        return this._hover.containerDomNode;\n    }\n    getPosition() {\n        return null;\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _onModelDecorationsChanged() {\n        if (this._isVisible) {\n            // The decorations have changed and the hover is visible,\n            // we need to recompute the displayed text\n            this._hoverOperation.cancel();\n            this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n        }\n    }\n    startShowingAt(lineNumber, laneOrLine) {\n        if (this._computer.lineNumber === lineNumber && this._computer.lane === laneOrLine) {\n            // We have to show the widget at the exact same line number as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this.hide();\n        this._computer.lineNumber = lineNumber;\n        this._computer.lane = laneOrLine;\n        this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n    }\n    hide() {\n        this._computer.lineNumber = -1;\n        this._hoverOperation.cancel();\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n    }\n    _withResult(result) {\n        this._messages = result;\n        if (this._messages.length > 0) {\n            this._renderMessages(this._computer.lineNumber, this._messages);\n        }\n        else {\n            this.hide();\n        }\n    }\n    _renderMessages(lineNumber, messages) {\n        this._renderDisposeables.clear();\n        const fragment = document.createDocumentFragment();\n        for (const msg of messages) {\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderedContents = this._renderDisposeables.add(this._markdownRenderer.render(msg.value));\n            hoverContentsElement.appendChild(renderedContents.element);\n            fragment.appendChild(markdownHoverElement);\n        }\n        this._updateContents(fragment);\n        this._showAt(lineNumber);\n    }\n    _updateContents(node) {\n        this._hover.contentsDomNode.textContent = '';\n        this._hover.contentsDomNode.appendChild(node);\n        this._updateFont();\n    }\n    _showAt(lineNumber) {\n        if (!this._isVisible) {\n            this._isVisible = true;\n            this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        }\n        const editorLayout = this._editor.getLayoutInfo();\n        const topForLineNumber = this._editor.getTopForLineNumber(lineNumber);\n        const editorScrollTop = this._editor.getScrollTop();\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const nodeHeight = this._hover.containerDomNode.clientHeight;\n        const top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\n        const left = editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth + (this._computer.lane === 'lineNo' ? editorLayout.lineNumbersWidth : 0);\n        this._hover.containerDomNode.style.left = `${left}px`;\n        this._hover.containerDomNode.style.top = `${Math.max(Math.round(top), 0)}px`;\n    }\n}\nMarginHoverWidget.ID = 'editor.contrib.modesGlyphHoverWidget';\nclass MarginHoverComputer {\n    get lineNumber() {\n        return this._lineNumber;\n    }\n    set lineNumber(value) {\n        this._lineNumber = value;\n    }\n    get lane() {\n        return this._laneOrLine;\n    }\n    set lane(value) {\n        this._laneOrLine = value;\n    }\n    constructor(_editor) {\n        this._editor = _editor;\n        this._lineNumber = -1;\n        this._laneOrLine = GlyphMarginLane.Center;\n    }\n    computeSync() {\n        var _a, _b;\n        const toHoverMessage = (contents) => {\n            return {\n                value: contents\n            };\n        };\n        const lineDecorations = this._editor.getLineDecorations(this._lineNumber);\n        const result = [];\n        const isLineHover = this._laneOrLine === 'lineNo';\n        if (!lineDecorations) {\n            return result;\n        }\n        for (const d of lineDecorations) {\n            const lane = (_b = (_a = d.options.glyphMargin) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : GlyphMarginLane.Center;\n            if (!isLineHover && lane !== this._laneOrLine) {\n                continue;\n            }\n            const hoverMessage = isLineHover ? d.options.lineNumberHoverMessage : d.options.glyphMarginHoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            result.push(...asArray(hoverMessage).map(toHoverMessage));\n        }\n        return result;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { getHover } from './getHover.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nconst $ = dom.$;\nexport class MarkdownHover {\n    constructor(owner, range, contents, isBeforeContent, ordinal) {\n        this.owner = owner;\n        this.range = range;\n        this.contents = contents;\n        this.isBeforeContent = isBeforeContent;\n        this.ordinal = ordinal;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\n    constructor(_editor, _languageService, _openerService, _configurationService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this.hoverOrdinal = 3;\n    }\n    createLoadingMessage(anchor) {\n        return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))], false, 2000);\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        let index = 1000;\n        const lineLength = model.getLineLength(lineNumber);\n        const languageId = model.getLanguageIdAtPosition(anchor.range.startLineNumber, anchor.range.startColumn);\n        const stopRenderingLineAfter = this._editor.getOption(117 /* EditorOption.stopRenderingLineAfter */);\n        const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n            overrideIdentifier: languageId\n        });\n        let stopRenderingMessage = false;\n        if (stopRenderingLineAfter >= 0 && lineLength > stopRenderingLineAfter && anchor.range.startColumn >= stopRenderingLineAfter) {\n            stopRenderingMessage = true;\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('stopped rendering', \"Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.\")\n                }], false, index++));\n        }\n        if (!stopRenderingMessage && typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\n                }], false, index++));\n        }\n        let isBeforeContent = false;\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const hoverMessage = d.options.hoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            if (d.options.beforeContentClassName) {\n                isBeforeContent = true;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkdownHover(this, range, asArray(hoverMessage), isBeforeContent, index++));\n        }\n        return result;\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const model = this._editor.getModel();\n        if (!this._languageFeaturesService.hoverProvider.has(model)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const position = new Position(anchor.range.startLineNumber, anchor.range.startColumn);\n        return getHover(this._languageFeaturesService.hoverProvider, model, position, token)\n            .filter(item => !isEmptyMarkdownString(item.hover.contents))\n            .map(item => {\n            const rng = item.hover.range ? Range.lift(item.hover.range) : anchor.range;\n            return new MarkdownHover(this, rng, item.hover.contents, false, item.ordinal);\n        });\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderMarkdownHovers(context, hoverParts, this._editor, this._languageService, this._openerService);\n    }\n};\nMarkdownHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeaturesService)\n], MarkdownHoverParticipant);\nexport { MarkdownHoverParticipant };\nexport function renderMarkdownHovers(context, hoverParts, editor, languageService, openerService) {\n    // Sort hover parts to keep them stable since they might come in async, out-of-order\n    hoverParts.sort((a, b) => a.ordinal - b.ordinal);\n    const disposables = new DisposableStore();\n    for (const hoverPart of hoverParts) {\n        for (const contents of hoverPart.contents) {\n            if (isEmptyMarkdownString(contents)) {\n                continue;\n            }\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderer = disposables.add(new MarkdownRenderer({ editor }, languageService, openerService));\n            disposables.add(renderer.onDidRenderAsync(() => {\n                hoverContentsElement.className = 'hover-contents code-hover-contents';\n                context.onContentsChanged();\n            }));\n            const renderedContents = disposables.add(renderer.render(contents));\n            hoverContentsElement.appendChild(renderedContents.element);\n            context.fragment.appendChild(markdownHoverElement);\n        }\n    }\n    return disposables;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class HoverProviderResult {\n    constructor(provider, hover, ordinal) {\n        this.provider = provider;\n        this.hover = hover;\n        this.ordinal = ordinal;\n    }\n}\nasync function executeProvider(provider, ordinal, model, position, token) {\n    try {\n        const result = await Promise.resolve(provider.provideHover(model, position, token));\n        if (result && isValid(result)) {\n            return new HoverProviderResult(provider, result, ordinal);\n        }\n    }\n    catch (err) {\n        onUnexpectedExternalError(err);\n    }\n    return undefined;\n}\nexport function getHover(registry, model, position, token) {\n    const providers = registry.ordered(model);\n    const promises = providers.map((provider, index) => executeProvider(provider, index, model, position, token));\n    return AsyncIterableObject.fromPromises(promises).coalesce();\n}\nexport function getHoverPromise(registry, model, position, token) {\n    return getHover(registry, model, position, token).map(item => item.hover).toPromise();\n}\nregisterModelAndPositionCommand('_executeHoverProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    return getHoverPromise(languageFeaturesService.hoverProvider, model, position, CancellationToken.None);\n});\nfunction isValid(result) {\n    const hasRange = (typeof result.range !== 'undefined');\n    const hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\n    return hasRange && hasHtmlContent;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, disposableTimeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IMarkerDecorationsService } from '../../../common/services/markerDecorations.js';\nimport { getCodeActions, quickFixCommandId } from '../../codeAction/browser/codeAction.js';\nimport { CodeActionController } from '../../codeAction/browser/codeActionController.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../../codeAction/common/types.js';\nimport { MarkerController, NextMarkerAction } from '../../gotoError/browser/gotoError.js';\nimport * as nls from '../../../../nls.js';\nimport { IMarkerData, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nconst $ = dom.$;\nexport class MarkerHover {\n    constructor(owner, range, marker) {\n        this.owner = owner;\n        this.range = range;\n        this.marker = marker;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nconst markerCodeActionTrigger = {\n    type: 1 /* CodeActionTriggerType.Invoke */,\n    filter: { include: CodeActionKind.QuickFix },\n    triggerAction: CodeActionTriggerSource.QuickFixHover\n};\nlet MarkerHoverParticipant = class MarkerHoverParticipant {\n    constructor(_editor, _markerDecorationsService, _openerService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._markerDecorationsService = _markerDecorationsService;\n        this._openerService = _openerService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this.hoverOrdinal = 1;\n        this.recentMarkerCodeActionsInfo = undefined;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const marker = this._markerDecorationsService.getMarker(model.uri, d);\n            if (!marker) {\n                continue;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkerHover(this, range, marker));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        if (!hoverParts.length) {\n            return Disposable.None;\n        }\n        const disposables = new DisposableStore();\n        hoverParts.forEach(msg => context.fragment.appendChild(this.renderMarkerHover(msg, disposables)));\n        const markerHoverForStatusbar = hoverParts.length === 1 ? hoverParts[0] : hoverParts.sort((a, b) => MarkerSeverity.compare(a.marker.severity, b.marker.severity))[0];\n        this.renderMarkerStatusbar(context, markerHoverForStatusbar, disposables);\n        return disposables;\n    }\n    renderMarkerHover(markerHover, disposables) {\n        const hoverElement = $('div.hover-row');\n        const markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\n        const { source, message, code, relatedInformation } = markerHover.marker;\n        this._editor.applyFontInfo(markerElement);\n        const messageElement = dom.append(markerElement, $('span'));\n        messageElement.style.whiteSpace = 'pre-wrap';\n        messageElement.innerText = message;\n        if (source || code) {\n            // Code has link\n            if (code && typeof code !== 'string') {\n                const sourceAndCodeElement = $('span');\n                if (source) {\n                    const sourceElement = dom.append(sourceAndCodeElement, $('span'));\n                    sourceElement.innerText = source;\n                }\n                const codeLink = dom.append(sourceAndCodeElement, $('a.code-link'));\n                codeLink.setAttribute('href', code.target.toString());\n                disposables.add(dom.addDisposableListener(codeLink, 'click', (e) => {\n                    this._openerService.open(code.target, { allowCommands: true });\n                    e.preventDefault();\n                    e.stopPropagation();\n                }));\n                const codeElement = dom.append(codeLink, $('span'));\n                codeElement.innerText = code.value;\n                const detailsElement = dom.append(markerElement, sourceAndCodeElement);\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n            }\n            else {\n                const detailsElement = dom.append(markerElement, $('span'));\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n                detailsElement.innerText = source && code ? `${source}(${code})` : source ? source : `(${code})`;\n            }\n        }\n        if (isNonEmptyArray(relatedInformation)) {\n            for (const { message, resource, startLineNumber, startColumn } of relatedInformation) {\n                const relatedInfoContainer = dom.append(markerElement, $('div'));\n                relatedInfoContainer.style.marginTop = '8px';\n                const a = dom.append(relatedInfoContainer, $('a'));\n                a.innerText = `${basename(resource)}(${startLineNumber}, ${startColumn}): `;\n                a.style.cursor = 'pointer';\n                disposables.add(dom.addDisposableListener(a, 'click', (e) => {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    if (this._openerService) {\n                        this._openerService.open(resource, {\n                            fromUserGesture: true,\n                            editorOptions: { selection: { startLineNumber, startColumn } }\n                        }).catch(onUnexpectedError);\n                    }\n                }));\n                const messageElement = dom.append(relatedInfoContainer, $('span'));\n                messageElement.innerText = message;\n                this._editor.applyFontInfo(messageElement);\n            }\n        }\n        return hoverElement;\n    }\n    renderMarkerStatusbar(context, markerHover, disposables) {\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\n            const markerController = MarkerController.get(this._editor);\n            if (markerController) {\n                context.statusBar.addAction({\n                    label: nls.localize('view problem', \"View Problem\"),\n                    commandId: NextMarkerAction.ID,\n                    run: () => {\n                        context.hide();\n                        markerController.showAtMarker(markerHover.marker);\n                        this._editor.focus();\n                    }\n                });\n            }\n        }\n        if (!this._editor.getOption(91 /* EditorOption.readOnly */)) {\n            const quickfixPlaceholderElement = context.statusBar.append($('div'));\n            if (this.recentMarkerCodeActionsInfo) {\n                if (IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker) === IMarkerData.makeKey(markerHover.marker)) {\n                    if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                        quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    }\n                }\n                else {\n                    this.recentMarkerCodeActionsInfo = undefined;\n                }\n            }\n            const updatePlaceholderDisposable = this.recentMarkerCodeActionsInfo && !this.recentMarkerCodeActionsInfo.hasCodeActions ? Disposable.None : disposableTimeout(() => quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\"), 200, disposables);\n            if (!quickfixPlaceholderElement.textContent) {\n                // Have some content in here to avoid flickering\n                quickfixPlaceholderElement.textContent = String.fromCharCode(0xA0); // &nbsp;\n            }\n            const codeActionsPromise = this.getCodeActions(markerHover.marker);\n            disposables.add(toDisposable(() => codeActionsPromise.cancel()));\n            codeActionsPromise.then(actions => {\n                updatePlaceholderDisposable.dispose();\n                this.recentMarkerCodeActionsInfo = { marker: markerHover.marker, hasCodeActions: actions.validActions.length > 0 };\n                if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                    actions.dispose();\n                    quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    return;\n                }\n                quickfixPlaceholderElement.style.display = 'none';\n                let showing = false;\n                disposables.add(toDisposable(() => {\n                    if (!showing) {\n                        actions.dispose();\n                    }\n                }));\n                context.statusBar.addAction({\n                    label: nls.localize('quick fixes', \"Quick Fix...\"),\n                    commandId: quickFixCommandId,\n                    run: (target) => {\n                        showing = true;\n                        const controller = CodeActionController.get(this._editor);\n                        const elementPosition = dom.getDomNodePagePosition(target);\n                        // Hide the hover pre-emptively, otherwise the editor can close the code actions\n                        // context menu as well when using keyboard navigation\n                        context.hide();\n                        controller === null || controller === void 0 ? void 0 : controller.showCodeActions(markerCodeActionTrigger, actions, {\n                            x: elementPosition.left,\n                            y: elementPosition.top,\n                            width: elementPosition.width,\n                            height: elementPosition.height\n                        });\n                    }\n                });\n            }, onUnexpectedError);\n        }\n    }\n    getCodeActions(marker) {\n        return createCancelablePromise(cancellationToken => {\n            return getCodeActions(this._languageFeaturesService.codeActionProvider, this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), markerCodeActionTrigger, Progress.None, cancellationToken);\n        });\n    }\n};\nMarkerHoverParticipant = __decorate([\n    __param(1, IMarkerDecorationsService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageFeaturesService)\n], MarkerHoverParticipant);\nexport { MarkerHoverParticipant };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkerController_1;\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nlet MarkerController = MarkerController_1 = class MarkerController {\n    static get(editor) {\n        return editor.getContribution(MarkerController_1.ID);\n    }\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            var _a, _b, _c;\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    async nagivate(next, multiFile) {\n        var _a, _b;\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n            model.move(next, this._editor.getModel(), this._editor.getPosition());\n            if (!model.selected) {\n                return;\n            }\n            if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                // show in different editor\n                this._cleanUp();\n                const otherEditor = await this._editorService.openCodeEditor({\n                    resource: model.selected.marker.resource,\n                    options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                }, this._editor);\n                if (otherEditor) {\n                    (_a = MarkerController_1.get(otherEditor)) === null || _a === void 0 ? void 0 : _a.close();\n                    (_b = MarkerController_1.get(otherEditor)) === null || _b === void 0 ? void 0 : _b.nagivate(next, multiFile);\n                }\n            }\n            else {\n                // show in this editor\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n};\nMarkerController.ID = 'editor.contrib.markerController';\nMarkerController = MarkerController_1 = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nexport { MarkerController };\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    async run(_accessor, editor) {\n        var _a;\n        if (editor.hasModel()) {\n            (_a = MarkerController.get(editor)) === null || _a === void 0 ? void 0 : _a.nagivate(this._next, this._multiFile);\n        }\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nNextMarkerAction.ID = 'editor.action.marker.next';\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\nclass PrevMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nPrevMarkerAction.ID = 'editor.action.marker.prev';\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, 1 /* InstantiationType.Delayed */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkerNavigationWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/browser/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(67 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nlet MarkerNavigationWidget = MarkerNavigationWidget_1 = class MarkerNavigationWidget extends PeekViewWidget {\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.createMenu(MarkerNavigationWidget_1.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, undefined, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n        menu.dispose();\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\nMarkerNavigationWidget = MarkerNavigationWidget_1 = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\nexport { MarkerNavigationWidget };\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nconst editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nconst editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nconst editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nconst editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nconst editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nconst editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nconst editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: editorBackground, light: editorBackground, hcDark: editorBackground, hcLight: editorBackground }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './media/severityIcon.css';\nimport { Codicon } from '../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport Severity from '../../../base/common/severity.js';\nexport var SeverityIcon;\n(function (SeverityIcon) {\n    function className(severity) {\n        switch (severity) {\n            case Severity.Ignore:\n                return 'severity-ignore ' + ThemeIcon.asClassName(Codicon.info);\n            case Severity.Info:\n                return ThemeIcon.asClassName(Codicon.info);\n            case Severity.Warning:\n                return ThemeIcon.asClassName(Codicon.warning);\n            case Severity.Error:\n                return ThemeIcon.asClassName(Codicon.error);\n            default:\n                return '';\n        }\n    }\n    SeverityIcon.className = className;\n})(SeverityIcon || (SeverityIcon = {}));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineSuggestionHintsContentWidget_1;\nimport { h } from '../../../../base/browser/dom.js';\nimport { ActionViewItem } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { KeybindingLabel, unthemedKeybindingLabelOptions } from '../../../../base/browser/ui/keybindingLabel/keybindingLabel.js';\nimport { Action, Separator } from '../../../../base/common/actions.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, observableFromEvent } from '../../../../base/common/observable.js';\nimport { OS } from '../../../../base/common/platform.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './inlineCompletionsHintsWidget.css';\nimport { Position } from '../../../common/core/position.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { showNextInlineSuggestionActionId, showPreviousInlineSuggestionActionId } from './commandIds.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuEntryActionViewItem, createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { WorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nlet InlineCompletionsHintsWidget = class InlineCompletionsHintsWidget extends Disposable {\n    constructor(editor, model, instantiationService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.instantiationService = instantiationService;\n        this.alwaysShowToolbar = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).showToolbar === 'always');\n        this.sessionPosition = undefined;\n        this.position = derived(this, reader => {\n            var _a, _b, _c;\n            const ghostText = (_a = this.model.read(reader)) === null || _a === void 0 ? void 0 : _a.primaryGhostText.read(reader);\n            if (!this.alwaysShowToolbar.read(reader) || !ghostText || ghostText.parts.length === 0) {\n                this.sessionPosition = undefined;\n                return null;\n            }\n            const firstColumn = ghostText.parts[0].column;\n            if (this.sessionPosition && this.sessionPosition.lineNumber !== ghostText.lineNumber) {\n                this.sessionPosition = undefined;\n            }\n            const position = new Position(ghostText.lineNumber, Math.min(firstColumn, (_c = (_b = this.sessionPosition) === null || _b === void 0 ? void 0 : _b.column) !== null && _c !== void 0 ? _c : Number.MAX_SAFE_INTEGER));\n            this.sessionPosition = position;\n            return position;\n        });\n        this._register(autorunWithStore((reader, store) => {\n            /** @description setup content widget */\n            const model = this.model.read(reader);\n            if (!model || !this.alwaysShowToolbar.read(reader)) {\n                return;\n            }\n            const contentWidget = store.add(this.instantiationService.createInstance(InlineSuggestionHintsContentWidget, this.editor, true, this.position, model.selectedInlineCompletionIndex, model.inlineCompletionsCount, model.selectedInlineCompletion.map(v => /** @description commands */ { var _a; /** @description commands */ return (_a = v === null || v === void 0 ? void 0 : v.inlineCompletion.source.inlineCompletions.commands) !== null && _a !== void 0 ? _a : []; })));\n            editor.addContentWidget(contentWidget);\n            store.add(toDisposable(() => editor.removeContentWidget(contentWidget)));\n            store.add(autorun(reader => {\n                /** @description request explicit */\n                const position = this.position.read(reader);\n                if (!position) {\n                    return;\n                }\n                if (model.lastTriggerKind.read(reader) !== InlineCompletionTriggerKind.Explicit) {\n                    model.triggerExplicitly();\n                }\n            }));\n        }));\n    }\n};\nInlineCompletionsHintsWidget = __decorate([\n    __param(2, IInstantiationService)\n], InlineCompletionsHintsWidget);\nexport { InlineCompletionsHintsWidget };\nconst inlineSuggestionHintsNextIcon = registerIcon('inline-suggestion-hints-next', Codicon.chevronRight, localize('parameterHintsNextIcon', 'Icon for show next parameter hint.'));\nconst inlineSuggestionHintsPreviousIcon = registerIcon('inline-suggestion-hints-previous', Codicon.chevronLeft, localize('parameterHintsPreviousIcon', 'Icon for show previous parameter hint.'));\nlet InlineSuggestionHintsContentWidget = InlineSuggestionHintsContentWidget_1 = class InlineSuggestionHintsContentWidget extends Disposable {\n    static get dropDownVisible() { return this._dropDownVisible; }\n    createCommandAction(commandId, label, iconClassName) {\n        const action = new Action(commandId, label, iconClassName, true, () => this._commandService.executeCommand(commandId));\n        const kb = this.keybindingService.lookupKeybinding(commandId, this._contextKeyService);\n        let tooltip = label;\n        if (kb) {\n            tooltip = localize({ key: 'content', comment: ['A label', 'A keybinding'] }, '{0} ({1})', label, kb.getLabel());\n        }\n        action.tooltip = tooltip;\n        return action;\n    }\n    constructor(editor, withBorder, _position, _currentSuggestionIdx, _suggestionCount, _extraCommands, _commandService, instantiationService, keybindingService, _contextKeyService, _menuService) {\n        super();\n        this.editor = editor;\n        this.withBorder = withBorder;\n        this._position = _position;\n        this._currentSuggestionIdx = _currentSuggestionIdx;\n        this._suggestionCount = _suggestionCount;\n        this._extraCommands = _extraCommands;\n        this._commandService = _commandService;\n        this.keybindingService = keybindingService;\n        this._contextKeyService = _contextKeyService;\n        this._menuService = _menuService;\n        this.id = `InlineSuggestionHintsContentWidget${InlineSuggestionHintsContentWidget_1.id++}`;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this.nodes = h('div.inlineSuggestionsHints', { className: this.withBorder ? '.withBorder' : '' }, [\n            h('div@toolBar'),\n        ]);\n        this.previousAction = this.createCommandAction(showPreviousInlineSuggestionActionId, localize('previous', 'Previous'), ThemeIcon.asClassName(inlineSuggestionHintsPreviousIcon));\n        this.availableSuggestionCountAction = new Action('inlineSuggestionHints.availableSuggestionCount', '', undefined, false);\n        this.nextAction = this.createCommandAction(showNextInlineSuggestionActionId, localize('next', 'Next'), ThemeIcon.asClassName(inlineSuggestionHintsNextIcon));\n        // TODO@hediet: deprecate MenuId.InlineCompletionsActions\n        this.inlineCompletionsActionsMenus = this._register(this._menuService.createMenu(MenuId.InlineCompletionsActions, this._contextKeyService));\n        this.clearAvailableSuggestionCountLabelDebounced = this._register(new RunOnceScheduler(() => {\n            this.availableSuggestionCountAction.label = '';\n        }, 100));\n        this.disableButtonsDebounced = this._register(new RunOnceScheduler(() => {\n            this.previousAction.enabled = this.nextAction.enabled = false;\n        }, 100));\n        this.lastCommands = [];\n        this.toolBar = this._register(instantiationService.createInstance(CustomizedMenuWorkbenchToolBar, this.nodes.toolBar, MenuId.InlineSuggestionToolbar, {\n            menuOptions: { renderShortTitle: true },\n            toolbarOptions: { primaryGroup: g => g.startsWith('primary') },\n            actionViewItemProvider: (action, options) => {\n                if (action instanceof MenuItemAction) {\n                    return instantiationService.createInstance(StatusBarViewItem, action, undefined);\n                }\n                if (action === this.availableSuggestionCountAction) {\n                    const a = new ActionViewItemWithClassName(undefined, action, { label: true, icon: false });\n                    a.setClass('availableSuggestionCount');\n                    return a;\n                }\n                return undefined;\n            },\n            telemetrySource: 'InlineSuggestionToolbar',\n        }));\n        this.toolBar.setPrependedPrimaryActions([\n            this.previousAction,\n            this.availableSuggestionCountAction,\n            this.nextAction,\n        ]);\n        this._register(this.toolBar.onDidChangeDropdownVisibility(e => {\n            InlineSuggestionHintsContentWidget_1._dropDownVisible = e;\n        }));\n        this._register(autorun(reader => {\n            /** @description update position */\n            this._position.read(reader);\n            this.editor.layoutContentWidget(this);\n        }));\n        this._register(autorun(reader => {\n            /** @description counts */\n            const suggestionCount = this._suggestionCount.read(reader);\n            const currentSuggestionIdx = this._currentSuggestionIdx.read(reader);\n            if (suggestionCount !== undefined) {\n                this.clearAvailableSuggestionCountLabelDebounced.cancel();\n                this.availableSuggestionCountAction.label = `${currentSuggestionIdx + 1}/${suggestionCount}`;\n            }\n            else {\n                this.clearAvailableSuggestionCountLabelDebounced.schedule();\n            }\n            if (suggestionCount !== undefined && suggestionCount > 1) {\n                this.disableButtonsDebounced.cancel();\n                this.previousAction.enabled = this.nextAction.enabled = true;\n            }\n            else {\n                this.disableButtonsDebounced.schedule();\n            }\n        }));\n        this._register(autorun(reader => {\n            /** @description extra commands */\n            const extraCommands = this._extraCommands.read(reader);\n            if (equals(this.lastCommands, extraCommands)) {\n                // nothing to update\n                return;\n            }\n            this.lastCommands = extraCommands;\n            const extraActions = extraCommands.map(c => ({\n                class: undefined,\n                id: c.id,\n                enabled: true,\n                tooltip: c.tooltip || '',\n                label: c.title,\n                run: (event) => {\n                    return this._commandService.executeCommand(c.id);\n                },\n            }));\n            for (const [_, group] of this.inlineCompletionsActionsMenus.getActions()) {\n                for (const action of group) {\n                    if (action instanceof MenuItemAction) {\n                        extraActions.push(action);\n                    }\n                }\n            }\n            if (extraActions.length > 0) {\n                extraActions.unshift(new Separator());\n            }\n            this.toolBar.setAdditionalSecondaryActions(extraActions);\n        }));\n    }\n    getId() { return this.id; }\n    getDomNode() {\n        return this.nodes.root;\n    }\n    getPosition() {\n        return {\n            position: this._position.get(),\n            preference: [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */],\n            positionAffinity: 3 /* PositionAffinity.LeftOfInjectedText */,\n        };\n    }\n};\nInlineSuggestionHintsContentWidget._dropDownVisible = false;\nInlineSuggestionHintsContentWidget.id = 0;\nInlineSuggestionHintsContentWidget = InlineSuggestionHintsContentWidget_1 = __decorate([\n    __param(6, ICommandService),\n    __param(7, IInstantiationService),\n    __param(8, IKeybindingService),\n    __param(9, IContextKeyService),\n    __param(10, IMenuService)\n], InlineSuggestionHintsContentWidget);\nexport { InlineSuggestionHintsContentWidget };\nclass ActionViewItemWithClassName extends ActionViewItem {\n    constructor() {\n        super(...arguments);\n        this._className = undefined;\n    }\n    setClass(className) {\n        this._className = className;\n    }\n    render(container) {\n        super.render(container);\n        if (this._className) {\n            container.classList.add(this._className);\n        }\n    }\n    updateTooltip() {\n        // NOOP, disable tooltip\n    }\n}\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            const div = h('div.keybinding').root;\n            const k = new KeybindingLabel(div, OS, { disableTitle: true, ...unthemedKeybindingLabelOptions });\n            k.set(kb);\n            this.label.textContent = this._action.label;\n            this.label.appendChild(div);\n            this.label.classList.add('inlineSuggestionStatusBarItemLabel');\n        }\n    }\n    updateTooltip() {\n        // NOOP, disable tooltip\n    }\n}\nlet CustomizedMenuWorkbenchToolBar = class CustomizedMenuWorkbenchToolBar extends WorkbenchToolBar {\n    constructor(container, menuId, options2, menuService, contextKeyService, contextMenuService, keybindingService, telemetryService) {\n        super(container, { resetMenu: menuId, ...options2 }, menuService, contextKeyService, contextMenuService, keybindingService, telemetryService);\n        this.menuId = menuId;\n        this.options2 = options2;\n        this.menuService = menuService;\n        this.contextKeyService = contextKeyService;\n        this.menu = this._store.add(this.menuService.createMenu(this.menuId, this.contextKeyService, { emitEventsForSubmenuChanges: true }));\n        this.additionalActions = [];\n        this.prependedPrimaryActions = [];\n        this._store.add(this.menu.onDidChange(() => this.updateToolbar()));\n        this.updateToolbar();\n    }\n    updateToolbar() {\n        var _a, _b, _c, _d, _e, _f, _g;\n        const primary = [];\n        const secondary = [];\n        createAndFillInActionBarActions(this.menu, (_a = this.options2) === null || _a === void 0 ? void 0 : _a.menuOptions, { primary, secondary }, (_c = (_b = this.options2) === null || _b === void 0 ? void 0 : _b.toolbarOptions) === null || _c === void 0 ? void 0 : _c.primaryGroup, (_e = (_d = this.options2) === null || _d === void 0 ? void 0 : _d.toolbarOptions) === null || _e === void 0 ? void 0 : _e.shouldInlineSubmenu, (_g = (_f = this.options2) === null || _f === void 0 ? void 0 : _f.toolbarOptions) === null || _g === void 0 ? void 0 : _g.useSeparatorsInPrimaryActions);\n        secondary.push(...this.additionalActions);\n        primary.unshift(...this.prependedPrimaryActions);\n        this.setActions(primary, secondary);\n    }\n    setPrependedPrimaryActions(actions) {\n        if (equals(this.prependedPrimaryActions, actions, (a, b) => a === b)) {\n            return;\n        }\n        this.prependedPrimaryActions = actions;\n        this.updateToolbar();\n    }\n    setAdditionalSecondaryActions(actions) {\n        if (equals(this.additionalActions, actions, (a, b) => a === b)) {\n            return;\n        }\n        this.additionalActions = actions;\n        this.updateToolbar();\n    }\n};\nCustomizedMenuWorkbenchToolBar = __decorate([\n    __param(3, IMenuService),\n    __param(4, IContextKeyService),\n    __param(5, IContextMenuService),\n    __param(6, IKeybindingService),\n    __param(7, ITelemetryService)\n], CustomizedMenuWorkbenchToolBar);\nexport { CustomizedMenuWorkbenchToolBar };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const inlineSuggestCommitId = 'editor.action.inlineSuggest.commit';\nexport const showPreviousInlineSuggestionActionId = 'editor.action.inlineSuggest.showPrevious';\nexport const showNextInlineSuggestionActionId = 'editor.action.inlineSuggest.showNext';\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, EditorAction2, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { StandaloneColorPickerController } from './standaloneColorPickerWidget.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { MenuId, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport './colorPicker.css';\nexport class ShowOrFocusStandaloneColorPicker extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.showOrFocusStandaloneColorPicker',\n            title: {\n                ...localize2('showOrFocusStandaloneColorPicker', \"Show or Focus Standalone Color Picker\"),\n                mnemonicTitle: localize({ key: 'mishowOrFocusStandaloneColorPicker', comment: ['&& denotes a mnemonic'] }, \"&&Show or Focus Standalone Color Picker\"),\n            },\n            precondition: undefined,\n            menu: [\n                { id: MenuId.CommandPalette },\n            ]\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StandaloneColorPickerController.get(editor)) === null || _a === void 0 ? void 0 : _a.showOrFocus();\n    }\n}\nclass HideStandaloneColorPicker extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.hideColorPicker',\n            label: localize({\n                key: 'hideColorPicker',\n                comment: [\n                    'Action that hides the color picker'\n                ]\n            }, \"Hide the Color Picker\"),\n            alias: 'Hide the Color Picker',\n            precondition: EditorContextKeys.standaloneColorPickerVisible.isEqualTo(true),\n            kbOpts: {\n                primary: 9 /* KeyCode.Escape */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        (_a = StandaloneColorPickerController.get(editor)) === null || _a === void 0 ? void 0 : _a.hide();\n    }\n}\nclass InsertColorWithStandaloneColorPicker extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertColorWithStandaloneColorPicker',\n            label: localize({\n                key: 'insertColorWithStandaloneColorPicker',\n                comment: [\n                    'Action that inserts color with standalone color picker'\n                ]\n            }, \"Insert Color with Standalone Color Picker\"),\n            alias: 'Insert Color with Standalone Color Picker',\n            precondition: EditorContextKeys.standaloneColorPickerFocused.isEqualTo(true),\n            kbOpts: {\n                primary: 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        (_a = StandaloneColorPickerController.get(editor)) === null || _a === void 0 ? void 0 : _a.insertColor();\n    }\n}\nregisterEditorAction(HideStandaloneColorPicker);\nregisterEditorAction(InsertColorWithStandaloneColorPicker);\nregisterAction2(ShowOrFocusStandaloneColorPicker);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar StandaloneColorPickerController_1, StandaloneColorPickerWidget_1;\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { StandaloneColorPickerParticipant } from './colorHoverParticipant.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { EditorHoverStatusBar } from '../../hover/browser/contentHover.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { DefaultDocumentColorProvider } from './defaultDocumentColorProvider.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport './colorPicker.css';\nlet StandaloneColorPickerController = StandaloneColorPickerController_1 = class StandaloneColorPickerController extends Disposable {\n    constructor(_editor, _contextKeyService, _modelService, _keybindingService, _instantiationService, _languageFeatureService, _languageConfigurationService) {\n        super();\n        this._editor = _editor;\n        this._modelService = _modelService;\n        this._keybindingService = _keybindingService;\n        this._instantiationService = _instantiationService;\n        this._languageFeatureService = _languageFeatureService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._standaloneColorPickerWidget = null;\n        this._standaloneColorPickerVisible = EditorContextKeys.standaloneColorPickerVisible.bindTo(_contextKeyService);\n        this._standaloneColorPickerFocused = EditorContextKeys.standaloneColorPickerFocused.bindTo(_contextKeyService);\n    }\n    showOrFocus() {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._standaloneColorPickerVisible.get()) {\n            this._standaloneColorPickerWidget = new StandaloneColorPickerWidget(this._editor, this._standaloneColorPickerVisible, this._standaloneColorPickerFocused, this._instantiationService, this._modelService, this._keybindingService, this._languageFeatureService, this._languageConfigurationService);\n        }\n        else if (!this._standaloneColorPickerFocused.get()) {\n            (_a = this._standaloneColorPickerWidget) === null || _a === void 0 ? void 0 : _a.focus();\n        }\n    }\n    hide() {\n        var _a;\n        this._standaloneColorPickerFocused.set(false);\n        this._standaloneColorPickerVisible.set(false);\n        (_a = this._standaloneColorPickerWidget) === null || _a === void 0 ? void 0 : _a.hide();\n        this._editor.focus();\n    }\n    insertColor() {\n        var _a;\n        (_a = this._standaloneColorPickerWidget) === null || _a === void 0 ? void 0 : _a.updateEditor();\n        this.hide();\n    }\n    static get(editor) {\n        return editor.getContribution(StandaloneColorPickerController_1.ID);\n    }\n};\nStandaloneColorPickerController.ID = 'editor.contrib.standaloneColorPickerController';\nStandaloneColorPickerController = StandaloneColorPickerController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IModelService),\n    __param(3, IKeybindingService),\n    __param(4, IInstantiationService),\n    __param(5, ILanguageFeaturesService),\n    __param(6, ILanguageConfigurationService)\n], StandaloneColorPickerController);\nexport { StandaloneColorPickerController };\nregisterEditorContribution(StandaloneColorPickerController.ID, StandaloneColorPickerController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nconst PADDING = 8;\nconst CLOSE_BUTTON_WIDTH = 22;\nlet StandaloneColorPickerWidget = StandaloneColorPickerWidget_1 = class StandaloneColorPickerWidget extends Disposable {\n    constructor(_editor, _standaloneColorPickerVisible, _standaloneColorPickerFocused, _instantiationService, _modelService, _keybindingService, _languageFeaturesService, _languageConfigurationService) {\n        var _a;\n        super();\n        this._editor = _editor;\n        this._standaloneColorPickerVisible = _standaloneColorPickerVisible;\n        this._standaloneColorPickerFocused = _standaloneColorPickerFocused;\n        this._modelService = _modelService;\n        this._keybindingService = _keybindingService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this.allowEditorOverflow = true;\n        this._position = undefined;\n        this._body = document.createElement('div');\n        this._colorHover = null;\n        this._selectionSetInEditor = false;\n        this._onResult = this._register(new Emitter());\n        this.onResult = this._onResult.event;\n        this._standaloneColorPickerVisible.set(true);\n        this._standaloneColorPickerParticipant = _instantiationService.createInstance(StandaloneColorPickerParticipant, this._editor);\n        this._position = (_a = this._editor._getViewModel()) === null || _a === void 0 ? void 0 : _a.getPrimaryCursorState().modelState.position;\n        const editorSelection = this._editor.getSelection();\n        const selection = editorSelection ?\n            {\n                startLineNumber: editorSelection.startLineNumber,\n                startColumn: editorSelection.startColumn,\n                endLineNumber: editorSelection.endLineNumber,\n                endColumn: editorSelection.endColumn\n            } : { startLineNumber: 0, endLineNumber: 0, endColumn: 0, startColumn: 0 };\n        const focusTracker = this._register(dom.trackFocus(this._body));\n        this._register(focusTracker.onDidBlur(_ => {\n            this.hide();\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        // When the cursor position changes, hide the color picker\n        this._register(this._editor.onDidChangeCursorPosition(() => {\n            // Do not hide the color picker when the cursor changes position due to the keybindings\n            if (!this._selectionSetInEditor) {\n                this.hide();\n            }\n            else {\n                this._selectionSetInEditor = false;\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => {\n            var _a;\n            const classList = (_a = e.target.element) === null || _a === void 0 ? void 0 : _a.classList;\n            if (classList && classList.contains('colorpicker-color-decoration')) {\n                this.hide();\n            }\n        }));\n        this._register(this.onResult((result) => {\n            this._render(result.value, result.foundInEditor);\n        }));\n        this._start(selection);\n        this._body.style.zIndex = '50';\n        this._editor.addContentWidget(this);\n    }\n    updateEditor() {\n        if (this._colorHover) {\n            this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover);\n        }\n    }\n    getId() {\n        return StandaloneColorPickerWidget_1.ID;\n    }\n    getDomNode() {\n        return this._body;\n    }\n    getPosition() {\n        if (!this._position) {\n            return null;\n        }\n        const positionPreference = this._editor.getOption(60 /* EditorOption.hover */).above;\n        return {\n            position: this._position,\n            secondaryPosition: this._position,\n            preference: positionPreference ? [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */] : [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */],\n            positionAffinity: 2 /* PositionAffinity.None */\n        };\n    }\n    hide() {\n        this.dispose();\n        this._standaloneColorPickerVisible.set(false);\n        this._standaloneColorPickerFocused.set(false);\n        this._editor.removeContentWidget(this);\n        this._editor.focus();\n    }\n    focus() {\n        this._standaloneColorPickerFocused.set(true);\n        this._body.focus();\n    }\n    async _start(selection) {\n        const computeAsyncResult = await this._computeAsync(selection);\n        if (!computeAsyncResult) {\n            return;\n        }\n        this._onResult.fire(new StandaloneColorPickerResult(computeAsyncResult.result, computeAsyncResult.foundInEditor));\n    }\n    async _computeAsync(range) {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const colorInfo = {\n            range: range,\n            color: { red: 0, green: 0, blue: 0, alpha: 1 }\n        };\n        const colorHoverResult = await this._standaloneColorPickerParticipant.createColorHover(colorInfo, new DefaultDocumentColorProvider(this._modelService, this._languageConfigurationService), this._languageFeaturesService.colorProvider);\n        if (!colorHoverResult) {\n            return null;\n        }\n        return { result: colorHoverResult.colorHover, foundInEditor: colorHoverResult.foundInEditor };\n    }\n    _render(colorHover, foundInEditor) {\n        const fragment = document.createDocumentFragment();\n        const statusBar = this._register(new EditorHoverStatusBar(this._keybindingService));\n        let colorPickerWidget;\n        const context = {\n            fragment,\n            statusBar,\n            setColorPicker: (widget) => colorPickerWidget = widget,\n            onContentsChanged: () => { },\n            hide: () => this.hide()\n        };\n        this._colorHover = colorHover;\n        this._register(this._standaloneColorPickerParticipant.renderHoverParts(context, [colorHover]));\n        if (colorPickerWidget === undefined) {\n            return;\n        }\n        this._body.classList.add('standalone-colorpicker-body');\n        this._body.style.maxHeight = Math.max(this._editor.getLayoutInfo().height / 4, 250) + 'px';\n        this._body.style.maxWidth = Math.max(this._editor.getLayoutInfo().width * 0.66, 500) + 'px';\n        this._body.tabIndex = 0;\n        this._body.appendChild(fragment);\n        colorPickerWidget.layout();\n        const colorPickerBody = colorPickerWidget.body;\n        const saturationBoxWidth = colorPickerBody.saturationBox.domNode.clientWidth;\n        const widthOfOriginalColorBox = colorPickerBody.domNode.clientWidth - saturationBoxWidth - CLOSE_BUTTON_WIDTH - PADDING;\n        const enterButton = colorPickerWidget.body.enterButton;\n        enterButton === null || enterButton === void 0 ? void 0 : enterButton.onClicked(() => {\n            this.updateEditor();\n            this.hide();\n        });\n        const colorPickerHeader = colorPickerWidget.header;\n        const pickedColorNode = colorPickerHeader.pickedColorNode;\n        pickedColorNode.style.width = saturationBoxWidth + PADDING + 'px';\n        const originalColorNode = colorPickerHeader.originalColorNode;\n        originalColorNode.style.width = widthOfOriginalColorBox + 'px';\n        const closeButton = colorPickerWidget.header.closeButton;\n        closeButton === null || closeButton === void 0 ? void 0 : closeButton.onClicked(() => {\n            this.hide();\n        });\n        // When found in the editor, highlight the selection in the editor\n        if (foundInEditor) {\n            if (enterButton) {\n                enterButton.button.textContent = 'Replace';\n            }\n            this._selectionSetInEditor = true;\n            this._editor.setSelection(colorHover.range);\n        }\n        this._editor.layoutContentWidget(this);\n    }\n};\nStandaloneColorPickerWidget.ID = 'editor.contrib.standaloneColorPickerWidget';\nStandaloneColorPickerWidget = StandaloneColorPickerWidget_1 = __decorate([\n    __param(3, IInstantiationService),\n    __param(4, IModelService),\n    __param(5, IKeybindingService),\n    __param(6, ILanguageFeaturesService),\n    __param(7, ILanguageConfigurationService)\n], StandaloneColorPickerWidget);\nexport { StandaloneColorPickerWidget };\nclass StandaloneColorPickerResult {\n    // The color picker result consists of: an array of color results and a boolean indicating if the color was found in the editor\n    constructor(value, foundInEditor) {\n        this.value = value;\n        this.foundInEditor = foundInEditor;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { BlockCommentCommand } from './blockCommentCommand.js';\nimport { LineCommentCommand } from './lineCommentCommand.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nclass CommentLineAction extends EditorAction {\n    constructor(type, opts) {\n        super(opts);\n        this._type = type;\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const commands = [];\n        const modelOptions = model.getOptions();\n        const commentsOptions = editor.getOption(23 /* EditorOption.comments */);\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignoreFirstLine: false }));\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        // Remove selections that would result in copying the same line\n        let prev = selections[0];\n        for (let i = 1; i < selections.length; i++) {\n            const curr = selections[i];\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\n                // these two selections would copy the same line\n                if (prev.index < curr.index) {\n                    // prev wins\n                    curr.ignoreFirstLine = true;\n                }\n                else {\n                    // curr wins\n                    prev.ignoreFirstLine = true;\n                    prev = curr;\n                }\n            }\n        }\n        for (const selection of selections) {\n            commands.push(new LineCommentCommand(languageConfigurationService, selection.selection, modelOptions.tabSize, this._type, commentsOptions.insertSpace, commentsOptions.ignoreEmptyLines, selection.ignoreFirstLine));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass ToggleCommentLineAction extends CommentLineAction {\n    constructor() {\n        super(0 /* Type.Toggle */, {\n            id: 'editor.action.commentLine',\n            label: nls.localize('comment.line', \"Toggle Line Comment\"),\n            alias: 'Toggle Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarEditMenu,\n                group: '5_insert',\n                title: nls.localize({ key: 'miToggleLineComment', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Line Comment\"),\n                order: 1\n            }\n        });\n    }\n}\nclass AddLineCommentAction extends CommentLineAction {\n    constructor() {\n        super(1 /* Type.ForceAdd */, {\n            id: 'editor.action.addCommentLine',\n            label: nls.localize('comment.line.add', \"Add Line Comment\"),\n            alias: 'Add Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass RemoveLineCommentAction extends CommentLineAction {\n    constructor() {\n        super(2 /* Type.ForceRemove */, {\n            id: 'editor.action.removeCommentLine',\n            label: nls.localize('comment.line.remove', \"Remove Line Comment\"),\n            alias: 'Remove Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 51 /* KeyCode.KeyU */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass BlockCommentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.blockComment',\n            label: nls.localize('comment.block', \"Toggle Block Comment\"),\n            alias: 'Toggle Block Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 31 /* KeyCode.KeyA */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 31 /* KeyCode.KeyA */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarEditMenu,\n                group: '5_insert',\n                title: nls.localize({ key: 'miToggleBlockComment', comment: ['&& denotes a mnemonic'] }, \"Toggle &&Block Comment\"),\n                order: 2\n            }\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commentsOptions = editor.getOption(23 /* EditorOption.comments */);\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            commands.push(new BlockCommentCommand(selection, commentsOptions.insertSpace, languageConfigurationService));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nregisterEditorAction(ToggleCommentLineAction);\nregisterEditorAction(AddLineCommentAction);\nregisterEditorAction(RemoveLineCommentAction);\nregisterEditorAction(BlockCommentAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class BlockCommentCommand {\n    constructor(selection, insertSpace, languageConfigurationService) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._selection = selection;\n        this._insertSpace = insertSpace;\n        this._usedEndToken = null;\n    }\n    static _haystackHasNeedleAtOffset(haystack, needle, offset) {\n        if (offset < 0) {\n            return false;\n        }\n        const needleLength = needle.length;\n        const haystackLength = haystack.length;\n        if (offset + needleLength > haystackLength) {\n            return false;\n        }\n        for (let i = 0; i < needleLength; i++) {\n            const codeA = haystack.charCodeAt(offset + i);\n            const codeB = needle.charCodeAt(i);\n            if (codeA === codeB) {\n                continue;\n            }\n            if (codeA >= 65 /* CharCode.A */ && codeA <= 90 /* CharCode.Z */ && codeA + 32 === codeB) {\n                // codeA is upper-case variant of codeB\n                continue;\n            }\n            if (codeB >= 65 /* CharCode.A */ && codeB <= 90 /* CharCode.Z */ && codeB + 32 === codeA) {\n                // codeB is upper-case variant of codeA\n                continue;\n            }\n            return false;\n        }\n        return true;\n    }\n    _createOperationsForBlockComment(selection, startToken, endToken, insertSpace, model, builder) {\n        const startLineNumber = selection.startLineNumber;\n        const startColumn = selection.startColumn;\n        const endLineNumber = selection.endLineNumber;\n        const endColumn = selection.endColumn;\n        const startLineText = model.getLineContent(startLineNumber);\n        const endLineText = model.getLineContent(endLineNumber);\n        let startTokenIndex = startLineText.lastIndexOf(startToken, startColumn - 1 + startToken.length);\n        let endTokenIndex = endLineText.indexOf(endToken, endColumn - 1 - endToken.length);\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            if (startLineNumber === endLineNumber) {\n                const lineBetweenTokens = startLineText.substring(startTokenIndex + startToken.length, endTokenIndex);\n                if (lineBetweenTokens.indexOf(endToken) >= 0) {\n                    // force to add a block comment\n                    startTokenIndex = -1;\n                    endTokenIndex = -1;\n                }\n            }\n            else {\n                const startLineAfterStartToken = startLineText.substring(startTokenIndex + startToken.length);\n                const endLineBeforeEndToken = endLineText.substring(0, endTokenIndex);\n                if (startLineAfterStartToken.indexOf(endToken) >= 0 || endLineBeforeEndToken.indexOf(endToken) >= 0) {\n                    // force to add a block comment\n                    startTokenIndex = -1;\n                    endTokenIndex = -1;\n                }\n            }\n        }\n        let ops;\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            // Consider spaces as part of the comment tokens\n            if (insertSpace && startTokenIndex + startToken.length < startLineText.length && startLineText.charCodeAt(startTokenIndex + startToken.length) === 32 /* CharCode.Space */) {\n                // Pretend the start token contains a trailing space\n                startToken = startToken + ' ';\n            }\n            if (insertSpace && endTokenIndex > 0 && endLineText.charCodeAt(endTokenIndex - 1) === 32 /* CharCode.Space */) {\n                // Pretend the end token contains a leading space\n                endToken = ' ' + endToken;\n                endTokenIndex -= 1;\n            }\n            ops = BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\n        }\n        else {\n            ops = BlockCommentCommand._createAddBlockCommentOperations(selection, startToken, endToken, this._insertSpace);\n            this._usedEndToken = ops.length === 1 ? endToken : null;\n        }\n        for (const op of ops) {\n            builder.addTrackedEditOperation(op.range, op.text);\n        }\n    }\n    static _createRemoveBlockCommentOperations(r, startToken, endToken) {\n        const res = [];\n        if (!Range.isEmpty(r)) {\n            // Remove block comment start\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.startLineNumber, r.startColumn)));\n            // Remove block comment end\n            res.push(EditOperation.delete(new Range(r.endLineNumber, r.endColumn, r.endLineNumber, r.endColumn + endToken.length)));\n        }\n        else {\n            // Remove both continuously\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.endLineNumber, r.endColumn + endToken.length)));\n        }\n        return res;\n    }\n    static _createAddBlockCommentOperations(r, startToken, endToken, insertSpace) {\n        const res = [];\n        if (!Range.isEmpty(r)) {\n            // Insert block comment start\n            res.push(EditOperation.insert(new Position(r.startLineNumber, r.startColumn), startToken + (insertSpace ? ' ' : '')));\n            // Insert block comment end\n            res.push(EditOperation.insert(new Position(r.endLineNumber, r.endColumn), (insertSpace ? ' ' : '') + endToken));\n        }\n        else {\n            // Insert both continuously\n            res.push(EditOperation.replace(new Range(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn), startToken + '  ' + endToken));\n        }\n        return res;\n    }\n    getEditOperations(model, builder) {\n        const startLineNumber = this._selection.startLineNumber;\n        const startColumn = this._selection.startColumn;\n        model.tokenization.tokenizeIfCheap(startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, startColumn);\n        const config = this.languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\n            // Mode does not support block comments\n            return;\n        }\n        this._createOperationsForBlockComment(this._selection, config.blockCommentStartToken, config.blockCommentEndToken, this._insertSpace, model, builder);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        if (inverseEditOperations.length === 2) {\n            const startTokenEditOperation = inverseEditOperations[0];\n            const endTokenEditOperation = inverseEditOperations[1];\n            return new Selection(startTokenEditOperation.range.endLineNumber, startTokenEditOperation.range.endColumn, endTokenEditOperation.range.startLineNumber, endTokenEditOperation.range.startColumn);\n        }\n        else {\n            const srcRange = inverseEditOperations[0].range;\n            const deltaColumn = this._usedEndToken ? -this._usedEndToken.length - 1 : 0; // minus 1 space before endToken\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn + deltaColumn, srcRange.endLineNumber, srcRange.endColumn + deltaColumn);\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { BlockCommentCommand } from './blockCommentCommand.js';\nexport class LineCommentCommand {\n    constructor(languageConfigurationService, selection, tabSize, type, insertSpace, ignoreEmptyLines, ignoreFirstLine) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._selection = selection;\n        this._tabSize = tabSize;\n        this._type = type;\n        this._insertSpace = insertSpace;\n        this._selectionId = null;\n        this._deltaColumn = 0;\n        this._moveEndPositionDown = false;\n        this._ignoreEmptyLines = ignoreEmptyLines;\n        this._ignoreFirstLine = ignoreFirstLine || false;\n    }\n    /**\n     * Do an initial pass over the lines and gather info about the line comment string.\n     * Returns null if any of the lines doesn't support a line comment string.\n     */\n    static _gatherPreflightCommentStrings(model, startLineNumber, endLineNumber, languageConfigurationService) {\n        model.tokenization.tokenizeIfCheap(startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, 1);\n        const config = languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        const commentStr = (config ? config.lineCommentToken : null);\n        if (!commentStr) {\n            // Mode does not support line comments\n            return null;\n        }\n        const lines = [];\n        for (let i = 0, lineCount = endLineNumber - startLineNumber + 1; i < lineCount; i++) {\n            lines[i] = {\n                ignore: false,\n                commentStr: commentStr,\n                commentStrOffset: 0,\n                commentStrLength: commentStr.length\n            };\n        }\n        return lines;\n    }\n    /**\n     * Analyze lines and decide which lines are relevant and what the toggle should do.\n     * Also, build up several offsets and lengths useful in the generation of editor operations.\n     */\n    static _analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService) {\n        let onlyWhitespaceLines = true;\n        let shouldRemoveComments;\n        if (type === 0 /* Type.Toggle */) {\n            shouldRemoveComments = true;\n        }\n        else if (type === 1 /* Type.ForceAdd */) {\n            shouldRemoveComments = false;\n        }\n        else {\n            shouldRemoveComments = true;\n        }\n        for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\n            const lineData = lines[i];\n            const lineNumber = startLineNumber + i;\n            if (lineNumber === startLineNumber && ignoreFirstLine) {\n                // first line ignored\n                lineData.ignore = true;\n                continue;\n            }\n            const lineContent = model.getLineContent(lineNumber);\n            const lineContentStartOffset = strings.firstNonWhitespaceIndex(lineContent);\n            if (lineContentStartOffset === -1) {\n                // Empty or whitespace only line\n                lineData.ignore = ignoreEmptyLines;\n                lineData.commentStrOffset = lineContent.length;\n                continue;\n            }\n            onlyWhitespaceLines = false;\n            lineData.ignore = false;\n            lineData.commentStrOffset = lineContentStartOffset;\n            if (shouldRemoveComments && !BlockCommentCommand._haystackHasNeedleAtOffset(lineContent, lineData.commentStr, lineContentStartOffset)) {\n                if (type === 0 /* Type.Toggle */) {\n                    // Every line so far has been a line comment, but this one is not\n                    shouldRemoveComments = false;\n                }\n                else if (type === 1 /* Type.ForceAdd */) {\n                    // Will not happen\n                }\n                else {\n                    lineData.ignore = true;\n                }\n            }\n            if (shouldRemoveComments && insertSpace) {\n                // Remove a following space if present\n                const commentStrEndOffset = lineContentStartOffset + lineData.commentStrLength;\n                if (commentStrEndOffset < lineContent.length && lineContent.charCodeAt(commentStrEndOffset) === 32 /* CharCode.Space */) {\n                    lineData.commentStrLength += 1;\n                }\n            }\n        }\n        if (type === 0 /* Type.Toggle */ && onlyWhitespaceLines) {\n            // For only whitespace lines, we insert comments\n            shouldRemoveComments = false;\n            // Also, no longer ignore them\n            for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\n                lines[i].ignore = false;\n            }\n        }\n        return {\n            supported: true,\n            shouldRemoveComments: shouldRemoveComments,\n            lines: lines\n        };\n    }\n    /**\n     * Analyze all lines and decide exactly what to do => not supported | insert line comments | remove line comments\n     */\n    static _gatherPreflightData(type, insertSpace, model, startLineNumber, endLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService) {\n        const lines = LineCommentCommand._gatherPreflightCommentStrings(model, startLineNumber, endLineNumber, languageConfigurationService);\n        if (lines === null) {\n            return {\n                supported: false\n            };\n        }\n        return LineCommentCommand._analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService);\n    }\n    /**\n     * Given a successful analysis, execute either insert line comments, either remove line comments\n     */\n    _executeLineComments(model, builder, data, s) {\n        let ops;\n        if (data.shouldRemoveComments) {\n            ops = LineCommentCommand._createRemoveLineCommentsOperations(data.lines, s.startLineNumber);\n        }\n        else {\n            LineCommentCommand._normalizeInsertionPoint(model, data.lines, s.startLineNumber, this._tabSize);\n            ops = this._createAddLineCommentsOperations(data.lines, s.startLineNumber);\n        }\n        const cursorPosition = new Position(s.positionLineNumber, s.positionColumn);\n        for (let i = 0, len = ops.length; i < len; i++) {\n            builder.addEditOperation(ops[i].range, ops[i].text);\n            if (Range.isEmpty(ops[i].range) && Range.getStartPosition(ops[i].range).equals(cursorPosition)) {\n                const lineContent = model.getLineContent(cursorPosition.lineNumber);\n                if (lineContent.length + 1 === cursorPosition.column) {\n                    this._deltaColumn = (ops[i].text || '').length;\n                }\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n    }\n    _attemptRemoveBlockComment(model, s, startToken, endToken) {\n        let startLineNumber = s.startLineNumber;\n        let endLineNumber = s.endLineNumber;\n        const startTokenAllowedBeforeColumn = endToken.length + Math.max(model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.startColumn);\n        let startTokenIndex = model.getLineContent(startLineNumber).lastIndexOf(startToken, startTokenAllowedBeforeColumn - 1);\n        let endTokenIndex = model.getLineContent(endLineNumber).indexOf(endToken, s.endColumn - 1 - startToken.length);\n        if (startTokenIndex !== -1 && endTokenIndex === -1) {\n            endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\n            endLineNumber = startLineNumber;\n        }\n        if (startTokenIndex === -1 && endTokenIndex !== -1) {\n            startTokenIndex = model.getLineContent(endLineNumber).lastIndexOf(startToken, endTokenIndex);\n            startLineNumber = endLineNumber;\n        }\n        if (s.isEmpty() && (startTokenIndex === -1 || endTokenIndex === -1)) {\n            startTokenIndex = model.getLineContent(startLineNumber).indexOf(startToken);\n            if (startTokenIndex !== -1) {\n                endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\n            }\n        }\n        // We have to adjust to possible inner white space.\n        // For Space after startToken, add Space to startToken - range math will work out.\n        if (startTokenIndex !== -1 && model.getLineContent(startLineNumber).charCodeAt(startTokenIndex + startToken.length) === 32 /* CharCode.Space */) {\n            startToken += ' ';\n        }\n        // For Space before endToken, add Space before endToken and shift index one left.\n        if (endTokenIndex !== -1 && model.getLineContent(endLineNumber).charCodeAt(endTokenIndex - 1) === 32 /* CharCode.Space */) {\n            endToken = ' ' + endToken;\n            endTokenIndex -= 1;\n        }\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            return BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\n        }\n        return null;\n    }\n    /**\n     * Given an unsuccessful analysis, delegate to the block comment command\n     */\n    _executeBlockComment(model, builder, s) {\n        model.tokenization.tokenizeIfCheap(s.startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(s.startLineNumber, 1);\n        const config = this.languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\n            // Mode does not support block comments\n            return;\n        }\n        const startToken = config.blockCommentStartToken;\n        const endToken = config.blockCommentEndToken;\n        let ops = this._attemptRemoveBlockComment(model, s, startToken, endToken);\n        if (!ops) {\n            if (s.isEmpty()) {\n                const lineContent = model.getLineContent(s.startLineNumber);\n                let firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\n                if (firstNonWhitespaceIndex === -1) {\n                    // Line is empty or contains only whitespace\n                    firstNonWhitespaceIndex = lineContent.length;\n                }\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, firstNonWhitespaceIndex + 1, s.startLineNumber, lineContent.length + 1), startToken, endToken, this._insertSpace);\n            }\n            else {\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), startToken, endToken, this._insertSpace);\n            }\n            if (ops.length === 1) {\n                // Leave cursor after token and Space\n                this._deltaColumn = startToken.length + 1;\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n        for (const op of ops) {\n            builder.addEditOperation(op.range, op.text);\n        }\n    }\n    getEditOperations(model, builder) {\n        let s = this._selection;\n        this._moveEndPositionDown = false;\n        if (s.startLineNumber === s.endLineNumber && this._ignoreFirstLine) {\n            builder.addEditOperation(new Range(s.startLineNumber, model.getLineMaxColumn(s.startLineNumber), s.startLineNumber + 1, 1), s.startLineNumber === model.getLineCount() ? '' : '\\n');\n            this._selectionId = builder.trackSelection(s);\n            return;\n        }\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._moveEndPositionDown = true;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const data = LineCommentCommand._gatherPreflightData(this._type, this._insertSpace, model, s.startLineNumber, s.endLineNumber, this._ignoreEmptyLines, this._ignoreFirstLine, this.languageConfigurationService);\n        if (data.supported) {\n            return this._executeLineComments(model, builder, data, s);\n        }\n        return this._executeBlockComment(model, builder, s);\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._moveEndPositionDown) {\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\n        }\n        return new Selection(result.selectionStartLineNumber, result.selectionStartColumn + this._deltaColumn, result.positionLineNumber, result.positionColumn + this._deltaColumn);\n    }\n    /**\n     * Generate edit operations in the remove line comment case\n     */\n    static _createRemoveLineCommentsOperations(lines, startLineNumber) {\n        const res = [];\n        for (let i = 0, len = lines.length; i < len; i++) {\n            const lineData = lines[i];\n            if (lineData.ignore) {\n                continue;\n            }\n            res.push(EditOperation.delete(new Range(startLineNumber + i, lineData.commentStrOffset + 1, startLineNumber + i, lineData.commentStrOffset + lineData.commentStrLength + 1)));\n        }\n        return res;\n    }\n    /**\n     * Generate edit operations in the add line comment case\n     */\n    _createAddLineCommentsOperations(lines, startLineNumber) {\n        const res = [];\n        const afterCommentStr = this._insertSpace ? ' ' : '';\n        for (let i = 0, len = lines.length; i < len; i++) {\n            const lineData = lines[i];\n            if (lineData.ignore) {\n                continue;\n            }\n            res.push(EditOperation.insert(new Position(startLineNumber + i, lineData.commentStrOffset + 1), lineData.commentStr + afterCommentStr));\n        }\n        return res;\n    }\n    static nextVisibleColumn(currentVisibleColumn, tabSize, isTab, columnSize) {\n        if (isTab) {\n            return currentVisibleColumn + (tabSize - (currentVisibleColumn % tabSize));\n        }\n        return currentVisibleColumn + columnSize;\n    }\n    /**\n     * Adjust insertion points to have them vertically aligned in the add line comment case\n     */\n    static _normalizeInsertionPoint(model, lines, startLineNumber, tabSize) {\n        let minVisibleColumn = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        let j;\n        let lenJ;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].ignore) {\n                continue;\n            }\n            const lineContent = model.getLineContent(startLineNumber + i);\n            let currentVisibleColumn = 0;\n            for (let j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* CharCode.Tab */, 1);\n            }\n            if (currentVisibleColumn < minVisibleColumn) {\n                minVisibleColumn = currentVisibleColumn;\n            }\n        }\n        minVisibleColumn = Math.floor(minVisibleColumn / tabSize) * tabSize;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].ignore) {\n                continue;\n            }\n            const lineContent = model.getLineContent(startLineNumber + i);\n            let currentVisibleColumn = 0;\n            for (j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* CharCode.Tab */, 1);\n            }\n            if (currentVisibleColumn > minVisibleColumn) {\n                lines[i].commentStrOffset = j - 1;\n            }\n            else {\n                lines[i].commentStrOffset = j;\n            }\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ContextMenuController_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionViewItem } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { Separator, SubmenuAction } from '../../../../base/common/actions.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { isIOS } from '../../../../base/common/platform.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nimport { IMenuService, MenuId, SubmenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService, IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IWorkspaceContextService, isStandaloneEditorWorkspace } from '../../../../platform/workspace/common/workspace.js';\nlet ContextMenuController = ContextMenuController_1 = class ContextMenuController {\n    static get(editor) {\n        return editor.getContribution(ContextMenuController_1.ID);\n    }\n    constructor(editor, _contextMenuService, _contextViewService, _contextKeyService, _keybindingService, _menuService, _configurationService, _workspaceContextService) {\n        this._contextMenuService = _contextMenuService;\n        this._contextViewService = _contextViewService;\n        this._contextKeyService = _contextKeyService;\n        this._keybindingService = _keybindingService;\n        this._menuService = _menuService;\n        this._configurationService = _configurationService;\n        this._workspaceContextService = _workspaceContextService;\n        this._toDispose = new DisposableStore();\n        this._contextMenuIsBeingShownCount = 0;\n        this._editor = editor;\n        this._toDispose.add(this._editor.onContextMenu((e) => this._onContextMenu(e)));\n        this._toDispose.add(this._editor.onMouseWheel((e) => {\n            if (this._contextMenuIsBeingShownCount > 0) {\n                const view = this._contextViewService.getContextViewElement();\n                const target = e.srcElement;\n                // Event triggers on shadow root host first\n                // Check if the context view is under this host before hiding it #103169\n                if (!(target.shadowRoot && dom.getShadowRoot(view) === target.shadowRoot)) {\n                    this._contextViewService.hideContextView();\n                }\n            }\n        }));\n        this._toDispose.add(this._editor.onKeyDown((e) => {\n            if (!this._editor.getOption(24 /* EditorOption.contextmenu */)) {\n                return; // Context menu is turned off through configuration\n            }\n            if (e.keyCode === 58 /* KeyCode.ContextMenu */) {\n                // Chrome is funny like that\n                e.preventDefault();\n                e.stopPropagation();\n                this.showContextMenu();\n            }\n        }));\n    }\n    _onContextMenu(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._editor.getOption(24 /* EditorOption.contextmenu */)) {\n            this._editor.focus();\n            // Ensure the cursor is at the position of the mouse click\n            if (e.target.position && !this._editor.getSelection().containsPosition(e.target.position)) {\n                this._editor.setPosition(e.target.position);\n            }\n            return; // Context menu is turned off through configuration\n        }\n        if (e.target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */) {\n            return; // allow native menu on widgets to support right click on input field for example in find\n        }\n        if (e.target.type === 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.detail.injectedText) {\n            return; // allow native menu on injected text\n        }\n        e.event.preventDefault();\n        e.event.stopPropagation();\n        if (e.target.type === 11 /* MouseTargetType.SCROLLBAR */) {\n            return this._showScrollbarContextMenu(e.event);\n        }\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.type !== 7 /* MouseTargetType.CONTENT_EMPTY */ && e.target.type !== 1 /* MouseTargetType.TEXTAREA */) {\n            return; // only support mouse click into text or native context menu key for now\n        }\n        // Ensure the editor gets focus if it hasn't, so the right events are being sent to other contributions\n        this._editor.focus();\n        // Ensure the cursor is at the position of the mouse click\n        if (e.target.position) {\n            let hasSelectionAtPosition = false;\n            for (const selection of this._editor.getSelections()) {\n                if (selection.containsPosition(e.target.position)) {\n                    hasSelectionAtPosition = true;\n                    break;\n                }\n            }\n            if (!hasSelectionAtPosition) {\n                this._editor.setPosition(e.target.position);\n            }\n        }\n        // Unless the user triggerd the context menu through Shift+F10, use the mouse position as menu position\n        let anchor = null;\n        if (e.target.type !== 1 /* MouseTargetType.TEXTAREA */) {\n            anchor = e.event;\n        }\n        // Show the context menu\n        this.showContextMenu(anchor);\n    }\n    showContextMenu(anchor) {\n        if (!this._editor.getOption(24 /* EditorOption.contextmenu */)) {\n            return; // Context menu is turned off through configuration\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // Find actions available for menu\n        const menuActions = this._getMenuActions(this._editor.getModel(), this._editor.isSimpleWidget ? MenuId.SimpleEditorContext : MenuId.EditorContext);\n        // Show menu if we have actions to show\n        if (menuActions.length > 0) {\n            this._doShowContextMenu(menuActions, anchor);\n        }\n    }\n    _getMenuActions(model, menuId) {\n        const result = [];\n        // get menu groups\n        const menu = this._menuService.createMenu(menuId, this._contextKeyService);\n        const groups = menu.getActions({ arg: model.uri });\n        menu.dispose();\n        // translate them into other actions\n        for (const group of groups) {\n            const [, actions] = group;\n            let addedItems = 0;\n            for (const action of actions) {\n                if (action instanceof SubmenuItemAction) {\n                    const subActions = this._getMenuActions(model, action.item.submenu);\n                    if (subActions.length > 0) {\n                        result.push(new SubmenuAction(action.id, action.label, subActions));\n                        addedItems++;\n                    }\n                }\n                else {\n                    result.push(action);\n                    addedItems++;\n                }\n            }\n            if (addedItems) {\n                result.push(new Separator());\n            }\n        }\n        if (result.length) {\n            result.pop(); // remove last separator\n        }\n        return result;\n    }\n    _doShowContextMenu(actions, event = null) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // Disable hover\n        const oldHoverSetting = this._editor.getOption(60 /* EditorOption.hover */);\n        this._editor.updateOptions({\n            hover: {\n                enabled: false\n            }\n        });\n        let anchor = event;\n        if (!anchor) {\n            // Ensure selection is visible\n            this._editor.revealPosition(this._editor.getPosition(), 1 /* ScrollType.Immediate */);\n            this._editor.render();\n            const cursorCoords = this._editor.getScrolledVisiblePosition(this._editor.getPosition());\n            // Translate to absolute editor position\n            const editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\n            const posx = editorCoords.left + cursorCoords.left;\n            const posy = editorCoords.top + cursorCoords.top + cursorCoords.height;\n            anchor = { x: posx, y: posy };\n        }\n        const useShadowDOM = this._editor.getOption(127 /* EditorOption.useShadowDOM */) && !isIOS; // Do not use shadow dom on IOS #122035\n        // Show menu\n        this._contextMenuIsBeingShownCount++;\n        this._contextMenuService.showContextMenu({\n            domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\n            getAnchor: () => anchor,\n            getActions: () => actions,\n            getActionViewItem: (action) => {\n                const keybinding = this._keybindingFor(action);\n                if (keybinding) {\n                    return new ActionViewItem(action, action, { label: true, keybinding: keybinding.getLabel(), isMenu: true });\n                }\n                const customActionViewItem = action;\n                if (typeof customActionViewItem.getActionViewItem === 'function') {\n                    return customActionViewItem.getActionViewItem();\n                }\n                return new ActionViewItem(action, action, { icon: true, label: true, isMenu: true });\n            },\n            getKeyBinding: (action) => {\n                return this._keybindingFor(action);\n            },\n            onHide: (wasCancelled) => {\n                this._contextMenuIsBeingShownCount--;\n                this._editor.updateOptions({\n                    hover: oldHoverSetting\n                });\n            }\n        });\n    }\n    _showScrollbarContextMenu(anchor) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (isStandaloneEditorWorkspace(this._workspaceContextService.getWorkspace())) {\n            // can't update the configuration properly in the standalone editor\n            return;\n        }\n        const minimapOptions = this._editor.getOption(73 /* EditorOption.minimap */);\n        let lastId = 0;\n        const createAction = (opts) => {\n            return {\n                id: `menu-action-${++lastId}`,\n                label: opts.label,\n                tooltip: '',\n                class: undefined,\n                enabled: (typeof opts.enabled === 'undefined' ? true : opts.enabled),\n                checked: opts.checked,\n                run: opts.run\n            };\n        };\n        const createSubmenuAction = (label, actions) => {\n            return new SubmenuAction(`menu-action-${++lastId}`, label, actions, undefined);\n        };\n        const createEnumAction = (label, enabled, configName, configuredValue, options) => {\n            if (!enabled) {\n                return createAction({ label, enabled, run: () => { } });\n            }\n            const createRunner = (value) => {\n                return () => {\n                    this._configurationService.updateValue(configName, value);\n                };\n            };\n            const actions = [];\n            for (const option of options) {\n                actions.push(createAction({\n                    label: option.label,\n                    checked: configuredValue === option.value,\n                    run: createRunner(option.value)\n                }));\n            }\n            return createSubmenuAction(label, actions);\n        };\n        const actions = [];\n        actions.push(createAction({\n            label: nls.localize('context.minimap.minimap', \"Minimap\"),\n            checked: minimapOptions.enabled,\n            run: () => {\n                this._configurationService.updateValue(`editor.minimap.enabled`, !minimapOptions.enabled);\n            }\n        }));\n        actions.push(new Separator());\n        actions.push(createAction({\n            label: nls.localize('context.minimap.renderCharacters', \"Render Characters\"),\n            enabled: minimapOptions.enabled,\n            checked: minimapOptions.renderCharacters,\n            run: () => {\n                this._configurationService.updateValue(`editor.minimap.renderCharacters`, !minimapOptions.renderCharacters);\n            }\n        }));\n        actions.push(createEnumAction(nls.localize('context.minimap.size', \"Vertical size\"), minimapOptions.enabled, 'editor.minimap.size', minimapOptions.size, [{\n                label: nls.localize('context.minimap.size.proportional', \"Proportional\"),\n                value: 'proportional'\n            }, {\n                label: nls.localize('context.minimap.size.fill', \"Fill\"),\n                value: 'fill'\n            }, {\n                label: nls.localize('context.minimap.size.fit', \"Fit\"),\n                value: 'fit'\n            }]));\n        actions.push(createEnumAction(nls.localize('context.minimap.slider', \"Slider\"), minimapOptions.enabled, 'editor.minimap.showSlider', minimapOptions.showSlider, [{\n                label: nls.localize('context.minimap.slider.mouseover', \"Mouse Over\"),\n                value: 'mouseover'\n            }, {\n                label: nls.localize('context.minimap.slider.always', \"Always\"),\n                value: 'always'\n            }]));\n        const useShadowDOM = this._editor.getOption(127 /* EditorOption.useShadowDOM */) && !isIOS; // Do not use shadow dom on IOS #122035\n        this._contextMenuIsBeingShownCount++;\n        this._contextMenuService.showContextMenu({\n            domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\n            getAnchor: () => anchor,\n            getActions: () => actions,\n            onHide: (wasCancelled) => {\n                this._contextMenuIsBeingShownCount--;\n                this._editor.focus();\n            }\n        });\n    }\n    _keybindingFor(action) {\n        return this._keybindingService.lookupKeybinding(action.id);\n    }\n    dispose() {\n        if (this._contextMenuIsBeingShownCount > 0) {\n            this._contextViewService.hideContextView();\n        }\n        this._toDispose.dispose();\n    }\n};\nContextMenuController.ID = 'editor.contrib.contextmenu';\nContextMenuController = ContextMenuController_1 = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, IContextViewService),\n    __param(3, IContextKeyService),\n    __param(4, IKeybindingService),\n    __param(5, IMenuService),\n    __param(6, IConfigurationService),\n    __param(7, IWorkspaceContextService)\n], ContextMenuController);\nexport { ContextMenuController };\nclass ShowContextMenu extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showContextMenu',\n            label: nls.localize('action.showContextMenu.label', \"Show Editor Context Menu\"),\n            alias: 'Show Editor Context Menu',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        var _a;\n        (_a = ContextMenuController.get(editor)) === null || _a === void 0 ? void 0 : _a.showContextMenu();\n    }\n}\nregisterEditorContribution(ContextMenuController.ID, ContextMenuController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(ShowContextMenu);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nclass CursorState {\n    constructor(selections) {\n        this.selections = selections;\n    }\n    equals(other) {\n        const thisLen = this.selections.length;\n        const otherLen = other.selections.length;\n        if (thisLen !== otherLen) {\n            return false;\n        }\n        for (let i = 0; i < thisLen; i++) {\n            if (!this.selections[i].equalsSelection(other.selections[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\nclass StackElement {\n    constructor(cursorState, scrollTop, scrollLeft) {\n        this.cursorState = cursorState;\n        this.scrollTop = scrollTop;\n        this.scrollLeft = scrollLeft;\n    }\n}\nexport class CursorUndoRedoController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(CursorUndoRedoController.ID);\n    }\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._isCursorUndoRedo = false;\n        this._undoStack = [];\n        this._redoStack = [];\n        this._register(editor.onDidChangeModel((e) => {\n            this._undoStack = [];\n            this._redoStack = [];\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            this._undoStack = [];\n            this._redoStack = [];\n        }));\n        this._register(editor.onDidChangeCursorSelection((e) => {\n            if (this._isCursorUndoRedo) {\n                return;\n            }\n            if (!e.oldSelections) {\n                return;\n            }\n            if (e.oldModelVersionId !== e.modelVersionId) {\n                return;\n            }\n            const prevState = new CursorState(e.oldSelections);\n            const isEqualToLastUndoStack = (this._undoStack.length > 0 && this._undoStack[this._undoStack.length - 1].cursorState.equals(prevState));\n            if (!isEqualToLastUndoStack) {\n                this._undoStack.push(new StackElement(prevState, editor.getScrollTop(), editor.getScrollLeft()));\n                this._redoStack = [];\n                if (this._undoStack.length > 50) {\n                    // keep the cursor undo stack bounded\n                    this._undoStack.shift();\n                }\n            }\n        }));\n    }\n    cursorUndo() {\n        if (!this._editor.hasModel() || this._undoStack.length === 0) {\n            return;\n        }\n        this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n        this._applyState(this._undoStack.pop());\n    }\n    cursorRedo() {\n        if (!this._editor.hasModel() || this._redoStack.length === 0) {\n            return;\n        }\n        this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n        this._applyState(this._redoStack.pop());\n    }\n    _applyState(stackElement) {\n        this._isCursorUndoRedo = true;\n        this._editor.setSelections(stackElement.cursorState.selections);\n        this._editor.setScrollPosition({\n            scrollTop: stackElement.scrollTop,\n            scrollLeft: stackElement.scrollLeft\n        });\n        this._isCursorUndoRedo = false;\n    }\n}\nCursorUndoRedoController.ID = 'editor.contrib.cursorUndoRedoController';\nexport class CursorUndo extends EditorAction {\n    constructor() {\n        super({\n            id: 'cursorUndo',\n            label: nls.localize('cursor.undo', \"Cursor Undo\"),\n            alias: 'Cursor Undo',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 51 /* KeyCode.KeyU */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        var _a;\n        (_a = CursorUndoRedoController.get(editor)) === null || _a === void 0 ? void 0 : _a.cursorUndo();\n    }\n}\nexport class CursorRedo extends EditorAction {\n    constructor() {\n        super({\n            id: 'cursorRedo',\n            label: nls.localize('cursor.redo', \"Cursor Redo\"),\n            alias: 'Cursor Redo',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        var _a;\n        (_a = CursorUndoRedoController.get(editor)) === null || _a === void 0 ? void 0 : _a.cursorRedo();\n    }\n}\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController, 0 /* EditorContributionInstantiation.Eager */); // eager because it needs to listen to record cursor state ASAP\nregisterEditorAction(CursorUndo);\nregisterEditorAction(CursorRedo);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { isMacintosh } from '../../../../base/common/platform.js';\nimport './dnd.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { DragAndDropCommand } from './dragAndDropCommand.js';\nfunction hasTriggerModifier(e) {\n    if (isMacintosh) {\n        return e.altKey;\n    }\n    else {\n        return e.ctrlKey;\n    }\n}\nexport class DragAndDropController extends Disposable {\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._dndDecorationIds = this._editor.createDecorationsCollection();\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(e)));\n        this._register(this._editor.onMouseDrag((e) => this._onEditorMouseDrag(e)));\n        this._register(this._editor.onMouseDrop((e) => this._onEditorMouseDrop(e)));\n        this._register(this._editor.onMouseDropCanceled(() => this._onEditorMouseDropCanceled()));\n        this._register(this._editor.onKeyDown((e) => this.onEditorKeyDown(e)));\n        this._register(this._editor.onKeyUp((e) => this.onEditorKeyUp(e)));\n        this._register(this._editor.onDidBlurEditorWidget(() => this.onEditorBlur()));\n        this._register(this._editor.onDidBlurEditorText(() => this.onEditorBlur()));\n        this._mouseDown = false;\n        this._modifierPressed = false;\n        this._dragSelection = null;\n    }\n    onEditorBlur() {\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n        this._modifierPressed = false;\n    }\n    onEditorKeyDown(e) {\n        if (!this._editor.getOption(35 /* EditorOption.dragAndDrop */) || this._editor.getOption(22 /* EditorOption.columnSelection */)) {\n            return;\n        }\n        if (hasTriggerModifier(e)) {\n            this._modifierPressed = true;\n        }\n        if (this._mouseDown && hasTriggerModifier(e)) {\n            this._editor.updateOptions({\n                mouseStyle: 'copy'\n            });\n        }\n    }\n    onEditorKeyUp(e) {\n        if (!this._editor.getOption(35 /* EditorOption.dragAndDrop */) || this._editor.getOption(22 /* EditorOption.columnSelection */)) {\n            return;\n        }\n        if (hasTriggerModifier(e)) {\n            this._modifierPressed = false;\n        }\n        if (this._mouseDown && e.keyCode === DragAndDropController.TRIGGER_KEY_VALUE) {\n            this._editor.updateOptions({\n                mouseStyle: 'default'\n            });\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._mouseDown = true;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        this._mouseDown = false;\n        // Whenever users release the mouse, the drag and drop operation should finish and the cursor should revert to text.\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n    }\n    _onEditorMouseDrag(mouseEvent) {\n        const target = mouseEvent.target;\n        if (this._dragSelection === null) {\n            const selections = this._editor.getSelections() || [];\n            const possibleSelections = selections.filter(selection => target.position && selection.containsPosition(target.position));\n            if (possibleSelections.length === 1) {\n                this._dragSelection = possibleSelections[0];\n            }\n            else {\n                return;\n            }\n        }\n        if (hasTriggerModifier(mouseEvent.event)) {\n            this._editor.updateOptions({\n                mouseStyle: 'copy'\n            });\n        }\n        else {\n            this._editor.updateOptions({\n                mouseStyle: 'default'\n            });\n        }\n        if (target.position) {\n            if (this._dragSelection.containsPosition(target.position)) {\n                this._removeDecoration();\n            }\n            else {\n                this.showAt(target.position);\n            }\n        }\n    }\n    _onEditorMouseDropCanceled() {\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n    }\n    _onEditorMouseDrop(mouseEvent) {\n        if (mouseEvent.target && (this._hitContent(mouseEvent.target) || this._hitMargin(mouseEvent.target)) && mouseEvent.target.position) {\n            const newCursorPosition = new Position(mouseEvent.target.position.lineNumber, mouseEvent.target.position.column);\n            if (this._dragSelection === null) {\n                let newSelections = null;\n                if (mouseEvent.event.shiftKey) {\n                    const primarySelection = this._editor.getSelection();\n                    if (primarySelection) {\n                        const { selectionStartLineNumber, selectionStartColumn } = primarySelection;\n                        newSelections = [new Selection(selectionStartLineNumber, selectionStartColumn, newCursorPosition.lineNumber, newCursorPosition.column)];\n                    }\n                }\n                else {\n                    newSelections = (this._editor.getSelections() || []).map(selection => {\n                        if (selection.containsPosition(newCursorPosition)) {\n                            return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\n                        }\n                        else {\n                            return selection;\n                        }\n                    });\n                }\n                // Use `mouse` as the source instead of `api` and setting the reason to explicit (to behave like any other mouse operation).\n                this._editor.setSelections(newSelections || [], 'mouse', 3 /* CursorChangeReason.Explicit */);\n            }\n            else if (!this._dragSelection.containsPosition(newCursorPosition) ||\n                ((hasTriggerModifier(mouseEvent.event) ||\n                    this._modifierPressed) && (this._dragSelection.getEndPosition().equals(newCursorPosition) || this._dragSelection.getStartPosition().equals(newCursorPosition)) // we allow users to paste content beside the selection\n                )) {\n                this._editor.pushUndoStop();\n                this._editor.executeCommand(DragAndDropController.ID, new DragAndDropCommand(this._dragSelection, newCursorPosition, hasTriggerModifier(mouseEvent.event) || this._modifierPressed));\n                this._editor.pushUndoStop();\n            }\n        }\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n    }\n    showAt(position) {\n        this._dndDecorationIds.set([{\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column),\n                options: DragAndDropController._DECORATION_OPTIONS\n            }]);\n        this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n    }\n    _removeDecoration() {\n        this._dndDecorationIds.clear();\n    }\n    _hitContent(target) {\n        return target.type === 6 /* MouseTargetType.CONTENT_TEXT */ ||\n            target.type === 7 /* MouseTargetType.CONTENT_EMPTY */;\n    }\n    _hitMargin(target) {\n        return target.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ ||\n            target.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */ ||\n            target.type === 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */;\n    }\n    dispose() {\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n        this._modifierPressed = false;\n        super.dispose();\n    }\n}\nDragAndDropController.ID = 'editor.contrib.dragAndDrop';\nDragAndDropController.TRIGGER_KEY_VALUE = isMacintosh ? 6 /* KeyCode.Alt */ : 5 /* KeyCode.Ctrl */;\nDragAndDropController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n    description: 'dnd-target',\n    className: 'dnd-target'\n});\nregisterEditorContribution(DragAndDropController.ID, DragAndDropController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class DragAndDropCommand {\n    constructor(selection, targetPosition, copy) {\n        this.selection = selection;\n        this.targetPosition = targetPosition;\n        this.copy = copy;\n        this.targetSelection = null;\n    }\n    getEditOperations(model, builder) {\n        const text = model.getValueInRange(this.selection);\n        if (!this.copy) {\n            builder.addEditOperation(this.selection, null);\n        }\n        builder.addEditOperation(new Range(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column), text);\n        if (this.selection.containsPosition(this.targetPosition) && !(this.copy && (this.selection.getEndPosition().equals(this.targetPosition) || this.selection.getStartPosition().equals(this.targetPosition)) // we allow users to paste content beside the selection\n        )) {\n            this.targetSelection = this.selection;\n            return;\n        }\n        if (this.copy) {\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.selection.endLineNumber - this.selection.startLineNumber + this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        if (this.targetPosition.lineNumber > this.selection.endLineNumber) {\n            // Drag the selection downwards\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        if (this.targetPosition.lineNumber < this.selection.endLineNumber) {\n            // Drag the selection upwards\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber + this.selection.endLineNumber - this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        // The target position is at the same line as the selection's end position.\n        if (this.selection.endColumn <= this.targetPosition.column) {\n            // The target position is after the selection's end position\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn :\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column :\n                this.selection.endColumn);\n        }\n        else {\n            // The target position is before the selection's end position. Since the selection doesn't contain the target position, the selection is one-line and target position is before this selection.\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column + this.selection.endColumn - this.selection.startColumn);\n        }\n    }\n    computeCursorState(model, helper) {\n        return this.targetSelection;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { CopyPasteController, changePasteTypeCommandId, pasteWidgetVisibleCtx } from './copyPasteController.js';\nimport { DefaultPasteProvidersFeature } from './defaultProviders.js';\nimport * as nls from '../../../../nls.js';\nregisterEditorContribution(CopyPasteController.ID, CopyPasteController, 0 /* EditorContributionInstantiation.Eager */); // eager because it listens to events on the container dom node of the editor\nregisterEditorFeature(DefaultPasteProvidersFeature);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: changePasteTypeCommandId,\n            precondition: pasteWidgetVisibleCtx,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */,\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor, _args) {\n        var _a;\n        return (_a = CopyPasteController.get(editor)) === null || _a === void 0 ? void 0 : _a.changePasteType();\n    }\n});\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.pasteAs',\n            label: nls.localize('pasteAs', \"Paste As...\"),\n            alias: 'Paste As...',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: 'Paste as',\n                args: [{\n                        name: 'args',\n                        schema: {\n                            type: 'object',\n                            properties: {\n                                'id': {\n                                    type: 'string',\n                                    description: nls.localize('pasteAs.id', \"The id of the paste edit to try applying. If not provided, the editor will show a picker.\"),\n                                }\n                            },\n                        }\n                    }]\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        var _a;\n        const id = typeof (args === null || args === void 0 ? void 0 : args.id) === 'string' ? args.id : undefined;\n        return (_a = CopyPasteController.get(editor)) === null || _a === void 0 ? void 0 : _a.pasteAs(id);\n    }\n});\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.pasteAsText',\n            label: nls.localize('pasteAsText', \"Paste as Text\"),\n            alias: 'Paste as Text',\n            precondition: EditorContextKeys.writable,\n        });\n    }\n    run(_accessor, editor, args) {\n        var _a;\n        return (_a = CopyPasteController.get(editor)) === null || _a === void 0 ? void 0 : _a.pasteAs('text');\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { UriList } from '../../../../base/common/dataTransfer.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../base/common/mime.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { relativePath } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { localize } from '../../../../nls.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nconst builtInLabel = localize('builtIn', 'Built-in');\nclass SimplePasteAndDropProvider {\n    async provideDocumentPasteEdits(_model, _ranges, dataTransfer, context, token) {\n        const edit = await this.getEdit(dataTransfer, token);\n        return edit ? { insertText: edit.insertText, label: edit.label, detail: edit.detail, handledMimeType: edit.handledMimeType, yieldTo: edit.yieldTo } : undefined;\n    }\n    async provideDocumentOnDropEdits(_model, _position, dataTransfer, token) {\n        const edit = await this.getEdit(dataTransfer, token);\n        return edit ? { insertText: edit.insertText, label: edit.label, handledMimeType: edit.handledMimeType, yieldTo: edit.yieldTo } : undefined;\n    }\n}\nclass DefaultTextProvider extends SimplePasteAndDropProvider {\n    constructor() {\n        super(...arguments);\n        this.id = 'text';\n        this.dropMimeTypes = [Mimes.text];\n        this.pasteMimeTypes = [Mimes.text];\n    }\n    async getEdit(dataTransfer, _token) {\n        const textEntry = dataTransfer.get(Mimes.text);\n        if (!textEntry) {\n            return;\n        }\n        // Suppress if there's also a uriList entry.\n        // Typically the uri-list contains the same text as the text entry so showing both is confusing.\n        if (dataTransfer.has(Mimes.uriList)) {\n            return;\n        }\n        const insertText = await textEntry.asString();\n        return {\n            handledMimeType: Mimes.text,\n            label: localize('text.label', \"Insert Plain Text\"),\n            detail: builtInLabel,\n            insertText\n        };\n    }\n}\nclass PathProvider extends SimplePasteAndDropProvider {\n    constructor() {\n        super(...arguments);\n        this.id = 'uri';\n        this.dropMimeTypes = [Mimes.uriList];\n        this.pasteMimeTypes = [Mimes.uriList];\n    }\n    async getEdit(dataTransfer, token) {\n        const entries = await extractUriList(dataTransfer);\n        if (!entries.length || token.isCancellationRequested) {\n            return;\n        }\n        let uriCount = 0;\n        const insertText = entries\n            .map(({ uri, originalText }) => {\n            if (uri.scheme === Schemas.file) {\n                return uri.fsPath;\n            }\n            else {\n                uriCount++;\n                return originalText;\n            }\n        })\n            .join(' ');\n        let label;\n        if (uriCount > 0) {\n            // Dropping at least one generic uri (such as https) so use most generic label\n            label = entries.length > 1\n                ? localize('defaultDropProvider.uriList.uris', \"Insert Uris\")\n                : localize('defaultDropProvider.uriList.uri', \"Insert Uri\");\n        }\n        else {\n            // All the paths are file paths\n            label = entries.length > 1\n                ? localize('defaultDropProvider.uriList.paths', \"Insert Paths\")\n                : localize('defaultDropProvider.uriList.path', \"Insert Path\");\n        }\n        return {\n            handledMimeType: Mimes.uriList,\n            insertText,\n            label,\n            detail: builtInLabel,\n        };\n    }\n}\nlet RelativePathProvider = class RelativePathProvider extends SimplePasteAndDropProvider {\n    constructor(_workspaceContextService) {\n        super();\n        this._workspaceContextService = _workspaceContextService;\n        this.id = 'relativePath';\n        this.dropMimeTypes = [Mimes.uriList];\n        this.pasteMimeTypes = [Mimes.uriList];\n    }\n    async getEdit(dataTransfer, token) {\n        const entries = await extractUriList(dataTransfer);\n        if (!entries.length || token.isCancellationRequested) {\n            return;\n        }\n        const relativeUris = coalesce(entries.map(({ uri }) => {\n            const root = this._workspaceContextService.getWorkspaceFolder(uri);\n            return root ? relativePath(root.uri, uri) : undefined;\n        }));\n        if (!relativeUris.length) {\n            return;\n        }\n        return {\n            handledMimeType: Mimes.uriList,\n            insertText: relativeUris.join(' '),\n            label: entries.length > 1\n                ? localize('defaultDropProvider.uriList.relativePaths', \"Insert Relative Paths\")\n                : localize('defaultDropProvider.uriList.relativePath', \"Insert Relative Path\"),\n            detail: builtInLabel,\n        };\n    }\n};\nRelativePathProvider = __decorate([\n    __param(0, IWorkspaceContextService)\n], RelativePathProvider);\nclass PasteHtmlProvider {\n    constructor() {\n        this.id = 'html';\n        this.pasteMimeTypes = ['text/html'];\n        this._yieldTo = [{ mimeType: Mimes.text }];\n    }\n    async provideDocumentPasteEdits(_model, _ranges, dataTransfer, context, token) {\n        if (context.trigger !== 'explicit' && context.only !== this.id) {\n            return;\n        }\n        const entry = dataTransfer.get('text/html');\n        const htmlText = await (entry === null || entry === void 0 ? void 0 : entry.asString());\n        if (!htmlText || token.isCancellationRequested) {\n            return;\n        }\n        return {\n            insertText: htmlText,\n            yieldTo: this._yieldTo,\n            label: localize('pasteHtmlLabel', 'Insert HTML'),\n            detail: builtInLabel,\n        };\n    }\n}\nasync function extractUriList(dataTransfer) {\n    const urlListEntry = dataTransfer.get(Mimes.uriList);\n    if (!urlListEntry) {\n        return [];\n    }\n    const strUriList = await urlListEntry.asString();\n    const entries = [];\n    for (const entry of UriList.parse(strUriList)) {\n        try {\n            entries.push({ uri: URI.parse(entry), originalText: entry });\n        }\n        catch (_a) {\n            // noop\n        }\n    }\n    return entries;\n}\nlet DefaultDropProvidersFeature = class DefaultDropProvidersFeature extends Disposable {\n    constructor(languageFeaturesService, workspaceContextService) {\n        super();\n        this._register(languageFeaturesService.documentOnDropEditProvider.register('*', new DefaultTextProvider()));\n        this._register(languageFeaturesService.documentOnDropEditProvider.register('*', new PathProvider()));\n        this._register(languageFeaturesService.documentOnDropEditProvider.register('*', new RelativePathProvider(workspaceContextService)));\n    }\n};\nDefaultDropProvidersFeature = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IWorkspaceContextService)\n], DefaultDropProvidersFeature);\nexport { DefaultDropProvidersFeature };\nlet DefaultPasteProvidersFeature = class DefaultPasteProvidersFeature extends Disposable {\n    constructor(languageFeaturesService, workspaceContextService) {\n        super();\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new DefaultTextProvider()));\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new PathProvider()));\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new RelativePathProvider(workspaceContextService)));\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new PasteHtmlProvider()));\n    }\n};\nDefaultPasteProvidersFeature = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IWorkspaceContextService)\n], DefaultPasteProvidersFeature);\nexport { DefaultPasteProvidersFeature };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { editorConfigurationBaseNode } from '../../../common/config/editorConfigurationSchema.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { DefaultDropProvidersFeature } from './defaultProviders.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions as ConfigurationExtensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { DropIntoEditorController, changeDropTypeCommandId, defaultProviderConfig, dropWidgetVisibleCtx } from './dropIntoEditorController.js';\nregisterEditorContribution(DropIntoEditorController.ID, DropIntoEditorController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: changeDropTypeCommandId,\n            precondition: dropWidgetVisibleCtx,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */,\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor, _args) {\n        var _a;\n        (_a = DropIntoEditorController.get(editor)) === null || _a === void 0 ? void 0 : _a.changeDropType();\n    }\n});\nregisterEditorFeature(DefaultDropProvidersFeature);\nRegistry.as(ConfigurationExtensions.Configuration).registerConfiguration({\n    ...editorConfigurationBaseNode,\n    properties: {\n        [defaultProviderConfig]: {\n            type: 'object',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('defaultProviderDescription', \"Configures the default drop provider to use for content of a given mime type.\"),\n            default: {},\n            additionalProperties: {\n                type: 'string',\n            },\n        },\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar DropIntoEditorController_1;\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { VSDataTransfer, matchesMimeType } from '../../../../base/common/dataTransfer.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { toExternalVSDataTransfer } from '../../../browser/dnd.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DraggedTreeItemsIdentifier } from '../../../common/services/treeViewsDnd.js';\nimport { ITreeViewsDnDService } from '../../../common/services/treeViewsDndService.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { InlineProgressManager } from '../../inlineProgress/browser/inlineProgress.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { LocalSelectionTransfer } from '../../../../platform/dnd/browser/dnd.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { sortEditsByYieldTo } from './edit.js';\nimport { PostEditWidgetManager } from './postEditWidget.js';\nexport const defaultProviderConfig = 'editor.experimental.dropIntoEditor.defaultProvider';\nexport const changeDropTypeCommandId = 'editor.changeDropType';\nexport const dropWidgetVisibleCtx = new RawContextKey('dropWidgetVisible', false, localize('dropWidgetVisible', \"Whether the drop widget is showing\"));\nlet DropIntoEditorController = DropIntoEditorController_1 = class DropIntoEditorController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(DropIntoEditorController_1.ID);\n    }\n    constructor(editor, instantiationService, _configService, _languageFeaturesService, _treeViewsDragAndDropService) {\n        super();\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._treeViewsDragAndDropService = _treeViewsDragAndDropService;\n        this.treeItemsTransfer = LocalSelectionTransfer.getInstance();\n        this._dropProgressManager = this._register(instantiationService.createInstance(InlineProgressManager, 'dropIntoEditor', editor));\n        this._postDropWidgetManager = this._register(instantiationService.createInstance(PostEditWidgetManager, 'dropIntoEditor', editor, dropWidgetVisibleCtx, { id: changeDropTypeCommandId, label: localize('postDropWidgetTitle', \"Show drop options...\") }));\n        this._register(editor.onDropIntoEditor(e => this.onDropIntoEditor(editor, e.position, e.event)));\n    }\n    changeDropType() {\n        this._postDropWidgetManager.tryShowSelector();\n    }\n    async onDropIntoEditor(editor, position, dragEvent) {\n        var _a;\n        if (!dragEvent.dataTransfer || !editor.hasModel()) {\n            return;\n        }\n        (_a = this._currentOperation) === null || _a === void 0 ? void 0 : _a.cancel();\n        editor.focus();\n        editor.setPosition(position);\n        const p = createCancelablePromise(async (token) => {\n            const tokenSource = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */, undefined, token);\n            try {\n                const ourDataTransfer = await this.extractDataTransferData(dragEvent);\n                if (ourDataTransfer.size === 0 || tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                const model = editor.getModel();\n                if (!model) {\n                    return;\n                }\n                const providers = this._languageFeaturesService.documentOnDropEditProvider\n                    .ordered(model)\n                    .filter(provider => {\n                    if (!provider.dropMimeTypes) {\n                        // Keep all providers that don't specify mime types\n                        return true;\n                    }\n                    return provider.dropMimeTypes.some(mime => ourDataTransfer.matches(mime));\n                });\n                const edits = await this.getDropEdits(providers, model, position, ourDataTransfer, tokenSource);\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                if (edits.length) {\n                    const activeEditIndex = this.getInitialActiveEditIndex(model, edits);\n                    const canShowWidget = editor.getOption(36 /* EditorOption.dropIntoEditor */).showDropSelector === 'afterDrop';\n                    // Pass in the parent token here as it tracks cancelling the entire drop operation\n                    await this._postDropWidgetManager.applyEditAndShowIfNeeded([Range.fromPositions(position)], { activeEditIndex, allEdits: edits }, canShowWidget, token);\n                }\n            }\n            finally {\n                tokenSource.dispose();\n                if (this._currentOperation === p) {\n                    this._currentOperation = undefined;\n                }\n            }\n        });\n        this._dropProgressManager.showWhile(position, localize('dropIntoEditorProgress', \"Running drop handlers. Click to cancel\"), p);\n        this._currentOperation = p;\n    }\n    async getDropEdits(providers, model, position, dataTransfer, tokenSource) {\n        const results = await raceCancellation(Promise.all(providers.map(async (provider) => {\n            try {\n                const edit = await provider.provideDocumentOnDropEdits(model, position, dataTransfer, tokenSource.token);\n                if (edit) {\n                    return { ...edit, providerId: provider.id };\n                }\n            }\n            catch (err) {\n                console.error(err);\n            }\n            return undefined;\n        })), tokenSource.token);\n        const edits = coalesce(results !== null && results !== void 0 ? results : []);\n        return sortEditsByYieldTo(edits);\n    }\n    getInitialActiveEditIndex(model, edits) {\n        const preferredProviders = this._configService.getValue(defaultProviderConfig, { resource: model.uri });\n        for (const [configMime, desiredId] of Object.entries(preferredProviders)) {\n            const editIndex = edits.findIndex(edit => desiredId === edit.providerId\n                && edit.handledMimeType && matchesMimeType(configMime, [edit.handledMimeType]));\n            if (editIndex >= 0) {\n                return editIndex;\n            }\n        }\n        return 0;\n    }\n    async extractDataTransferData(dragEvent) {\n        if (!dragEvent.dataTransfer) {\n            return new VSDataTransfer();\n        }\n        const dataTransfer = toExternalVSDataTransfer(dragEvent.dataTransfer);\n        if (this.treeItemsTransfer.hasData(DraggedTreeItemsIdentifier.prototype)) {\n            const data = this.treeItemsTransfer.getData(DraggedTreeItemsIdentifier.prototype);\n            if (Array.isArray(data)) {\n                for (const id of data) {\n                    const treeDataTransfer = await this._treeViewsDragAndDropService.removeDragOperationTransfer(id.identifier);\n                    if (treeDataTransfer) {\n                        for (const [type, value] of treeDataTransfer) {\n                            dataTransfer.replace(type, value);\n                        }\n                    }\n                }\n            }\n        }\n        return dataTransfer;\n    }\n};\nDropIntoEditorController.ID = 'editor.contrib.dropIntoEditorController';\nDropIntoEditorController = DropIntoEditorController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IConfigurationService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ITreeViewsDnDService)\n], DropIntoEditorController);\nexport { DropIntoEditorController };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class TreeViewsDnDService {\n    constructor() {\n        this._dragOperations = new Map();\n    }\n    removeDragOperationTransfer(uuid) {\n        if ((uuid && this._dragOperations.has(uuid))) {\n            const operation = this._dragOperations.get(uuid);\n            this._dragOperations.delete(uuid);\n            return operation;\n        }\n        return undefined;\n    }\n}\nexport class DraggedTreeItemsIdentifier {\n    constructor(identifier) {\n        this.identifier = identifier;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { TreeViewsDnDService } from './treeViewsDnd.js';\nexport const ITreeViewsDnDService = createDecorator('treeViewsDndService');\nregisterSingleton(ITreeViewsDnDService, TreeViewsDnDService, 1 /* InstantiationType.Delayed */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CommonFindController_1;\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand, MultiEditorAction, registerEditorAction, registerEditorCommand, registerEditorContribution, registerMultiEditorAction } from '../../../browser/editorExtensions.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, CONTEXT_REPLACE_INPUT_FOCUSED, FindModelBoundToEditorModel, FIND_IDS, ToggleCaseSensitiveKeybinding, TogglePreserveCaseKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding } from './findModel.js';\nimport { FindOptionsWidget } from './findOptionsWidget.js';\nimport { FindReplaceState } from './findState.js';\nimport { FindWidget } from './findWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { IThemeService, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst SEARCH_STRING_MAX_LENGTH = 524288;\nexport function getSelectionSearchString(editor, seedSearchStringFromSelection = 'single', seedSearchStringFromNonEmptySelection = false) {\n    if (!editor.hasModel()) {\n        return null;\n    }\n    const selection = editor.getSelection();\n    // if selection spans multiple lines, default search string to empty\n    if ((seedSearchStringFromSelection === 'single' && selection.startLineNumber === selection.endLineNumber)\n        || seedSearchStringFromSelection === 'multiple') {\n        if (selection.isEmpty()) {\n            const wordAtPosition = editor.getConfiguredWordAtPosition(selection.getStartPosition());\n            if (wordAtPosition && (false === seedSearchStringFromNonEmptySelection)) {\n                return wordAtPosition.word;\n            }\n        }\n        else {\n            if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\n                return editor.getModel().getValueInRange(selection);\n            }\n        }\n    }\n    return null;\n}\nlet CommonFindController = CommonFindController_1 = class CommonFindController extends Disposable {\n    get editor() {\n        return this._editor;\n    }\n    static get(editor) {\n        return editor.getContribution(CommonFindController_1.ID);\n    }\n    constructor(editor, contextKeyService, storageService, clipboardService, notificationService) {\n        super();\n        this._editor = editor;\n        this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\n        this._contextKeyService = contextKeyService;\n        this._storageService = storageService;\n        this._clipboardService = clipboardService;\n        this._notificationService = notificationService;\n        this._updateHistoryDelayer = new Delayer(500);\n        this._state = this._register(new FindReplaceState());\n        this.loadQueryState();\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this._model = null;\n        this._register(this._editor.onDidChangeModel(() => {\n            const shouldRestartFind = (this._editor.getModel() && this._state.isRevealed);\n            this.disposeModel();\n            this._state.change({\n                searchScope: null,\n                matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, false),\n                wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, false),\n                isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, false),\n                preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, false)\n            }, false);\n            if (shouldRestartFind) {\n                this._start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: 'none',\n                    seedSearchStringFromNonEmptySelection: false,\n                    seedSearchStringFromGlobalClipboard: false,\n                    shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                    shouldAnimate: false,\n                    updateSearchScope: false,\n                    loop: this._editor.getOption(41 /* EditorOption.find */).loop\n                });\n            }\n        }));\n    }\n    dispose() {\n        this.disposeModel();\n        super.dispose();\n    }\n    disposeModel() {\n        if (this._model) {\n            this._model.dispose();\n            this._model = null;\n        }\n    }\n    _onStateChanged(e) {\n        this.saveQueryState(e);\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._findWidgetVisible.set(true);\n            }\n            else {\n                this._findWidgetVisible.reset();\n                this.disposeModel();\n            }\n        }\n        if (e.searchString) {\n            this.setGlobalBufferTerm(this._state.searchString);\n        }\n    }\n    saveQueryState(e) {\n        if (e.isRegex) {\n            this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.wholeWord) {\n            this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.matchCase) {\n            this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.preserveCase) {\n            this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n    loadQueryState() {\n        this._state.change({\n            matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, this._state.matchCase),\n            wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, this._state.wholeWord),\n            isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, this._state.isRegex),\n            preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, this._state.preserveCase)\n        }, false);\n    }\n    isFindInputFocused() {\n        return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\n    }\n    getState() {\n        return this._state;\n    }\n    closeFindWidget() {\n        this._state.change({\n            isRevealed: false,\n            searchScope: null\n        }, false);\n        this._editor.focus();\n    }\n    toggleCaseSensitive() {\n        this._state.change({ matchCase: !this._state.matchCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleWholeWords() {\n        this._state.change({ wholeWord: !this._state.wholeWord }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleRegex() {\n        this._state.change({ isRegex: !this._state.isRegex }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    togglePreserveCase() {\n        this._state.change({ preserveCase: !this._state.preserveCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleSearchScope() {\n        if (this._state.searchScope) {\n            this._state.change({ searchScope: null }, true);\n        }\n        else {\n            if (this._editor.hasModel()) {\n                let selections = this._editor.getSelections();\n                selections = selections.map(selection => {\n                    if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                        selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                    }\n                    if (!selection.isEmpty()) {\n                        return selection;\n                    }\n                    return null;\n                }).filter((element) => !!element);\n                if (selections.length) {\n                    this._state.change({ searchScope: selections }, true);\n                }\n            }\n        }\n    }\n    setSearchString(searchString) {\n        if (this._state.isRegex) {\n            searchString = strings.escapeRegExpCharacters(searchString);\n        }\n        this._state.change({ searchString: searchString }, false);\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        // overwritten in subclass\n    }\n    async _start(opts, newState) {\n        this.disposeModel();\n        if (!this._editor.hasModel()) {\n            // cannot do anything with an editor that doesn't have a model...\n            return;\n        }\n        const stateChanges = {\n            ...newState,\n            isRevealed: true\n        };\n        if (opts.seedSearchStringFromSelection === 'single') {\n            const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection, opts.seedSearchStringFromNonEmptySelection);\n            if (selectionSearchString) {\n                if (this._state.isRegex) {\n                    stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\n                }\n                else {\n                    stateChanges.searchString = selectionSearchString;\n                }\n            }\n        }\n        else if (opts.seedSearchStringFromSelection === 'multiple' && !opts.updateSearchScope) {\n            const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection);\n            if (selectionSearchString) {\n                stateChanges.searchString = selectionSearchString;\n            }\n        }\n        if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\n            const selectionSearchString = await this.getGlobalBufferTerm();\n            if (!this._editor.hasModel()) {\n                // the editor has lost its model in the meantime\n                return;\n            }\n            if (selectionSearchString) {\n                stateChanges.searchString = selectionSearchString;\n            }\n        }\n        // Overwrite isReplaceRevealed\n        if (opts.forceRevealReplace || stateChanges.isReplaceRevealed) {\n            stateChanges.isReplaceRevealed = true;\n        }\n        else if (!this._findWidgetVisible.get()) {\n            stateChanges.isReplaceRevealed = false;\n        }\n        if (opts.updateSearchScope) {\n            const currentSelections = this._editor.getSelections();\n            if (currentSelections.some(selection => !selection.isEmpty())) {\n                stateChanges.searchScope = currentSelections;\n            }\n        }\n        stateChanges.loop = opts.loop;\n        this._state.change(stateChanges, false);\n        if (!this._model) {\n            this._model = new FindModelBoundToEditorModel(this._editor, this._state);\n        }\n    }\n    start(opts, newState) {\n        return this._start(opts, newState);\n    }\n    moveToNextMatch() {\n        if (this._model) {\n            this._model.moveToNextMatch();\n            return true;\n        }\n        return false;\n    }\n    moveToPrevMatch() {\n        if (this._model) {\n            this._model.moveToPrevMatch();\n            return true;\n        }\n        return false;\n    }\n    goToMatch(index) {\n        if (this._model) {\n            this._model.moveToMatch(index);\n            return true;\n        }\n        return false;\n    }\n    replace() {\n        if (this._model) {\n            this._model.replace();\n            return true;\n        }\n        return false;\n    }\n    replaceAll() {\n        var _a;\n        if (this._model) {\n            if ((_a = this._editor.getModel()) === null || _a === void 0 ? void 0 : _a.isTooLargeForHeapOperation()) {\n                this._notificationService.warn(nls.localize('too.large.for.replaceall', \"The file is too large to perform a replace all operation.\"));\n                return false;\n            }\n            this._model.replaceAll();\n            return true;\n        }\n        return false;\n    }\n    selectAllMatches() {\n        if (this._model) {\n            this._model.selectAllMatches();\n            this._editor.focus();\n            return true;\n        }\n        return false;\n    }\n    async getGlobalBufferTerm() {\n        if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard\n            && this._editor.hasModel()\n            && !this._editor.getModel().isTooLargeForSyncing()) {\n            return this._clipboardService.readFindText();\n        }\n        return '';\n    }\n    setGlobalBufferTerm(text) {\n        if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard\n            && this._editor.hasModel()\n            && !this._editor.getModel().isTooLargeForSyncing()) {\n            // intentionally not awaited\n            this._clipboardService.writeFindText(text);\n        }\n    }\n};\nCommonFindController.ID = 'editor.contrib.findController';\nCommonFindController = CommonFindController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IStorageService),\n    __param(3, IClipboardService),\n    __param(4, INotificationService)\n], CommonFindController);\nexport { CommonFindController };\nlet FindController = class FindController extends CommonFindController {\n    constructor(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, notificationService, _storageService, clipboardService) {\n        super(editor, _contextKeyService, _storageService, clipboardService, notificationService);\n        this._contextViewService = _contextViewService;\n        this._keybindingService = _keybindingService;\n        this._themeService = _themeService;\n        this._widget = null;\n        this._findOptionsWidget = null;\n    }\n    async _start(opts, newState) {\n        if (!this._widget) {\n            this._createFindWidget();\n        }\n        const selection = this._editor.getSelection();\n        let updateSearchScope = false;\n        switch (this._editor.getOption(41 /* EditorOption.find */).autoFindInSelection) {\n            case 'always':\n                updateSearchScope = true;\n                break;\n            case 'never':\n                updateSearchScope = false;\n                break;\n            case 'multiline': {\n                const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n                updateSearchScope = isSelectionMultipleLine;\n                break;\n            }\n            default:\n                break;\n        }\n        opts.updateSearchScope = opts.updateSearchScope || updateSearchScope;\n        await super._start(opts, newState);\n        if (this._widget) {\n            if (opts.shouldFocus === 2 /* FindStartFocusAction.FocusReplaceInput */) {\n                this._widget.focusReplaceInput();\n            }\n            else if (opts.shouldFocus === 1 /* FindStartFocusAction.FocusFindInput */) {\n                this._widget.focusFindInput();\n            }\n        }\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        if (!this._widget) {\n            this._createFindWidget();\n        }\n        if (this._state.isRevealed && !ignoreWhenVisible) {\n            this._widget.highlightFindOptions();\n        }\n        else {\n            this._findOptionsWidget.highlightFindOptions();\n        }\n    }\n    _createFindWidget() {\n        this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\n        this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService));\n    }\n};\nFindController = __decorate([\n    __param(1, IContextViewService),\n    __param(2, IContextKeyService),\n    __param(3, IKeybindingService),\n    __param(4, IThemeService),\n    __param(5, INotificationService),\n    __param(6, IStorageService),\n    __param(7, IClipboardService)\n], FindController);\nexport { FindController };\nexport const StartFindAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindAction,\n    label: nls.localize('startFindAction', \"Find\"),\n    alias: 'Find',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miFind', comment: ['&& denotes a mnemonic'] }, \"&&Find\"),\n        order: 1\n    }\n}));\nStartFindAction.addImplementation(0, (accessor, editor, args) => {\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    return controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).globalFindClipboard,\n        shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n    });\n});\nconst findArgDescription = {\n    description: 'Open a new In-Editor Find Widget.',\n    args: [{\n            name: 'Open a new In-Editor Find Widget args',\n            schema: {\n                properties: {\n                    searchString: { type: 'string' },\n                    replaceString: { type: 'string' },\n                    isRegex: { type: 'boolean' },\n                    matchWholeWord: { type: 'boolean' },\n                    isCaseSensitive: { type: 'boolean' },\n                    preserveCase: { type: 'boolean' },\n                    findInSelection: { type: 'boolean' },\n                }\n            }\n        }]\n};\nexport class StartFindWithArgsAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithArgs,\n            label: nls.localize('startFindWithArgsAction', \"Find With Arguments\"),\n            alias: 'Find With Arguments',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: findArgDescription\n        });\n    }\n    async run(accessor, editor, args) {\n        const controller = CommonFindController.get(editor);\n        if (controller) {\n            const newState = args ? {\n                searchString: args.searchString,\n                replaceString: args.replaceString,\n                isReplaceRevealed: args.replaceString !== undefined,\n                isRegex: args.isRegex,\n                // isRegexOverride: args.regexOverride,\n                wholeWord: args.matchWholeWord,\n                // wholeWordOverride: args.wholeWordOverride,\n                matchCase: args.isCaseSensitive,\n                // matchCaseOverride: args.matchCaseOverride,\n                preserveCase: args.preserveCase,\n                // preserveCaseOverride: args.preserveCaseOverride,\n            } : {};\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                seedSearchStringFromGlobalClipboard: true,\n                shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n                shouldAnimate: true,\n                updateSearchScope: (args === null || args === void 0 ? void 0 : args.findInSelection) || false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            }, newState);\n            controller.setGlobalBufferTerm(controller.getState().searchString);\n        }\n    }\n}\nexport class StartFindWithSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithSelection,\n            label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\n            alias: 'Find With Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 35 /* KeyCode.KeyE */,\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (controller) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: 'multiple',\n                seedSearchStringFromNonEmptySelection: false,\n                seedSearchStringFromGlobalClipboard: false,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            controller.setGlobalBufferTerm(controller.getState().searchString);\n        }\n    }\n}\nexport class MatchFindAction extends EditorAction {\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (controller && !this._run(controller)) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                seedSearchStringFromGlobalClipboard: true,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            this._run(controller);\n        }\n    }\n}\nexport class NextMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextMatchFindAction,\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\n            alias: 'Find Next',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 37 /* KeyCode.KeyG */, secondary: [61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }]\n        });\n    }\n    _run(controller) {\n        const result = controller.moveToNextMatch();\n        if (result) {\n            controller.editor.pushUndoStop();\n            return true;\n        }\n        return false;\n    }\n}\nexport class PreviousMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousMatchFindAction,\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\n            alias: 'Find Previous',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 37 /* KeyCode.KeyG */, secondary: [1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            ]\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport class MoveToMatchFindAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.GoToMatchFindAction,\n            label: nls.localize('findMatchAction.goToMatch', \"Go to Match...\"),\n            alias: 'Go to Match...',\n            precondition: CONTEXT_FIND_WIDGET_VISIBLE\n        });\n        this._highlightDecorations = [];\n    }\n    run(accessor, editor, args) {\n        const controller = CommonFindController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const matchesCount = controller.getState().matchesCount;\n        if (matchesCount < 1) {\n            const notificationService = accessor.get(INotificationService);\n            notificationService.notify({\n                severity: Severity.Warning,\n                message: nls.localize('findMatchAction.noResults', \"No matches. Try searching for something else.\")\n            });\n            return;\n        }\n        const quickInputService = accessor.get(IQuickInputService);\n        const inputBox = quickInputService.createInputBox();\n        inputBox.placeholder = nls.localize('findMatchAction.inputPlaceHolder', \"Type a number to go to a specific match (between 1 and {0})\", matchesCount);\n        const toFindMatchIndex = (value) => {\n            const index = parseInt(value);\n            if (isNaN(index)) {\n                return undefined;\n            }\n            const matchCount = controller.getState().matchesCount;\n            if (index > 0 && index <= matchCount) {\n                return index - 1; // zero based\n            }\n            else if (index < 0 && index >= -matchCount) {\n                return matchCount + index;\n            }\n            return undefined;\n        };\n        const updatePickerAndEditor = (value) => {\n            const index = toFindMatchIndex(value);\n            if (typeof index === 'number') {\n                // valid\n                inputBox.validationMessage = undefined;\n                controller.goToMatch(index);\n                const currentMatch = controller.getState().currentMatch;\n                if (currentMatch) {\n                    this.addDecorations(editor, currentMatch);\n                }\n            }\n            else {\n                inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n                this.clearDecorations(editor);\n            }\n        };\n        inputBox.onDidChangeValue(value => {\n            updatePickerAndEditor(value);\n        });\n        inputBox.onDidAccept(() => {\n            const index = toFindMatchIndex(inputBox.value);\n            if (typeof index === 'number') {\n                controller.goToMatch(index);\n                inputBox.hide();\n            }\n            else {\n                inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n            }\n        });\n        inputBox.onDidHide(() => {\n            this.clearDecorations(editor);\n            inputBox.dispose();\n        });\n        inputBox.show();\n    }\n    clearDecorations(editor) {\n        editor.changeDecorations(changeAccessor => {\n            this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, []);\n        });\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, [\n                {\n                    range,\n                    options: {\n                        description: 'find-match-quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                {\n                    range,\n                    options: {\n                        description: 'find-match-quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ]);\n        });\n    }\n}\nexport class SelectionMatchFindAction extends EditorAction {\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const selectionSearchString = getSelectionSearchString(editor, 'single', false);\n        if (selectionSearchString) {\n            controller.setSearchString(selectionSearchString);\n        }\n        if (!this._run(controller)) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: 'none',\n                seedSearchStringFromNonEmptySelection: false,\n                seedSearchStringFromGlobalClipboard: false,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            this._run(controller);\n        }\n    }\n}\nexport class NextSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextSelectionMatchFindAction,\n            label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\n            alias: 'Find Next Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToNextMatch();\n    }\n}\nexport class PreviousSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousSelectionMatchFindAction,\n            label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\n            alias: 'Find Previous Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport const StartFindReplaceAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindReplaceAction,\n    label: nls.localize('startReplace', \"Replace\"),\n    alias: 'Replace',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 38 /* KeyCode.KeyH */,\n        mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */ },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miReplace', comment: ['&& denotes a mnemonic'] }, \"&&Replace\"),\n        order: 2\n    }\n}));\nStartFindReplaceAction.addImplementation(0, (accessor, editor, args) => {\n    if (!editor.hasModel() || editor.getOption(91 /* EditorOption.readOnly */)) {\n        return false;\n    }\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    const currentSelection = editor.getSelection();\n    const findInputFocused = controller.isFindInputFocused();\n    // we only seed search string from selection when the current selection is single line and not empty,\n    // + the find input is not focused\n    const seedSearchStringFromSelection = !currentSelection.isEmpty()\n        && currentSelection.startLineNumber === currentSelection.endLineNumber\n        && (editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never')\n        && !findInputFocused;\n    /*\n    * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\n\n    * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\n    * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\n    * findInputFocused false seedSearchStringFromSelection false FocusFindInput\n    */\n    const shouldFocus = (findInputFocused || seedSearchStringFromSelection) ?\n        2 /* FindStartFocusAction.FocusReplaceInput */ : 1 /* FindStartFocusAction.FocusFindInput */;\n    return controller.start({\n        forceRevealReplace: true,\n        seedSearchStringFromSelection: seedSearchStringFromSelection ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never',\n        shouldFocus: shouldFocus,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n    });\n});\nregisterEditorContribution(CommonFindController.ID, FindController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(StartFindWithArgsAction);\nregisterEditorAction(StartFindWithSelectionAction);\nregisterEditorAction(NextMatchFindAction);\nregisterEditorAction(PreviousMatchFindAction);\nregisterEditorAction(MoveToMatchFindAction);\nregisterEditorAction(NextSelectionMatchFindAction);\nregisterEditorAction(PreviousSelectionMatchFindAction);\nconst FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.CloseFindWidgetCommand,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.closeFindWidget(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleCaseSensitiveCommand,\n    precondition: undefined,\n    handler: x => x.toggleCaseSensitive(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleCaseSensitiveKeybinding.primary,\n        mac: ToggleCaseSensitiveKeybinding.mac,\n        win: ToggleCaseSensitiveKeybinding.win,\n        linux: ToggleCaseSensitiveKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleWholeWordCommand,\n    precondition: undefined,\n    handler: x => x.toggleWholeWords(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleWholeWordKeybinding.primary,\n        mac: ToggleWholeWordKeybinding.mac,\n        win: ToggleWholeWordKeybinding.win,\n        linux: ToggleWholeWordKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleRegexCommand,\n    precondition: undefined,\n    handler: x => x.toggleRegex(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleRegexKeybinding.primary,\n        mac: ToggleRegexKeybinding.mac,\n        win: ToggleRegexKeybinding.win,\n        linux: ToggleRegexKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleSearchScopeCommand,\n    precondition: undefined,\n    handler: x => x.toggleSearchScope(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleSearchScopeKeybinding.primary,\n        mac: ToggleSearchScopeKeybinding.mac,\n        win: ToggleSearchScopeKeybinding.win,\n        linux: ToggleSearchScopeKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.TogglePreserveCaseCommand,\n    precondition: undefined,\n    handler: x => x.togglePreserveCase(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: TogglePreserveCaseKeybinding.primary,\n        mac: TogglePreserveCaseKeybinding.mac,\n        win: TogglePreserveCaseKeybinding.win,\n        linux: TogglePreserveCaseKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 22 /* KeyCode.Digit1 */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: undefined,\n        mac: {\n            primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n        }\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.SelectAllMatchesAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.selectAllMatches(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstIdxMonotonousOrArrLen } from '../../../../base/common/arraysFind.js';\nimport { RunOnceScheduler, TimeoutTimer } from '../../../../base/common/async.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection } from '../../../common/commands/replaceCommand.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { SearchParams } from '../../../common/model/textModelSearch.js';\nimport { FindDecorations } from './findDecorations.js';\nimport { ReplaceAllCommand } from './replaceAllCommand.js';\nimport { parseReplaceString, ReplacePattern } from './replacePattern.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const CONTEXT_FIND_WIDGET_VISIBLE = new RawContextKey('findWidgetVisible', false);\nexport const CONTEXT_FIND_WIDGET_NOT_VISIBLE = CONTEXT_FIND_WIDGET_VISIBLE.toNegated();\n// Keep ContextKey use of 'Focussed' to not break when clauses\nexport const CONTEXT_FIND_INPUT_FOCUSED = new RawContextKey('findInputFocussed', false);\nexport const CONTEXT_REPLACE_INPUT_FOCUSED = new RawContextKey('replaceInputFocussed', false);\nexport const ToggleCaseSensitiveKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 33 /* KeyCode.KeyC */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 33 /* KeyCode.KeyC */ }\n};\nexport const ToggleWholeWordKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 53 /* KeyCode.KeyW */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 53 /* KeyCode.KeyW */ }\n};\nexport const ToggleRegexKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 48 /* KeyCode.KeyR */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 48 /* KeyCode.KeyR */ }\n};\nexport const ToggleSearchScopeKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 42 /* KeyCode.KeyL */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 42 /* KeyCode.KeyL */ }\n};\nexport const TogglePreserveCaseKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 46 /* KeyCode.KeyP */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 46 /* KeyCode.KeyP */ }\n};\nexport const FIND_IDS = {\n    StartFindAction: 'actions.find',\n    StartFindWithSelection: 'actions.findWithSelection',\n    StartFindWithArgs: 'editor.actions.findWithArgs',\n    NextMatchFindAction: 'editor.action.nextMatchFindAction',\n    PreviousMatchFindAction: 'editor.action.previousMatchFindAction',\n    GoToMatchFindAction: 'editor.action.goToMatchFindAction',\n    NextSelectionMatchFindAction: 'editor.action.nextSelectionMatchFindAction',\n    PreviousSelectionMatchFindAction: 'editor.action.previousSelectionMatchFindAction',\n    StartFindReplaceAction: 'editor.action.startFindReplaceAction',\n    CloseFindWidgetCommand: 'closeFindWidget',\n    ToggleCaseSensitiveCommand: 'toggleFindCaseSensitive',\n    ToggleWholeWordCommand: 'toggleFindWholeWord',\n    ToggleRegexCommand: 'toggleFindRegex',\n    ToggleSearchScopeCommand: 'toggleFindInSelection',\n    TogglePreserveCaseCommand: 'togglePreserveCase',\n    ReplaceOneAction: 'editor.action.replaceOne',\n    ReplaceAllAction: 'editor.action.replaceAll',\n    SelectAllMatchesAction: 'editor.action.selectAllMatches'\n};\nexport const MATCHES_LIMIT = 19999;\nconst RESEARCH_DELAY = 240;\nexport class FindModelBoundToEditorModel {\n    constructor(editor, state) {\n        this._toDispose = new DisposableStore();\n        this._editor = editor;\n        this._state = state;\n        this._isDisposed = false;\n        this._startSearchingTimer = new TimeoutTimer();\n        this._decorations = new FindDecorations(editor);\n        this._toDispose.add(this._decorations);\n        this._updateDecorationsScheduler = new RunOnceScheduler(() => this.research(false), 100);\n        this._toDispose.add(this._updateDecorationsScheduler);\n        this._toDispose.add(this._editor.onDidChangeCursorPosition((e) => {\n            if (e.reason === 3 /* CursorChangeReason.Explicit */\n                || e.reason === 5 /* CursorChangeReason.Undo */\n                || e.reason === 6 /* CursorChangeReason.Redo */) {\n                this._decorations.setStartPosition(this._editor.getPosition());\n            }\n        }));\n        this._ignoreModelContentChanged = false;\n        this._toDispose.add(this._editor.onDidChangeModelContent((e) => {\n            if (this._ignoreModelContentChanged) {\n                return;\n            }\n            if (e.isFlush) {\n                // a model.setValue() was called\n                this._decorations.reset();\n            }\n            this._decorations.setStartPosition(this._editor.getPosition());\n            this._updateDecorationsScheduler.schedule();\n        }));\n        this._toDispose.add(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this.research(false, this._state.searchScope);\n    }\n    dispose() {\n        this._isDisposed = true;\n        dispose(this._startSearchingTimer);\n        this._toDispose.dispose();\n    }\n    _onStateChanged(e) {\n        if (this._isDisposed) {\n            // The find model is disposed during a find state changed event\n            return;\n        }\n        if (!this._editor.hasModel()) {\n            // The find model will be disposed momentarily\n            return;\n        }\n        if (e.searchString || e.isReplaceRevealed || e.isRegex || e.wholeWord || e.matchCase || e.searchScope) {\n            const model = this._editor.getModel();\n            if (model.isTooLargeForSyncing()) {\n                this._startSearchingTimer.cancel();\n                this._startSearchingTimer.setIfNotSet(() => {\n                    if (e.searchScope) {\n                        this.research(e.moveCursor, this._state.searchScope);\n                    }\n                    else {\n                        this.research(e.moveCursor);\n                    }\n                }, RESEARCH_DELAY);\n            }\n            else {\n                if (e.searchScope) {\n                    this.research(e.moveCursor, this._state.searchScope);\n                }\n                else {\n                    this.research(e.moveCursor);\n                }\n            }\n        }\n    }\n    static _getSearchRange(model, findScope) {\n        // If we have set now or before a find scope, use it for computing the search range\n        if (findScope) {\n            return findScope;\n        }\n        return model.getFullModelRange();\n    }\n    research(moveCursor, newFindScope) {\n        let findScopes = null;\n        if (typeof newFindScope !== 'undefined') {\n            if (newFindScope !== null) {\n                if (!Array.isArray(newFindScope)) {\n                    findScopes = [newFindScope];\n                }\n                else {\n                    findScopes = newFindScope;\n                }\n            }\n        }\n        else {\n            findScopes = this._decorations.getFindScopes();\n        }\n        if (findScopes !== null) {\n            findScopes = findScopes.map(findScope => {\n                if (findScope.startLineNumber !== findScope.endLineNumber) {\n                    let endLineNumber = findScope.endLineNumber;\n                    if (findScope.endColumn === 1) {\n                        endLineNumber = endLineNumber - 1;\n                    }\n                    return new Range(findScope.startLineNumber, 1, endLineNumber, this._editor.getModel().getLineMaxColumn(endLineNumber));\n                }\n                return findScope;\n            });\n        }\n        const findMatches = this._findMatches(findScopes, false, MATCHES_LIMIT);\n        this._decorations.set(findMatches, findScopes);\n        const editorSelection = this._editor.getSelection();\n        let currentMatchesPosition = this._decorations.getCurrentMatchesPosition(editorSelection);\n        if (currentMatchesPosition === 0 && findMatches.length > 0) {\n            // current selection is not on top of a match\n            // try to find its nearest result from the top of the document\n            const matchAfterSelection = findFirstIdxMonotonousOrArrLen(findMatches.map(match => match.range), range => Range.compareRangesUsingStarts(range, editorSelection) >= 0);\n            currentMatchesPosition = matchAfterSelection > 0 ? matchAfterSelection - 1 + 1 /** match position is one based */ : currentMatchesPosition;\n        }\n        this._state.changeMatchInfo(currentMatchesPosition, this._decorations.getCount(), undefined);\n        if (moveCursor && this._editor.getOption(41 /* EditorOption.find */).cursorMoveOnType) {\n            this._moveToNextMatch(this._decorations.getStartPosition());\n        }\n    }\n    _hasMatches() {\n        return (this._state.matchesCount > 0);\n    }\n    _cannotFind() {\n        if (!this._hasMatches()) {\n            const findScope = this._decorations.getFindScope();\n            if (findScope) {\n                // Reveal the selection so user is reminded that 'selection find' is on.\n                this._editor.revealRangeInCenterIfOutsideViewport(findScope, 0 /* ScrollType.Smooth */);\n            }\n            return true;\n        }\n        return false;\n    }\n    _setCurrentFindMatch(match) {\n        const matchesPosition = this._decorations.setCurrentFindMatch(match);\n        this._state.changeMatchInfo(matchesPosition, this._decorations.getCount(), match);\n        this._editor.setSelection(match);\n        this._editor.revealRangeInCenterIfOutsideViewport(match, 0 /* ScrollType.Smooth */);\n    }\n    _prevSearchPosition(before) {\n        const isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\n            || this._state.searchString.indexOf('$') >= 0);\n        let { lineNumber, column } = before;\n        const model = this._editor.getModel();\n        if (isUsingLineStops || column === 1) {\n            if (lineNumber === 1) {\n                lineNumber = model.getLineCount();\n            }\n            else {\n                lineNumber--;\n            }\n            column = model.getLineMaxColumn(lineNumber);\n        }\n        else {\n            column--;\n        }\n        return new Position(lineNumber, column);\n    }\n    _moveToPrevMatch(before, isRecursed = false) {\n        if (!this._state.canNavigateBack()) {\n            // we are beyond the first matched find result\n            // instead of doing nothing, we should refocus the first item\n            const nextMatchRange = this._decorations.matchAfterPosition(before);\n            if (nextMatchRange) {\n                this._setCurrentFindMatch(nextMatchRange);\n            }\n            return;\n        }\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\n            let prevMatchRange = this._decorations.matchBeforePosition(before);\n            if (prevMatchRange && prevMatchRange.isEmpty() && prevMatchRange.getStartPosition().equals(before)) {\n                before = this._prevSearchPosition(before);\n                prevMatchRange = this._decorations.matchBeforePosition(before);\n            }\n            if (prevMatchRange) {\n                this._setCurrentFindMatch(prevMatchRange);\n            }\n            return;\n        }\n        if (this._cannotFind()) {\n            return;\n        }\n        const findScope = this._decorations.getFindScope();\n        const searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\n        // ...(----)...|...\n        if (searchRange.getEndPosition().isBefore(before)) {\n            before = searchRange.getEndPosition();\n        }\n        // ...|...(----)...\n        if (before.isBefore(searchRange.getStartPosition())) {\n            before = searchRange.getEndPosition();\n        }\n        const { lineNumber, column } = before;\n        const model = this._editor.getModel();\n        let position = new Position(lineNumber, column);\n        let prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false);\n        if (prevMatch && prevMatch.range.isEmpty() && prevMatch.range.getStartPosition().equals(position)) {\n            // Looks like we're stuck at this position, unacceptable!\n            position = this._prevSearchPosition(position);\n            prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false);\n        }\n        if (!prevMatch) {\n            // there is precisely one match and selection is on top of it\n            return;\n        }\n        if (!isRecursed && !searchRange.containsRange(prevMatch.range)) {\n            return this._moveToPrevMatch(prevMatch.range.getStartPosition(), true);\n        }\n        this._setCurrentFindMatch(prevMatch.range);\n    }\n    moveToPrevMatch() {\n        this._moveToPrevMatch(this._editor.getSelection().getStartPosition());\n    }\n    _nextSearchPosition(after) {\n        const isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\n            || this._state.searchString.indexOf('$') >= 0);\n        let { lineNumber, column } = after;\n        const model = this._editor.getModel();\n        if (isUsingLineStops || column === model.getLineMaxColumn(lineNumber)) {\n            if (lineNumber === model.getLineCount()) {\n                lineNumber = 1;\n            }\n            else {\n                lineNumber++;\n            }\n            column = 1;\n        }\n        else {\n            column++;\n        }\n        return new Position(lineNumber, column);\n    }\n    _moveToNextMatch(after) {\n        if (!this._state.canNavigateForward()) {\n            // we are beyond the last matched find result\n            // instead of doing nothing, we should refocus the last item\n            const prevMatchRange = this._decorations.matchBeforePosition(after);\n            if (prevMatchRange) {\n                this._setCurrentFindMatch(prevMatchRange);\n            }\n            return;\n        }\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\n            let nextMatchRange = this._decorations.matchAfterPosition(after);\n            if (nextMatchRange && nextMatchRange.isEmpty() && nextMatchRange.getStartPosition().equals(after)) {\n                // Looks like we're stuck at this position, unacceptable!\n                after = this._nextSearchPosition(after);\n                nextMatchRange = this._decorations.matchAfterPosition(after);\n            }\n            if (nextMatchRange) {\n                this._setCurrentFindMatch(nextMatchRange);\n            }\n            return;\n        }\n        const nextMatch = this._getNextMatch(after, false, true);\n        if (nextMatch) {\n            this._setCurrentFindMatch(nextMatch.range);\n        }\n    }\n    _getNextMatch(after, captureMatches, forceMove, isRecursed = false) {\n        if (this._cannotFind()) {\n            return null;\n        }\n        const findScope = this._decorations.getFindScope();\n        const searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\n        // ...(----)...|...\n        if (searchRange.getEndPosition().isBefore(after)) {\n            after = searchRange.getStartPosition();\n        }\n        // ...|...(----)...\n        if (after.isBefore(searchRange.getStartPosition())) {\n            after = searchRange.getStartPosition();\n        }\n        const { lineNumber, column } = after;\n        const model = this._editor.getModel();\n        let position = new Position(lineNumber, column);\n        let nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, captureMatches);\n        if (forceMove && nextMatch && nextMatch.range.isEmpty() && nextMatch.range.getStartPosition().equals(position)) {\n            // Looks like we're stuck at this position, unacceptable!\n            position = this._nextSearchPosition(position);\n            nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, captureMatches);\n        }\n        if (!nextMatch) {\n            // there is precisely one match and selection is on top of it\n            return null;\n        }\n        if (!isRecursed && !searchRange.containsRange(nextMatch.range)) {\n            return this._getNextMatch(nextMatch.range.getEndPosition(), captureMatches, forceMove, true);\n        }\n        return nextMatch;\n    }\n    moveToNextMatch() {\n        this._moveToNextMatch(this._editor.getSelection().getEndPosition());\n    }\n    _moveToMatch(index) {\n        const decorationRange = this._decorations.getDecorationRangeAt(index);\n        if (decorationRange) {\n            this._setCurrentFindMatch(decorationRange);\n        }\n    }\n    moveToMatch(index) {\n        this._moveToMatch(index);\n    }\n    _getReplacePattern() {\n        if (this._state.isRegex) {\n            return parseReplaceString(this._state.replaceString);\n        }\n        return ReplacePattern.fromStaticValue(this._state.replaceString);\n    }\n    replace() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const replacePattern = this._getReplacePattern();\n        const selection = this._editor.getSelection();\n        const nextMatch = this._getNextMatch(selection.getStartPosition(), true, false);\n        if (nextMatch) {\n            if (selection.equalsRange(nextMatch.range)) {\n                // selection sits on a find match => replace it!\n                const replaceString = replacePattern.buildReplaceString(nextMatch.matches, this._state.preserveCase);\n                const command = new ReplaceCommand(selection, replaceString);\n                this._executeEditorCommand('replace', command);\n                this._decorations.setStartPosition(new Position(selection.startLineNumber, selection.startColumn + replaceString.length));\n                this.research(true);\n            }\n            else {\n                this._decorations.setStartPosition(this._editor.getPosition());\n                this._setCurrentFindMatch(nextMatch.range);\n            }\n        }\n    }\n    _findMatches(findScopes, captureMatches, limitResultCount) {\n        const searchRanges = (findScopes || [null]).map((scope) => FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), scope));\n        return this._editor.getModel().findMatches(this._state.searchString, searchRanges, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, captureMatches, limitResultCount);\n    }\n    replaceAll() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const findScopes = this._decorations.getFindScopes();\n        if (findScopes === null && this._state.matchesCount >= MATCHES_LIMIT) {\n            // Doing a replace on the entire file that is over ${MATCHES_LIMIT} matches\n            this._largeReplaceAll();\n        }\n        else {\n            this._regularReplaceAll(findScopes);\n        }\n        this.research(false);\n    }\n    _largeReplaceAll() {\n        const searchParams = new SearchParams(this._state.searchString, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null);\n        const searchData = searchParams.parseSearchRequest();\n        if (!searchData) {\n            return;\n        }\n        let searchRegex = searchData.regex;\n        if (!searchRegex.multiline) {\n            let mod = 'mu';\n            if (searchRegex.ignoreCase) {\n                mod += 'i';\n            }\n            if (searchRegex.global) {\n                mod += 'g';\n            }\n            searchRegex = new RegExp(searchRegex.source, mod);\n        }\n        const model = this._editor.getModel();\n        const modelText = model.getValue(1 /* EndOfLinePreference.LF */);\n        const fullModelRange = model.getFullModelRange();\n        const replacePattern = this._getReplacePattern();\n        let resultText;\n        const preserveCase = this._state.preserveCase;\n        if (replacePattern.hasReplacementPatterns || preserveCase) {\n            resultText = modelText.replace(searchRegex, function () {\n                return replacePattern.buildReplaceString(arguments, preserveCase);\n            });\n        }\n        else {\n            resultText = modelText.replace(searchRegex, replacePattern.buildReplaceString(null, preserveCase));\n        }\n        const command = new ReplaceCommandThatPreservesSelection(fullModelRange, resultText, this._editor.getSelection());\n        this._executeEditorCommand('replaceAll', command);\n    }\n    _regularReplaceAll(findScopes) {\n        const replacePattern = this._getReplacePattern();\n        // Get all the ranges (even more than the highlighted ones)\n        const matches = this._findMatches(findScopes, replacePattern.hasReplacementPatterns || this._state.preserveCase, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const replaceStrings = [];\n        for (let i = 0, len = matches.length; i < len; i++) {\n            replaceStrings[i] = replacePattern.buildReplaceString(matches[i].matches, this._state.preserveCase);\n        }\n        const command = new ReplaceAllCommand(this._editor.getSelection(), matches.map(m => m.range), replaceStrings);\n        this._executeEditorCommand('replaceAll', command);\n    }\n    selectAllMatches() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const findScopes = this._decorations.getFindScopes();\n        // Get all the ranges (even more than the highlighted ones)\n        const matches = this._findMatches(findScopes, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        let selections = matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn));\n        // If one of the ranges is the editor selection, then maintain it as primary\n        const editorSelection = this._editor.getSelection();\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const sel = selections[i];\n            if (sel.equalsRange(editorSelection)) {\n                selections = [editorSelection].concat(selections.slice(0, i)).concat(selections.slice(i + 1));\n                break;\n            }\n        }\n        this._editor.setSelections(selections);\n    }\n    _executeEditorCommand(source, command) {\n        try {\n            this._ignoreModelContentChanged = true;\n            this._editor.pushUndoStop();\n            this._editor.executeCommand(source, command);\n            this._editor.pushUndoStop();\n        }\n        finally {\n            this._ignoreModelContentChanged = false;\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { MinimapPosition, OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { minimapFindMatch, overviewRulerFindMatchForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nexport class FindDecorations {\n    constructor(editor) {\n        this._editor = editor;\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n        this._startPosition = this._editor.getPosition();\n    }\n    dispose() {\n        this._editor.removeDecorations(this._allDecorations());\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n    }\n    reset() {\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n    }\n    getCount() {\n        return this._decorations.length;\n    }\n    /** @deprecated use getFindScopes to support multiple selections */\n    getFindScope() {\n        if (this._findScopeDecorationIds[0]) {\n            return this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]);\n        }\n        return null;\n    }\n    getFindScopes() {\n        if (this._findScopeDecorationIds.length) {\n            const scopes = this._findScopeDecorationIds.map(findScopeDecorationId => this._editor.getModel().getDecorationRange(findScopeDecorationId)).filter(element => !!element);\n            if (scopes.length) {\n                return scopes;\n            }\n        }\n        return null;\n    }\n    getStartPosition() {\n        return this._startPosition;\n    }\n    setStartPosition(newStartPosition) {\n        this._startPosition = newStartPosition;\n        this.setCurrentFindMatch(null);\n    }\n    _getDecorationIndex(decorationId) {\n        const index = this._decorations.indexOf(decorationId);\n        if (index >= 0) {\n            return index + 1;\n        }\n        return 1;\n    }\n    getDecorationRangeAt(index) {\n        const decorationId = index < this._decorations.length ? this._decorations[index] : null;\n        if (decorationId) {\n            return this._editor.getModel().getDecorationRange(decorationId);\n        }\n        return null;\n    }\n    getCurrentMatchesPosition(desiredRange) {\n        const candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\n        for (const candidate of candidates) {\n            const candidateOpts = candidate.options;\n            if (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\n                return this._getDecorationIndex(candidate.id);\n            }\n        }\n        // We don't know the current match position, so returns zero to show '?' in find widget\n        return 0;\n    }\n    setCurrentFindMatch(nextMatch) {\n        let newCurrentDecorationId = null;\n        let matchPosition = 0;\n        if (nextMatch) {\n            for (let i = 0, len = this._decorations.length; i < len; i++) {\n                const range = this._editor.getModel().getDecorationRange(this._decorations[i]);\n                if (nextMatch.equalsRange(range)) {\n                    newCurrentDecorationId = this._decorations[i];\n                    matchPosition = (i + 1);\n                    break;\n                }\n            }\n        }\n        if (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\n            this._editor.changeDecorations((changeAccessor) => {\n                if (this._highlightedDecorationId !== null) {\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\n                    this._highlightedDecorationId = null;\n                }\n                if (newCurrentDecorationId !== null) {\n                    this._highlightedDecorationId = newCurrentDecorationId;\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\n                }\n                if (this._rangeHighlightDecorationId !== null) {\n                    changeAccessor.removeDecoration(this._rangeHighlightDecorationId);\n                    this._rangeHighlightDecorationId = null;\n                }\n                if (newCurrentDecorationId !== null) {\n                    let rng = this._editor.getModel().getDecorationRange(newCurrentDecorationId);\n                    if (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\n                        const lineBeforeEnd = rng.endLineNumber - 1;\n                        const lineBeforeEndMaxColumn = this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\n                        rng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\n                    }\n                    this._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\n                }\n            });\n        }\n        return matchPosition;\n    }\n    set(findMatches, findScopes) {\n        this._editor.changeDecorations((accessor) => {\n            let findMatchesOptions = FindDecorations._FIND_MATCH_DECORATION;\n            const newOverviewRulerApproximateDecorations = [];\n            if (findMatches.length > 1000) {\n                // we go into a mode where the overview ruler gets \"approximate\" decorations\n                // the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\n                findMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\n                // approximate a distance in lines where matches should be merged\n                const lineCount = this._editor.getModel().getLineCount();\n                const height = this._editor.getLayoutInfo().height;\n                const approxPixelsPerLine = height / lineCount;\n                const mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\n                // merge decorations as much as possible\n                let prevStartLineNumber = findMatches[0].range.startLineNumber;\n                let prevEndLineNumber = findMatches[0].range.endLineNumber;\n                for (let i = 1, len = findMatches.length; i < len; i++) {\n                    const range = findMatches[i].range;\n                    if (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\n                        if (range.endLineNumber > prevEndLineNumber) {\n                            prevEndLineNumber = range.endLineNumber;\n                        }\n                    }\n                    else {\n                        newOverviewRulerApproximateDecorations.push({\n                            range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n                            options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n                        });\n                        prevStartLineNumber = range.startLineNumber;\n                        prevEndLineNumber = range.endLineNumber;\n                    }\n                }\n                newOverviewRulerApproximateDecorations.push({\n                    range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n                    options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n                });\n            }\n            // Find matches\n            const newFindMatchesDecorations = new Array(findMatches.length);\n            for (let i = 0, len = findMatches.length; i < len; i++) {\n                newFindMatchesDecorations[i] = {\n                    range: findMatches[i].range,\n                    options: findMatchesOptions\n                };\n            }\n            this._decorations = accessor.deltaDecorations(this._decorations, newFindMatchesDecorations);\n            // Overview ruler approximate decorations\n            this._overviewRulerApproximateDecorations = accessor.deltaDecorations(this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\n            // Range highlight\n            if (this._rangeHighlightDecorationId) {\n                accessor.removeDecoration(this._rangeHighlightDecorationId);\n                this._rangeHighlightDecorationId = null;\n            }\n            // Find scope\n            if (this._findScopeDecorationIds.length) {\n                this._findScopeDecorationIds.forEach(findScopeDecorationId => accessor.removeDecoration(findScopeDecorationId));\n                this._findScopeDecorationIds = [];\n            }\n            if (findScopes === null || findScopes === void 0 ? void 0 : findScopes.length) {\n                this._findScopeDecorationIds = findScopes.map(findScope => accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION));\n            }\n        });\n    }\n    matchBeforePosition(position) {\n        if (this._decorations.length === 0) {\n            return null;\n        }\n        for (let i = this._decorations.length - 1; i >= 0; i--) {\n            const decorationId = this._decorations[i];\n            const r = this._editor.getModel().getDecorationRange(decorationId);\n            if (!r || r.endLineNumber > position.lineNumber) {\n                continue;\n            }\n            if (r.endLineNumber < position.lineNumber) {\n                return r;\n            }\n            if (r.endColumn > position.column) {\n                continue;\n            }\n            return r;\n        }\n        return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\n    }\n    matchAfterPosition(position) {\n        if (this._decorations.length === 0) {\n            return null;\n        }\n        for (let i = 0, len = this._decorations.length; i < len; i++) {\n            const decorationId = this._decorations[i];\n            const r = this._editor.getModel().getDecorationRange(decorationId);\n            if (!r || r.startLineNumber < position.lineNumber) {\n                continue;\n            }\n            if (r.startLineNumber > position.lineNumber) {\n                return r;\n            }\n            if (r.startColumn < position.column) {\n                continue;\n            }\n            return r;\n        }\n        return this._editor.getModel().getDecorationRange(this._decorations[0]);\n    }\n    _allDecorations() {\n        let result = [];\n        result = result.concat(this._decorations);\n        result = result.concat(this._overviewRulerApproximateDecorations);\n        if (this._findScopeDecorationIds.length) {\n            result.push(...this._findScopeDecorationIds);\n        }\n        if (this._rangeHighlightDecorationId) {\n            result.push(this._rangeHighlightDecorationId);\n        }\n        return result;\n    }\n}\nFindDecorations._CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n    description: 'current-find-match',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    zIndex: 13,\n    className: 'currentFindMatch',\n    showIfCollapsed: true,\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerFindMatchForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapFindMatch),\n        position: MinimapPosition.Inline\n    }\n});\nFindDecorations._FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n    description: 'find-match',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    zIndex: 10,\n    className: 'findMatch',\n    showIfCollapsed: true,\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerFindMatchForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapFindMatch),\n        position: MinimapPosition.Inline\n    }\n});\nFindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n    description: 'find-match-no-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'findMatch',\n    showIfCollapsed: true\n});\nFindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n    description: 'find-match-only-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerFindMatchForeground),\n        position: OverviewRulerLane.Center\n    }\n});\nFindDecorations._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\n    description: 'find-range-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'rangeHighlight',\n    isWholeLine: true\n});\nFindDecorations._FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\n    description: 'find-scope',\n    className: 'findScope',\n    isWholeLine: true\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nexport class ReplaceAllCommand {\n    constructor(editorSelection, ranges, replaceStrings) {\n        this._editorSelection = editorSelection;\n        this._ranges = ranges;\n        this._replaceStrings = replaceStrings;\n        this._trackedEditorSelectionId = null;\n    }\n    getEditOperations(model, builder) {\n        if (this._ranges.length > 0) {\n            // Collect all edit operations\n            const ops = [];\n            for (let i = 0; i < this._ranges.length; i++) {\n                ops.push({\n                    range: this._ranges[i],\n                    text: this._replaceStrings[i]\n                });\n            }\n            // Sort them in ascending order by range starts\n            ops.sort((o1, o2) => {\n                return Range.compareRangesUsingStarts(o1.range, o2.range);\n            });\n            // Merge operations that touch each other\n            const resultOps = [];\n            let previousOp = ops[0];\n            for (let i = 1; i < ops.length; i++) {\n                if (previousOp.range.endLineNumber === ops[i].range.startLineNumber && previousOp.range.endColumn === ops[i].range.startColumn) {\n                    // These operations are one after another and can be merged\n                    previousOp.range = previousOp.range.plusRange(ops[i].range);\n                    previousOp.text = previousOp.text + ops[i].text;\n                }\n                else {\n                    resultOps.push(previousOp);\n                    previousOp = ops[i];\n                }\n            }\n            resultOps.push(previousOp);\n            for (const op of resultOps) {\n                builder.addEditOperation(op.range, op.text);\n            }\n        }\n        this._trackedEditorSelectionId = builder.trackSelection(this._editorSelection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._trackedEditorSelectionId);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from './strings.js';\nexport function buildReplaceStringWithCasePreserved(matches, pattern) {\n    if (matches && (matches[0] !== '')) {\n        const containsHyphens = validateSpecificSpecialCharacter(matches, pattern, '-');\n        const containsUnderscores = validateSpecificSpecialCharacter(matches, pattern, '_');\n        if (containsHyphens && !containsUnderscores) {\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '-');\n        }\n        else if (!containsHyphens && containsUnderscores) {\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '_');\n        }\n        if (matches[0].toUpperCase() === matches[0]) {\n            return pattern.toUpperCase();\n        }\n        else if (matches[0].toLowerCase() === matches[0]) {\n            return pattern.toLowerCase();\n        }\n        else if (strings.containsUppercaseCharacter(matches[0][0]) && pattern.length > 0) {\n            return pattern[0].toUpperCase() + pattern.substr(1);\n        }\n        else if (matches[0][0].toUpperCase() !== matches[0][0] && pattern.length > 0) {\n            return pattern[0].toLowerCase() + pattern.substr(1);\n        }\n        else {\n            // we don't understand its pattern yet.\n            return pattern;\n        }\n    }\n    else {\n        return pattern;\n    }\n}\nfunction validateSpecificSpecialCharacter(matches, pattern, specialCharacter) {\n    const doesContainSpecialCharacter = matches[0].indexOf(specialCharacter) !== -1 && pattern.indexOf(specialCharacter) !== -1;\n    return doesContainSpecialCharacter && matches[0].split(specialCharacter).length === pattern.split(specialCharacter).length;\n}\nfunction buildReplaceStringForSpecificSpecialCharacter(matches, pattern, specialCharacter) {\n    const splitPatternAtSpecialCharacter = pattern.split(specialCharacter);\n    const splitMatchAtSpecialCharacter = matches[0].split(specialCharacter);\n    let replaceString = '';\n    splitPatternAtSpecialCharacter.forEach((splitValue, index) => {\n        replaceString += buildReplaceStringWithCasePreserved([splitMatchAtSpecialCharacter[index]], splitValue) + specialCharacter;\n    });\n    return replaceString.slice(0, -1);\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { buildReplaceStringWithCasePreserved } from '../../../../base/common/search.js';\n/**\n * Assigned when the replace pattern is entirely static.\n */\nclass StaticValueReplacePattern {\n    constructor(staticValue) {\n        this.staticValue = staticValue;\n        this.kind = 0 /* ReplacePatternKind.StaticValue */;\n    }\n}\n/**\n * Assigned when the replace pattern has replacement patterns.\n */\nclass DynamicPiecesReplacePattern {\n    constructor(pieces) {\n        this.pieces = pieces;\n        this.kind = 1 /* ReplacePatternKind.DynamicPieces */;\n    }\n}\nexport class ReplacePattern {\n    static fromStaticValue(value) {\n        return new ReplacePattern([ReplacePiece.staticValue(value)]);\n    }\n    get hasReplacementPatterns() {\n        return (this._state.kind === 1 /* ReplacePatternKind.DynamicPieces */);\n    }\n    constructor(pieces) {\n        if (!pieces || pieces.length === 0) {\n            this._state = new StaticValueReplacePattern('');\n        }\n        else if (pieces.length === 1 && pieces[0].staticValue !== null) {\n            this._state = new StaticValueReplacePattern(pieces[0].staticValue);\n        }\n        else {\n            this._state = new DynamicPiecesReplacePattern(pieces);\n        }\n    }\n    buildReplaceString(matches, preserveCase) {\n        if (this._state.kind === 0 /* ReplacePatternKind.StaticValue */) {\n            if (preserveCase) {\n                return buildReplaceStringWithCasePreserved(matches, this._state.staticValue);\n            }\n            else {\n                return this._state.staticValue;\n            }\n        }\n        let result = '';\n        for (let i = 0, len = this._state.pieces.length; i < len; i++) {\n            const piece = this._state.pieces[i];\n            if (piece.staticValue !== null) {\n                // static value ReplacePiece\n                result += piece.staticValue;\n                continue;\n            }\n            // match index ReplacePiece\n            let match = ReplacePattern._substitute(piece.matchIndex, matches);\n            if (piece.caseOps !== null && piece.caseOps.length > 0) {\n                const repl = [];\n                const lenOps = piece.caseOps.length;\n                let opIdx = 0;\n                for (let idx = 0, len = match.length; idx < len; idx++) {\n                    if (opIdx >= lenOps) {\n                        repl.push(match.slice(idx));\n                        break;\n                    }\n                    switch (piece.caseOps[opIdx]) {\n                        case 'U':\n                            repl.push(match[idx].toUpperCase());\n                            break;\n                        case 'u':\n                            repl.push(match[idx].toUpperCase());\n                            opIdx++;\n                            break;\n                        case 'L':\n                            repl.push(match[idx].toLowerCase());\n                            break;\n                        case 'l':\n                            repl.push(match[idx].toLowerCase());\n                            opIdx++;\n                            break;\n                        default:\n                            repl.push(match[idx]);\n                    }\n                }\n                match = repl.join('');\n            }\n            result += match;\n        }\n        return result;\n    }\n    static _substitute(matchIndex, matches) {\n        if (matches === null) {\n            return '';\n        }\n        if (matchIndex === 0) {\n            return matches[0];\n        }\n        let remainder = '';\n        while (matchIndex > 0) {\n            if (matchIndex < matches.length) {\n                // A match can be undefined\n                const match = (matches[matchIndex] || '');\n                return match + remainder;\n            }\n            remainder = String(matchIndex % 10) + remainder;\n            matchIndex = Math.floor(matchIndex / 10);\n        }\n        return '$' + remainder;\n    }\n}\n/**\n * A replace piece can either be a static string or an index to a specific match.\n */\nexport class ReplacePiece {\n    static staticValue(value) {\n        return new ReplacePiece(value, -1, null);\n    }\n    static caseOps(index, caseOps) {\n        return new ReplacePiece(null, index, caseOps);\n    }\n    constructor(staticValue, matchIndex, caseOps) {\n        this.staticValue = staticValue;\n        this.matchIndex = matchIndex;\n        if (!caseOps || caseOps.length === 0) {\n            this.caseOps = null;\n        }\n        else {\n            this.caseOps = caseOps.slice(0);\n        }\n    }\n}\nclass ReplacePieceBuilder {\n    constructor(source) {\n        this._source = source;\n        this._lastCharIndex = 0;\n        this._result = [];\n        this._resultLen = 0;\n        this._currentStaticPiece = '';\n    }\n    emitUnchanged(toCharIndex) {\n        this._emitStatic(this._source.substring(this._lastCharIndex, toCharIndex));\n        this._lastCharIndex = toCharIndex;\n    }\n    emitStatic(value, toCharIndex) {\n        this._emitStatic(value);\n        this._lastCharIndex = toCharIndex;\n    }\n    _emitStatic(value) {\n        if (value.length === 0) {\n            return;\n        }\n        this._currentStaticPiece += value;\n    }\n    emitMatchIndex(index, toCharIndex, caseOps) {\n        if (this._currentStaticPiece.length !== 0) {\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\n            this._currentStaticPiece = '';\n        }\n        this._result[this._resultLen++] = ReplacePiece.caseOps(index, caseOps);\n        this._lastCharIndex = toCharIndex;\n    }\n    finalize() {\n        this.emitUnchanged(this._source.length);\n        if (this._currentStaticPiece.length !== 0) {\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\n            this._currentStaticPiece = '';\n        }\n        return new ReplacePattern(this._result);\n    }\n}\n/**\n * \\n\t\t\t=> inserts a LF\n * \\t\t\t\t=> inserts a TAB\n * \\\\\t\t\t=> inserts a \"\\\".\n * \\u\t\t\t=> upper-cases one character in a match.\n * \\U\t\t\t=> upper-cases ALL remaining characters in a match.\n * \\l\t\t\t=> lower-cases one character in a match.\n * \\L\t\t\t=> lower-cases ALL remaining characters in a match.\n * $$\t\t\t=> inserts a \"$\".\n * $& and $0\t=> inserts the matched substring.\n * $n\t\t\t=> Where n is a non-negative integer lesser than 100, inserts the nth parenthesized submatch string\n * everything else stays untouched\n *\n * Also see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter\n */\nexport function parseReplaceString(replaceString) {\n    if (!replaceString || replaceString.length === 0) {\n        return new ReplacePattern(null);\n    }\n    const caseOps = [];\n    const result = new ReplacePieceBuilder(replaceString);\n    for (let i = 0, len = replaceString.length; i < len; i++) {\n        const chCode = replaceString.charCodeAt(i);\n        if (chCode === 92 /* CharCode.Backslash */) {\n            // move to next char\n            i++;\n            if (i >= len) {\n                // string ends with a \\\n                break;\n            }\n            const nextChCode = replaceString.charCodeAt(i);\n            // let replaceWithCharacter: string | null = null;\n            switch (nextChCode) {\n                case 92 /* CharCode.Backslash */:\n                    // \\\\ => inserts a \"\\\"\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\\\', i + 1);\n                    break;\n                case 110 /* CharCode.n */:\n                    // \\n => inserts a LF\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\n', i + 1);\n                    break;\n                case 116 /* CharCode.t */:\n                    // \\t => inserts a TAB\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\t', i + 1);\n                    break;\n                // Case modification of string replacements, patterned after Boost, but only applied\n                // to the replacement text, not subsequent content.\n                case 117 /* CharCode.u */:\n                // \\u => upper-cases one character.\n                case 85 /* CharCode.U */:\n                // \\U => upper-cases ALL following characters.\n                case 108 /* CharCode.l */:\n                // \\l => lower-cases one character.\n                case 76 /* CharCode.L */:\n                    // \\L => lower-cases ALL following characters.\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('', i + 1);\n                    caseOps.push(String.fromCharCode(nextChCode));\n                    break;\n            }\n            continue;\n        }\n        if (chCode === 36 /* CharCode.DollarSign */) {\n            // move to next char\n            i++;\n            if (i >= len) {\n                // string ends with a $\n                break;\n            }\n            const nextChCode = replaceString.charCodeAt(i);\n            if (nextChCode === 36 /* CharCode.DollarSign */) {\n                // $$ => inserts a \"$\"\n                result.emitUnchanged(i - 1);\n                result.emitStatic('$', i + 1);\n                continue;\n            }\n            if (nextChCode === 48 /* CharCode.Digit0 */ || nextChCode === 38 /* CharCode.Ampersand */) {\n                // $& and $0 => inserts the matched substring.\n                result.emitUnchanged(i - 1);\n                result.emitMatchIndex(0, i + 1, caseOps);\n                caseOps.length = 0;\n                continue;\n            }\n            if (49 /* CharCode.Digit1 */ <= nextChCode && nextChCode <= 57 /* CharCode.Digit9 */) {\n                // $n\n                let matchIndex = nextChCode - 48 /* CharCode.Digit0 */;\n                // peek next char to probe for $nn\n                if (i + 1 < len) {\n                    const nextNextChCode = replaceString.charCodeAt(i + 1);\n                    if (48 /* CharCode.Digit0 */ <= nextNextChCode && nextNextChCode <= 57 /* CharCode.Digit9 */) {\n                        // $nn\n                        // move to next char\n                        i++;\n                        matchIndex = matchIndex * 10 + (nextNextChCode - 48 /* CharCode.Digit0 */);\n                        result.emitUnchanged(i - 2);\n                        result.emitMatchIndex(matchIndex, i + 1, caseOps);\n                        caseOps.length = 0;\n                        continue;\n                    }\n                }\n                result.emitUnchanged(i - 1);\n                result.emitMatchIndex(matchIndex, i + 1, caseOps);\n                caseOps.length = 0;\n                continue;\n            }\n        }\n    }\n    return result.finalize();\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport './findOptionsWidget.css';\nimport { CaseSensitiveToggle, RegexToggle, WholeWordsToggle } from '../../../../base/browser/ui/findinput/findInputToggles.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { FIND_IDS } from './findModel.js';\nimport { asCssVariable, inputActiveOptionBackground, inputActiveOptionBorder, inputActiveOptionForeground } from '../../../../platform/theme/common/colorRegistry.js';\nexport class FindOptionsWidget extends Widget {\n    constructor(editor, state, keybindingService) {\n        super();\n        this._hideSoon = this._register(new RunOnceScheduler(() => this._hide(), 2000));\n        this._isVisible = false;\n        this._editor = editor;\n        this._state = state;\n        this._keybindingService = keybindingService;\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'findOptionsWidget';\n        this._domNode.style.display = 'none';\n        this._domNode.style.top = '10px';\n        this._domNode.style.zIndex = '12';\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        const toggleStyles = {\n            inputActiveOptionBorder: asCssVariable(inputActiveOptionBorder),\n            inputActiveOptionForeground: asCssVariable(inputActiveOptionForeground),\n            inputActiveOptionBackground: asCssVariable(inputActiveOptionBackground),\n        };\n        this.caseSensitive = this._register(new CaseSensitiveToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\n            isChecked: this._state.matchCase,\n            ...toggleStyles\n        }));\n        this._domNode.appendChild(this.caseSensitive.domNode);\n        this._register(this.caseSensitive.onChange(() => {\n            this._state.change({\n                matchCase: this.caseSensitive.checked\n            }, false);\n        }));\n        this.wholeWords = this._register(new WholeWordsToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\n            isChecked: this._state.wholeWord,\n            ...toggleStyles\n        }));\n        this._domNode.appendChild(this.wholeWords.domNode);\n        this._register(this.wholeWords.onChange(() => {\n            this._state.change({\n                wholeWord: this.wholeWords.checked\n            }, false);\n        }));\n        this.regex = this._register(new RegexToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\n            isChecked: this._state.isRegex,\n            ...toggleStyles\n        }));\n        this._domNode.appendChild(this.regex.domNode);\n        this._register(this.regex.onChange(() => {\n            this._state.change({\n                isRegex: this.regex.checked\n            }, false);\n        }));\n        this._editor.addOverlayWidget(this);\n        this._register(this._state.onFindReplaceStateChange((e) => {\n            let somethingChanged = false;\n            if (e.isRegex) {\n                this.regex.checked = this._state.isRegex;\n                somethingChanged = true;\n            }\n            if (e.wholeWord) {\n                this.wholeWords.checked = this._state.wholeWord;\n                somethingChanged = true;\n            }\n            if (e.matchCase) {\n                this.caseSensitive.checked = this._state.matchCase;\n                somethingChanged = true;\n            }\n            if (!this._state.isRevealed && somethingChanged) {\n                this._revealTemporarily();\n            }\n        }));\n        this._register(dom.addDisposableListener(this._domNode, dom.EventType.MOUSE_LEAVE, (e) => this._onMouseLeave()));\n        this._register(dom.addDisposableListener(this._domNode, 'mouseover', (e) => this._onMouseOver()));\n    }\n    _keybindingLabelFor(actionId) {\n        const kb = this._keybindingService.lookupKeybinding(actionId);\n        if (!kb) {\n            return '';\n        }\n        return ` (${kb.getLabel()})`;\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    // ----- IOverlayWidget API\n    getId() {\n        return FindOptionsWidget.ID;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            preference: 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */\n        };\n    }\n    highlightFindOptions() {\n        this._revealTemporarily();\n    }\n    _revealTemporarily() {\n        this._show();\n        this._hideSoon.schedule();\n    }\n    _onMouseLeave() {\n        this._hideSoon.schedule();\n    }\n    _onMouseOver() {\n        this._hideSoon.cancel();\n    }\n    _show() {\n        if (this._isVisible) {\n            return;\n        }\n        this._isVisible = true;\n        this._domNode.style.display = 'block';\n    }\n    _hide() {\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._domNode.style.display = 'none';\n    }\n}\nFindOptionsWidget.ID = 'editor.contrib.findOptionsWidget';\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../../common/core/range.js';\nimport { MATCHES_LIMIT } from './findModel.js';\nfunction effectiveOptionValue(override, value) {\n    if (override === 1 /* FindOptionOverride.True */) {\n        return true;\n    }\n    if (override === 2 /* FindOptionOverride.False */) {\n        return false;\n    }\n    return value;\n}\nexport class FindReplaceState extends Disposable {\n    get searchString() { return this._searchString; }\n    get replaceString() { return this._replaceString; }\n    get isRevealed() { return this._isRevealed; }\n    get isReplaceRevealed() { return this._isReplaceRevealed; }\n    get isRegex() { return effectiveOptionValue(this._isRegexOverride, this._isRegex); }\n    get wholeWord() { return effectiveOptionValue(this._wholeWordOverride, this._wholeWord); }\n    get matchCase() { return effectiveOptionValue(this._matchCaseOverride, this._matchCase); }\n    get preserveCase() { return effectiveOptionValue(this._preserveCaseOverride, this._preserveCase); }\n    get actualIsRegex() { return this._isRegex; }\n    get actualWholeWord() { return this._wholeWord; }\n    get actualMatchCase() { return this._matchCase; }\n    get actualPreserveCase() { return this._preserveCase; }\n    get searchScope() { return this._searchScope; }\n    get matchesPosition() { return this._matchesPosition; }\n    get matchesCount() { return this._matchesCount; }\n    get currentMatch() { return this._currentMatch; }\n    constructor() {\n        super();\n        this._onFindReplaceStateChange = this._register(new Emitter());\n        this.onFindReplaceStateChange = this._onFindReplaceStateChange.event;\n        this._searchString = '';\n        this._replaceString = '';\n        this._isRevealed = false;\n        this._isReplaceRevealed = false;\n        this._isRegex = false;\n        this._isRegexOverride = 0 /* FindOptionOverride.NotSet */;\n        this._wholeWord = false;\n        this._wholeWordOverride = 0 /* FindOptionOverride.NotSet */;\n        this._matchCase = false;\n        this._matchCaseOverride = 0 /* FindOptionOverride.NotSet */;\n        this._preserveCase = false;\n        this._preserveCaseOverride = 0 /* FindOptionOverride.NotSet */;\n        this._searchScope = null;\n        this._matchesPosition = 0;\n        this._matchesCount = 0;\n        this._currentMatch = null;\n        this._loop = true;\n        this._isSearching = false;\n        this._filters = null;\n    }\n    changeMatchInfo(matchesPosition, matchesCount, currentMatch) {\n        const changeEvent = {\n            moveCursor: false,\n            updateHistory: false,\n            searchString: false,\n            replaceString: false,\n            isRevealed: false,\n            isReplaceRevealed: false,\n            isRegex: false,\n            wholeWord: false,\n            matchCase: false,\n            preserveCase: false,\n            searchScope: false,\n            matchesPosition: false,\n            matchesCount: false,\n            currentMatch: false,\n            loop: false,\n            isSearching: false,\n            filters: false\n        };\n        let somethingChanged = false;\n        if (matchesCount === 0) {\n            matchesPosition = 0;\n        }\n        if (matchesPosition > matchesCount) {\n            matchesPosition = matchesCount;\n        }\n        if (this._matchesPosition !== matchesPosition) {\n            this._matchesPosition = matchesPosition;\n            changeEvent.matchesPosition = true;\n            somethingChanged = true;\n        }\n        if (this._matchesCount !== matchesCount) {\n            this._matchesCount = matchesCount;\n            changeEvent.matchesCount = true;\n            somethingChanged = true;\n        }\n        if (typeof currentMatch !== 'undefined') {\n            if (!Range.equalsRange(this._currentMatch, currentMatch)) {\n                this._currentMatch = currentMatch;\n                changeEvent.currentMatch = true;\n                somethingChanged = true;\n            }\n        }\n        if (somethingChanged) {\n            this._onFindReplaceStateChange.fire(changeEvent);\n        }\n    }\n    change(newState, moveCursor, updateHistory = true) {\n        var _a;\n        const changeEvent = {\n            moveCursor: moveCursor,\n            updateHistory: updateHistory,\n            searchString: false,\n            replaceString: false,\n            isRevealed: false,\n            isReplaceRevealed: false,\n            isRegex: false,\n            wholeWord: false,\n            matchCase: false,\n            preserveCase: false,\n            searchScope: false,\n            matchesPosition: false,\n            matchesCount: false,\n            currentMatch: false,\n            loop: false,\n            isSearching: false,\n            filters: false\n        };\n        let somethingChanged = false;\n        const oldEffectiveIsRegex = this.isRegex;\n        const oldEffectiveWholeWords = this.wholeWord;\n        const oldEffectiveMatchCase = this.matchCase;\n        const oldEffectivePreserveCase = this.preserveCase;\n        if (typeof newState.searchString !== 'undefined') {\n            if (this._searchString !== newState.searchString) {\n                this._searchString = newState.searchString;\n                changeEvent.searchString = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.replaceString !== 'undefined') {\n            if (this._replaceString !== newState.replaceString) {\n                this._replaceString = newState.replaceString;\n                changeEvent.replaceString = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isRevealed !== 'undefined') {\n            if (this._isRevealed !== newState.isRevealed) {\n                this._isRevealed = newState.isRevealed;\n                changeEvent.isRevealed = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isReplaceRevealed !== 'undefined') {\n            if (this._isReplaceRevealed !== newState.isReplaceRevealed) {\n                this._isReplaceRevealed = newState.isReplaceRevealed;\n                changeEvent.isReplaceRevealed = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isRegex !== 'undefined') {\n            this._isRegex = newState.isRegex;\n        }\n        if (typeof newState.wholeWord !== 'undefined') {\n            this._wholeWord = newState.wholeWord;\n        }\n        if (typeof newState.matchCase !== 'undefined') {\n            this._matchCase = newState.matchCase;\n        }\n        if (typeof newState.preserveCase !== 'undefined') {\n            this._preserveCase = newState.preserveCase;\n        }\n        if (typeof newState.searchScope !== 'undefined') {\n            if (!((_a = newState.searchScope) === null || _a === void 0 ? void 0 : _a.every((newSearchScope) => {\n                var _a;\n                return (_a = this._searchScope) === null || _a === void 0 ? void 0 : _a.some(existingSearchScope => {\n                    return !Range.equalsRange(existingSearchScope, newSearchScope);\n                });\n            }))) {\n                this._searchScope = newState.searchScope;\n                changeEvent.searchScope = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.loop !== 'undefined') {\n            if (this._loop !== newState.loop) {\n                this._loop = newState.loop;\n                changeEvent.loop = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isSearching !== 'undefined') {\n            if (this._isSearching !== newState.isSearching) {\n                this._isSearching = newState.isSearching;\n                changeEvent.isSearching = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.filters !== 'undefined') {\n            if (this._filters) {\n                this._filters.update(newState.filters);\n            }\n            else {\n                this._filters = newState.filters;\n            }\n            changeEvent.filters = true;\n            somethingChanged = true;\n        }\n        // Overrides get set when they explicitly come in and get reset anytime something else changes\n        this._isRegexOverride = (typeof newState.isRegexOverride !== 'undefined' ? newState.isRegexOverride : 0 /* FindOptionOverride.NotSet */);\n        this._wholeWordOverride = (typeof newState.wholeWordOverride !== 'undefined' ? newState.wholeWordOverride : 0 /* FindOptionOverride.NotSet */);\n        this._matchCaseOverride = (typeof newState.matchCaseOverride !== 'undefined' ? newState.matchCaseOverride : 0 /* FindOptionOverride.NotSet */);\n        this._preserveCaseOverride = (typeof newState.preserveCaseOverride !== 'undefined' ? newState.preserveCaseOverride : 0 /* FindOptionOverride.NotSet */);\n        if (oldEffectiveIsRegex !== this.isRegex) {\n            somethingChanged = true;\n            changeEvent.isRegex = true;\n        }\n        if (oldEffectiveWholeWords !== this.wholeWord) {\n            somethingChanged = true;\n            changeEvent.wholeWord = true;\n        }\n        if (oldEffectiveMatchCase !== this.matchCase) {\n            somethingChanged = true;\n            changeEvent.matchCase = true;\n        }\n        if (oldEffectivePreserveCase !== this.preserveCase) {\n            somethingChanged = true;\n            changeEvent.preserveCase = true;\n        }\n        if (somethingChanged) {\n            this._onFindReplaceStateChange.fire(changeEvent);\n        }\n    }\n    canNavigateBack() {\n        return this.canNavigateInLoop() || (this.matchesPosition !== 1);\n    }\n    canNavigateForward() {\n        return this.canNavigateInLoop() || (this.matchesPosition < this.matchesCount);\n    }\n    canNavigateInLoop() {\n        return this._loop || (this.matchesCount >= MATCHES_LIMIT);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { alert as alertFn } from '../../../../base/browser/ui/aria/aria.js';\nimport { Toggle } from '../../../../base/browser/ui/toggle/toggle.js';\nimport { Sash } from '../../../../base/browser/ui/sash/sash.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './findWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_REPLACE_INPUT_FOCUSED, FIND_IDS, MATCHES_LIMIT } from './findModel.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextScopedFindInput, ContextScopedReplaceInput } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nimport { showHistoryKeybindingHint } from '../../../../platform/history/browser/historyWidgetKeybindingHint.js';\nimport { asCssVariable, contrastBorder, editorFindMatchHighlightBorder, editorFindRangeHighlightBorder, inputActiveOptionBackground, inputActiveOptionBorder, inputActiveOptionForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon, widgetClose } from '../../../../platform/theme/common/iconRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { assertIsDefined } from '../../../../base/common/types.js';\nimport { defaultInputBoxStyles, defaultToggleStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nconst findSelectionIcon = registerIcon('find-selection', Codicon.selection, nls.localize('findSelectionIcon', 'Icon for \\'Find in Selection\\' in the editor find widget.'));\nconst findCollapsedIcon = registerIcon('find-collapsed', Codicon.chevronRight, nls.localize('findCollapsedIcon', 'Icon to indicate that the editor find widget is collapsed.'));\nconst findExpandedIcon = registerIcon('find-expanded', Codicon.chevronDown, nls.localize('findExpandedIcon', 'Icon to indicate that the editor find widget is expanded.'));\nexport const findReplaceIcon = registerIcon('find-replace', Codicon.replace, nls.localize('findReplaceIcon', 'Icon for \\'Replace\\' in the editor find widget.'));\nexport const findReplaceAllIcon = registerIcon('find-replace-all', Codicon.replaceAll, nls.localize('findReplaceAllIcon', 'Icon for \\'Replace All\\' in the editor find widget.'));\nexport const findPreviousMatchIcon = registerIcon('find-previous-match', Codicon.arrowUp, nls.localize('findPreviousMatchIcon', 'Icon for \\'Find Previous\\' in the editor find widget.'));\nexport const findNextMatchIcon = registerIcon('find-next-match', Codicon.arrowDown, nls.localize('findNextMatchIcon', 'Icon for \\'Find Next\\' in the editor find widget.'));\nconst NLS_FIND_DIALOG_LABEL = nls.localize('label.findDialog', \"Find / Replace\");\nconst NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\nconst NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\nconst NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous Match\");\nconst NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next Match\");\nconst NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in Selection\");\nconst NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\nconst NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\nconst NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\nconst NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\nconst NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\nconst NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace\");\nconst NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", MATCHES_LIMIT);\nexport const NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\nexport const NLS_NO_RESULTS = nls.localize('label.noResults', \"No results\");\nconst FIND_WIDGET_INITIAL_WIDTH = 419;\nconst PART_WIDTH = 275;\nconst FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\nlet MAX_MATCHES_COUNT_WIDTH = 69;\n// let FIND_ALL_CONTROLS_WIDTH = 17/** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2/** sash */;\nconst FIND_INPUT_AREA_HEIGHT = 33; // The height of Find Widget when Replace Input is not visible.\nconst ctrlEnterReplaceAllWarningPromptedKey = 'ctrlEnterReplaceAll.windows.donotask';\nconst ctrlKeyMod = (platform.isMacintosh ? 256 /* KeyMod.WinCtrl */ : 2048 /* KeyMod.CtrlCmd */);\nexport class FindWidgetViewZone {\n    constructor(afterLineNumber) {\n        this.afterLineNumber = afterLineNumber;\n        this.heightInPx = FIND_INPUT_AREA_HEIGHT;\n        this.suppressMouseDown = false;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'dock-find-viewzone';\n    }\n}\nfunction stopPropagationForMultiLineUpwards(event, value, textarea) {\n    const isMultiline = !!value.match(/\\n/);\n    if (textarea && isMultiline && textarea.selectionStart > 0) {\n        event.stopPropagation();\n        return;\n    }\n}\nfunction stopPropagationForMultiLineDownwards(event, value, textarea) {\n    const isMultiline = !!value.match(/\\n/);\n    if (textarea && isMultiline && textarea.selectionEnd < textarea.value.length) {\n        event.stopPropagation();\n        return;\n    }\n}\nexport class FindWidget extends Widget {\n    constructor(codeEditor, controller, state, contextViewProvider, keybindingService, contextKeyService, themeService, storageService, notificationService) {\n        super();\n        this._cachedHeight = null;\n        this._revealTimeouts = [];\n        this._codeEditor = codeEditor;\n        this._controller = controller;\n        this._state = state;\n        this._contextViewProvider = contextViewProvider;\n        this._keybindingService = keybindingService;\n        this._contextKeyService = contextKeyService;\n        this._storageService = storageService;\n        this._notificationService = notificationService;\n        this._ctrlEnterReplaceAllWarningPrompted = !!storageService.getBoolean(ctrlEnterReplaceAllWarningPromptedKey, 0 /* StorageScope.PROFILE */);\n        this._isVisible = false;\n        this._isReplaceVisible = false;\n        this._ignoreChangeEvent = false;\n        this._updateHistoryDelayer = new Delayer(500);\n        this._register(toDisposable(() => this._updateHistoryDelayer.cancel()));\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this._buildDomNode();\n        this._updateButtons();\n        this._tryUpdateWidgetWidth();\n        this._findInput.inputBox.layout();\n        this._register(this._codeEditor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(91 /* EditorOption.readOnly */)) {\n                if (this._codeEditor.getOption(91 /* EditorOption.readOnly */)) {\n                    // Hide replace part if editor becomes read only\n                    this._state.change({ isReplaceRevealed: false }, false);\n                }\n                this._updateButtons();\n            }\n            if (e.hasChanged(144 /* EditorOption.layoutInfo */)) {\n                this._tryUpdateWidgetWidth();\n            }\n            if (e.hasChanged(2 /* EditorOption.accessibilitySupport */)) {\n                this.updateAccessibilitySupport();\n            }\n            if (e.hasChanged(41 /* EditorOption.find */)) {\n                const supportLoop = this._codeEditor.getOption(41 /* EditorOption.find */).loop;\n                this._state.change({ loop: supportLoop }, false);\n                const addExtraSpaceOnTop = this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop;\n                if (addExtraSpaceOnTop && !this._viewZone) {\n                    this._viewZone = new FindWidgetViewZone(0);\n                    this._showViewZone();\n                }\n                if (!addExtraSpaceOnTop && this._viewZone) {\n                    this._removeViewZone();\n                }\n            }\n        }));\n        this.updateAccessibilitySupport();\n        this._register(this._codeEditor.onDidChangeCursorSelection(() => {\n            if (this._isVisible) {\n                this._updateToggleSelectionFindButton();\n            }\n        }));\n        this._register(this._codeEditor.onDidFocusEditorWidget(async () => {\n            if (this._isVisible) {\n                const globalBufferTerm = await this._controller.getGlobalBufferTerm();\n                if (globalBufferTerm && globalBufferTerm !== this._state.searchString) {\n                    this._state.change({ searchString: globalBufferTerm }, false);\n                    this._findInput.select();\n                }\n            }\n        }));\n        this._findInputFocused = CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\n        this._findFocusTracker = this._register(dom.trackFocus(this._findInput.inputBox.inputElement));\n        this._register(this._findFocusTracker.onDidFocus(() => {\n            this._findInputFocused.set(true);\n            this._updateSearchScope();\n        }));\n        this._register(this._findFocusTracker.onDidBlur(() => {\n            this._findInputFocused.set(false);\n        }));\n        this._replaceInputFocused = CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\n        this._replaceFocusTracker = this._register(dom.trackFocus(this._replaceInput.inputBox.inputElement));\n        this._register(this._replaceFocusTracker.onDidFocus(() => {\n            this._replaceInputFocused.set(true);\n            this._updateSearchScope();\n        }));\n        this._register(this._replaceFocusTracker.onDidBlur(() => {\n            this._replaceInputFocused.set(false);\n        }));\n        this._codeEditor.addOverlayWidget(this);\n        if (this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop) {\n            this._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\n        }\n        this._register(this._codeEditor.onDidChangeModel(() => {\n            if (!this._isVisible) {\n                return;\n            }\n            this._viewZoneId = undefined;\n        }));\n        this._register(this._codeEditor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged) {\n                this._layoutViewZone();\n                return;\n            }\n            // for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\n            setTimeout(() => {\n                this._layoutViewZone();\n            }, 0);\n        }));\n    }\n    // ----- IOverlayWidget API\n    getId() {\n        return FindWidget.ID;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        if (this._isVisible) {\n            return {\n                preference: 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */\n            };\n        }\n        return null;\n    }\n    // ----- React to state changes\n    _onStateChanged(e) {\n        if (e.searchString) {\n            try {\n                this._ignoreChangeEvent = true;\n                this._findInput.setValue(this._state.searchString);\n            }\n            finally {\n                this._ignoreChangeEvent = false;\n            }\n            this._updateButtons();\n        }\n        if (e.replaceString) {\n            this._replaceInput.inputBox.value = this._state.replaceString;\n        }\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._reveal();\n            }\n            else {\n                this._hide(true);\n            }\n        }\n        if (e.isReplaceRevealed) {\n            if (this._state.isReplaceRevealed) {\n                if (!this._codeEditor.getOption(91 /* EditorOption.readOnly */) && !this._isReplaceVisible) {\n                    this._isReplaceVisible = true;\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                    this._updateButtons();\n                    this._replaceInput.inputBox.layout();\n                }\n            }\n            else {\n                if (this._isReplaceVisible) {\n                    this._isReplaceVisible = false;\n                    this._updateButtons();\n                }\n            }\n        }\n        if ((e.isRevealed || e.isReplaceRevealed) && (this._state.isRevealed || this._state.isReplaceRevealed)) {\n            if (this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }\n        if (e.isRegex) {\n            this._findInput.setRegex(this._state.isRegex);\n        }\n        if (e.wholeWord) {\n            this._findInput.setWholeWords(this._state.wholeWord);\n        }\n        if (e.matchCase) {\n            this._findInput.setCaseSensitive(this._state.matchCase);\n        }\n        if (e.preserveCase) {\n            this._replaceInput.setPreserveCase(this._state.preserveCase);\n        }\n        if (e.searchScope) {\n            if (this._state.searchScope) {\n                this._toggleSelectionFind.checked = true;\n            }\n            else {\n                this._toggleSelectionFind.checked = false;\n            }\n            this._updateToggleSelectionFindButton();\n        }\n        if (e.searchString || e.matchesCount || e.matchesPosition) {\n            const showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\n            this._domNode.classList.toggle('no-results', showRedOutline);\n            this._updateMatchesCount();\n            this._updateButtons();\n        }\n        if (e.searchString || e.currentMatch) {\n            this._layoutViewZone();\n        }\n        if (e.updateHistory) {\n            this._delayedUpdateHistory();\n        }\n        if (e.loop) {\n            this._updateButtons();\n        }\n    }\n    _delayedUpdateHistory() {\n        this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(undefined, onUnexpectedError);\n    }\n    _updateHistory() {\n        if (this._state.searchString) {\n            this._findInput.inputBox.addToHistory();\n        }\n        if (this._state.replaceString) {\n            this._replaceInput.inputBox.addToHistory();\n        }\n    }\n    _updateMatchesCount() {\n        this._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\n        if (this._state.matchesCount >= MATCHES_LIMIT) {\n            this._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\n        }\n        else {\n            this._matchesCount.title = '';\n        }\n        // remove previous content\n        if (this._matchesCount.firstChild) {\n            this._matchesCount.removeChild(this._matchesCount.firstChild);\n        }\n        let label;\n        if (this._state.matchesCount > 0) {\n            let matchesCount = String(this._state.matchesCount);\n            if (this._state.matchesCount >= MATCHES_LIMIT) {\n                matchesCount += '+';\n            }\n            let matchesPosition = String(this._state.matchesPosition);\n            if (matchesPosition === '0') {\n                matchesPosition = '?';\n            }\n            label = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\n        }\n        else {\n            label = NLS_NO_RESULTS;\n        }\n        this._matchesCount.appendChild(document.createTextNode(label));\n        alertFn(this._getAriaLabel(label, this._state.currentMatch, this._state.searchString));\n        MAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\n    }\n    // ----- actions\n    _getAriaLabel(label, currentMatch, searchString) {\n        if (label === NLS_NO_RESULTS) {\n            return searchString === ''\n                ? nls.localize('ariaSearchNoResultEmpty', \"{0} found\", label)\n                : nls.localize('ariaSearchNoResult', \"{0} found for '{1}'\", label, searchString);\n        }\n        if (currentMatch) {\n            const ariaLabel = nls.localize('ariaSearchNoResultWithLineNum', \"{0} found for '{1}', at {2}\", label, searchString, currentMatch.startLineNumber + ':' + currentMatch.startColumn);\n            const model = this._codeEditor.getModel();\n            if (model && (currentMatch.startLineNumber <= model.getLineCount()) && (currentMatch.startLineNumber >= 1)) {\n                const lineContent = model.getLineContent(currentMatch.startLineNumber);\n                return `${lineContent}, ${ariaLabel}`;\n            }\n            return ariaLabel;\n        }\n        return nls.localize('ariaSearchNoResultWithLineNumNoCurrentMatch', \"{0} found for '{1}'\", label, searchString);\n    }\n    /**\n     * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\n     * If 'selection find' is OFF we enable the button only if there is a selection.\n     */\n    _updateToggleSelectionFindButton() {\n        const selection = this._codeEditor.getSelection();\n        const isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\n        const isChecked = this._toggleSelectionFind.checked;\n        if (this._isVisible && (isChecked || isSelection)) {\n            this._toggleSelectionFind.enable();\n        }\n        else {\n            this._toggleSelectionFind.disable();\n        }\n    }\n    _updateButtons() {\n        this._findInput.setEnabled(this._isVisible);\n        this._replaceInput.setEnabled(this._isVisible && this._isReplaceVisible);\n        this._updateToggleSelectionFindButton();\n        this._closeBtn.setEnabled(this._isVisible);\n        const findInputIsNonEmpty = (this._state.searchString.length > 0);\n        const matchesCount = this._state.matchesCount ? true : false;\n        this._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateBack());\n        this._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateForward());\n        this._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        this._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        this._domNode.classList.toggle('replaceToggled', this._isReplaceVisible);\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        const canReplace = !this._codeEditor.getOption(91 /* EditorOption.readOnly */);\n        this._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\n    }\n    _reveal() {\n        this._revealTimeouts.forEach(e => {\n            clearTimeout(e);\n        });\n        this._revealTimeouts = [];\n        if (!this._isVisible) {\n            this._isVisible = true;\n            const selection = this._codeEditor.getSelection();\n            switch (this._codeEditor.getOption(41 /* EditorOption.find */).autoFindInSelection) {\n                case 'always':\n                    this._toggleSelectionFind.checked = true;\n                    break;\n                case 'never':\n                    this._toggleSelectionFind.checked = false;\n                    break;\n                case 'multiline': {\n                    const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n                    this._toggleSelectionFind.checked = isSelectionMultipleLine;\n                    break;\n                }\n                default:\n                    break;\n            }\n            this._tryUpdateWidgetWidth();\n            this._updateButtons();\n            this._revealTimeouts.push(setTimeout(() => {\n                this._domNode.classList.add('visible');\n                this._domNode.setAttribute('aria-hidden', 'false');\n            }, 0));\n            // validate query again as it's being dismissed when we hide the find widget.\n            this._revealTimeouts.push(setTimeout(() => {\n                this._findInput.validate();\n            }, 200));\n            this._codeEditor.layoutOverlayWidget(this);\n            let adjustEditorScrollTop = true;\n            if (this._codeEditor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection && selection) {\n                const domNode = this._codeEditor.getDomNode();\n                if (domNode) {\n                    const editorCoords = dom.getDomNodePagePosition(domNode);\n                    const startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\n                    const startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\n                    const startTop = startCoords ? startCoords.top : 0;\n                    if (this._viewZone && startTop < this._viewZone.heightInPx) {\n                        if (selection.endLineNumber > selection.startLineNumber) {\n                            adjustEditorScrollTop = false;\n                        }\n                        const leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\n                        if (startLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                        const endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\n                        const endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\n                        if (endLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                    }\n                }\n            }\n            this._showViewZone(adjustEditorScrollTop);\n        }\n    }\n    _hide(focusTheEditor) {\n        this._revealTimeouts.forEach(e => {\n            clearTimeout(e);\n        });\n        this._revealTimeouts = [];\n        if (this._isVisible) {\n            this._isVisible = false;\n            this._updateButtons();\n            this._domNode.classList.remove('visible');\n            this._domNode.setAttribute('aria-hidden', 'true');\n            this._findInput.clearMessage();\n            if (focusTheEditor) {\n                this._codeEditor.focus();\n            }\n            this._codeEditor.layoutOverlayWidget(this);\n            this._removeViewZone();\n        }\n    }\n    _layoutViewZone(targetScrollTop) {\n        const addExtraSpaceOnTop = this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop;\n        if (!addExtraSpaceOnTop) {\n            this._removeViewZone();\n            return;\n        }\n        if (!this._isVisible) {\n            return;\n        }\n        const viewZone = this._viewZone;\n        if (this._viewZoneId !== undefined || !viewZone) {\n            return;\n        }\n        this._codeEditor.changeViewZones((accessor) => {\n            viewZone.heightInPx = this._getHeight();\n            this._viewZoneId = accessor.addZone(viewZone);\n            // scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\n            this._codeEditor.setScrollTop(targetScrollTop || this._codeEditor.getScrollTop() + viewZone.heightInPx);\n        });\n    }\n    _showViewZone(adjustScroll = true) {\n        if (!this._isVisible) {\n            return;\n        }\n        const addExtraSpaceOnTop = this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop;\n        if (!addExtraSpaceOnTop) {\n            return;\n        }\n        if (this._viewZone === undefined) {\n            this._viewZone = new FindWidgetViewZone(0);\n        }\n        const viewZone = this._viewZone;\n        this._codeEditor.changeViewZones((accessor) => {\n            if (this._viewZoneId !== undefined) {\n                // the view zone already exists, we need to update the height\n                const newHeight = this._getHeight();\n                if (newHeight === viewZone.heightInPx) {\n                    return;\n                }\n                const scrollAdjustment = newHeight - viewZone.heightInPx;\n                viewZone.heightInPx = newHeight;\n                accessor.layoutZone(this._viewZoneId);\n                if (adjustScroll) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\n                }\n                return;\n            }\n            else {\n                let scrollAdjustment = this._getHeight();\n                // if the editor has top padding, factor that into the zone height\n                scrollAdjustment -= this._codeEditor.getOption(84 /* EditorOption.padding */).top;\n                if (scrollAdjustment <= 0) {\n                    return;\n                }\n                viewZone.heightInPx = scrollAdjustment;\n                this._viewZoneId = accessor.addZone(viewZone);\n                if (adjustScroll) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\n                }\n            }\n        });\n    }\n    _removeViewZone() {\n        this._codeEditor.changeViewZones((accessor) => {\n            if (this._viewZoneId !== undefined) {\n                accessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n                if (this._viewZone) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() - this._viewZone.heightInPx);\n                    this._viewZone = undefined;\n                }\n            }\n        });\n    }\n    _tryUpdateWidgetWidth() {\n        if (!this._isVisible) {\n            return;\n        }\n        if (!this._domNode.isConnected) {\n            // the widget is not in the DOM\n            return;\n        }\n        const layoutInfo = this._codeEditor.getLayoutInfo();\n        const editorContentWidth = layoutInfo.contentWidth;\n        if (editorContentWidth <= 0) {\n            // for example, diff view original editor\n            this._domNode.classList.add('hiddenEditor');\n            return;\n        }\n        else if (this._domNode.classList.contains('hiddenEditor')) {\n            this._domNode.classList.remove('hiddenEditor');\n        }\n        const editorWidth = layoutInfo.width;\n        const minimapWidth = layoutInfo.minimap.minimapWidth;\n        let collapsedFindWidget = false;\n        let reducedFindWidget = false;\n        let narrowFindWidget = false;\n        if (this._resized) {\n            const widgetWidth = dom.getTotalWidth(this._domNode);\n            if (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\n                // as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\n                this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                return;\n            }\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\n            reducedFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\n            narrowFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\n            collapsedFindWidget = true;\n        }\n        this._domNode.classList.toggle('collapsed-find-widget', collapsedFindWidget);\n        this._domNode.classList.toggle('narrow-find-widget', narrowFindWidget);\n        this._domNode.classList.toggle('reduced-find-widget', reducedFindWidget);\n        if (!narrowFindWidget && !collapsedFindWidget) {\n            // the minimal left offset of findwidget is 15px.\n            this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n        }\n        this._findInput.layout({ collapsedFindWidget, narrowFindWidget, reducedFindWidget });\n        if (this._resized) {\n            const findInputWidth = this._findInput.inputBox.element.clientWidth;\n            if (findInputWidth > 0) {\n                this._replaceInput.width = findInputWidth;\n            }\n        }\n        else if (this._isReplaceVisible) {\n            this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n        }\n    }\n    _getHeight() {\n        let totalheight = 0;\n        // find input margin top\n        totalheight += 4;\n        // find input height\n        totalheight += this._findInput.inputBox.height + 2 /** input box border */;\n        if (this._isReplaceVisible) {\n            // replace input margin\n            totalheight += 4;\n            totalheight += this._replaceInput.inputBox.height + 2 /** input box border */;\n        }\n        // margin bottom\n        totalheight += 4;\n        return totalheight;\n    }\n    _tryUpdateHeight() {\n        const totalHeight = this._getHeight();\n        if (this._cachedHeight !== null && this._cachedHeight === totalHeight) {\n            return false;\n        }\n        this._cachedHeight = totalHeight;\n        this._domNode.style.height = `${totalHeight}px`;\n        return true;\n    }\n    // ----- Public\n    focusFindInput() {\n        this._findInput.select();\n        // Edge browser requires focus() in addition to select()\n        this._findInput.focus();\n    }\n    focusReplaceInput() {\n        this._replaceInput.select();\n        // Edge browser requires focus() in addition to select()\n        this._replaceInput.focus();\n    }\n    highlightFindOptions() {\n        this._findInput.highlightFindOptions();\n    }\n    _updateSearchScope() {\n        if (!this._codeEditor.hasModel()) {\n            return;\n        }\n        if (this._toggleSelectionFind.checked) {\n            const selections = this._codeEditor.getSelections();\n            selections.map(selection => {\n                if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                    selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                }\n                const currentMatch = this._state.currentMatch;\n                if (selection.startLineNumber !== selection.endLineNumber) {\n                    if (!Range.equalsRange(selection, currentMatch)) {\n                        return selection;\n                    }\n                }\n                return null;\n            }).filter(element => !!element);\n            if (selections.length) {\n                this._state.change({ searchScope: selections }, true);\n            }\n        }\n    }\n    _onFindInputMouseDown(e) {\n        // on linux, middle key does pasting.\n        if (e.middleButton) {\n            e.stopPropagation();\n        }\n    }\n    _onFindInputKeyDown(e) {\n        if (e.equals(ctrlKeyMod | 3 /* KeyCode.Enter */)) {\n            if (this._keybindingService.dispatchEvent(e, e.target)) {\n                e.preventDefault();\n                return;\n            }\n            else {\n                this._findInput.inputBox.insertAtCursor('\\n');\n                e.preventDefault();\n                return;\n            }\n        }\n        if (e.equals(2 /* KeyCode.Tab */)) {\n            if (this._isReplaceVisible) {\n                this._replaceInput.focus();\n            }\n            else {\n                this._findInput.focusOnCaseSensitive();\n            }\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(16 /* KeyCode.UpArrow */)) {\n            return stopPropagationForMultiLineUpwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\n        }\n        if (e.equals(18 /* KeyCode.DownArrow */)) {\n            return stopPropagationForMultiLineDownwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\n        }\n    }\n    _onReplaceInputKeyDown(e) {\n        if (e.equals(ctrlKeyMod | 3 /* KeyCode.Enter */)) {\n            if (this._keybindingService.dispatchEvent(e, e.target)) {\n                e.preventDefault();\n                return;\n            }\n            else {\n                if (platform.isWindows && platform.isNative && !this._ctrlEnterReplaceAllWarningPrompted) {\n                    // this is the first time when users press Ctrl + Enter to replace all\n                    this._notificationService.info(nls.localize('ctrlEnter.keybindingChanged', 'Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.'));\n                    this._ctrlEnterReplaceAllWarningPrompted = true;\n                    this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey, true, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n                }\n                this._replaceInput.inputBox.insertAtCursor('\\n');\n                e.preventDefault();\n                return;\n            }\n        }\n        if (e.equals(2 /* KeyCode.Tab */)) {\n            this._findInput.focusOnCaseSensitive();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n            this._findInput.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(16 /* KeyCode.UpArrow */)) {\n            return stopPropagationForMultiLineUpwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\n        }\n        if (e.equals(18 /* KeyCode.DownArrow */)) {\n            return stopPropagationForMultiLineDownwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\n        }\n    }\n    // ----- sash\n    getVerticalSashLeft(_sash) {\n        return 0;\n    }\n    // ----- initialization\n    _keybindingLabelFor(actionId) {\n        const kb = this._keybindingService.lookupKeybinding(actionId);\n        if (!kb) {\n            return '';\n        }\n        return ` (${kb.getLabel()})`;\n    }\n    _buildDomNode() {\n        const flexibleHeight = true;\n        const flexibleWidth = true;\n        // Find input\n        this._findInput = this._register(new ContextScopedFindInput(null, this._contextViewProvider, {\n            width: FIND_INPUT_AREA_WIDTH,\n            label: NLS_FIND_INPUT_LABEL,\n            placeholder: NLS_FIND_INPUT_PLACEHOLDER,\n            appendCaseSensitiveLabel: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\n            appendWholeWordsLabel: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\n            appendRegexLabel: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\n            validation: (value) => {\n                if (value.length === 0 || !this._findInput.getRegex()) {\n                    return null;\n                }\n                try {\n                    // use `g` and `u` which are also used by the TextModel search\n                    new RegExp(value, 'gu');\n                    return null;\n                }\n                catch (e) {\n                    return { content: e.message };\n                }\n            },\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight: 118,\n            showCommonFindToggles: true,\n            showHistoryHint: () => showHistoryKeybindingHint(this._keybindingService),\n            inputBoxStyles: defaultInputBoxStyles,\n            toggleStyles: defaultToggleStyles\n        }, this._contextKeyService));\n        this._findInput.setRegex(!!this._state.isRegex);\n        this._findInput.setCaseSensitive(!!this._state.matchCase);\n        this._findInput.setWholeWords(!!this._state.wholeWord);\n        this._register(this._findInput.onKeyDown((e) => this._onFindInputKeyDown(e)));\n        this._register(this._findInput.inputBox.onDidChange(() => {\n            if (this._ignoreChangeEvent) {\n                return;\n            }\n            this._state.change({ searchString: this._findInput.getValue() }, true);\n        }));\n        this._register(this._findInput.onDidOptionChange(() => {\n            this._state.change({\n                isRegex: this._findInput.getRegex(),\n                wholeWord: this._findInput.getWholeWords(),\n                matchCase: this._findInput.getCaseSensitive()\n            }, true);\n        }));\n        this._register(this._findInput.onCaseSensitiveKeyDown((e) => {\n            if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n                if (this._isReplaceVisible) {\n                    this._replaceInput.focus();\n                    e.preventDefault();\n                }\n            }\n        }));\n        this._register(this._findInput.onRegexKeyDown((e) => {\n            if (e.equals(2 /* KeyCode.Tab */)) {\n                if (this._isReplaceVisible) {\n                    this._replaceInput.focusOnPreserve();\n                    e.preventDefault();\n                }\n            }\n        }));\n        this._register(this._findInput.inputBox.onDidHeightChange((e) => {\n            if (this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }));\n        if (platform.isLinux) {\n            this._register(this._findInput.onMouseDown((e) => this._onFindInputMouseDown(e)));\n        }\n        this._matchesCount = document.createElement('div');\n        this._matchesCount.className = 'matchesCount';\n        this._updateMatchesCount();\n        // Previous button\n        this._prevBtn = this._register(new SimpleButton({\n            label: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),\n            icon: findPreviousMatchIcon,\n            onTrigger: () => {\n                assertIsDefined(this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction)).run().then(undefined, onUnexpectedError);\n            }\n        }));\n        // Next button\n        this._nextBtn = this._register(new SimpleButton({\n            label: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),\n            icon: findNextMatchIcon,\n            onTrigger: () => {\n                assertIsDefined(this._codeEditor.getAction(FIND_IDS.NextMatchFindAction)).run().then(undefined, onUnexpectedError);\n            }\n        }));\n        const findPart = document.createElement('div');\n        findPart.className = 'find-part';\n        findPart.appendChild(this._findInput.domNode);\n        const actionsContainer = document.createElement('div');\n        actionsContainer.className = 'find-actions';\n        findPart.appendChild(actionsContainer);\n        actionsContainer.appendChild(this._matchesCount);\n        actionsContainer.appendChild(this._prevBtn.domNode);\n        actionsContainer.appendChild(this._nextBtn.domNode);\n        // Toggle selection button\n        this._toggleSelectionFind = this._register(new Toggle({\n            icon: findSelectionIcon,\n            title: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),\n            isChecked: false,\n            inputActiveOptionBackground: asCssVariable(inputActiveOptionBackground),\n            inputActiveOptionBorder: asCssVariable(inputActiveOptionBorder),\n            inputActiveOptionForeground: asCssVariable(inputActiveOptionForeground),\n        }));\n        this._register(this._toggleSelectionFind.onChange(() => {\n            if (this._toggleSelectionFind.checked) {\n                if (this._codeEditor.hasModel()) {\n                    let selections = this._codeEditor.getSelections();\n                    selections = selections.map(selection => {\n                        if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                            selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                        }\n                        if (!selection.isEmpty()) {\n                            return selection;\n                        }\n                        return null;\n                    }).filter((element) => !!element);\n                    if (selections.length) {\n                        this._state.change({ searchScope: selections }, true);\n                    }\n                }\n            }\n            else {\n                this._state.change({ searchScope: null }, true);\n            }\n        }));\n        actionsContainer.appendChild(this._toggleSelectionFind.domNode);\n        // Close button\n        this._closeBtn = this._register(new SimpleButton({\n            label: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),\n            icon: widgetClose,\n            onTrigger: () => {\n                this._state.change({ isRevealed: false, searchScope: null }, false);\n            },\n            onKeyDown: (e) => {\n                if (e.equals(2 /* KeyCode.Tab */)) {\n                    if (this._isReplaceVisible) {\n                        if (this._replaceBtn.isEnabled()) {\n                            this._replaceBtn.focus();\n                        }\n                        else {\n                            this._codeEditor.focus();\n                        }\n                        e.preventDefault();\n                    }\n                }\n            }\n        }));\n        // Replace input\n        this._replaceInput = this._register(new ContextScopedReplaceInput(null, undefined, {\n            label: NLS_REPLACE_INPUT_LABEL,\n            placeholder: NLS_REPLACE_INPUT_PLACEHOLDER,\n            appendPreserveCaseLabel: this._keybindingLabelFor(FIND_IDS.TogglePreserveCaseCommand),\n            history: [],\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight: 118,\n            showHistoryHint: () => showHistoryKeybindingHint(this._keybindingService),\n            inputBoxStyles: defaultInputBoxStyles,\n            toggleStyles: defaultToggleStyles\n        }, this._contextKeyService, true));\n        this._replaceInput.setPreserveCase(!!this._state.preserveCase);\n        this._register(this._replaceInput.onKeyDown((e) => this._onReplaceInputKeyDown(e)));\n        this._register(this._replaceInput.inputBox.onDidChange(() => {\n            this._state.change({ replaceString: this._replaceInput.inputBox.value }, false);\n        }));\n        this._register(this._replaceInput.inputBox.onDidHeightChange((e) => {\n            if (this._isReplaceVisible && this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }));\n        this._register(this._replaceInput.onDidOptionChange(() => {\n            this._state.change({\n                preserveCase: this._replaceInput.getPreserveCase()\n            }, true);\n        }));\n        this._register(this._replaceInput.onPreserveCaseKeyDown((e) => {\n            if (e.equals(2 /* KeyCode.Tab */)) {\n                if (this._prevBtn.isEnabled()) {\n                    this._prevBtn.focus();\n                }\n                else if (this._nextBtn.isEnabled()) {\n                    this._nextBtn.focus();\n                }\n                else if (this._toggleSelectionFind.enabled) {\n                    this._toggleSelectionFind.focus();\n                }\n                else if (this._closeBtn.isEnabled()) {\n                    this._closeBtn.focus();\n                }\n                e.preventDefault();\n            }\n        }));\n        // Replace one button\n        this._replaceBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),\n            icon: findReplaceIcon,\n            onTrigger: () => {\n                this._controller.replace();\n            },\n            onKeyDown: (e) => {\n                if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n                    this._closeBtn.focus();\n                    e.preventDefault();\n                }\n            }\n        }));\n        // Replace all button\n        this._replaceAllBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),\n            icon: findReplaceAllIcon,\n            onTrigger: () => {\n                this._controller.replaceAll();\n            }\n        }));\n        const replacePart = document.createElement('div');\n        replacePart.className = 'replace-part';\n        replacePart.appendChild(this._replaceInput.domNode);\n        const replaceActionsContainer = document.createElement('div');\n        replaceActionsContainer.className = 'replace-actions';\n        replacePart.appendChild(replaceActionsContainer);\n        replaceActionsContainer.appendChild(this._replaceBtn.domNode);\n        replaceActionsContainer.appendChild(this._replaceAllBtn.domNode);\n        // Toggle replace button\n        this._toggleReplaceBtn = this._register(new SimpleButton({\n            label: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\n            className: 'codicon toggle left',\n            onTrigger: () => {\n                this._state.change({ isReplaceRevealed: !this._isReplaceVisible }, false);\n                if (this._isReplaceVisible) {\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                    this._replaceInput.inputBox.layout();\n                }\n                this._showViewZone();\n            }\n        }));\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        // Widget\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'editor-widget find-widget';\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._domNode.ariaLabel = NLS_FIND_DIALOG_LABEL;\n        this._domNode.role = 'dialog';\n        // We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\n        this._domNode.style.width = `${FIND_WIDGET_INITIAL_WIDTH}px`;\n        this._domNode.appendChild(this._toggleReplaceBtn.domNode);\n        this._domNode.appendChild(findPart);\n        this._domNode.appendChild(this._closeBtn.domNode);\n        this._domNode.appendChild(replacePart);\n        this._resizeSash = this._register(new Sash(this._domNode, this, { orientation: 0 /* Orientation.VERTICAL */, size: 2 }));\n        this._resized = false;\n        let originalWidth = FIND_WIDGET_INITIAL_WIDTH;\n        this._register(this._resizeSash.onDidStart(() => {\n            originalWidth = dom.getTotalWidth(this._domNode);\n        }));\n        this._register(this._resizeSash.onDidChange((evt) => {\n            this._resized = true;\n            const width = originalWidth + evt.startX - evt.currentX;\n            if (width < FIND_WIDGET_INITIAL_WIDTH) {\n                // narrow down the find widget should be handled by CSS.\n                return;\n            }\n            const maxWidth = parseFloat(dom.getComputedStyle(this._domNode).maxWidth) || 0;\n            if (width > maxWidth) {\n                return;\n            }\n            this._domNode.style.width = `${width}px`;\n            if (this._isReplaceVisible) {\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n            }\n            this._findInput.inputBox.layout();\n            this._tryUpdateHeight();\n        }));\n        this._register(this._resizeSash.onDidReset(() => {\n            // users double click on the sash\n            const currentWidth = dom.getTotalWidth(this._domNode);\n            if (currentWidth < FIND_WIDGET_INITIAL_WIDTH) {\n                // The editor is narrow and the width of the find widget is controlled fully by CSS.\n                return;\n            }\n            let width = FIND_WIDGET_INITIAL_WIDTH;\n            if (!this._resized || currentWidth === FIND_WIDGET_INITIAL_WIDTH) {\n                // 1. never resized before, double click should maximizes it\n                // 2. users resized it already but its width is the same as default\n                const layoutInfo = this._codeEditor.getLayoutInfo();\n                width = layoutInfo.width - 28 - layoutInfo.minimap.minimapWidth - 15;\n                this._resized = true;\n            }\n            else {\n                /**\n                 * no op, the find widget should be shrinked to its default size.\n                 */\n            }\n            this._domNode.style.width = `${width}px`;\n            if (this._isReplaceVisible) {\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n            }\n            this._findInput.inputBox.layout();\n        }));\n    }\n    updateAccessibilitySupport() {\n        const value = this._codeEditor.getOption(2 /* EditorOption.accessibilitySupport */);\n        this._findInput.setFocusInputOnOptionClick(value !== 2 /* AccessibilitySupport.Enabled */);\n    }\n}\nFindWidget.ID = 'editor.contrib.findWidget';\nexport class SimpleButton extends Widget {\n    constructor(opts) {\n        super();\n        this._opts = opts;\n        let className = 'button';\n        if (this._opts.className) {\n            className = className + ' ' + this._opts.className;\n        }\n        if (this._opts.icon) {\n            className = className + ' ' + ThemeIcon.asClassName(this._opts.icon);\n        }\n        this._domNode = document.createElement('div');\n        this._domNode.title = this._opts.label;\n        this._domNode.tabIndex = 0;\n        this._domNode.className = className;\n        this._domNode.setAttribute('role', 'button');\n        this._domNode.setAttribute('aria-label', this._opts.label);\n        this.onclick(this._domNode, (e) => {\n            this._opts.onTrigger();\n            e.preventDefault();\n        });\n        this.onkeydown(this._domNode, (e) => {\n            var _a, _b;\n            if (e.equals(10 /* KeyCode.Space */) || e.equals(3 /* KeyCode.Enter */)) {\n                this._opts.onTrigger();\n                e.preventDefault();\n                return;\n            }\n            (_b = (_a = this._opts).onKeyDown) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        });\n    }\n    get domNode() {\n        return this._domNode;\n    }\n    isEnabled() {\n        return (this._domNode.tabIndex >= 0);\n    }\n    focus() {\n        this._domNode.focus();\n    }\n    setEnabled(enabled) {\n        this._domNode.classList.toggle('disabled', !enabled);\n        this._domNode.setAttribute('aria-disabled', String(!enabled));\n        this._domNode.tabIndex = enabled ? 0 : -1;\n    }\n    setExpanded(expanded) {\n        this._domNode.setAttribute('aria-expanded', String(!!expanded));\n        if (expanded) {\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findCollapsedIcon));\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findExpandedIcon));\n        }\n        else {\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findExpandedIcon));\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findCollapsedIcon));\n        }\n    }\n}\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\n    if (findMatchHighlightBorder) {\n        collector.addRule(`.monaco-editor .findMatch { border: 1px ${isHighContrast(theme.type) ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\n    }\n    const findRangeHighlightBorder = theme.getColor(editorFindRangeHighlightBorder);\n    if (findRangeHighlightBorder) {\n        collector.addRule(`.monaco-editor .findScope { border: 1px ${isHighContrast(theme.type) ? 'dashed' : 'solid'} ${findRangeHighlightBorder}; }`);\n    }\n    const hcBorder = theme.getColor(contrastBorder);\n    if (hcBorder) {\n        collector.addRule(`.monaco-editor .find-widget { border: 1px solid ${hcBorder}; }`);\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../dom.js';\nimport { Toggle } from '../toggle/toggle.js';\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\nimport { Widget } from '../widget.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { Emitter } from '../../../common/event.js';\nimport './findInput.css';\nimport * as nls from '../../../../nls.js';\nconst NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\nconst NLS_PRESERVE_CASE_LABEL = nls.localize('label.preserveCaseToggle', \"Preserve Case\");\nclass PreserveCaseToggle extends Toggle {\n    constructor(opts) {\n        super({\n            // TODO: does this need its own icon?\n            icon: Codicon.preserveCase,\n            title: NLS_PRESERVE_CASE_LABEL + opts.appendTitle,\n            isChecked: opts.isChecked,\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\n            inputActiveOptionForeground: opts.inputActiveOptionForeground,\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\n        });\n    }\n}\nexport class ReplaceInput extends Widget {\n    constructor(parent, contextViewProvider, _showOptionButtons, options) {\n        super();\n        this._showOptionButtons = _showOptionButtons;\n        this.fixFocusOnOptionClickEnabled = true;\n        this.cachedOptionsWidth = 0;\n        this._onDidOptionChange = this._register(new Emitter());\n        this.onDidOptionChange = this._onDidOptionChange.event;\n        this._onKeyDown = this._register(new Emitter());\n        this.onKeyDown = this._onKeyDown.event;\n        this._onMouseDown = this._register(new Emitter());\n        this._onInput = this._register(new Emitter());\n        this._onKeyUp = this._register(new Emitter());\n        this._onPreserveCaseKeyDown = this._register(new Emitter());\n        this.onPreserveCaseKeyDown = this._onPreserveCaseKeyDown.event;\n        this.contextViewProvider = contextViewProvider;\n        this.placeholder = options.placeholder || '';\n        this.validation = options.validation;\n        this.label = options.label || NLS_DEFAULT_LABEL;\n        const appendPreserveCaseLabel = options.appendPreserveCaseLabel || '';\n        const history = options.history || [];\n        const flexibleHeight = !!options.flexibleHeight;\n        const flexibleWidth = !!options.flexibleWidth;\n        const flexibleMaxHeight = options.flexibleMaxHeight;\n        this.domNode = document.createElement('div');\n        this.domNode.classList.add('monaco-findInput');\n        this.inputBox = this._register(new HistoryInputBox(this.domNode, this.contextViewProvider, {\n            ariaLabel: this.label || '',\n            placeholder: this.placeholder || '',\n            validationOptions: {\n                validation: this.validation\n            },\n            history,\n            showHistoryHint: options.showHistoryHint,\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight,\n            inputBoxStyles: options.inputBoxStyles\n        }));\n        this.preserveCase = this._register(new PreserveCaseToggle({\n            appendTitle: appendPreserveCaseLabel,\n            isChecked: false,\n            ...options.toggleStyles\n        }));\n        this._register(this.preserveCase.onChange(viaKeyboard => {\n            this._onDidOptionChange.fire(viaKeyboard);\n            if (!viaKeyboard && this.fixFocusOnOptionClickEnabled) {\n                this.inputBox.focus();\n            }\n            this.validate();\n        }));\n        this._register(this.preserveCase.onKeyDown(e => {\n            this._onPreserveCaseKeyDown.fire(e);\n        }));\n        if (this._showOptionButtons) {\n            this.cachedOptionsWidth = this.preserveCase.width();\n        }\n        else {\n            this.cachedOptionsWidth = 0;\n        }\n        // Arrow-Key support to navigate between options\n        const indexes = [this.preserveCase.domNode];\n        this.onkeydown(this.domNode, (event) => {\n            if (event.equals(15 /* KeyCode.LeftArrow */) || event.equals(17 /* KeyCode.RightArrow */) || event.equals(9 /* KeyCode.Escape */)) {\n                const index = indexes.indexOf(this.domNode.ownerDocument.activeElement);\n                if (index >= 0) {\n                    let newIndex = -1;\n                    if (event.equals(17 /* KeyCode.RightArrow */)) {\n                        newIndex = (index + 1) % indexes.length;\n                    }\n                    else if (event.equals(15 /* KeyCode.LeftArrow */)) {\n                        if (index === 0) {\n                            newIndex = indexes.length - 1;\n                        }\n                        else {\n                            newIndex = index - 1;\n                        }\n                    }\n                    if (event.equals(9 /* KeyCode.Escape */)) {\n                        indexes[index].blur();\n                        this.inputBox.focus();\n                    }\n                    else if (newIndex >= 0) {\n                        indexes[newIndex].focus();\n                    }\n                    dom.EventHelper.stop(event, true);\n                }\n            }\n        });\n        const controls = document.createElement('div');\n        controls.className = 'controls';\n        controls.style.display = this._showOptionButtons ? 'block' : 'none';\n        controls.appendChild(this.preserveCase.domNode);\n        this.domNode.appendChild(controls);\n        parent === null || parent === void 0 ? void 0 : parent.appendChild(this.domNode);\n        this.onkeydown(this.inputBox.inputElement, (e) => this._onKeyDown.fire(e));\n        this.onkeyup(this.inputBox.inputElement, (e) => this._onKeyUp.fire(e));\n        this.oninput(this.inputBox.inputElement, (e) => this._onInput.fire());\n        this.onmousedown(this.inputBox.inputElement, (e) => this._onMouseDown.fire(e));\n    }\n    enable() {\n        this.domNode.classList.remove('disabled');\n        this.inputBox.enable();\n        this.preserveCase.enable();\n    }\n    disable() {\n        this.domNode.classList.add('disabled');\n        this.inputBox.disable();\n        this.preserveCase.disable();\n    }\n    setEnabled(enabled) {\n        if (enabled) {\n            this.enable();\n        }\n        else {\n            this.disable();\n        }\n    }\n    select() {\n        this.inputBox.select();\n    }\n    focus() {\n        this.inputBox.focus();\n    }\n    getPreserveCase() {\n        return this.preserveCase.checked;\n    }\n    setPreserveCase(value) {\n        this.preserveCase.checked = value;\n    }\n    focusOnPreserve() {\n        this.preserveCase.focus();\n    }\n    validate() {\n        var _a;\n        (_a = this.inputBox) === null || _a === void 0 ? void 0 : _a.validate();\n    }\n    set width(newWidth) {\n        this.inputBox.paddingRight = this.cachedOptionsWidth;\n        this.domNode.style.width = newWidth + 'px';\n    }\n    dispose() {\n        super.dispose();\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { FindInput } from '../../../base/browser/ui/findinput/findInput.js';\nimport { ReplaceInput } from '../../../base/browser/ui/findinput/replaceInput.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../contextkey/common/contextkey.js';\nimport { KeybindingsRegistry } from '../../keybinding/common/keybindingsRegistry.js';\nimport { localize } from '../../../nls.js';\nimport { DisposableStore, toDisposable } from '../../../base/common/lifecycle.js';\nimport { isActiveElement } from '../../../base/browser/dom.js';\nexport const historyNavigationVisible = new RawContextKey('suggestWidgetVisible', false, localize('suggestWidgetVisible', \"Whether suggestion are visible\"));\nconst HistoryNavigationWidgetFocusContext = 'historyNavigationWidgetFocus';\nconst HistoryNavigationForwardsEnablementContext = 'historyNavigationForwardsEnabled';\nconst HistoryNavigationBackwardsEnablementContext = 'historyNavigationBackwardsEnabled';\nlet lastFocusedWidget = undefined;\nconst widgets = [];\nexport function registerAndCreateHistoryNavigationContext(scopedContextKeyService, widget) {\n    if (widgets.includes(widget)) {\n        throw new Error('Cannot register the same widget multiple times');\n    }\n    widgets.push(widget);\n    const disposableStore = new DisposableStore();\n    const historyNavigationWidgetFocus = new RawContextKey(HistoryNavigationWidgetFocusContext, false).bindTo(scopedContextKeyService);\n    const historyNavigationForwardsEnablement = new RawContextKey(HistoryNavigationForwardsEnablementContext, true).bindTo(scopedContextKeyService);\n    const historyNavigationBackwardsEnablement = new RawContextKey(HistoryNavigationBackwardsEnablementContext, true).bindTo(scopedContextKeyService);\n    const onDidFocus = () => {\n        historyNavigationWidgetFocus.set(true);\n        lastFocusedWidget = widget;\n    };\n    const onDidBlur = () => {\n        historyNavigationWidgetFocus.set(false);\n        if (lastFocusedWidget === widget) {\n            lastFocusedWidget = undefined;\n        }\n    };\n    // Check for currently being focused\n    if (isActiveElement(widget.element)) {\n        onDidFocus();\n    }\n    disposableStore.add(widget.onDidFocus(() => onDidFocus()));\n    disposableStore.add(widget.onDidBlur(() => onDidBlur()));\n    disposableStore.add(toDisposable(() => {\n        widgets.splice(widgets.indexOf(widget), 1);\n        onDidBlur();\n    }));\n    return {\n        historyNavigationForwardsEnablement,\n        historyNavigationBackwardsEnablement,\n        dispose() {\n            disposableStore.dispose();\n        }\n    };\n}\nlet ContextScopedFindInput = class ContextScopedFindInput extends FindInput {\n    constructor(container, contextViewProvider, options, contextKeyService) {\n        super(container, contextViewProvider, options);\n        const scopedContextKeyService = this._register(contextKeyService.createScoped(this.inputBox.element));\n        this._register(registerAndCreateHistoryNavigationContext(scopedContextKeyService, this.inputBox));\n    }\n};\nContextScopedFindInput = __decorate([\n    __param(3, IContextKeyService)\n], ContextScopedFindInput);\nexport { ContextScopedFindInput };\nlet ContextScopedReplaceInput = class ContextScopedReplaceInput extends ReplaceInput {\n    constructor(container, contextViewProvider, options, contextKeyService, showReplaceOptions = false) {\n        super(container, contextViewProvider, showReplaceOptions, options);\n        const scopedContextKeyService = this._register(contextKeyService.createScoped(this.inputBox.element));\n        this._register(registerAndCreateHistoryNavigationContext(scopedContextKeyService, this.inputBox));\n    }\n};\nContextScopedReplaceInput = __decorate([\n    __param(3, IContextKeyService)\n], ContextScopedReplaceInput);\nexport { ContextScopedReplaceInput };\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'history.showPrevious',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext), ContextKeyExpr.equals(HistoryNavigationBackwardsEnablementContext, true), ContextKeyExpr.not('isComposing'), historyNavigationVisible.isEqualTo(false)),\n    primary: 16 /* KeyCode.UpArrow */,\n    secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n    handler: (accessor) => {\n        lastFocusedWidget === null || lastFocusedWidget === void 0 ? void 0 : lastFocusedWidget.showPreviousValue();\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'history.showNext',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetFocusContext), ContextKeyExpr.equals(HistoryNavigationForwardsEnablementContext, true), ContextKeyExpr.not('isComposing'), historyNavigationVisible.isEqualTo(false)),\n    primary: 18 /* KeyCode.DownArrow */,\n    secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n    handler: (accessor) => {\n        lastFocusedWidget === null || lastFocusedWidget === void 0 ? void 0 : lastFocusedWidget.showNextValue();\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function showHistoryKeybindingHint(keybindingService) {\n    var _a, _b;\n    return ((_a = keybindingService.lookupKeybinding('history.showPrevious')) === null || _a === void 0 ? void 0 : _a.getElectronAccelerator()) === 'Up' && ((_b = keybindingService.lookupKeybinding('history.showNext')) === null || _b === void 0 ? void 0 : _b.getElectronAccelerator()) === 'Down';\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar FoldingController_1;\nimport { createCancelablePromise, Delayer, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport * as types from '../../../../base/common/types.js';\nimport './folding.css';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { FoldingRangeKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingModel, getNextFoldLine, getParentFoldLine as getParentFoldLine, getPreviousFoldLine, setCollapseStateAtLevel, setCollapseStateForMatchingLines, setCollapseStateForRest, setCollapseStateForType, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateUp, toggleCollapseState } from './foldingModel.js';\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\nimport { IndentRangeProvider } from './indentRangeProvider.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { FoldingDecorationProvider } from './foldingDecorations.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { SyntaxRangeProvider } from './syntaxRangeProvider.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\nlet FoldingController = FoldingController_1 = class FoldingController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(FoldingController_1.ID);\n    }\n    static getFoldingRangeProviders(languageFeaturesService, model) {\n        var _a, _b;\n        const foldingRangeProviders = languageFeaturesService.foldingRangeProvider.ordered(model);\n        return (_b = ((_a = FoldingController_1._foldingRangeSelector) === null || _a === void 0 ? void 0 : _a.call(FoldingController_1, foldingRangeProviders, model))) !== null && _b !== void 0 ? _b : foldingRangeProviders;\n    }\n    constructor(editor, contextKeyService, languageConfigurationService, notificationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.localToDispose = this._register(new DisposableStore());\n        this.editor = editor;\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n        const options = this.editor.getOptions();\n        this._isEnabled = options.get(43 /* EditorOption.folding */);\n        this._useFoldingProviders = options.get(44 /* EditorOption.foldingStrategy */) !== 'indentation';\n        this._unfoldOnClickAfterEndOfLine = options.get(48 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n        this._restoringViewState = false;\n        this._currentModelHasFoldedImports = false;\n        this._foldingImportsByDefault = options.get(46 /* EditorOption.foldingImportsByDefault */);\n        this.updateDebounceInfo = languageFeatureDebounceService.for(languageFeaturesService.foldingRangeProvider, 'Folding', { min: 200 });\n        this.foldingModel = null;\n        this.hiddenRangeModel = null;\n        this.rangeProvider = null;\n        this.foldingRegionPromise = null;\n        this.foldingModelPromise = null;\n        this.updateScheduler = null;\n        this.cursorChangedScheduler = null;\n        this.mouseDownInfo = null;\n        this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\n        this.foldingDecorationProvider.showFoldingControls = options.get(110 /* EditorOption.showFoldingControls */);\n        this.foldingDecorationProvider.showFoldingHighlights = options.get(45 /* EditorOption.foldingHighlight */);\n        this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService);\n        this.foldingEnabled.set(this._isEnabled);\n        this._register(this.editor.onDidChangeModel(() => this.onModelChanged()));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(43 /* EditorOption.folding */)) {\n                this._isEnabled = this.editor.getOptions().get(43 /* EditorOption.folding */);\n                this.foldingEnabled.set(this._isEnabled);\n                this.onModelChanged();\n            }\n            if (e.hasChanged(47 /* EditorOption.foldingMaximumRegions */)) {\n                this.onModelChanged();\n            }\n            if (e.hasChanged(110 /* EditorOption.showFoldingControls */) || e.hasChanged(45 /* EditorOption.foldingHighlight */)) {\n                const options = this.editor.getOptions();\n                this.foldingDecorationProvider.showFoldingControls = options.get(110 /* EditorOption.showFoldingControls */);\n                this.foldingDecorationProvider.showFoldingHighlights = options.get(45 /* EditorOption.foldingHighlight */);\n                this.triggerFoldingModelChanged();\n            }\n            if (e.hasChanged(44 /* EditorOption.foldingStrategy */)) {\n                this._useFoldingProviders = this.editor.getOptions().get(44 /* EditorOption.foldingStrategy */) !== 'indentation';\n                this.onFoldingStrategyChanged();\n            }\n            if (e.hasChanged(48 /* EditorOption.unfoldOnClickAfterEndOfLine */)) {\n                this._unfoldOnClickAfterEndOfLine = this.editor.getOptions().get(48 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n            }\n            if (e.hasChanged(46 /* EditorOption.foldingImportsByDefault */)) {\n                this._foldingImportsByDefault = this.editor.getOptions().get(46 /* EditorOption.foldingImportsByDefault */);\n            }\n        }));\n        this.onModelChanged();\n    }\n    /**\n     * Store view state.\n     */\n    saveViewState() {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\n            return {};\n        }\n        if (this.foldingModel) { // disposed ?\n            const collapsedRegions = this.foldingModel.getMemento();\n            const provider = this.rangeProvider ? this.rangeProvider.id : undefined;\n            return { collapsedRegions, lineCount: model.getLineCount(), provider, foldedImports: this._currentModelHasFoldedImports };\n        }\n        return undefined;\n    }\n    /**\n     * Restore view state.\n     */\n    restoreViewState(state) {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\n            return;\n        }\n        if (!state) {\n            return;\n        }\n        this._currentModelHasFoldedImports = !!state.foldedImports;\n        if (state.collapsedRegions && state.collapsedRegions.length > 0 && this.foldingModel) {\n            this._restoringViewState = true;\n            try {\n                this.foldingModel.applyMemento(state.collapsedRegions);\n            }\n            finally {\n                this._restoringViewState = false;\n            }\n        }\n    }\n    onModelChanged() {\n        this.localToDispose.clear();\n        const model = this.editor.getModel();\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\n            // huge files get no view model, so they cannot support hidden areas\n            return;\n        }\n        this._currentModelHasFoldedImports = false;\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\n        this.localToDispose.add(this.foldingModel);\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\n        this.localToDispose.add(this.hiddenRangeModel);\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(hr => this.onHiddenRangesChanges(hr)));\n        this.updateScheduler = new Delayer(this.updateDebounceInfo.get(model));\n        this.cursorChangedScheduler = new RunOnceScheduler(() => this.revealCursor(), 200);\n        this.localToDispose.add(this.cursorChangedScheduler);\n        this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(() => this.onFoldingStrategyChanged()));\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(() => this.onFoldingStrategyChanged())); // covers model language changes as well\n        this.localToDispose.add(this.editor.onDidChangeModelContent(e => this.onDidChangeModelContent(e)));\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(() => this.onCursorPositionChanged()));\n        this.localToDispose.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\n        this.localToDispose.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\n        this.localToDispose.add({\n            dispose: () => {\n                var _a, _b;\n                if (this.foldingRegionPromise) {\n                    this.foldingRegionPromise.cancel();\n                    this.foldingRegionPromise = null;\n                }\n                (_a = this.updateScheduler) === null || _a === void 0 ? void 0 : _a.cancel();\n                this.updateScheduler = null;\n                this.foldingModel = null;\n                this.foldingModelPromise = null;\n                this.hiddenRangeModel = null;\n                this.cursorChangedScheduler = null;\n                (_b = this.rangeProvider) === null || _b === void 0 ? void 0 : _b.dispose();\n                this.rangeProvider = null;\n            }\n        });\n        this.triggerFoldingModelChanged();\n    }\n    onFoldingStrategyChanged() {\n        var _a;\n        (_a = this.rangeProvider) === null || _a === void 0 ? void 0 : _a.dispose();\n        this.rangeProvider = null;\n        this.triggerFoldingModelChanged();\n    }\n    getRangeProvider(editorModel) {\n        if (this.rangeProvider) {\n            return this.rangeProvider;\n        }\n        const indentRangeProvider = new IndentRangeProvider(editorModel, this.languageConfigurationService, this._foldingLimitReporter);\n        this.rangeProvider = indentRangeProvider; // fallback\n        if (this._useFoldingProviders && this.foldingModel) {\n            const selectedProviders = FoldingController_1.getFoldingRangeProviders(this.languageFeaturesService, editorModel);\n            if (selectedProviders.length > 0) {\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, selectedProviders, () => this.triggerFoldingModelChanged(), this._foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        return this.rangeProvider;\n    }\n    getFoldingModel() {\n        return this.foldingModelPromise;\n    }\n    onDidChangeModelContent(e) {\n        var _a;\n        (_a = this.hiddenRangeModel) === null || _a === void 0 ? void 0 : _a.notifyChangeModelContent(e);\n        this.triggerFoldingModelChanged();\n    }\n    triggerFoldingModelChanged() {\n        if (this.updateScheduler) {\n            if (this.foldingRegionPromise) {\n                this.foldingRegionPromise.cancel();\n                this.foldingRegionPromise = null;\n            }\n            this.foldingModelPromise = this.updateScheduler.trigger(() => {\n                const foldingModel = this.foldingModel;\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\n                    return null;\n                }\n                const sw = new StopWatch();\n                const provider = this.getRangeProvider(foldingModel.textModel);\n                const foldingRegionPromise = this.foldingRegionPromise = createCancelablePromise(token => provider.compute(token));\n                return foldingRegionPromise.then(foldingRanges => {\n                    if (foldingRanges && foldingRegionPromise === this.foldingRegionPromise) { // new request or cancelled in the meantime?\n                        let scrollState;\n                        if (this._foldingImportsByDefault && !this._currentModelHasFoldedImports) {\n                            const hasChanges = foldingRanges.setCollapsedAllOfType(FoldingRangeKind.Imports.value, true);\n                            if (hasChanges) {\n                                scrollState = StableEditorScrollState.capture(this.editor);\n                                this._currentModelHasFoldedImports = hasChanges;\n                            }\n                        }\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\n                        const selections = this.editor.getSelections();\n                        const selectionLineNumbers = selections ? selections.map(s => s.startLineNumber) : [];\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\n                        scrollState === null || scrollState === void 0 ? void 0 : scrollState.restore(this.editor);\n                        // update debounce info\n                        const newValue = this.updateDebounceInfo.update(foldingModel.textModel, sw.elapsed());\n                        if (this.updateScheduler) {\n                            this.updateScheduler.defaultDelay = newValue;\n                        }\n                    }\n                    return foldingModel;\n                });\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return null;\n            });\n        }\n    }\n    onHiddenRangesChanges(hiddenRanges) {\n        if (this.hiddenRangeModel && hiddenRanges.length && !this._restoringViewState) {\n            const selections = this.editor.getSelections();\n            if (selections) {\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\n                    this.editor.setSelections(selections);\n                }\n            }\n        }\n        this.editor.setHiddenAreas(hiddenRanges, this);\n    }\n    onCursorPositionChanged() {\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\n            this.cursorChangedScheduler.schedule();\n        }\n    }\n    revealCursor() {\n        const foldingModel = this.getFoldingModel();\n        if (!foldingModel) {\n            return;\n        }\n        foldingModel.then(foldingModel => {\n            if (foldingModel) {\n                const selections = this.editor.getSelections();\n                if (selections && selections.length > 0) {\n                    const toToggle = [];\n                    for (const selection of selections) {\n                        const lineNumber = selection.selectionStartLineNumber;\n                        if (this.hiddenRangeModel && this.hiddenRangeModel.isHidden(lineNumber)) {\n                            toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber, r => r.isCollapsed && lineNumber > r.startLineNumber));\n                        }\n                    }\n                    if (toToggle.length) {\n                        foldingModel.toggleCollapseState(toToggle);\n                        this.reveal(selections[0].getPosition());\n                    }\n                }\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    onEditorMouseDown(e) {\n        this.mouseDownInfo = null;\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\n            return;\n        }\n        if (!e.event.leftButton && !e.event.middleButton) {\n            return;\n        }\n        const range = e.target.range;\n        let iconClicked = false;\n        switch (e.target.type) {\n            case 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */: {\n                const data = e.target.detail;\n                const offsetLeftInGutter = e.target.element.offsetLeft;\n                const gutterOffsetX = data.offsetX - offsetLeftInGutter;\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\n                if (gutterOffsetX < 4) { // the whitespace between the border and the real folding icon border is 4px\n                    return;\n                }\n                iconClicked = true;\n                break;\n            }\n            case 7 /* MouseTargetType.CONTENT_EMPTY */: {\n                if (this._unfoldOnClickAfterEndOfLine && this.hiddenRangeModel.hasRanges()) {\n                    const data = e.target.detail;\n                    if (!data.isAfterLines) {\n                        break;\n                    }\n                }\n                return;\n            }\n            case 6 /* MouseTargetType.CONTENT_TEXT */: {\n                if (this.hiddenRangeModel.hasRanges()) {\n                    const model = this.editor.getModel();\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\n                        break;\n                    }\n                }\n                return;\n            }\n            default:\n                return;\n        }\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\n    }\n    onEditorMouseUp(e) {\n        const foldingModel = this.foldingModel;\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\n            return;\n        }\n        const lineNumber = this.mouseDownInfo.lineNumber;\n        const iconClicked = this.mouseDownInfo.iconClicked;\n        const range = e.target.range;\n        if (!range || range.startLineNumber !== lineNumber) {\n            return;\n        }\n        if (iconClicked) {\n            if (e.target.type !== 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */) {\n                return;\n            }\n        }\n        else {\n            const model = this.editor.getModel();\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\n                return;\n            }\n        }\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region && region.startLineNumber === lineNumber) {\n            const isCollapsed = region.isCollapsed;\n            if (iconClicked || isCollapsed) {\n                const surrounding = e.event.altKey;\n                let toToggle = [];\n                if (surrounding) {\n                    const filter = (otherRegion) => !otherRegion.containedBy(region) && !region.containedBy(otherRegion);\n                    const toMaybeToggle = foldingModel.getRegionsInside(null, filter);\n                    for (const r of toMaybeToggle) {\n                        if (r.isCollapsed) {\n                            toToggle.push(r);\n                        }\n                    }\n                    // if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\n                    if (toToggle.length === 0) {\n                        toToggle = toMaybeToggle;\n                    }\n                }\n                else {\n                    const recursive = e.event.middleButton || e.event.shiftKey;\n                    if (recursive) {\n                        for (const r of foldingModel.getRegionsInside(region)) {\n                            if (r.isCollapsed === isCollapsed) {\n                                toToggle.push(r);\n                            }\n                        }\n                    }\n                    // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\n                    if (isCollapsed || !recursive || toToggle.length === 0) {\n                        toToggle.push(region);\n                    }\n                }\n                foldingModel.toggleCollapseState(toToggle);\n                this.reveal({ lineNumber, column: 1 });\n            }\n        }\n    }\n    reveal(position) {\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n    }\n};\nFoldingController.ID = 'editor.contrib.folding';\nFoldingController = FoldingController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageConfigurationService),\n    __param(3, INotificationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], FoldingController);\nexport { FoldingController };\nexport class RangesLimitReporter {\n    constructor(editor) {\n        this.editor = editor;\n        this._onDidChange = new Emitter();\n        this._computed = 0;\n        this._limited = false;\n    }\n    get limit() {\n        return this.editor.getOptions().get(47 /* EditorOption.foldingMaximumRegions */);\n    }\n    update(computed, limited) {\n        if (computed !== this._computed || limited !== this._limited) {\n            this._computed = computed;\n            this._limited = limited;\n            this._onDidChange.fire();\n        }\n    }\n}\nclass FoldingAction extends EditorAction {\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const foldingController = FoldingController.get(editor);\n        if (!foldingController) {\n            return;\n        }\n        const foldingModelPromise = foldingController.getFoldingModel();\n        if (foldingModelPromise) {\n            this.reportTelemetry(accessor, editor);\n            return foldingModelPromise.then(foldingModel => {\n                if (foldingModel) {\n                    this.invoke(foldingController, foldingModel, editor, args, languageConfigurationService);\n                    const selection = editor.getSelection();\n                    if (selection) {\n                        foldingController.reveal(selection.getStartPosition());\n                    }\n                }\n            });\n        }\n    }\n    getSelectedLines(editor) {\n        const selections = editor.getSelections();\n        return selections ? selections.map(s => s.startLineNumber) : [];\n    }\n    getLineNumbers(args, editor) {\n        if (args && args.selectionLines) {\n            return args.selectionLines.map(l => l + 1); // to 0-bases line numbers\n        }\n        return this.getSelectedLines(editor);\n    }\n    run(_accessor, _editor) {\n    }\n}\nfunction foldingArgumentsConstraint(args) {\n    if (!types.isUndefined(args)) {\n        if (!types.isObject(args)) {\n            return false;\n        }\n        const foldingArgs = args;\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!Array.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\n            return false;\n        }\n    }\n    return true;\n}\nclass UnfoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfold',\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\n            alias: 'Unfold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 94 /* KeyCode.BracketRight */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: 'Unfold the content in the editor',\n                args: [\n                    {\n                        name: 'Unfold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                    'default': 1\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                    'default': 'down'\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const levels = args && args.levels || 1;\n        const lineNumbers = this.getLineNumbers(args, editor);\n        if (args && args.direction === 'up') {\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\n        }\n        else {\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\n        }\n    }\n}\nclass UnFoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldRecursively',\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\n            alias: 'Unfold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 94 /* KeyCode.BracketRight */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, _args) {\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\n    }\n}\nclass FoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.fold',\n            label: nls.localize('foldAction.label', \"Fold\"),\n            alias: 'Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 92 /* KeyCode.BracketLeft */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: 'Fold the content in the editor',\n                args: [\n                    {\n                        name: 'Fold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const lineNumbers = this.getLineNumbers(args, editor);\n        const levels = args && args.levels;\n        const direction = args && args.direction;\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\n            setCollapseStateUp(foldingModel, true, lineNumbers);\n        }\n        else {\n            if (direction === 'up') {\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\n            }\n            else {\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\n            }\n        }\n    }\n}\nclass ToggleFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.toggleFold',\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\n            alias: 'Toggle Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        toggleCollapseState(foldingModel, 1, selectedLines);\n    }\n}\nclass FoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldRecursively',\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\n            alias: 'Fold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 92 /* KeyCode.BracketLeft */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\n    }\n}\nclass FoldAllBlockCommentsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllBlockComments',\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\n            alias: 'Fold All Block Comments',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const comments = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).comments;\n            if (comments && comments.blockCommentStartToken) {\n                const regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass FoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllMarkerRegions',\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\n            alias: 'Fold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 29 /* KeyCode.Digit8 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass UnfoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllMarkerRegions',\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\n            alias: 'Unfold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 30 /* KeyCode.Digit9 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\n            }\n        }\n    }\n}\nclass FoldAllExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllExcept',\n            label: nls.localize('foldAllExcept.label', \"Fold All Except Selected\"),\n            alias: 'Fold All Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 88 /* KeyCode.Minus */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, true, selectedLines);\n    }\n}\nclass UnfoldAllExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllExcept',\n            label: nls.localize('unfoldAllExcept.label', \"Unfold All Except Selected\"),\n            alias: 'Unfold All Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 86 /* KeyCode.Equal */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, false, selectedLines);\n    }\n}\nclass FoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAll',\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\n            alias: 'Fold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 21 /* KeyCode.Digit0 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, true);\n    }\n}\nclass UnfoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAll',\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\n            alias: 'Unfold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 40 /* KeyCode.KeyJ */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, false);\n    }\n}\nclass FoldLevelAction extends FoldingAction {\n    getFoldingLevel() {\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\n    }\n}\nFoldLevelAction.ID_PREFIX = 'editor.foldLevel';\nFoldLevelAction.ID = (level) => FoldLevelAction.ID_PREFIX + level;\n/** Action to go to the parent fold of current line */\nclass GotoParentFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoParentFold',\n            label: nls.localize('gotoParentFold.label', \"Go to Parent Fold\"),\n            alias: 'Go to Parent Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getParentFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the previous fold of current line */\nclass GotoPreviousFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoPreviousFold',\n            label: nls.localize('gotoPreviousFold.label', \"Go to Previous Folding Range\"),\n            alias: 'Go to Previous Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getPreviousFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the next fold of current line */\nclass GotoNextFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoNextFold',\n            label: nls.localize('gotoNextFold.label', \"Go to Next Folding Range\"),\n            alias: 'Go to Next Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getNextFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\nclass FoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.createFoldingRangeFromSelection',\n            label: nls.localize('createManualFoldRange.label', \"Create Folding Range from Selection\"),\n            alias: 'Create Folding Range from Selection',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 87 /* KeyCode.Comma */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        var _a;\n        const collapseRanges = [];\n        const selections = editor.getSelections();\n        if (selections) {\n            for (const selection of selections) {\n                let endLineNumber = selection.endLineNumber;\n                if (selection.endColumn === 1) {\n                    --endLineNumber;\n                }\n                if (endLineNumber > selection.startLineNumber) {\n                    collapseRanges.push({\n                        startLineNumber: selection.startLineNumber,\n                        endLineNumber: endLineNumber,\n                        type: undefined,\n                        isCollapsed: true,\n                        source: 1 /* FoldSource.userDefined */\n                    });\n                    editor.setSelection({\n                        startLineNumber: selection.startLineNumber,\n                        startColumn: 1,\n                        endLineNumber: selection.startLineNumber,\n                        endColumn: 1\n                    });\n                }\n            }\n            if (collapseRanges.length > 0) {\n                collapseRanges.sort((a, b) => {\n                    return a.startLineNumber - b.startLineNumber;\n                });\n                const newRanges = FoldingRegions.sanitizeAndMerge(foldingModel.regions, collapseRanges, (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLineCount());\n                foldingModel.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n            }\n        }\n    }\n}\nclass RemoveFoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.removeManualFoldingRanges',\n            label: nls.localize('removeManualFoldingRanges.label', \"Remove Manual Folding Ranges\"),\n            alias: 'Remove Manual Folding Ranges',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(foldingController, foldingModel, editor) {\n        const selections = editor.getSelections();\n        if (selections) {\n            const ranges = [];\n            for (const selection of selections) {\n                const { startLineNumber, endLineNumber } = selection;\n                ranges.push(endLineNumber >= startLineNumber ? { startLineNumber, endLineNumber } : { endLineNumber, startLineNumber });\n            }\n            foldingModel.removeManualRanges(ranges);\n            foldingController.triggerFoldingModelChanged();\n        }\n    }\n}\nregisterEditorContribution(FoldingController.ID, FoldingController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(UnfoldAction);\nregisterEditorAction(UnFoldRecursivelyAction);\nregisterEditorAction(FoldAction);\nregisterEditorAction(FoldRecursivelyAction);\nregisterEditorAction(FoldAllAction);\nregisterEditorAction(UnfoldAllAction);\nregisterEditorAction(FoldAllBlockCommentsAction);\nregisterEditorAction(FoldAllRegionsAction);\nregisterEditorAction(UnfoldAllRegionsAction);\nregisterEditorAction(FoldAllExceptAction);\nregisterEditorAction(UnfoldAllExceptAction);\nregisterEditorAction(ToggleFoldAction);\nregisterEditorAction(GotoParentFoldAction);\nregisterEditorAction(GotoPreviousFoldAction);\nregisterEditorAction(GotoNextFoldAction);\nregisterEditorAction(FoldRangeFromSelectionAction);\nregisterEditorAction(RemoveFoldRangeFromSelectionAction);\nfor (let i = 1; i <= 7; i++) {\n    registerInstantiatedEditorAction(new FoldLevelAction({\n        id: FoldLevelAction.ID(i),\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\n        alias: `Fold Level ${i}`,\n        precondition: CONTEXT_FOLDING_ENABLED,\n        kbOpts: {\n            kbExpr: EditorContextKeys.editorTextFocus,\n            primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | (21 /* KeyCode.Digit0 */ + i)),\n            weight: 100 /* KeybindingWeight.EditorContrib */\n        }\n    }));\n}\nCommandsRegistry.registerCommand('_executeFoldingRangeProvider', async function (accessor, ...args) {\n    const [resource] = args;\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const configurationService = accessor.get(IConfigurationService);\n    if (!configurationService.getValue('editor.folding', { resource })) {\n        return [];\n    }\n    const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n    const strategy = configurationService.getValue('editor.foldingStrategy', { resource });\n    const foldingLimitReporter = {\n        get limit() {\n            return configurationService.getValue('editor.foldingMaximumRegions', { resource });\n        },\n        update: (computed, limited) => { }\n    };\n    const indentRangeProvider = new IndentRangeProvider(model, languageConfigurationService, foldingLimitReporter);\n    let rangeProvider = indentRangeProvider;\n    if (strategy !== 'indentation') {\n        const providers = FoldingController.getFoldingRangeProviders(languageFeaturesService, model);\n        if (providers.length) {\n            rangeProvider = new SyntaxRangeProvider(model, providers, () => { }, foldingLimitReporter, indentRangeProvider);\n        }\n    }\n    const ranges = await rangeProvider.compute(CancellationToken.None);\n    const result = [];\n    try {\n        if (ranges) {\n            for (let i = 0; i < ranges.length; i++) {\n                const type = ranges.getType(i);\n                result.push({ start: ranges.getStartLineNumber(i), end: ranges.getEndLineNumber(i), kind: type ? FoldingRangeKind.fromValue(type) : undefined });\n            }\n        }\n        return result;\n    }\n    finally {\n        rangeProvider.dispose();\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { hash } from '../../../../base/common/hash.js';\nexport class FoldingModel {\n    get regions() { return this._regions; }\n    get textModel() { return this._textModel; }\n    constructor(textModel, decorationProvider) {\n        this._updateEventEmitter = new Emitter();\n        this.onDidChange = this._updateEventEmitter.event;\n        this._textModel = textModel;\n        this._decorationProvider = decorationProvider;\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\n        this._editorDecorationIds = [];\n    }\n    toggleCollapseState(toggledRegions) {\n        if (!toggledRegions.length) {\n            return;\n        }\n        toggledRegions = toggledRegions.sort((r1, r2) => r1.regionIndex - r2.regionIndex);\n        const processed = {};\n        this._decorationProvider.changeDecorations(accessor => {\n            let k = 0; // index from [0 ... this.regions.length]\n            let dirtyRegionEndLine = -1; // end of the range where decorations need to be updated\n            let lastHiddenLine = -1; // the end of the last hidden lines\n            const updateDecorationsUntil = (index) => {\n                while (k < index) {\n                    const endLineNumber = this._regions.getEndLineNumber(k);\n                    const isCollapsed = this._regions.isCollapsed(k);\n                    if (endLineNumber <= dirtyRegionEndLine) {\n                        const isManual = this.regions.getSource(k) !== 0 /* FoldSource.provider */;\n                        accessor.changeDecorationOptions(this._editorDecorationIds[k], this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual));\n                    }\n                    if (isCollapsed && endLineNumber > lastHiddenLine) {\n                        lastHiddenLine = endLineNumber;\n                    }\n                    k++;\n                }\n            };\n            for (const region of toggledRegions) {\n                const index = region.regionIndex;\n                const editorDecorationId = this._editorDecorationIds[index];\n                if (editorDecorationId && !processed[editorDecorationId]) {\n                    processed[editorDecorationId] = true;\n                    updateDecorationsUntil(index); // update all decorations up to current index using the old dirtyRegionEndLine\n                    const newCollapseState = !this._regions.isCollapsed(index);\n                    this._regions.setCollapsed(index, newCollapseState);\n                    dirtyRegionEndLine = Math.max(dirtyRegionEndLine, this._regions.getEndLineNumber(index));\n                }\n            }\n            updateDecorationsUntil(this._regions.length);\n        });\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: toggledRegions });\n    }\n    removeManualRanges(ranges) {\n        const newFoldingRanges = new Array();\n        const intersects = (foldRange) => {\n            for (const range of ranges) {\n                if (!(range.startLineNumber > foldRange.endLineNumber || foldRange.startLineNumber > range.endLineNumber)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        for (let i = 0; i < this._regions.length; i++) {\n            const foldRange = this._regions.toFoldRange(i);\n            if (foldRange.source === 0 /* FoldSource.provider */ || !intersects(foldRange)) {\n                newFoldingRanges.push(foldRange);\n            }\n        }\n        this.updatePost(FoldingRegions.fromFoldRanges(newFoldingRanges));\n    }\n    update(newRegions, blockedLineNumers = []) {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges(blockedLineNumers);\n        const newRanges = FoldingRegions.sanitizeAndMerge(newRegions, foldedOrManualRanges, this._textModel.getLineCount());\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    updatePost(newRegions) {\n        const newEditorDecorations = [];\n        let lastHiddenLine = -1;\n        for (let index = 0, limit = newRegions.length; index < limit; index++) {\n            const startLineNumber = newRegions.getStartLineNumber(index);\n            const endLineNumber = newRegions.getEndLineNumber(index);\n            const isCollapsed = newRegions.isCollapsed(index);\n            const isManual = newRegions.getSource(index) !== 0 /* FoldSource.provider */;\n            const decorationRange = {\n                startLineNumber: startLineNumber,\n                startColumn: this._textModel.getLineMaxColumn(startLineNumber),\n                endLineNumber: endLineNumber,\n                endColumn: this._textModel.getLineMaxColumn(endLineNumber) + 1\n            };\n            newEditorDecorations.push({ range: decorationRange, options: this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual) });\n            if (isCollapsed && endLineNumber > lastHiddenLine) {\n                lastHiddenLine = endLineNumber;\n            }\n        }\n        this._decorationProvider.changeDecorations(accessor => this._editorDecorationIds = accessor.deltaDecorations(this._editorDecorationIds, newEditorDecorations));\n        this._regions = newRegions;\n        this._updateEventEmitter.fire({ model: this });\n    }\n    _currentFoldedOrManualRanges(blockedLineNumers = []) {\n        const isBlocked = (startLineNumber, endLineNumber) => {\n            for (const blockedLineNumber of blockedLineNumers) {\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\n                    return true;\n                }\n            }\n            return false;\n        };\n        const foldedRanges = [];\n        for (let i = 0, limit = this._regions.length; i < limit; i++) {\n            let isCollapsed = this.regions.isCollapsed(i);\n            const source = this.regions.getSource(i);\n            if (isCollapsed || source !== 0 /* FoldSource.provider */) {\n                const foldRange = this._regions.toFoldRange(i);\n                const decRange = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\n                if (decRange) {\n                    if (isCollapsed && isBlocked(decRange.startLineNumber, decRange.endLineNumber)) {\n                        isCollapsed = false; // uncollapse is the range is blocked\n                    }\n                    foldedRanges.push({\n                        startLineNumber: decRange.startLineNumber,\n                        endLineNumber: decRange.endLineNumber,\n                        type: foldRange.type,\n                        isCollapsed,\n                        source\n                    });\n                }\n            }\n        }\n        return foldedRanges;\n    }\n    /**\n     * Collapse state memento, for persistence only\n     */\n    getMemento() {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges();\n        const result = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (let i = 0, limit = foldedOrManualRanges.length; i < limit; i++) {\n            const range = foldedOrManualRanges[i];\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            result.push({\n                startLineNumber: range.startLineNumber,\n                endLineNumber: range.endLineNumber,\n                isCollapsed: range.isCollapsed,\n                source: range.source,\n                checksum: checksum\n            });\n        }\n        return (result.length > 0) ? result : undefined;\n    }\n    /**\n     * Apply persisted state, for persistence only\n     */\n    applyMemento(state) {\n        var _a, _b;\n        if (!Array.isArray(state)) {\n            return;\n        }\n        const rangesToRestore = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (const range of state) {\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            if (!range.checksum || checksum === range.checksum) {\n                rangesToRestore.push({\n                    startLineNumber: range.startLineNumber,\n                    endLineNumber: range.endLineNumber,\n                    type: undefined,\n                    isCollapsed: (_a = range.isCollapsed) !== null && _a !== void 0 ? _a : true,\n                    source: (_b = range.source) !== null && _b !== void 0 ? _b : 0 /* FoldSource.provider */\n                });\n            }\n        }\n        const newRanges = FoldingRegions.sanitizeAndMerge(this._regions, rangesToRestore, maxLineNumber);\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    _getLinesChecksum(lineNumber1, lineNumber2) {\n        const h = hash(this._textModel.getLineContent(lineNumber1)\n            + this._textModel.getLineContent(lineNumber2));\n        return h % 1000000; // 6 digits is plenty\n    }\n    dispose() {\n        this._decorationProvider.removeDecorations(this._editorDecorationIds);\n    }\n    getAllRegionsAtLine(lineNumber, filter) {\n        const result = [];\n        if (this._regions) {\n            let index = this._regions.findRange(lineNumber);\n            let level = 1;\n            while (index >= 0) {\n                const current = this._regions.toRegion(index);\n                if (!filter || filter(current, level)) {\n                    result.push(current);\n                }\n                level++;\n                index = current.parentIndex;\n            }\n        }\n        return result;\n    }\n    getRegionAtLine(lineNumber) {\n        if (this._regions) {\n            const index = this._regions.findRange(lineNumber);\n            if (index >= 0) {\n                return this._regions.toRegion(index);\n            }\n        }\n        return null;\n    }\n    getRegionsInside(region, filter) {\n        const result = [];\n        const index = region ? region.regionIndex + 1 : 0;\n        const endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\n        if (filter && filter.length === 2) {\n            const levelStack = [];\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\n                        levelStack.pop();\n                    }\n                    levelStack.push(current);\n                    if (filter(current, levelStack.length)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    if (!filter || filter(current)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return result;\n    }\n}\n/**\n * Collapse or expand the regions at the given locations\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region) {\n            const doCollapse = !region.isCollapsed;\n            toToggle.push(region);\n            if (levels > 1) {\n                const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                toToggle.push(...regionsInside);\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all children.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels = Number.MAX_VALUE, lineNumbers) {\n    const toToggle = [];\n    if (lineNumbers && lineNumbers.length > 0) {\n        for (const lineNumber of lineNumbers) {\n            const region = foldingModel.getRegionAtLine(lineNumber);\n            if (region) {\n                if (region.isCollapsed !== doCollapse) {\n                    toToggle.push(region);\n                }\n                if (levels > 1) {\n                    const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                    toToggle.push(...regionsInside);\n                }\n            }\n        }\n    }\n    else {\n        const regionsInside = foldingModel.getRegionsInside(null, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n        toToggle.push(...regionsInside);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all parents.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region, level) => region.isCollapsed !== doCollapse && level <= levels);\n        toToggle.push(...regions);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\n * @param doCollapse Whether to collapse or expand\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region) => region.isCollapsed !== doCollapse);\n        if (regions.length > 0) {\n            toToggle.push(regions[0]);\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\n * @param foldLevel level. Level == 1 is the top level\n * @param doCollapse Whether to collapse or expand\n*/\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\n    const filter = (region, level) => level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(line => region.containsLine(line));\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions, except if they contain or are contained by a region of one of the blocked lines.\n * @param doCollapse Whether to collapse or expand\n * @param blockedLineNumbers the location of regions to not collapse or expand\n */\nexport function setCollapseStateForRest(foldingModel, doCollapse, blockedLineNumbers) {\n    const filteredRegions = [];\n    for (const lineNumber of blockedLineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, undefined);\n        if (regions.length > 0) {\n            filteredRegions.push(regions[0]);\n        }\n    }\n    const filter = (region) => filteredRegions.every((filteredRegion) => !filteredRegion.containedBy(region) && !region.containedBy(filteredRegion)) && region.isCollapsed !== doCollapse;\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions for which the lines start with a given regex\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\n    const editorModel = foldingModel.textModel;\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i)) {\n            const startLineNumber = regions.getStartLineNumber(i);\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\n                toToggle.push(regions.toRegion(i));\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions of the given type\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\n            toToggle.push(regions.toRegion(i));\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Get line to go to for parent fold of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Parent fold start line\n */\nexport function getParentFoldLine(lineNumber, foldingModel) {\n    let startLineNumber = null;\n    const foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    if (foldingRegion !== null) {\n        startLineNumber = foldingRegion.startLineNumber;\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to parent fold\n        if (lineNumber === startLineNumber) {\n            const parentFoldingIdx = foldingRegion.parentIndex;\n            if (parentFoldingIdx !== -1) {\n                startLineNumber = foldingModel.regions.getStartLineNumber(parentFoldingIdx);\n            }\n            else {\n                startLineNumber = null;\n            }\n        }\n    }\n    return startLineNumber;\n}\n/**\n * Get line to go to for previous fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Previous fold start line\n */\nexport function getPreviousFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to previous sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to previous fold.\n        if (lineNumber !== foldingRegion.startLineNumber) {\n            return foldingRegion.startLineNumber;\n        }\n        else {\n            // Find min line number to stay within parent.\n            const expectedParentIndex = foldingRegion.parentIndex;\n            let minLineNumber = 0;\n            if (expectedParentIndex !== -1) {\n                minLineNumber = foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex);\n            }\n            // Find fold at same level.\n            while (foldingRegion !== null) {\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                    // Keep at same level.\n                    if (foldingRegion.startLineNumber <= minLineNumber) {\n                        return null;\n                    }\n                    else if (foldingRegion.parentIndex === expectedParentIndex) {\n                        return foldingRegion.startLineNumber;\n                    }\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    }\n    else {\n        // Go to last fold that's before the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(foldingModel.regions.length - 1);\n            while (foldingRegion !== null) {\n                // Found fold before current line.\n                if (foldingRegion.startLineNumber < lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n/**\n * Get line to go to next fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Next fold start line\n */\nexport function getNextFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to next sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // Find max line number to stay within parent.\n        const expectedParentIndex = foldingRegion.parentIndex;\n        let maxLineNumber = 0;\n        if (expectedParentIndex !== -1) {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);\n        }\n        else if (foldingModel.regions.length === 0) {\n            return null;\n        }\n        else {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingModel.regions.length - 1);\n        }\n        // Find fold at same level.\n        while (foldingRegion !== null) {\n            if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                // Keep at same level.\n                if (foldingRegion.startLineNumber >= maxLineNumber) {\n                    return null;\n                }\n                else if (foldingRegion.parentIndex === expectedParentIndex) {\n                    return foldingRegion.startLineNumber;\n                }\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    else {\n        // Go to first fold that's after the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(0);\n            while (foldingRegion !== null) {\n                // Found fold after current line.\n                if (foldingRegion.startLineNumber > lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const foldSourceAbbr = {\n    [0 /* FoldSource.provider */]: ' ',\n    [1 /* FoldSource.userDefined */]: 'u',\n    [2 /* FoldSource.recovered */]: 'r',\n};\nexport const MAX_FOLDING_REGIONS = 0xFFFF;\nexport const MAX_LINE_NUMBER = 0xFFFFFF;\nconst MASK_INDENT = 0xFF000000;\nclass BitField {\n    constructor(size) {\n        const numWords = Math.ceil(size / 32);\n        this._states = new Uint32Array(numWords);\n    }\n    get(index) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        return (this._states[arrayIndex] & (1 << bit)) !== 0;\n    }\n    set(index, newState) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        const value = this._states[arrayIndex];\n        if (newState) {\n            this._states[arrayIndex] = value | (1 << bit);\n        }\n        else {\n            this._states[arrayIndex] = value & ~(1 << bit);\n        }\n    }\n}\nexport class FoldingRegions {\n    constructor(startIndexes, endIndexes, types) {\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\n            throw new Error('invalid startIndexes or endIndexes size');\n        }\n        this._startIndexes = startIndexes;\n        this._endIndexes = endIndexes;\n        this._collapseStates = new BitField(startIndexes.length);\n        this._userDefinedStates = new BitField(startIndexes.length);\n        this._recoveredStates = new BitField(startIndexes.length);\n        this._types = types;\n        this._parentsComputed = false;\n    }\n    ensureParentIndices() {\n        if (!this._parentsComputed) {\n            this._parentsComputed = true;\n            const parentIndexes = [];\n            const isInsideLast = (startLineNumber, endLineNumber) => {\n                const index = parentIndexes[parentIndexes.length - 1];\n                return this.getStartLineNumber(index) <= startLineNumber && this.getEndLineNumber(index) >= endLineNumber;\n            };\n            for (let i = 0, len = this._startIndexes.length; i < len; i++) {\n                const startLineNumber = this._startIndexes[i];\n                const endLineNumber = this._endIndexes[i];\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\n                }\n                while (parentIndexes.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\n                    parentIndexes.pop();\n                }\n                const parentIndex = parentIndexes.length > 0 ? parentIndexes[parentIndexes.length - 1] : -1;\n                parentIndexes.push(i);\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\n            }\n        }\n    }\n    get length() {\n        return this._startIndexes.length;\n    }\n    getStartLineNumber(index) {\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getEndLineNumber(index) {\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getType(index) {\n        return this._types ? this._types[index] : undefined;\n    }\n    hasTypes() {\n        return !!this._types;\n    }\n    isCollapsed(index) {\n        return this._collapseStates.get(index);\n    }\n    setCollapsed(index, newState) {\n        this._collapseStates.set(index, newState);\n    }\n    isUserDefined(index) {\n        return this._userDefinedStates.get(index);\n    }\n    setUserDefined(index, newState) {\n        return this._userDefinedStates.set(index, newState);\n    }\n    isRecovered(index) {\n        return this._recoveredStates.get(index);\n    }\n    setRecovered(index, newState) {\n        return this._recoveredStates.set(index, newState);\n    }\n    getSource(index) {\n        if (this.isUserDefined(index)) {\n            return 1 /* FoldSource.userDefined */;\n        }\n        else if (this.isRecovered(index)) {\n            return 2 /* FoldSource.recovered */;\n        }\n        return 0 /* FoldSource.provider */;\n    }\n    setSource(index, source) {\n        if (source === 1 /* FoldSource.userDefined */) {\n            this.setUserDefined(index, true);\n            this.setRecovered(index, false);\n        }\n        else if (source === 2 /* FoldSource.recovered */) {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, true);\n        }\n        else {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, false);\n        }\n    }\n    setCollapsedAllOfType(type, newState) {\n        let hasChanged = false;\n        if (this._types) {\n            for (let i = 0; i < this._types.length; i++) {\n                if (this._types[i] === type) {\n                    this.setCollapsed(i, newState);\n                    hasChanged = true;\n                }\n            }\n        }\n        return hasChanged;\n    }\n    toRegion(index) {\n        return new FoldingRegion(this, index);\n    }\n    getParentIndex(index) {\n        this.ensureParentIndices();\n        const parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\n        if (parent === MAX_FOLDING_REGIONS) {\n            return -1;\n        }\n        return parent;\n    }\n    contains(index, line) {\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\n    }\n    findIndex(line) {\n        let low = 0, high = this._startIndexes.length;\n        if (high === 0) {\n            return -1; // no children\n        }\n        while (low < high) {\n            const mid = Math.floor((low + high) / 2);\n            if (line < this.getStartLineNumber(mid)) {\n                high = mid;\n            }\n            else {\n                low = mid + 1;\n            }\n        }\n        return low - 1;\n    }\n    findRange(line) {\n        let index = this.findIndex(line);\n        if (index >= 0) {\n            const endLineNumber = this.getEndLineNumber(index);\n            if (endLineNumber >= line) {\n                return index;\n            }\n            index = this.getParentIndex(index);\n            while (index !== -1) {\n                if (this.contains(index, line)) {\n                    return index;\n                }\n                index = this.getParentIndex(index);\n            }\n        }\n        return -1;\n    }\n    toString() {\n        const res = [];\n        for (let i = 0; i < this.length; i++) {\n            res[i] = `[${foldSourceAbbr[this.getSource(i)]}${this.isCollapsed(i) ? '+' : '-'}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;\n        }\n        return res.join(', ');\n    }\n    toFoldRange(index) {\n        return {\n            startLineNumber: this._startIndexes[index] & MAX_LINE_NUMBER,\n            endLineNumber: this._endIndexes[index] & MAX_LINE_NUMBER,\n            type: this._types ? this._types[index] : undefined,\n            isCollapsed: this.isCollapsed(index),\n            source: this.getSource(index)\n        };\n    }\n    static fromFoldRanges(ranges) {\n        const rangesLength = ranges.length;\n        const startIndexes = new Uint32Array(rangesLength);\n        const endIndexes = new Uint32Array(rangesLength);\n        let types = [];\n        let gotTypes = false;\n        for (let i = 0; i < rangesLength; i++) {\n            const range = ranges[i];\n            startIndexes[i] = range.startLineNumber;\n            endIndexes[i] = range.endLineNumber;\n            types.push(range.type);\n            if (range.type) {\n                gotTypes = true;\n            }\n        }\n        if (!gotTypes) {\n            types = undefined;\n        }\n        const regions = new FoldingRegions(startIndexes, endIndexes, types);\n        for (let i = 0; i < rangesLength; i++) {\n            if (ranges[i].isCollapsed) {\n                regions.setCollapsed(i, true);\n            }\n            regions.setSource(i, ranges[i].source);\n        }\n        return regions;\n    }\n    /**\n     * Two inputs, each a FoldingRegions or a FoldRange[], are merged.\n     * Each input must be pre-sorted on startLineNumber.\n     * The first list is assumed to always include all regions currently defined by range providers.\n     * The second list only contains the previously collapsed and all manual ranges.\n     * If the line position matches, the range of the new range is taken, and the range is no longer manual\n     * When an entry in one list overlaps an entry in the other, the second list's entry \"wins\" and\n     * overlapping entries in the first list are discarded.\n     * Invalid entries are discarded. An entry is invalid if:\n     * \t\tthe start and end line numbers aren't a valid range of line numbers,\n     * \t\tit is out of sequence or has the same start line as a preceding entry,\n     * \t\tit overlaps a preceding entry and is not fully contained by that entry.\n     */\n    static sanitizeAndMerge(rangesA, rangesB, maxLineNumber) {\n        maxLineNumber = maxLineNumber !== null && maxLineNumber !== void 0 ? maxLineNumber : Number.MAX_VALUE;\n        const getIndexedFunction = (r, limit) => {\n            return Array.isArray(r)\n                ? ((i) => { return (i < limit) ? r[i] : undefined; })\n                : ((i) => { return (i < limit) ? r.toFoldRange(i) : undefined; });\n        };\n        const getA = getIndexedFunction(rangesA, rangesA.length);\n        const getB = getIndexedFunction(rangesB, rangesB.length);\n        let indexA = 0;\n        let indexB = 0;\n        let nextA = getA(0);\n        let nextB = getB(0);\n        const stackedRanges = [];\n        let topStackedRange;\n        let prevLineNumber = 0;\n        const resultRanges = [];\n        while (nextA || nextB) {\n            let useRange = undefined;\n            if (nextB && (!nextA || nextA.startLineNumber >= nextB.startLineNumber)) {\n                if (nextA && nextA.startLineNumber === nextB.startLineNumber) {\n                    if (nextB.source === 1 /* FoldSource.userDefined */) {\n                        // a user defined range (possibly unfolded)\n                        useRange = nextB;\n                    }\n                    else {\n                        // a previously folded range or a (possibly unfolded) recovered range\n                        useRange = nextA;\n                        useRange.isCollapsed = nextB.isCollapsed && nextA.endLineNumber === nextB.endLineNumber;\n                        useRange.source = 0 /* FoldSource.provider */;\n                    }\n                    nextA = getA(++indexA); // not necessary, just for speed\n                }\n                else {\n                    useRange = nextB;\n                    if (nextB.isCollapsed && nextB.source === 0 /* FoldSource.provider */) {\n                        // a previously collapsed range\n                        useRange.source = 2 /* FoldSource.recovered */;\n                    }\n                }\n                nextB = getB(++indexB);\n            }\n            else {\n                // nextA is next. The user folded B set takes precedence and we sometimes need to look\n                // ahead in it to check for an upcoming conflict.\n                let scanIndex = indexB;\n                let prescanB = nextB;\n                while (true) {\n                    if (!prescanB || prescanB.startLineNumber > nextA.endLineNumber) {\n                        useRange = nextA;\n                        break; // no conflict, use this nextA\n                    }\n                    if (prescanB.source === 1 /* FoldSource.userDefined */ && prescanB.endLineNumber > nextA.endLineNumber) {\n                        // we found a user folded range, it wins\n                        break; // without setting nextResult, so this nextA gets skipped\n                    }\n                    prescanB = getB(++scanIndex);\n                }\n                nextA = getA(++indexA);\n            }\n            if (useRange) {\n                while (topStackedRange\n                    && topStackedRange.endLineNumber < useRange.startLineNumber) {\n                    topStackedRange = stackedRanges.pop();\n                }\n                if (useRange.endLineNumber > useRange.startLineNumber\n                    && useRange.startLineNumber > prevLineNumber\n                    && useRange.endLineNumber <= maxLineNumber\n                    && (!topStackedRange\n                        || topStackedRange.endLineNumber >= useRange.endLineNumber)) {\n                    resultRanges.push(useRange);\n                    prevLineNumber = useRange.startLineNumber;\n                    if (topStackedRange) {\n                        stackedRanges.push(topStackedRange);\n                    }\n                    topStackedRange = useRange;\n                }\n            }\n        }\n        return resultRanges;\n    }\n}\nexport class FoldingRegion {\n    constructor(ranges, index) {\n        this.ranges = ranges;\n        this.index = index;\n    }\n    get startLineNumber() {\n        return this.ranges.getStartLineNumber(this.index);\n    }\n    get endLineNumber() {\n        return this.ranges.getEndLineNumber(this.index);\n    }\n    get regionIndex() {\n        return this.index;\n    }\n    get parentIndex() {\n        return this.ranges.getParentIndex(this.index);\n    }\n    get isCollapsed() {\n        return this.ranges.isCollapsed(this.index);\n    }\n    containedBy(range) {\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\n    }\n    containsLine(lineNumber) {\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstIdxMonotonousOrArrLen } from '../../../../base/common/arraysFind.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Range } from '../../../common/core/range.js';\nimport { countEOL } from '../../../common/core/eolCounter.js';\nexport class HiddenRangeModel {\n    get onDidChange() { return this._updateEventEmitter.event; }\n    get hiddenRanges() { return this._hiddenRanges; }\n    constructor(model) {\n        this._updateEventEmitter = new Emitter();\n        this._hasLineChanges = false;\n        this._foldingModel = model;\n        this._foldingModelListener = model.onDidChange(_ => this.updateHiddenRanges());\n        this._hiddenRanges = [];\n        if (model.regions.length) {\n            this.updateHiddenRanges();\n        }\n    }\n    notifyChangeModelContent(e) {\n        if (this._hiddenRanges.length && !this._hasLineChanges) {\n            this._hasLineChanges = e.changes.some(change => {\n                return change.range.endLineNumber !== change.range.startLineNumber || countEOL(change.text)[0] !== 0;\n            });\n        }\n    }\n    updateHiddenRanges() {\n        let updateHiddenAreas = false;\n        const newHiddenAreas = [];\n        let i = 0; // index into hidden\n        let k = 0;\n        let lastCollapsedStart = Number.MAX_VALUE;\n        let lastCollapsedEnd = -1;\n        const ranges = this._foldingModel.regions;\n        for (; i < ranges.length; i++) {\n            if (!ranges.isCollapsed(i)) {\n                continue;\n            }\n            const startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\n            const endLineNumber = ranges.getEndLineNumber(i);\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\n                // ignore ranges contained in collapsed regions\n                continue;\n            }\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\n                // reuse the old ranges\n                newHiddenAreas.push(this._hiddenRanges[k]);\n                k++;\n            }\n            else {\n                updateHiddenAreas = true;\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\n            }\n            lastCollapsedStart = startLineNumber;\n            lastCollapsedEnd = endLineNumber;\n        }\n        if (this._hasLineChanges || updateHiddenAreas || k < this._hiddenRanges.length) {\n            this.applyHiddenRanges(newHiddenAreas);\n        }\n    }\n    applyHiddenRanges(newHiddenAreas) {\n        this._hiddenRanges = newHiddenAreas;\n        this._hasLineChanges = false;\n        this._updateEventEmitter.fire(newHiddenAreas);\n    }\n    hasRanges() {\n        return this._hiddenRanges.length > 0;\n    }\n    isHidden(line) {\n        return findRange(this._hiddenRanges, line) !== null;\n    }\n    adjustSelections(selections) {\n        let hasChanges = false;\n        const editorModel = this._foldingModel.textModel;\n        let lastRange = null;\n        const adjustLine = (line) => {\n            if (!lastRange || !isInside(line, lastRange)) {\n                lastRange = findRange(this._hiddenRanges, line);\n            }\n            if (lastRange) {\n                return lastRange.startLineNumber - 1;\n            }\n            return null;\n        };\n        for (let i = 0, len = selections.length; i < len; i++) {\n            let selection = selections[i];\n            const adjustedStartLine = adjustLine(selection.startLineNumber);\n            if (adjustedStartLine) {\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\n                hasChanges = true;\n            }\n            const adjustedEndLine = adjustLine(selection.endLineNumber);\n            if (adjustedEndLine) {\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\n                hasChanges = true;\n            }\n            selections[i] = selection;\n        }\n        return hasChanges;\n    }\n    dispose() {\n        if (this.hiddenRanges.length > 0) {\n            this._hiddenRanges = [];\n            this._updateEventEmitter.fire(this._hiddenRanges);\n        }\n        if (this._foldingModelListener) {\n            this._foldingModelListener.dispose();\n            this._foldingModelListener = null;\n        }\n    }\n}\nfunction isInside(line, range) {\n    return line >= range.startLineNumber && line <= range.endLineNumber;\n}\nfunction findRange(ranges, line) {\n    const i = findFirstIdxMonotonousOrArrLen(ranges, r => line < r.startLineNumber) - 1;\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\n        return ranges[i];\n    }\n    return null;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT = 5000;\nconst ID_INDENT_PROVIDER = 'indent';\nexport class IndentRangeProvider {\n    constructor(editorModel, languageConfigurationService, foldingRangesLimit) {\n        this.editorModel = editorModel;\n        this.languageConfigurationService = languageConfigurationService;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.id = ID_INDENT_PROVIDER;\n    }\n    dispose() { }\n    compute(cancelationToken) {\n        const foldingRules = this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules;\n        const offSide = foldingRules && !!foldingRules.offSide;\n        const markers = foldingRules && foldingRules.markers;\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers, this.foldingRangesLimit));\n    }\n}\n// public only for testing\nexport class RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._indentOccurrences = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    insertFirst(startLineNumber, endLineNumber, indent) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._length++;\n        if (indent < 1000) {\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\n        }\n    }\n    toIndentRanges(model) {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = this._length - 1, k = 0; i >= 0; i--, k++) {\n                startIndexes[k] = this._startIndexes[i];\n                endIndexes[k] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxIndent = this._indentOccurrences.length;\n            for (let i = 0; i < this._indentOccurrences.length; i++) {\n                const n = this._indentOccurrences[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxIndent = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const tabSize = model.getOptions().tabSize;\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            for (let i = this._length - 1, k = 0; i >= 0; i--) {\n                const startIndex = this._startIndexes[i];\n                const lineContent = model.getLineContent(startIndex);\n                const indent = computeIndentLevel(lineContent, tabSize);\n                if (indent < maxIndent || (indent === maxIndent && entries++ < limit)) {\n                    startIndexes[k] = startIndex;\n                    endIndexes[k] = this._endIndexes[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n    }\n}\nconst foldingRangesLimitDefault = {\n    limit: MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT,\n    update: () => { }\n};\nexport function computeRanges(model, offSide, markers, foldingRangesLimit = foldingRangesLimitDefault) {\n    const tabSize = model.getOptions().tabSize;\n    const result = new RangesCollector(foldingRangesLimit);\n    let pattern = undefined;\n    if (markers) {\n        pattern = new RegExp(`(${markers.start.source})|(?:${markers.end.source})`);\n    }\n    const previousRegions = [];\n    const line = model.getLineCount() + 1;\n    previousRegions.push({ indent: -1, endAbove: line, line }); // sentinel, to make sure there's at least one entry\n    for (let line = model.getLineCount(); line > 0; line--) {\n        const lineContent = model.getLineContent(line);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        let previous = previousRegions[previousRegions.length - 1];\n        if (indent === -1) {\n            if (offSide) {\n                // for offSide languages, empty lines are associated to the previous block\n                // note: the next block is already written to the results, so this only\n                // impacts the end position of the block before\n                previous.endAbove = line;\n            }\n            continue; // only whitespace\n        }\n        let m;\n        if (pattern && (m = lineContent.match(pattern))) {\n            // folding pattern match\n            if (m[1]) { // start pattern match\n                // discard all regions until the folding pattern\n                let i = previousRegions.length - 1;\n                while (i > 0 && previousRegions[i].indent !== -2) {\n                    i--;\n                }\n                if (i > 0) {\n                    previousRegions.length = i + 1;\n                    previous = previousRegions[i];\n                    // new folding range from pattern, includes the end line\n                    result.insertFirst(line, previous.line, indent);\n                    previous.line = line;\n                    previous.indent = indent;\n                    previous.endAbove = line;\n                    continue;\n                }\n                else {\n                    // no end marker found, treat line as a regular line\n                }\n            }\n            else { // end pattern match\n                previousRegions.push({ indent: -2, endAbove: line, line });\n                continue;\n            }\n        }\n        if (previous.indent > indent) {\n            // discard all regions with larger indent\n            do {\n                previousRegions.pop();\n                previous = previousRegions[previousRegions.length - 1];\n            } while (previous.indent > indent);\n            // new folding range\n            const endLineNumber = previous.endAbove - 1;\n            if (endLineNumber - line >= 1) { // needs at east size 1\n                result.insertFirst(line, endLineNumber, indent);\n            }\n        }\n        if (previous.indent === indent) {\n            previous.endAbove = line;\n        }\n        else { // previous.indent < indent\n            // new region with a bigger indent\n            previousRegions.push({ indent, endAbove: line, line });\n        }\n    }\n    return result.toIndentRanges(model);\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MinimapPosition } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { localize } from '../../../../nls.js';\nimport { editorSelectionBackground, iconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst foldBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hcDark: null, hcLight: null }, localize('foldBackgroundBackground', \"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.\"), true);\nregisterColor('editorGutter.foldingControlForeground', { dark: iconForeground, light: iconForeground, hcDark: iconForeground, hcLight: iconForeground }, localize('editorGutter.foldingControlForeground', 'Color of the folding control in the editor gutter.'));\nexport const foldingExpandedIcon = registerIcon('folding-expanded', Codicon.chevronDown, localize('foldingExpandedIcon', 'Icon for expanded ranges in the editor glyph margin.'));\nexport const foldingCollapsedIcon = registerIcon('folding-collapsed', Codicon.chevronRight, localize('foldingCollapsedIcon', 'Icon for collapsed ranges in the editor glyph margin.'));\nexport const foldingManualCollapsedIcon = registerIcon('folding-manual-collapsed', foldingCollapsedIcon, localize('foldingManualCollapedIcon', 'Icon for manually collapsed ranges in the editor glyph margin.'));\nexport const foldingManualExpandedIcon = registerIcon('folding-manual-expanded', foldingExpandedIcon, localize('foldingManualExpandedIcon', 'Icon for manually expanded ranges in the editor glyph margin.'));\nconst foldedBackgroundMinimap = { color: themeColorFromId(foldBackground), position: MinimapPosition.Inline };\nconst collapsed = localize('linesCollapsed', \"Click to expand the range.\");\nconst expanded = localize('linesExpanded', \"Click to collapse the range.\");\nexport class FoldingDecorationProvider {\n    constructor(editor) {\n        this.editor = editor;\n        this.showFoldingControls = 'mouseover';\n        this.showFoldingHighlights = true;\n    }\n    getDecorationOption(isCollapsed, isHidden, isManual) {\n        if (isHidden) { // is inside another collapsed region\n            return FoldingDecorationProvider.HIDDEN_RANGE_DECORATION;\n        }\n        if (this.showFoldingControls === 'never') {\n            if (isCollapsed) {\n                return this.showFoldingHighlights ? FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION : FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION;\n            }\n            return FoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION;\n        }\n        if (isCollapsed) {\n            return isManual ?\n                (this.showFoldingHighlights ? FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION)\n                : (this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION);\n        }\n        else if (this.showFoldingControls === 'mouseover') {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\n        }\n        else {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\n        }\n    }\n    changeDecorations(callback) {\n        return this.editor.changeDecorations(callback);\n    }\n    removeDecorations(decorationIds) {\n        this.editor.removeDecorations(decorationIds);\n    }\n}\nFoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    linesDecorationsTooltip: collapsed,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon),\n});\nFoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    linesDecorationsTooltip: collapsed,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    linesDecorationsTooltip: collapsed,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    linesDecorationsTooltip: collapsed,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    linesDecorationsTooltip: collapsed,\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    linesDecorationsTooltip: collapsed,\n});\nFoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon),\n    linesDecorationsTooltip: expanded,\n});\nFoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-auto-hide-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingExpandedIcon),\n    linesDecorationsTooltip: expanded,\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingManualExpandedIcon),\n    linesDecorationsTooltip: expanded,\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-auto-hide-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualExpandedIcon),\n    linesDecorationsTooltip: expanded,\n});\nFoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true\n});\nFoldingDecorationProvider.HIDDEN_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-hidden-range-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst foldingContext = {};\nconst ID_SYNTAX_PROVIDER = 'syntax';\nexport class SyntaxRangeProvider {\n    constructor(editorModel, providers, handleFoldingRangesChange, foldingRangesLimit, fallbackRangeProvider // used when all providers return null\n    ) {\n        this.editorModel = editorModel;\n        this.providers = providers;\n        this.handleFoldingRangesChange = handleFoldingRangesChange;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.fallbackRangeProvider = fallbackRangeProvider;\n        this.id = ID_SYNTAX_PROVIDER;\n        this.disposables = new DisposableStore();\n        if (fallbackRangeProvider) {\n            this.disposables.add(fallbackRangeProvider);\n        }\n        for (const provider of providers) {\n            if (typeof provider.onDidChange === 'function') {\n                this.disposables.add(provider.onDidChange(handleFoldingRangesChange));\n            }\n        }\n    }\n    compute(cancellationToken) {\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(ranges => {\n            var _a, _b;\n            if (ranges) {\n                const res = sanitizeRanges(ranges, this.foldingRangesLimit);\n                return res;\n            }\n            return (_b = (_a = this.fallbackRangeProvider) === null || _a === void 0 ? void 0 : _a.compute(cancellationToken)) !== null && _b !== void 0 ? _b : null;\n        });\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\n    let rangeData = null;\n    const promises = providers.map((provider, i) => {\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(ranges => {\n            if (cancellationToken.isCancellationRequested) {\n                return;\n            }\n            if (Array.isArray(ranges)) {\n                if (!Array.isArray(rangeData)) {\n                    rangeData = [];\n                }\n                const nLines = model.getLineCount();\n                for (const r of ranges) {\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\n                    }\n                }\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(_ => {\n        return rangeData;\n    });\n}\nclass RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._nestingLevels = [];\n        this._nestingLevelCounts = [];\n        this._types = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    add(startLineNumber, endLineNumber, type, nestingLevel) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._nestingLevels[index] = nestingLevel;\n        this._types[index] = type;\n        this._length++;\n        if (nestingLevel < 30) {\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\n        }\n    }\n    toIndentRanges() {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = 0; i < this._length; i++) {\n                startIndexes[i] = this._startIndexes[i];\n                endIndexes[i] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxLevel = this._nestingLevelCounts.length;\n            for (let i = 0; i < this._nestingLevelCounts.length; i++) {\n                const n = this._nestingLevelCounts[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxLevel = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            const types = [];\n            for (let i = 0, k = 0; i < this._length; i++) {\n                const level = this._nestingLevels[i];\n                if (level < maxLevel || (level === maxLevel && entries++ < limit)) {\n                    startIndexes[k] = this._startIndexes[i];\n                    endIndexes[k] = this._endIndexes[i];\n                    types[k] = this._types[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes, types);\n        }\n    }\n}\nexport function sanitizeRanges(rangeData, foldingRangesLimit) {\n    const sorted = rangeData.sort((d1, d2) => {\n        let diff = d1.start - d2.start;\n        if (diff === 0) {\n            diff = d1.rank - d2.rank;\n        }\n        return diff;\n    });\n    const collector = new RangesCollector(foldingRangesLimit);\n    let top = undefined;\n    const previous = [];\n    for (const entry of sorted) {\n        if (!top) {\n            top = entry;\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n        }\n        else {\n            if (entry.start > top.start) {\n                if (entry.end <= top.end) {\n                    previous.push(top);\n                    top = entry;\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n                else {\n                    if (entry.start > top.end) {\n                        do {\n                            top = previous.pop();\n                        } while (top && entry.start > top.end);\n                        if (top) {\n                            previous.push(top);\n                        }\n                        top = entry;\n                    }\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n            }\n        }\n    }\n    return collector.toIndentRanges();\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Increase Editor Font Size\"),\n            alias: 'Increase Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Decrease Editor Font Size\"),\n            alias: 'Decrease Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Reset Editor Font Size\"),\n            alias: 'Reset Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    constructor(_editor, _languageFeaturesService, _workerService, _accessibilitySignalService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._accessibilitySignalService = _accessibilitySignalService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(56 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(56 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                this._accessibilitySignalService.playSignal(AccessibilitySignal.format, { userGesture: false });\n                FormattingEdit.execute(this._editor, edits, true);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType.ID = 'editor.contrib.autoFormat';\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService),\n    __param(3, IAccessibilitySignalService)\n], FormatOnType);\nexport { FormatOnType };\nlet FormatOnPaste = class FormatOnPaste {\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(55 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None, false).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    async run(accessor, editor) {\n        if (editor.hasModel()) {\n            const instaService = accessor.get(IInstantiationService);\n            const progressService = accessor.get(IEditorProgressService);\n            await progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None, true), 250);\n        }\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    async run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const ranges = editor.getSelections().map(range => {\n            return range.isEmpty()\n                ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                : range;\n        });\n        const progressService = accessor.get(IEditorProgressService);\n        await progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None, true), 250);\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', async (accessor) => {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        await commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        await commandService.executeCommand('editor.action.formatSelection');\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { IOutlineModelService } from './outlineModel.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nCommandsRegistry.registerCommand('_executeDocumentSymbolProvider', async function (accessor, ...args) {\n    const [resource] = args;\n    assertType(URI.isUri(resource));\n    const outlineService = accessor.get(IOutlineModelService);\n    const modelService = accessor.get(ITextModelService);\n    const reference = await modelService.createModelReference(resource);\n    try {\n        return (await outlineService.getOrCreate(reference.object.textEditorModel, CancellationToken.None)).getTopLevelSymbols();\n    }\n    finally {\n        reference.dispose();\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { TriggerInlineSuggestionAction, ShowNextInlineSuggestionAction, ShowPreviousInlineSuggestionAction, AcceptNextWordOfInlineCompletion, AcceptInlineCompletion, HideInlineCompletion, ToggleAlwaysShowInlineSuggestionToolbar, AcceptNextLineOfInlineCompletion } from './commands.js';\nimport { InlineCompletionsHoverParticipant } from './hoverParticipant.js';\nimport { InlineCompletionsController } from './inlineCompletionsController.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\nregisterEditorContribution(InlineCompletionsController.ID, InlineCompletionsController, 3 /* EditorContributionInstantiation.Eventually */);\nregisterEditorAction(TriggerInlineSuggestionAction);\nregisterEditorAction(ShowNextInlineSuggestionAction);\nregisterEditorAction(ShowPreviousInlineSuggestionAction);\nregisterEditorAction(AcceptNextWordOfInlineCompletion);\nregisterEditorAction(AcceptNextLineOfInlineCompletion);\nregisterEditorAction(AcceptInlineCompletion);\nregisterEditorAction(HideInlineCompletion);\nregisterAction2(ToggleAlwaysShowInlineSuggestionToolbar);\nHoverParticipantRegistry.register(InlineCompletionsHoverParticipant);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { transaction } from '../../../../base/common/observable.js';\nimport { asyncTransaction } from '../../../../base/common/observableInternal/base.js';\nimport { EditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { showNextInlineSuggestionActionId, showPreviousInlineSuggestionActionId, inlineSuggestCommitId } from './commandIds.js';\nimport { InlineCompletionContextKeys } from './inlineCompletionContextKeys.js';\nimport { InlineCompletionsController } from './inlineCompletionsController.js';\nimport { Context as SuggestContext } from '../../suggest/browser/suggest.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, Action2 } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nexport class ShowNextInlineSuggestionAction extends EditorAction {\n    constructor() {\n        super({\n            id: ShowNextInlineSuggestionAction.ID,\n            label: nls.localize('action.inlineSuggest.showNext', \"Show Next Inline Suggestion\"),\n            alias: 'Show Next Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */,\n            },\n        });\n    }\n    async run(accessor, editor) {\n        var _a;\n        const controller = InlineCompletionsController.get(editor);\n        (_a = controller === null || controller === void 0 ? void 0 : controller.model.get()) === null || _a === void 0 ? void 0 : _a.next();\n    }\n}\nShowNextInlineSuggestionAction.ID = showNextInlineSuggestionActionId;\nexport class ShowPreviousInlineSuggestionAction extends EditorAction {\n    constructor() {\n        super({\n            id: ShowPreviousInlineSuggestionAction.ID,\n            label: nls.localize('action.inlineSuggest.showPrevious', \"Show Previous Inline Suggestion\"),\n            alias: 'Show Previous Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */,\n            },\n        });\n    }\n    async run(accessor, editor) {\n        var _a;\n        const controller = InlineCompletionsController.get(editor);\n        (_a = controller === null || controller === void 0 ? void 0 : controller.model.get()) === null || _a === void 0 ? void 0 : _a.previous();\n    }\n}\nShowPreviousInlineSuggestionAction.ID = showPreviousInlineSuggestionActionId;\nexport class TriggerInlineSuggestionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineSuggest.trigger',\n            label: nls.localize('action.inlineSuggest.trigger', \"Trigger Inline Suggestion\"),\n            alias: 'Trigger Inline Suggestion',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        await asyncTransaction(async (tx) => {\n            var _a;\n            /** @description triggerExplicitly from command */\n            await ((_a = controller === null || controller === void 0 ? void 0 : controller.model.get()) === null || _a === void 0 ? void 0 : _a.triggerExplicitly(tx));\n            controller === null || controller === void 0 ? void 0 : controller.playAccessibilitySignal(tx);\n        });\n    }\n}\nexport class AcceptNextWordOfInlineCompletion extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineSuggest.acceptNextWord',\n            label: nls.localize('action.inlineSuggest.acceptNextWord', \"Accept Next Word Of Inline Suggestion\"),\n            alias: 'Accept Next Word Of Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 17 /* KeyCode.RightArrow */,\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineSuggestionToolbar,\n                    title: nls.localize('acceptWord', 'Accept Word'),\n                    group: 'primary',\n                    order: 2,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        var _a;\n        const controller = InlineCompletionsController.get(editor);\n        await ((_a = controller === null || controller === void 0 ? void 0 : controller.model.get()) === null || _a === void 0 ? void 0 : _a.acceptNextWord(controller.editor));\n    }\n}\nexport class AcceptNextLineOfInlineCompletion extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineSuggest.acceptNextLine',\n            label: nls.localize('action.inlineSuggest.acceptNextLine', \"Accept Next Line Of Inline Suggestion\"),\n            alias: 'Accept Next Line Of Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineSuggestionToolbar,\n                    title: nls.localize('acceptLine', 'Accept Line'),\n                    group: 'secondary',\n                    order: 2,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        var _a;\n        const controller = InlineCompletionsController.get(editor);\n        await ((_a = controller === null || controller === void 0 ? void 0 : controller.model.get()) === null || _a === void 0 ? void 0 : _a.acceptNextLine(controller.editor));\n    }\n}\nexport class AcceptInlineCompletion extends EditorAction {\n    constructor() {\n        super({\n            id: inlineSuggestCommitId,\n            label: nls.localize('action.inlineSuggest.accept', \"Accept Inline Suggestion\"),\n            alias: 'Accept Inline Suggestion',\n            precondition: InlineCompletionContextKeys.inlineSuggestionVisible,\n            menuOpts: [{\n                    menuId: MenuId.InlineSuggestionToolbar,\n                    title: nls.localize('accept', \"Accept\"),\n                    group: 'primary',\n                    order: 1,\n                }],\n            kbOpts: {\n                primary: 2 /* KeyCode.Tab */,\n                weight: 200,\n                kbExpr: ContextKeyExpr.and(InlineCompletionContextKeys.inlineSuggestionVisible, EditorContextKeys.tabMovesFocus.toNegated(), InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize, SuggestContext.Visible.toNegated(), EditorContextKeys.hoverFocused.toNegated()),\n            }\n        });\n    }\n    async run(accessor, editor) {\n        var _a;\n        const controller = InlineCompletionsController.get(editor);\n        if (controller) {\n            (_a = controller.model.get()) === null || _a === void 0 ? void 0 : _a.accept(controller.editor);\n            controller.editor.focus();\n        }\n    }\n}\nexport class HideInlineCompletion extends EditorAction {\n    constructor() {\n        super({\n            id: HideInlineCompletion.ID,\n            label: nls.localize('action.inlineSuggest.hide', \"Hide Inline Suggestion\"),\n            alias: 'Hide Inline Suggestion',\n            precondition: InlineCompletionContextKeys.inlineSuggestionVisible,\n            kbOpts: {\n                weight: 100,\n                primary: 9 /* KeyCode.Escape */,\n            }\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        transaction(tx => {\n            var _a;\n            (_a = controller === null || controller === void 0 ? void 0 : controller.model.get()) === null || _a === void 0 ? void 0 : _a.stop(tx);\n        });\n    }\n}\nHideInlineCompletion.ID = 'editor.action.inlineSuggest.hide';\nexport class ToggleAlwaysShowInlineSuggestionToolbar extends Action2 {\n    constructor() {\n        super({\n            id: ToggleAlwaysShowInlineSuggestionToolbar.ID,\n            title: nls.localize('action.inlineSuggest.alwaysShowToolbar', \"Always Show Toolbar\"),\n            f1: false,\n            precondition: undefined,\n            menu: [{\n                    id: MenuId.InlineSuggestionToolbar,\n                    group: 'secondary',\n                    order: 10,\n                }],\n            toggled: ContextKeyExpr.equals('config.editor.inlineSuggest.showToolbar', 'always')\n        });\n    }\n    async run(accessor, editor) {\n        const configService = accessor.get(IConfigurationService);\n        const currentValue = configService.getValue('editor.inlineSuggest.showToolbar');\n        const newValue = currentValue === 'always' ? 'onHover' : 'always';\n        configService.updateValue('editor.inlineSuggest.showToolbar', newValue);\n    }\n}\nToggleAlwaysShowInlineSuggestionToolbar.ID = 'editor.action.inlineSuggest.toggleAlwaysShowToolbar';\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { autorun } from '../../../../base/common/observable.js';\nimport { firstNonWhitespaceIndex } from '../../../../base/common/strings.js';\nimport { CursorColumns } from '../../../common/core/cursorColumns.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { localize } from '../../../../nls.js';\nexport class InlineCompletionContextKeys extends Disposable {\n    constructor(contextKeyService, model) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.model = model;\n        this.inlineCompletionVisible = InlineCompletionContextKeys.inlineSuggestionVisible.bindTo(this.contextKeyService);\n        this.inlineCompletionSuggestsIndentation = InlineCompletionContextKeys.inlineSuggestionHasIndentation.bindTo(this.contextKeyService);\n        this.inlineCompletionSuggestsIndentationLessThanTabSize = InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService);\n        this.suppressSuggestions = InlineCompletionContextKeys.suppressSuggestions.bindTo(this.contextKeyService);\n        this._register(autorun(reader => {\n            /** @description update context key: inlineCompletionVisible, suppressSuggestions */\n            const model = this.model.read(reader);\n            const state = model === null || model === void 0 ? void 0 : model.state.read(reader);\n            const isInlineCompletionVisible = !!(state === null || state === void 0 ? void 0 : state.inlineCompletion) && (state === null || state === void 0 ? void 0 : state.primaryGhostText) !== undefined && !(state === null || state === void 0 ? void 0 : state.primaryGhostText.isEmpty());\n            this.inlineCompletionVisible.set(isInlineCompletionVisible);\n            if ((state === null || state === void 0 ? void 0 : state.primaryGhostText) && (state === null || state === void 0 ? void 0 : state.inlineCompletion)) {\n                this.suppressSuggestions.set(state.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions);\n            }\n        }));\n        this._register(autorun(reader => {\n            /** @description update context key: inlineCompletionSuggestsIndentation, inlineCompletionSuggestsIndentationLessThanTabSize */\n            const model = this.model.read(reader);\n            let startsWithIndentation = false;\n            let startsWithIndentationLessThanTabSize = true;\n            const ghostText = model === null || model === void 0 ? void 0 : model.primaryGhostText.read(reader);\n            if (!!(model === null || model === void 0 ? void 0 : model.selectedSuggestItem) && ghostText && ghostText.parts.length > 0) {\n                const { column, lines } = ghostText.parts[0];\n                const firstLine = lines[0];\n                const indentationEndColumn = model.textModel.getLineIndentColumn(ghostText.lineNumber);\n                const inIndentation = column <= indentationEndColumn;\n                if (inIndentation) {\n                    let firstNonWsIdx = firstNonWhitespaceIndex(firstLine);\n                    if (firstNonWsIdx === -1) {\n                        firstNonWsIdx = firstLine.length - 1;\n                    }\n                    startsWithIndentation = firstNonWsIdx > 0;\n                    const tabSize = model.textModel.getOptions().tabSize;\n                    const visibleColumnIndentation = CursorColumns.visibleColumnFromColumn(firstLine, firstNonWsIdx + 1, tabSize);\n                    startsWithIndentationLessThanTabSize = visibleColumnIndentation < tabSize;\n                }\n            }\n            this.inlineCompletionSuggestsIndentation.set(startsWithIndentation);\n            this.inlineCompletionSuggestsIndentationLessThanTabSize.set(startsWithIndentationLessThanTabSize);\n        }));\n    }\n}\nInlineCompletionContextKeys.inlineSuggestionVisible = new RawContextKey('inlineSuggestionVisible', false, localize('inlineSuggestionVisible', \"Whether an inline suggestion is visible\"));\nInlineCompletionContextKeys.inlineSuggestionHasIndentation = new RawContextKey('inlineSuggestionHasIndentation', false, localize('inlineSuggestionHasIndentation', \"Whether the inline suggestion starts with whitespace\"));\nInlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize = new RawContextKey('inlineSuggestionHasIndentationLessThanTabSize', true, localize('inlineSuggestionHasIndentationLessThanTabSize', \"Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab\"));\nInlineCompletionContextKeys.suppressSuggestions = new RawContextKey('inlineSuggestionSuppressSuggestions', undefined, localize('suppressSuggestions', \"Whether suggestions should be suppressed for the current suggestion\"));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineCompletionsController_1;\nimport { createStyleSheet2 } from '../../../../base/browser/dom.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunHandleChanges, constObservable, derived, disposableObservableValue, observableFromEvent, observableSignal, observableValue, transaction } from '../../../../base/common/observable.js';\nimport { CoreEditingCommands } from '../../../browser/coreCommands.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { inlineSuggestCommitId } from './commandIds.js';\nimport { GhostTextWidget } from './ghostTextWidget.js';\nimport { InlineCompletionContextKeys } from './inlineCompletionContextKeys.js';\nimport { InlineCompletionsHintsWidget, InlineSuggestionHintsContentWidget } from './inlineCompletionsHintsWidget.js';\nimport { InlineCompletionsModel, VersionIdChangeReason } from './inlineCompletionsModel.js';\nimport { SuggestWidgetAdaptor } from './suggestWidgetInlineCompletionProvider.js';\nimport { localize } from '../../../../nls.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { mapObservableArrayCached } from '../../../../base/common/observableInternal/utils.js';\nlet InlineCompletionsController = InlineCompletionsController_1 = class InlineCompletionsController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(InlineCompletionsController_1.ID);\n    }\n    constructor(editor, _instantiationService, _contextKeyService, _configurationService, _commandService, _debounceService, _languageFeaturesService, _accessibilitySignalService, _keybindingService) {\n        super();\n        this.editor = editor;\n        this._instantiationService = _instantiationService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._commandService = _commandService;\n        this._debounceService = _debounceService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._accessibilitySignalService = _accessibilitySignalService;\n        this._keybindingService = _keybindingService;\n        this.model = this._register(disposableObservableValue('inlineCompletionModel', undefined));\n        this._textModelVersionId = observableValue(this, -1);\n        this._positions = observableValue(this, [new Position(1, 1)]);\n        this._suggestWidgetAdaptor = this._register(new SuggestWidgetAdaptor(this.editor, () => { var _a, _b; return (_b = (_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.selectedInlineCompletion.get()) === null || _b === void 0 ? void 0 : _b.toSingleTextEdit(undefined); }, (tx) => this.updateObservables(tx, VersionIdChangeReason.Other), (item) => {\n            transaction(tx => {\n                var _a;\n                /** @description InlineCompletionsController.handleSuggestAccepted */\n                this.updateObservables(tx, VersionIdChangeReason.Other);\n                (_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.handleSuggestAccepted(item);\n            });\n        }));\n        this._enabled = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).enabled);\n        this._fontFamily = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).fontFamily);\n        this._ghostTexts = derived(this, (reader) => {\n            var _a;\n            const model = this.model.read(reader);\n            return (_a = model === null || model === void 0 ? void 0 : model.ghostTexts.read(reader)) !== null && _a !== void 0 ? _a : [];\n        });\n        this._stablizedGhostTexts = convertItemsToStableObservables(this._ghostTexts, this._store);\n        this._ghostTextWidgets = mapObservableArrayCached(this, this._stablizedGhostTexts, (ghostText, store) => {\n            return store.add(this._instantiationService.createInstance(GhostTextWidget, this.editor, {\n                ghostText: ghostText,\n                minReservedLineCount: constObservable(0),\n                targetTextModel: this.model.map(v => v === null || v === void 0 ? void 0 : v.textModel),\n            }));\n        }).recomputeInitiallyAndOnChange(this._store);\n        this._debounceValue = this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider, 'InlineCompletionsDebounce', { min: 50, max: 50 });\n        this._playAccessibilitySignal = observableSignal(this);\n        this._isReadonly = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(91 /* EditorOption.readOnly */));\n        this._textModel = observableFromEvent(this.editor.onDidChangeModel, () => this.editor.getModel());\n        this._textModelIfWritable = derived(reader => this._isReadonly.read(reader) ? undefined : this._textModel.read(reader));\n        this._register(new InlineCompletionContextKeys(this._contextKeyService, this.model));\n        this._register(autorun(reader => {\n            /** @description InlineCompletionsController.update model */\n            const textModel = this._textModelIfWritable.read(reader);\n            transaction(tx => {\n                /** @description InlineCompletionsController.onDidChangeModel/readonly */\n                this.model.set(undefined, tx);\n                this.updateObservables(tx, VersionIdChangeReason.Other);\n                if (textModel) {\n                    const model = _instantiationService.createInstance(InlineCompletionsModel, textModel, this._suggestWidgetAdaptor.selectedItem, this._textModelVersionId, this._positions, this._debounceValue, observableFromEvent(editor.onDidChangeConfiguration, () => editor.getOption(118 /* EditorOption.suggest */).preview), observableFromEvent(editor.onDidChangeConfiguration, () => editor.getOption(118 /* EditorOption.suggest */).previewMode), observableFromEvent(editor.onDidChangeConfiguration, () => editor.getOption(62 /* EditorOption.inlineSuggest */).mode), this._enabled);\n                    this.model.set(model, tx);\n                }\n            });\n        }));\n        const styleElement = this._register(createStyleSheet2());\n        this._register(autorun(reader => {\n            const fontFamily = this._fontFamily.read(reader);\n            styleElement.setStyle(fontFamily === '' || fontFamily === 'default' ? `` : `\n.monaco-editor .ghost-text-decoration,\n.monaco-editor .ghost-text-decoration-preview,\n.monaco-editor .ghost-text {\n\tfont-family: ${fontFamily};\n}`);\n        }));\n        const getReason = (e) => {\n            var _a;\n            if (e.isUndoing) {\n                return VersionIdChangeReason.Undo;\n            }\n            if (e.isRedoing) {\n                return VersionIdChangeReason.Redo;\n            }\n            if ((_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.isAcceptingPartially) {\n                return VersionIdChangeReason.AcceptWord;\n            }\n            return VersionIdChangeReason.Other;\n        };\n        this._register(editor.onDidChangeModelContent((e) => transaction(tx => \n        /** @description InlineCompletionsController.onDidChangeModelContent */\n        this.updateObservables(tx, getReason(e)))));\n        this._register(editor.onDidChangeCursorPosition(e => transaction(tx => {\n            var _a;\n            /** @description InlineCompletionsController.onDidChangeCursorPosition */\n            this.updateObservables(tx, VersionIdChangeReason.Other);\n            if (e.reason === 3 /* CursorChangeReason.Explicit */ || e.source === 'api') {\n                (_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.stop(tx);\n            }\n        })));\n        this._register(editor.onDidType(() => transaction(tx => {\n            var _a;\n            /** @description InlineCompletionsController.onDidType */\n            this.updateObservables(tx, VersionIdChangeReason.Other);\n            if (this._enabled.get()) {\n                (_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.trigger(tx);\n            }\n        })));\n        this._register(this._commandService.onDidExecuteCommand((e) => {\n            // These commands don't trigger onDidType.\n            const commands = new Set([\n                CoreEditingCommands.Tab.id,\n                CoreEditingCommands.DeleteLeft.id,\n                CoreEditingCommands.DeleteRight.id,\n                inlineSuggestCommitId,\n                'acceptSelectedSuggestion',\n            ]);\n            if (commands.has(e.commandId) && editor.hasTextFocus() && this._enabled.get()) {\n                transaction(tx => {\n                    var _a;\n                    /** @description onDidExecuteCommand */\n                    (_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.trigger(tx);\n                });\n            }\n        }));\n        this._register(this.editor.onDidBlurEditorWidget(() => {\n            // This is a hidden setting very useful for debugging\n            if (this._contextKeyService.getContextKeyValue('accessibleViewIsShown') || this._configurationService.getValue('editor.inlineSuggest.keepOnBlur') ||\n                editor.getOption(62 /* EditorOption.inlineSuggest */).keepOnBlur) {\n                return;\n            }\n            if (InlineSuggestionHintsContentWidget.dropDownVisible) {\n                return;\n            }\n            transaction(tx => {\n                var _a;\n                /** @description InlineCompletionsController.onDidBlurEditorWidget */\n                (_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.stop(tx);\n            });\n        }));\n        this._register(autorun(reader => {\n            var _a;\n            /** @description InlineCompletionsController.forceRenderingAbove */\n            const state = (_a = this.model.read(reader)) === null || _a === void 0 ? void 0 : _a.state.read(reader);\n            if (state === null || state === void 0 ? void 0 : state.suggestItem) {\n                if (state.primaryGhostText.lineCount >= 2) {\n                    this._suggestWidgetAdaptor.forceRenderingAbove();\n                }\n            }\n            else {\n                this._suggestWidgetAdaptor.stopForceRenderingAbove();\n            }\n        }));\n        this._register(toDisposable(() => {\n            this._suggestWidgetAdaptor.stopForceRenderingAbove();\n        }));\n        let lastInlineCompletionId = undefined;\n        this._register(autorunHandleChanges({\n            handleChange: (context, changeSummary) => {\n                if (context.didChange(this._playAccessibilitySignal)) {\n                    lastInlineCompletionId = undefined;\n                }\n                return true;\n            },\n        }, async (reader) => {\n            /** @description InlineCompletionsController.playAccessibilitySignalAndReadSuggestion */\n            this._playAccessibilitySignal.read(reader);\n            const model = this.model.read(reader);\n            const state = model === null || model === void 0 ? void 0 : model.state.read(reader);\n            if (!model || !state || !state.inlineCompletion) {\n                lastInlineCompletionId = undefined;\n                return;\n            }\n            if (state.inlineCompletion.semanticId !== lastInlineCompletionId) {\n                lastInlineCompletionId = state.inlineCompletion.semanticId;\n                const lineText = model.textModel.getLineContent(state.primaryGhostText.lineNumber);\n                this._accessibilitySignalService.playSignal(AccessibilitySignal.inlineSuggestion).then(() => {\n                    if (this.editor.getOption(8 /* EditorOption.screenReaderAnnounceInlineSuggestion */)) {\n                        this.provideScreenReaderUpdate(state.primaryGhostText.renderForScreenReader(lineText));\n                    }\n                });\n            }\n        }));\n        this._register(new InlineCompletionsHintsWidget(this.editor, this.model, this._instantiationService));\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration('accessibility.verbosity.inlineCompletions')) {\n                this.editor.updateOptions({ inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions') });\n            }\n        }));\n        this.editor.updateOptions({ inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions') });\n    }\n    playAccessibilitySignal(tx) {\n        this._playAccessibilitySignal.trigger(tx);\n    }\n    provideScreenReaderUpdate(content) {\n        const accessibleViewShowing = this._contextKeyService.getContextKeyValue('accessibleViewIsShown');\n        const accessibleViewKeybinding = this._keybindingService.lookupKeybinding('editor.action.accessibleView');\n        let hint;\n        if (!accessibleViewShowing && accessibleViewKeybinding && this.editor.getOption(148 /* EditorOption.inlineCompletionsAccessibilityVerbose */)) {\n            hint = localize('showAccessibleViewHint', \"Inspect this in the accessible view ({0})\", accessibleViewKeybinding.getAriaLabel());\n        }\n        hint ? alert(content + ', ' + hint) : alert(content);\n    }\n    /**\n     * Copies over the relevant state from the text model to observables.\n     * This solves all kind of eventing issues, as we make sure we always operate on the latest state,\n     * regardless of who calls into us.\n     */\n    updateObservables(tx, changeReason) {\n        var _a, _b, _c;\n        const newModel = this.editor.getModel();\n        this._textModelVersionId.set((_a = newModel === null || newModel === void 0 ? void 0 : newModel.getVersionId()) !== null && _a !== void 0 ? _a : -1, tx, changeReason);\n        this._positions.set((_c = (_b = this.editor.getSelections()) === null || _b === void 0 ? void 0 : _b.map(selection => selection.getPosition())) !== null && _c !== void 0 ? _c : [new Position(1, 1)], tx);\n    }\n    shouldShowHoverAt(range) {\n        var _a;\n        const ghostText = (_a = this.model.get()) === null || _a === void 0 ? void 0 : _a.primaryGhostText.get();\n        if (ghostText) {\n            return ghostText.parts.some(p => range.containsPosition(new Position(ghostText.lineNumber, p.column)));\n        }\n        return false;\n    }\n    shouldShowHoverAtViewZone(viewZoneId) {\n        var _a, _b;\n        return (_b = (_a = this._ghostTextWidgets.get()[0]) === null || _a === void 0 ? void 0 : _a.ownsViewZone(viewZoneId)) !== null && _b !== void 0 ? _b : false;\n    }\n};\nInlineCompletionsController.ID = 'editor.contrib.inlineCompletionsController';\nInlineCompletionsController = InlineCompletionsController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, IConfigurationService),\n    __param(4, ICommandService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, ILanguageFeaturesService),\n    __param(7, IAccessibilitySignalService),\n    __param(8, IKeybindingService)\n], InlineCompletionsController);\nexport { InlineCompletionsController };\nfunction convertItemsToStableObservables(items, store) {\n    const result = observableValue('result', []);\n    const innerObservables = [];\n    store.add(autorun(reader => {\n        const itemsValue = items.read(reader);\n        transaction(tx => {\n            if (itemsValue.length !== innerObservables.length) {\n                innerObservables.length = itemsValue.length;\n                for (let i = 0; i < innerObservables.length; i++) {\n                    if (!innerObservables[i]) {\n                        innerObservables[i] = observableValue('item', itemsValue[i]);\n                    }\n                }\n                result.set([...innerObservables], tx);\n            }\n            innerObservables.forEach((o, i) => o.set(itemsValue[i], tx));\n        });\n    }));\n    return result;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, derived, observableFromEvent, observableSignalFromEvent, observableValue } from '../../../../base/common/observable.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './ghostText.css';\nimport { applyFontInfo } from '../../../browser/config/domFontInfo.js';\nimport { EditorFontLigatures } from '../../../common/config/editorOptions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { LineTokens } from '../../../common/tokens/lineTokens.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { GhostTextReplacement } from './ghostText.js';\nimport { ColumnRange, applyObservableDecorations } from './utils.js';\nexport const GHOST_TEXT_DESCRIPTION = 'ghost-text';\nlet GhostTextWidget = class GhostTextWidget extends Disposable {\n    constructor(editor, model, languageService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.languageService = languageService;\n        this.isDisposed = observableValue(this, false);\n        this.currentTextModel = observableFromEvent(this.editor.onDidChangeModel, () => /** @description editor.model */ this.editor.getModel());\n        this.uiState = derived(this, reader => {\n            if (this.isDisposed.read(reader)) {\n                return undefined;\n            }\n            const textModel = this.currentTextModel.read(reader);\n            if (textModel !== this.model.targetTextModel.read(reader)) {\n                return undefined;\n            }\n            const ghostText = this.model.ghostText.read(reader);\n            if (!ghostText) {\n                return undefined;\n            }\n            const replacedRange = ghostText instanceof GhostTextReplacement ? ghostText.columnRange : undefined;\n            const inlineTexts = [];\n            const additionalLines = [];\n            function addToAdditionalLines(lines, className) {\n                if (additionalLines.length > 0) {\n                    const lastLine = additionalLines[additionalLines.length - 1];\n                    if (className) {\n                        lastLine.decorations.push(new LineDecoration(lastLine.content.length + 1, lastLine.content.length + 1 + lines[0].length, className, 0 /* InlineDecorationType.Regular */));\n                    }\n                    lastLine.content += lines[0];\n                    lines = lines.slice(1);\n                }\n                for (const line of lines) {\n                    additionalLines.push({\n                        content: line,\n                        decorations: className ? [new LineDecoration(1, line.length + 1, className, 0 /* InlineDecorationType.Regular */)] : []\n                    });\n                }\n            }\n            const textBufferLine = textModel.getLineContent(ghostText.lineNumber);\n            let hiddenTextStartColumn = undefined;\n            let lastIdx = 0;\n            for (const part of ghostText.parts) {\n                let lines = part.lines;\n                if (hiddenTextStartColumn === undefined) {\n                    inlineTexts.push({\n                        column: part.column,\n                        text: lines[0],\n                        preview: part.preview,\n                    });\n                    lines = lines.slice(1);\n                }\n                else {\n                    addToAdditionalLines([textBufferLine.substring(lastIdx, part.column - 1)], undefined);\n                }\n                if (lines.length > 0) {\n                    addToAdditionalLines(lines, GHOST_TEXT_DESCRIPTION);\n                    if (hiddenTextStartColumn === undefined && part.column <= textBufferLine.length) {\n                        hiddenTextStartColumn = part.column;\n                    }\n                }\n                lastIdx = part.column - 1;\n            }\n            if (hiddenTextStartColumn !== undefined) {\n                addToAdditionalLines([textBufferLine.substring(lastIdx)], undefined);\n            }\n            const hiddenRange = hiddenTextStartColumn !== undefined ? new ColumnRange(hiddenTextStartColumn, textBufferLine.length + 1) : undefined;\n            return {\n                replacedRange,\n                inlineTexts,\n                additionalLines,\n                hiddenRange,\n                lineNumber: ghostText.lineNumber,\n                additionalReservedLineCount: this.model.minReservedLineCount.read(reader),\n                targetTextModel: textModel,\n            };\n        });\n        this.decorations = derived(this, reader => {\n            const uiState = this.uiState.read(reader);\n            if (!uiState) {\n                return [];\n            }\n            const decorations = [];\n            if (uiState.replacedRange) {\n                decorations.push({\n                    range: uiState.replacedRange.toRange(uiState.lineNumber),\n                    options: { inlineClassName: 'inline-completion-text-to-replace', description: 'GhostTextReplacement' }\n                });\n            }\n            if (uiState.hiddenRange) {\n                decorations.push({\n                    range: uiState.hiddenRange.toRange(uiState.lineNumber),\n                    options: { inlineClassName: 'ghost-text-hidden', description: 'ghost-text-hidden', }\n                });\n            }\n            for (const p of uiState.inlineTexts) {\n                decorations.push({\n                    range: Range.fromPositions(new Position(uiState.lineNumber, p.column)),\n                    options: {\n                        description: GHOST_TEXT_DESCRIPTION,\n                        after: { content: p.text, inlineClassName: p.preview ? 'ghost-text-decoration-preview' : 'ghost-text-decoration', cursorStops: InjectedTextCursorStops.Left },\n                        showIfCollapsed: true,\n                    }\n                });\n            }\n            return decorations;\n        });\n        this.additionalLinesWidget = this._register(new AdditionalLinesWidget(this.editor, this.languageService.languageIdCodec, derived(reader => {\n            /** @description lines */\n            const uiState = this.uiState.read(reader);\n            return uiState ? {\n                lineNumber: uiState.lineNumber,\n                additionalLines: uiState.additionalLines,\n                minReservedLineCount: uiState.additionalReservedLineCount,\n                targetTextModel: uiState.targetTextModel,\n            } : undefined;\n        })));\n        this._register(toDisposable(() => { this.isDisposed.set(true, undefined); }));\n        this._register(applyObservableDecorations(this.editor, this.decorations));\n    }\n    ownsViewZone(viewZoneId) {\n        return this.additionalLinesWidget.viewZoneId === viewZoneId;\n    }\n};\nGhostTextWidget = __decorate([\n    __param(2, ILanguageService)\n], GhostTextWidget);\nexport { GhostTextWidget };\nexport class AdditionalLinesWidget extends Disposable {\n    get viewZoneId() { return this._viewZoneId; }\n    constructor(editor, languageIdCodec, lines) {\n        super();\n        this.editor = editor;\n        this.languageIdCodec = languageIdCodec;\n        this.lines = lines;\n        this._viewZoneId = undefined;\n        this.editorOptionsChanged = observableSignalFromEvent('editorOptionChanged', Event.filter(this.editor.onDidChangeConfiguration, e => e.hasChanged(33 /* EditorOption.disableMonospaceOptimizations */)\n            || e.hasChanged(117 /* EditorOption.stopRenderingLineAfter */)\n            || e.hasChanged(99 /* EditorOption.renderWhitespace */)\n            || e.hasChanged(94 /* EditorOption.renderControlCharacters */)\n            || e.hasChanged(51 /* EditorOption.fontLigatures */)\n            || e.hasChanged(50 /* EditorOption.fontInfo */)\n            || e.hasChanged(67 /* EditorOption.lineHeight */)));\n        this._register(autorun(reader => {\n            /** @description update view zone */\n            const lines = this.lines.read(reader);\n            this.editorOptionsChanged.read(reader);\n            if (lines) {\n                this.updateLines(lines.lineNumber, lines.additionalLines, lines.minReservedLineCount);\n            }\n            else {\n                this.clear();\n            }\n        }));\n    }\n    dispose() {\n        super.dispose();\n        this.clear();\n    }\n    clear() {\n        this.editor.changeViewZones((changeAccessor) => {\n            if (this._viewZoneId) {\n                changeAccessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n            }\n        });\n    }\n    updateLines(lineNumber, additionalLines, minReservedLineCount) {\n        const textModel = this.editor.getModel();\n        if (!textModel) {\n            return;\n        }\n        const { tabSize } = textModel.getOptions();\n        this.editor.changeViewZones((changeAccessor) => {\n            if (this._viewZoneId) {\n                changeAccessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n            }\n            const heightInLines = Math.max(additionalLines.length, minReservedLineCount);\n            if (heightInLines > 0) {\n                const domNode = document.createElement('div');\n                renderLines(domNode, tabSize, additionalLines, this.editor.getOptions(), this.languageIdCodec);\n                this._viewZoneId = changeAccessor.addZone({\n                    afterLineNumber: lineNumber,\n                    heightInLines: heightInLines,\n                    domNode,\n                    afterColumnAffinity: 1 /* PositionAffinity.Right */\n                });\n            }\n        });\n    }\n}\nfunction renderLines(domNode, tabSize, lines, opts, languageIdCodec) {\n    const disableMonospaceOptimizations = opts.get(33 /* EditorOption.disableMonospaceOptimizations */);\n    const stopRenderingLineAfter = opts.get(117 /* EditorOption.stopRenderingLineAfter */);\n    // To avoid visual confusion, we don't want to render visible whitespace\n    const renderWhitespace = 'none';\n    const renderControlCharacters = opts.get(94 /* EditorOption.renderControlCharacters */);\n    const fontLigatures = opts.get(51 /* EditorOption.fontLigatures */);\n    const fontInfo = opts.get(50 /* EditorOption.fontInfo */);\n    const lineHeight = opts.get(67 /* EditorOption.lineHeight */);\n    const sb = new StringBuilder(10000);\n    sb.appendString('<div class=\"suggest-preview-text\">');\n    for (let i = 0, len = lines.length; i < len; i++) {\n        const lineData = lines[i];\n        const line = lineData.content;\n        sb.appendString('<div class=\"view-line');\n        sb.appendString('\" style=\"top:');\n        sb.appendString(String(i * lineHeight));\n        sb.appendString('px;width:1000000px;\">');\n        const isBasicASCII = strings.isBasicASCII(line);\n        const containsRTL = strings.containsRTL(line);\n        const lineTokens = LineTokens.createEmpty(line, languageIdCodec);\n        renderViewLine(new RenderLineInput((fontInfo.isMonospace && !disableMonospaceOptimizations), fontInfo.canUseHalfwidthRightwardsArrow, line, false, isBasicASCII, containsRTL, 0, lineTokens, lineData.decorations, tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, fontInfo.wsmiddotWidth, stopRenderingLineAfter, renderWhitespace, renderControlCharacters, fontLigatures !== EditorFontLigatures.OFF, null), sb);\n        sb.appendString('</div>');\n    }\n    sb.appendString('</div>');\n    applyFontInfo(domNode, fontInfo);\n    const html = sb.build();\n    const trustedhtml = ttPolicy ? ttPolicy.createHTML(html) : html;\n    domNode.innerHTML = trustedhtml;\n}\nexport const ttPolicy = createTrustedTypesPolicy('editorGhostText', { createHTML: value => value });\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { equals } from '../../../../base/common/arrays.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport { applyEdits } from './utils.js';\nexport class GhostText {\n    constructor(lineNumber, parts) {\n        this.lineNumber = lineNumber;\n        this.parts = parts;\n    }\n    equals(other) {\n        return this.lineNumber === other.lineNumber &&\n            this.parts.length === other.parts.length &&\n            this.parts.every((part, index) => part.equals(other.parts[index]));\n    }\n    renderForScreenReader(lineText) {\n        if (this.parts.length === 0) {\n            return '';\n        }\n        const lastPart = this.parts[this.parts.length - 1];\n        const cappedLineText = lineText.substr(0, lastPart.column - 1);\n        const text = applyEdits(cappedLineText, this.parts.map(p => ({\n            range: { startLineNumber: 1, endLineNumber: 1, startColumn: p.column, endColumn: p.column },\n            text: p.lines.join('\\n')\n        })));\n        return text.substring(this.parts[0].column - 1);\n    }\n    isEmpty() {\n        return this.parts.every(p => p.lines.length === 0);\n    }\n    get lineCount() {\n        return 1 + this.parts.reduce((r, p) => r + p.lines.length - 1, 0);\n    }\n}\nexport class GhostTextPart {\n    constructor(column, text, \n    /**\n     * Indicates if this part is a preview of an inline suggestion when a suggestion is previewed.\n    */\n    preview) {\n        this.column = column;\n        this.text = text;\n        this.preview = preview;\n        this.lines = splitLines(this.text);\n    }\n    ;\n    equals(other) {\n        return this.column === other.column &&\n            this.lines.length === other.lines.length &&\n            this.lines.every((line, index) => line === other.lines[index]);\n    }\n}\nexport class GhostTextReplacement {\n    constructor(lineNumber, columnRange, text, additionalReservedLineCount = 0) {\n        this.lineNumber = lineNumber;\n        this.columnRange = columnRange;\n        this.text = text;\n        this.additionalReservedLineCount = additionalReservedLineCount;\n        this.parts = [\n            new GhostTextPart(this.columnRange.endColumnExclusive, this.text, false),\n        ];\n        this.newLines = splitLines(this.text);\n    }\n    renderForScreenReader(_lineText) {\n        return this.newLines.join('\\n');\n    }\n    get lineCount() {\n        return this.newLines.length;\n    }\n    isEmpty() {\n        return this.parts.every(p => p.lines.length === 0);\n    }\n    equals(other) {\n        return this.lineNumber === other.lineNumber &&\n            this.columnRange.equals(other.columnRange) &&\n            this.newLines.length === other.newLines.length &&\n            this.newLines.every((line, index) => line === other.newLines[index]) &&\n            this.additionalReservedLineCount === other.additionalReservedLineCount;\n    }\n}\nexport function ghostTextsOrReplacementsEqual(a, b) {\n    return equals(a, b, ghostTextOrReplacementEquals);\n}\nexport function ghostTextOrReplacementEquals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (!a || !b) {\n        return false;\n    }\n    if (a instanceof GhostText && b instanceof GhostText) {\n        return a.equals(b);\n    }\n    if (a instanceof GhostTextReplacement && b instanceof GhostTextReplacement) {\n        return a.equals(b);\n    }\n    return false;\n}\n", "import { BugIndicatingError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { autorunOpts } from '../../../../base/common/observable.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nexport function applyEdits(text, edits) {\n    const transformer = new PositionOffsetTransformer(text);\n    const offsetEdits = edits.map(e => {\n        const range = Range.lift(e.range);\n        return ({\n            startOffset: transformer.getOffset(range.getStartPosition()),\n            endOffset: transformer.getOffset(range.getEndPosition()),\n            text: e.text\n        });\n    });\n    offsetEdits.sort((a, b) => b.startOffset - a.startOffset);\n    for (const edit of offsetEdits) {\n        text = text.substring(0, edit.startOffset) + edit.text + text.substring(edit.endOffset);\n    }\n    return text;\n}\nclass PositionOffsetTransformer {\n    constructor(text) {\n        this.lineStartOffsetByLineIdx = [];\n        this.lineStartOffsetByLineIdx.push(0);\n        for (let i = 0; i < text.length; i++) {\n            if (text.charAt(i) === '\\n') {\n                this.lineStartOffsetByLineIdx.push(i + 1);\n            }\n        }\n    }\n    getOffset(position) {\n        return this.lineStartOffsetByLineIdx[position.lineNumber - 1] + position.column - 1;\n    }\n}\nconst array = [];\nexport function getReadonlyEmptyArray() {\n    return array;\n}\nexport class ColumnRange {\n    constructor(startColumn, endColumnExclusive) {\n        this.startColumn = startColumn;\n        this.endColumnExclusive = endColumnExclusive;\n        if (startColumn > endColumnExclusive) {\n            throw new BugIndicatingError(`startColumn ${startColumn} cannot be after endColumnExclusive ${endColumnExclusive}`);\n        }\n    }\n    toRange(lineNumber) {\n        return new Range(lineNumber, this.startColumn, lineNumber, this.endColumnExclusive);\n    }\n    equals(other) {\n        return this.startColumn === other.startColumn\n            && this.endColumnExclusive === other.endColumnExclusive;\n    }\n}\nexport function applyObservableDecorations(editor, decorations) {\n    const d = new DisposableStore();\n    const decorationsCollection = editor.createDecorationsCollection();\n    d.add(autorunOpts({ debugName: () => `Apply decorations from ${decorations.debugName}` }, reader => {\n        const d = decorations.read(reader);\n        decorationsCollection.set(d);\n    }));\n    d.add({\n        dispose: () => {\n            decorationsCollection.clear();\n        }\n    });\n    return d;\n}\nexport function addPositions(pos1, pos2) {\n    return new Position(pos1.lineNumber + pos2.lineNumber - 1, pos2.lineNumber === 1 ? pos1.column + pos2.column - 1 : pos2.column);\n}\nexport function subtractPositions(pos1, pos2) {\n    return new Position(pos1.lineNumber - pos2.lineNumber + 1, pos1.lineNumber - pos2.lineNumber === 0 ? pos1.column - pos2.column + 1 : pos1.column);\n}\nexport function lengthOfText(text) {\n    let line = 1;\n    let column = 1;\n    for (const c of text) {\n        if (c === '\\n') {\n            line++;\n            column = 1;\n        }\n        else {\n            column++;\n        }\n    }\n    return new Position(line, column);\n}\n/**\n * Given some text edits, this function finds the new ranges of the editted text post application of all edits.\n * Assumes that the edit ranges are disjoint and they are sorted in the order of the ranges\n * @param edits edits applied\n * @returns new ranges post edits for every edit\n */\nexport function getNewRanges(edits) {\n    var _a;\n    const newRanges = [];\n    let previousEditEndLineNumber = 0;\n    let lineOffset = 0;\n    let columnOffset = 0;\n    for (const edit of edits) {\n        const text = (_a = edit.text) !== null && _a !== void 0 ? _a : '';\n        const textLength = lengthOfText(text);\n        const newRangeStart = Position.lift({\n            lineNumber: edit.range.startLineNumber + lineOffset,\n            column: edit.range.startColumn + (edit.range.startLineNumber === previousEditEndLineNumber ? columnOffset : 0)\n        });\n        const newRangeEnd = addPositions(newRangeStart, textLength);\n        newRanges.push(Range.fromPositions(newRangeStart, newRangeEnd));\n        lineOffset += textLength.lineNumber - edit.range.endLineNumber + edit.range.startLineNumber - 1;\n        columnOffset = newRangeEnd.column - edit.range.endColumn;\n        previousEditEndLineNumber = edit.range.endLineNumber;\n    }\n    return newRanges;\n}\nexport class Permutation {\n    constructor(_indexMap) {\n        this._indexMap = _indexMap;\n    }\n    static createSortPermutation(arr, compareFn) {\n        const sortIndices = Array.from(arr.keys()).sort((index1, index2) => compareFn(arr[index1], arr[index2]));\n        return new Permutation(sortIndices);\n    }\n    apply(arr) {\n        return arr.map((_, index) => arr[this._indexMap[index]]);\n    }\n    inverse() {\n        const inverseIndexMap = this._indexMap.slice();\n        for (let i = 0; i < this._indexMap.length; i++) {\n            inverseIndexMap[this._indexMap[i]] = i;\n        }\n        return new Permutation(inverseIndexMap);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { mapFindFirst } from '../../../../base/common/arraysFind.js';\nimport { BugIndicatingError, onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, derived, derivedHandleChanges, derivedOpts, recomputeInitiallyAndOnChange, observableSignal, observableValue, subtransaction, transaction } from '../../../../base/common/observable.js';\nimport { commonPrefixLength, splitLinesIncludeSeparators } from '../../../../base/common/strings.js';\nimport { isDefined } from '../../../../base/common/types.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { GhostText, ghostTextOrReplacementEquals, ghostTextsOrReplacementsEqual } from './ghostText.js';\nimport { InlineCompletionsSource } from './inlineCompletionsSource.js';\nimport { SingleTextEdit } from './singleTextEdit.js';\nimport { Permutation, addPositions, getNewRanges, lengthOfText, subtractPositions } from './utils.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport var VersionIdChangeReason;\n(function (VersionIdChangeReason) {\n    VersionIdChangeReason[VersionIdChangeReason[\"Undo\"] = 0] = \"Undo\";\n    VersionIdChangeReason[VersionIdChangeReason[\"Redo\"] = 1] = \"Redo\";\n    VersionIdChangeReason[VersionIdChangeReason[\"AcceptWord\"] = 2] = \"AcceptWord\";\n    VersionIdChangeReason[VersionIdChangeReason[\"Other\"] = 3] = \"Other\";\n})(VersionIdChangeReason || (VersionIdChangeReason = {}));\nlet InlineCompletionsModel = class InlineCompletionsModel extends Disposable {\n    get isAcceptingPartially() { return this._isAcceptingPartially; }\n    constructor(textModel, selectedSuggestItem, textModelVersionId, _positions, _debounceValue, _suggestPreviewEnabled, _suggestPreviewMode, _inlineSuggestMode, _enabled, _instantiationService, _commandService, _languageConfigurationService) {\n        super();\n        this.textModel = textModel;\n        this.selectedSuggestItem = selectedSuggestItem;\n        this.textModelVersionId = textModelVersionId;\n        this._positions = _positions;\n        this._debounceValue = _debounceValue;\n        this._suggestPreviewEnabled = _suggestPreviewEnabled;\n        this._suggestPreviewMode = _suggestPreviewMode;\n        this._inlineSuggestMode = _inlineSuggestMode;\n        this._enabled = _enabled;\n        this._instantiationService = _instantiationService;\n        this._commandService = _commandService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._source = this._register(this._instantiationService.createInstance(InlineCompletionsSource, this.textModel, this.textModelVersionId, this._debounceValue));\n        this._isActive = observableValue(this, false);\n        this._forceUpdateSignal = observableSignal('forceUpdate');\n        // We use a semantic id to keep the same inline completion selected even if the provider reorders the completions.\n        this._selectedInlineCompletionId = observableValue(this, undefined);\n        this._primaryPosition = derived(this, reader => { var _a; return (_a = this._positions.read(reader)[0]) !== null && _a !== void 0 ? _a : new Position(1, 1); });\n        this._isAcceptingPartially = false;\n        this._preserveCurrentCompletionReasons = new Set([\n            VersionIdChangeReason.Redo,\n            VersionIdChangeReason.Undo,\n            VersionIdChangeReason.AcceptWord,\n        ]);\n        this._fetchInlineCompletions = derivedHandleChanges({\n            owner: this,\n            createEmptyChangeSummary: () => ({\n                preserveCurrentCompletion: false,\n                inlineCompletionTriggerKind: InlineCompletionTriggerKind.Automatic\n            }),\n            handleChange: (ctx, changeSummary) => {\n                /** @description fetch inline completions */\n                if (ctx.didChange(this.textModelVersionId) && this._preserveCurrentCompletionReasons.has(ctx.change)) {\n                    changeSummary.preserveCurrentCompletion = true;\n                }\n                else if (ctx.didChange(this._forceUpdateSignal)) {\n                    changeSummary.inlineCompletionTriggerKind = ctx.change;\n                }\n                return true;\n            },\n        }, (reader, changeSummary) => {\n            this._forceUpdateSignal.read(reader);\n            const shouldUpdate = (this._enabled.read(reader) && this.selectedSuggestItem.read(reader)) || this._isActive.read(reader);\n            if (!shouldUpdate) {\n                this._source.cancelUpdate();\n                return undefined;\n            }\n            this.textModelVersionId.read(reader); // Refetch on text change\n            const itemToPreserveCandidate = this.selectedInlineCompletion.get();\n            const itemToPreserve = changeSummary.preserveCurrentCompletion || (itemToPreserveCandidate === null || itemToPreserveCandidate === void 0 ? void 0 : itemToPreserveCandidate.forwardStable)\n                ? itemToPreserveCandidate : undefined;\n            const suggestWidgetInlineCompletions = this._source.suggestWidgetInlineCompletions.get();\n            const suggestItem = this.selectedSuggestItem.read(reader);\n            if (suggestWidgetInlineCompletions && !suggestItem) {\n                const inlineCompletions = this._source.inlineCompletions.get();\n                transaction(tx => {\n                    /** @description Seed inline completions with (newer) suggest widget inline completions */\n                    if (!inlineCompletions || suggestWidgetInlineCompletions.request.versionId > inlineCompletions.request.versionId) {\n                        this._source.inlineCompletions.set(suggestWidgetInlineCompletions.clone(), tx);\n                    }\n                    this._source.clearSuggestWidgetInlineCompletions(tx);\n                });\n            }\n            const cursorPosition = this._primaryPosition.read(reader);\n            const context = {\n                triggerKind: changeSummary.inlineCompletionTriggerKind,\n                selectedSuggestionInfo: suggestItem === null || suggestItem === void 0 ? void 0 : suggestItem.toSelectedSuggestionInfo(),\n            };\n            return this._source.fetch(cursorPosition, context, itemToPreserve);\n        });\n        this._filteredInlineCompletionItems = derived(this, reader => {\n            const c = this._source.inlineCompletions.read(reader);\n            if (!c) {\n                return [];\n            }\n            const cursorPosition = this._primaryPosition.read(reader);\n            const filteredCompletions = c.inlineCompletions.filter(c => c.isVisible(this.textModel, cursorPosition, reader));\n            return filteredCompletions;\n        });\n        this.selectedInlineCompletionIndex = derived(this, (reader) => {\n            const selectedInlineCompletionId = this._selectedInlineCompletionId.read(reader);\n            const filteredCompletions = this._filteredInlineCompletionItems.read(reader);\n            const idx = this._selectedInlineCompletionId === undefined ? -1\n                : filteredCompletions.findIndex(v => v.semanticId === selectedInlineCompletionId);\n            if (idx === -1) {\n                // Reset the selection so that the selection does not jump back when it appears again\n                this._selectedInlineCompletionId.set(undefined, undefined);\n                return 0;\n            }\n            return idx;\n        });\n        this.selectedInlineCompletion = derived(this, (reader) => {\n            const filteredCompletions = this._filteredInlineCompletionItems.read(reader);\n            const idx = this.selectedInlineCompletionIndex.read(reader);\n            return filteredCompletions[idx];\n        });\n        this.lastTriggerKind = this._source.inlineCompletions.map(this, v => v === null || v === void 0 ? void 0 : v.request.context.triggerKind);\n        this.inlineCompletionsCount = derived(this, reader => {\n            if (this.lastTriggerKind.read(reader) === InlineCompletionTriggerKind.Explicit) {\n                return this._filteredInlineCompletionItems.read(reader).length;\n            }\n            else {\n                return undefined;\n            }\n        });\n        this.state = derivedOpts({\n            owner: this,\n            equalityComparer: (a, b) => {\n                if (!a || !b) {\n                    return a === b;\n                }\n                return ghostTextsOrReplacementsEqual(a.ghostTexts, b.ghostTexts)\n                    && a.inlineCompletion === b.inlineCompletion\n                    && a.suggestItem === b.suggestItem;\n            }\n        }, (reader) => {\n            var _a, _b;\n            const model = this.textModel;\n            const suggestItem = this.selectedSuggestItem.read(reader);\n            if (suggestItem) {\n                const suggestCompletionEdit = suggestItem.toSingleTextEdit().removeCommonPrefix(model);\n                const augmentation = this._computeAugmentation(suggestCompletionEdit, reader);\n                const isSuggestionPreviewEnabled = this._suggestPreviewEnabled.read(reader);\n                if (!isSuggestionPreviewEnabled && !augmentation) {\n                    return undefined;\n                }\n                const fullEdit = (_a = augmentation === null || augmentation === void 0 ? void 0 : augmentation.edit) !== null && _a !== void 0 ? _a : suggestCompletionEdit;\n                const fullEditPreviewLength = augmentation ? augmentation.edit.text.length - suggestCompletionEdit.text.length : 0;\n                const mode = this._suggestPreviewMode.read(reader);\n                const positions = this._positions.read(reader);\n                const edits = [fullEdit, ...getSecondaryEdits(this.textModel, positions, fullEdit)];\n                const ghostTexts = edits\n                    .map((edit, idx) => edit.computeGhostText(model, mode, positions[idx], fullEditPreviewLength))\n                    .filter(isDefined);\n                const primaryGhostText = (_b = ghostTexts[0]) !== null && _b !== void 0 ? _b : new GhostText(fullEdit.range.endLineNumber, []);\n                return { edits, primaryGhostText, ghostTexts, inlineCompletion: augmentation === null || augmentation === void 0 ? void 0 : augmentation.completion, suggestItem };\n            }\n            else {\n                if (!this._isActive.read(reader)) {\n                    return undefined;\n                }\n                const inlineCompletion = this.selectedInlineCompletion.read(reader);\n                if (!inlineCompletion) {\n                    return undefined;\n                }\n                const replacement = inlineCompletion.toSingleTextEdit(reader);\n                const mode = this._inlineSuggestMode.read(reader);\n                const positions = this._positions.read(reader);\n                const edits = [replacement, ...getSecondaryEdits(this.textModel, positions, replacement)];\n                const ghostTexts = edits\n                    .map((edit, idx) => edit.computeGhostText(model, mode, positions[idx], 0))\n                    .filter(isDefined);\n                if (!ghostTexts[0]) {\n                    return undefined;\n                }\n                return { edits, primaryGhostText: ghostTexts[0], ghostTexts, inlineCompletion, suggestItem: undefined };\n            }\n        });\n        this.ghostTexts = derivedOpts({\n            owner: this,\n            equalityComparer: ghostTextsOrReplacementsEqual\n        }, reader => {\n            const v = this.state.read(reader);\n            if (!v) {\n                return undefined;\n            }\n            return v.ghostTexts;\n        });\n        this.primaryGhostText = derivedOpts({\n            owner: this,\n            equalityComparer: ghostTextOrReplacementEquals\n        }, reader => {\n            const v = this.state.read(reader);\n            if (!v) {\n                return undefined;\n            }\n            return v === null || v === void 0 ? void 0 : v.primaryGhostText;\n        });\n        this._register(recomputeInitiallyAndOnChange(this._fetchInlineCompletions));\n        let lastItem = undefined;\n        this._register(autorun(reader => {\n            var _a, _b;\n            /** @description call handleItemDidShow */\n            const item = this.state.read(reader);\n            const completion = item === null || item === void 0 ? void 0 : item.inlineCompletion;\n            if ((completion === null || completion === void 0 ? void 0 : completion.semanticId) !== (lastItem === null || lastItem === void 0 ? void 0 : lastItem.semanticId)) {\n                lastItem = completion;\n                if (completion) {\n                    const i = completion.inlineCompletion;\n                    const src = i.source;\n                    (_b = (_a = src.provider).handleItemDidShow) === null || _b === void 0 ? void 0 : _b.call(_a, src.inlineCompletions, i.sourceInlineCompletion, i.insertText);\n                }\n            }\n        }));\n    }\n    async trigger(tx) {\n        this._isActive.set(true, tx);\n        await this._fetchInlineCompletions.get();\n    }\n    async triggerExplicitly(tx) {\n        subtransaction(tx, tx => {\n            this._isActive.set(true, tx);\n            this._forceUpdateSignal.trigger(tx, InlineCompletionTriggerKind.Explicit);\n        });\n        await this._fetchInlineCompletions.get();\n    }\n    stop(tx) {\n        subtransaction(tx, tx => {\n            this._isActive.set(false, tx);\n            this._source.clear(tx);\n        });\n    }\n    _computeAugmentation(suggestCompletion, reader) {\n        const model = this.textModel;\n        const suggestWidgetInlineCompletions = this._source.suggestWidgetInlineCompletions.read(reader);\n        const candidateInlineCompletions = suggestWidgetInlineCompletions\n            ? suggestWidgetInlineCompletions.inlineCompletions\n            : [this.selectedInlineCompletion.read(reader)].filter(isDefined);\n        const augmentedCompletion = mapFindFirst(candidateInlineCompletions, completion => {\n            let r = completion.toSingleTextEdit(reader);\n            r = r.removeCommonPrefix(model, Range.fromPositions(r.range.getStartPosition(), suggestCompletion.range.getEndPosition()));\n            return r.augments(suggestCompletion) ? { completion, edit: r } : undefined;\n        });\n        return augmentedCompletion;\n    }\n    async _deltaSelectedInlineCompletionIndex(delta) {\n        await this.triggerExplicitly();\n        const completions = this._filteredInlineCompletionItems.get() || [];\n        if (completions.length > 0) {\n            const newIdx = (this.selectedInlineCompletionIndex.get() + delta + completions.length) % completions.length;\n            this._selectedInlineCompletionId.set(completions[newIdx].semanticId, undefined);\n        }\n        else {\n            this._selectedInlineCompletionId.set(undefined, undefined);\n        }\n    }\n    async next() {\n        await this._deltaSelectedInlineCompletionIndex(1);\n    }\n    async previous() {\n        await this._deltaSelectedInlineCompletionIndex(-1);\n    }\n    async accept(editor) {\n        var _a;\n        if (editor.getModel() !== this.textModel) {\n            throw new BugIndicatingError();\n        }\n        const state = this.state.get();\n        if (!state || state.primaryGhostText.isEmpty() || !state.inlineCompletion) {\n            return;\n        }\n        const completion = state.inlineCompletion.toInlineCompletion(undefined);\n        editor.pushUndoStop();\n        if (completion.snippetInfo) {\n            editor.executeEdits('inlineSuggestion.accept', [\n                EditOperation.replaceMove(completion.range, ''),\n                ...completion.additionalTextEdits\n            ]);\n            editor.setPosition(completion.snippetInfo.range.getStartPosition(), 'inlineCompletionAccept');\n            (_a = SnippetController2.get(editor)) === null || _a === void 0 ? void 0 : _a.insert(completion.snippetInfo.snippet, { undoStopBefore: false });\n        }\n        else {\n            const edits = state.edits;\n            const selections = getEndPositionsAfterApplying(edits).map(p => Selection.fromPositions(p));\n            editor.executeEdits('inlineSuggestion.accept', [\n                ...edits.map(edit => EditOperation.replaceMove(edit.range, edit.text)),\n                ...completion.additionalTextEdits\n            ]);\n            editor.setSelections(selections, 'inlineCompletionAccept');\n        }\n        if (completion.command) {\n            // Make sure the completion list will not be disposed.\n            completion.source.addRef();\n        }\n        // Reset before invoking the command, since the command might cause a follow up trigger.\n        transaction(tx => {\n            this._source.clear(tx);\n            // Potentially, isActive will get set back to true by the typing or accept inline suggest event\n            // if automatic inline suggestions are enabled.\n            this._isActive.set(false, tx);\n        });\n        if (completion.command) {\n            await this._commandService\n                .executeCommand(completion.command.id, ...(completion.command.arguments || []))\n                .then(undefined, onUnexpectedExternalError);\n            completion.source.removeRef();\n        }\n    }\n    async acceptNextWord(editor) {\n        await this._acceptNext(editor, (pos, text) => {\n            const langId = this.textModel.getLanguageIdAtPosition(pos.lineNumber, pos.column);\n            const config = this._languageConfigurationService.getLanguageConfiguration(langId);\n            const wordRegExp = new RegExp(config.wordDefinition.source, config.wordDefinition.flags.replace('g', ''));\n            const m1 = text.match(wordRegExp);\n            let acceptUntilIndexExclusive = 0;\n            if (m1 && m1.index !== undefined) {\n                if (m1.index === 0) {\n                    acceptUntilIndexExclusive = m1[0].length;\n                }\n                else {\n                    acceptUntilIndexExclusive = m1.index;\n                }\n            }\n            else {\n                acceptUntilIndexExclusive = text.length;\n            }\n            const wsRegExp = /\\s+/g;\n            const m2 = wsRegExp.exec(text);\n            if (m2 && m2.index !== undefined) {\n                if (m2.index + m2[0].length < acceptUntilIndexExclusive) {\n                    acceptUntilIndexExclusive = m2.index + m2[0].length;\n                }\n            }\n            return acceptUntilIndexExclusive;\n        });\n    }\n    async acceptNextLine(editor) {\n        await this._acceptNext(editor, (pos, text) => {\n            const m = text.match(/\\n/);\n            if (m && m.index !== undefined) {\n                return m.index + 1;\n            }\n            return text.length;\n        });\n    }\n    async _acceptNext(editor, getAcceptUntilIndex) {\n        if (editor.getModel() !== this.textModel) {\n            throw new BugIndicatingError();\n        }\n        const state = this.state.get();\n        if (!state || state.primaryGhostText.isEmpty() || !state.inlineCompletion) {\n            return;\n        }\n        const ghostText = state.primaryGhostText;\n        const completion = state.inlineCompletion.toInlineCompletion(undefined);\n        if (completion.snippetInfo || completion.filterText !== completion.insertText) {\n            // not in WYSIWYG mode, partial commit might change completion, thus it is not supported\n            await this.accept(editor);\n            return;\n        }\n        const firstPart = ghostText.parts[0];\n        const ghostTextPos = new Position(ghostText.lineNumber, firstPart.column);\n        const ghostTextVal = firstPart.text;\n        const acceptUntilIndexExclusive = getAcceptUntilIndex(ghostTextPos, ghostTextVal);\n        if (acceptUntilIndexExclusive === ghostTextVal.length && ghostText.parts.length === 1) {\n            this.accept(editor);\n            return;\n        }\n        const partialGhostTextVal = ghostTextVal.substring(0, acceptUntilIndexExclusive);\n        const positions = this._positions.get();\n        const cursorPosition = positions[0];\n        // Executing the edit might free the completion, so we have to hold a reference on it.\n        completion.source.addRef();\n        try {\n            this._isAcceptingPartially = true;\n            try {\n                editor.pushUndoStop();\n                const replaceRange = Range.fromPositions(cursorPosition, ghostTextPos);\n                const newText = editor.getModel().getValueInRange(replaceRange) + partialGhostTextVal;\n                const primaryEdit = new SingleTextEdit(replaceRange, newText);\n                const edits = [primaryEdit, ...getSecondaryEdits(this.textModel, positions, primaryEdit)];\n                const selections = getEndPositionsAfterApplying(edits).map(p => Selection.fromPositions(p));\n                editor.executeEdits('inlineSuggestion.accept', edits.map(edit => EditOperation.replaceMove(edit.range, edit.text)));\n                editor.setSelections(selections, 'inlineCompletionPartialAccept');\n            }\n            finally {\n                this._isAcceptingPartially = false;\n            }\n            if (completion.source.provider.handlePartialAccept) {\n                const acceptedRange = Range.fromPositions(completion.range.getStartPosition(), addPositions(ghostTextPos, lengthOfText(partialGhostTextVal)));\n                // This assumes that the inline completion and the model use the same EOL style.\n                const text = editor.getModel().getValueInRange(acceptedRange, 1 /* EndOfLinePreference.LF */);\n                completion.source.provider.handlePartialAccept(completion.source.inlineCompletions, completion.sourceInlineCompletion, text.length);\n            }\n        }\n        finally {\n            completion.source.removeRef();\n        }\n    }\n    handleSuggestAccepted(item) {\n        var _a, _b;\n        const itemEdit = item.toSingleTextEdit().removeCommonPrefix(this.textModel);\n        const augmentedCompletion = this._computeAugmentation(itemEdit, undefined);\n        if (!augmentedCompletion) {\n            return;\n        }\n        const inlineCompletion = augmentedCompletion.completion.inlineCompletion;\n        (_b = (_a = inlineCompletion.source.provider).handlePartialAccept) === null || _b === void 0 ? void 0 : _b.call(_a, inlineCompletion.source.inlineCompletions, inlineCompletion.sourceInlineCompletion, itemEdit.text.length);\n    }\n};\nInlineCompletionsModel = __decorate([\n    __param(9, IInstantiationService),\n    __param(10, ICommandService),\n    __param(11, ILanguageConfigurationService)\n], InlineCompletionsModel);\nexport { InlineCompletionsModel };\nexport function getSecondaryEdits(textModel, positions, primaryEdit) {\n    if (positions.length === 1) {\n        // No secondary cursor positions\n        return [];\n    }\n    const primaryPosition = positions[0];\n    const secondaryPositions = positions.slice(1);\n    const primaryEditStartPosition = primaryEdit.range.getStartPosition();\n    const primaryEditEndPosition = primaryEdit.range.getEndPosition();\n    const replacedTextAfterPrimaryCursor = textModel.getValueInRange(Range.fromPositions(primaryPosition, primaryEditEndPosition));\n    const positionWithinTextEdit = subtractPositions(primaryPosition, primaryEditStartPosition);\n    if (positionWithinTextEdit.lineNumber < 1) {\n        onUnexpectedError(new BugIndicatingError(`positionWithinTextEdit line number should be bigger than 0.\n\t\t\tInvalid subtraction between ${primaryPosition.toString()} and ${primaryEditStartPosition.toString()}`));\n        return [];\n    }\n    const secondaryEditText = substringPos(primaryEdit.text, positionWithinTextEdit);\n    return secondaryPositions.map(pos => {\n        const posEnd = addPositions(subtractPositions(pos, primaryEditStartPosition), primaryEditEndPosition);\n        const textAfterSecondaryCursor = textModel.getValueInRange(Range.fromPositions(pos, posEnd));\n        const l = commonPrefixLength(replacedTextAfterPrimaryCursor, textAfterSecondaryCursor);\n        const range = Range.fromPositions(pos, pos.delta(0, l));\n        return new SingleTextEdit(range, secondaryEditText);\n    });\n}\nfunction substringPos(text, pos) {\n    let subtext = '';\n    const lines = splitLinesIncludeSeparators(text);\n    for (let i = pos.lineNumber - 1; i < lines.length; i++) {\n        subtext += lines[i].substring(i === pos.lineNumber - 1 ? pos.column - 1 : 0);\n    }\n    return subtext;\n}\nfunction getEndPositionsAfterApplying(edits) {\n    const sortPerm = Permutation.createSortPermutation(edits, (edit1, edit2) => Range.compareRangesUsingStarts(edit1.range, edit2.range));\n    const sortedNewRanges = getNewRanges(sortPerm.apply(edits));\n    const newRanges = sortPerm.inverse().apply(sortedNewRanges);\n    return newRanges.map(range => range.getEndPosition());\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { matchesSubString } from '../../../../base/common/filters.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { derived, disposableObservableValue, transaction } from '../../../../base/common/observable.js';\nimport { Position } from '../../../common/core/position.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { provideInlineCompletions } from './provideInlineCompletions.js';\nimport { SingleTextEdit } from './singleTextEdit.js';\nlet InlineCompletionsSource = class InlineCompletionsSource extends Disposable {\n    constructor(textModel, versionId, _debounceValue, languageFeaturesService, languageConfigurationService) {\n        super();\n        this.textModel = textModel;\n        this.versionId = versionId;\n        this._debounceValue = _debounceValue;\n        this.languageFeaturesService = languageFeaturesService;\n        this.languageConfigurationService = languageConfigurationService;\n        this._updateOperation = this._register(new MutableDisposable());\n        this.inlineCompletions = disposableObservableValue('inlineCompletions', undefined);\n        this.suggestWidgetInlineCompletions = disposableObservableValue('suggestWidgetInlineCompletions', undefined);\n        this._register(this.textModel.onDidChangeContent(() => {\n            this._updateOperation.clear();\n        }));\n    }\n    fetch(position, context, activeInlineCompletion) {\n        var _a, _b;\n        const request = new UpdateRequest(position, context, this.textModel.getVersionId());\n        const target = context.selectedSuggestionInfo ? this.suggestWidgetInlineCompletions : this.inlineCompletions;\n        if ((_a = this._updateOperation.value) === null || _a === void 0 ? void 0 : _a.request.satisfies(request)) {\n            return this._updateOperation.value.promise;\n        }\n        else if ((_b = target.get()) === null || _b === void 0 ? void 0 : _b.request.satisfies(request)) {\n            return Promise.resolve(true);\n        }\n        const updateOngoing = !!this._updateOperation.value;\n        this._updateOperation.clear();\n        const source = new CancellationTokenSource();\n        const promise = (async () => {\n            const shouldDebounce = updateOngoing || context.triggerKind === InlineCompletionTriggerKind.Automatic;\n            if (shouldDebounce) {\n                // This debounces the operation\n                await wait(this._debounceValue.get(this.textModel), source.token);\n            }\n            if (source.token.isCancellationRequested || this.textModel.getVersionId() !== request.versionId) {\n                return false;\n            }\n            const startTime = new Date();\n            const updatedCompletions = await provideInlineCompletions(this.languageFeaturesService.inlineCompletionsProvider, position, this.textModel, context, source.token, this.languageConfigurationService);\n            if (source.token.isCancellationRequested || this.textModel.getVersionId() !== request.versionId) {\n                return false;\n            }\n            const endTime = new Date();\n            this._debounceValue.update(this.textModel, endTime.getTime() - startTime.getTime());\n            const completions = new UpToDateInlineCompletions(updatedCompletions, request, this.textModel, this.versionId);\n            if (activeInlineCompletion) {\n                const asInlineCompletion = activeInlineCompletion.toInlineCompletion(undefined);\n                if (activeInlineCompletion.canBeReused(this.textModel, position) && !updatedCompletions.has(asInlineCompletion)) {\n                    completions.prepend(activeInlineCompletion.inlineCompletion, asInlineCompletion.range, true);\n                }\n            }\n            this._updateOperation.clear();\n            transaction(tx => {\n                /** @description Update completions with provider result */\n                target.set(completions, tx);\n            });\n            return true;\n        })();\n        const updateOperation = new UpdateOperation(request, source, promise);\n        this._updateOperation.value = updateOperation;\n        return promise;\n    }\n    clear(tx) {\n        this._updateOperation.clear();\n        this.inlineCompletions.set(undefined, tx);\n        this.suggestWidgetInlineCompletions.set(undefined, tx);\n    }\n    clearSuggestWidgetInlineCompletions(tx) {\n        var _a;\n        if ((_a = this._updateOperation.value) === null || _a === void 0 ? void 0 : _a.request.context.selectedSuggestionInfo) {\n            this._updateOperation.clear();\n        }\n        this.suggestWidgetInlineCompletions.set(undefined, tx);\n    }\n    cancelUpdate() {\n        this._updateOperation.clear();\n    }\n};\nInlineCompletionsSource = __decorate([\n    __param(3, ILanguageFeaturesService),\n    __param(4, ILanguageConfigurationService)\n], InlineCompletionsSource);\nexport { InlineCompletionsSource };\nfunction wait(ms, cancellationToken) {\n    return new Promise(resolve => {\n        let d = undefined;\n        const handle = setTimeout(() => {\n            if (d) {\n                d.dispose();\n            }\n            resolve();\n        }, ms);\n        if (cancellationToken) {\n            d = cancellationToken.onCancellationRequested(() => {\n                clearTimeout(handle);\n                if (d) {\n                    d.dispose();\n                }\n                resolve();\n            });\n        }\n    });\n}\nclass UpdateRequest {\n    constructor(position, context, versionId) {\n        this.position = position;\n        this.context = context;\n        this.versionId = versionId;\n    }\n    satisfies(other) {\n        return this.position.equals(other.position)\n            && equals(this.context.selectedSuggestionInfo, other.context.selectedSuggestionInfo, (v1, v2) => v1.equals(v2))\n            && (other.context.triggerKind === InlineCompletionTriggerKind.Automatic\n                || this.context.triggerKind === InlineCompletionTriggerKind.Explicit)\n            && this.versionId === other.versionId;\n    }\n}\nfunction equals(v1, v2, equals) {\n    if (!v1 || !v2) {\n        return v1 === v2;\n    }\n    return equals(v1, v2);\n}\nclass UpdateOperation {\n    constructor(request, cancellationTokenSource, promise) {\n        this.request = request;\n        this.cancellationTokenSource = cancellationTokenSource;\n        this.promise = promise;\n    }\n    dispose() {\n        this.cancellationTokenSource.cancel();\n    }\n}\nexport class UpToDateInlineCompletions {\n    get inlineCompletions() { return this._inlineCompletions; }\n    constructor(inlineCompletionProviderResult, request, textModel, versionId) {\n        this.inlineCompletionProviderResult = inlineCompletionProviderResult;\n        this.request = request;\n        this.textModel = textModel;\n        this.versionId = versionId;\n        this._refCount = 1;\n        this._prependedInlineCompletionItems = [];\n        this._rangeVersionIdValue = 0;\n        this._rangeVersionId = derived(this, reader => {\n            this.versionId.read(reader);\n            let changed = false;\n            for (const i of this._inlineCompletions) {\n                changed = changed || i._updateRange(this.textModel);\n            }\n            if (changed) {\n                this._rangeVersionIdValue++;\n            }\n            return this._rangeVersionIdValue;\n        });\n        const ids = textModel.deltaDecorations([], inlineCompletionProviderResult.completions.map(i => ({\n            range: i.range,\n            options: {\n                description: 'inline-completion-tracking-range'\n            },\n        })));\n        this._inlineCompletions = inlineCompletionProviderResult.completions.map((i, index) => new InlineCompletionWithUpdatedRange(i, ids[index], this._rangeVersionId));\n    }\n    clone() {\n        this._refCount++;\n        return this;\n    }\n    dispose() {\n        this._refCount--;\n        if (this._refCount === 0) {\n            setTimeout(() => {\n                // To fix https://github.com/microsoft/vscode/issues/188348\n                if (!this.textModel.isDisposed()) {\n                    // This is just cleanup. It's ok if it happens with a delay.\n                    this.textModel.deltaDecorations(this._inlineCompletions.map(i => i.decorationId), []);\n                }\n            }, 0);\n            this.inlineCompletionProviderResult.dispose();\n            for (const i of this._prependedInlineCompletionItems) {\n                i.source.removeRef();\n            }\n        }\n    }\n    prepend(inlineCompletion, range, addRefToSource) {\n        if (addRefToSource) {\n            inlineCompletion.source.addRef();\n        }\n        const id = this.textModel.deltaDecorations([], [{\n                range,\n                options: {\n                    description: 'inline-completion-tracking-range'\n                },\n            }])[0];\n        this._inlineCompletions.unshift(new InlineCompletionWithUpdatedRange(inlineCompletion, id, this._rangeVersionId, range));\n        this._prependedInlineCompletionItems.push(inlineCompletion);\n    }\n}\nexport class InlineCompletionWithUpdatedRange {\n    get forwardStable() {\n        var _a;\n        return (_a = this.inlineCompletion.source.inlineCompletions.enableForwardStability) !== null && _a !== void 0 ? _a : false;\n    }\n    constructor(inlineCompletion, decorationId, rangeVersion, initialRange) {\n        this.inlineCompletion = inlineCompletion;\n        this.decorationId = decorationId;\n        this.rangeVersion = rangeVersion;\n        this.semanticId = JSON.stringify([\n            this.inlineCompletion.filterText,\n            this.inlineCompletion.insertText,\n            this.inlineCompletion.range.getStartPosition().toString()\n        ]);\n        this._isValid = true;\n        this._updatedRange = initialRange !== null && initialRange !== void 0 ? initialRange : inlineCompletion.range;\n    }\n    toInlineCompletion(reader) {\n        return this.inlineCompletion.withRange(this._getUpdatedRange(reader));\n    }\n    toSingleTextEdit(reader) {\n        return new SingleTextEdit(this._getUpdatedRange(reader), this.inlineCompletion.insertText);\n    }\n    isVisible(model, cursorPosition, reader) {\n        const minimizedReplacement = this._toFilterTextReplacement(reader).removeCommonPrefix(model);\n        if (!this._isValid\n            || !this.inlineCompletion.range.getStartPosition().equals(this._getUpdatedRange(reader).getStartPosition())\n            || cursorPosition.lineNumber !== minimizedReplacement.range.startLineNumber) {\n            return false;\n        }\n        // We might consider comparing by .toLowerText, but this requires GhostTextReplacement\n        const originalValue = model.getValueInRange(minimizedReplacement.range, 1 /* EndOfLinePreference.LF */);\n        const filterText = minimizedReplacement.text;\n        const cursorPosIndex = Math.max(0, cursorPosition.column - minimizedReplacement.range.startColumn);\n        let filterTextBefore = filterText.substring(0, cursorPosIndex);\n        let filterTextAfter = filterText.substring(cursorPosIndex);\n        let originalValueBefore = originalValue.substring(0, cursorPosIndex);\n        let originalValueAfter = originalValue.substring(cursorPosIndex);\n        const originalValueIndent = model.getLineIndentColumn(minimizedReplacement.range.startLineNumber);\n        if (minimizedReplacement.range.startColumn <= originalValueIndent) {\n            // Remove indentation\n            originalValueBefore = originalValueBefore.trimStart();\n            if (originalValueBefore.length === 0) {\n                originalValueAfter = originalValueAfter.trimStart();\n            }\n            filterTextBefore = filterTextBefore.trimStart();\n            if (filterTextBefore.length === 0) {\n                filterTextAfter = filterTextAfter.trimStart();\n            }\n        }\n        return filterTextBefore.startsWith(originalValueBefore)\n            && !!matchesSubString(originalValueAfter, filterTextAfter);\n    }\n    canBeReused(model, position) {\n        const result = this._isValid\n            && this._getUpdatedRange(undefined).containsPosition(position)\n            && this.isVisible(model, position, undefined)\n            && !this._isSmallerThanOriginal(undefined);\n        return result;\n    }\n    _toFilterTextReplacement(reader) {\n        return new SingleTextEdit(this._getUpdatedRange(reader), this.inlineCompletion.filterText);\n    }\n    _isSmallerThanOriginal(reader) {\n        return length(this._getUpdatedRange(reader)).isBefore(length(this.inlineCompletion.range));\n    }\n    _getUpdatedRange(reader) {\n        this.rangeVersion.read(reader); // This makes sure all the ranges are updated.\n        return this._updatedRange;\n    }\n    _updateRange(textModel) {\n        const range = textModel.getDecorationRange(this.decorationId);\n        if (!range) {\n            // A setValue call might flush all decorations.\n            this._isValid = false;\n            return true;\n        }\n        if (!this._updatedRange.equalsRange(range)) {\n            this._updatedRange = range;\n            return true;\n        }\n        return false;\n    }\n}\nfunction length(range) {\n    if (range.startLineNumber === range.endLineNumber) {\n        return new Position(1, 1 + range.endColumn - range.startColumn);\n    }\n    else {\n        return new Position(1 + range.endLineNumber - range.startLineNumber, range.endColumn);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { assertNever } from '../../../../base/common/assert.js';\nimport { DeferredPromise } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { SetMap } from '../../../../base/common/map.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Range } from '../../../common/core/range.js';\nimport { fixBracketsInLine } from '../../../common/model/bracketPairsTextModelPart/fixBrackets.js';\nimport { getReadonlyEmptyArray } from './utils.js';\nimport { SnippetParser, Text } from '../../snippet/browser/snippetParser.js';\nexport async function provideInlineCompletions(registry, position, model, context, token = CancellationToken.None, languageConfigurationService) {\n    // Important: Don't use position after the await calls, as the model could have been changed in the meantime!\n    const defaultReplaceRange = getDefaultRange(position, model);\n    const providers = registry.all(model);\n    const multiMap = new SetMap();\n    for (const provider of providers) {\n        if (provider.groupId) {\n            multiMap.add(provider.groupId, provider);\n        }\n    }\n    function getPreferredProviders(provider) {\n        if (!provider.yieldsToGroupIds) {\n            return [];\n        }\n        const result = [];\n        for (const groupId of provider.yieldsToGroupIds || []) {\n            const providers = multiMap.get(groupId);\n            for (const p of providers) {\n                result.push(p);\n            }\n        }\n        return result;\n    }\n    const states = new Map();\n    const seen = new Set();\n    function findPreferredProviderCircle(provider, stack) {\n        stack = [...stack, provider];\n        if (seen.has(provider)) {\n            return stack;\n        }\n        seen.add(provider);\n        try {\n            const preferred = getPreferredProviders(provider);\n            for (const p of preferred) {\n                const c = findPreferredProviderCircle(p, stack);\n                if (c) {\n                    return c;\n                }\n            }\n        }\n        finally {\n            seen.delete(provider);\n        }\n        return undefined;\n    }\n    function processProvider(provider) {\n        const state = states.get(provider);\n        if (state) {\n            return state;\n        }\n        const circle = findPreferredProviderCircle(provider, []);\n        if (circle) {\n            onUnexpectedExternalError(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${circle.map(s => s.toString ? s.toString() : ('' + s)).join(' -> ')}`));\n        }\n        const deferredPromise = new DeferredPromise();\n        states.set(provider, deferredPromise.p);\n        (async () => {\n            if (!circle) {\n                const preferred = getPreferredProviders(provider);\n                for (const p of preferred) {\n                    const result = await processProvider(p);\n                    if (result && result.items.length > 0) {\n                        // Skip provider\n                        return undefined;\n                    }\n                }\n            }\n            try {\n                const completions = await provider.provideInlineCompletions(model, position, context, token);\n                return completions;\n            }\n            catch (e) {\n                onUnexpectedExternalError(e);\n                return undefined;\n            }\n        })().then(c => deferredPromise.complete(c), e => deferredPromise.error(e));\n        return deferredPromise.p;\n    }\n    const providerResults = await Promise.all(providers.map(async (provider) => ({ provider, completions: await processProvider(provider) })));\n    const itemsByHash = new Map();\n    const lists = [];\n    for (const result of providerResults) {\n        const completions = result.completions;\n        if (!completions) {\n            continue;\n        }\n        const list = new InlineCompletionList(completions, result.provider);\n        lists.push(list);\n        for (const item of completions.items) {\n            const inlineCompletionItem = InlineCompletionItem.from(item, list, defaultReplaceRange, model, languageConfigurationService);\n            itemsByHash.set(inlineCompletionItem.hash(), inlineCompletionItem);\n        }\n    }\n    return new InlineCompletionProviderResult(Array.from(itemsByHash.values()), new Set(itemsByHash.keys()), lists);\n}\nexport class InlineCompletionProviderResult {\n    constructor(\n    /**\n     * Free of duplicates.\n     */\n    completions, hashs, providerResults) {\n        this.completions = completions;\n        this.hashs = hashs;\n        this.providerResults = providerResults;\n    }\n    has(item) {\n        return this.hashs.has(item.hash());\n    }\n    dispose() {\n        for (const result of this.providerResults) {\n            result.removeRef();\n        }\n    }\n}\n/**\n * A ref counted pointer to the computed `InlineCompletions` and the `InlineCompletionsProvider` that\n * computed them.\n */\nexport class InlineCompletionList {\n    constructor(inlineCompletions, provider) {\n        this.inlineCompletions = inlineCompletions;\n        this.provider = provider;\n        this.refCount = 1;\n    }\n    addRef() {\n        this.refCount++;\n    }\n    removeRef() {\n        this.refCount--;\n        if (this.refCount === 0) {\n            this.provider.freeInlineCompletions(this.inlineCompletions);\n        }\n    }\n}\nexport class InlineCompletionItem {\n    static from(inlineCompletion, source, defaultReplaceRange, textModel, languageConfigurationService) {\n        let insertText;\n        let snippetInfo;\n        let range = inlineCompletion.range ? Range.lift(inlineCompletion.range) : defaultReplaceRange;\n        if (typeof inlineCompletion.insertText === 'string') {\n            insertText = inlineCompletion.insertText;\n            if (languageConfigurationService && inlineCompletion.completeBracketPairs) {\n                insertText = closeBrackets(insertText, range.getStartPosition(), textModel, languageConfigurationService);\n                // Modify range depending on if brackets are added or removed\n                const diff = insertText.length - inlineCompletion.insertText.length;\n                if (diff !== 0) {\n                    range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn + diff);\n                }\n            }\n            snippetInfo = undefined;\n        }\n        else if ('snippet' in inlineCompletion.insertText) {\n            const preBracketCompletionLength = inlineCompletion.insertText.snippet.length;\n            if (languageConfigurationService && inlineCompletion.completeBracketPairs) {\n                inlineCompletion.insertText.snippet = closeBrackets(inlineCompletion.insertText.snippet, range.getStartPosition(), textModel, languageConfigurationService);\n                // Modify range depending on if brackets are added or removed\n                const diff = inlineCompletion.insertText.snippet.length - preBracketCompletionLength;\n                if (diff !== 0) {\n                    range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn + diff);\n                }\n            }\n            const snippet = new SnippetParser().parse(inlineCompletion.insertText.snippet);\n            if (snippet.children.length === 1 && snippet.children[0] instanceof Text) {\n                insertText = snippet.children[0].value;\n                snippetInfo = undefined;\n            }\n            else {\n                insertText = snippet.toString();\n                snippetInfo = {\n                    snippet: inlineCompletion.insertText.snippet,\n                    range: range\n                };\n            }\n        }\n        else {\n            assertNever(inlineCompletion.insertText);\n        }\n        return new InlineCompletionItem(insertText, inlineCompletion.command, range, insertText, snippetInfo, inlineCompletion.additionalTextEdits || getReadonlyEmptyArray(), inlineCompletion, source);\n    }\n    constructor(filterText, command, range, insertText, snippetInfo, additionalTextEdits, \n    /**\n     * A reference to the original inline completion this inline completion has been constructed from.\n     * Used for event data to ensure referential equality.\n    */\n    sourceInlineCompletion, \n    /**\n     * A reference to the original inline completion list this inline completion has been constructed from.\n     * Used for event data to ensure referential equality.\n    */\n    source) {\n        this.filterText = filterText;\n        this.command = command;\n        this.range = range;\n        this.insertText = insertText;\n        this.snippetInfo = snippetInfo;\n        this.additionalTextEdits = additionalTextEdits;\n        this.sourceInlineCompletion = sourceInlineCompletion;\n        this.source = source;\n        filterText = filterText.replace(/\\r\\n|\\r/g, '\\n');\n        insertText = filterText.replace(/\\r\\n|\\r/g, '\\n');\n    }\n    withRange(updatedRange) {\n        return new InlineCompletionItem(this.filterText, this.command, updatedRange, this.insertText, this.snippetInfo, this.additionalTextEdits, this.sourceInlineCompletion, this.source);\n    }\n    hash() {\n        return JSON.stringify({ insertText: this.insertText, range: this.range.toString() });\n    }\n}\nfunction getDefaultRange(position, model) {\n    const word = model.getWordAtPosition(position);\n    const maxColumn = model.getLineMaxColumn(position.lineNumber);\n    // By default, always replace up until the end of the current line.\n    // This default might be subject to change!\n    return word\n        ? new Range(position.lineNumber, word.startColumn, position.lineNumber, maxColumn)\n        : Range.fromPositions(position, position.with(undefined, maxColumn));\n}\nfunction closeBrackets(text, position, model, languageConfigurationService) {\n    const lineStart = model.getLineContent(position.lineNumber).substring(0, position.column - 1);\n    const newLine = lineStart + text;\n    const newTokens = model.tokenization.tokenizeLineWithEdit(position, newLine.length - (position.column - 1), text);\n    const slicedTokens = newTokens === null || newTokens === void 0 ? void 0 : newTokens.sliceAndInflate(position.column - 1, newLine.length, 0);\n    if (!slicedTokens) {\n        return text;\n    }\n    const newText = fixBracketsInLine(slicedTokens, languageConfigurationService);\n    return newText;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LanguageAgnosticBracketTokens } from './bracketPairsTree/brackets.js';\nimport { lengthAdd, lengthGetColumnCountIfZeroLineCount, lengthZero } from './bracketPairsTree/length.js';\nimport { parseDocument } from './bracketPairsTree/parser.js';\nimport { DenseKeyProvider } from './bracketPairsTree/smallImmutableSet.js';\nimport { TextBufferTokenizer } from './bracketPairsTree/tokenizer.js';\nexport function fixBracketsInLine(tokens, languageConfigurationService) {\n    const denseKeyProvider = new DenseKeyProvider();\n    const bracketTokens = new LanguageAgnosticBracketTokens(denseKeyProvider, (languageId) => languageConfigurationService.getLanguageConfiguration(languageId));\n    const tokenizer = new TextBufferTokenizer(new StaticTokenizerSource([tokens]), bracketTokens);\n    const node = parseDocument(tokenizer, [], undefined, true);\n    let str = '';\n    const line = tokens.getLineContent();\n    function processNode(node, offset) {\n        if (node.kind === 2 /* AstNodeKind.Pair */) {\n            processNode(node.openingBracket, offset);\n            offset = lengthAdd(offset, node.openingBracket.length);\n            if (node.child) {\n                processNode(node.child, offset);\n                offset = lengthAdd(offset, node.child.length);\n            }\n            if (node.closingBracket) {\n                processNode(node.closingBracket, offset);\n                offset = lengthAdd(offset, node.closingBracket.length);\n            }\n            else {\n                const singleLangBracketTokens = bracketTokens.getSingleLanguageBracketTokens(node.openingBracket.languageId);\n                const closingTokenText = singleLangBracketTokens.findClosingTokenText(node.openingBracket.bracketIds);\n                str += closingTokenText;\n            }\n        }\n        else if (node.kind === 3 /* AstNodeKind.UnexpectedClosingBracket */) {\n            // remove the bracket\n        }\n        else if (node.kind === 0 /* AstNodeKind.Text */ || node.kind === 1 /* AstNodeKind.Bracket */) {\n            str += line.substring(lengthGetColumnCountIfZeroLineCount(offset), lengthGetColumnCountIfZeroLineCount(lengthAdd(offset, node.length)));\n        }\n        else if (node.kind === 4 /* AstNodeKind.List */) {\n            for (const child of node.children) {\n                processNode(child, offset);\n                offset = lengthAdd(offset, child.length);\n            }\n        }\n    }\n    processNode(node, lengthZero);\n    return str;\n}\nclass StaticTokenizerSource {\n    constructor(lines) {\n        this.lines = lines;\n        this.tokenization = {\n            getLineTokens: (lineNumber) => {\n                return this.lines[lineNumber - 1];\n            }\n        };\n    }\n    getLineCount() {\n        return this.lines.length;\n    }\n    getLineLength(lineNumber) {\n        return this.lines[lineNumber - 1].getLineContent().length;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LcsDiff } from '../../../../base/common/diff/diff.js';\nimport { commonPrefixLength, getLeadingWhitespace } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { GhostText, GhostTextPart } from './ghostText.js';\nimport { addPositions, lengthOfText } from './utils.js';\nexport class SingleTextEdit {\n    constructor(range, text) {\n        this.range = range;\n        this.text = text;\n    }\n    removeCommonPrefix(model, validModelRange) {\n        const modelRange = validModelRange ? this.range.intersectRanges(validModelRange) : this.range;\n        if (!modelRange) {\n            return this;\n        }\n        const valueToReplace = model.getValueInRange(modelRange, 1 /* EndOfLinePreference.LF */);\n        const commonPrefixLen = commonPrefixLength(valueToReplace, this.text);\n        const start = addPositions(this.range.getStartPosition(), lengthOfText(valueToReplace.substring(0, commonPrefixLen)));\n        const text = this.text.substring(commonPrefixLen);\n        const range = Range.fromPositions(start, this.range.getEndPosition());\n        return new SingleTextEdit(range, text);\n    }\n    augments(base) {\n        // The augmented completion must replace the base range, but can replace even more\n        return this.text.startsWith(base.text) && rangeExtends(this.range, base.range);\n    }\n    /**\n     * @param previewSuffixLength Sets where to split `inlineCompletion.text`.\n     * \tIf the text is `hello` and the suffix length is 2, the non-preview part is `hel` and the preview-part is `lo`.\n    */\n    computeGhostText(model, mode, cursorPosition, previewSuffixLength = 0) {\n        let edit = this.removeCommonPrefix(model);\n        if (edit.range.endLineNumber !== edit.range.startLineNumber) {\n            // This edit might span multiple lines, but the first lines must be a common prefix.\n            return undefined;\n        }\n        const sourceLine = model.getLineContent(edit.range.startLineNumber);\n        const sourceIndentationLength = getLeadingWhitespace(sourceLine).length;\n        const suggestionTouchesIndentation = edit.range.startColumn - 1 <= sourceIndentationLength;\n        if (suggestionTouchesIndentation) {\n            // source:      \u00B7\u00B7\u00B7\u00B7\u00B7\u00B7\u00B7\u00B7\u00B7\u00B7[\u00B7\u00B7\u00B7\u00B7\u00B7\u00B7abc]\n            //                         ^^^^^^^^^ inlineCompletion.range\n            //              ^^^^^^^^^^ ^^^^^^ sourceIndentationLength\n            //                         ^^^^^^ replacedIndentation.length\n            //                               ^^^ rangeThatDoesNotReplaceIndentation\n            // inlineCompletion.text: '\u00B7\u00B7foo'\n            //                         ^^ suggestionAddedIndentationLength\n            const suggestionAddedIndentationLength = getLeadingWhitespace(edit.text).length;\n            const replacedIndentation = sourceLine.substring(edit.range.startColumn - 1, sourceIndentationLength);\n            const [startPosition, endPosition] = [edit.range.getStartPosition(), edit.range.getEndPosition()];\n            const newStartPosition = startPosition.column + replacedIndentation.length <= endPosition.column\n                ? startPosition.delta(0, replacedIndentation.length)\n                : endPosition;\n            const rangeThatDoesNotReplaceIndentation = Range.fromPositions(newStartPosition, endPosition);\n            const suggestionWithoutIndentationChange = edit.text.startsWith(replacedIndentation)\n                // Adds more indentation without changing existing indentation: We can add ghost text for this\n                ? edit.text.substring(replacedIndentation.length)\n                // Changes or removes existing indentation. Only add ghost text for the non-indentation part.\n                : edit.text.substring(suggestionAddedIndentationLength);\n            edit = new SingleTextEdit(rangeThatDoesNotReplaceIndentation, suggestionWithoutIndentationChange);\n        }\n        // This is a single line string\n        const valueToBeReplaced = model.getValueInRange(edit.range);\n        const changes = cachingDiff(valueToBeReplaced, edit.text);\n        if (!changes) {\n            // No ghost text in case the diff would be too slow to compute\n            return undefined;\n        }\n        const lineNumber = edit.range.startLineNumber;\n        const parts = new Array();\n        if (mode === 'prefix') {\n            const filteredChanges = changes.filter(c => c.originalLength === 0);\n            if (filteredChanges.length > 1 || filteredChanges.length === 1 && filteredChanges[0].originalStart !== valueToBeReplaced.length) {\n                // Prefixes only have a single change.\n                return undefined;\n            }\n        }\n        const previewStartInCompletionText = edit.text.length - previewSuffixLength;\n        for (const c of changes) {\n            const insertColumn = edit.range.startColumn + c.originalStart + c.originalLength;\n            if (mode === 'subwordSmart' && cursorPosition && cursorPosition.lineNumber === edit.range.startLineNumber && insertColumn < cursorPosition.column) {\n                // No ghost text before cursor\n                return undefined;\n            }\n            if (c.originalLength > 0) {\n                return undefined;\n            }\n            if (c.modifiedLength === 0) {\n                continue;\n            }\n            const modifiedEnd = c.modifiedStart + c.modifiedLength;\n            const nonPreviewTextEnd = Math.max(c.modifiedStart, Math.min(modifiedEnd, previewStartInCompletionText));\n            const nonPreviewText = edit.text.substring(c.modifiedStart, nonPreviewTextEnd);\n            const italicText = edit.text.substring(nonPreviewTextEnd, Math.max(c.modifiedStart, modifiedEnd));\n            if (nonPreviewText.length > 0) {\n                parts.push(new GhostTextPart(insertColumn, nonPreviewText, false));\n            }\n            if (italicText.length > 0) {\n                parts.push(new GhostTextPart(insertColumn, italicText, true));\n            }\n        }\n        return new GhostText(lineNumber, parts);\n    }\n}\nfunction rangeExtends(extendingRange, rangeToExtend) {\n    return rangeToExtend.getStartPosition().equals(extendingRange.getStartPosition())\n        && rangeToExtend.getEndPosition().isBeforeOrEqual(extendingRange.getEndPosition());\n}\nlet lastRequest = undefined;\nfunction cachingDiff(originalValue, newValue) {\n    if ((lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.originalValue) === originalValue && (lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.newValue) === newValue) {\n        return lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.changes;\n    }\n    else {\n        let changes = smartDiff(originalValue, newValue, true);\n        if (changes) {\n            const deletedChars = deletedCharacters(changes);\n            if (deletedChars > 0) {\n                // For performance reasons, don't compute diff if there is nothing to improve\n                const newChanges = smartDiff(originalValue, newValue, false);\n                if (newChanges && deletedCharacters(newChanges) < deletedChars) {\n                    // Disabling smartness seems to be better here\n                    changes = newChanges;\n                }\n            }\n        }\n        lastRequest = {\n            originalValue,\n            newValue,\n            changes\n        };\n        return changes;\n    }\n}\nfunction deletedCharacters(changes) {\n    let sum = 0;\n    for (const c of changes) {\n        sum += c.originalLength;\n    }\n    return sum;\n}\n/**\n * When matching `if ()` with `if (f() = 1) { g(); }`,\n * align it like this:        `if (       )`\n * Not like this:\t\t\t  `if (  )`\n * Also not like this:\t\t  `if (             )`.\n *\n * The parenthesis are preprocessed to ensure that they match correctly.\n */\nfunction smartDiff(originalValue, newValue, smartBracketMatching) {\n    if (originalValue.length > 5000 || newValue.length > 5000) {\n        // We don't want to work on strings that are too big\n        return undefined;\n    }\n    function getMaxCharCode(val) {\n        let maxCharCode = 0;\n        for (let i = 0, len = val.length; i < len; i++) {\n            const charCode = val.charCodeAt(i);\n            if (charCode > maxCharCode) {\n                maxCharCode = charCode;\n            }\n        }\n        return maxCharCode;\n    }\n    const maxCharCode = Math.max(getMaxCharCode(originalValue), getMaxCharCode(newValue));\n    function getUniqueCharCode(id) {\n        if (id < 0) {\n            throw new Error('unexpected');\n        }\n        return maxCharCode + id + 1;\n    }\n    function getElements(source) {\n        let level = 0;\n        let group = 0;\n        const characters = new Int32Array(source.length);\n        for (let i = 0, len = source.length; i < len; i++) {\n            // TODO support more brackets\n            if (smartBracketMatching && source[i] === '(') {\n                const id = group * 100 + level;\n                characters[i] = getUniqueCharCode(2 * id);\n                level++;\n            }\n            else if (smartBracketMatching && source[i] === ')') {\n                level = Math.max(level - 1, 0);\n                const id = group * 100 + level;\n                characters[i] = getUniqueCharCode(2 * id + 1);\n                if (level === 0) {\n                    group++;\n                }\n            }\n            else {\n                characters[i] = source.charCodeAt(i);\n            }\n        }\n        return characters;\n    }\n    const elements1 = getElements(originalValue);\n    const elements2 = getElements(newValue);\n    return new LcsDiff({ getElements: () => elements1 }, { getElements: () => elements2 }).ComputeDiff(false).changes;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SnippetController2_1;\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { showSimpleSuggestions } from '../../suggest/browser/suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { SnippetSession } from './snippetSession.js';\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    undoStopBefore: true,\n    undoStopAfter: true,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetController2 = SnippetController2_1 = class SnippetController2 {\n    static get(editor) {\n        return editor.getContribution(SnippetController2_1.ID);\n    }\n    constructor(_editor, _logService, _languageFeaturesService, contextKeyService, _languageConfigurationService) {\n        this._editor = _editor;\n        this._logService = _logService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._snippetListener = new DisposableStore();\n        this._modelVersionId = -1;\n        this._inSnippet = SnippetController2_1.InSnippetMode.bindTo(contextKeyService);\n        this._hasNextTabstop = SnippetController2_1.HasNextTabstop.bindTo(contextKeyService);\n        this._hasPrevTabstop = SnippetController2_1.HasPrevTabstop.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._snippetListener.dispose();\n    }\n    insert(template, opts) {\n        // this is here to find out more about the yet-not-understood\n        // error that sometimes happens when we fail to inserted a nested\n        // snippet\n        try {\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : { ..._defaultOptions, ...opts });\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_template=', template);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    _doInsert(template, opts) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // don't listen while inserting the snippet\n        // as that is the inflight state causing cancelation\n        this._snippetListener.clear();\n        if (opts.undoStopBefore) {\n            this._editor.getModel().pushStackElement();\n        }\n        // don't merge\n        if (this._session && typeof template !== 'string') {\n            this.cancel();\n        }\n        if (!this._session) {\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\n            this._session = new SnippetSession(this._editor, template, opts, this._languageConfigurationService);\n            this._session.insert();\n        }\n        else {\n            assertType(typeof template === 'string');\n            this._session.merge(template, opts);\n        }\n        if (opts.undoStopAfter) {\n            this._editor.getModel().pushStackElement();\n        }\n        // regster completion item provider when there is any choice element\n        if ((_a = this._session) === null || _a === void 0 ? void 0 : _a.hasChoice) {\n            const provider = {\n                _debugDisplayName: 'snippetChoiceCompletions',\n                provideCompletionItems: (model, position) => {\n                    if (!this._session || model !== this._editor.getModel() || !Position.equals(this._editor.getPosition(), position)) {\n                        return undefined;\n                    }\n                    const { activeChoice } = this._session;\n                    if (!activeChoice || activeChoice.choice.options.length === 0) {\n                        return undefined;\n                    }\n                    const word = model.getValueInRange(activeChoice.range);\n                    const isAnyOfOptions = Boolean(activeChoice.choice.options.find(o => o.value === word));\n                    const suggestions = [];\n                    for (let i = 0; i < activeChoice.choice.options.length; i++) {\n                        const option = activeChoice.choice.options[i];\n                        suggestions.push({\n                            kind: 13 /* CompletionItemKind.Value */,\n                            label: option.value,\n                            insertText: option.value,\n                            sortText: 'a'.repeat(i + 1),\n                            range: activeChoice.range,\n                            filterText: isAnyOfOptions ? `${word}_${option.value}` : undefined,\n                            command: { id: 'jumpToNextSnippetPlaceholder', title: localize('next', 'Go to next placeholder...') }\n                        });\n                    }\n                    return { suggestions };\n                }\n            };\n            const model = this._editor.getModel();\n            let registration;\n            let isRegistered = false;\n            const disable = () => {\n                registration === null || registration === void 0 ? void 0 : registration.dispose();\n                isRegistered = false;\n            };\n            const enable = () => {\n                if (!isRegistered) {\n                    registration = this._languageFeaturesService.completionProvider.register({\n                        language: model.getLanguageId(),\n                        pattern: model.uri.fsPath,\n                        scheme: model.uri.scheme,\n                        exclusive: true\n                    }, provider);\n                    this._snippetListener.add(registration);\n                    isRegistered = true;\n                }\n            };\n            this._choiceCompletions = { provider, enable, disable };\n        }\n        this._updateState();\n        this._snippetListener.add(this._editor.onDidChangeModelContent(e => e.isFlush && this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeModel(() => this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(() => this._updateState()));\n    }\n    _updateState() {\n        if (!this._session || !this._editor.hasModel()) {\n            // canceled in the meanwhile\n            return;\n        }\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\n            // undo until the 'before' state happened\n            // and makes use cancel snippet mode\n            return this.cancel();\n        }\n        if (!this._session.hasPlaceholder) {\n            // don't listen for selection changes and don't\n            // update context keys when the snippet is plain text\n            return this.cancel();\n        }\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\n            this._editor.getModel().pushStackElement();\n            return this.cancel();\n        }\n        this._inSnippet.set(true);\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\n        this._handleChoice();\n    }\n    _handleChoice() {\n        var _a;\n        if (!this._session || !this._editor.hasModel()) {\n            this._currentChoice = undefined;\n            return;\n        }\n        const { activeChoice } = this._session;\n        if (!activeChoice || !this._choiceCompletions) {\n            (_a = this._choiceCompletions) === null || _a === void 0 ? void 0 : _a.disable();\n            this._currentChoice = undefined;\n            return;\n        }\n        if (this._currentChoice !== activeChoice.choice) {\n            this._currentChoice = activeChoice.choice;\n            this._choiceCompletions.enable();\n            // trigger suggest with the special choice completion provider\n            queueMicrotask(() => {\n                showSimpleSuggestions(this._editor, this._choiceCompletions.provider);\n            });\n        }\n    }\n    finish() {\n        while (this._inSnippet.get()) {\n            this.next();\n        }\n    }\n    cancel(resetSelection = false) {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        this._snippetListener.clear();\n        this._currentChoice = undefined;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._session = undefined;\n        this._modelVersionId = -1;\n        if (resetSelection) {\n            // reset selection to the primary cursor when being asked\n            // for. this happens when explicitly cancelling snippet mode,\n            // e.g. when pressing ESC\n            this._editor.setSelections([this._editor.getSelection()]);\n        }\n    }\n    prev() {\n        var _a;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.prev();\n        this._updateState();\n    }\n    next() {\n        var _a;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.next();\n        this._updateState();\n    }\n    isInSnippet() {\n        return Boolean(this._inSnippet.get());\n    }\n};\nSnippetController2.ID = 'snippetController2';\nSnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false, localize('inSnippetMode', \"Whether the editor in current in snippet mode\"));\nSnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false, localize('hasNextTabstop', \"Whether there is a next tab stop when in snippet mode\"));\nSnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false, localize('hasPrevTabstop', \"Whether there is a previous tab stop when in snippet mode\"));\nSnippetController2 = SnippetController2_1 = __decorate([\n    __param(1, ILogService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IContextKeyService),\n    __param(4, ILanguageConfigurationService)\n], SnippetController2);\nexport { SnippetController2 };\nregisterEditorContribution(SnippetController2.ID, SnippetController2, 4 /* EditorContributionInstantiation.Lazy */);\nconst CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToNextSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\n    handler: ctrl => ctrl.next(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToPrevSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\n    handler: ctrl => ctrl.prev(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'leaveSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.cancel(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'acceptSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.finish(),\n    // kbOpts: {\n    // \tweight: KeybindingWeight.EditorContrib + 30,\n    // \tkbExpr: EditorContextKeys.textFocus,\n    // \tprimary: KeyCode.Enter,\n    // }\n}));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancellationError, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { historyNavigationVisible } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nexport const Context = {\n    Visible: historyNavigationVisible,\n    HasFocusedSuggestion: new RawContextKey('suggestWidgetHasFocusedSuggestion', false, localize('suggestWidgetHasSelection', \"Whether any suggestion is focused\")),\n    DetailsVisible: new RawContextKey('suggestWidgetDetailsVisible', false, localize('suggestWidgetDetailsVisible', \"Whether suggestion details are visible\")),\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false, localize('suggestWidgetMultipleSuggestions', \"Whether there are multiple suggestions to pick from\")),\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true, localize('suggestionMakesTextEdit', \"Whether inserting the current suggestion yields in a change or has everything already been typed\")),\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true, localize('acceptSuggestionOnEnter', \"Whether suggestions are inserted when pressing Enter\")),\n    HasInsertAndReplaceRange: new RawContextKey('suggestionHasInsertAndReplaceRange', false, localize('suggestionHasInsertAndReplaceRange', \"Whether the current suggestion has insert and replace behaviour\")),\n    InsertMode: new RawContextKey('suggestionInsertMode', undefined, { type: 'string', description: localize('suggestionInsertMode', \"Whether the default behaviour is to insert or replace\") }),\n    CanResolve: new RawContextKey('suggestionCanResolve', false, localize('suggestionCanResolve', \"Whether the current suggestion supports to resolve further details\")),\n};\nexport const suggestWidgetStatusbarMenu = new MenuId('suggestWidgetStatusBar');\nexport class CompletionItem {\n    constructor(position, completion, container, provider) {\n        var _a;\n        this.position = position;\n        this.completion = completion;\n        this.container = container;\n        this.provider = provider;\n        // validation\n        this.isInvalid = false;\n        // sorting, filtering\n        this.score = FuzzyScore.Default;\n        this.distance = 0;\n        this.textLabel = typeof completion.label === 'string'\n            ? completion.label\n            : (_a = completion.label) === null || _a === void 0 ? void 0 : _a.label;\n        // ensure lower-variants (perf)\n        this.labelLow = this.textLabel.toLowerCase();\n        // validate label\n        this.isInvalid = !this.textLabel;\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\n        this.extensionId = completion.extensionId;\n        // normalize ranges\n        if (Range.isIRange(completion.range)) {\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            // validate range\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range) || completion.range.startLineNumber !== position.lineNumber;\n        }\n        else {\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\n            // validate ranges\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range.insert) || Range.spansMultipleLines(completion.range.replace)\n                || completion.range.insert.startLineNumber !== position.lineNumber || completion.range.replace.startLineNumber !== position.lineNumber\n                || completion.range.insert.startColumn !== completion.range.replace.startColumn;\n        }\n        // create the suggestion resolver\n        if (typeof provider.resolveCompletionItem !== 'function') {\n            this._resolveCache = Promise.resolve();\n            this._resolveDuration = 0;\n        }\n    }\n    // ---- resolving\n    get isResolved() {\n        return this._resolveDuration !== undefined;\n    }\n    get resolveDuration() {\n        return this._resolveDuration !== undefined ? this._resolveDuration : -1;\n    }\n    async resolve(token) {\n        if (!this._resolveCache) {\n            const sub = token.onCancellationRequested(() => {\n                this._resolveCache = undefined;\n                this._resolveDuration = undefined;\n            });\n            const sw = new StopWatch(true);\n            this._resolveCache = Promise.resolve(this.provider.resolveCompletionItem(this.completion, token)).then(value => {\n                Object.assign(this.completion, value);\n                this._resolveDuration = sw.elapsed();\n            }, err => {\n                if (isCancellationError(err)) {\n                    // the IPC queue will reject the request with the\n                    // cancellation error -> reset cached\n                    this._resolveCache = undefined;\n                    this._resolveDuration = undefined;\n                }\n            }).finally(() => {\n                sub.dispose();\n            });\n        }\n        return this._resolveCache;\n    }\n}\nexport class CompletionOptions {\n    constructor(snippetSortOrder = 2 /* SnippetSortOrder.Bottom */, kindFilter = new Set(), providerFilter = new Set(), providerItemsToReuse = new Map(), showDeprecated = true) {\n        this.snippetSortOrder = snippetSortOrder;\n        this.kindFilter = kindFilter;\n        this.providerFilter = providerFilter;\n        this.providerItemsToReuse = providerItemsToReuse;\n        this.showDeprecated = showDeprecated;\n    }\n}\nCompletionOptions.default = new CompletionOptions();\nlet _snippetSuggestSupport;\nexport function getSnippetSuggestSupport() {\n    return _snippetSuggestSupport;\n}\nexport class CompletionItemModel {\n    constructor(items, needsClipboard, durations, disposable) {\n        this.items = items;\n        this.needsClipboard = needsClipboard;\n        this.durations = durations;\n        this.disposable = disposable;\n    }\n}\nexport async function provideSuggestionItems(registry, model, position, options = CompletionOptions.default, context = { triggerKind: 0 /* languages.CompletionTriggerKind.Invoke */ }, token = CancellationToken.None) {\n    const sw = new StopWatch();\n    position = position.clone();\n    const word = model.getWordAtPosition(position);\n    const defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\n    const defaultRange = { replace: defaultReplaceRange, insert: defaultReplaceRange.setEndPosition(position.lineNumber, position.column) };\n    const result = [];\n    const disposables = new DisposableStore();\n    const durations = [];\n    let needsClipboard = false;\n    const onCompletionList = (provider, container, sw) => {\n        var _a, _b, _c;\n        let didAddResult = false;\n        if (!container) {\n            return didAddResult;\n        }\n        for (const suggestion of container.suggestions) {\n            if (!options.kindFilter.has(suggestion.kind)) {\n                // skip if not showing deprecated suggestions\n                if (!options.showDeprecated && ((_a = suggestion === null || suggestion === void 0 ? void 0 : suggestion.tags) === null || _a === void 0 ? void 0 : _a.includes(1 /* languages.CompletionItemTag.Deprecated */))) {\n                    continue;\n                }\n                // fill in default range when missing\n                if (!suggestion.range) {\n                    suggestion.range = defaultRange;\n                }\n                // fill in default sortText when missing\n                if (!suggestion.sortText) {\n                    suggestion.sortText = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.label;\n                }\n                if (!needsClipboard && suggestion.insertTextRules && suggestion.insertTextRules & 4 /* languages.CompletionItemInsertTextRule.InsertAsSnippet */) {\n                    needsClipboard = SnippetParser.guessNeedsClipboard(suggestion.insertText);\n                }\n                result.push(new CompletionItem(position, suggestion, container, provider));\n                didAddResult = true;\n            }\n        }\n        if (isDisposable(container)) {\n            disposables.add(container);\n        }\n        durations.push({\n            providerName: (_b = provider._debugDisplayName) !== null && _b !== void 0 ? _b : 'unknown_provider', elapsedProvider: (_c = container.duration) !== null && _c !== void 0 ? _c : -1, elapsedOverall: sw.elapsed()\n        });\n        return didAddResult;\n    };\n    // ask for snippets in parallel to asking \"real\" providers. Only do something if configured to\n    // do so - no snippet filter, no special-providers-only request\n    const snippetCompletions = (async () => {\n        if (!_snippetSuggestSupport || options.kindFilter.has(27 /* languages.CompletionItemKind.Snippet */)) {\n            return;\n        }\n        // we have items from a previous session that we can reuse\n        const reuseItems = options.providerItemsToReuse.get(_snippetSuggestSupport);\n        if (reuseItems) {\n            reuseItems.forEach(item => result.push(item));\n            return;\n        }\n        if (options.providerFilter.size > 0 && !options.providerFilter.has(_snippetSuggestSupport)) {\n            return;\n        }\n        const sw = new StopWatch();\n        const list = await _snippetSuggestSupport.provideCompletionItems(model, position, context, token);\n        onCompletionList(_snippetSuggestSupport, list, sw);\n    })();\n    // add suggestions from contributed providers - providers are ordered in groups of\n    // equal score and once a group produces a result the process stops\n    // get provider groups, always add snippet suggestion provider\n    for (const providerGroup of registry.orderedGroups(model)) {\n        // for each support in the group ask for suggestions\n        let didAddResult = false;\n        await Promise.all(providerGroup.map(async (provider) => {\n            // we have items from a previous session that we can reuse\n            if (options.providerItemsToReuse.has(provider)) {\n                const items = options.providerItemsToReuse.get(provider);\n                items.forEach(item => result.push(item));\n                didAddResult = didAddResult || items.length > 0;\n                return;\n            }\n            // check if this provider is filtered out\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\n                return;\n            }\n            try {\n                const sw = new StopWatch();\n                const list = await provider.provideCompletionItems(model, position, context, token);\n                didAddResult = onCompletionList(provider, list, sw) || didAddResult;\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n        }));\n        if (didAddResult || token.isCancellationRequested) {\n            break;\n        }\n    }\n    await snippetCompletions;\n    if (token.isCancellationRequested) {\n        disposables.dispose();\n        return Promise.reject(new CancellationError());\n    }\n    return new CompletionItemModel(result.sort(getSuggestionComparator(options.snippetSortOrder)), needsClipboard, { entries: durations, elapsed: sw.elapsed() }, disposables);\n}\nfunction defaultComparator(a, b) {\n    // check with 'sortText'\n    if (a.sortTextLow && b.sortTextLow) {\n        if (a.sortTextLow < b.sortTextLow) {\n            return -1;\n        }\n        else if (a.sortTextLow > b.sortTextLow) {\n            return 1;\n        }\n    }\n    // check with 'label'\n    if (a.textLabel < b.textLabel) {\n        return -1;\n    }\n    else if (a.textLabel > b.textLabel) {\n        return 1;\n    }\n    // check with 'type'\n    return a.completion.kind - b.completion.kind;\n}\nfunction snippetUpComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nfunction snippetDownComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nconst _snippetComparators = new Map();\n_snippetComparators.set(0 /* SnippetSortOrder.Top */, snippetUpComparator);\n_snippetComparators.set(2 /* SnippetSortOrder.Bottom */, snippetDownComparator);\n_snippetComparators.set(1 /* SnippetSortOrder.Inline */, defaultComparator);\nexport function getSuggestionComparator(snippetConfig) {\n    return _snippetComparators.get(snippetConfig);\n}\nCommandsRegistry.registerCommand('_executeCompletionItemProvider', async (accessor, ...args) => {\n    const [uri, position, triggerCharacter, maxItemsToResolve] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    assertType(typeof maxItemsToResolve === 'number' || !maxItemsToResolve);\n    const { completionProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = await accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = {\n            incomplete: false,\n            suggestions: []\n        };\n        const resolving = [];\n        const actualPosition = ref.object.textEditorModel.validatePosition(position);\n        const completions = await provideSuggestionItems(completionProvider, ref.object.textEditorModel, actualPosition, undefined, { triggerCharacter: triggerCharacter !== null && triggerCharacter !== void 0 ? triggerCharacter : undefined, triggerKind: triggerCharacter ? 1 /* languages.CompletionTriggerKind.TriggerCharacter */ : 0 /* languages.CompletionTriggerKind.Invoke */ });\n        for (const item of completions.items) {\n            if (resolving.length < (maxItemsToResolve !== null && maxItemsToResolve !== void 0 ? maxItemsToResolve : 0)) {\n                resolving.push(item.resolve(CancellationToken.None));\n            }\n            result.incomplete = result.incomplete || item.container.incomplete;\n            result.suggestions.push(item.completion);\n        }\n        try {\n            await Promise.all(resolving);\n            return result;\n        }\n        finally {\n            setTimeout(() => completions.disposable.dispose(), 100);\n        }\n    }\n    finally {\n        ref.dispose();\n    }\n});\nexport function showSimpleSuggestions(editor, provider) {\n    var _a;\n    (_a = editor.getContribution('editor.contrib.suggestController')) === null || _a === void 0 ? void 0 : _a.triggerSuggest(new Set().add(provider), undefined, true);\n}\nexport class QuickSuggestionsOptions {\n    static isAllOff(config) {\n        return config.other === 'off' && config.comments === 'off' && config.strings === 'off';\n    }\n    static isAllOn(config) {\n        return config.other === 'on' && config.comments === 'on' && config.strings === 'on';\n    }\n    static valueFor(config, tokenType) {\n        switch (tokenType) {\n            case 1 /* StandardTokenType.Comment */: return config.comments;\n            case 2 /* StandardTokenType.String */: return config.strings;\n            default: return config.other;\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SnippetSession_1;\nimport { groupBy } from '../../../../base/common/arrays.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace } from '../../../../base/common/strings.js';\nimport './snippetSession.css';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { Choice, Placeholder, SnippetParser, Text, TextmateSnippet } from './snippetParser.js';\nimport { ClipboardBasedVariableResolver, CommentBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, RandomBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, WorkspaceBasedVariableResolver } from './snippetVariables.js';\nexport class OneSnippet {\n    constructor(_editor, _snippet, _snippetLineLeadingWhitespace) {\n        this._editor = _editor;\n        this._snippet = _snippet;\n        this._snippetLineLeadingWhitespace = _snippetLineLeadingWhitespace;\n        this._offset = -1;\n        this._nestingLevel = 1;\n        this._placeholderGroups = groupBy(_snippet.placeholders, Placeholder.compareByIndex);\n        this._placeholderGroupsIdx = -1;\n    }\n    initialize(textChange) {\n        this._offset = textChange.newPosition;\n    }\n    dispose() {\n        if (this._placeholderDecorations) {\n            this._editor.removeDecorations([...this._placeholderDecorations.values()]);\n        }\n        this._placeholderGroups.length = 0;\n    }\n    _initDecorations() {\n        if (this._offset === -1) {\n            throw new Error(`Snippet not initialized!`);\n        }\n        if (this._placeholderDecorations) {\n            // already initialized\n            return;\n        }\n        this._placeholderDecorations = new Map();\n        const model = this._editor.getModel();\n        this._editor.changeDecorations(accessor => {\n            // create a decoration for each placeholder\n            for (const placeholder of this._snippet.placeholders) {\n                const placeholderOffset = this._snippet.offset(placeholder);\n                const placeholderLen = this._snippet.fullLen(placeholder);\n                const range = Range.fromPositions(model.getPositionAt(this._offset + placeholderOffset), model.getPositionAt(this._offset + placeholderOffset + placeholderLen));\n                const options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\n                const handle = accessor.addDecoration(range, options);\n                this._placeholderDecorations.set(placeholder, handle);\n            }\n        });\n    }\n    move(fwd) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this._initDecorations();\n        // Transform placeholder text if necessary\n        if (this._placeholderGroupsIdx >= 0) {\n            const operations = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                // Check if the placeholder has a transformation\n                if (placeholder.transform) {\n                    const id = this._placeholderDecorations.get(placeholder);\n                    const range = this._editor.getModel().getDecorationRange(id);\n                    const currentValue = this._editor.getModel().getValueInRange(range);\n                    const transformedValueLines = placeholder.transform.resolve(currentValue).split(/\\r\\n|\\r|\\n/);\n                    // fix indentation for transformed lines\n                    for (let i = 1; i < transformedValueLines.length; i++) {\n                        transformedValueLines[i] = this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace + transformedValueLines[i]);\n                    }\n                    operations.push(EditOperation.replace(range, transformedValueLines.join(this._editor.getModel().getEOL())));\n                }\n            }\n            if (operations.length > 0) {\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\n            }\n        }\n        let couldSkipThisPlaceholder = false;\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\n            this._placeholderGroupsIdx += 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\n            this._placeholderGroupsIdx -= 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else {\n            // the selection of the current placeholder might\n            // not acurate any more -> simply restore it\n        }\n        const newSelections = this._editor.getModel().changeDecorations(accessor => {\n            const activePlaceholders = new Set();\n            // change stickiness to always grow when typing at its edges\n            // because these decorations represent the currently active\n            // tabstop.\n            // Special case #1: reaching the final tabstop\n            // Special case #2: placeholders enclosing active placeholders\n            const selections = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\n                // consider to skip this placeholder index when the decoration\n                // range is empty but when the placeholder wasn't. that's a strong\n                // hint that the placeholder has been deleted. (all placeholder must match this)\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && this._hasPlaceholderBeenCollapsed(placeholder);\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                activePlaceholders.add(placeholder);\n                for (const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)) {\n                    const id = this._placeholderDecorations.get(enclosingPlaceholder);\n                    accessor.changeDecorationOptions(id, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                    activePlaceholders.add(enclosingPlaceholder);\n                }\n            }\n            // change stickness to never grow when typing at its edges\n            // so that in-active tabstops never grow\n            for (const [placeholder, id] of this._placeholderDecorations) {\n                if (!activePlaceholders.has(placeholder)) {\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\n                }\n            }\n            return selections;\n        });\n        return !couldSkipThisPlaceholder ? newSelections !== null && newSelections !== void 0 ? newSelections : [] : this.move(fwd);\n    }\n    _hasPlaceholderBeenCollapsed(placeholder) {\n        // A placeholder is empty when it wasn't empty when authored but\n        // when its tracking decoration is empty. This also applies to all\n        // potential parent placeholders\n        let marker = placeholder;\n        while (marker) {\n            if (marker instanceof Placeholder) {\n                const id = this._placeholderDecorations.get(marker);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (range.isEmpty() && marker.toString().length > 0) {\n                    return true;\n                }\n            }\n            marker = marker.parent;\n        }\n        return false;\n    }\n    get isAtFirstPlaceholder() {\n        return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\n    }\n    get isAtLastPlaceholder() {\n        return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\n    }\n    get hasPlaceholder() {\n        return this._snippet.placeholders.length > 0;\n    }\n    /**\n     * A snippet is trivial when it has no placeholder or only a final placeholder at\n     * its very end\n     */\n    get isTrivialSnippet() {\n        if (this._snippet.placeholders.length === 0) {\n            return true;\n        }\n        if (this._snippet.placeholders.length === 1) {\n            const [placeholder] = this._snippet.placeholders;\n            if (placeholder.isFinalTabstop) {\n                if (this._snippet.rightMostDescendant === placeholder) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    computePossibleSelections() {\n        const result = new Map();\n        for (const placeholdersWithEqualIndex of this._placeholderGroups) {\n            let ranges;\n            for (const placeholder of placeholdersWithEqualIndex) {\n                if (placeholder.isFinalTabstop) {\n                    // ignore those\n                    break;\n                }\n                if (!ranges) {\n                    ranges = [];\n                    result.set(placeholder.index, ranges);\n                }\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (!range) {\n                    // one of the placeholder lost its decoration and\n                    // therefore we bail out and pretend the placeholder\n                    // (with its mirrors) doesn't exist anymore.\n                    result.delete(placeholder.index);\n                    break;\n                }\n                ranges.push(range);\n            }\n        }\n        return result;\n    }\n    get activeChoice() {\n        if (!this._placeholderDecorations) {\n            return undefined;\n        }\n        const placeholder = this._placeholderGroups[this._placeholderGroupsIdx][0];\n        if (!(placeholder === null || placeholder === void 0 ? void 0 : placeholder.choice)) {\n            return undefined;\n        }\n        const id = this._placeholderDecorations.get(placeholder);\n        if (!id) {\n            return undefined;\n        }\n        const range = this._editor.getModel().getDecorationRange(id);\n        if (!range) {\n            return undefined;\n        }\n        return { range, choice: placeholder.choice };\n    }\n    get hasChoice() {\n        let result = false;\n        this._snippet.walk(marker => {\n            result = marker instanceof Choice;\n            return !result;\n        });\n        return result;\n    }\n    merge(others) {\n        const model = this._editor.getModel();\n        this._nestingLevel *= 10;\n        this._editor.changeDecorations(accessor => {\n            // For each active placeholder take one snippet and merge it\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\n            // everything is sorted by editor selection we can simply remove\n            // elements from the beginning of the array\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const nested = others.shift();\n                console.assert(nested._offset !== -1);\n                console.assert(!nested._placeholderDecorations);\n                // Massage placeholder-indicies of the nested snippet to be\n                // sorted right after the insertion point. This ensures we move\n                // through the placeholders in the correct order\n                const indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\n                for (const nestedPlaceholder of nested._snippet.placeholderInfo.all) {\n                    if (nestedPlaceholder.isFinalTabstop) {\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / this._nestingLevel);\n                    }\n                    else {\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / this._nestingLevel);\n                    }\n                }\n                this._snippet.replace(placeholder, nested._snippet.children);\n                // Remove the placeholder at which position are inserting\n                // the snippet and also remove its decoration.\n                const id = this._placeholderDecorations.get(placeholder);\n                accessor.removeDecoration(id);\n                this._placeholderDecorations.delete(placeholder);\n                // For each *new* placeholder we create decoration to monitor\n                // how and if it grows/shrinks.\n                for (const placeholder of nested._snippet.placeholders) {\n                    const placeholderOffset = nested._snippet.offset(placeholder);\n                    const placeholderLen = nested._snippet.fullLen(placeholder);\n                    const range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\n                    const handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\n                    this._placeholderDecorations.set(placeholder, handle);\n                }\n            }\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\n            this._placeholderGroups = groupBy(this._snippet.placeholders, Placeholder.compareByIndex);\n        });\n    }\n}\nOneSnippet._decor = {\n    active: ModelDecorationOptions.register({ description: 'snippet-placeholder-1', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    inactive: ModelDecorationOptions.register({ description: 'snippet-placeholder-2', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    activeFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-3', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n    inactiveFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-4', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n};\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetSession = SnippetSession_1 = class SnippetSession {\n    static adjustWhitespace(model, position, adjustIndentation, snippet, filter) {\n        const line = model.getLineContent(position.lineNumber);\n        const lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\n        // the snippet as inserted\n        let snippetTextString;\n        snippet.walk(marker => {\n            // all text elements that are not inside choice\n            if (!(marker instanceof Text) || marker.parent instanceof Choice) {\n                return true;\n            }\n            // check with filter (iff provided)\n            if (filter && !filter.has(marker)) {\n                return true;\n            }\n            const lines = marker.value.split(/\\r\\n|\\r|\\n/);\n            if (adjustIndentation) {\n                // adjust indentation of snippet test\n                // -the snippet-start doesn't get extra-indented (lineLeadingWhitespace), only normalized\n                // -all N+1 lines get extra-indented and normalized\n                // -the text start get extra-indented and normalized when following a linebreak\n                const offset = snippet.offset(marker);\n                if (offset === 0) {\n                    // snippet start\n                    lines[0] = model.normalizeIndentation(lines[0]);\n                }\n                else {\n                    // check if text start is after a linebreak\n                    snippetTextString = snippetTextString !== null && snippetTextString !== void 0 ? snippetTextString : snippet.toString();\n                    const prevChar = snippetTextString.charCodeAt(offset - 1);\n                    if (prevChar === 10 /* CharCode.LineFeed */ || prevChar === 13 /* CharCode.CarriageReturn */) {\n                        lines[0] = model.normalizeIndentation(lineLeadingWhitespace + lines[0]);\n                    }\n                }\n                for (let i = 1; i < lines.length; i++) {\n                    lines[i] = model.normalizeIndentation(lineLeadingWhitespace + lines[i]);\n                }\n            }\n            const newValue = lines.join(model.getEOL());\n            if (newValue !== marker.value) {\n                marker.parent.replace(marker, [new Text(newValue)]);\n                snippetTextString = undefined;\n            }\n            return true;\n        });\n        return lineLeadingWhitespace;\n    }\n    static adjustSelection(model, selection, overwriteBefore, overwriteAfter) {\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\n            // overwrite[Before|After] is compute using the position, not the whole\n            // selection. therefore we adjust the selection around that position\n            const { positionLineNumber, positionColumn } = selection;\n            const positionColumnBefore = positionColumn - overwriteBefore;\n            const positionColumnAfter = positionColumn + overwriteAfter;\n            const range = model.validateRange({\n                startLineNumber: positionLineNumber,\n                startColumn: positionColumnBefore,\n                endLineNumber: positionLineNumber,\n                endColumn: positionColumnAfter\n            });\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\n        }\n        return selection;\n    }\n    static createEditsAndSnippetsFromSelections(editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        const edits = [];\n        const snippets = [];\n        if (!editor.hasModel()) {\n            return { edits, snippets };\n        }\n        const model = editor.getModel();\n        const workspaceService = editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService));\n        const modelBasedVariableResolver = editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model));\n        const readClipboardText = () => clipboardText;\n        // know what text the overwrite[Before|After] extensions\n        // of the primary curser have selected because only when\n        // secondary selections extend to the same text we can grow them\n        const firstBeforeText = model.getValueInRange(SnippetSession_1.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\n        const firstAfterText = model.getValueInRange(SnippetSession_1.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\n        // remember the first non-whitespace column to decide if\n        // `keepWhitespace` should be overruled for secondary selections\n        const firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\n        // sort selections by their start position but remeber\n        // the original index. that allows you to create correct\n        // offset-based selection logic without changing the\n        // primary selection\n        const indexedSelections = editor.getSelections()\n            .map((selection, idx) => ({ selection, idx }))\n            .sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        for (const { selection, idx } of indexedSelections) {\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\n            // compare if this matches the extensions of the primary selection\n            let extensionBefore = SnippetSession_1.adjustSelection(model, selection, overwriteBefore, 0);\n            let extensionAfter = SnippetSession_1.adjustSelection(model, selection, 0, overwriteAfter);\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\n                extensionBefore = selection;\n            }\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\n                extensionAfter = selection;\n            }\n            // merge the before and after selection into one\n            const snippetSelection = selection\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\n            const snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\n            // adjust the template string to match the indentation and\n            // whitespace rules of this insert location (can be different for each cursor)\n            // happens when being asked for (default) or when this is a secondary\n            // cursor and the leading whitespace is different\n            const start = snippetSelection.getStartPosition();\n            const snippetLineLeadingWhitespace = SnippetSession_1.adjustWhitespace(model, start, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), snippet);\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\n                modelBasedVariableResolver,\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(79 /* EditorOption.multiCursorPaste */) === 'spread'),\n                new SelectionBasedVariableResolver(model, selection, idx, overtypingCapturer),\n                new CommentBasedVariableResolver(model, selection, languageConfigurationService),\n                new TimeBasedVariableResolver,\n                new WorkspaceBasedVariableResolver(workspaceService),\n                new RandomBasedVariableResolver,\n            ]));\n            // store snippets with the index of their originating selection.\n            // that ensures the primiary cursor stays primary despite not being\n            // the one with lowest start position\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\n            edits[idx].identifier = { major: idx, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edits[idx]._isTracked = true;\n            snippets[idx] = new OneSnippet(editor, snippet, snippetLineLeadingWhitespace);\n        }\n        return { edits, snippets };\n    }\n    static createEditsAndSnippetsFromEdits(editor, snippetEdits, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        if (!editor.hasModel() || snippetEdits.length === 0) {\n            return { edits: [], snippets: [] };\n        }\n        const edits = [];\n        const model = editor.getModel();\n        const parser = new SnippetParser();\n        const snippet = new TextmateSnippet();\n        // snippet variables resolver\n        const resolver = new CompositeSnippetVariableResolver([\n            editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model)),\n            new ClipboardBasedVariableResolver(() => clipboardText, 0, editor.getSelections().length, editor.getOption(79 /* EditorOption.multiCursorPaste */) === 'spread'),\n            new SelectionBasedVariableResolver(model, editor.getSelection(), 0, overtypingCapturer),\n            new CommentBasedVariableResolver(model, editor.getSelection(), languageConfigurationService),\n            new TimeBasedVariableResolver,\n            new WorkspaceBasedVariableResolver(editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService))),\n            new RandomBasedVariableResolver,\n        ]);\n        //\n        snippetEdits = snippetEdits.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        let offset = 0;\n        for (let i = 0; i < snippetEdits.length; i++) {\n            const { range, template } = snippetEdits[i];\n            // gaps between snippet edits are appended as text nodes. this\n            // ensures placeholder-offsets are later correct\n            if (i > 0) {\n                const lastRange = snippetEdits[i - 1].range;\n                const textRange = Range.fromPositions(lastRange.getEndPosition(), range.getStartPosition());\n                const textNode = new Text(model.getValueInRange(textRange));\n                snippet.appendChild(textNode);\n                offset += textNode.value.length;\n            }\n            const newNodes = parser.parseFragment(template, snippet);\n            SnippetSession_1.adjustWhitespace(model, range.getStartPosition(), true, snippet, new Set(newNodes));\n            snippet.resolveVariables(resolver);\n            const snippetText = snippet.toString();\n            const snippetFragmentText = snippetText.slice(offset);\n            offset = snippetText.length;\n            // make edit\n            const edit = EditOperation.replace(range, snippetFragmentText);\n            edit.identifier = { major: i, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edit._isTracked = true;\n            edits.push(edit);\n        }\n        //\n        parser.ensureFinalTabstop(snippet, enforceFinalTabstop, true);\n        return {\n            edits,\n            snippets: [new OneSnippet(editor, snippet, '')]\n        };\n    }\n    constructor(_editor, _template, _options = _defaultOptions, _languageConfigurationService) {\n        this._editor = _editor;\n        this._template = _template;\n        this._options = _options;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._templateMerges = [];\n        this._snippets = [];\n    }\n    dispose() {\n        dispose(this._snippets);\n    }\n    _logInfo() {\n        return `template=\"${this._template}\", merged_templates=\"${this._templateMerges.join(' -> ')}\"`;\n    }\n    insert() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // make insert edit and start with first selections\n        const { edits, snippets } = typeof this._template === 'string'\n            ? SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService)\n            : SnippetSession_1.createEditsAndSnippetsFromEdits(this._editor, this._template, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService);\n        this._snippets = snippets;\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            if (this._snippets[0].hasPlaceholder) {\n                return this._move(true);\n            }\n            else {\n                return undoEdits\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n        this._editor.revealRange(this._editor.getSelections()[0]);\n    }\n    merge(template, options = _defaultOptions) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\n        const { edits, snippets } = SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText, options.overtypingCapturer, this._languageConfigurationService);\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            // Trivial snippets have no placeholder or are just the final placeholder. That means they\n            // are just text insertions and we don't need to merge the nested snippet into the existing\n            // snippet\n            const isTrivialSnippet = snippets[0].isTrivialSnippet;\n            if (!isTrivialSnippet) {\n                for (const snippet of this._snippets) {\n                    snippet.merge(snippets);\n                }\n                console.assert(snippets.length === 0);\n            }\n            if (this._snippets[0].hasPlaceholder && !isTrivialSnippet) {\n                return this._move(undefined);\n            }\n            else {\n                return undoEdits.map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n    }\n    next() {\n        const newSelections = this._move(true);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    prev() {\n        const newSelections = this._move(false);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    _move(fwd) {\n        const selections = [];\n        for (const snippet of this._snippets) {\n            const oneSelection = snippet.move(fwd);\n            selections.push(...oneSelection);\n        }\n        return selections;\n    }\n    get isAtFirstPlaceholder() {\n        return this._snippets[0].isAtFirstPlaceholder;\n    }\n    get isAtLastPlaceholder() {\n        return this._snippets[0].isAtLastPlaceholder;\n    }\n    get hasPlaceholder() {\n        return this._snippets[0].hasPlaceholder;\n    }\n    get hasChoice() {\n        return this._snippets[0].hasChoice;\n    }\n    get activeChoice() {\n        return this._snippets[0].activeChoice;\n    }\n    isSelectionWithinPlaceholders() {\n        if (!this.hasPlaceholder) {\n            return false;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length < this._snippets.length) {\n            // this means we started snippet mode with N\n            // selections and have M (N > M) selections.\n            // So one snippet is without selection -> cancel\n            return false;\n        }\n        const allPossibleSelections = new Map();\n        for (const snippet of this._snippets) {\n            const possibleSelections = snippet.computePossibleSelections();\n            // for the first snippet find the placeholder (and its ranges)\n            // that contain at least one selection. for all remaining snippets\n            // the same placeholder (and their ranges) must be used.\n            if (allPossibleSelections.size === 0) {\n                for (const [index, ranges] of possibleSelections) {\n                    ranges.sort(Range.compareRangesUsingStarts);\n                    for (const selection of selections) {\n                        if (ranges[0].containsRange(selection)) {\n                            allPossibleSelections.set(index, []);\n                            break;\n                        }\n                    }\n                }\n            }\n            if (allPossibleSelections.size === 0) {\n                // return false if we couldn't associate a selection to\n                // this (the first) snippet\n                return false;\n            }\n            // add selections from 'this' snippet so that we know all\n            // selections for this placeholder\n            allPossibleSelections.forEach((array, index) => {\n                array.push(...possibleSelections.get(index));\n            });\n        }\n        // sort selections (and later placeholder-ranges). then walk both\n        // arrays and make sure the placeholder-ranges contain the corresponding\n        // selection\n        selections.sort(Range.compareRangesUsingStarts);\n        for (const [index, ranges] of allPossibleSelections) {\n            if (ranges.length !== selections.length) {\n                allPossibleSelections.delete(index);\n                continue;\n            }\n            ranges.sort(Range.compareRangesUsingStarts);\n            for (let i = 0; i < ranges.length; i++) {\n                if (!ranges[i].containsRange(selections[i])) {\n                    allPossibleSelections.delete(index);\n                    continue;\n                }\n            }\n        }\n        // from all possible selections we have deleted those\n        // that don't match with the current selection. if we don't\n        // have any left, we don't have a selection anymore\n        return allPossibleSelections.size > 0;\n    }\n};\nSnippetSession = SnippetSession_1 = __decorate([\n    __param(3, ILanguageConfigurationService)\n], SnippetSession);\nexport { SnippetSession };\n", "import { hasDriveLetter } from './extpath.js';\nimport { isWindows } from './platform.js';\nexport function normalizeDriveLetter(path, isWindowsOS = isWindows) {\n    if (hasDriveLetter(path, isWindowsOS)) {\n        return path.charAt(0).toUpperCase() + path.slice(1);\n    }\n    return path;\n}\nlet normalizedUserHomeCached = Object.create(null);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { commonPrefixLength, getLeadingWhitespace, isFalsyOrWhitespace, splitLines } from '../../../../base/common/strings.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { Text } from './snippetParser.js';\nimport * as nls from '../../../../nls.js';\nimport { WORKSPACE_EXTENSION, isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier, isEmptyWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nexport const KnownSnippetVariableNames = Object.freeze({\n    'CURRENT_YEAR': true,\n    'CURRENT_YEAR_SHORT': true,\n    'CURRENT_MONTH': true,\n    'CURRENT_DATE': true,\n    'CURRENT_HOUR': true,\n    'CURRENT_MINUTE': true,\n    'CURRENT_SECOND': true,\n    'CURRENT_DAY_NAME': true,\n    'CURRENT_DAY_NAME_SHORT': true,\n    'CURRENT_MONTH_NAME': true,\n    'CURRENT_MONTH_NAME_SHORT': true,\n    'CURRENT_SECONDS_UNIX': true,\n    'CURRENT_TIMEZONE_OFFSET': true,\n    'SELECTION': true,\n    'CLIPBOARD': true,\n    'TM_SELECTED_TEXT': true,\n    'TM_CURRENT_LINE': true,\n    'TM_CURRENT_WORD': true,\n    'TM_LINE_INDEX': true,\n    'TM_LINE_NUMBER': true,\n    'TM_FILENAME': true,\n    'TM_FILENAME_BASE': true,\n    'TM_DIRECTORY': true,\n    'TM_FILEPATH': true,\n    'CURSOR_INDEX': true, // 0-offset\n    'CURSOR_NUMBER': true, // 1-offset\n    'RELATIVE_FILEPATH': true,\n    'BLOCK_COMMENT_START': true,\n    'BLOCK_COMMENT_END': true,\n    'LINE_COMMENT': true,\n    'WORKSPACE_NAME': true,\n    'WORKSPACE_FOLDER': true,\n    'RANDOM': true,\n    'RANDOM_HEX': true,\n    'UUID': true\n});\nexport class CompositeSnippetVariableResolver {\n    constructor(_delegates) {\n        this._delegates = _delegates;\n        //\n    }\n    resolve(variable) {\n        for (const delegate of this._delegates) {\n            const value = delegate.resolve(variable);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n        return undefined;\n    }\n}\nexport class SelectionBasedVariableResolver {\n    constructor(_model, _selection, _selectionIdx, _overtypingCapturer) {\n        this._model = _model;\n        this._selection = _selection;\n        this._selectionIdx = _selectionIdx;\n        this._overtypingCapturer = _overtypingCapturer;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\n            let value = this._model.getValueInRange(this._selection) || undefined;\n            let isMultiline = this._selection.startLineNumber !== this._selection.endLineNumber;\n            // If there was no selected text, try to get last overtyped text\n            if (!value && this._overtypingCapturer) {\n                const info = this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);\n                if (info) {\n                    value = info.value;\n                    isMultiline = info.multiline;\n                }\n            }\n            if (value && isMultiline && variable.snippet) {\n                // Selection is a multiline string which we indentation we now\n                // need to adjust. We compare the indentation of this variable\n                // with the indentation at the editor position and add potential\n                // extra indentation to the value\n                const line = this._model.getLineContent(this._selection.startLineNumber);\n                const lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\n                let varLeadingWhitespace = lineLeadingWhitespace;\n                variable.snippet.walk(marker => {\n                    if (marker === variable) {\n                        return false;\n                    }\n                    if (marker instanceof Text) {\n                        varLeadingWhitespace = getLeadingWhitespace(splitLines(marker.value).pop());\n                    }\n                    return true;\n                });\n                const whitespaceCommonLength = commonPrefixLength(varLeadingWhitespace, lineLeadingWhitespace);\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, (m, newline, rest) => `${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`);\n            }\n            return value;\n        }\n        else if (name === 'TM_CURRENT_LINE') {\n            return this._model.getLineContent(this._selection.positionLineNumber);\n        }\n        else if (name === 'TM_CURRENT_WORD') {\n            const info = this._model.getWordAtPosition({\n                lineNumber: this._selection.positionLineNumber,\n                column: this._selection.positionColumn\n            });\n            return info && info.word || undefined;\n        }\n        else if (name === 'TM_LINE_INDEX') {\n            return String(this._selection.positionLineNumber - 1);\n        }\n        else if (name === 'TM_LINE_NUMBER') {\n            return String(this._selection.positionLineNumber);\n        }\n        else if (name === 'CURSOR_INDEX') {\n            return String(this._selectionIdx);\n        }\n        else if (name === 'CURSOR_NUMBER') {\n            return String(this._selectionIdx + 1);\n        }\n        return undefined;\n    }\n}\nexport class ModelBasedVariableResolver {\n    constructor(_labelService, _model) {\n        this._labelService = _labelService;\n        this._model = _model;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'TM_FILENAME') {\n            return path.basename(this._model.uri.fsPath);\n        }\n        else if (name === 'TM_FILENAME_BASE') {\n            const name = path.basename(this._model.uri.fsPath);\n            const idx = name.lastIndexOf('.');\n            if (idx <= 0) {\n                return name;\n            }\n            else {\n                return name.slice(0, idx);\n            }\n        }\n        else if (name === 'TM_DIRECTORY') {\n            if (path.dirname(this._model.uri.fsPath) === '.') {\n                return '';\n            }\n            return this._labelService.getUriLabel(dirname(this._model.uri));\n        }\n        else if (name === 'TM_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri);\n        }\n        else if (name === 'RELATIVE_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri, { relative: true, noPrefix: true });\n        }\n        return undefined;\n    }\n}\nexport class ClipboardBasedVariableResolver {\n    constructor(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\n        this._readClipboardText = _readClipboardText;\n        this._selectionIdx = _selectionIdx;\n        this._selectionCount = _selectionCount;\n        this._spread = _spread;\n        //\n    }\n    resolve(variable) {\n        if (variable.name !== 'CLIPBOARD') {\n            return undefined;\n        }\n        const clipboardText = this._readClipboardText();\n        if (!clipboardText) {\n            return undefined;\n        }\n        // `spread` is assigning each cursor a line of the clipboard\n        // text whenever there the line count equals the cursor count\n        // and when enabled\n        if (this._spread) {\n            const lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(s => !isFalsyOrWhitespace(s));\n            if (lines.length === this._selectionCount) {\n                return lines[this._selectionIdx];\n            }\n        }\n        return clipboardText;\n    }\n}\nlet CommentBasedVariableResolver = class CommentBasedVariableResolver {\n    constructor(_model, _selection, _languageConfigurationService) {\n        this._model = _model;\n        this._selection = _selection;\n        this._languageConfigurationService = _languageConfigurationService;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        const langId = this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber, this._selection.selectionStartColumn);\n        const config = this._languageConfigurationService.getLanguageConfiguration(langId).comments;\n        if (!config) {\n            return undefined;\n        }\n        if (name === 'LINE_COMMENT') {\n            return config.lineCommentToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_START') {\n            return config.blockCommentStartToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_END') {\n            return config.blockCommentEndToken || undefined;\n        }\n        return undefined;\n    }\n};\nCommentBasedVariableResolver = __decorate([\n    __param(2, ILanguageConfigurationService)\n], CommentBasedVariableResolver);\nexport { CommentBasedVariableResolver };\nexport class TimeBasedVariableResolver {\n    constructor() {\n        this._date = new Date();\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'CURRENT_YEAR') {\n            return String(this._date.getFullYear());\n        }\n        else if (name === 'CURRENT_YEAR_SHORT') {\n            return String(this._date.getFullYear()).slice(-2);\n        }\n        else if (name === 'CURRENT_MONTH') {\n            return String(this._date.getMonth().valueOf() + 1).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DATE') {\n            return String(this._date.getDate().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_HOUR') {\n            return String(this._date.getHours().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_MINUTE') {\n            return String(this._date.getMinutes().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_SECOND') {\n            return String(this._date.getSeconds().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DAY_NAME') {\n            return TimeBasedVariableResolver.dayNames[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\n            return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME') {\n            return TimeBasedVariableResolver.monthNames[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\n            return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_SECONDS_UNIX') {\n            return String(Math.floor(this._date.getTime() / 1000));\n        }\n        else if (name === 'CURRENT_TIMEZONE_OFFSET') {\n            const rawTimeOffset = this._date.getTimezoneOffset();\n            const sign = rawTimeOffset > 0 ? '-' : '+';\n            const hours = Math.trunc(Math.abs(rawTimeOffset / 60));\n            const hoursString = (hours < 10 ? '0' + hours : hours);\n            const minutes = Math.abs(rawTimeOffset) - hours * 60;\n            const minutesString = (minutes < 10 ? '0' + minutes : minutes);\n            return sign + hoursString + ':' + minutesString;\n        }\n        return undefined;\n    }\n}\nTimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\nTimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\nTimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\nTimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\nexport class WorkspaceBasedVariableResolver {\n    constructor(_workspaceService) {\n        this._workspaceService = _workspaceService;\n        //\n    }\n    resolve(variable) {\n        if (!this._workspaceService) {\n            return undefined;\n        }\n        const workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\n        if (isEmptyWorkspaceIdentifier(workspaceIdentifier)) {\n            return undefined;\n        }\n        if (variable.name === 'WORKSPACE_NAME') {\n            return this._resolveWorkspaceName(workspaceIdentifier);\n        }\n        else if (variable.name === 'WORKSPACE_FOLDER') {\n            return this._resoveWorkspacePath(workspaceIdentifier);\n        }\n        return undefined;\n    }\n    _resolveWorkspaceName(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return path.basename(workspaceIdentifier.uri.path);\n        }\n        let filename = path.basename(workspaceIdentifier.configPath.path);\n        if (filename.endsWith(WORKSPACE_EXTENSION)) {\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\n        }\n        return filename;\n    }\n    _resoveWorkspacePath(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return normalizeDriveLetter(workspaceIdentifier.uri.fsPath);\n        }\n        const filename = path.basename(workspaceIdentifier.configPath.path);\n        let folderpath = workspaceIdentifier.configPath.fsPath;\n        if (folderpath.endsWith(filename)) {\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\n        }\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\n    }\n}\nexport class RandomBasedVariableResolver {\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'RANDOM') {\n            return Math.random().toString().slice(-6);\n        }\n        else if (name === 'RANDOM_HEX') {\n            return Math.random().toString(16).slice(-6);\n        }\n        else if (name === 'UUID') {\n            return generateUuid();\n        }\n        return undefined;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SelectedSuggestionInfo } from '../../../common/languages.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { SnippetSession } from '../../snippet/browser/snippetSession.js';\nimport { SuggestController } from '../../suggest/browser/suggestController.js';\nimport { observableValue, transaction } from '../../../../base/common/observable.js';\nimport { SingleTextEdit } from './singleTextEdit.js';\nimport { compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { findFirstMaxBy } from '../../../../base/common/arraysFind.js';\nexport class SuggestWidgetAdaptor extends Disposable {\n    get selectedItem() {\n        return this._selectedItem;\n    }\n    constructor(editor, suggestControllerPreselector, checkModelVersion, onWillAccept) {\n        super();\n        this.editor = editor;\n        this.suggestControllerPreselector = suggestControllerPreselector;\n        this.checkModelVersion = checkModelVersion;\n        this.onWillAccept = onWillAccept;\n        this.isSuggestWidgetVisible = false;\n        this.isShiftKeyPressed = false;\n        this._isActive = false;\n        this._currentSuggestItemInfo = undefined;\n        this._selectedItem = observableValue(this, undefined);\n        // See the command acceptAlternativeSelectedSuggestion that is bound to shift+tab\n        this._register(editor.onKeyDown(e => {\n            if (e.shiftKey && !this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = true;\n                this.update(this._isActive);\n            }\n        }));\n        this._register(editor.onKeyUp(e => {\n            if (e.shiftKey && this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = false;\n                this.update(this._isActive);\n            }\n        }));\n        const suggestController = SuggestController.get(this.editor);\n        if (suggestController) {\n            this._register(suggestController.registerSelector({\n                priority: 100,\n                select: (model, pos, suggestItems) => {\n                    var _a;\n                    transaction(tx => this.checkModelVersion(tx));\n                    const textModel = this.editor.getModel();\n                    if (!textModel) {\n                        // Should not happen\n                        return -1;\n                    }\n                    const itemToPreselect = (_a = this.suggestControllerPreselector()) === null || _a === void 0 ? void 0 : _a.removeCommonPrefix(textModel);\n                    if (!itemToPreselect) {\n                        return -1;\n                    }\n                    const position = Position.lift(pos);\n                    const candidates = suggestItems\n                        .map((suggestItem, index) => {\n                        const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, textModel, position, suggestItem, this.isShiftKeyPressed);\n                        const suggestItemTextEdit = suggestItemInfo.toSingleTextEdit().removeCommonPrefix(textModel);\n                        const valid = itemToPreselect.augments(suggestItemTextEdit);\n                        return { index, valid, prefixLength: suggestItemTextEdit.text.length, suggestItem };\n                    })\n                        .filter(item => item && item.valid && item.prefixLength > 0);\n                    const result = findFirstMaxBy(candidates, compareBy(s => s.prefixLength, numberComparator));\n                    return result ? result.index : -1;\n                }\n            }));\n            let isBoundToSuggestWidget = false;\n            const bindToSuggestWidget = () => {\n                if (isBoundToSuggestWidget) {\n                    return;\n                }\n                isBoundToSuggestWidget = true;\n                this._register(suggestController.widget.value.onDidShow(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n                this._register(suggestController.widget.value.onDidHide(() => {\n                    this.isSuggestWidgetVisible = false;\n                    this.update(false);\n                }));\n                this._register(suggestController.widget.value.onDidFocus(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n            };\n            this._register(Event.once(suggestController.model.onDidTrigger)(e => {\n                bindToSuggestWidget();\n            }));\n            this._register(suggestController.onWillInsertSuggestItem(e => {\n                const position = this.editor.getPosition();\n                const model = this.editor.getModel();\n                if (!position || !model) {\n                    return undefined;\n                }\n                const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, model, position, e.item, this.isShiftKeyPressed);\n                this.onWillAccept(suggestItemInfo);\n            }));\n        }\n        this.update(this._isActive);\n    }\n    update(newActive) {\n        const newInlineCompletion = this.getSuggestItemInfo();\n        if (this._isActive !== newActive || !suggestItemInfoEquals(this._currentSuggestItemInfo, newInlineCompletion)) {\n            this._isActive = newActive;\n            this._currentSuggestItemInfo = newInlineCompletion;\n            transaction(tx => {\n                /** @description Update state from suggest widget */\n                this.checkModelVersion(tx);\n                this._selectedItem.set(this._isActive ? this._currentSuggestItemInfo : undefined, tx);\n            });\n        }\n    }\n    getSuggestItemInfo() {\n        const suggestController = SuggestController.get(this.editor);\n        if (!suggestController || !this.isSuggestWidgetVisible) {\n            return undefined;\n        }\n        const focusedItem = suggestController.widget.value.getFocusedItem();\n        const position = this.editor.getPosition();\n        const model = this.editor.getModel();\n        if (!focusedItem || !position || !model) {\n            return undefined;\n        }\n        return SuggestItemInfo.fromSuggestion(suggestController, model, position, focusedItem.item, this.isShiftKeyPressed);\n    }\n    stopForceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        suggestController === null || suggestController === void 0 ? void 0 : suggestController.stopForceRenderingAbove();\n    }\n    forceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        suggestController === null || suggestController === void 0 ? void 0 : suggestController.forceRenderingAbove();\n    }\n}\nexport class SuggestItemInfo {\n    static fromSuggestion(suggestController, model, position, item, toggleMode) {\n        let { insertText } = item.completion;\n        let isSnippetText = false;\n        if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */) {\n            const snippet = new SnippetParser().parse(insertText);\n            if (snippet.children.length < 100) {\n                // Adjust whitespace is expensive.\n                SnippetSession.adjustWhitespace(model, position, true, snippet);\n            }\n            insertText = snippet.toString();\n            isSnippetText = true;\n        }\n        const info = suggestController.getOverwriteInfo(item, toggleMode);\n        return new SuggestItemInfo(Range.fromPositions(position.delta(0, -info.overwriteBefore), position.delta(0, Math.max(info.overwriteAfter, 0))), insertText, item.completion.kind, isSnippetText);\n    }\n    constructor(range, insertText, completionItemKind, isSnippetText) {\n        this.range = range;\n        this.insertText = insertText;\n        this.completionItemKind = completionItemKind;\n        this.isSnippetText = isSnippetText;\n    }\n    equals(other) {\n        return this.range.equalsRange(other.range)\n            && this.insertText === other.insertText\n            && this.completionItemKind === other.completionItemKind\n            && this.isSnippetText === other.isSnippetText;\n    }\n    toSelectedSuggestionInfo() {\n        return new SelectedSuggestionInfo(this.range, this.insertText, this.completionItemKind, this.isSnippetText);\n    }\n    toSingleTextEdit() {\n        return new SingleTextEdit(this.range, this.insertText);\n    }\n}\nfunction suggestItemInfoEquals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (!a || !b) {\n        return false;\n    }\n    return a.equals(b);\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { KeyCodeChord } from '../../../../base/common/keybindings.js';\nimport { DisposableStore, dispose, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isObject } from '../../../../base/common/types.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordContextKey } from './wordContextKey.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { SuggestAlternatives } from './suggestAlternatives.js';\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\nimport { SuggestModel } from './suggestModel.js';\nimport { OvertypingCapturer } from './suggestOvertypingCapturer.js';\nimport { SuggestWidget } from './suggestWidget.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { basename, extname } from '../../../../base/common/resources.js';\nimport { hash } from '../../../../base/common/hash.js';\nimport { WindowIdleValue, getWindow } from '../../../../base/browser/dom.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\n// sticky suggest widget which doesn't disappear on focus out and such\nconst _sticky = false;\nclass LineSuffix {\n    constructor(_model, _position) {\n        this._model = _model;\n        this._position = _position;\n        this._decorationOptions = ModelDecorationOptions.register({\n            description: 'suggest-line-suffix',\n            stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n        });\n        // spy on what's happening right of the cursor. two cases:\n        // 1. end of line -> check that it's still end of line\n        // 2. mid of line -> add a marker and compute the delta\n        const maxColumn = _model.getLineMaxColumn(_position.lineNumber);\n        if (maxColumn !== _position.column) {\n            const offset = _model.getOffsetAt(_position);\n            const end = _model.getPositionAt(offset + 1);\n            _model.changeDecorations(accessor => {\n                if (this._marker) {\n                    accessor.removeDecoration(this._marker);\n                }\n                this._marker = accessor.addDecoration(Range.fromPositions(_position, end), this._decorationOptions);\n            });\n        }\n    }\n    dispose() {\n        if (this._marker && !this._model.isDisposed()) {\n            this._model.changeDecorations(accessor => {\n                accessor.removeDecoration(this._marker);\n                this._marker = undefined;\n            });\n        }\n    }\n    delta(position) {\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\n            // bail out early if things seems fishy\n            return 0;\n        }\n        // read the marker (in case suggest was triggered at line end) or compare\n        // the cursor to the line end.\n        if (this._marker) {\n            const range = this._model.getDecorationRange(this._marker);\n            const end = this._model.getOffsetAt(range.getStartPosition());\n            return end - this._model.getOffsetAt(position);\n        }\n        else {\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\n        }\n    }\n}\nlet SuggestController = SuggestController_1 = class SuggestController {\n    static get(editor) {\n        return editor.getContribution(SuggestController_1.ID);\n    }\n    constructor(editor, _memoryService, _commandService, _contextKeyService, _instantiationService, _logService, _telemetryService) {\n        this._memoryService = _memoryService;\n        this._commandService = _commandService;\n        this._contextKeyService = _contextKeyService;\n        this._instantiationService = _instantiationService;\n        this._logService = _logService;\n        this._telemetryService = _telemetryService;\n        this._lineSuffix = new MutableDisposable();\n        this._toDispose = new DisposableStore();\n        this._selectors = new PriorityRegistry(s => s.priority);\n        this._onWillInsertSuggestItem = new Emitter();\n        this.onWillInsertSuggestItem = this._onWillInsertSuggestItem.event;\n        this.editor = editor;\n        this.model = _instantiationService.createInstance(SuggestModel, this.editor);\n        // default selector\n        this._selectors.register({\n            priority: 0,\n            select: (model, pos, items) => this._memoryService.select(model, pos, items)\n        });\n        // context key: update insert/replace mode\n        const ctxInsertMode = SuggestContext.InsertMode.bindTo(_contextKeyService);\n        ctxInsertMode.set(editor.getOption(118 /* EditorOption.suggest */).insertMode);\n        this._toDispose.add(this.model.onDidTrigger(() => ctxInsertMode.set(editor.getOption(118 /* EditorOption.suggest */).insertMode)));\n        this.widget = this._toDispose.add(new WindowIdleValue(getWindow(editor.getDomNode()), () => {\n            const widget = this._instantiationService.createInstance(SuggestWidget, this.editor);\n            this._toDispose.add(widget);\n            this._toDispose.add(widget.onDidSelect(item => this._insertSuggestion(item, 0 /* InsertFlags.None */), this));\n            // Wire up logic to accept a suggestion on certain characters\n            const commitCharacterController = new CommitCharacterController(this.editor, widget, this.model, item => this._insertSuggestion(item, 2 /* InsertFlags.NoAfterUndoStop */));\n            this._toDispose.add(commitCharacterController);\n            // Wire up makes text edit context key\n            const ctxMakesTextEdit = SuggestContext.MakesTextEdit.bindTo(this._contextKeyService);\n            const ctxHasInsertAndReplace = SuggestContext.HasInsertAndReplaceRange.bindTo(this._contextKeyService);\n            const ctxCanResolve = SuggestContext.CanResolve.bindTo(this._contextKeyService);\n            this._toDispose.add(toDisposable(() => {\n                ctxMakesTextEdit.reset();\n                ctxHasInsertAndReplace.reset();\n                ctxCanResolve.reset();\n            }));\n            this._toDispose.add(widget.onDidFocus(({ item }) => {\n                // (ctx: makesTextEdit)\n                const position = this.editor.getPosition();\n                const startColumn = item.editStart.column;\n                const endColumn = position.column;\n                let value = true;\n                if (this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */) === 'smart'\n                    && this.model.state === 2 /* State.Auto */\n                    && !item.completion.additionalTextEdits\n                    && !(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                    && endColumn - startColumn === item.completion.insertText.length) {\n                    const oldText = this.editor.getModel().getValueInRange({\n                        startLineNumber: position.lineNumber,\n                        startColumn,\n                        endLineNumber: position.lineNumber,\n                        endColumn\n                    });\n                    value = oldText !== item.completion.insertText;\n                }\n                ctxMakesTextEdit.set(value);\n                // (ctx: hasInsertAndReplaceRange)\n                ctxHasInsertAndReplace.set(!Position.equals(item.editInsertEnd, item.editReplaceEnd));\n                // (ctx: canResolve)\n                ctxCanResolve.set(Boolean(item.provider.resolveCompletionItem) || Boolean(item.completion.documentation) || item.completion.detail !== item.completion.label);\n            }));\n            this._toDispose.add(widget.onDetailsKeyDown(e => {\n                // cmd + c on macOS, ctrl + c on Win / Linux\n                if (e.toKeyCodeChord().equals(new KeyCodeChord(true, false, false, false, 33 /* KeyCode.KeyC */)) ||\n                    (platform.isMacintosh && e.toKeyCodeChord().equals(new KeyCodeChord(false, false, false, true, 33 /* KeyCode.KeyC */)))) {\n                    e.stopPropagation();\n                    return;\n                }\n                if (!e.toKeyCodeChord().isModifierKey()) {\n                    this.editor.focus();\n                }\n            }));\n            return widget;\n        }));\n        // Wire up text overtyping capture\n        this._overtypingCapturer = this._toDispose.add(new WindowIdleValue(getWindow(editor.getDomNode()), () => {\n            return this._toDispose.add(new OvertypingCapturer(this.editor, this.model));\n        }));\n        this._alternatives = this._toDispose.add(new WindowIdleValue(getWindow(editor.getDomNode()), () => {\n            return this._toDispose.add(new SuggestAlternatives(this.editor, this._contextKeyService));\n        }));\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\n        this._toDispose.add(this.model.onDidTrigger(e => {\n            this.widget.value.showTriggered(e.auto, e.shy ? 250 : 50);\n            this._lineSuffix.value = new LineSuffix(this.editor.getModel(), e.position);\n        }));\n        this._toDispose.add(this.model.onDidSuggest(e => {\n            if (e.triggerOptions.shy) {\n                return;\n            }\n            let index = -1;\n            for (const selector of this._selectors.itemsOrderedByPriorityDesc) {\n                index = selector.select(this.editor.getModel(), this.editor.getPosition(), e.completionModel.items);\n                if (index !== -1) {\n                    break;\n                }\n            }\n            if (index === -1) {\n                index = 0;\n            }\n            if (this.model.state === 0 /* State.Idle */) {\n                // selecting an item can \"pump\" out selection/cursor change events\n                // which can cancel suggest halfway through this function. therefore\n                // we need to check again and bail if the session has been canceled\n                return;\n            }\n            let noFocus = false;\n            if (e.triggerOptions.auto) {\n                // don't \"focus\" item when configured to do\n                const options = this.editor.getOption(118 /* EditorOption.suggest */);\n                if (options.selectionMode === 'never' || options.selectionMode === 'always') {\n                    // simple: always or never\n                    noFocus = options.selectionMode === 'never';\n                }\n                else if (options.selectionMode === 'whenTriggerCharacter') {\n                    // on with trigger character\n                    noFocus = e.triggerOptions.triggerKind !== 1 /* CompletionTriggerKind.TriggerCharacter */;\n                }\n                else if (options.selectionMode === 'whenQuickSuggestion') {\n                    // without trigger character or when refiltering\n                    noFocus = e.triggerOptions.triggerKind === 1 /* CompletionTriggerKind.TriggerCharacter */ && !e.triggerOptions.refilter;\n                }\n            }\n            this.widget.value.showSuggestions(e.completionModel, index, e.isFrozen, e.triggerOptions.auto, noFocus);\n        }));\n        this._toDispose.add(this.model.onDidCancel(e => {\n            if (!e.retrigger) {\n                this.widget.value.hideWidget();\n            }\n        }));\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(() => {\n            if (!_sticky) {\n                this.model.cancel();\n                this.model.clear();\n            }\n        }));\n        // Manage the acceptSuggestionsOnEnter context key\n        const acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\n        const updateFromConfig = () => {\n            const acceptSuggestionOnEnter = this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */);\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\n        };\n        this._toDispose.add(this.editor.onDidChangeConfiguration(() => updateFromConfig()));\n        updateFromConfig();\n    }\n    dispose() {\n        this._alternatives.dispose();\n        this._toDispose.dispose();\n        this.widget.dispose();\n        this.model.dispose();\n        this._lineSuffix.dispose();\n        this._onWillInsertSuggestItem.dispose();\n    }\n    _insertSuggestion(event, flags) {\n        if (!event || !event.item) {\n            this._alternatives.value.reset();\n            this.model.cancel();\n            this.model.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const snippetController = SnippetController2.get(this.editor);\n        if (!snippetController) {\n            return;\n        }\n        this._onWillInsertSuggestItem.fire({ item: event.item });\n        const model = this.editor.getModel();\n        const modelVersionNow = model.getAlternativeVersionId();\n        const { item } = event;\n        //\n        const tasks = [];\n        const cts = new CancellationTokenSource();\n        // pushing undo stops *before* additional text edits and\n        // *after* the main edit\n        if (!(flags & 1 /* InsertFlags.NoBeforeUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\n        const info = this.getOverwriteInfo(item, Boolean(flags & 8 /* InsertFlags.AlternativeOverwriteConfig */));\n        // keep item in memory\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\n        const isResolved = item.isResolved;\n        // telemetry data points: duration of command execution, info about async additional edits (-1=n/a, -2=none, 1=success, 0=failed)\n        let _commandExectionDuration = -1;\n        let _additionalEditsAppliedAsync = -1;\n        if (Array.isArray(item.completion.additionalTextEdits)) {\n            // cancel -> stops all listening and closes widget\n            this.model.cancel();\n            // sync additional edits\n            const scrollState = StableEditorScrollState.capture(this.editor);\n            this.editor.executeEdits('suggestController.additionalTextEdits.sync', item.completion.additionalTextEdits.map(edit => {\n                let range = Range.lift(edit.range);\n                if (range.startLineNumber === item.position.lineNumber && range.startColumn > item.position.column) {\n                    // shift additional edit when it is \"after\" the completion insertion position\n                    const columnDelta = this.editor.getPosition().column - item.position.column;\n                    const startColumnDelta = columnDelta;\n                    const endColumnDelta = Range.spansMultipleLines(range) ? 0 : columnDelta;\n                    range = new Range(range.startLineNumber, range.startColumn + startColumnDelta, range.endLineNumber, range.endColumn + endColumnDelta);\n                }\n                return EditOperation.replaceMove(range, edit.text);\n            }));\n            scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n        }\n        else if (!isResolved) {\n            // async additional edits\n            const sw = new StopWatch();\n            let position;\n            const docListener = model.onDidChangeContent(e => {\n                if (e.isFlush) {\n                    cts.cancel();\n                    docListener.dispose();\n                    return;\n                }\n                for (const change of e.changes) {\n                    const thisPosition = Range.getEndPosition(change.range);\n                    if (!position || Position.isBefore(thisPosition, position)) {\n                        position = thisPosition;\n                    }\n                }\n            });\n            const oldFlags = flags;\n            flags |= 2 /* InsertFlags.NoAfterUndoStop */;\n            let didType = false;\n            const typeListener = this.editor.onWillType(() => {\n                typeListener.dispose();\n                didType = true;\n                if (!(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n            });\n            tasks.push(item.resolve(cts.token).then(() => {\n                if (!item.completion.additionalTextEdits || cts.token.isCancellationRequested) {\n                    return undefined;\n                }\n                if (position && item.completion.additionalTextEdits.some(edit => Position.isBefore(position, Range.getStartPosition(edit.range)))) {\n                    return false;\n                }\n                if (didType) {\n                    this.editor.pushUndoStop();\n                }\n                const scrollState = StableEditorScrollState.capture(this.editor);\n                this.editor.executeEdits('suggestController.additionalTextEdits.async', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n                scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n                if (didType || !(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n                return true;\n            }).then(applied => {\n                this._logService.trace('[suggest] async resolving of edits DONE (ms, applied?)', sw.elapsed(), applied);\n                _additionalEditsAppliedAsync = applied === true ? 1 : applied === false ? 0 : -2;\n            }).finally(() => {\n                docListener.dispose();\n                typeListener.dispose();\n            }));\n        }\n        let { insertText } = item.completion;\n        if (!(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)) {\n            insertText = SnippetParser.escape(insertText);\n        }\n        // cancel -> stops all listening and closes widget\n        this.model.cancel();\n        snippetController.insert(insertText, {\n            overwriteBefore: info.overwriteBefore,\n            overwriteAfter: info.overwriteAfter,\n            undoStopBefore: false,\n            undoStopAfter: false,\n            adjustWhitespace: !(item.completion.insertTextRules & 1 /* CompletionItemInsertTextRule.KeepWhitespace */),\n            clipboardText: event.model.clipboardText,\n            overtypingCapturer: this._overtypingCapturer.value\n        });\n        if (!(flags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        if (item.completion.command) {\n            if (item.completion.command.id === TriggerSuggestAction.id) {\n                // retigger\n                this.model.trigger({ auto: true, retrigger: true });\n            }\n            else {\n                // exec command, done\n                const sw = new StopWatch();\n                tasks.push(this._commandService.executeCommand(item.completion.command.id, ...(item.completion.command.arguments ? [...item.completion.command.arguments] : [])).catch(e => {\n                    if (item.completion.extensionId) {\n                        onUnexpectedExternalError(e);\n                    }\n                    else {\n                        onUnexpectedError(e);\n                    }\n                }).finally(() => {\n                    _commandExectionDuration = sw.elapsed();\n                }));\n            }\n        }\n        if (flags & 4 /* InsertFlags.KeepAlternativeSuggestions */) {\n            this._alternatives.value.set(event, next => {\n                // cancel resolving of additional edits\n                cts.cancel();\n                // this is not so pretty. when inserting the 'next'\n                // suggestion we undo until we are at the state at\n                // which we were before inserting the previous suggestion...\n                while (model.canUndo()) {\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\n                        model.undo();\n                    }\n                    this._insertSuggestion(next, 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */ | (flags & 8 /* InsertFlags.AlternativeOverwriteConfig */ ? 8 /* InsertFlags.AlternativeOverwriteConfig */ : 0));\n                    break;\n                }\n            });\n        }\n        this._alertCompletionItem(item);\n        // clear only now - after all tasks are done\n        Promise.all(tasks).finally(() => {\n            this._reportSuggestionAcceptedTelemetry(item, model, isResolved, _commandExectionDuration, _additionalEditsAppliedAsync);\n            this.model.clear();\n            cts.dispose();\n        });\n    }\n    _reportSuggestionAcceptedTelemetry(item, model, itemResolved, commandExectionDuration, additionalEditsAppliedAsync) {\n        var _a, _b, _c;\n        if (Math.floor(Math.random() * 100) === 0) {\n            // throttle telemetry event because accepting completions happens a lot\n            return;\n        }\n        this._telemetryService.publicLog2('suggest.acceptedSuggestion', {\n            extensionId: (_b = (_a = item.extensionId) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : 'unknown',\n            providerId: (_c = item.provider._debugDisplayName) !== null && _c !== void 0 ? _c : 'unknown',\n            kind: item.completion.kind,\n            basenameHash: hash(basename(model.uri)).toString(16),\n            languageId: model.getLanguageId(),\n            fileExtension: extname(model.uri),\n            resolveInfo: !item.provider.resolveCompletionItem ? -1 : itemResolved ? 1 : 0,\n            resolveDuration: item.resolveDuration,\n            commandDuration: commandExectionDuration,\n            additionalEditsAsync: additionalEditsAppliedAsync\n        });\n    }\n    getOverwriteInfo(item, toggleMode) {\n        assertType(this.editor.hasModel());\n        let replace = this.editor.getOption(118 /* EditorOption.suggest */).insertMode === 'replace';\n        if (toggleMode) {\n            replace = !replace;\n        }\n        const overwriteBefore = item.position.column - item.editStart.column;\n        const overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\n        const columnDelta = this.editor.getPosition().column - item.position.column;\n        const suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\n        return {\n            overwriteBefore: overwriteBefore + columnDelta,\n            overwriteAfter: overwriteAfter + suffixDelta\n        };\n    }\n    _alertCompletionItem(item) {\n        if (isNonEmptyArray(item.completion.additionalTextEdits)) {\n            const msg = nls.localize('aria.alert.snippet', \"Accepting '{0}' made {1} additional edits\", item.textLabel, item.completion.additionalTextEdits.length);\n            alert(msg);\n        }\n    }\n    triggerSuggest(onlyFrom, auto, noFilter) {\n        if (this.editor.hasModel()) {\n            this.model.trigger({\n                auto: auto !== null && auto !== void 0 ? auto : false,\n                completionOptions: { providerFilter: onlyFrom, kindFilter: noFilter ? new Set() : undefined }\n            });\n            this.editor.revealPosition(this.editor.getPosition(), 0 /* ScrollType.Smooth */);\n            this.editor.focus();\n        }\n    }\n    triggerSuggestAndAcceptBest(arg) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const positionNow = this.editor.getPosition();\n        const fallback = () => {\n            if (positionNow.equals(this.editor.getPosition())) {\n                this._commandService.executeCommand(arg.fallback);\n            }\n        };\n        const makesTextEdit = (item) => {\n            if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */ || item.completion.additionalTextEdits) {\n                // snippet, other editor -> makes edit\n                return true;\n            }\n            const position = this.editor.getPosition();\n            const startColumn = item.editStart.column;\n            const endColumn = position.column;\n            if (endColumn - startColumn !== item.completion.insertText.length) {\n                // unequal lengths -> makes edit\n                return true;\n            }\n            const textNow = this.editor.getModel().getValueInRange({\n                startLineNumber: position.lineNumber,\n                startColumn,\n                endLineNumber: position.lineNumber,\n                endColumn\n            });\n            // unequal text -> makes edit\n            return textNow !== item.completion.insertText;\n        };\n        Event.once(this.model.onDidTrigger)(_ => {\n            // wait for trigger because only then the cancel-event is trustworthy\n            const listener = [];\n            Event.any(this.model.onDidTrigger, this.model.onDidCancel)(() => {\n                // retrigger or cancel -> try to type default text\n                dispose(listener);\n                fallback();\n            }, undefined, listener);\n            this.model.onDidSuggest(({ completionModel }) => {\n                dispose(listener);\n                if (completionModel.items.length === 0) {\n                    fallback();\n                    return;\n                }\n                const index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), completionModel.items);\n                const item = completionModel.items[index];\n                if (!makesTextEdit(item)) {\n                    fallback();\n                    return;\n                }\n                this.editor.pushUndoStop();\n                this._insertSuggestion({ index, item, model: completionModel }, 4 /* InsertFlags.KeepAlternativeSuggestions */ | 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */);\n            }, undefined, listener);\n        });\n        this.model.trigger({ auto: false, shy: true });\n        this.editor.revealPosition(positionNow, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    acceptSelectedSuggestion(keepAlternativeSuggestions, alternativeOverwriteConfig) {\n        const item = this.widget.value.getFocusedItem();\n        let flags = 0;\n        if (keepAlternativeSuggestions) {\n            flags |= 4 /* InsertFlags.KeepAlternativeSuggestions */;\n        }\n        if (alternativeOverwriteConfig) {\n            flags |= 8 /* InsertFlags.AlternativeOverwriteConfig */;\n        }\n        this._insertSuggestion(item, flags);\n    }\n    acceptNextSuggestion() {\n        this._alternatives.value.next();\n    }\n    acceptPrevSuggestion() {\n        this._alternatives.value.prev();\n    }\n    cancelSuggestWidget() {\n        this.model.cancel();\n        this.model.clear();\n        this.widget.value.hideWidget();\n    }\n    focusSuggestion() {\n        this.widget.value.focusSelected();\n    }\n    selectNextSuggestion() {\n        this.widget.value.selectNext();\n    }\n    selectNextPageSuggestion() {\n        this.widget.value.selectNextPage();\n    }\n    selectLastSuggestion() {\n        this.widget.value.selectLast();\n    }\n    selectPrevSuggestion() {\n        this.widget.value.selectPrevious();\n    }\n    selectPrevPageSuggestion() {\n        this.widget.value.selectPreviousPage();\n    }\n    selectFirstSuggestion() {\n        this.widget.value.selectFirst();\n    }\n    toggleSuggestionDetails() {\n        this.widget.value.toggleDetails();\n    }\n    toggleExplainMode() {\n        this.widget.value.toggleExplainMode();\n    }\n    toggleSuggestionFocus() {\n        this.widget.value.toggleDetailsFocus();\n    }\n    resetWidgetSize() {\n        this.widget.value.resetPersistedSize();\n    }\n    forceRenderingAbove() {\n        this.widget.value.forceRenderingAbove();\n    }\n    stopForceRenderingAbove() {\n        if (!this.widget.isInitialized) {\n            // This method has no effect if the widget is not initialized yet.\n            return;\n        }\n        this.widget.value.stopForceRenderingAbove();\n    }\n    registerSelector(selector) {\n        return this._selectors.register(selector);\n    }\n};\nSuggestController.ID = 'editor.contrib.suggestController';\nSuggestController = SuggestController_1 = __decorate([\n    __param(1, ISuggestMemoryService),\n    __param(2, ICommandService),\n    __param(3, IContextKeyService),\n    __param(4, IInstantiationService),\n    __param(5, ILogService),\n    __param(6, ITelemetryService)\n], SuggestController);\nexport { SuggestController };\nclass PriorityRegistry {\n    constructor(prioritySelector) {\n        this.prioritySelector = prioritySelector;\n        this._items = new Array();\n    }\n    register(value) {\n        if (this._items.indexOf(value) !== -1) {\n            throw new Error('Value is already registered');\n        }\n        this._items.push(value);\n        this._items.sort((s1, s2) => this.prioritySelector(s2) - this.prioritySelector(s1));\n        return {\n            dispose: () => {\n                const idx = this._items.indexOf(value);\n                if (idx >= 0) {\n                    this._items.splice(idx, 1);\n                }\n            }\n        };\n    }\n    get itemsOrderedByPriorityDesc() {\n        return this._items;\n    }\n}\nexport class TriggerSuggestAction extends EditorAction {\n    constructor() {\n        super({\n            id: TriggerSuggestAction.id,\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\n            alias: 'Trigger Suggest',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider, SuggestContext.Visible.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [512 /* KeyMod.Alt */ | 9 /* KeyCode.Escape */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        const controller = SuggestController.get(editor);\n        if (!controller) {\n            return;\n        }\n        let auto;\n        if (args && typeof args === 'object') {\n            if (args.auto === true) {\n                auto = true;\n            }\n        }\n        controller.triggerSuggest(undefined, auto, undefined);\n    }\n}\nTriggerSuggestAction.id = 'editor.action.triggerSuggest';\nregisterEditorContribution(SuggestController.ID, SuggestController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(TriggerSuggestAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 90;\nconst SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler(x) {\n        x.acceptSelectedSuggestion(true, false);\n    },\n    kbOpts: [{\n            // normal tab\n            primary: 2 /* KeyCode.Tab */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\n            weight,\n        }, {\n            // accept on enter has special rules\n            primary: 3 /* KeyCode.Enter */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\n            weight,\n        }],\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: SuggestContext.HasInsertAndReplaceRange.toNegated()\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert'))\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.replace', \"Replace\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace'))\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptAlternativeSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.HasFocusedSuggestion),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n        secondary: [1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */],\n    },\n    handler(x) {\n        x.acceptSelectedSuggestion(false, true);\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert')),\n            title: nls.localize('accept.replace', \"Replace\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace')),\n            title: nls.localize('accept.insert', \"Insert\")\n        }]\n}));\n// continue to support the old command\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\nregisterEditorCommand(new SuggestCommand({\n    id: 'hideSuggestWidget',\n    precondition: SuggestContext.Visible,\n    handler: x => x.cancelSuggestWidget(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 12 /* KeyCode.PageDown */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 12 /* KeyCode.PageDown */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectLastSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectLastSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 11 /* KeyCode.PageUp */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 11 /* KeyCode.PageUp */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectFirstSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectFirstSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: x => x.focusSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusAndAcceptSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: c => {\n        c.focusSuggestion();\n        c.acceptSelectedSuggestion(true, false);\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionDetails',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler: x => x.toggleSuggestionDetails(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible, SuggestContext.CanResolve),\n            title: nls.localize('detail.more', \"show less\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible.toNegated(), SuggestContext.CanResolve),\n            title: nls.localize('detail.less', \"show more\")\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleExplainMode',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleExplainMode(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */,\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionFocus',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleSuggestionFocus(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */,\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */ }\n    }\n}));\n//#region tab completions\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertBestCompletion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: (x, arg) => {\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? { fallback: 'tab', ...arg } : { fallback: 'tab' });\n    },\n    kbOpts: {\n        weight,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertNextSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertPrevSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.resetSuggestSize',\n            label: nls.localize('suggest.reset.label', \"Reset Suggest Widget Size\"),\n            alias: 'Reset Suggest Widget Size',\n            precondition: undefined\n        });\n    }\n    run(_accessor, editor) {\n        var _a;\n        (_a = SuggestController.get(editor)) === null || _a === void 0 ? void 0 : _a.resetWidgetSize();\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestMemoryService_1;\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { TernarySearchTree } from '../../../../base/common/ternarySearchTree.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nexport class Memory {\n    constructor(name) {\n        this.name = name;\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const topScore = items[0].score[0];\n        for (let i = 0; i < items.length; i++) {\n            const { score, completion: suggestion } = items[i];\n            if (score[0] !== topScore) {\n                // stop when leaving the group of top matches\n                break;\n            }\n            if (suggestion.preselect) {\n                // stop when seeing an auto-select-item\n                return i;\n            }\n        }\n        return 0;\n    }\n}\nexport class NoMemory extends Memory {\n    constructor() {\n        super('first');\n    }\n    memorize(model, pos, item) {\n        // no-op\n    }\n    toJSON() {\n        return undefined;\n    }\n    fromJSON() {\n        //\n    }\n}\nexport class LRUMemory extends Memory {\n    constructor() {\n        super('recentlyUsed');\n        this._cache = new LRUCache(300, 0.66);\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const key = `${model.getLanguageId()}/${item.textLabel}`;\n        this._cache.set(key, {\n            touch: this._seq++,\n            type: item.completion.kind,\n            insertText: item.completion.insertText\n        });\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\n        if (/\\s$/.test(lineSuffix)) {\n            return super.select(model, pos, items);\n        }\n        const topScore = items[0].score[0];\n        let indexPreselect = -1;\n        let indexRecency = -1;\n        let seq = -1;\n        for (let i = 0; i < items.length; i++) {\n            if (items[i].score[0] !== topScore) {\n                // consider only top items\n                break;\n            }\n            const key = `${model.getLanguageId()}/${items[i].textLabel}`;\n            const item = this._cache.peek(key);\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\n                seq = item.touch;\n                indexRecency = i;\n            }\n            if (items[i].completion.preselect && indexPreselect === -1) {\n                // stop when seeing an auto-select-item\n                return indexPreselect = i;\n            }\n        }\n        if (indexRecency !== -1) {\n            return indexRecency;\n        }\n        else if (indexPreselect !== -1) {\n            return indexPreselect;\n        }\n        else {\n            return 0;\n        }\n    }\n    toJSON() {\n        return this._cache.toJSON();\n    }\n    fromJSON(data) {\n        this._cache.clear();\n        const seq = 0;\n        for (const [key, value] of data) {\n            value.touch = seq;\n            value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n            this._cache.set(key, value);\n        }\n        this._seq = this._cache.size;\n    }\n}\nexport class PrefixMemory extends Memory {\n    constructor() {\n        super('recentlyUsedByPrefix');\n        this._trie = TernarySearchTree.forStrings();\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const { word } = model.getWordUntilPosition(pos);\n        const key = `${model.getLanguageId()}/${word}`;\n        this._trie.set(key, {\n            type: item.completion.kind,\n            insertText: item.completion.insertText,\n            touch: this._seq++\n        });\n    }\n    select(model, pos, items) {\n        const { word } = model.getWordUntilPosition(pos);\n        if (!word) {\n            return super.select(model, pos, items);\n        }\n        const key = `${model.getLanguageId()}/${word}`;\n        let item = this._trie.get(key);\n        if (!item) {\n            item = this._trie.findSubstr(key);\n        }\n        if (item) {\n            for (let i = 0; i < items.length; i++) {\n                const { kind, insertText } = items[i].completion;\n                if (kind === item.type && insertText === item.insertText) {\n                    return i;\n                }\n            }\n        }\n        return super.select(model, pos, items);\n    }\n    toJSON() {\n        const entries = [];\n        this._trie.forEach((value, key) => entries.push([key, value]));\n        // sort by last recently used (touch), then\n        // take the top 200 item and normalize their\n        // touch\n        entries\n            .sort((a, b) => -(a[1].touch - b[1].touch))\n            .forEach((value, i) => value[1].touch = i);\n        return entries.slice(0, 200);\n    }\n    fromJSON(data) {\n        this._trie.clear();\n        if (data.length > 0) {\n            this._seq = data[0][1].touch + 1;\n            for (const [key, value] of data) {\n                value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n                this._trie.set(key, value);\n            }\n        }\n    }\n}\nlet SuggestMemoryService = SuggestMemoryService_1 = class SuggestMemoryService {\n    constructor(_storageService, _configService) {\n        this._storageService = _storageService;\n        this._configService = _configService;\n        this._disposables = new DisposableStore();\n        this._persistSoon = new RunOnceScheduler(() => this._saveState(), 500);\n        this._disposables.add(_storageService.onWillSaveState(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                this._saveState();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._persistSoon.dispose();\n    }\n    memorize(model, pos, item) {\n        this._withStrategy(model, pos).memorize(model, pos, item);\n        this._persistSoon.schedule();\n    }\n    select(model, pos, items) {\n        return this._withStrategy(model, pos).select(model, pos, items);\n    }\n    _withStrategy(model, pos) {\n        var _a;\n        const mode = this._configService.getValue('editor.suggestSelection', {\n            overrideIdentifier: model.getLanguageIdAtPosition(pos.lineNumber, pos.column),\n            resource: model.uri\n        });\n        if (((_a = this._strategy) === null || _a === void 0 ? void 0 : _a.name) !== mode) {\n            this._saveState();\n            const ctor = SuggestMemoryService_1._strategyCtors.get(mode) || NoMemory;\n            this._strategy = new ctor();\n            try {\n                const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n                const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n                const raw = this._storageService.get(`${SuggestMemoryService_1._storagePrefix}/${mode}`, scope);\n                if (raw) {\n                    this._strategy.fromJSON(JSON.parse(raw));\n                }\n            }\n            catch (e) {\n                // things can go wrong with JSON...\n            }\n        }\n        return this._strategy;\n    }\n    _saveState() {\n        if (this._strategy) {\n            const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n            const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n            const raw = JSON.stringify(this._strategy);\n            this._storageService.store(`${SuggestMemoryService_1._storagePrefix}/${this._strategy.name}`, raw, scope, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n};\nSuggestMemoryService._strategyCtors = new Map([\n    ['recentlyUsedByPrefix', PrefixMemory],\n    ['recentlyUsed', LRUMemory],\n    ['first', NoMemory]\n]);\nSuggestMemoryService._storagePrefix = 'suggest/memories';\nSuggestMemoryService = SuggestMemoryService_1 = __decorate([\n    __param(0, IStorageService),\n    __param(1, IConfigurationService)\n], SuggestMemoryService);\nexport { SuggestMemoryService };\nexport const ISuggestMemoryService = createDecorator('ISuggestMemories');\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, 1 /* InstantiationType.Delayed */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar WordContextKey_1;\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet WordContextKey = WordContextKey_1 = class WordContextKey {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._enabled = false;\n        this._ckAtEnd = WordContextKey_1.AtEnd.bindTo(contextKeyService);\n        this._configListener = this._editor.onDidChangeConfiguration(e => e.hasChanged(123 /* EditorOption.tabCompletion */) && this._update());\n        this._update();\n    }\n    dispose() {\n        var _a;\n        this._configListener.dispose();\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._ckAtEnd.reset();\n    }\n    _update() {\n        // only update this when tab completions are enabled\n        const enabled = this._editor.getOption(123 /* EditorOption.tabCompletion */) === 'on';\n        if (this._enabled === enabled) {\n            return;\n        }\n        this._enabled = enabled;\n        if (this._enabled) {\n            const checkForWordEnd = () => {\n                if (!this._editor.hasModel()) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                const model = this._editor.getModel();\n                const selection = this._editor.getSelection();\n                const word = model.getWordAtPosition(selection.getStartPosition());\n                if (!word) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\n            };\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\n            checkForWordEnd();\n        }\n        else if (this._selectionListener) {\n            this._ckAtEnd.reset();\n            this._selectionListener.dispose();\n            this._selectionListener = undefined;\n        }\n    }\n};\nWordContextKey.AtEnd = new RawContextKey('atEndOfWord', false);\nWordContextKey = WordContextKey_1 = __decorate([\n    __param(1, IContextKeyService)\n], WordContextKey);\nexport { WordContextKey };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestAlternatives_1;\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet SuggestAlternatives = SuggestAlternatives_1 = class SuggestAlternatives {\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._index = 0;\n        this._ckOtherSuggestions = SuggestAlternatives_1.OtherSuggestions.bindTo(contextKeyService);\n    }\n    dispose() {\n        this.reset();\n    }\n    reset() {\n        var _a;\n        this._ckOtherSuggestions.reset();\n        (_a = this._listener) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._model = undefined;\n        this._acceptNext = undefined;\n        this._ignore = false;\n    }\n    set({ model, index }, acceptNext) {\n        // no suggestions -> nothing to do\n        if (model.items.length === 0) {\n            this.reset();\n            return;\n        }\n        // no alternative suggestions -> nothing to do\n        const nextIndex = SuggestAlternatives_1._moveIndex(true, model, index);\n        if (nextIndex === index) {\n            this.reset();\n            return;\n        }\n        this._acceptNext = acceptNext;\n        this._model = model;\n        this._index = index;\n        this._listener = this._editor.onDidChangeCursorPosition(() => {\n            if (!this._ignore) {\n                this.reset();\n            }\n        });\n        this._ckOtherSuggestions.set(true);\n    }\n    static _moveIndex(fwd, model, index) {\n        let newIndex = index;\n        for (let rounds = model.items.length; rounds > 0; rounds--) {\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\n            if (newIndex === index) {\n                break;\n            }\n            if (!model.items[newIndex].completion.additionalTextEdits) {\n                break;\n            }\n        }\n        return newIndex;\n    }\n    next() {\n        this._move(true);\n    }\n    prev() {\n        this._move(false);\n    }\n    _move(fwd) {\n        if (!this._model) {\n            // nothing to reason about\n            return;\n        }\n        try {\n            this._ignore = true;\n            this._index = SuggestAlternatives_1._moveIndex(fwd, this._model, this._index);\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\n        }\n        finally {\n            this._ignore = false;\n        }\n    }\n};\nSuggestAlternatives.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false);\nSuggestAlternatives = SuggestAlternatives_1 = __decorate([\n    __param(1, IContextKeyService)\n], SuggestAlternatives);\nexport { SuggestAlternatives };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nexport class CommitCharacterController {\n    constructor(editor, widget, model, accept) {\n        this._disposables = new DisposableStore();\n        this._disposables.add(model.onDidSuggest(e => {\n            if (e.completionModel.items.length === 0) {\n                this.reset();\n            }\n        }));\n        this._disposables.add(model.onDidCancel(e => {\n            this.reset();\n        }));\n        this._disposables.add(widget.onDidShow(() => this._onItem(widget.getFocusedItem())));\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\n        this._disposables.add(widget.onDidHide(this.reset, this));\n        this._disposables.add(editor.onWillType(text => {\n            if (this._active && !widget.isFrozen() && model.state !== 0 /* State.Idle */) {\n                const ch = text.charCodeAt(text.length - 1);\n                if (this._active.acceptCharacters.has(ch) && editor.getOption(0 /* EditorOption.acceptSuggestionOnCommitCharacter */)) {\n                    accept(this._active.item);\n                }\n            }\n        }));\n    }\n    _onItem(selected) {\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\n            // no item or no commit characters\n            this.reset();\n            return;\n        }\n        if (this._active && this._active.item.item === selected.item) {\n            // still the same item\n            return;\n        }\n        // keep item and its commit characters\n        const acceptCharacters = new CharacterSet();\n        for (const ch of selected.item.completion.commitCharacters) {\n            if (ch.length > 0) {\n                acceptCharacters.add(ch.charCodeAt(0));\n            }\n        }\n        this._active = { acceptCharacters, item: selected };\n    }\n    reset() {\n        this._active = undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestModel_1;\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace, isHighSurrogate, isLowSurrogate } from '../../../../base/common/strings.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CompletionModel } from './completionModel.js';\nimport { CompletionOptions, getSnippetSuggestSupport, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { InlineCompletionContextKeys } from '../../inlineCompletions/browser/inlineCompletionContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nexport class LineContext {\n    static shouldAutoTrigger(editor) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const pos = editor.getPosition();\n        model.tokenization.tokenizeIfCheap(pos.lineNumber);\n        const word = model.getWordAtPosition(pos);\n        if (!word) {\n            return false;\n        }\n        if (word.endColumn !== pos.column &&\n            word.startColumn + 1 !== pos.column /* after typing a single character before a word */) {\n            return false;\n        }\n        if (!isNaN(Number(word.word))) {\n            return false;\n        }\n        return true;\n    }\n    constructor(model, position, triggerOptions) {\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n        this.leadingWord = model.getWordUntilPosition(position);\n        this.lineNumber = position.lineNumber;\n        this.column = position.column;\n        this.triggerOptions = triggerOptions;\n    }\n}\nfunction canShowQuickSuggest(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue(InlineCompletionContextKeys.inlineSuggestionVisible.key))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(62 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nfunction canShowSuggestOnTriggerCharacters(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(62 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nlet SuggestModel = SuggestModel_1 = class SuggestModel {\n    constructor(_editor, _editorWorkerService, _clipboardService, _telemetryService, _logService, _contextKeyService, _configurationService, _languageFeaturesService, _envService) {\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._clipboardService = _clipboardService;\n        this._telemetryService = _telemetryService;\n        this._logService = _logService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._envService = _envService;\n        this._toDispose = new DisposableStore();\n        this._triggerCharacterListener = new DisposableStore();\n        this._triggerQuickSuggest = new TimeoutTimer();\n        this._triggerState = undefined;\n        this._completionDisposables = new DisposableStore();\n        this._onDidCancel = new Emitter();\n        this._onDidTrigger = new Emitter();\n        this._onDidSuggest = new Emitter();\n        this.onDidCancel = this._onDidCancel.event;\n        this.onDidTrigger = this._onDidTrigger.event;\n        this.onDidSuggest = this._onDidSuggest.event;\n        this._telemetryGate = 0;\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\n        // wire up various listeners\n        this._toDispose.add(this._editor.onDidChangeModel(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeConfiguration(() => {\n            this._updateTriggerCharacters();\n        }));\n        this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(() => {\n            this._updateTriggerCharacters();\n            this._updateActiveSuggestSession();\n        }));\n        let editorIsComposing = false;\n        this._toDispose.add(this._editor.onDidCompositionStart(() => {\n            editorIsComposing = true;\n        }));\n        this._toDispose.add(this._editor.onDidCompositionEnd(() => {\n            editorIsComposing = false;\n            this._onCompositionEnd();\n        }));\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(e => {\n            // only trigger suggest when the editor isn't composing a character\n            if (!editorIsComposing) {\n                this._onCursorChange(e);\n            }\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelContent(() => {\n            // only filter completions when the editor isn't composing a character\n            // allow-any-unicode-next-line\n            // e.g. \u00A8 + u makes \u00FC but just \u00A8 cannot be used for filtering\n            if (!editorIsComposing && this._triggerState !== undefined) {\n                this._refilterCompletionItems();\n            }\n        }));\n        this._updateTriggerCharacters();\n    }\n    dispose() {\n        dispose(this._triggerCharacterListener);\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\n        this._toDispose.dispose();\n        this._completionDisposables.dispose();\n        this.cancel();\n    }\n    _updateTriggerCharacters() {\n        this._triggerCharacterListener.clear();\n        if (this._editor.getOption(91 /* EditorOption.readOnly */)\n            || !this._editor.hasModel()\n            || !this._editor.getOption(121 /* EditorOption.suggestOnTriggerCharacters */)) {\n            return;\n        }\n        const supportsByTriggerCharacter = new Map();\n        for (const support of this._languageFeaturesService.completionProvider.all(this._editor.getModel())) {\n            for (const ch of support.triggerCharacters || []) {\n                let set = supportsByTriggerCharacter.get(ch);\n                if (!set) {\n                    set = new Set();\n                    set.add(getSnippetSuggestSupport());\n                    supportsByTriggerCharacter.set(ch, set);\n                }\n                set.add(support);\n            }\n        }\n        const checkTriggerCharacter = (text) => {\n            var _a;\n            if (!canShowSuggestOnTriggerCharacters(this._editor, this._contextKeyService, this._configurationService)) {\n                return;\n            }\n            if (LineContext.shouldAutoTrigger(this._editor)) {\n                // don't trigger by trigger characters when this is a case for quick suggest\n                return;\n            }\n            if (!text) {\n                // came here from the compositionEnd-event\n                const position = this._editor.getPosition();\n                const model = this._editor.getModel();\n                text = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n            }\n            let lastChar = '';\n            if (isLowSurrogate(text.charCodeAt(text.length - 1))) {\n                if (isHighSurrogate(text.charCodeAt(text.length - 2))) {\n                    lastChar = text.substr(text.length - 2);\n                }\n            }\n            else {\n                lastChar = text.charAt(text.length - 1);\n            }\n            const supports = supportsByTriggerCharacter.get(lastChar);\n            if (supports) {\n                // keep existing items that where not computed by the\n                // supports/providers that want to trigger now\n                const providerItemsToReuse = new Map();\n                if (this._completionModel) {\n                    for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                        if (!supports.has(provider)) {\n                            providerItemsToReuse.set(provider, items);\n                        }\n                    }\n                }\n                this.trigger({\n                    auto: true,\n                    triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                    triggerCharacter: lastChar,\n                    retrigger: Boolean(this._completionModel),\n                    clipboardText: (_a = this._completionModel) === null || _a === void 0 ? void 0 : _a.clipboardText,\n                    completionOptions: { providerFilter: supports, providerItemsToReuse }\n                });\n            }\n        };\n        this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter));\n        this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(() => checkTriggerCharacter()));\n    }\n    // --- trigger/retrigger/cancel suggest\n    get state() {\n        if (!this._triggerState) {\n            return 0 /* State.Idle */;\n        }\n        else if (!this._triggerState.auto) {\n            return 1 /* State.Manual */;\n        }\n        else {\n            return 2 /* State.Auto */;\n        }\n    }\n    cancel(retrigger = false) {\n        var _a;\n        if (this._triggerState !== undefined) {\n            this._triggerQuickSuggest.cancel();\n            (_a = this._requestToken) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._requestToken = undefined;\n            this._triggerState = undefined;\n            this._completionModel = undefined;\n            this._context = undefined;\n            this._onDidCancel.fire({ retrigger });\n        }\n    }\n    clear() {\n        this._completionDisposables.clear();\n    }\n    _updateActiveSuggestSession() {\n        if (this._triggerState !== undefined) {\n            if (!this._editor.hasModel() || !this._languageFeaturesService.completionProvider.has(this._editor.getModel())) {\n                this.cancel();\n            }\n            else {\n                this.trigger({ auto: this._triggerState.auto, retrigger: true });\n            }\n        }\n    }\n    _onCursorChange(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const prevSelection = this._currentSelection;\n        this._currentSelection = this._editor.getSelection();\n        if (!e.selection.isEmpty()\n            || (e.reason !== 0 /* CursorChangeReason.NotSet */ && e.reason !== 3 /* CursorChangeReason.Explicit */)\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\n            // Early exit if nothing needs to be done!\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n            this.cancel();\n            return;\n        }\n        if (this._triggerState === undefined && e.reason === 0 /* CursorChangeReason.NotSet */) {\n            if (prevSelection.containsRange(this._currentSelection) || prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\n                // cursor did move RIGHT due to typing -> trigger quick suggest\n                this._doTriggerQuickSuggest();\n            }\n        }\n        else if (this._triggerState !== undefined && e.reason === 3 /* CursorChangeReason.Explicit */) {\n            // suggest is active and something like cursor keys are used to move\n            // the cursor. this means we can refilter at the new position\n            this._refilterCompletionItems();\n        }\n    }\n    _onCompositionEnd() {\n        // trigger or refilter when composition ends\n        if (this._triggerState === undefined) {\n            this._doTriggerQuickSuggest();\n        }\n        else {\n            this._refilterCompletionItems();\n        }\n    }\n    _doTriggerQuickSuggest() {\n        var _a;\n        if (QuickSuggestionsOptions.isAllOff(this._editor.getOption(89 /* EditorOption.quickSuggestions */))) {\n            // not enabled\n            return;\n        }\n        if (this._editor.getOption(118 /* EditorOption.suggest */).snippetsPreventQuickSuggestions && ((_a = SnippetController2.get(this._editor)) === null || _a === void 0 ? void 0 : _a.isInSnippet())) {\n            // no quick suggestion when in snippet mode\n            return;\n        }\n        this.cancel();\n        this._triggerQuickSuggest.cancelAndSet(() => {\n            if (this._triggerState !== undefined) {\n                return;\n            }\n            if (!LineContext.shouldAutoTrigger(this._editor)) {\n                return;\n            }\n            if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            const pos = this._editor.getPosition();\n            // validate enabled now\n            const config = this._editor.getOption(89 /* EditorOption.quickSuggestions */);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                return;\n            }\n            if (!QuickSuggestionsOptions.isAllOn(config)) {\n                // Check the type of the token that triggered this\n                model.tokenization.tokenizeIfCheap(pos.lineNumber);\n                const lineTokens = model.tokenization.getLineTokens(pos.lineNumber);\n                const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\n                if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'on') {\n                    return;\n                }\n            }\n            if (!canShowQuickSuggest(this._editor, this._contextKeyService, this._configurationService)) {\n                // do not trigger quick suggestions if inline suggestions are shown\n                return;\n            }\n            if (!this._languageFeaturesService.completionProvider.has(model)) {\n                return;\n            }\n            // we made it till here -> trigger now\n            this.trigger({ auto: true });\n        }, this._editor.getOption(90 /* EditorOption.quickSuggestionsDelay */));\n    }\n    _refilterCompletionItems() {\n        assertType(this._editor.hasModel());\n        assertType(this._triggerState !== undefined);\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const ctx = new LineContext(model, position, { ...this._triggerState, refilter: true });\n        this._onNewContext(ctx);\n    }\n    trigger(options) {\n        var _a, _b, _c, _d, _e, _f;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const ctx = new LineContext(model, this._editor.getPosition(), options);\n        // Cancel previous requests, change state & update UI\n        this.cancel(options.retrigger);\n        this._triggerState = options;\n        this._onDidTrigger.fire({ auto: options.auto, shy: (_a = options.shy) !== null && _a !== void 0 ? _a : false, position: this._editor.getPosition() });\n        // Capture context when request was sent\n        this._context = ctx;\n        // Build context for request\n        let suggestCtx = { triggerKind: (_b = options.triggerKind) !== null && _b !== void 0 ? _b : 0 /* CompletionTriggerKind.Invoke */ };\n        if (options.triggerCharacter) {\n            suggestCtx = {\n                triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                triggerCharacter: options.triggerCharacter\n            };\n        }\n        this._requestToken = new CancellationTokenSource();\n        // kind filter and snippet sort rules\n        const snippetSuggestions = this._editor.getOption(112 /* EditorOption.snippetSuggestions */);\n        let snippetSortOrder = 1 /* SnippetSortOrder.Inline */;\n        switch (snippetSuggestions) {\n            case 'top':\n                snippetSortOrder = 0 /* SnippetSortOrder.Top */;\n                break;\n            // \t\u2193 that's the default anyways...\n            // case 'inline':\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\n            // \tbreak;\n            case 'bottom':\n                snippetSortOrder = 2 /* SnippetSortOrder.Bottom */;\n                break;\n        }\n        const { itemKind: itemKindFilter, showDeprecated } = SuggestModel_1.createSuggestFilter(this._editor);\n        const completionOptions = new CompletionOptions(snippetSortOrder, (_d = (_c = options.completionOptions) === null || _c === void 0 ? void 0 : _c.kindFilter) !== null && _d !== void 0 ? _d : itemKindFilter, (_e = options.completionOptions) === null || _e === void 0 ? void 0 : _e.providerFilter, (_f = options.completionOptions) === null || _f === void 0 ? void 0 : _f.providerItemsToReuse, showDeprecated);\n        const wordDistance = WordDistance.create(this._editorWorkerService, this._editor);\n        const completions = provideSuggestionItems(this._languageFeaturesService.completionProvider, model, this._editor.getPosition(), completionOptions, suggestCtx, this._requestToken.token);\n        Promise.all([completions, wordDistance]).then(async ([completions, wordDistance]) => {\n            var _a;\n            (_a = this._requestToken) === null || _a === void 0 ? void 0 : _a.dispose();\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            let clipboardText = options === null || options === void 0 ? void 0 : options.clipboardText;\n            if (!clipboardText && completions.needsClipboard) {\n                clipboardText = await this._clipboardService.readText();\n            }\n            if (this._triggerState === undefined) {\n                return;\n            }\n            const model = this._editor.getModel();\n            // const items = completions.items;\n            // if (existing) {\n            // \tconst cmpFn = getSuggestionComparator(snippetSortOrder);\n            // \titems = items.concat(existing.items).sort(cmpFn);\n            // }\n            const ctx = new LineContext(model, this._editor.getPosition(), options);\n            const fuzzySearchOptions = {\n                ...FuzzyScoreOptions.default,\n                firstMatchCanBeWeak: !this._editor.getOption(118 /* EditorOption.suggest */).matchOnWordStartOnly\n            };\n            this._completionModel = new CompletionModel(completions.items, this._context.column, {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            }, wordDistance, this._editor.getOption(118 /* EditorOption.suggest */), this._editor.getOption(112 /* EditorOption.snippetSuggestions */), fuzzySearchOptions, clipboardText);\n            // store containers so that they can be disposed later\n            this._completionDisposables.add(completions.disposable);\n            this._onNewContext(ctx);\n            // finally report telemetry about durations\n            this._reportDurationsTelemetry(completions.durations);\n            // report invalid completions by source\n            if (!this._envService.isBuilt || this._envService.isExtensionDevelopment) {\n                for (const item of completions.items) {\n                    if (item.isInvalid) {\n                        this._logService.warn(`[suggest] did IGNORE invalid completion item from ${item.provider._debugDisplayName}`, item.completion);\n                    }\n                }\n            }\n        }).catch(onUnexpectedError);\n    }\n    _reportDurationsTelemetry(durations) {\n        if (this._telemetryGate++ % 230 !== 0) {\n            return;\n        }\n        setTimeout(() => {\n            this._telemetryService.publicLog2('suggest.durations.json', { data: JSON.stringify(durations) });\n            this._logService.debug('suggest.durations.json', durations);\n        });\n    }\n    static createSuggestFilter(editor) {\n        // kind filter and snippet sort rules\n        const result = new Set();\n        // snippet setting\n        const snippetSuggestions = editor.getOption(112 /* EditorOption.snippetSuggestions */);\n        if (snippetSuggestions === 'none') {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        // type setting\n        const suggestOptions = editor.getOption(118 /* EditorOption.suggest */);\n        if (!suggestOptions.showMethods) {\n            result.add(0 /* CompletionItemKind.Method */);\n        }\n        if (!suggestOptions.showFunctions) {\n            result.add(1 /* CompletionItemKind.Function */);\n        }\n        if (!suggestOptions.showConstructors) {\n            result.add(2 /* CompletionItemKind.Constructor */);\n        }\n        if (!suggestOptions.showFields) {\n            result.add(3 /* CompletionItemKind.Field */);\n        }\n        if (!suggestOptions.showVariables) {\n            result.add(4 /* CompletionItemKind.Variable */);\n        }\n        if (!suggestOptions.showClasses) {\n            result.add(5 /* CompletionItemKind.Class */);\n        }\n        if (!suggestOptions.showStructs) {\n            result.add(6 /* CompletionItemKind.Struct */);\n        }\n        if (!suggestOptions.showInterfaces) {\n            result.add(7 /* CompletionItemKind.Interface */);\n        }\n        if (!suggestOptions.showModules) {\n            result.add(8 /* CompletionItemKind.Module */);\n        }\n        if (!suggestOptions.showProperties) {\n            result.add(9 /* CompletionItemKind.Property */);\n        }\n        if (!suggestOptions.showEvents) {\n            result.add(10 /* CompletionItemKind.Event */);\n        }\n        if (!suggestOptions.showOperators) {\n            result.add(11 /* CompletionItemKind.Operator */);\n        }\n        if (!suggestOptions.showUnits) {\n            result.add(12 /* CompletionItemKind.Unit */);\n        }\n        if (!suggestOptions.showValues) {\n            result.add(13 /* CompletionItemKind.Value */);\n        }\n        if (!suggestOptions.showConstants) {\n            result.add(14 /* CompletionItemKind.Constant */);\n        }\n        if (!suggestOptions.showEnums) {\n            result.add(15 /* CompletionItemKind.Enum */);\n        }\n        if (!suggestOptions.showEnumMembers) {\n            result.add(16 /* CompletionItemKind.EnumMember */);\n        }\n        if (!suggestOptions.showKeywords) {\n            result.add(17 /* CompletionItemKind.Keyword */);\n        }\n        if (!suggestOptions.showWords) {\n            result.add(18 /* CompletionItemKind.Text */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(19 /* CompletionItemKind.Color */);\n        }\n        if (!suggestOptions.showFiles) {\n            result.add(20 /* CompletionItemKind.File */);\n        }\n        if (!suggestOptions.showReferences) {\n            result.add(21 /* CompletionItemKind.Reference */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(22 /* CompletionItemKind.Customcolor */);\n        }\n        if (!suggestOptions.showFolders) {\n            result.add(23 /* CompletionItemKind.Folder */);\n        }\n        if (!suggestOptions.showTypeParameters) {\n            result.add(24 /* CompletionItemKind.TypeParameter */);\n        }\n        if (!suggestOptions.showSnippets) {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        if (!suggestOptions.showUsers) {\n            result.add(25 /* CompletionItemKind.User */);\n        }\n        if (!suggestOptions.showIssues) {\n            result.add(26 /* CompletionItemKind.Issue */);\n        }\n        return { itemKind: result, showDeprecated: suggestOptions.showDeprecated };\n    }\n    _onNewContext(ctx) {\n        if (!this._context) {\n            // happens when 24x7 IntelliSense is enabled and still in its delay\n            return;\n        }\n        if (ctx.lineNumber !== this._context.lineNumber) {\n            // e.g. happens when pressing Enter while IntelliSense is computed\n            this.cancel();\n            return;\n        }\n        if (getLeadingWhitespace(ctx.leadingLineContent) !== getLeadingWhitespace(this._context.leadingLineContent)) {\n            // cancel IntelliSense when line start changes\n            // happens when the current word gets outdented\n            this.cancel();\n            return;\n        }\n        if (ctx.column < this._context.column) {\n            // typed -> moved cursor LEFT -> retrigger if still on a word\n            if (ctx.leadingWord.word) {\n                this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n            }\n            else {\n                this.cancel();\n            }\n            return;\n        }\n        if (!this._completionModel) {\n            // happens when IntelliSense is not yet computed\n            return;\n        }\n        if (ctx.leadingWord.word.length !== 0 && ctx.leadingWord.startColumn > this._context.leadingWord.startColumn) {\n            // started a new word while IntelliSense shows -> retrigger but reuse all items that we currently have\n            const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n            if (shouldAutoTrigger && this._context) {\n                // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                // suggestions to be cancelled, which causes `this._context` to be undefined\n                const map = this._completionModel.getItemsByProvider();\n                this.trigger({\n                    auto: this._context.triggerOptions.auto,\n                    retrigger: true,\n                    clipboardText: this._completionModel.clipboardText,\n                    completionOptions: { providerItemsToReuse: map }\n                });\n            }\n            return;\n        }\n        if (ctx.column > this._context.column && this._completionModel.getIncompleteProvider().size > 0 && ctx.leadingWord.word.length !== 0) {\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\n            const providerItemsToReuse = new Map();\n            const providerFilter = new Set();\n            for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                if (items.length > 0 && items[0].container.incomplete) {\n                    providerFilter.add(provider);\n                }\n                else {\n                    providerItemsToReuse.set(provider, items);\n                }\n            }\n            this.trigger({\n                auto: this._context.triggerOptions.auto,\n                triggerKind: 2 /* CompletionTriggerKind.TriggerForIncompleteCompletions */,\n                retrigger: true,\n                clipboardText: this._completionModel.clipboardText,\n                completionOptions: { providerFilter, providerItemsToReuse }\n            });\n        }\n        else {\n            // typed -> moved cursor RIGHT -> update UI\n            const oldLineContext = this._completionModel.lineContext;\n            let isFrozen = false;\n            this._completionModel.lineContext = {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            };\n            if (this._completionModel.items.length === 0) {\n                const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n                if (!this._context) {\n                    // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                    // suggestions to be cancelled, which causes `this._context` to be undefined\n                    this.cancel();\n                    return;\n                }\n                if (shouldAutoTrigger && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\n                    // retrigger when heading into a new word\n                    this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n                    return;\n                }\n                if (!this._context.triggerOptions.auto) {\n                    // freeze when IntelliSense was manually requested\n                    this._completionModel.lineContext = oldLineContext;\n                    isFrozen = this._completionModel.items.length > 0;\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\n                        // there were results before but now there aren't\n                        // and also we are not on a word anymore -> cancel\n                        this.cancel();\n                        return;\n                    }\n                }\n                else {\n                    // nothing left\n                    this.cancel();\n                    return;\n                }\n            }\n            this._onDidSuggest.fire({\n                completionModel: this._completionModel,\n                triggerOptions: ctx.triggerOptions,\n                isFrozen,\n            });\n        }\n    }\n};\nSuggestModel = SuggestModel_1 = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IClipboardService),\n    __param(3, ITelemetryService),\n    __param(4, ILogService),\n    __param(5, IContextKeyService),\n    __param(6, IConfigurationService),\n    __param(7, ILanguageFeaturesService),\n    __param(8, IEnvironmentService)\n], SuggestModel);\nexport { SuggestModel };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { binarySearch, isFalsyOrEmpty } from '../../../../base/common/arrays.js';\nimport { Range } from '../../../common/core/range.js';\nimport { BracketSelectionRangeProvider } from '../../smartSelect/browser/bracketSelections.js';\nexport class WordDistance {\n    static async create(service, editor) {\n        if (!editor.getOption(118 /* EditorOption.suggest */).localityBonus) {\n            return WordDistance.None;\n        }\n        if (!editor.hasModel()) {\n            return WordDistance.None;\n        }\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        if (!service.canComputeWordRanges(model.uri)) {\n            return WordDistance.None;\n        }\n        const [ranges] = await new BracketSelectionRangeProvider().provideSelectionRanges(model, [position]);\n        if (ranges.length === 0) {\n            return WordDistance.None;\n        }\n        const wordRanges = await service.computeWordRanges(model.uri, ranges[0].range);\n        if (!wordRanges) {\n            return WordDistance.None;\n        }\n        // remove current word\n        const wordUntilPos = model.getWordUntilPosition(position);\n        delete wordRanges[wordUntilPos.word];\n        return new class extends WordDistance {\n            distance(anchor, item) {\n                if (!position.equals(editor.getPosition())) {\n                    return 0;\n                }\n                if (item.kind === 17 /* CompletionItemKind.Keyword */) {\n                    return 2 << 20;\n                }\n                const word = typeof item.label === 'string' ? item.label : item.label.label;\n                const wordLines = wordRanges[word];\n                if (isFalsyOrEmpty(wordLines)) {\n                    return 2 << 20;\n                }\n                const idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\n                const bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\n                let blockDistance = ranges.length;\n                for (const range of ranges) {\n                    if (!Range.containsRange(range.range, bestWordRange)) {\n                        break;\n                    }\n                    blockDistance -= 1;\n                }\n                return blockDistance;\n            }\n        };\n    }\n}\nWordDistance.None = new class extends WordDistance {\n    distance() { return 0; }\n};\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nexport class BracketSelectionRangeProvider {\n    async provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            const ranges = new Map();\n            await new Promise(resolve => BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges));\n            await new Promise(resolve => BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket));\n        }\n        return result;\n    }\n    static _bracketsRightYield(resolve, round, model, pos, ranges) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findNextBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges));\n                break;\n            }\n            if (bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.bracketText;\n                // wait for closing\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // process closing\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    let list = ranges.get(key);\n                    if (!list) {\n                        list = new LinkedList();\n                        ranges.set(key, list);\n                    }\n                    list.push(bracket.range);\n                }\n            }\n            pos = bracket.range.getEndPosition();\n        }\n    }\n    static _bracketsLeftYield(resolve, round, model, pos, ranges, bucket) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findPrevBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket));\n                break;\n            }\n            if (!bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // wait for opening\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.bracketText;\n                // opening\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    const list = ranges.get(key);\n                    if (list) {\n                        const closing = list.shift();\n                        if (list.size === 0) {\n                            ranges.delete(key);\n                        }\n                        const innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\n                        const outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\n                        bucket.push({ range: innerBracket });\n                        bucket.push({ range: outerBracket });\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\n                    }\n                }\n            }\n            pos = bracket.range.getStartPosition();\n        }\n    }\n    static _addBracketLeading(model, bracket, bucket) {\n        if (bracket.startLineNumber === bracket.endLineNumber) {\n            return;\n        }\n        // xxxxxxxx {\n        //\n        // }\n        const startLine = bracket.startLineNumber;\n        const column = model.getLineFirstNonWhitespaceColumn(startLine);\n        if (column !== 0 && column !== bracket.startColumn) {\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\n        }\n        // xxxxxxxx\n        // {\n        //\n        // }\n        const aboveLine = startLine - 1;\n        if (aboveLine > 0) {\n            const column = model.getLineFirstNonWhitespaceColumn(aboveLine);\n            if (column === bracket.startColumn && column !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column), bracket.getEndPosition()) });\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\n            }\n        }\n    }\n}\nBracketSelectionRangeProvider._maxDuration = 30;\nBracketSelectionRangeProvider._maxRounds = 2;\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { quickSelect } from '../../../../base/common/arrays.js';\nimport { anyScore, fuzzyScore, FuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { compareIgnoreCase } from '../../../../base/common/strings.js';\nexport class LineContext {\n    constructor(leadingLineContent, characterCountDelta) {\n        this.leadingLineContent = leadingLineContent;\n        this.characterCountDelta = characterCountDelta;\n    }\n}\n/**\n * Sorted, filtered completion view model\n * */\nexport class CompletionModel {\n    constructor(items, column, lineContext, wordDistance, options, snippetSuggestions, fuzzyScoreOptions = FuzzyScoreOptions.default, clipboardText = undefined) {\n        this.clipboardText = clipboardText;\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\n        this._items = items;\n        this._column = column;\n        this._wordDistance = wordDistance;\n        this._options = options;\n        this._refilterKind = 1 /* Refilter.All */;\n        this._lineContext = lineContext;\n        this._fuzzyScoreOptions = fuzzyScoreOptions;\n        if (snippetSuggestions === 'top') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\n        }\n        else if (snippetSuggestions === 'bottom') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\n        }\n    }\n    get lineContext() {\n        return this._lineContext;\n    }\n    set lineContext(value) {\n        if (this._lineContext.leadingLineContent !== value.leadingLineContent\n            || this._lineContext.characterCountDelta !== value.characterCountDelta) {\n            this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Refilter.Incr */ : 1 /* Refilter.All */;\n            this._lineContext = value;\n        }\n    }\n    get items() {\n        this._ensureCachedState();\n        return this._filteredItems;\n    }\n    getItemsByProvider() {\n        this._ensureCachedState();\n        return this._itemsByProvider;\n    }\n    getIncompleteProvider() {\n        this._ensureCachedState();\n        const result = new Set();\n        for (const [provider, items] of this.getItemsByProvider()) {\n            if (items.length > 0 && items[0].container.incomplete) {\n                result.add(provider);\n            }\n        }\n        return result;\n    }\n    get stats() {\n        this._ensureCachedState();\n        return this._stats;\n    }\n    _ensureCachedState() {\n        if (this._refilterKind !== 0 /* Refilter.Nothing */) {\n            this._createCachedState();\n        }\n    }\n    _createCachedState() {\n        this._itemsByProvider = new Map();\n        const labelLengths = [];\n        const { leadingLineContent, characterCountDelta } = this._lineContext;\n        let word = '';\n        let wordLow = '';\n        // incrementally filter less\n        const source = this._refilterKind === 1 /* Refilter.All */ ? this._items : this._filteredItems;\n        const target = [];\n        // picks a score function based on the number of\n        // items that we have to score/filter and based on the\n        // user-configuration\n        const scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\n        for (let i = 0; i < source.length; i++) {\n            const item = source[i];\n            if (item.isInvalid) {\n                continue; // SKIP invalid items\n            }\n            // keep all items by their provider\n            const arr = this._itemsByProvider.get(item.provider);\n            if (arr) {\n                arr.push(item);\n            }\n            else {\n                this._itemsByProvider.set(item.provider, [item]);\n            }\n            // 'word' is that remainder of the current line that we\n            // filter and score against. In theory each suggestion uses a\n            // different word, but in practice not - that's why we cache\n            const overwriteBefore = item.position.column - item.editStart.column;\n            const wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\n            if (word.length !== wordLen) {\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\n                wordLow = word.toLowerCase();\n            }\n            // remember the word against which this item was\n            // scored\n            item.word = word;\n            if (wordLen === 0) {\n                // when there is nothing to score against, don't\n                // event try to do. Use a const rank and rely on\n                // the fallback-sort using the initial sort order.\n                // use a score of `-100` because that is out of the\n                // bound of values `fuzzyScore` will return\n                item.score = FuzzyScore.Default;\n            }\n            else {\n                // skip word characters that are whitespace until\n                // we have hit the replace range (overwriteBefore)\n                let wordPos = 0;\n                while (wordPos < overwriteBefore) {\n                    const ch = word.charCodeAt(wordPos);\n                    if (ch === 32 /* CharCode.Space */ || ch === 9 /* CharCode.Tab */) {\n                        wordPos += 1;\n                    }\n                    else {\n                        break;\n                    }\n                }\n                if (wordPos >= wordLen) {\n                    // the wordPos at which scoring starts is the whole word\n                    // and therefore the same rules as not having a word apply\n                    item.score = FuzzyScore.Default;\n                }\n                else if (typeof item.completion.filterText === 'string') {\n                    // when there is a `filterText` it must match the `word`.\n                    // if it matches we check with the label to compute highlights\n                    // and if that doesn't yield a result we have no highlights,\n                    // despite having the match\n                    const match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    if (compareIgnoreCase(item.completion.filterText, item.textLabel) === 0) {\n                        // filterText and label are actually the same -> use good highlights\n                        item.score = match;\n                    }\n                    else {\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\n                        // of the filterText-match\n                        item.score = anyScore(word, wordLow, wordPos, item.textLabel, item.labelLow, 0);\n                        item.score[0] = match[0]; // use score from filterText\n                    }\n                }\n                else {\n                    // by default match `word` against the `label`\n                    const match = scoreFn(word, wordLow, wordPos, item.textLabel, item.labelLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    item.score = match;\n                }\n            }\n            item.idx = i;\n            item.distance = this._wordDistance.distance(item.position, item.completion);\n            target.push(item);\n            // update stats\n            labelLengths.push(item.textLabel.length);\n        }\n        this._filteredItems = target.sort(this._snippetCompareFn);\n        this._refilterKind = 0 /* Refilter.Nothing */;\n        this._stats = {\n            pLabelLen: labelLengths.length ?\n                quickSelect(labelLengths.length - .85, labelLengths, (a, b) => a - b)\n                : 0\n        };\n    }\n    static _compareCompletionItems(a, b) {\n        if (a.score[0] > b.score[0]) {\n            return -1;\n        }\n        else if (a.score[0] < b.score[0]) {\n            return 1;\n        }\n        else if (a.distance < b.distance) {\n            return -1;\n        }\n        else if (a.distance > b.distance) {\n            return 1;\n        }\n        else if (a.idx < b.idx) {\n            return -1;\n        }\n        else if (a.idx > b.idx) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    static _compareCompletionItemsSnippetsDown(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n    static _compareCompletionItemsSnippetsUp(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nexport class OvertypingCapturer {\n    constructor(editor, suggestModel) {\n        this._disposables = new DisposableStore();\n        this._lastOvertyped = [];\n        this._locked = false;\n        this._disposables.add(editor.onWillType(() => {\n            if (this._locked || !editor.hasModel()) {\n                return;\n            }\n            const selections = editor.getSelections();\n            const selectionsLength = selections.length;\n            // Check if it will overtype any selections\n            let willOvertype = false;\n            for (let i = 0; i < selectionsLength; i++) {\n                if (!selections[i].isEmpty()) {\n                    willOvertype = true;\n                    break;\n                }\n            }\n            if (!willOvertype) {\n                if (this._lastOvertyped.length !== 0) {\n                    this._lastOvertyped.length = 0;\n                }\n                return;\n            }\n            this._lastOvertyped = [];\n            const model = editor.getModel();\n            for (let i = 0; i < selectionsLength; i++) {\n                const selection = selections[i];\n                // Check for overtyping capturer restrictions\n                if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\n                    return;\n                }\n                this._lastOvertyped[i] = { value: model.getValueInRange(selection), multiline: selection.startLineNumber !== selection.endLineNumber };\n            }\n        }));\n        this._disposables.add(suggestModel.onDidTrigger(e => {\n            this._locked = true;\n        }));\n        this._disposables.add(suggestModel.onDidCancel(e => {\n            this._locked = false;\n        }));\n    }\n    getLastOvertypedInfo(idx) {\n        if (idx >= 0 && idx < this._lastOvertyped.length) {\n            return this._lastOvertyped[idx];\n        }\n        return undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nOvertypingCapturer._maxSelectionLength = 51200;\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { createCancelablePromise, disposableTimeout, TimeoutTimer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter, PauseableEmitter } from '../../../../base/common/event.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './media/suggest.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { activeContrastBorder, editorForeground, editorWidgetBackground, editorWidgetBorder, listFocusHighlightForeground, listHighlightForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { canExpandCompletionItem, SuggestDetailsOverlay, SuggestDetailsWidget } from './suggestWidgetDetails.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\nimport { getListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\n/**\n * Suggest widget colors\n */\nregisterColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hcDark: editorWidgetBackground, hcLight: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nregisterColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hcDark: editorWidgetBorder, hcLight: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nconst editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hcDark: editorForeground, hcLight: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedForeground', { dark: quickInputListFocusForeground, light: quickInputListFocusForeground, hcDark: quickInputListFocusForeground, hcLight: quickInputListFocusForeground }, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedIconForeground', { dark: quickInputListFocusIconForeground, light: quickInputListFocusIconForeground, hcDark: quickInputListFocusIconForeground, hcLight: quickInputListFocusIconForeground }, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: quickInputListFocusBackground, light: quickInputListFocusBackground, hcDark: quickInputListFocusBackground, hcLight: quickInputListFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hcDark: listHighlightForeground, hcLight: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nregisterColor('editorSuggestWidget.focusHighlightForeground', { dark: listFocusHighlightForeground, light: listFocusHighlightForeground, hcDark: listFocusHighlightForeground, hcLight: listFocusHighlightForeground }, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\nregisterColor('editorSuggestWidgetStatus.foreground', { dark: transparent(editorSuggestWidgetForeground, .5), light: transparent(editorSuggestWidgetForeground, .5), hcDark: transparent(editorSuggestWidgetForeground, .5), hcLight: transparent(editorSuggestWidgetForeground, .5) }, nls.localize('editorSuggestWidgetStatusForeground', 'Foreground color of the suggest widget status.'));\nclass PersistedWidgetSize {\n    constructor(_service, editor) {\n        this._service = _service;\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n    }\n    restore() {\n        var _a;\n        const raw = (_a = this._service.get(this._key, 0 /* StorageScope.PROFILE */)) !== null && _a !== void 0 ? _a : '';\n        try {\n            const obj = JSON.parse(raw);\n            if (dom.Dimension.is(obj)) {\n                return dom.Dimension.lift(obj);\n            }\n        }\n        catch (_b) {\n            // ignore\n        }\n        return undefined;\n    }\n    store(size) {\n        this._service.store(this._key, JSON.stringify(size), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n    }\n    reset() {\n        this._service.remove(this._key, 0 /* StorageScope.PROFILE */);\n    }\n}\nlet SuggestWidget = SuggestWidget_1 = class SuggestWidget {\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n        this.editor = editor;\n        this._storageService = _storageService;\n        this._state = 0 /* State.Hidden */;\n        this._isAuto = false;\n        this._pendingLayout = new MutableDisposable();\n        this._pendingShowDetails = new MutableDisposable();\n        this._ignoreFocusEvents = false;\n        this._forceRenderingAbove = false;\n        this._explainMode = false;\n        this._showTimeout = new TimeoutTimer();\n        this._disposables = new DisposableStore();\n        this._onDidSelect = new PauseableEmitter();\n        this._onDidFocus = new PauseableEmitter();\n        this._onDidHide = new Emitter();\n        this._onDidShow = new Emitter();\n        this.onDidSelect = this._onDidSelect.event;\n        this.onDidFocus = this._onDidFocus.event;\n        this.onDidHide = this._onDidHide.event;\n        this.onDidShow = this._onDidShow.event;\n        this._onDetailsKeydown = new Emitter();\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\n        this.element = new ResizableHTMLElement();\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n        this._contentWidget = new SuggestContentWidget(this, editor);\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n        class ResizeState {\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\n                this.persistedSize = persistedSize;\n                this.currentSize = currentSize;\n                this.persistHeight = persistHeight;\n                this.persistWidth = persistWidth;\n            }\n        }\n        let state;\n        this._disposables.add(this.element.onDidWillResize(() => {\n            this._contentWidget.lockPreference();\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\n        }));\n        this._disposables.add(this.element.onDidResize(e => {\n            var _a, _b, _c, _d;\n            this._resize(e.dimension.width, e.dimension.height);\n            if (state) {\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n            }\n            if (!e.done) {\n                return;\n            }\n            if (state) {\n                // only store width or height value that have changed and also\n                // only store changes that are above a certain threshold\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\n                const threshold = Math.round(itemHeight / 2);\n                let { width, height } = this.element.size;\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n                    height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\n                }\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n                    width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\n                }\n                this._persistedSize.store(new dom.Dimension(width, height));\n            }\n            // reset working state\n            this._contentWidget.unlockPreference();\n            state = undefined;\n        }));\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n        const details = this._disposables.add(instantiationService.createInstance(SuggestDetailsWidget, this.editor));\n        details.onDidClose(this.toggleDetails, this, this._disposables);\n        this._details = new SuggestDetailsOverlay(details, this.editor);\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(118 /* EditorOption.suggest */).showIcons);\n        applyIconStyle();\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n        this._disposables.add(renderer);\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n        this._list = new List('SuggestWidget', this._listElement, {\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\n            getTemplateId: (_element) => 'suggestion'\n        }, [renderer], {\n            alwaysConsumeMouseWheel: true,\n            useShadows: false,\n            mouseSupport: false,\n            multipleSelectionSupport: false,\n            accessibilityProvider: {\n                getRole: () => 'option',\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n                getWidgetRole: () => 'listbox',\n                getAriaLabel: (item) => {\n                    let label = item.textLabel;\n                    if (typeof item.completion.label !== 'string') {\n                        const { detail, description } = item.completion.label;\n                        if (detail && description) {\n                            label = nls.localize('label.full', '{0} {1}, {2}', label, detail, description);\n                        }\n                        else if (detail) {\n                            label = nls.localize('label.detail', '{0} {1}', label, detail);\n                        }\n                        else if (description) {\n                            label = nls.localize('label.desc', '{0}, {1}', label, description);\n                        }\n                    }\n                    if (!item.isResolved || !this._isDetailsVisible()) {\n                        return label;\n                    }\n                    const { documentation, detail } = item.completion;\n                    const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\n                    return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", label, docs);\n                },\n            }\n        });\n        this._list.style(getListStyles({\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n            listInactiveFocusOutline: activeContrastBorder\n        }));\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode, suggestWidgetStatusbarMenu);\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(118 /* EditorOption.suggest */).showStatusBar);\n        applyStatusBarStyle();\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n        this._onThemeChange(_themeService.getColorTheme());\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(118 /* EditorOption.suggest */)) {\n                applyStatusBarStyle();\n                applyIconStyle();\n            }\n            if (this._completionModel && (e.hasChanged(50 /* EditorOption.fontInfo */) || e.hasChanged(119 /* EditorOption.suggestFontSize */) || e.hasChanged(120 /* EditorOption.suggestLineHeight */))) {\n                this._list.splice(0, this._list.length, this._completionModel.items);\n            }\n        }));\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetHasFocusedSuggestion = SuggestContext.HasFocusedSuggestion.bindTo(_contextKeyService);\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n            this._onDetailsKeydown.fire(e);\n        }));\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n    }\n    dispose() {\n        var _a;\n        this._details.widget.dispose();\n        this._details.dispose();\n        this._list.dispose();\n        this._status.dispose();\n        this._disposables.dispose();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._pendingLayout.dispose();\n        this._pendingShowDetails.dispose();\n        this._showTimeout.dispose();\n        this._contentWidget.dispose();\n        this.element.dispose();\n    }\n    _onEditorMouseDown(mouseEvent) {\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n            // Clicking inside details\n            this._details.widget.domNode.focus();\n        }\n        else {\n            // Clicking outside details and inside suggest\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\n                this.editor.focus();\n            }\n        }\n    }\n    _onCursorSelectionChanged() {\n        if (this._state !== 0 /* State.Hidden */) {\n            this._contentWidget.layout();\n        }\n    }\n    _onListMouseDownOrTap(e) {\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n            return;\n        }\n        // prevent stealing browser focus from the editor\n        e.browserEvent.preventDefault();\n        e.browserEvent.stopPropagation();\n        this._select(e.element, e.index);\n    }\n    _onListSelection(e) {\n        if (e.elements.length) {\n            this._select(e.elements[0], e.indexes[0]);\n        }\n    }\n    _select(item, index) {\n        const completionModel = this._completionModel;\n        if (completionModel) {\n            this._onDidSelect.fire({ item, index, model: completionModel });\n            this.editor.focus();\n        }\n    }\n    _onThemeChange(theme) {\n        this._details.widget.borderWidth = isHighContrast(theme.type) ? 2 : 1;\n    }\n    _onListFocus(e) {\n        var _a;\n        if (this._ignoreFocusEvents) {\n            return;\n        }\n        if (!e.elements.length) {\n            if (this._currentSuggestionDetails) {\n                this._currentSuggestionDetails.cancel();\n                this._currentSuggestionDetails = undefined;\n                this._focusedItem = undefined;\n            }\n            this.editor.setAriaOptions({ activeDescendant: undefined });\n            this._ctxSuggestWidgetHasFocusedSuggestion.set(false);\n            return;\n        }\n        if (!this._completionModel) {\n            return;\n        }\n        this._ctxSuggestWidgetHasFocusedSuggestion.set(true);\n        const item = e.elements[0];\n        const index = e.indexes[0];\n        if (item !== this._focusedItem) {\n            (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\n            this._currentSuggestionDetails = undefined;\n            this._focusedItem = item;\n            this._list.reveal(index);\n            this._currentSuggestionDetails = createCancelablePromise(async (token) => {\n                const loading = disposableTimeout(() => {\n                    if (this._isDetailsVisible()) {\n                        this.showDetails(true);\n                    }\n                }, 250);\n                const sub = token.onCancellationRequested(() => loading.dispose());\n                try {\n                    return await item.resolve(token);\n                }\n                finally {\n                    loading.dispose();\n                    sub.dispose();\n                }\n            });\n            this._currentSuggestionDetails.then(() => {\n                if (index >= this._list.length || item !== this._list.element(index)) {\n                    return;\n                }\n                // item can have extra information, so re-render\n                this._ignoreFocusEvents = true;\n                this._list.splice(index, 1, [item]);\n                this._list.setFocus([index]);\n                this._ignoreFocusEvents = false;\n                if (this._isDetailsVisible()) {\n                    this.showDetails(false);\n                }\n                else {\n                    this.element.domNode.classList.remove('docs-side');\n                }\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\n            }).catch(onUnexpectedError);\n        }\n        // emit an event\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\n    }\n    _setState(state) {\n        if (this._state === state) {\n            return;\n        }\n        this._state = state;\n        this.element.domNode.classList.toggle('frozen', state === 4 /* State.Frozen */);\n        this.element.domNode.classList.remove('message');\n        switch (state) {\n            case 0 /* State.Hidden */:\n                dom.hide(this._messageElement, this._listElement, this._status.element);\n                this._details.hide(true);\n                this._status.hide();\n                this._contentWidget.hide();\n                this._ctxSuggestWidgetVisible.reset();\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\n                this._ctxSuggestWidgetHasFocusedSuggestion.reset();\n                this._showTimeout.cancel();\n                this.element.domNode.classList.remove('visible');\n                this._list.splice(0, this._list.length);\n                this._focusedItem = undefined;\n                this._cappedHeight = undefined;\n                this._explainMode = false;\n                break;\n            case 1 /* State.Loading */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget_1.LOADING_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                status(SuggestWidget_1.LOADING_MESSAGE);\n                break;\n            case 2 /* State.Empty */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget_1.NO_SUGGESTIONS_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                status(SuggestWidget_1.NO_SUGGESTIONS_MESSAGE);\n                break;\n            case 3 /* State.Open */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 4 /* State.Frozen */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 5 /* State.Details */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._details.show();\n                this._show();\n                break;\n        }\n    }\n    _show() {\n        this._status.show();\n        this._contentWidget.show();\n        this._layout(this._persistedSize.restore());\n        this._ctxSuggestWidgetVisible.set(true);\n        this._showTimeout.cancelAndSet(() => {\n            this.element.domNode.classList.add('visible');\n            this._onDidShow.fire(this);\n        }, 100);\n    }\n    showTriggered(auto, delay) {\n        if (this._state !== 0 /* State.Hidden */) {\n            return;\n        }\n        this._contentWidget.setPosition(this.editor.getPosition());\n        this._isAuto = !!auto;\n        if (!this._isAuto) {\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* State.Loading */), delay);\n        }\n    }\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto, noFocus) {\n        var _a, _b;\n        this._contentWidget.setPosition(this.editor.getPosition());\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\n        this._currentSuggestionDetails = undefined;\n        if (this._completionModel !== completionModel) {\n            this._completionModel = completionModel;\n        }\n        if (isFrozen && this._state !== 2 /* State.Empty */ && this._state !== 0 /* State.Hidden */) {\n            this._setState(4 /* State.Frozen */);\n            return;\n        }\n        const visibleCount = this._completionModel.items.length;\n        const isEmpty = visibleCount === 0;\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n        if (isEmpty) {\n            this._setState(isAuto ? 0 /* State.Hidden */ : 2 /* State.Empty */);\n            this._completionModel = undefined;\n            return;\n        }\n        this._focusedItem = undefined;\n        // calling list.splice triggers focus event which this widget forwards. That can lead to\n        // suggestions being cancelled and the widget being cleared (and hidden). All this happens\n        // before revealing and focusing is done which means revealing and focusing will fail when\n        // they get run.\n        this._onDidFocus.pause();\n        this._onDidSelect.pause();\n        try {\n            this._list.splice(0, this._list.length, this._completionModel.items);\n            this._setState(isFrozen ? 4 /* State.Frozen */ : 3 /* State.Open */);\n            this._list.reveal(selectionIndex, 0);\n            this._list.setFocus(noFocus ? [] : [selectionIndex]);\n        }\n        finally {\n            this._onDidFocus.resume();\n            this._onDidSelect.resume();\n        }\n        this._pendingLayout.value = dom.runAtThisOrScheduleAtNextAnimationFrame(dom.getWindow(this.element.domNode), () => {\n            this._pendingLayout.clear();\n            this._layout(this.element.size);\n            // Reset focus border\n            this._details.widget.domNode.classList.remove('focused');\n        });\n    }\n    focusSelected() {\n        if (this._list.length > 0) {\n            this._list.setFocus([0]);\n        }\n    }\n    selectNextPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageDown();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNextPage();\n                return true;\n        }\n    }\n    selectNext() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNext(1, true);\n                return true;\n        }\n    }\n    selectLast() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollBottom();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusLast();\n                return true;\n        }\n    }\n    selectPreviousPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageUp();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPreviousPage();\n                return true;\n        }\n    }\n    selectPrevious() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPrevious(1, true);\n                return false;\n        }\n    }\n    selectFirst() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollTop();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusFirst();\n                return true;\n        }\n    }\n    getFocusedItem() {\n        if (this._state !== 0 /* State.Hidden */\n            && this._state !== 2 /* State.Empty */\n            && this._state !== 1 /* State.Loading */\n            && this._completionModel\n            && this._list.getFocus().length > 0) {\n            return {\n                item: this._list.getFocusedElements()[0],\n                index: this._list.getFocus()[0],\n                model: this._completionModel\n            };\n        }\n        return undefined;\n    }\n    toggleDetailsFocus() {\n        if (this._state === 5 /* State.Details */) {\n            this._setState(3 /* State.Open */);\n            this._details.widget.domNode.classList.remove('focused');\n        }\n        else if (this._state === 3 /* State.Open */ && this._isDetailsVisible()) {\n            this._setState(5 /* State.Details */);\n            this._details.widget.domNode.classList.add('focused');\n        }\n    }\n    toggleDetails() {\n        if (this._isDetailsVisible()) {\n            // hide details widget\n            this._pendingShowDetails.clear();\n            this._ctxSuggestWidgetDetailsVisible.set(false);\n            this._setDetailsVisible(false);\n            this._details.hide();\n            this.element.domNode.classList.remove('shows-details');\n        }\n        else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3 /* State.Open */ || this._state === 5 /* State.Details */ || this._state === 4 /* State.Frozen */)) {\n            // show details widget (iff possible)\n            this._ctxSuggestWidgetDetailsVisible.set(true);\n            this._setDetailsVisible(true);\n            this.showDetails(false);\n        }\n    }\n    showDetails(loading) {\n        this._pendingShowDetails.value = dom.runAtThisOrScheduleAtNextAnimationFrame(dom.getWindow(this.element.domNode), () => {\n            this._pendingShowDetails.clear();\n            this._details.show();\n            if (loading) {\n                this._details.widget.renderLoading();\n            }\n            else {\n                this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n            }\n            if (!this._details.widget.isEmpty) {\n                this._positionDetails();\n                this.element.domNode.classList.add('shows-details');\n            }\n            else {\n                this._details.hide();\n            }\n            this.editor.focus();\n        });\n    }\n    toggleExplainMode() {\n        if (this._list.getFocusedElements()[0]) {\n            this._explainMode = !this._explainMode;\n            if (!this._isDetailsVisible()) {\n                this.toggleDetails();\n            }\n            else {\n                this.showDetails(false);\n            }\n        }\n    }\n    resetPersistedSize() {\n        this._persistedSize.reset();\n    }\n    hideWidget() {\n        var _a;\n        this._pendingLayout.clear();\n        this._pendingShowDetails.clear();\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._setState(0 /* State.Hidden */);\n        this._onDidHide.fire(this);\n        this.element.clearSashHoverState();\n        // ensure that a reasonable widget height is persisted so that\n        // accidential \"resize-to-single-items\" cases aren't happening\n        const dim = this._persistedSize.restore();\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n        if (dim && dim.height < minPersistedHeight) {\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n        }\n    }\n    isFrozen() {\n        return this._state === 4 /* State.Frozen */;\n    }\n    _afterRender(position) {\n        if (position === null) {\n            if (this._isDetailsVisible()) {\n                this._details.hide(); //todo@jrieken soft-hide\n            }\n            return;\n        }\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // no special positioning when widget isn't showing list\n            return;\n        }\n        if (this._isDetailsVisible() && !this._details.widget.isEmpty) {\n            this._details.show();\n        }\n        this._positionDetails();\n    }\n    _layout(size) {\n        var _a, _b, _c;\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (!this.editor.getDomNode()) {\n            // happens when running tests\n            return;\n        }\n        const bodyBox = dom.getClientArea(this.element.domNode.ownerDocument.body);\n        const info = this.getLayoutInfo();\n        if (!size) {\n            size = info.defaultSize;\n        }\n        let height = size.height;\n        let width = size.width;\n        // status bar\n        this._status.element.style.height = `${info.itemHeight}px`;\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // showing a message only\n            height = info.itemHeight + info.borderHeight;\n            width = info.defaultSize.width / 2;\n            this.element.enableSashes(false, false, false, false);\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n            this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n        else {\n            // showing items\n            // width math\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n            if (width > maxWidth) {\n                width = maxWidth;\n            }\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n            // height math\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n            const minHeight = info.itemHeight + info.statusBarHeight;\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n            const availableSpaceAbove = editorBox.top + cursorBox.top - info.verticalPadding;\n            const maxHeightAbove = Math.min(availableSpaceAbove, fullHeight);\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n            if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\n                // Restore the old (wanted) height when the current\n                // height is capped to fit\n                height = this._cappedHeight.wanted;\n            }\n            if (height < minHeight) {\n                height = minHeight;\n            }\n            if (height > maxHeight) {\n                height = maxHeight;\n            }\n            const forceRenderingAboveRequiredSpace = 150;\n            if (height > maxHeightBelow || (this._forceRenderingAbove && availableSpaceAbove > forceRenderingAboveRequiredSpace)) {\n                this._contentWidget.setPreference(1 /* ContentWidgetPositionPreference.ABOVE */);\n                this.element.enableSashes(true, true, false, false);\n                maxHeight = maxHeightAbove;\n            }\n            else {\n                this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n                this.element.enableSashes(false, true, true, false);\n                maxHeight = maxHeightBelow;\n            }\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n            this.element.minSize = new dom.Dimension(220, minHeight);\n            // Know when the height was capped to fit and remember\n            // the wanted height for later. This is required when going\n            // left to widen suggestions.\n            this._cappedHeight = height === fullHeight\n                ? { wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height, capped: height }\n                : undefined;\n        }\n        this._resize(width, height);\n    }\n    _resize(width, height) {\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\n        width = Math.min(maxWidth, width);\n        height = Math.min(maxHeight, height);\n        const { statusBarHeight } = this.getLayoutInfo();\n        this._list.layout(height - statusBarHeight, width);\n        this._listElement.style.height = `${height - statusBarHeight}px`;\n        this.element.layout(height, width);\n        this._contentWidget.layout();\n        this._positionDetails();\n    }\n    _positionDetails() {\n        var _a;\n        if (this._isDetailsVisible()) {\n            this._details.placeAtAnchor(this.element.domNode, ((_a = this._contentWidget.getPosition()) === null || _a === void 0 ? void 0 : _a.preference[0]) === 2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n    }\n    getLayoutInfo() {\n        const fontInfo = this.editor.getOption(50 /* EditorOption.fontInfo */);\n        const itemHeight = clamp(this.editor.getOption(120 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\n        const statusBarHeight = !this.editor.getOption(118 /* EditorOption.suggest */).showStatusBar || this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */ ? 0 : itemHeight;\n        const borderWidth = this._details.widget.borderWidth;\n        const borderHeight = 2 * borderWidth;\n        return {\n            itemHeight,\n            statusBarHeight,\n            borderWidth,\n            borderHeight,\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n            verticalPadding: 22,\n            horizontalPadding: 14,\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n        };\n    }\n    _isDetailsVisible() {\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* StorageScope.PROFILE */, false);\n    }\n    _setDetailsVisible(value) {\n        this._storageService.store('expandSuggestionDocs', value, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n    }\n    forceRenderingAbove() {\n        if (!this._forceRenderingAbove) {\n            this._forceRenderingAbove = true;\n            this._layout(this._persistedSize.restore());\n        }\n    }\n    stopForceRenderingAbove() {\n        this._forceRenderingAbove = false;\n    }\n};\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\nSuggestWidget = SuggestWidget_1 = __decorate([\n    __param(1, IStorageService),\n    __param(2, IContextKeyService),\n    __param(3, IThemeService),\n    __param(4, IInstantiationService)\n], SuggestWidget);\nexport { SuggestWidget };\nexport class SuggestContentWidget {\n    constructor(_widget, _editor) {\n        this._widget = _widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._preferenceLocked = false;\n        this._added = false;\n        this._hidden = false;\n    }\n    dispose() {\n        if (this._added) {\n            this._added = false;\n            this._editor.removeContentWidget(this);\n        }\n    }\n    getId() {\n        return 'editor.widget.suggestWidget';\n    }\n    getDomNode() {\n        return this._widget.element.domNode;\n    }\n    show() {\n        this._hidden = false;\n        if (!this._added) {\n            this._added = true;\n            this._editor.addContentWidget(this);\n        }\n    }\n    hide() {\n        if (!this._hidden) {\n            this._hidden = true;\n            this.layout();\n        }\n    }\n    layout() {\n        this._editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this._hidden || !this._position || !this._preference) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [this._preference]\n        };\n    }\n    beforeRender() {\n        const { height, width } = this._widget.element.size;\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n    }\n    afterRender(position) {\n        this._widget._afterRender(position);\n    }\n    setPreference(preference) {\n        if (!this._preferenceLocked) {\n            this._preference = preference;\n        }\n    }\n    lockPreference() {\n        this._preferenceLocked = true;\n    }\n    unlockPreference() {\n        this._preferenceLocked = false;\n    }\n    setPosition(position) {\n        this._position = position;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            this.label.textContent = localize({ key: 'content', comment: ['A label', 'A keybinding'] }, '{0} ({1})', this._action.label, StatusBarViewItem.symbolPrintEnter(kb));\n        }\n    }\n    static symbolPrintEnter(kb) {\n        var _a;\n        return (_a = kb.getLabel()) === null || _a === void 0 ? void 0 : _a.replace(/\\benter\\b/gi, '\\u23CE');\n    }\n}\nlet SuggestWidgetStatus = class SuggestWidgetStatus {\n    constructor(container, _menuId, instantiationService, _menuService, _contextKeyService) {\n        this._menuId = _menuId;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._menuDisposables = new DisposableStore();\n        this.element = dom.append(container, dom.$('.suggest-status-bar'));\n        const actionViewItemProvider = (action => {\n            return action instanceof MenuItemAction ? instantiationService.createInstance(StatusBarViewItem, action, undefined) : undefined;\n        });\n        this._leftActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._rightActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._leftActions.domNode.classList.add('left');\n        this._rightActions.domNode.classList.add('right');\n    }\n    dispose() {\n        this._menuDisposables.dispose();\n        this._leftActions.dispose();\n        this._rightActions.dispose();\n        this.element.remove();\n    }\n    show() {\n        const menu = this._menuService.createMenu(this._menuId, this._contextKeyService);\n        const renderMenu = () => {\n            const left = [];\n            const right = [];\n            for (const [group, actions] of menu.getActions()) {\n                if (group === 'left') {\n                    left.push(...actions);\n                }\n                else {\n                    right.push(...actions);\n                }\n            }\n            this._leftActions.clear();\n            this._leftActions.push(left);\n            this._rightActions.clear();\n            this._rightActions.push(right);\n        };\n        this._menuDisposables.add(menu.onDidChange(() => renderMenu()));\n        this._menuDisposables.add(menu);\n    }\n    hide() {\n        this._menuDisposables.clear();\n    }\n};\nSuggestWidgetStatus = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, IMenuService),\n    __param(4, IContextKeyService)\n], SuggestWidgetStatus);\nexport { SuggestWidgetStatus };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport * as nls from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport function canExpandCompletionItem(item) {\n    return !!item && Boolean(item.completion.documentation || item.completion.detail && item.completion.detail !== item.completion.label);\n}\nlet SuggestDetailsWidget = class SuggestDetailsWidget {\n    constructor(_editor, instaService) {\n        this._editor = _editor;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        this._onDidChangeContents = new Emitter();\n        this.onDidChangeContents = this._onDidChangeContents.event;\n        this._disposables = new DisposableStore();\n        this._renderDisposeable = new DisposableStore();\n        this._borderWidth = 1;\n        this._size = new dom.Dimension(330, 0);\n        this.domNode = dom.$('.suggest-details');\n        this.domNode.classList.add('no-docs');\n        this._markdownRenderer = instaService.createInstance(MarkdownRenderer, { editor: _editor });\n        this._body = dom.$('.body');\n        this._scrollbar = new DomScrollableElement(this._body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        dom.append(this.domNode, this._scrollbar.getDomNode());\n        this._disposables.add(this._scrollbar);\n        this._header = dom.append(this._body, dom.$('.header'));\n        this._close = dom.append(this._header, dom.$('span' + ThemeIcon.asCSSSelector(Codicon.close)));\n        this._close.title = nls.localize('details.close', \"Close\");\n        this._type = dom.append(this._header, dom.$('p.type'));\n        this._docs = dom.append(this._body, dom.$('p.docs'));\n        this._configureFont();\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._configureFont();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._renderDisposeable.dispose();\n    }\n    _configureFont() {\n        const options = this._editor.getOptions();\n        const fontInfo = options.get(50 /* EditorOption.fontInfo */);\n        const fontFamily = fontInfo.getMassagedFontFamily();\n        const fontSize = options.get(119 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n        const lineHeight = options.get(120 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n        const fontWeight = fontInfo.fontWeight;\n        const fontSizePx = `${fontSize}px`;\n        const lineHeightPx = `${lineHeight}px`;\n        this.domNode.style.fontSize = fontSizePx;\n        this.domNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this.domNode.style.fontWeight = fontWeight;\n        this.domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\n        this._type.style.fontFamily = fontFamily;\n        this._close.style.height = lineHeightPx;\n        this._close.style.width = lineHeightPx;\n    }\n    getLayoutInfo() {\n        const lineHeight = this._editor.getOption(120 /* EditorOption.suggestLineHeight */) || this._editor.getOption(50 /* EditorOption.fontInfo */).lineHeight;\n        const borderWidth = this._borderWidth;\n        const borderHeight = borderWidth * 2;\n        return {\n            lineHeight,\n            borderWidth,\n            borderHeight,\n            verticalPadding: 22,\n            horizontalPadding: 14\n        };\n    }\n    renderLoading() {\n        this._type.textContent = nls.localize('loading', \"Loading...\");\n        this._docs.textContent = '';\n        this.domNode.classList.remove('no-docs', 'no-type');\n        this.layout(this.size.width, this.getLayoutInfo().lineHeight * 2);\n        this._onDidChangeContents.fire(this);\n    }\n    renderItem(item, explainMode) {\n        var _a, _b;\n        this._renderDisposeable.clear();\n        let { detail, documentation } = item.completion;\n        if (explainMode) {\n            let md = '';\n            md += `score: ${item.score[0]}\\n`;\n            md += `prefix: ${(_a = item.word) !== null && _a !== void 0 ? _a : '(no prefix)'}\\n`;\n            md += `word: ${item.completion.filterText ? item.completion.filterText + ' (filterText)' : item.textLabel}\\n`;\n            md += `distance: ${item.distance} (localityBonus-setting)\\n`;\n            md += `index: ${item.idx}, based on ${item.completion.sortText && `sortText: \"${item.completion.sortText}\"` || 'label'}\\n`;\n            md += `commit_chars: ${(_b = item.completion.commitCharacters) === null || _b === void 0 ? void 0 : _b.join('')}\\n`;\n            documentation = new MarkdownString().appendCodeblock('empty', md);\n            detail = `Provider: ${item.provider._debugDisplayName}`;\n        }\n        if (!explainMode && !canExpandCompletionItem(item)) {\n            this.clearContents();\n            return;\n        }\n        this.domNode.classList.remove('no-docs', 'no-type');\n        // --- details\n        if (detail) {\n            const cappedDetail = detail.length > 100000 ? `${detail.substr(0, 100000)}\u2026` : detail;\n            this._type.textContent = cappedDetail;\n            this._type.title = cappedDetail;\n            dom.show(this._type);\n            this._type.classList.toggle('auto-wrap', !/\\r?\\n^\\s+/gmi.test(cappedDetail));\n        }\n        else {\n            dom.clearNode(this._type);\n            this._type.title = '';\n            dom.hide(this._type);\n            this.domNode.classList.add('no-type');\n        }\n        // --- documentation\n        dom.clearNode(this._docs);\n        if (typeof documentation === 'string') {\n            this._docs.classList.remove('markdown-docs');\n            this._docs.textContent = documentation;\n        }\n        else if (documentation) {\n            this._docs.classList.add('markdown-docs');\n            dom.clearNode(this._docs);\n            const renderedContents = this._markdownRenderer.render(documentation);\n            this._docs.appendChild(renderedContents.element);\n            this._renderDisposeable.add(renderedContents);\n            this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(() => {\n                this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n                this._onDidChangeContents.fire(this);\n            }));\n        }\n        this.domNode.style.userSelect = 'text';\n        this.domNode.tabIndex = -1;\n        this._close.onmousedown = e => {\n            e.preventDefault();\n            e.stopPropagation();\n        };\n        this._close.onclick = e => {\n            e.preventDefault();\n            e.stopPropagation();\n            this._onDidClose.fire();\n        };\n        this._body.scrollTop = 0;\n        this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n        this._onDidChangeContents.fire(this);\n    }\n    clearContents() {\n        this.domNode.classList.add('no-docs');\n        this._type.textContent = '';\n        this._docs.textContent = '';\n    }\n    get isEmpty() {\n        return this.domNode.classList.contains('no-docs');\n    }\n    get size() {\n        return this._size;\n    }\n    layout(width, height) {\n        const newSize = new dom.Dimension(width, height);\n        if (!dom.Dimension.equals(newSize, this._size)) {\n            this._size = newSize;\n            dom.size(this.domNode, width, height);\n        }\n        this._scrollbar.scanDomNode();\n    }\n    scrollDown(much = 8) {\n        this._body.scrollTop += much;\n    }\n    scrollUp(much = 8) {\n        this._body.scrollTop -= much;\n    }\n    scrollTop() {\n        this._body.scrollTop = 0;\n    }\n    scrollBottom() {\n        this._body.scrollTop = this._body.scrollHeight;\n    }\n    pageDown() {\n        this.scrollDown(80);\n    }\n    pageUp() {\n        this.scrollUp(80);\n    }\n    set borderWidth(width) {\n        this._borderWidth = width;\n    }\n    get borderWidth() {\n        return this._borderWidth;\n    }\n};\nSuggestDetailsWidget = __decorate([\n    __param(1, IInstantiationService)\n], SuggestDetailsWidget);\nexport { SuggestDetailsWidget };\nexport class SuggestDetailsOverlay {\n    constructor(widget, _editor) {\n        this.widget = widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this._disposables = new DisposableStore();\n        this._added = false;\n        this._preferAlignAtTop = true;\n        this._resizable = new ResizableHTMLElement();\n        this._resizable.domNode.classList.add('suggest-details-container');\n        this._resizable.domNode.appendChild(widget.domNode);\n        this._resizable.enableSashes(false, true, true, false);\n        let topLeftNow;\n        let sizeNow;\n        let deltaTop = 0;\n        let deltaLeft = 0;\n        this._disposables.add(this._resizable.onDidWillResize(() => {\n            topLeftNow = this._topLeft;\n            sizeNow = this._resizable.size;\n        }));\n        this._disposables.add(this._resizable.onDidResize(e => {\n            if (topLeftNow && sizeNow) {\n                this.widget.layout(e.dimension.width, e.dimension.height);\n                let updateTopLeft = false;\n                if (e.west) {\n                    deltaLeft = sizeNow.width - e.dimension.width;\n                    updateTopLeft = true;\n                }\n                if (e.north) {\n                    deltaTop = sizeNow.height - e.dimension.height;\n                    updateTopLeft = true;\n                }\n                if (updateTopLeft) {\n                    this._applyTopLeft({\n                        top: topLeftNow.top + deltaTop,\n                        left: topLeftNow.left + deltaLeft,\n                    });\n                }\n            }\n            if (e.done) {\n                topLeftNow = undefined;\n                sizeNow = undefined;\n                deltaTop = 0;\n                deltaLeft = 0;\n                this._userSize = e.dimension;\n            }\n        }));\n        this._disposables.add(this.widget.onDidChangeContents(() => {\n            var _a;\n            if (this._anchorBox) {\n                this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, this._preferAlignAtTop);\n            }\n        }));\n    }\n    dispose() {\n        this._resizable.dispose();\n        this._disposables.dispose();\n        this.hide();\n    }\n    getId() {\n        return 'suggest.details';\n    }\n    getDomNode() {\n        return this._resizable.domNode;\n    }\n    getPosition() {\n        return this._topLeft ? { preference: this._topLeft } : null;\n    }\n    show() {\n        if (!this._added) {\n            this._editor.addOverlayWidget(this);\n            this._added = true;\n        }\n    }\n    hide(sessionEnded = false) {\n        this._resizable.clearSashHoverState();\n        if (this._added) {\n            this._editor.removeOverlayWidget(this);\n            this._added = false;\n            this._anchorBox = undefined;\n            this._topLeft = undefined;\n        }\n        if (sessionEnded) {\n            this._userSize = undefined;\n            this.widget.clearContents();\n        }\n    }\n    placeAtAnchor(anchor, preferAlignAtTop) {\n        var _a;\n        const anchorBox = anchor.getBoundingClientRect();\n        this._anchorBox = anchorBox;\n        this._preferAlignAtTop = preferAlignAtTop;\n        this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size, preferAlignAtTop);\n    }\n    _placeAtAnchor(anchorBox, size, preferAlignAtTop) {\n        var _a;\n        const bodyBox = dom.getClientArea(this.getDomNode().ownerDocument.body);\n        const info = this.widget.getLayoutInfo();\n        const defaultMinSize = new dom.Dimension(220, 2 * info.lineHeight);\n        const defaultTop = anchorBox.top;\n        // EAST\n        const eastPlacement = (function () {\n            const width = bodyBox.width - (anchorBox.left + anchorBox.width + info.borderWidth + info.horizontalPadding);\n            const left = -info.borderWidth + anchorBox.left + anchorBox.width;\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // WEST\n        const westPlacement = (function () {\n            const width = anchorBox.left - info.borderWidth - info.horizontalPadding;\n            const left = Math.max(info.horizontalPadding, anchorBox.left - size.width - info.borderWidth);\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // SOUTH\n        const southPacement = (function () {\n            const left = anchorBox.left;\n            const top = -info.borderWidth + anchorBox.top + anchorBox.height;\n            const maxSizeBottom = new dom.Dimension(anchorBox.width - info.borderHeight, bodyBox.height - anchorBox.top - anchorBox.height - info.verticalPadding);\n            return { top, left, fit: maxSizeBottom.height - size.height, maxSizeBottom, maxSizeTop: maxSizeBottom, minSize: defaultMinSize.with(maxSizeBottom.width) };\n        })();\n        // take first placement that fits or the first with \"least bad\" fit\n        const placements = [eastPlacement, westPlacement, southPacement];\n        const placement = (_a = placements.find(p => p.fit >= 0)) !== null && _a !== void 0 ? _a : placements.sort((a, b) => b.fit - a.fit)[0];\n        // top/bottom placement\n        const bottom = anchorBox.top + anchorBox.height - info.borderHeight;\n        let alignAtTop;\n        let height = size.height;\n        const maxHeight = Math.max(placement.maxSizeTop.height, placement.maxSizeBottom.height);\n        if (height > maxHeight) {\n            height = maxHeight;\n        }\n        let maxSize;\n        if (preferAlignAtTop) {\n            if (height <= placement.maxSizeTop.height) {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n            else {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n        }\n        else {\n            if (height <= placement.maxSizeBottom.height) {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n            else {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n        }\n        let { top, left } = placement;\n        if (!alignAtTop && height > anchorBox.height) {\n            top = bottom - height;\n        }\n        const editorDomNode = this._editor.getDomNode();\n        if (editorDomNode) {\n            // get bounding rectangle of the suggest widget relative to the editor\n            const editorBoundingBox = editorDomNode.getBoundingClientRect();\n            top -= editorBoundingBox.top;\n            left -= editorBoundingBox.left;\n        }\n        this._applyTopLeft({ left, top });\n        this._resizable.enableSashes(!alignAtTop, placement === eastPlacement, alignAtTop, placement !== eastPlacement);\n        this._resizable.minSize = placement.minSize;\n        this._resizable.maxSize = maxSize;\n        this._resizable.layout(height, Math.min(maxSize.width, size.width));\n        this.widget.layout(this._resizable.size.width, this._resizable.size.height);\n    }\n    _applyTopLeft(topLeft) {\n        this._topLeft = topLeft;\n        this._editor.layoutOverlayWidget(this);\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar _a;\nimport { $, append, hide, show } from '../../../../base/browser/dom.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { createMatches } from '../../../../base/common/filters.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { getIconClasses } from '../../../common/services/getIconClasses.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport * as nls from '../../../../nls.js';\nimport { FileKind } from '../../../../platform/files/common/files.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { canExpandCompletionItem } from './suggestWidgetDetails.js';\nexport function getAriaId(index) {\n    return `suggest-aria-id:${index}`;\n}\nconst suggestMoreInfoIcon = registerIcon('suggest-more-info', Codicon.chevronRight, nls.localize('suggestMoreInfoIcon', 'Icon for more information in the suggest widget.'));\nconst _completionItemColor = new (_a = class ColorExtractor {\n        extract(item, out) {\n            if (item.textLabel.match(_a._regexStrict)) {\n                out[0] = item.textLabel;\n                return true;\n            }\n            if (item.completion.detail && item.completion.detail.match(_a._regexStrict)) {\n                out[0] = item.completion.detail;\n                return true;\n            }\n            if (item.completion.documentation) {\n                const value = typeof item.completion.documentation === 'string'\n                    ? item.completion.documentation\n                    : item.completion.documentation.value;\n                const match = _a._regexRelaxed.exec(value);\n                if (match && (match.index === 0 || match.index + match[0].length === value.length)) {\n                    out[0] = match[0];\n                    return true;\n                }\n            }\n            return false;\n        }\n    },\n    _a._regexRelaxed = /(#([\\da-fA-F]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))/,\n    _a._regexStrict = new RegExp(`^${_a._regexRelaxed.source}$`, 'i'),\n    _a);\nlet ItemRenderer = class ItemRenderer {\n    constructor(_editor, _modelService, _languageService, _themeService) {\n        this._editor = _editor;\n        this._modelService = _modelService;\n        this._languageService = _languageService;\n        this._themeService = _themeService;\n        this._onDidToggleDetails = new Emitter();\n        this.onDidToggleDetails = this._onDidToggleDetails.event;\n        this.templateId = 'suggestion';\n    }\n    dispose() {\n        this._onDidToggleDetails.dispose();\n    }\n    renderTemplate(container) {\n        const disposables = new DisposableStore();\n        const root = container;\n        root.classList.add('show-file-icons');\n        const icon = append(container, $('.icon'));\n        const colorspan = append(icon, $('span.colorspan'));\n        const text = append(container, $('.contents'));\n        const main = append(text, $('.main'));\n        const iconContainer = append(main, $('.icon-label.codicon'));\n        const left = append(main, $('span.left'));\n        const right = append(main, $('span.right'));\n        const iconLabel = new IconLabel(left, { supportHighlights: true, supportIcons: true });\n        disposables.add(iconLabel);\n        const parametersLabel = append(left, $('span.signature-label'));\n        const qualifierLabel = append(left, $('span.qualifier-label'));\n        const detailsLabel = append(right, $('span.details-label'));\n        const readMore = append(right, $('span.readMore' + ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));\n        readMore.title = nls.localize('readMore', \"Read More\");\n        const configureFont = () => {\n            const options = this._editor.getOptions();\n            const fontInfo = options.get(50 /* EditorOption.fontInfo */);\n            const fontFamily = fontInfo.getMassagedFontFamily();\n            const fontFeatureSettings = fontInfo.fontFeatureSettings;\n            const fontSize = options.get(119 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n            const lineHeight = options.get(120 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n            const fontWeight = fontInfo.fontWeight;\n            const letterSpacing = fontInfo.letterSpacing;\n            const fontSizePx = `${fontSize}px`;\n            const lineHeightPx = `${lineHeight}px`;\n            const letterSpacingPx = `${letterSpacing}px`;\n            root.style.fontSize = fontSizePx;\n            root.style.fontWeight = fontWeight;\n            root.style.letterSpacing = letterSpacingPx;\n            main.style.fontFamily = fontFamily;\n            main.style.fontFeatureSettings = fontFeatureSettings;\n            main.style.lineHeight = lineHeightPx;\n            icon.style.height = lineHeightPx;\n            icon.style.width = lineHeightPx;\n            readMore.style.height = lineHeightPx;\n            readMore.style.width = lineHeightPx;\n        };\n        return { root, left, right, icon, colorspan, iconLabel, iconContainer, parametersLabel, qualifierLabel, detailsLabel, readMore, disposables, configureFont };\n    }\n    renderElement(element, index, data) {\n        data.configureFont();\n        const { completion } = element;\n        data.root.id = getAriaId(index);\n        data.colorspan.style.backgroundColor = '';\n        const labelOptions = {\n            labelEscapeNewLines: true,\n            matches: createMatches(element.score)\n        };\n        const color = [];\n        if (completion.kind === 19 /* CompletionItemKind.Color */ && _completionItemColor.extract(element, color)) {\n            // special logic for 'color' completion items\n            data.icon.className = 'icon customcolor';\n            data.iconContainer.className = 'icon hide';\n            data.colorspan.style.backgroundColor = color[0];\n        }\n        else if (completion.kind === 20 /* CompletionItemKind.File */ && this._themeService.getFileIconTheme().hasFileIcons) {\n            // special logic for 'file' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            const labelClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FILE);\n            const detailClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FILE);\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\n        }\n        else if (completion.kind === 23 /* CompletionItemKind.Folder */ && this._themeService.getFileIconTheme().hasFolderIcons) {\n            // special logic for 'folder' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            labelOptions.extraClasses = [\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FOLDER),\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FOLDER)\n            ].flat();\n        }\n        else {\n            // normal icon\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = '';\n            data.iconContainer.classList.add('suggest-icon', ...ThemeIcon.asClassNameArray(CompletionItemKinds.toIcon(completion.kind)));\n        }\n        if (completion.tags && completion.tags.indexOf(1 /* CompletionItemTag.Deprecated */) >= 0) {\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\n            labelOptions.matches = [];\n        }\n        data.iconLabel.setLabel(element.textLabel, undefined, labelOptions);\n        if (typeof completion.label === 'string') {\n            data.parametersLabel.textContent = '';\n            data.detailsLabel.textContent = stripNewLines(completion.detail || '');\n            data.root.classList.add('string-label');\n        }\n        else {\n            data.parametersLabel.textContent = stripNewLines(completion.label.detail || '');\n            data.detailsLabel.textContent = stripNewLines(completion.label.description || '');\n            data.root.classList.remove('string-label');\n        }\n        if (this._editor.getOption(118 /* EditorOption.suggest */).showInlineDetails) {\n            show(data.detailsLabel);\n        }\n        else {\n            hide(data.detailsLabel);\n        }\n        if (canExpandCompletionItem(element)) {\n            data.right.classList.add('can-expand-details');\n            show(data.readMore);\n            data.readMore.onmousedown = e => {\n                e.stopPropagation();\n                e.preventDefault();\n            };\n            data.readMore.onclick = e => {\n                e.stopPropagation();\n                e.preventDefault();\n                this._onDidToggleDetails.fire();\n            };\n        }\n        else {\n            data.right.classList.remove('can-expand-details');\n            hide(data.readMore);\n            data.readMore.onmousedown = null;\n            data.readMore.onclick = null;\n        }\n    }\n    disposeTemplate(templateData) {\n        templateData.disposables.dispose();\n    }\n};\nItemRenderer = __decorate([\n    __param(1, IModelService),\n    __param(2, ILanguageService),\n    __param(3, IThemeService)\n], ItemRenderer);\nexport { ItemRenderer };\nfunction stripNewLines(str) {\n    return str.replace(/\\r\\n|\\r|\\n/g, '');\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Schemas } from '../../../base/common/network.js';\nimport { DataUri } from '../../../base/common/resources.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../languages/modesRegistry.js';\nimport { FileKind } from '../../../platform/files/common/files.js';\nconst fileIconDirectoryRegex = /(?:\\/|^)(?:([^\\/]+)\\/)?([^\\/]+)$/;\nexport function getIconClasses(modelService, languageService, resource, fileKind, icon) {\n    if (icon) {\n        return [`codicon-${icon.id}`, 'predefined-file-icon'];\n    }\n    // we always set these base classes even if we do not have a path\n    const classes = fileKind === FileKind.ROOT_FOLDER ? ['rootfolder-icon'] : fileKind === FileKind.FOLDER ? ['folder-icon'] : ['file-icon'];\n    if (resource) {\n        // Get the path and name of the resource. For data-URIs, we need to parse specially\n        let name;\n        if (resource.scheme === Schemas.data) {\n            const metadata = DataUri.parseMetaData(resource);\n            name = metadata.get(DataUri.META_DATA_LABEL);\n        }\n        else {\n            const match = resource.path.match(fileIconDirectoryRegex);\n            if (match) {\n                name = cssEscape(match[2].toLowerCase());\n                if (match[1]) {\n                    classes.push(`${cssEscape(match[1].toLowerCase())}-name-dir-icon`); // parent directory\n                }\n            }\n            else {\n                name = cssEscape(resource.authority.toLowerCase());\n            }\n        }\n        // Root Folders\n        if (fileKind === FileKind.ROOT_FOLDER) {\n            classes.push(`${name}-root-name-folder-icon`);\n        }\n        // Folders\n        else if (fileKind === FileKind.FOLDER) {\n            classes.push(`${name}-name-folder-icon`);\n        }\n        // Files\n        else {\n            // Name & Extension(s)\n            if (name) {\n                classes.push(`${name}-name-file-icon`);\n                classes.push(`name-file-icon`); // extra segment to increase file-name score\n                // Avoid doing an explosive combination of extensions for very long filenames\n                // (most file systems do not allow files > 255 length) with lots of `.` characters\n                // https://github.com/microsoft/vscode/issues/116199\n                if (name.length <= 255) {\n                    const dotSegments = name.split('.');\n                    for (let i = 1; i < dotSegments.length; i++) {\n                        classes.push(`${dotSegments.slice(i).join('.')}-ext-file-icon`); // add each combination of all found extensions if more than one\n                    }\n                }\n                classes.push(`ext-file-icon`); // extra segment to increase file-ext score\n            }\n            // Detected Mode\n            const detectedLanguageId = detectLanguageId(modelService, languageService, resource);\n            if (detectedLanguageId) {\n                classes.push(`${cssEscape(detectedLanguageId)}-lang-file-icon`);\n            }\n        }\n    }\n    return classes;\n}\nfunction detectLanguageId(modelService, languageService, resource) {\n    if (!resource) {\n        return null; // we need a resource at least\n    }\n    let languageId = null;\n    // Data URI: check for encoded metadata\n    if (resource.scheme === Schemas.data) {\n        const metadata = DataUri.parseMetaData(resource);\n        const mime = metadata.get(DataUri.META_DATA_MIME);\n        if (mime) {\n            languageId = languageService.getLanguageIdByMimeType(mime);\n        }\n    }\n    // Any other URI: check for model if existing\n    else {\n        const model = modelService.getModel(resource);\n        if (model) {\n            languageId = model.getLanguageId();\n        }\n    }\n    // only take if the language id is specific (aka no just plain text)\n    if (languageId && languageId !== PLAINTEXT_LANGUAGE_ID) {\n        return languageId;\n    }\n    // otherwise fallback to path based detection\n    return languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n}\nfunction cssEscape(str) {\n    return str.replace(/[\\11\\12\\14\\15\\40]/g, '/'); // HTML class names can not contain certain whitespace characters, use / instead, which doesn't exist in file names.\n}\n", "//#endregion\n//#region Utilities\nexport var FileKind;\n(function (FileKind) {\n    FileKind[FileKind[\"FILE\"] = 0] = \"FILE\";\n    FileKind[FileKind[\"FOLDER\"] = 1] = \"FOLDER\";\n    FileKind[FileKind[\"ROOT_FOLDER\"] = 2] = \"ROOT_FOLDER\";\n})(FileKind || (FileKind = {}));\n//#endregion\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable } from '../../../../base/common/observable.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { HoverForeignElementAnchor } from '../../hover/browser/hoverTypes.js';\nimport { InlineCompletionsController } from './inlineCompletionsController.js';\nimport { InlineSuggestionHintsContentWidget } from './inlineCompletionsHintsWidget.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport * as nls from '../../../../nls.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nexport class InlineCompletionsHover {\n    constructor(owner, range, controller) {\n        this.owner = owner;\n        this.range = range;\n        this.controller = controller;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet InlineCompletionsHoverParticipant = class InlineCompletionsHoverParticipant {\n    constructor(_editor, _languageService, _openerService, accessibilityService, _instantiationService, _telemetryService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this.accessibilityService = accessibilityService;\n        this._instantiationService = _instantiationService;\n        this._telemetryService = _telemetryService;\n        this.hoverOrdinal = 4;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        const controller = InlineCompletionsController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        const target = mouseEvent.target;\n        if (target.type === 8 /* MouseTargetType.CONTENT_VIEW_ZONE */) {\n            // handle the case where the mouse is over the view zone\n            const viewZoneData = target.detail;\n            if (controller.shouldShowHoverAtViewZone(viewZoneData.viewZoneId)) {\n                return new HoverForeignElementAnchor(1000, this, Range.fromPositions(this._editor.getModel().validatePosition(viewZoneData.positionBefore || viewZoneData.position)), mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            // handle the case where the mouse is over the empty portion of a line following ghost text\n            if (controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range, mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            // handle the case where the mouse is directly over ghost text\n            const mightBeForeignElement = target.detail.mightBeForeignElement;\n            if (mightBeForeignElement && controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range, mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        return null;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (this._editor.getOption(62 /* EditorOption.inlineSuggest */).showToolbar !== 'onHover') {\n            return [];\n        }\n        const controller = InlineCompletionsController.get(this._editor);\n        if (controller && controller.shouldShowHoverAt(anchor.range)) {\n            return [new InlineCompletionsHover(this, anchor.range, controller)];\n        }\n        return [];\n    }\n    renderHoverParts(context, hoverParts) {\n        const disposableStore = new DisposableStore();\n        const part = hoverParts[0];\n        this._telemetryService.publicLog2('inlineCompletionHover.shown');\n        if (this.accessibilityService.isScreenReaderOptimized() && !this._editor.getOption(8 /* EditorOption.screenReaderAnnounceInlineSuggestion */)) {\n            this.renderScreenReaderText(context, part, disposableStore);\n        }\n        const model = part.controller.model.get();\n        const w = this._instantiationService.createInstance(InlineSuggestionHintsContentWidget, this._editor, false, constObservable(null), model.selectedInlineCompletionIndex, model.inlineCompletionsCount, model.selectedInlineCompletion.map(v => /** @description commands */ { var _a; /** @description commands */ return (_a = v === null || v === void 0 ? void 0 : v.inlineCompletion.source.inlineCompletions.commands) !== null && _a !== void 0 ? _a : []; }));\n        context.fragment.appendChild(w.getDomNode());\n        model.triggerExplicitly();\n        disposableStore.add(w);\n        return disposableStore;\n    }\n    renderScreenReaderText(context, part, disposableStore) {\n        const $ = dom.$;\n        const markdownHoverElement = $('div.hover-row.markdown-hover');\n        const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents', { ['aria-live']: 'assertive' }));\n        const renderer = disposableStore.add(new MarkdownRenderer({ editor: this._editor }, this._languageService, this._openerService));\n        const render = (code) => {\n            disposableStore.add(renderer.onDidRenderAsync(() => {\n                hoverContentsElement.className = 'hover-contents code-hover-contents';\n                context.onContentsChanged();\n            }));\n            const inlineSuggestionAvailable = nls.localize('inlineSuggestionFollows', \"Suggestion:\");\n            const renderedContents = disposableStore.add(renderer.render(new MarkdownString().appendText(inlineSuggestionAvailable).appendCodeblock('text', code)));\n            hoverContentsElement.replaceChildren(renderedContents.element);\n        };\n        disposableStore.add(autorun(reader => {\n            var _a;\n            /** @description update hover */\n            const ghostText = (_a = part.controller.model.read(reader)) === null || _a === void 0 ? void 0 : _a.primaryGhostText.read(reader);\n            if (ghostText) {\n                const lineText = this._editor.getModel().getLineContent(ghostText.lineNumber);\n                render(ghostText.renderForScreenReader(lineText));\n            }\n            else {\n                dom.reset(hoverContentsElement);\n            }\n        }));\n        context.fragment.appendChild(markdownHoverElement);\n    }\n};\nInlineCompletionsHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IAccessibilityService),\n    __param(4, IInstantiationService),\n    __param(5, ITelemetryService)\n], InlineCompletionsHoverParticipant);\nexport { InlineCompletionsHoverParticipant };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport * as indentUtils from './indentUtils.js';\nimport * as nls from '../../../../nls.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { normalizeIndentation } from '../../../common/core/indentation.js';\nimport { getGoodIndentForLine, getIndentMetadata } from '../../../common/languages/autoIndent.js';\nexport function getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber, inheritedIndent) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return [];\n    }\n    const indentationRules = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).indentationRules;\n    if (!indentationRules) {\n        return [];\n    }\n    endLineNumber = Math.min(endLineNumber, model.getLineCount());\n    // Skip `unIndentedLinePattern` lines\n    while (startLineNumber <= endLineNumber) {\n        if (!indentationRules.unIndentedLinePattern) {\n            break;\n        }\n        const text = model.getLineContent(startLineNumber);\n        if (!indentationRules.unIndentedLinePattern.test(text)) {\n            break;\n        }\n        startLineNumber++;\n    }\n    if (startLineNumber > endLineNumber - 1) {\n        return [];\n    }\n    const { tabSize, indentSize, insertSpaces } = model.getOptions();\n    const shiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.shiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const unshiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.unshiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const indentEdits = [];\n    // indentation being passed to lines below\n    let globalIndent;\n    // Calculate indentation for the first line\n    // If there is no passed-in indentation, we use the indentation of the first line as base.\n    const currentLineText = model.getLineContent(startLineNumber);\n    let adjustedLineContent = currentLineText;\n    if (inheritedIndent !== undefined && inheritedIndent !== null) {\n        globalIndent = inheritedIndent;\n        const oldIndentation = strings.getLeadingWhitespace(currentLineText);\n        adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = unshiftIndent(globalIndent);\n            adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        }\n        if (currentLineText !== adjustedLineContent) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(startLineNumber, 1, startLineNumber, oldIndentation.length + 1), normalizeIndentation(globalIndent, indentSize, insertSpaces)));\n        }\n    }\n    else {\n        globalIndent = strings.getLeadingWhitespace(currentLineText);\n    }\n    // idealIndentForNextLine doesn't equal globalIndent when there is a line matching `indentNextLinePattern`.\n    let idealIndentForNextLine = globalIndent;\n    if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        globalIndent = shiftIndent(globalIndent);\n    }\n    else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n    }\n    startLineNumber++;\n    // Calculate indentation adjustment for all following lines\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        const text = model.getLineContent(lineNumber);\n        const oldIndentation = strings.getLeadingWhitespace(text);\n        const adjustedLineContent = idealIndentForNextLine + text.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = unshiftIndent(idealIndentForNextLine);\n            globalIndent = unshiftIndent(globalIndent);\n        }\n        if (oldIndentation !== idealIndentForNextLine) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(lineNumber, 1, lineNumber, oldIndentation.length + 1), normalizeIndentation(idealIndentForNextLine, indentSize, insertSpaces)));\n        }\n        // calculate idealIndentForNextLine\n        if (indentationRules.unIndentedLinePattern && indentationRules.unIndentedLinePattern.test(text)) {\n            // In reindent phase, if the line matches `unIndentedLinePattern` we inherit indentation from above lines\n            // but don't change globalIndent and idealIndentForNextLine.\n            continue;\n        }\n        else if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = shiftIndent(globalIndent);\n            idealIndentForNextLine = globalIndent;\n        }\n        else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        }\n        else {\n            idealIndentForNextLine = globalIndent;\n        }\n    }\n    return indentEdits;\n}\nexport class IndentationToSpacesAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToSpacesAction.ID,\n            label: nls.localize('indentationToSpaces', \"Convert Indentation to Spaces\"),\n            alias: 'Convert Indentation to Spaces',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToSpacesCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: true\n        });\n    }\n}\nIndentationToSpacesAction.ID = 'editor.action.indentationToSpaces';\nexport class IndentationToTabsAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToTabsAction.ID,\n            label: nls.localize('indentationToTabs', \"Convert Indentation to Tabs\"),\n            alias: 'Convert Indentation to Tabs',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToTabsCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: false\n        });\n    }\n}\nIndentationToTabsAction.ID = 'editor.action.indentationToTabs';\nexport class ChangeIndentationSizeAction extends EditorAction {\n    constructor(insertSpaces, displaySizeOnly, opts) {\n        super(opts);\n        this.insertSpaces = insertSpaces;\n        this.displaySizeOnly = displaySizeOnly;\n    }\n    run(accessor, editor) {\n        const quickInputService = accessor.get(IQuickInputService);\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        const modelOpts = model.getOptions();\n        const picks = [1, 2, 3, 4, 5, 6, 7, 8].map(n => ({\n            id: n.toString(),\n            label: n.toString(),\n            // add description for tabSize value set in the configuration\n            description: (n === creationOpts.tabSize && n === modelOpts.tabSize\n                ? nls.localize('configuredTabSize', \"Configured Tab Size\")\n                : n === creationOpts.tabSize\n                    ? nls.localize('defaultTabSize', \"Default Tab Size\")\n                    : n === modelOpts.tabSize\n                        ? nls.localize('currentTabSize', \"Current Tab Size\")\n                        : undefined)\n        }));\n        // auto focus the tabSize set for the current editor\n        const autoFocusIndex = Math.min(model.getOptions().tabSize - 1, 7);\n        setTimeout(() => {\n            quickInputService.pick(picks, { placeHolder: nls.localize({ key: 'selectTabWidth', comment: ['Tab corresponds to the tab key'] }, \"Select Tab Size for Current File\"), activeItem: picks[autoFocusIndex] }).then(pick => {\n                if (pick) {\n                    if (model && !model.isDisposed()) {\n                        const pickedVal = parseInt(pick.label, 10);\n                        if (this.displaySizeOnly) {\n                            model.updateOptions({\n                                tabSize: pickedVal\n                            });\n                        }\n                        else {\n                            model.updateOptions({\n                                tabSize: pickedVal,\n                                indentSize: pickedVal,\n                                insertSpaces: this.insertSpaces\n                            });\n                        }\n                    }\n                }\n            });\n        }, 50 /* quick input is sensitive to being opened so soon after another */);\n    }\n}\nexport class IndentUsingTabs extends ChangeIndentationSizeAction {\n    constructor() {\n        super(false, false, {\n            id: IndentUsingTabs.ID,\n            label: nls.localize('indentUsingTabs', \"Indent Using Tabs\"),\n            alias: 'Indent Using Tabs',\n            precondition: undefined\n        });\n    }\n}\nIndentUsingTabs.ID = 'editor.action.indentUsingTabs';\nexport class IndentUsingSpaces extends ChangeIndentationSizeAction {\n    constructor() {\n        super(true, false, {\n            id: IndentUsingSpaces.ID,\n            label: nls.localize('indentUsingSpaces', \"Indent Using Spaces\"),\n            alias: 'Indent Using Spaces',\n            precondition: undefined\n        });\n    }\n}\nIndentUsingSpaces.ID = 'editor.action.indentUsingSpaces';\nexport class ChangeTabDisplaySize extends ChangeIndentationSizeAction {\n    constructor() {\n        super(true, true, {\n            id: ChangeTabDisplaySize.ID,\n            label: nls.localize('changeTabDisplaySize', \"Change Tab Display Size\"),\n            alias: 'Change Tab Display Size',\n            precondition: undefined\n        });\n    }\n}\nChangeTabDisplaySize.ID = 'editor.action.changeTabDisplaySize';\nexport class DetectIndentation extends EditorAction {\n    constructor() {\n        super({\n            id: DetectIndentation.ID,\n            label: nls.localize('detectIndentation', \"Detect Indentation from Content\"),\n            alias: 'Detect Indentation from Content',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        model.detectIndentation(creationOpts.insertSpaces, creationOpts.tabSize);\n    }\n}\nDetectIndentation.ID = 'editor.action.detectIndentation';\nexport class ReindentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentlines',\n            label: nls.localize('editor.reindentlines', \"Reindent Lines\"),\n            alias: 'Reindent Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const edits = getReindentEditOperations(model, languageConfigurationService, 1, model.getLineCount());\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class ReindentSelectedLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentselectedlines',\n            label: nls.localize('editor.reindentselectedlines', \"Reindent Selected Lines\"),\n            alias: 'Reindent Selected Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const edits = [];\n        for (const selection of selections) {\n            let startLineNumber = selection.startLineNumber;\n            let endLineNumber = selection.endLineNumber;\n            if (startLineNumber !== endLineNumber && selection.endColumn === 1) {\n                endLineNumber--;\n            }\n            if (startLineNumber === 1) {\n                if (startLineNumber === endLineNumber) {\n                    continue;\n                }\n            }\n            else {\n                startLineNumber--;\n            }\n            const editOperations = getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber);\n            edits.push(...editOperations);\n        }\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class AutoIndentOnPasteCommand {\n    constructor(edits, initialSelection) {\n        this._initialSelection = initialSelection;\n        this._edits = [];\n        this._selectionId = null;\n        for (const edit of edits) {\n            if (edit.range && typeof edit.text === 'string') {\n                this._edits.push(edit);\n            }\n        }\n    }\n    getEditOperations(model, builder) {\n        for (const edit of this._edits) {\n            builder.addEditOperation(Range.lift(edit.range), edit.text);\n        }\n        let selectionIsSet = false;\n        if (Array.isArray(this._edits) && this._edits.length === 1 && this._initialSelection.isEmpty()) {\n            if (this._edits[0].range.startColumn === this._initialSelection.endColumn &&\n                this._edits[0].range.startLineNumber === this._initialSelection.endLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, true);\n            }\n            else if (this._edits[0].range.endColumn === this._initialSelection.startColumn &&\n                this._edits[0].range.endLineNumber === this._initialSelection.startLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, false);\n            }\n        }\n        if (!selectionIsSet) {\n            this._selectionId = builder.trackSelection(this._initialSelection);\n        }\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._selectionId);\n    }\n}\nlet AutoIndentOnPaste = class AutoIndentOnPaste {\n    constructor(editor, _languageConfigurationService) {\n        this.editor = editor;\n        this._languageConfigurationService = _languageConfigurationService;\n        this.callOnDispose = new DisposableStore();\n        this.callOnModel = new DisposableStore();\n        this.callOnDispose.add(editor.onDidChangeConfiguration(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModel(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModelLanguage(() => this.update()));\n    }\n    update() {\n        // clean up\n        this.callOnModel.clear();\n        // we are disabled\n        if (this.editor.getOption(12 /* EditorOption.autoIndent */) < 4 /* EditorAutoIndentStrategy.Full */ || this.editor.getOption(55 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        this.callOnModel.add(this.editor.onDidPaste(({ range }) => {\n            this.trigger(range);\n        }));\n    }\n    trigger(range) {\n        const selections = this.editor.getSelections();\n        if (selections === null || selections.length > 1) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (!model.tokenization.isCheapToTokenize(range.getStartPosition().lineNumber)) {\n            return;\n        }\n        const autoIndent = this.editor.getOption(12 /* EditorOption.autoIndent */);\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        const textEdits = [];\n        const indentConverter = {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n        let startLineNumber = range.startLineNumber;\n        while (startLineNumber <= range.endLineNumber) {\n            if (this.shouldIgnoreLine(model, startLineNumber)) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber > range.endLineNumber) {\n            return;\n        }\n        let firstLineText = model.getLineContent(startLineNumber);\n        if (!/\\S/.test(firstLineText.substring(0, range.startColumn - 1))) {\n            const indentOfFirstLine = getGoodIndentForLine(autoIndent, model, model.getLanguageId(), startLineNumber, indentConverter, this._languageConfigurationService);\n            if (indentOfFirstLine !== null) {\n                const oldIndentation = strings.getLeadingWhitespace(firstLineText);\n                const newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                if (newSpaceCnt !== oldSpaceCnt) {\n                    const newIndent = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                    textEdits.push({\n                        range: new Range(startLineNumber, 1, startLineNumber, oldIndentation.length + 1),\n                        text: newIndent\n                    });\n                    firstLineText = newIndent + firstLineText.substr(oldIndentation.length);\n                }\n                else {\n                    const indentMetadata = getIndentMetadata(model, startLineNumber, this._languageConfigurationService);\n                    if (indentMetadata === 0 || indentMetadata === 8 /* IndentConsts.UNINDENT_MASK */) {\n                        // we paste content into a line where only contains whitespaces\n                        // after pasting, the indentation of the first line is already correct\n                        // the first line doesn't match any indentation rule\n                        // then no-op.\n                        return;\n                    }\n                }\n            }\n        }\n        const firstLineNumber = startLineNumber;\n        // ignore empty or ignored lines\n        while (startLineNumber < range.endLineNumber) {\n            if (!/\\S/.test(model.getLineContent(startLineNumber + 1))) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber !== range.endLineNumber) {\n            const virtualModel = {\n                tokenization: {\n                    getLineTokens: (lineNumber) => {\n                        return model.tokenization.getLineTokens(lineNumber);\n                    },\n                    getLanguageId: () => {\n                        return model.getLanguageId();\n                    },\n                    getLanguageIdAtPosition: (lineNumber, column) => {\n                        return model.getLanguageIdAtPosition(lineNumber, column);\n                    },\n                },\n                getLineContent: (lineNumber) => {\n                    if (lineNumber === firstLineNumber) {\n                        return firstLineText;\n                    }\n                    else {\n                        return model.getLineContent(lineNumber);\n                    }\n                }\n            };\n            const indentOfSecondLine = getGoodIndentForLine(autoIndent, virtualModel, model.getLanguageId(), startLineNumber + 1, indentConverter, this._languageConfigurationService);\n            if (indentOfSecondLine !== null) {\n                const newSpaceCntOfSecondLine = indentUtils.getSpaceCnt(indentOfSecondLine, tabSize);\n                const oldSpaceCntOfSecondLine = indentUtils.getSpaceCnt(strings.getLeadingWhitespace(model.getLineContent(startLineNumber + 1)), tabSize);\n                if (newSpaceCntOfSecondLine !== oldSpaceCntOfSecondLine) {\n                    const spaceCntOffset = newSpaceCntOfSecondLine - oldSpaceCntOfSecondLine;\n                    for (let i = startLineNumber + 1; i <= range.endLineNumber; i++) {\n                        const lineContent = model.getLineContent(i);\n                        const originalIndent = strings.getLeadingWhitespace(lineContent);\n                        const originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n                        const newSpacesCnt = originalSpacesCnt + spaceCntOffset;\n                        const newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n                        if (newIndent !== originalIndent) {\n                            textEdits.push({\n                                range: new Range(i, 1, i, originalIndent.length + 1),\n                                text: newIndent\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        if (textEdits.length > 0) {\n            this.editor.pushUndoStop();\n            const cmd = new AutoIndentOnPasteCommand(textEdits, this.editor.getSelection());\n            this.editor.executeCommand('autoIndentOnPaste', cmd);\n            this.editor.pushUndoStop();\n        }\n    }\n    shouldIgnoreLine(model, lineNumber) {\n        model.tokenization.forceTokenization(lineNumber);\n        const nonWhitespaceColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (nonWhitespaceColumn === 0) {\n            return true;\n        }\n        const tokens = model.tokenization.getLineTokens(lineNumber);\n        if (tokens.getCount() > 0) {\n            const firstNonWhitespaceTokenIndex = tokens.findTokenIndexAtOffset(nonWhitespaceColumn);\n            if (firstNonWhitespaceTokenIndex >= 0 && tokens.getStandardTokenType(firstNonWhitespaceTokenIndex) === 1 /* StandardTokenType.Comment */) {\n                return true;\n            }\n        }\n        return false;\n    }\n    dispose() {\n        this.callOnDispose.dispose();\n        this.callOnModel.dispose();\n    }\n};\nAutoIndentOnPaste.ID = 'editor.contrib.autoIndentOnPaste';\nAutoIndentOnPaste = __decorate([\n    __param(1, ILanguageConfigurationService)\n], AutoIndentOnPaste);\nexport { AutoIndentOnPaste };\nfunction getIndentationEditOperations(model, builder, tabSize, tabsToSpaces) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return;\n    }\n    let spaces = '';\n    for (let i = 0; i < tabSize; i++) {\n        spaces += ' ';\n    }\n    const spacesRegExp = new RegExp(spaces, 'gi');\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n        let lastIndentationColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (lastIndentationColumn === 0) {\n            lastIndentationColumn = model.getLineMaxColumn(lineNumber);\n        }\n        if (lastIndentationColumn === 1) {\n            continue;\n        }\n        const originalIndentationRange = new Range(lineNumber, 1, lineNumber, lastIndentationColumn);\n        const originalIndentation = model.getValueInRange(originalIndentationRange);\n        const newIndentation = (tabsToSpaces\n            ? originalIndentation.replace(/\\t/ig, spaces)\n            : originalIndentation.replace(spacesRegExp, '\\t'));\n        builder.addEditOperation(originalIndentationRange, newIndentation);\n    }\n}\nexport class IndentationToSpacesCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, true);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nexport class IndentationToTabsCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, false);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nregisterEditorContribution(AutoIndentOnPaste.ID, AutoIndentOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(IndentationToSpacesAction);\nregisterEditorAction(IndentationToTabsAction);\nregisterEditorAction(IndentUsingTabs);\nregisterEditorAction(IndentUsingSpaces);\nregisterEditorAction(ChangeTabDisplaySize);\nregisterEditorAction(DetectIndentation);\nregisterEditorAction(ReindentLinesAction);\nregisterEditorAction(ReindentSelectedLinesAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function getSpaceCnt(str, tabSize) {\n    let spacesCnt = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str.charAt(i) === '\\t') {\n            spacesCnt += tabSize;\n        }\n        else {\n            spacesCnt++;\n        }\n    }\n    return spacesCnt;\n}\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\n    let result = '';\n    if (!insertSpaces) {\n        const tabsCnt = Math.floor(spacesCnt / tabSize);\n        spacesCnt = spacesCnt % tabSize;\n        for (let i = 0; i < tabsCnt; i++) {\n            result += '\\t';\n        }\n    }\n    for (let i = 0; i < spacesCnt; i++) {\n        result += ' ';\n    }\n    return result;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { InlayHintsController } from './inlayHintsController.js';\nimport { InlayHintsHover } from './inlayHintsHover.js';\nregisterEditorContribution(InlayHintsController.ID, InlayHintsController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nHoverParticipantRegistry.register(InlayHintsHover);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlayHintsController_1;\nimport { ModifierKeyEmitter } from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as languages from '../../../common/languages.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { InlayHintAnchor, InlayHintsFragments } from './inlayHints.js';\nimport { goToDefinitionWithLocation, showGoToContextMenu } from './inlayHintsLocations.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport * as colors from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\n// --- hint caching service (per session)\nclass InlayHintsCache {\n    constructor() {\n        this._entries = new LRUCache(50);\n    }\n    get(model) {\n        const key = InlayHintsCache._key(model);\n        return this._entries.get(key);\n    }\n    set(model, value) {\n        const key = InlayHintsCache._key(model);\n        this._entries.set(key, value);\n    }\n    static _key(model) {\n        return `${model.uri.toString()}/${model.getVersionId()}`;\n    }\n}\nconst IInlayHintsCache = createDecorator('IInlayHintsCache');\nregisterSingleton(IInlayHintsCache, InlayHintsCache, 1 /* InstantiationType.Delayed */);\n// --- rendered label\nexport class RenderedInlayHintLabelPart {\n    constructor(item, index) {\n        this.item = item;\n        this.index = index;\n    }\n    get part() {\n        const label = this.item.hint.label;\n        if (typeof label === 'string') {\n            return { label };\n        }\n        else {\n            return label[this.index];\n        }\n    }\n}\nclass ActiveInlayHintInfo {\n    constructor(part, hasTriggerModifier) {\n        this.part = part;\n        this.hasTriggerModifier = hasTriggerModifier;\n    }\n}\n// --- controller\nlet InlayHintsController = InlayHintsController_1 = class InlayHintsController {\n    static get(editor) {\n        var _a;\n        return (_a = editor.getContribution(InlayHintsController_1.ID)) !== null && _a !== void 0 ? _a : undefined;\n    }\n    constructor(_editor, _languageFeaturesService, _featureDebounce, _inlayHintsCache, _commandService, _notificationService, _instaService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._inlayHintsCache = _inlayHintsCache;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._instaService = _instaService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._decorationsMetadata = new Map();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._activeRenderMode = 0 /* RenderMode.Normal */;\n        this._debounceInfo = _featureDebounce.for(_languageFeaturesService.inlayHintsProvider, 'InlayHint', { min: 25 });\n        this._disposables.add(_languageFeaturesService.inlayHintsProvider.onDidChange(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(140 /* EditorOption.inlayHints */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._sessionDisposables.dispose();\n        this._removeAllDecorations();\n        this._disposables.dispose();\n    }\n    _update() {\n        this._sessionDisposables.clear();\n        this._removeAllDecorations();\n        const options = this._editor.getOption(140 /* EditorOption.inlayHints */);\n        if (options.enabled === 'off') {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.inlayHintsProvider.has(model)) {\n            return;\n        }\n        if (options.enabled === 'on') {\n            // different \"on\" modes: always\n            this._activeRenderMode = 0 /* RenderMode.Normal */;\n        }\n        else {\n            // different \"on\" modes: offUnlessPressed, or onUnlessPressed\n            let defaultMode;\n            let altMode;\n            if (options.enabled === 'onUnlessPressed') {\n                defaultMode = 0 /* RenderMode.Normal */;\n                altMode = 1 /* RenderMode.Invisible */;\n            }\n            else {\n                defaultMode = 1 /* RenderMode.Invisible */;\n                altMode = 0 /* RenderMode.Normal */;\n            }\n            this._activeRenderMode = defaultMode;\n            this._sessionDisposables.add(ModifierKeyEmitter.getInstance().event(e => {\n                if (!this._editor.hasModel()) {\n                    return;\n                }\n                const newRenderMode = e.altKey && e.ctrlKey && !(e.shiftKey || e.metaKey) ? altMode : defaultMode;\n                if (newRenderMode !== this._activeRenderMode) {\n                    this._activeRenderMode = newRenderMode;\n                    const model = this._editor.getModel();\n                    const copies = this._copyInlayHintsWithCurrentAnchor(model);\n                    this._updateHintsDecorators([model.getFullModelRange()], copies);\n                    scheduler.schedule(0);\n                }\n            }));\n        }\n        // iff possible, quickly update from cache\n        const cached = this._inlayHintsCache.get(model);\n        if (cached) {\n            this._updateHintsDecorators([model.getFullModelRange()], cached);\n        }\n        this._sessionDisposables.add(toDisposable(() => {\n            // cache items when switching files etc\n            if (!model.isDisposed()) {\n                this._cacheHintsForFastRestore(model);\n            }\n        }));\n        let cts;\n        const watchedProviders = new Set();\n        const scheduler = new RunOnceScheduler(async () => {\n            const t1 = Date.now();\n            cts === null || cts === void 0 ? void 0 : cts.dispose(true);\n            cts = new CancellationTokenSource();\n            const listener = model.onWillDispose(() => cts === null || cts === void 0 ? void 0 : cts.cancel());\n            try {\n                const myToken = cts.token;\n                const inlayHints = await InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider, model, this._getHintsRanges(), myToken);\n                scheduler.delay = this._debounceInfo.update(model, Date.now() - t1);\n                if (myToken.isCancellationRequested) {\n                    inlayHints.dispose();\n                    return;\n                }\n                // listen to provider changes\n                for (const provider of inlayHints.provider) {\n                    if (typeof provider.onDidChangeInlayHints === 'function' && !watchedProviders.has(provider)) {\n                        watchedProviders.add(provider);\n                        this._sessionDisposables.add(provider.onDidChangeInlayHints(() => {\n                            if (!scheduler.isScheduled()) { // ignore event when request is already scheduled\n                                scheduler.schedule();\n                            }\n                        }));\n                    }\n                }\n                this._sessionDisposables.add(inlayHints);\n                this._updateHintsDecorators(inlayHints.ranges, inlayHints.items);\n                this._cacheHintsForFastRestore(model);\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n            finally {\n                cts.dispose();\n                listener.dispose();\n            }\n        }, this._debounceInfo.get(model));\n        this._sessionDisposables.add(scheduler);\n        this._sessionDisposables.add(toDisposable(() => cts === null || cts === void 0 ? void 0 : cts.dispose(true)));\n        scheduler.schedule(0);\n        this._sessionDisposables.add(this._editor.onDidScrollChange((e) => {\n            // update when scroll position changes\n            // uses scrollTopChanged has weak heuristic to differenatiate between scrolling due to\n            // typing or due to \"actual\" scrolling\n            if (e.scrollTopChanged || !scheduler.isScheduled()) {\n                scheduler.schedule();\n            }\n        }));\n        this._sessionDisposables.add(this._editor.onDidChangeModelContent((e) => {\n            cts === null || cts === void 0 ? void 0 : cts.cancel();\n            // update less aggressive when typing\n            const delay = Math.max(scheduler.delay, 1250);\n            scheduler.schedule(delay);\n        }));\n        // mouse gestures\n        this._sessionDisposables.add(this._installDblClickGesture(() => scheduler.schedule(0)));\n        this._sessionDisposables.add(this._installLinkGesture());\n        this._sessionDisposables.add(this._installContextMenu());\n    }\n    _installLinkGesture() {\n        const store = new DisposableStore();\n        const gesture = store.add(new ClickLinkGesture(this._editor));\n        // let removeHighlight = () => { };\n        const sessionStore = new DisposableStore();\n        store.add(sessionStore);\n        store.add(gesture.onMouseMoveOrRelevantKeyDown(e => {\n            const [mouseEvent] = e;\n            const labelPart = this._getInlayHintLabelPart(mouseEvent);\n            const model = this._editor.getModel();\n            if (!labelPart || !model) {\n                sessionStore.clear();\n                return;\n            }\n            // resolve the item\n            const cts = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cts.dispose(true)));\n            labelPart.item.resolve(cts.token);\n            // render link => when the modifier is pressed and when there is a command or location\n            this._activeInlayHintPart = labelPart.part.command || labelPart.part.location\n                ? new ActiveInlayHintInfo(labelPart, mouseEvent.hasTriggerModifier)\n                : undefined;\n            const lineNumber = model.validatePosition(labelPart.item.hint.position).lineNumber;\n            const range = new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber));\n            const lineHints = this._getInlineHintsForRange(range);\n            this._updateHintsDecorators([range], lineHints);\n            sessionStore.add(toDisposable(() => {\n                this._activeInlayHintPart = undefined;\n                this._updateHintsDecorators([range], lineHints);\n            }));\n        }));\n        store.add(gesture.onCancel(() => sessionStore.clear()));\n        store.add(gesture.onExecute(async (e) => {\n            const label = this._getInlayHintLabelPart(e);\n            if (label) {\n                const part = label.part;\n                if (part.location) {\n                    // location -> execute go to def\n                    this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, part.location);\n                }\n                else if (languages.Command.is(part.command)) {\n                    // command -> execute it\n                    await this._invokeCommand(part.command, label.item);\n                }\n            }\n        }));\n        return store;\n    }\n    _getInlineHintsForRange(range) {\n        const lineHints = new Set();\n        for (const data of this._decorationsMetadata.values()) {\n            if (range.containsRange(data.item.anchor.range)) {\n                lineHints.add(data.item);\n            }\n        }\n        return Array.from(lineHints);\n    }\n    _installDblClickGesture(updateInlayHints) {\n        return this._editor.onMouseUp(async (e) => {\n            if (e.event.detail !== 2) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (!part) {\n                return;\n            }\n            e.event.preventDefault();\n            await part.item.resolve(CancellationToken.None);\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                const edits = part.item.hint.textEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text));\n                this._editor.executeEdits('inlayHint.default', edits);\n                updateInlayHints();\n            }\n        });\n    }\n    _installContextMenu() {\n        return this._editor.onContextMenu(async (e) => {\n            if (!(e.event.target instanceof HTMLElement)) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (part) {\n                await this._instaService.invokeFunction(showGoToContextMenu, this._editor, e.event.target, part);\n            }\n        });\n    }\n    _getInlayHintLabelPart(e) {\n        var _a;\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return undefined;\n        }\n        const options = (_a = e.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n        if (options instanceof ModelDecorationInjectedTextOptions && (options === null || options === void 0 ? void 0 : options.attachedData) instanceof RenderedInlayHintLabelPart) {\n            return options.attachedData;\n        }\n        return undefined;\n    }\n    async _invokeCommand(command, item) {\n        var _a;\n        try {\n            await this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n        }\n        catch (err) {\n            this._notificationService.notify({\n                severity: Severity.Error,\n                source: item.provider.displayName,\n                message: err\n            });\n        }\n    }\n    _cacheHintsForFastRestore(model) {\n        const hints = this._copyInlayHintsWithCurrentAnchor(model);\n        this._inlayHintsCache.set(model, hints);\n    }\n    // return inlay hints but with an anchor that reflects \"updates\"\n    // that happened after receiving them, e.g adding new lines before a hint\n    _copyInlayHintsWithCurrentAnchor(model) {\n        const items = new Map();\n        for (const [id, obj] of this._decorationsMetadata) {\n            if (items.has(obj.item)) {\n                // an inlay item can be rendered as multiple decorations\n                // but they will all uses the same range\n                continue;\n            }\n            const range = model.getDecorationRange(id);\n            if (range) {\n                // update range with whatever the editor has tweaked it to\n                const anchor = new InlayHintAnchor(range, obj.item.anchor.direction);\n                const copy = obj.item.with({ anchor });\n                items.set(obj.item, copy);\n            }\n        }\n        return Array.from(items.values());\n    }\n    _getHintsRanges() {\n        const extra = 30;\n        const model = this._editor.getModel();\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        const result = [];\n        for (const range of visibleRanges.sort(Range.compareRangesUsingStarts)) {\n            const extendedRange = model.validateRange(new Range(range.startLineNumber - extra, range.startColumn, range.endLineNumber + extra, range.endColumn));\n            if (result.length === 0 || !Range.areIntersectingOrTouching(result[result.length - 1], extendedRange)) {\n                result.push(extendedRange);\n            }\n            else {\n                result[result.length - 1] = Range.plusRange(result[result.length - 1], extendedRange);\n            }\n        }\n        return result;\n    }\n    _updateHintsDecorators(ranges, items) {\n        var _a, _b;\n        // utils to collect/create injected text decorations\n        const newDecorationsData = [];\n        const addInjectedText = (item, ref, content, cursorStops, attachedData) => {\n            const opts = {\n                content,\n                inlineClassNameAffectsLetterSpacing: true,\n                inlineClassName: ref.className,\n                cursorStops,\n                attachedData\n            };\n            newDecorationsData.push({\n                item,\n                classNameRef: ref,\n                decoration: {\n                    range: item.anchor.range,\n                    options: {\n                        // className: \"rangeHighlight\", // DEBUG highlight to see to what range a hint is attached\n                        description: 'InlayHint',\n                        showIfCollapsed: item.anchor.range.isEmpty(), // \"original\" range is empty\n                        collapseOnReplaceEdit: !item.anchor.range.isEmpty(),\n                        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n                        [item.anchor.direction]: this._activeRenderMode === 0 /* RenderMode.Normal */ ? opts : undefined\n                    }\n                }\n            });\n        };\n        const addInjectedWhitespace = (item, isLast) => {\n            const marginRule = this._ruleFactory.createClassNameRef({\n                width: `${(fontSize / 3) | 0}px`,\n                display: 'inline-block'\n            });\n            addInjectedText(item, marginRule, '\\u200a', isLast ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None);\n        };\n        //\n        const { fontSize, fontFamily, padding, isUniform } = this._getLayoutInfo();\n        const fontFamilyVar = '--code-editorInlayHintsFontFamily';\n        this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily);\n        let currentLineInfo = { line: 0, totalLen: 0 };\n        for (const item of items) {\n            if (currentLineInfo.line !== item.anchor.range.startLineNumber) {\n                currentLineInfo = { line: item.anchor.range.startLineNumber, totalLen: 0 };\n            }\n            if (currentLineInfo.totalLen > InlayHintsController_1._MAX_LABEL_LEN) {\n                continue;\n            }\n            // whitespace leading the actual label\n            if (item.hint.paddingLeft) {\n                addInjectedWhitespace(item, false);\n            }\n            // the label with its parts\n            const parts = typeof item.hint.label === 'string'\n                ? [{ label: item.hint.label }]\n                : item.hint.label;\n            for (let i = 0; i < parts.length; i++) {\n                const part = parts[i];\n                const isFirst = i === 0;\n                const isLast = i === parts.length - 1;\n                const cssProperties = {\n                    fontSize: `${fontSize}px`,\n                    fontFamily: `var(${fontFamilyVar}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,\n                    verticalAlign: isUniform ? 'baseline' : 'middle',\n                    unicodeBidi: 'isolate'\n                };\n                if (isNonEmptyArray(item.hint.textEdits)) {\n                    cssProperties.cursor = 'default';\n                }\n                this._fillInColors(cssProperties, item.hint);\n                if ((part.command || part.location) && ((_a = this._activeInlayHintPart) === null || _a === void 0 ? void 0 : _a.part.item) === item && this._activeInlayHintPart.part.index === i) {\n                    // active link!\n                    cssProperties.textDecoration = 'underline';\n                    if (this._activeInlayHintPart.hasTriggerModifier) {\n                        cssProperties.color = themeColorFromId(colors.editorActiveLinkForeground);\n                        cssProperties.cursor = 'pointer';\n                    }\n                }\n                if (padding) {\n                    if (isFirst && isLast) {\n                        // only element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isFirst) {\n                        // first element\n                        cssProperties.padding = `1px 0 1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px 0 0 ${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isLast) {\n                        // last element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px 1px 0`;\n                        cssProperties.borderRadius = `0 ${(fontSize / 4) | 0}px ${(fontSize / 4) | 0}px 0`;\n                    }\n                    else {\n                        cssProperties.padding = `1px 0 1px 0`;\n                    }\n                }\n                let textlabel = part.label;\n                currentLineInfo.totalLen += textlabel.length;\n                let tooLong = false;\n                const over = currentLineInfo.totalLen - InlayHintsController_1._MAX_LABEL_LEN;\n                if (over > 0) {\n                    textlabel = textlabel.slice(0, -over) + '\u2026';\n                    tooLong = true;\n                }\n                addInjectedText(item, this._ruleFactory.createClassNameRef(cssProperties), fixSpace(textlabel), isLast && !item.hint.paddingRight ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None, new RenderedInlayHintLabelPart(item, i));\n                if (tooLong) {\n                    break;\n                }\n            }\n            // whitespace trailing the actual label\n            if (item.hint.paddingRight) {\n                addInjectedWhitespace(item, true);\n            }\n            if (newDecorationsData.length > InlayHintsController_1._MAX_DECORATORS) {\n                break;\n            }\n        }\n        // collect all decoration ids that are affected by the ranges\n        // and only update those decorations\n        const decorationIdsToReplace = [];\n        for (const [id, metadata] of this._decorationsMetadata) {\n            const range = (_b = this._editor.getModel()) === null || _b === void 0 ? void 0 : _b.getDecorationRange(id);\n            if (range && ranges.some(r => r.containsRange(range))) {\n                decorationIdsToReplace.push(id);\n                metadata.classNameRef.dispose();\n                this._decorationsMetadata.delete(id);\n            }\n        }\n        const scrollState = StableEditorScrollState.capture(this._editor);\n        this._editor.changeDecorations(accessor => {\n            const newDecorationIds = accessor.deltaDecorations(decorationIdsToReplace, newDecorationsData.map(d => d.decoration));\n            for (let i = 0; i < newDecorationIds.length; i++) {\n                const data = newDecorationsData[i];\n                this._decorationsMetadata.set(newDecorationIds[i], data);\n            }\n        });\n        scrollState.restore(this._editor);\n    }\n    _fillInColors(props, hint) {\n        if (hint.kind === languages.InlayHintKind.Parameter) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintParameterBackground);\n            props.color = themeColorFromId(colors.editorInlayHintParameterForeground);\n        }\n        else if (hint.kind === languages.InlayHintKind.Type) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintTypeBackground);\n            props.color = themeColorFromId(colors.editorInlayHintTypeForeground);\n        }\n        else {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintBackground);\n            props.color = themeColorFromId(colors.editorInlayHintForeground);\n        }\n    }\n    _getLayoutInfo() {\n        const options = this._editor.getOption(140 /* EditorOption.inlayHints */);\n        const padding = options.padding;\n        const editorFontSize = this._editor.getOption(52 /* EditorOption.fontSize */);\n        const editorFontFamily = this._editor.getOption(49 /* EditorOption.fontFamily */);\n        let fontSize = options.fontSize;\n        if (!fontSize || fontSize < 5 || fontSize > editorFontSize) {\n            fontSize = editorFontSize;\n        }\n        const fontFamily = options.fontFamily || editorFontFamily;\n        const isUniform = !padding\n            && fontFamily === editorFontFamily\n            && fontSize === editorFontSize;\n        return { fontSize, fontFamily, padding, isUniform };\n    }\n    _removeAllDecorations() {\n        this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));\n        for (const obj of this._decorationsMetadata.values()) {\n            obj.classNameRef.dispose();\n        }\n        this._decorationsMetadata.clear();\n    }\n};\nInlayHintsController.ID = 'editor.contrib.InlayHints';\nInlayHintsController._MAX_DECORATORS = 1500;\nInlayHintsController._MAX_LABEL_LEN = 43;\nInlayHintsController = InlayHintsController_1 = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, IInlayHintsCache),\n    __param(4, ICommandService),\n    __param(5, INotificationService),\n    __param(6, IInstantiationService)\n], InlayHintsController);\nexport { InlayHintsController };\n// Prevents the view from potentially visible whitespace\nfunction fixSpace(str) {\n    const noBreakWhitespace = '\\xa0';\n    return str.replace(/[ \\t]/g, noBreakWhitespace);\n}\nCommandsRegistry.registerCommand('_executeInlayHintProvider', async (accessor, ...args) => {\n    const [uri, range] = args;\n    assertType(URI.isUri(uri));\n    assertType(Range.isIRange(range));\n    const { inlayHintsProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = await accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const model = await InlayHintsFragments.create(inlayHintsProvider, ref.object.textEditorModel, [Range.lift(range)], CancellationToken.None);\n        const result = model.items.map(i => i.hint);\n        setTimeout(() => model.dispose(), 0); // dispose after sending to ext host\n        return result;\n    }\n    finally {\n        ref.dispose();\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { URI } from '../../../../base/common/uri.js';\nexport class InlayHintAnchor {\n    constructor(range, direction) {\n        this.range = range;\n        this.direction = direction;\n    }\n}\nexport class InlayHintItem {\n    constructor(hint, anchor, provider) {\n        this.hint = hint;\n        this.anchor = anchor;\n        this.provider = provider;\n        this._isResolved = false;\n    }\n    with(delta) {\n        const result = new InlayHintItem(this.hint, delta.anchor, this.provider);\n        result._isResolved = this._isResolved;\n        result._currentResolve = this._currentResolve;\n        return result;\n    }\n    async resolve(token) {\n        if (typeof this.provider.resolveInlayHint !== 'function') {\n            return;\n        }\n        if (this._currentResolve) {\n            // wait for an active resolve operation and try again\n            // when that's done.\n            await this._currentResolve;\n            if (token.isCancellationRequested) {\n                return;\n            }\n            return this.resolve(token);\n        }\n        if (!this._isResolved) {\n            this._currentResolve = this._doResolve(token)\n                .finally(() => this._currentResolve = undefined);\n        }\n        await this._currentResolve;\n    }\n    async _doResolve(token) {\n        var _a, _b, _c;\n        try {\n            const newHint = await Promise.resolve(this.provider.resolveInlayHint(this.hint, token));\n            this.hint.tooltip = (_a = newHint === null || newHint === void 0 ? void 0 : newHint.tooltip) !== null && _a !== void 0 ? _a : this.hint.tooltip;\n            this.hint.label = (_b = newHint === null || newHint === void 0 ? void 0 : newHint.label) !== null && _b !== void 0 ? _b : this.hint.label;\n            this.hint.textEdits = (_c = newHint === null || newHint === void 0 ? void 0 : newHint.textEdits) !== null && _c !== void 0 ? _c : this.hint.textEdits;\n            this._isResolved = true;\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n            this._isResolved = false;\n        }\n    }\n}\nexport class InlayHintsFragments {\n    static async create(registry, model, ranges, token) {\n        const data = [];\n        const promises = registry.ordered(model).reverse().map(provider => ranges.map(async (range) => {\n            try {\n                const result = await provider.provideInlayHints(model, range, token);\n                if ((result === null || result === void 0 ? void 0 : result.hints.length) || provider.onDidChangeInlayHints) {\n                    data.push([result !== null && result !== void 0 ? result : InlayHintsFragments._emptyInlayHintList, provider]);\n                }\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n        }));\n        await Promise.all(promises.flat());\n        if (token.isCancellationRequested || model.isDisposed()) {\n            throw new CancellationError();\n        }\n        return new InlayHintsFragments(ranges, data, model);\n    }\n    constructor(ranges, data, model) {\n        this._disposables = new DisposableStore();\n        this.ranges = ranges;\n        this.provider = new Set();\n        const items = [];\n        for (const [list, provider] of data) {\n            this._disposables.add(list);\n            this.provider.add(provider);\n            for (const hint of list.hints) {\n                // compute the range to which the item should be attached to\n                const position = model.validatePosition(hint.position);\n                let direction = 'before';\n                const wordRange = InlayHintsFragments._getRangeAtPosition(model, position);\n                let range;\n                if (wordRange.getStartPosition().isBefore(position)) {\n                    range = Range.fromPositions(wordRange.getStartPosition(), position);\n                    direction = 'after';\n                }\n                else {\n                    range = Range.fromPositions(position, wordRange.getEndPosition());\n                    direction = 'before';\n                }\n                items.push(new InlayHintItem(hint, new InlayHintAnchor(range, direction), provider));\n            }\n        }\n        this.items = items.sort((a, b) => Position.compare(a.hint.position, b.hint.position));\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    static _getRangeAtPosition(model, position) {\n        const line = position.lineNumber;\n        const word = model.getWordAtPosition(position);\n        if (word) {\n            // always prefer the word range\n            return new Range(line, word.startColumn, line, word.endColumn);\n        }\n        model.tokenization.tokenizeIfCheap(line);\n        const tokens = model.tokenization.getLineTokens(line);\n        const offset = position.column - 1;\n        const idx = tokens.findTokenIndexAtOffset(offset);\n        let start = tokens.getStartOffset(idx);\n        let end = tokens.getEndOffset(idx);\n        if (end - start === 1) {\n            // single character token, when at its end try leading/trailing token instead\n            if (start === offset && idx > 1) {\n                // leading token\n                start = tokens.getStartOffset(idx - 1);\n                end = tokens.getEndOffset(idx - 1);\n            }\n            else if (end === offset && idx < tokens.getCount() - 1) {\n                // trailing token\n                start = tokens.getStartOffset(idx + 1);\n                end = tokens.getEndOffset(idx + 1);\n            }\n        }\n        return new Range(line, start + 1, line, end + 1);\n    }\n}\nInlayHintsFragments._emptyInlayHintList = Object.freeze({ dispose() { }, hints: [] });\nexport function asCommandLink(command) {\n    return URI.from({\n        scheme: Schemas.command,\n        path: command.id,\n        query: command.arguments && encodeURIComponent(JSON.stringify(command.arguments))\n    }).toString();\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Action, Separator } from '../../../../base/common/actions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { DefinitionAction, SymbolNavigationAction, SymbolNavigationAnchor } from '../../gotoSymbol/browser/goToCommands.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport { isIMenuItem, MenuId, MenuItemAction, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nexport async function showGoToContextMenu(accessor, editor, anchor, part) {\n    var _a;\n    const resolverService = accessor.get(ITextModelService);\n    const contextMenuService = accessor.get(IContextMenuService);\n    const commandService = accessor.get(ICommandService);\n    const instaService = accessor.get(IInstantiationService);\n    const notificationService = accessor.get(INotificationService);\n    await part.item.resolve(CancellationToken.None);\n    if (!part.part.location) {\n        return;\n    }\n    const location = part.part.location;\n    const menuActions = [];\n    // from all registered (not active) context menu actions select those\n    // that are a symbol navigation actions\n    const filter = new Set(MenuRegistry.getMenuItems(MenuId.EditorContext)\n        .map(item => isIMenuItem(item) ? item.command.id : generateUuid()));\n    for (const delegate of SymbolNavigationAction.all()) {\n        if (filter.has(delegate.desc.id)) {\n            menuActions.push(new Action(delegate.desc.id, MenuItemAction.label(delegate.desc, { renderShortTitle: true }), undefined, true, async () => {\n                const ref = await resolverService.createModelReference(location.uri);\n                try {\n                    const symbolAnchor = new SymbolNavigationAnchor(ref.object.textEditorModel, Range.getStartPosition(location.range));\n                    const range = part.item.anchor.range;\n                    await instaService.invokeFunction(delegate.runEditorCommand.bind(delegate), editor, symbolAnchor, range);\n                }\n                finally {\n                    ref.dispose();\n                }\n            }));\n        }\n    }\n    if (part.part.command) {\n        const { command } = part.part;\n        menuActions.push(new Separator());\n        menuActions.push(new Action(command.id, command.title, undefined, true, async () => {\n            var _a;\n            try {\n                await commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n            }\n            catch (err) {\n                notificationService.notify({\n                    severity: Severity.Error,\n                    source: part.item.provider.displayName,\n                    message: err\n                });\n            }\n        }));\n    }\n    // show context menu\n    const useShadowDOM = editor.getOption(127 /* EditorOption.useShadowDOM */);\n    contextMenuService.showContextMenu({\n        domForShadowRoot: useShadowDOM ? (_a = editor.getDomNode()) !== null && _a !== void 0 ? _a : undefined : undefined,\n        getAnchor: () => {\n            const box = dom.getDomNodePagePosition(anchor);\n            return { x: box.left, y: box.top + box.height + 8 };\n        },\n        getActions: () => menuActions,\n        onHide: () => {\n            editor.focus();\n        },\n        autoSelectFirstItem: true,\n    });\n}\nexport async function goToDefinitionWithLocation(accessor, event, editor, location) {\n    const resolverService = accessor.get(ITextModelService);\n    const ref = await resolverService.createModelReference(location.uri);\n    await editor.invokeWithinContext(async (accessor) => {\n        const openToSide = event.hasSideBySideModifier;\n        const contextKeyService = accessor.get(IContextKeyService);\n        const isInPeek = PeekContext.inPeekEditor.getValue(contextKeyService);\n        const canPeek = !openToSide && editor.getOption(88 /* EditorOption.definitionLinkOpensInPeek */) && !isInPeek;\n        const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n        return action.run(accessor, new SymbolNavigationAnchor(ref.object.textEditorModel, Range.getStartPosition(location.range)), Range.lift(location.range));\n    });\n    ref.dispose();\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { HoverForeignElementAnchor } from '../../hover/browser/hoverTypes.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { getHover } from '../../hover/browser/getHover.js';\nimport { MarkdownHover, MarkdownHoverParticipant } from '../../hover/browser/markdownHoverParticipant.js';\nimport { RenderedInlayHintLabelPart, InlayHintsController } from './inlayHintsController.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { localize } from '../../../../nls.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { asCommandLink } from './inlayHints.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nclass InlayHintsHoverAnchor extends HoverForeignElementAnchor {\n    constructor(part, owner, initialMousePosX, initialMousePosY) {\n        super(10, owner, part.item.anchor.range, initialMousePosX, initialMousePosY, true);\n        this.part = part;\n    }\n}\nlet InlayHintsHover = class InlayHintsHover extends MarkdownHoverParticipant {\n    constructor(editor, languageService, openerService, configurationService, _resolverService, languageFeaturesService) {\n        super(editor, languageService, openerService, configurationService, languageFeaturesService);\n        this._resolverService = _resolverService;\n        this.hoverOrdinal = 6;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        var _a;\n        const controller = InlayHintsController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        if (mouseEvent.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return null;\n        }\n        const options = (_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n        if (!(options instanceof ModelDecorationInjectedTextOptions && options.attachedData instanceof RenderedInlayHintLabelPart)) {\n            return null;\n        }\n        return new InlayHintsHoverAnchor(options.attachedData, this, mouseEvent.event.posx, mouseEvent.event.posy);\n    }\n    computeSync() {\n        return [];\n    }\n    computeAsync(anchor, _lineDecorations, token) {\n        if (!(anchor instanceof InlayHintsHoverAnchor)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        return new AsyncIterableObject(async (executor) => {\n            const { part } = anchor;\n            await part.item.resolve(token);\n            if (token.isCancellationRequested) {\n                return;\n            }\n            // (1) Inlay Tooltip\n            let itemTooltip;\n            if (typeof part.item.hint.tooltip === 'string') {\n                itemTooltip = new MarkdownString().appendText(part.item.hint.tooltip);\n            }\n            else if (part.item.hint.tooltip) {\n                itemTooltip = part.item.hint.tooltip;\n            }\n            if (itemTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [itemTooltip], false, 0));\n            }\n            // (1.2) Inlay dbl-click gesture\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(localize('hint.dbl', \"Double-click to insert\"))], false, 10001));\n            }\n            // (2) Inlay Label Part Tooltip\n            let partTooltip;\n            if (typeof part.part.tooltip === 'string') {\n                partTooltip = new MarkdownString().appendText(part.part.tooltip);\n            }\n            else if (part.part.tooltip) {\n                partTooltip = part.part.tooltip;\n            }\n            if (partTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [partTooltip], false, 1));\n            }\n            // (2.2) Inlay Label Part Help Hover\n            if (part.part.location || part.part.command) {\n                let linkHint;\n                const useMetaKey = this._editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey';\n                const kb = useMetaKey\n                    ? platform.isMacintosh\n                        ? localize('links.navigate.kb.meta.mac', \"cmd + click\")\n                        : localize('links.navigate.kb.meta', \"ctrl + click\")\n                    : platform.isMacintosh\n                        ? localize('links.navigate.kb.alt.mac', \"option + click\")\n                        : localize('links.navigate.kb.alt', \"alt + click\");\n                if (part.part.location && part.part.command) {\n                    linkHint = new MarkdownString().appendText(localize('hint.defAndCommand', 'Go to Definition ({0}), right click for more', kb));\n                }\n                else if (part.part.location) {\n                    linkHint = new MarkdownString().appendText(localize('hint.def', 'Go to Definition ({0})', kb));\n                }\n                else if (part.part.command) {\n                    linkHint = new MarkdownString(`[${localize('hint.cmd', \"Execute Command\")}](${asCommandLink(part.part.command)} \"${part.part.command.title}\") (${kb})`, { isTrusted: true });\n                }\n                if (linkHint) {\n                    executor.emitOne(new MarkdownHover(this, anchor.range, [linkHint], false, 10000));\n                }\n            }\n            // (3) Inlay Label Part Location tooltip\n            const iterable = await this._resolveInlayHintLabelPartHover(part, token);\n            for await (const item of iterable) {\n                executor.emitOne(item);\n            }\n        });\n    }\n    async _resolveInlayHintLabelPartHover(part, token) {\n        if (!part.part.location) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const { uri, range } = part.part.location;\n        const ref = await this._resolverService.createModelReference(uri);\n        try {\n            const model = ref.object.textEditorModel;\n            if (!this._languageFeaturesService.hoverProvider.has(model)) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return getHover(this._languageFeaturesService.hoverProvider, model, new Position(range.startLineNumber, range.startColumn), token)\n                .filter(item => !isEmptyMarkdownString(item.hover.contents))\n                .map(item => new MarkdownHover(this, part.item.anchor.range, item.hover.contents, false, 2 + item.ordinal));\n        }\n        finally {\n            ref.dispose();\n        }\n    }\n};\nInlayHintsHover = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService),\n    __param(4, ITextModelService),\n    __param(5, ILanguageFeaturesService)\n], InlayHintsHover);\nexport { InlayHintsHover };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './browser/coreCommands.js';\nimport './browser/widget/codeEditorWidget.js';\nimport './browser/widget/diffEditor/diffEditor.contribution.js';\nimport './contrib/anchorSelect/browser/anchorSelect.js';\nimport './contrib/bracketMatching/browser/bracketMatching.js';\nimport './contrib/caretOperations/browser/caretOperations.js';\nimport './contrib/caretOperations/browser/transpose.js';\nimport './contrib/clipboard/browser/clipboard.js';\nimport './contrib/codeAction/browser/codeActionContributions.js';\nimport './contrib/codelens/browser/codelensController.js';\nimport './contrib/colorPicker/browser/colorContributions.js';\nimport './contrib/colorPicker/browser/standaloneColorPickerActions.js';\nimport './contrib/comment/browser/comment.js';\nimport './contrib/contextmenu/browser/contextmenu.js';\nimport './contrib/cursorUndo/browser/cursorUndo.js';\nimport './contrib/dnd/browser/dnd.js';\nimport './contrib/dropOrPasteInto/browser/copyPasteContribution.js';\nimport './contrib/dropOrPasteInto/browser/dropIntoEditorContribution.js';\nimport './contrib/find/browser/findController.js';\nimport './contrib/folding/browser/folding.js';\nimport './contrib/fontZoom/browser/fontZoom.js';\nimport './contrib/format/browser/formatActions.js';\nimport './contrib/documentSymbols/browser/documentSymbols.js';\nimport './contrib/inlineCompletions/browser/inlineCompletions.contribution.js';\nimport './contrib/inlineProgress/browser/inlineProgress.js';\nimport './contrib/gotoSymbol/browser/goToCommands.js';\nimport './contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport './contrib/gotoError/browser/gotoError.js';\nimport './contrib/hover/browser/hover.js';\nimport './contrib/indentation/browser/indentation.js';\nimport './contrib/inlayHints/browser/inlayHintsContribution.js';\nimport './contrib/inPlaceReplace/browser/inPlaceReplace.js';\nimport './contrib/lineSelection/browser/lineSelection.js';\nimport './contrib/linesOperations/browser/linesOperations.js';\nimport './contrib/linkedEditing/browser/linkedEditing.js';\nimport './contrib/links/browser/links.js';\nimport './contrib/longLinesHelper/browser/longLinesHelper.js';\nimport './contrib/multicursor/browser/multicursor.js';\nimport './contrib/inlineEdit/browser/inlineEdit.contribution.js';\nimport './contrib/parameterHints/browser/parameterHints.js';\nimport './contrib/rename/browser/rename.js';\nimport './contrib/semanticTokens/browser/documentSemanticTokens.js';\nimport './contrib/semanticTokens/browser/viewportSemanticTokens.js';\nimport './contrib/smartSelect/browser/smartSelect.js';\nimport './contrib/snippet/browser/snippetController2.js';\nimport './contrib/stickyScroll/browser/stickyScrollContribution.js';\nimport './contrib/suggest/browser/suggestController.js';\nimport './contrib/suggest/browser/suggestInlineCompletions.js';\nimport './contrib/tokenization/browser/tokenization.js';\nimport './contrib/toggleTabFocusMode/browser/toggleTabFocusMode.js';\nimport './contrib/unicodeHighlighter/browser/unicodeHighlighter.js';\nimport './contrib/unusualLineTerminators/browser/unusualLineTerminators.js';\nimport './contrib/wordHighlighter/browser/wordHighlighter.js';\nimport './contrib/wordOperations/browser/wordOperations.js';\nimport './contrib/wordPartOperations/browser/wordPartOperations.js';\nimport './contrib/readOnlyMessage/browser/contribution.js';\nimport './contrib/diffEditorBreadcrumbs/browser/contribution.js';\n// Load up these strings even in VSCode, even if they are not used\n// in order to get them translated\nimport './common/standaloneStrings.js';\nimport '../base/browser/ui/codicons/codiconStyles.js'; // The codicons are defined here and must be loaded\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { CursorMoveCommands } from '../../../common/cursor/cursorMoveCommands.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nexport class ExpandLineSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'expandLineSelection',\n            label: nls.localize('expandLineSelection', \"Expand Line Selection\"),\n            alias: 'Expand Line Selection',\n            precondition: undefined,\n            kbOpts: {\n                weight: 0 /* KeybindingWeight.EditorCore */,\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */\n            },\n        });\n    }\n    run(_accessor, editor, args) {\n        args = args || {};\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        viewModel.model.pushStackElement();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.expandLineSelection(viewModel, viewModel.getCursorStates()));\n        viewModel.revealPrimaryCursor(args.source, true);\n    }\n}\nregisterEditorAction(ExpandLineSelectionAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { CoreEditingCommands } from '../../../browser/coreCommands.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection, ReplaceCommandThatSelectsText } from '../../../common/commands/replaceCommand.js';\nimport { TrimTrailingWhitespaceCommand } from '../../../common/commands/trimTrailingWhitespaceCommand.js';\nimport { TypeOperations } from '../../../common/cursor/cursorTypeOperations.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CopyLinesCommand } from './copyLinesCommand.js';\nimport { MoveLinesCommand } from './moveLinesCommand.js';\nimport { SortLinesCommand } from './sortLinesCommand.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\n// copy lines\nclass AbstractCopyLinesAction extends EditorAction {\n    constructor(down, opts) {\n        super(opts);\n        this.down = down;\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignore: false }));\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        // Remove selections that would result in copying the same line\n        let prev = selections[0];\n        for (let i = 1; i < selections.length; i++) {\n            const curr = selections[i];\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\n                // these two selections would copy the same line\n                if (prev.index < curr.index) {\n                    // prev wins\n                    curr.ignore = true;\n                }\n                else {\n                    // curr wins\n                    prev.ignore = true;\n                    prev = curr;\n                }\n            }\n        }\n        const commands = [];\n        for (const selection of selections) {\n            commands.push(new CopyLinesCommand(selection.selection, this.down, selection.ignore));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass CopyLinesUpAction extends AbstractCopyLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.copyLinesUpAction',\n            label: nls.localize('lines.copyUp', \"Copy Line Up\"),\n            alias: 'Copy Line Up',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miCopyLinesUp', comment: ['&& denotes a mnemonic'] }, \"&&Copy Line Up\"),\n                order: 1\n            }\n        });\n    }\n}\nclass CopyLinesDownAction extends AbstractCopyLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.copyLinesDownAction',\n            label: nls.localize('lines.copyDown', \"Copy Line Down\"),\n            alias: 'Copy Line Down',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miCopyLinesDown', comment: ['&& denotes a mnemonic'] }, \"Co&&py Line Down\"),\n                order: 2\n            }\n        });\n    }\n}\nexport class DuplicateSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.duplicateSelection',\n            label: nls.localize('duplicateSelection', \"Duplicate Selection\"),\n            alias: 'Duplicate Selection',\n            precondition: EditorContextKeys.writable,\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miDuplicateSelection', comment: ['&& denotes a mnemonic'] }, \"&&Duplicate Selection\"),\n                order: 5\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commands = [];\n        const selections = editor.getSelections();\n        const model = editor.getModel();\n        for (const selection of selections) {\n            if (selection.isEmpty()) {\n                commands.push(new CopyLinesCommand(selection, true));\n            }\n            else {\n                const insertSelection = new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn);\n                commands.push(new ReplaceCommandThatSelectsText(insertSelection, model.getValueInRange(selection)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\n// move lines\nclass AbstractMoveLinesAction extends EditorAction {\n    constructor(down, opts) {\n        super(opts);\n        this.down = down;\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const commands = [];\n        const selections = editor.getSelections() || [];\n        const autoIndent = editor.getOption(12 /* EditorOption.autoIndent */);\n        for (const selection of selections) {\n            commands.push(new MoveLinesCommand(selection, this.down, autoIndent, languageConfigurationService));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass MoveLinesUpAction extends AbstractMoveLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.moveLinesUpAction',\n            label: nls.localize('lines.moveUp', \"Move Line Up\"),\n            alias: 'Move Line Up',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                linux: { primary: 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miMoveLinesUp', comment: ['&& denotes a mnemonic'] }, \"Mo&&ve Line Up\"),\n                order: 3\n            }\n        });\n    }\n}\nclass MoveLinesDownAction extends AbstractMoveLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.moveLinesDownAction',\n            label: nls.localize('lines.moveDown', \"Move Line Down\"),\n            alias: 'Move Line Down',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                linux: { primary: 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miMoveLinesDown', comment: ['&& denotes a mnemonic'] }, \"Move &&Line Down\"),\n                order: 4\n            }\n        });\n    }\n}\nexport class AbstractSortLinesAction extends EditorAction {\n    constructor(descending, opts) {\n        super(opts);\n        this.descending = descending;\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections() || [];\n        for (const selection of selections) {\n            if (!SortLinesCommand.canRun(editor.getModel(), selection, this.descending)) {\n                return;\n            }\n        }\n        const commands = [];\n        for (let i = 0, len = selections.length; i < len; i++) {\n            commands[i] = new SortLinesCommand(selections[i], this.descending);\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class SortLinesAscendingAction extends AbstractSortLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.sortLinesAscending',\n            label: nls.localize('lines.sortAscending', \"Sort Lines Ascending\"),\n            alias: 'Sort Lines Ascending',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class SortLinesDescendingAction extends AbstractSortLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.sortLinesDescending',\n            label: nls.localize('lines.sortDescending', \"Sort Lines Descending\"),\n            alias: 'Sort Lines Descending',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteDuplicateLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.removeDuplicateLines',\n            label: nls.localize('lines.deleteDuplicates', \"Delete Duplicate Lines\"),\n            alias: 'Delete Duplicate Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n            return;\n        }\n        const edits = [];\n        const endCursorState = [];\n        let linesDeleted = 0;\n        for (const selection of editor.getSelections()) {\n            const uniqueLines = new Set();\n            const lines = [];\n            for (let i = selection.startLineNumber; i <= selection.endLineNumber; i++) {\n                const line = model.getLineContent(i);\n                if (uniqueLines.has(line)) {\n                    continue;\n                }\n                lines.push(line);\n                uniqueLines.add(line);\n            }\n            const selectionToReplace = new Selection(selection.startLineNumber, 1, selection.endLineNumber, model.getLineMaxColumn(selection.endLineNumber));\n            const adjustedSelectionStart = selection.startLineNumber - linesDeleted;\n            const finalSelection = new Selection(adjustedSelectionStart, 1, adjustedSelectionStart + lines.length - 1, lines[lines.length - 1].length);\n            edits.push(EditOperation.replace(selectionToReplace, lines.join('\\n')));\n            endCursorState.push(finalSelection);\n            linesDeleted += (selection.endLineNumber - selection.startLineNumber + 1) - lines.length;\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class TrimTrailingWhitespaceAction extends EditorAction {\n    constructor() {\n        super({\n            id: TrimTrailingWhitespaceAction.ID,\n            label: nls.localize('lines.trimTrailingWhitespace', \"Trim Trailing Whitespace\"),\n            alias: 'Trim Trailing Whitespace',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        let cursors = [];\n        if (args.reason === 'auto-save') {\n            // See https://github.com/editorconfig/editorconfig-vscode/issues/47\n            // It is very convenient for the editor config extension to invoke this action.\n            // So, if we get a reason:'auto-save' passed in, let's preserve cursor positions.\n            cursors = (editor.getSelections() || []).map(s => new Position(s.positionLineNumber, s.positionColumn));\n        }\n        const selection = editor.getSelection();\n        if (selection === null) {\n            return;\n        }\n        const command = new TrimTrailingWhitespaceCommand(selection, cursors);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n    }\n}\nTrimTrailingWhitespaceAction.ID = 'editor.action.trimTrailingWhitespace';\nexport class DeleteLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.deleteLines',\n            label: nls.localize('lines.delete', \"Delete Line\"),\n            alias: 'Delete Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 41 /* KeyCode.KeyK */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const ops = this._getLinesToRemove(editor);\n        const model = editor.getModel();\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n            // Model is empty\n            return;\n        }\n        let linesDeleted = 0;\n        const edits = [];\n        const cursorState = [];\n        for (let i = 0, len = ops.length; i < len; i++) {\n            const op = ops[i];\n            let startLineNumber = op.startLineNumber;\n            let endLineNumber = op.endLineNumber;\n            let startColumn = 1;\n            let endColumn = model.getLineMaxColumn(endLineNumber);\n            if (endLineNumber < model.getLineCount()) {\n                endLineNumber += 1;\n                endColumn = 1;\n            }\n            else if (startLineNumber > 1) {\n                startLineNumber -= 1;\n                startColumn = model.getLineMaxColumn(startLineNumber);\n            }\n            edits.push(EditOperation.replace(new Selection(startLineNumber, startColumn, endLineNumber, endColumn), ''));\n            cursorState.push(new Selection(startLineNumber - linesDeleted, op.positionColumn, startLineNumber - linesDeleted, op.positionColumn));\n            linesDeleted += (op.endLineNumber - op.startLineNumber + 1);\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, cursorState);\n        editor.pushUndoStop();\n    }\n    _getLinesToRemove(editor) {\n        // Construct delete operations\n        const operations = editor.getSelections().map((s) => {\n            let endLineNumber = s.endLineNumber;\n            if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n                endLineNumber -= 1;\n            }\n            return {\n                startLineNumber: s.startLineNumber,\n                selectionStartColumn: s.selectionStartColumn,\n                endLineNumber: endLineNumber,\n                positionColumn: s.positionColumn\n            };\n        });\n        // Sort delete operations\n        operations.sort((a, b) => {\n            if (a.startLineNumber === b.startLineNumber) {\n                return a.endLineNumber - b.endLineNumber;\n            }\n            return a.startLineNumber - b.startLineNumber;\n        });\n        // Merge delete operations which are adjacent or overlapping\n        const mergedOperations = [];\n        let previousOperation = operations[0];\n        for (let i = 1; i < operations.length; i++) {\n            if (previousOperation.endLineNumber + 1 >= operations[i].startLineNumber) {\n                // Merge current operations into the previous one\n                previousOperation.endLineNumber = operations[i].endLineNumber;\n            }\n            else {\n                // Push previous operation\n                mergedOperations.push(previousOperation);\n                previousOperation = operations[i];\n            }\n        }\n        // Push the last operation\n        mergedOperations.push(previousOperation);\n        return mergedOperations;\n    }\n}\nexport class IndentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.indentLines',\n            label: nls.localize('lines.indent', \"Indent Line\"),\n            alias: 'Indent Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 94 /* KeyCode.BracketRight */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, TypeOperations.indent(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n        editor.pushUndoStop();\n    }\n}\nclass OutdentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.outdentLines',\n            label: nls.localize('lines.outdent', \"Outdent Line\"),\n            alias: 'Outdent Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 92 /* KeyCode.BracketLeft */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        CoreEditingCommands.Outdent.runEditorCommand(_accessor, editor, null);\n    }\n}\nexport class InsertLineBeforeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertLineBefore',\n            label: nls.localize('lines.insertBefore', \"Insert Line Above\"),\n            alias: 'Insert Line Above',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, TypeOperations.lineInsertBefore(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n    }\n}\nexport class InsertLineAfterAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertLineAfter',\n            label: nls.localize('lines.insertAfter', \"Insert Line Below\"),\n            alias: 'Insert Line Below',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, TypeOperations.lineInsertAfter(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n    }\n}\nexport class AbstractDeleteAllToBoundaryAction extends EditorAction {\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const primaryCursor = editor.getSelection();\n        const rangesToDelete = this._getRangesToDelete(editor);\n        // merge overlapping selections\n        const effectiveRanges = [];\n        for (let i = 0, count = rangesToDelete.length - 1; i < count; i++) {\n            const range = rangesToDelete[i];\n            const nextRange = rangesToDelete[i + 1];\n            if (Range.intersectRanges(range, nextRange) === null) {\n                effectiveRanges.push(range);\n            }\n            else {\n                rangesToDelete[i + 1] = Range.plusRange(range, nextRange);\n            }\n        }\n        effectiveRanges.push(rangesToDelete[rangesToDelete.length - 1]);\n        const endCursorState = this._getEndCursorState(primaryCursor, effectiveRanges);\n        const edits = effectiveRanges.map(range => {\n            return EditOperation.replace(range, '');\n        });\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class DeleteAllLeftAction extends AbstractDeleteAllToBoundaryAction {\n    constructor() {\n        super({\n            id: 'deleteAllLeft',\n            label: nls.localize('lines.deleteAllLeft', \"Delete All Left\"),\n            alias: 'Delete All Left',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _getEndCursorState(primaryCursor, rangesToDelete) {\n        let endPrimaryCursor = null;\n        const endCursorState = [];\n        let deletedLines = 0;\n        rangesToDelete.forEach(range => {\n            let endCursor;\n            if (range.endColumn === 1 && deletedLines > 0) {\n                const newStartLine = range.startLineNumber - deletedLines;\n                endCursor = new Selection(newStartLine, range.startColumn, newStartLine, range.startColumn);\n            }\n            else {\n                endCursor = new Selection(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\n            }\n            deletedLines += range.endLineNumber - range.startLineNumber;\n            if (range.intersectRanges(primaryCursor)) {\n                endPrimaryCursor = endCursor;\n            }\n            else {\n                endCursorState.push(endCursor);\n            }\n        });\n        if (endPrimaryCursor) {\n            endCursorState.unshift(endPrimaryCursor);\n        }\n        return endCursorState;\n    }\n    _getRangesToDelete(editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return [];\n        }\n        let rangesToDelete = selections;\n        const model = editor.getModel();\n        if (model === null) {\n            return [];\n        }\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\n        rangesToDelete = rangesToDelete.map(selection => {\n            if (selection.isEmpty()) {\n                if (selection.startColumn === 1) {\n                    const deleteFromLine = Math.max(1, selection.startLineNumber - 1);\n                    const deleteFromColumn = selection.startLineNumber === 1 ? 1 : model.getLineLength(deleteFromLine) + 1;\n                    return new Range(deleteFromLine, deleteFromColumn, selection.startLineNumber, 1);\n                }\n                else {\n                    return new Range(selection.startLineNumber, 1, selection.startLineNumber, selection.startColumn);\n                }\n            }\n            else {\n                return new Range(selection.startLineNumber, 1, selection.endLineNumber, selection.endColumn);\n            }\n        });\n        return rangesToDelete;\n    }\n}\nexport class DeleteAllRightAction extends AbstractDeleteAllToBoundaryAction {\n    constructor() {\n        super({\n            id: 'deleteAllRight',\n            label: nls.localize('lines.deleteAllRight', \"Delete All Right\"),\n            alias: 'Delete All Right',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 41 /* KeyCode.KeyK */, secondary: [2048 /* KeyMod.CtrlCmd */ | 20 /* KeyCode.Delete */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _getEndCursorState(primaryCursor, rangesToDelete) {\n        let endPrimaryCursor = null;\n        const endCursorState = [];\n        for (let i = 0, len = rangesToDelete.length, offset = 0; i < len; i++) {\n            const range = rangesToDelete[i];\n            const endCursor = new Selection(range.startLineNumber - offset, range.startColumn, range.startLineNumber - offset, range.startColumn);\n            if (range.intersectRanges(primaryCursor)) {\n                endPrimaryCursor = endCursor;\n            }\n            else {\n                endCursorState.push(endCursor);\n            }\n        }\n        if (endPrimaryCursor) {\n            endCursorState.unshift(endPrimaryCursor);\n        }\n        return endCursorState;\n    }\n    _getRangesToDelete(editor) {\n        const model = editor.getModel();\n        if (model === null) {\n            return [];\n        }\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return [];\n        }\n        const rangesToDelete = selections.map((sel) => {\n            if (sel.isEmpty()) {\n                const maxColumn = model.getLineMaxColumn(sel.startLineNumber);\n                if (sel.startColumn === maxColumn) {\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber + 1, 1);\n                }\n                else {\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber, maxColumn);\n                }\n            }\n            return sel;\n        });\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\n        return rangesToDelete;\n    }\n}\nexport class JoinLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.joinLines',\n            label: nls.localize('lines.joinLines', \"Join Lines\"),\n            alias: 'Join Lines',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 40 /* KeyCode.KeyJ */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        let primaryCursor = editor.getSelection();\n        if (primaryCursor === null) {\n            return;\n        }\n        selections.sort(Range.compareRangesUsingStarts);\n        const reducedSelections = [];\n        const lastSelection = selections.reduce((previousValue, currentValue) => {\n            if (previousValue.isEmpty()) {\n                if (previousValue.endLineNumber === currentValue.startLineNumber) {\n                    if (primaryCursor.equalsSelection(previousValue)) {\n                        primaryCursor = currentValue;\n                    }\n                    return currentValue;\n                }\n                if (currentValue.startLineNumber > previousValue.endLineNumber + 1) {\n                    reducedSelections.push(previousValue);\n                    return currentValue;\n                }\n                else {\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\n                }\n            }\n            else {\n                if (currentValue.startLineNumber > previousValue.endLineNumber) {\n                    reducedSelections.push(previousValue);\n                    return currentValue;\n                }\n                else {\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\n                }\n            }\n        });\n        reducedSelections.push(lastSelection);\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const edits = [];\n        const endCursorState = [];\n        let endPrimaryCursor = primaryCursor;\n        let lineOffset = 0;\n        for (let i = 0, len = reducedSelections.length; i < len; i++) {\n            const selection = reducedSelections[i];\n            const startLineNumber = selection.startLineNumber;\n            const startColumn = 1;\n            let columnDeltaOffset = 0;\n            let endLineNumber, endColumn;\n            const selectionEndPositionOffset = model.getLineLength(selection.endLineNumber) - selection.endColumn;\n            if (selection.isEmpty() || selection.startLineNumber === selection.endLineNumber) {\n                const position = selection.getStartPosition();\n                if (position.lineNumber < model.getLineCount()) {\n                    endLineNumber = startLineNumber + 1;\n                    endColumn = model.getLineMaxColumn(endLineNumber);\n                }\n                else {\n                    endLineNumber = position.lineNumber;\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\n                }\n            }\n            else {\n                endLineNumber = selection.endLineNumber;\n                endColumn = model.getLineMaxColumn(endLineNumber);\n            }\n            let trimmedLinesContent = model.getLineContent(startLineNumber);\n            for (let i = startLineNumber + 1; i <= endLineNumber; i++) {\n                const lineText = model.getLineContent(i);\n                const firstNonWhitespaceIdx = model.getLineFirstNonWhitespaceColumn(i);\n                if (firstNonWhitespaceIdx >= 1) {\n                    let insertSpace = true;\n                    if (trimmedLinesContent === '') {\n                        insertSpace = false;\n                    }\n                    if (insertSpace && (trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === ' ' ||\n                        trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === '\\t')) {\n                        insertSpace = false;\n                        trimmedLinesContent = trimmedLinesContent.replace(/[\\s\\uFEFF\\xA0]+$/g, ' ');\n                    }\n                    const lineTextWithoutIndent = lineText.substr(firstNonWhitespaceIdx - 1);\n                    trimmedLinesContent += (insertSpace ? ' ' : '') + lineTextWithoutIndent;\n                    if (insertSpace) {\n                        columnDeltaOffset = lineTextWithoutIndent.length + 1;\n                    }\n                    else {\n                        columnDeltaOffset = lineTextWithoutIndent.length;\n                    }\n                }\n                else {\n                    columnDeltaOffset = 0;\n                }\n            }\n            const deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\n            if (!deleteSelection.isEmpty()) {\n                let resultSelection;\n                if (selection.isEmpty()) {\n                    edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                    resultSelection = new Selection(deleteSelection.startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1, startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1);\n                }\n                else {\n                    if (selection.startLineNumber === selection.endLineNumber) {\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.endLineNumber - lineOffset, selection.endColumn);\n                    }\n                    else {\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.startLineNumber - lineOffset, trimmedLinesContent.length - selectionEndPositionOffset);\n                    }\n                }\n                if (Range.intersectRanges(deleteSelection, primaryCursor) !== null) {\n                    endPrimaryCursor = resultSelection;\n                }\n                else {\n                    endCursorState.push(resultSelection);\n                }\n            }\n            lineOffset += deleteSelection.endLineNumber - deleteSelection.startLineNumber;\n        }\n        endCursorState.unshift(endPrimaryCursor);\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class TransposeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.transpose',\n            label: nls.localize('editor.transpose', \"Transpose Characters around the Cursor\"),\n            alias: 'Transpose Characters around the Cursor',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const commands = [];\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            if (!selection.isEmpty()) {\n                continue;\n            }\n            const cursor = selection.getStartPosition();\n            const maxColumn = model.getLineMaxColumn(cursor.lineNumber);\n            if (cursor.column >= maxColumn) {\n                if (cursor.lineNumber === model.getLineCount()) {\n                    continue;\n                }\n                // The cursor is at the end of current line and current line is not empty\n                // then we transpose the character before the cursor and the line break if there is any following line.\n                const deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1);\n                const chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\n                commands.push(new ReplaceCommand(new Selection(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1), chars));\n            }\n            else {\n                const deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber, cursor.column + 1);\n                const chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\n                commands.push(new ReplaceCommandThatPreservesSelection(deleteSelection, chars, new Selection(cursor.lineNumber, cursor.column + 1, cursor.lineNumber, cursor.column + 1)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class AbstractCaseAction extends EditorAction {\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const wordSeparators = editor.getOption(130 /* EditorOption.wordSeparators */);\n        const textEdits = [];\n        for (const selection of selections) {\n            if (selection.isEmpty()) {\n                const cursor = selection.getStartPosition();\n                const word = editor.getConfiguredWordAtPosition(cursor);\n                if (!word) {\n                    continue;\n                }\n                const wordRange = new Range(cursor.lineNumber, word.startColumn, cursor.lineNumber, word.endColumn);\n                const text = model.getValueInRange(wordRange);\n                textEdits.push(EditOperation.replace(wordRange, this._modifyText(text, wordSeparators)));\n            }\n            else {\n                const text = model.getValueInRange(selection);\n                textEdits.push(EditOperation.replace(selection, this._modifyText(text, wordSeparators)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, textEdits);\n        editor.pushUndoStop();\n    }\n}\nexport class UpperCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToUppercase',\n            label: nls.localize('editor.transformToUppercase', \"Transform to Uppercase\"),\n            alias: 'Transform to Uppercase',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        return text.toLocaleUpperCase();\n    }\n}\nexport class LowerCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToLowercase',\n            label: nls.localize('editor.transformToLowercase', \"Transform to Lowercase\"),\n            alias: 'Transform to Lowercase',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        return text.toLocaleLowerCase();\n    }\n}\nclass BackwardsCompatibleRegExp {\n    constructor(_pattern, _flags) {\n        this._pattern = _pattern;\n        this._flags = _flags;\n        this._actual = null;\n        this._evaluated = false;\n    }\n    get() {\n        if (!this._evaluated) {\n            this._evaluated = true;\n            try {\n                this._actual = new RegExp(this._pattern, this._flags);\n            }\n            catch (err) {\n                // this browser does not support this regular expression\n            }\n        }\n        return this._actual;\n    }\n    isSupported() {\n        return (this.get() !== null);\n    }\n}\nexport class TitleCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToTitlecase',\n            label: nls.localize('editor.transformToTitlecase', \"Transform to Title Case\"),\n            alias: 'Transform to Title Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const titleBoundary = TitleCaseAction.titleBoundary.get();\n        if (!titleBoundary) {\n            // cannot support this\n            return text;\n        }\n        return text\n            .toLocaleLowerCase()\n            .replace(titleBoundary, (b) => b.toLocaleUpperCase());\n    }\n}\nTitleCaseAction.titleBoundary = new BackwardsCompatibleRegExp('(^|[^\\\\p{L}\\\\p{N}\\']|((^|\\\\P{L})\\'))\\\\p{L}', 'gmu');\nexport class SnakeCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToSnakecase',\n            label: nls.localize('editor.transformToSnakecase', \"Transform to Snake Case\"),\n            alias: 'Transform to Snake Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const caseBoundary = SnakeCaseAction.caseBoundary.get();\n        const singleLetters = SnakeCaseAction.singleLetters.get();\n        if (!caseBoundary || !singleLetters) {\n            // cannot support this\n            return text;\n        }\n        return (text\n            .replace(caseBoundary, '$1_$2')\n            .replace(singleLetters, '$1_$2$3')\n            .toLocaleLowerCase());\n    }\n}\nSnakeCaseAction.caseBoundary = new BackwardsCompatibleRegExp('(\\\\p{Ll})(\\\\p{Lu})', 'gmu');\nSnakeCaseAction.singleLetters = new BackwardsCompatibleRegExp('(\\\\p{Lu}|\\\\p{N})(\\\\p{Lu})(\\\\p{Ll})', 'gmu');\nexport class CamelCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToCamelcase',\n            label: nls.localize('editor.transformToCamelcase', \"Transform to Camel Case\"),\n            alias: 'Transform to Camel Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const wordBoundary = CamelCaseAction.wordBoundary.get();\n        if (!wordBoundary) {\n            // cannot support this\n            return text;\n        }\n        const words = text.split(wordBoundary);\n        const firstWord = words.shift();\n        return firstWord + words.map((word) => word.substring(0, 1).toLocaleUpperCase() + word.substring(1))\n            .join('');\n    }\n}\nCamelCaseAction.wordBoundary = new BackwardsCompatibleRegExp('[_\\\\s-]', 'gm');\nexport class KebabCaseAction extends AbstractCaseAction {\n    static isSupported() {\n        const areAllRegexpsSupported = [\n            this.caseBoundary,\n            this.singleLetters,\n            this.underscoreBoundary,\n        ].every((regexp) => regexp.isSupported());\n        return areAllRegexpsSupported;\n    }\n    constructor() {\n        super({\n            id: 'editor.action.transformToKebabcase',\n            label: nls.localize('editor.transformToKebabcase', 'Transform to Kebab Case'),\n            alias: 'Transform to Kebab Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, _) {\n        const caseBoundary = KebabCaseAction.caseBoundary.get();\n        const singleLetters = KebabCaseAction.singleLetters.get();\n        const underscoreBoundary = KebabCaseAction.underscoreBoundary.get();\n        if (!caseBoundary || !singleLetters || !underscoreBoundary) {\n            // one or more regexps aren't supported\n            return text;\n        }\n        return text\n            .replace(underscoreBoundary, '$1-$3')\n            .replace(caseBoundary, '$1-$2')\n            .replace(singleLetters, '$1-$2')\n            .toLocaleLowerCase();\n    }\n}\nKebabCaseAction.caseBoundary = new BackwardsCompatibleRegExp('(\\\\p{Ll})(\\\\p{Lu})', 'gmu');\nKebabCaseAction.singleLetters = new BackwardsCompatibleRegExp('(\\\\p{Lu}|\\\\p{N})(\\\\p{Lu}\\\\p{Ll})', 'gmu');\nKebabCaseAction.underscoreBoundary = new BackwardsCompatibleRegExp('(\\\\S)(_)(\\\\S)', 'gm');\nregisterEditorAction(CopyLinesUpAction);\nregisterEditorAction(CopyLinesDownAction);\nregisterEditorAction(DuplicateSelectionAction);\nregisterEditorAction(MoveLinesUpAction);\nregisterEditorAction(MoveLinesDownAction);\nregisterEditorAction(SortLinesAscendingAction);\nregisterEditorAction(SortLinesDescendingAction);\nregisterEditorAction(DeleteDuplicateLinesAction);\nregisterEditorAction(TrimTrailingWhitespaceAction);\nregisterEditorAction(DeleteLinesAction);\nregisterEditorAction(IndentLinesAction);\nregisterEditorAction(OutdentLinesAction);\nregisterEditorAction(InsertLineBeforeAction);\nregisterEditorAction(InsertLineAfterAction);\nregisterEditorAction(DeleteAllLeftAction);\nregisterEditorAction(DeleteAllRightAction);\nregisterEditorAction(JoinLinesAction);\nregisterEditorAction(TransposeAction);\nregisterEditorAction(UpperCaseAction);\nregisterEditorAction(LowerCaseAction);\nif (SnakeCaseAction.caseBoundary.isSupported() && SnakeCaseAction.singleLetters.isSupported()) {\n    registerEditorAction(SnakeCaseAction);\n}\nif (CamelCaseAction.wordBoundary.isSupported()) {\n    registerEditorAction(CamelCaseAction);\n}\nif (TitleCaseAction.titleBoundary.isSupported()) {\n    registerEditorAction(TitleCaseAction);\n}\nif (KebabCaseAction.isSupported()) {\n    registerEditorAction(KebabCaseAction);\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../base/common/strings.js';\nimport { EditOperation } from '../core/editOperation.js';\nimport { Range } from '../core/range.js';\nexport class TrimTrailingWhitespaceCommand {\n    constructor(selection, cursors) {\n        this._selection = selection;\n        this._cursors = cursors;\n        this._selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        const ops = trimTrailingWhitespace(model, this._cursors);\n        for (let i = 0, len = ops.length; i < len; i++) {\n            const op = ops[i];\n            builder.addEditOperation(op.range, op.text);\n        }\n        this._selectionId = builder.trackSelection(this._selection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._selectionId);\n    }\n}\n/**\n * Generate commands for trimming trailing whitespace on a model and ignore lines on which cursors are sitting.\n */\nexport function trimTrailingWhitespace(model, cursors) {\n    // Sort cursors ascending\n    cursors.sort((a, b) => {\n        if (a.lineNumber === b.lineNumber) {\n            return a.column - b.column;\n        }\n        return a.lineNumber - b.lineNumber;\n    });\n    // Reduce multiple cursors on the same line and only keep the last one on the line\n    for (let i = cursors.length - 2; i >= 0; i--) {\n        if (cursors[i].lineNumber === cursors[i + 1].lineNumber) {\n            // Remove cursor at `i`\n            cursors.splice(i, 1);\n        }\n    }\n    const r = [];\n    let rLen = 0;\n    let cursorIndex = 0;\n    const cursorLen = cursors.length;\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n        const lineContent = model.getLineContent(lineNumber);\n        const maxLineColumn = lineContent.length + 1;\n        let minEditColumn = 0;\n        if (cursorIndex < cursorLen && cursors[cursorIndex].lineNumber === lineNumber) {\n            minEditColumn = cursors[cursorIndex].column;\n            cursorIndex++;\n            if (minEditColumn === maxLineColumn) {\n                // The cursor is at the end of the line => no edits for sure on this line\n                continue;\n            }\n        }\n        if (lineContent.length === 0) {\n            continue;\n        }\n        const lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\n        let fromColumn = 0;\n        if (lastNonWhitespaceIndex === -1) {\n            // Entire line is whitespace\n            fromColumn = 1;\n        }\n        else if (lastNonWhitespaceIndex !== lineContent.length - 1) {\n            // There is trailing whitespace\n            fromColumn = lastNonWhitespaceIndex + 2;\n        }\n        else {\n            // There is no trailing whitespace\n            continue;\n        }\n        fromColumn = Math.max(minEditColumn, fromColumn);\n        r[rLen++] = EditOperation.delete(new Range(lineNumber, fromColumn, lineNumber, maxLineColumn));\n    }\n    return r;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class CopyLinesCommand {\n    constructor(selection, isCopyingDown, noop) {\n        this._selection = selection;\n        this._isCopyingDown = isCopyingDown;\n        this._noop = noop || false;\n        this._selectionDirection = 0 /* SelectionDirection.LTR */;\n        this._selectionId = null;\n        this._startLineNumberDelta = 0;\n        this._endLineNumberDelta = 0;\n    }\n    getEditOperations(model, builder) {\n        let s = this._selection;\n        this._startLineNumberDelta = 0;\n        this._endLineNumberDelta = 0;\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._endLineNumberDelta = 1;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const sourceLines = [];\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\n            sourceLines.push(model.getLineContent(i));\n        }\n        const sourceText = sourceLines.join('\\n');\n        if (sourceText === '') {\n            // Duplicating empty line\n            if (this._isCopyingDown) {\n                this._startLineNumberDelta++;\n                this._endLineNumberDelta++;\n            }\n        }\n        if (this._noop) {\n            builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber + 1, 1), s.endLineNumber === model.getLineCount() ? '' : '\\n');\n        }\n        else {\n            if (!this._isCopyingDown) {\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + sourceText);\n            }\n            else {\n                builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), sourceText + '\\n');\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n        this._selectionDirection = this._selection.getDirection();\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._startLineNumberDelta !== 0 || this._endLineNumberDelta !== 0) {\n            let startLineNumber = result.startLineNumber;\n            let startColumn = result.startColumn;\n            let endLineNumber = result.endLineNumber;\n            let endColumn = result.endColumn;\n            if (this._startLineNumberDelta !== 0) {\n                startLineNumber = startLineNumber + this._startLineNumberDelta;\n                startColumn = 1;\n            }\n            if (this._endLineNumberDelta !== 0) {\n                endLineNumber = endLineNumber + this._endLineNumberDelta;\n                endColumn = 1;\n            }\n            result = Selection.createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, this._selectionDirection);\n        }\n        return result;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as strings from '../../../../base/common/strings.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IndentAction } from '../../../common/languages/languageConfiguration.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as indentUtils from '../../indentation/browser/indentUtils.js';\nimport { getGoodIndentForLine, getIndentMetadata } from '../../../common/languages/autoIndent.js';\nimport { getEnterAction } from '../../../common/languages/enterAction.js';\nlet MoveLinesCommand = class MoveLinesCommand {\n    constructor(selection, isMovingDown, autoIndent, _languageConfigurationService) {\n        this._languageConfigurationService = _languageConfigurationService;\n        this._selection = selection;\n        this._isMovingDown = isMovingDown;\n        this._autoIndent = autoIndent;\n        this._selectionId = null;\n        this._moveEndLineSelectionShrink = false;\n    }\n    getEditOperations(model, builder) {\n        const modelLineCount = model.getLineCount();\n        if (this._isMovingDown && this._selection.endLineNumber === modelLineCount) {\n            this._selectionId = builder.trackSelection(this._selection);\n            return;\n        }\n        if (!this._isMovingDown && this._selection.startLineNumber === 1) {\n            this._selectionId = builder.trackSelection(this._selection);\n            return;\n        }\n        this._moveEndPositionDown = false;\n        let s = this._selection;\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._moveEndPositionDown = true;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        const indentConverter = this.buildIndentConverter(tabSize, indentSize, insertSpaces);\n        const virtualModel = {\n            tokenization: {\n                getLineTokens: (lineNumber) => {\n                    return model.tokenization.getLineTokens(lineNumber);\n                },\n                getLanguageId: () => {\n                    return model.getLanguageId();\n                },\n                getLanguageIdAtPosition: (lineNumber, column) => {\n                    return model.getLanguageIdAtPosition(lineNumber, column);\n                },\n            },\n            getLineContent: null,\n        };\n        if (s.startLineNumber === s.endLineNumber && model.getLineMaxColumn(s.startLineNumber) === 1) {\n            // Current line is empty\n            const lineNumber = s.startLineNumber;\n            const otherLineNumber = (this._isMovingDown ? lineNumber + 1 : lineNumber - 1);\n            if (model.getLineMaxColumn(otherLineNumber) === 1) {\n                // Other line number is empty too, so no editing is needed\n                // Add a no-op to force running by the model\n                builder.addEditOperation(new Range(1, 1, 1, 1), null);\n            }\n            else {\n                // Type content from other line number on line number\n                builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), model.getLineContent(otherLineNumber));\n                // Remove content from other line number\n                builder.addEditOperation(new Range(otherLineNumber, 1, otherLineNumber, model.getLineMaxColumn(otherLineNumber)), null);\n            }\n            // Track selection at the other line number\n            s = new Selection(otherLineNumber, 1, otherLineNumber, 1);\n        }\n        else {\n            let movingLineNumber;\n            let movingLineText;\n            if (this._isMovingDown) {\n                movingLineNumber = s.endLineNumber + 1;\n                movingLineText = model.getLineContent(movingLineNumber);\n                // Delete line that needs to be moved\n                builder.addEditOperation(new Range(movingLineNumber - 1, model.getLineMaxColumn(movingLineNumber - 1), movingLineNumber, model.getLineMaxColumn(movingLineNumber)), null);\n                let insertingText = movingLineText;\n                if (this.shouldAutoIndent(model, s)) {\n                    const movingLineMatchResult = this.matchEnterRule(model, indentConverter, tabSize, movingLineNumber, s.startLineNumber - 1);\n                    // if s.startLineNumber - 1 matches onEnter rule, we still honor that.\n                    if (movingLineMatchResult !== null) {\n                        const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\n                        const newSpaceCnt = movingLineMatchResult + indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                        const newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                        insertingText = newIndentation + this.trimStart(movingLineText);\n                    }\n                    else {\n                        // no enter rule matches, let's check indentatin rules then.\n                        virtualModel.getLineContent = (lineNumber) => {\n                            if (lineNumber === s.startLineNumber) {\n                                return model.getLineContent(movingLineNumber);\n                            }\n                            else {\n                                return model.getLineContent(lineNumber);\n                            }\n                        };\n                        const indentOfMovingLine = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber, indentConverter, this._languageConfigurationService);\n                        if (indentOfMovingLine !== null) {\n                            const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(indentOfMovingLine, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                                insertingText = newIndentation + this.trimStart(movingLineText);\n                            }\n                        }\n                    }\n                    // add edit operations for moving line first to make sure it's executed after we make indentation change\n                    // to s.startLineNumber\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\n                    const ret = this.matchEnterRuleMovingDown(model, indentConverter, tabSize, s.startLineNumber, movingLineNumber, insertingText);\n                    // check if the line being moved before matches onEnter rules, if so let's adjust the indentation by onEnter rules.\n                    if (ret !== null) {\n                        if (ret !== 0) {\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\n                        }\n                    }\n                    else {\n                        // it doesn't match onEnter rules, let's check indentation rules then.\n                        virtualModel.getLineContent = (lineNumber) => {\n                            if (lineNumber === s.startLineNumber) {\n                                return insertingText;\n                            }\n                            else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\n                                return model.getLineContent(lineNumber - 1);\n                            }\n                            else {\n                                return model.getLineContent(lineNumber);\n                            }\n                        };\n                        const newIndentatOfMovingBlock = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber + 1, indentConverter, this._languageConfigurationService);\n                        if (newIndentatOfMovingBlock !== null) {\n                            const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(newIndentatOfMovingBlock, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const spaceCntOffset = newSpaceCnt - oldSpaceCnt;\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\n                            }\n                        }\n                    }\n                }\n                else {\n                    // Insert line that needs to be moved before\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\n                }\n            }\n            else {\n                movingLineNumber = s.startLineNumber - 1;\n                movingLineText = model.getLineContent(movingLineNumber);\n                // Delete line that needs to be moved\n                builder.addEditOperation(new Range(movingLineNumber, 1, movingLineNumber + 1, 1), null);\n                // Insert line that needs to be moved after\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + movingLineText);\n                if (this.shouldAutoIndent(model, s)) {\n                    virtualModel.getLineContent = (lineNumber) => {\n                        if (lineNumber === movingLineNumber) {\n                            return model.getLineContent(s.startLineNumber);\n                        }\n                        else {\n                            return model.getLineContent(lineNumber);\n                        }\n                    };\n                    const ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber - 2);\n                    // check if s.startLineNumber - 2 matches onEnter rules, if so adjust the moving block by onEnter rules.\n                    if (ret !== null) {\n                        if (ret !== 0) {\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\n                        }\n                    }\n                    else {\n                        // it doesn't match any onEnter rule, let's check indentation rules then.\n                        const indentOfFirstLine = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(s.startLineNumber, 1), movingLineNumber, indentConverter, this._languageConfigurationService);\n                        if (indentOfFirstLine !== null) {\n                            // adjust the indentation of the moving block\n                            const oldIndent = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndent, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const spaceCntOffset = newSpaceCnt - oldSpaceCnt;\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n    }\n    buildIndentConverter(tabSize, indentSize, insertSpaces) {\n        return {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n    }\n    parseEnterResult(model, indentConverter, tabSize, line, enter) {\n        if (enter) {\n            let enterPrefix = enter.indentation;\n            if (enter.indentAction === IndentAction.None) {\n                enterPrefix = enter.indentation + enter.appendText;\n            }\n            else if (enter.indentAction === IndentAction.Indent) {\n                enterPrefix = enter.indentation + enter.appendText;\n            }\n            else if (enter.indentAction === IndentAction.IndentOutdent) {\n                enterPrefix = enter.indentation;\n            }\n            else if (enter.indentAction === IndentAction.Outdent) {\n                enterPrefix = indentConverter.unshiftIndent(enter.indentation) + enter.appendText;\n            }\n            const movingLineText = model.getLineContent(line);\n            if (this.trimStart(movingLineText).indexOf(this.trimStart(enterPrefix)) >= 0) {\n                const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(line));\n                let newIndentation = strings.getLeadingWhitespace(enterPrefix);\n                const indentMetadataOfMovelingLine = getIndentMetadata(model, line, this._languageConfigurationService);\n                if (indentMetadataOfMovelingLine !== null && indentMetadataOfMovelingLine & 2 /* IndentConsts.DECREASE_MASK */) {\n                    newIndentation = indentConverter.unshiftIndent(newIndentation);\n                }\n                const newSpaceCnt = indentUtils.getSpaceCnt(newIndentation, tabSize);\n                const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                return newSpaceCnt - oldSpaceCnt;\n            }\n        }\n        return null;\n    }\n    /**\n     *\n     * @param model\n     * @param indentConverter\n     * @param tabSize\n     * @param line the line moving down\n     * @param futureAboveLineNumber the line which will be at the `line` position\n     * @param futureAboveLineText\n     */\n    matchEnterRuleMovingDown(model, indentConverter, tabSize, line, futureAboveLineNumber, futureAboveLineText) {\n        if (strings.lastNonWhitespaceIndex(futureAboveLineText) >= 0) {\n            // break\n            const maxColumn = model.getLineMaxColumn(futureAboveLineNumber);\n            const enter = getEnterAction(this._autoIndent, model, new Range(futureAboveLineNumber, maxColumn, futureAboveLineNumber, maxColumn), this._languageConfigurationService);\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n        }\n        else {\n            // go upwards, starting from `line - 1`\n            let validPrecedingLine = line - 1;\n            while (validPrecedingLine >= 1) {\n                const lineContent = model.getLineContent(validPrecedingLine);\n                const nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\n                if (nonWhitespaceIdx >= 0) {\n                    break;\n                }\n                validPrecedingLine--;\n            }\n            if (validPrecedingLine < 1 || line > model.getLineCount()) {\n                return null;\n            }\n            const maxColumn = model.getLineMaxColumn(validPrecedingLine);\n            const enter = getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn), this._languageConfigurationService);\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n        }\n    }\n    matchEnterRule(model, indentConverter, tabSize, line, oneLineAbove, previousLineText) {\n        let validPrecedingLine = oneLineAbove;\n        while (validPrecedingLine >= 1) {\n            // ship empty lines as empty lines just inherit indentation\n            let lineContent;\n            if (validPrecedingLine === oneLineAbove && previousLineText !== undefined) {\n                lineContent = previousLineText;\n            }\n            else {\n                lineContent = model.getLineContent(validPrecedingLine);\n            }\n            const nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\n            if (nonWhitespaceIdx >= 0) {\n                break;\n            }\n            validPrecedingLine--;\n        }\n        if (validPrecedingLine < 1 || line > model.getLineCount()) {\n            return null;\n        }\n        const maxColumn = model.getLineMaxColumn(validPrecedingLine);\n        const enter = getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn), this._languageConfigurationService);\n        return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n    }\n    trimStart(str) {\n        return str.replace(/^\\s+/, '');\n    }\n    shouldAutoIndent(model, selection) {\n        if (this._autoIndent < 4 /* EditorAutoIndentStrategy.Full */) {\n            return false;\n        }\n        // if it's not easy to tokenize, we stop auto indent.\n        if (!model.tokenization.isCheapToTokenize(selection.startLineNumber)) {\n            return false;\n        }\n        const languageAtSelectionStart = model.getLanguageIdAtPosition(selection.startLineNumber, 1);\n        const languageAtSelectionEnd = model.getLanguageIdAtPosition(selection.endLineNumber, 1);\n        if (languageAtSelectionStart !== languageAtSelectionEnd) {\n            return false;\n        }\n        if (this._languageConfigurationService.getLanguageConfiguration(languageAtSelectionStart).indentRulesSupport === null) {\n            return false;\n        }\n        return true;\n    }\n    getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, offset) {\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\n            const lineContent = model.getLineContent(i);\n            const originalIndent = strings.getLeadingWhitespace(lineContent);\n            const originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n            const newSpacesCnt = originalSpacesCnt + offset;\n            const newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n            if (newIndent !== originalIndent) {\n                builder.addEditOperation(new Range(i, 1, i, originalIndent.length + 1), newIndent);\n                if (i === s.endLineNumber && s.endColumn <= originalIndent.length + 1 && newIndent === '') {\n                    // as users select part of the original indent white spaces\n                    // when we adjust the indentation of endLine, we should adjust the cursor position as well.\n                    this._moveEndLineSelectionShrink = true;\n                }\n            }\n        }\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._moveEndPositionDown) {\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\n        }\n        if (this._moveEndLineSelectionShrink && result.startLineNumber < result.endLineNumber) {\n            result = result.setEndPosition(result.endLineNumber, 2);\n        }\n        return result;\n    }\n};\nMoveLinesCommand = __decorate([\n    __param(3, ILanguageConfigurationService)\n], MoveLinesCommand);\nexport { MoveLinesCommand };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nexport class SortLinesCommand {\n    static getCollator() {\n        if (!SortLinesCommand._COLLATOR) {\n            SortLinesCommand._COLLATOR = new Intl.Collator();\n        }\n        return SortLinesCommand._COLLATOR;\n    }\n    constructor(selection, descending) {\n        this.selection = selection;\n        this.descending = descending;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        const op = sortLines(model, this.selection, this.descending);\n        if (op) {\n            builder.addEditOperation(op.range, op.text);\n        }\n        this.selectionId = builder.trackSelection(this.selection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n    static canRun(model, selection, descending) {\n        if (model === null) {\n            return false;\n        }\n        const data = getSortData(model, selection, descending);\n        if (!data) {\n            return false;\n        }\n        for (let i = 0, len = data.before.length; i < len; i++) {\n            if (data.before[i] !== data.after[i]) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\nSortLinesCommand._COLLATOR = null;\nfunction getSortData(model, selection, descending) {\n    const startLineNumber = selection.startLineNumber;\n    let endLineNumber = selection.endLineNumber;\n    if (selection.endColumn === 1) {\n        endLineNumber--;\n    }\n    // Nothing to sort if user didn't select anything.\n    if (startLineNumber >= endLineNumber) {\n        return null;\n    }\n    const linesToSort = [];\n    // Get the contents of the selection to be sorted.\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        linesToSort.push(model.getLineContent(lineNumber));\n    }\n    let sorted = linesToSort.slice(0);\n    sorted.sort(SortLinesCommand.getCollator().compare);\n    // If descending, reverse the order.\n    if (descending === true) {\n        sorted = sorted.reverse();\n    }\n    return {\n        startLineNumber: startLineNumber,\n        endLineNumber: endLineNumber,\n        before: linesToSort,\n        after: sorted\n    };\n}\n/**\n * Generate commands for sorting lines on a model.\n */\nfunction sortLines(model, selection, descending) {\n    const data = getSortData(model, selection, descending);\n    if (!data) {\n        return null;\n    }\n    return EditOperation.replace(new Range(data.startLineNumber, 1, data.endLineNumber, model.getLineMaxColumn(data.endLineNumber)), data.after.join('\\n'));\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar LinkedEditingContribution_1;\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { Delayer, first } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { isCancellationError, onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport './linkedEditing.css';\nexport const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE = new RawContextKey('LinkedEditingInputVisible', false);\nconst DECORATION_CLASS_NAME = 'linked-editing-decoration';\nlet LinkedEditingContribution = LinkedEditingContribution_1 = class LinkedEditingContribution extends Disposable {\n    static get(editor) {\n        return editor.getContribution(LinkedEditingContribution_1.ID);\n    }\n    constructor(editor, contextKeyService, languageFeaturesService, languageConfigurationService, languageFeatureDebounceService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._syncRangesToken = 0;\n        this._localToDispose = this._register(new DisposableStore());\n        this._editor = editor;\n        this._providers = languageFeaturesService.linkedEditingRangeProvider;\n        this._enabled = false;\n        this._visibleContextKey = CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._debounceInformation = languageFeatureDebounceService.for(this._providers, 'Linked Editing', { max: 200 });\n        this._currentDecorations = this._editor.createDecorationsCollection();\n        this._languageWordPattern = null;\n        this._currentWordPattern = null;\n        this._ignoreChangeEvent = false;\n        this._localToDispose = this._register(new DisposableStore());\n        this._rangeUpdateTriggerPromise = null;\n        this._rangeSyncTriggerPromise = null;\n        this._currentRequestCts = null;\n        this._currentRequestPosition = null;\n        this._currentRequestModelVersion = null;\n        this._register(this._editor.onDidChangeModel(() => this.reinitialize(true)));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(70 /* EditorOption.linkedEditing */) || e.hasChanged(93 /* EditorOption.renameOnType */)) {\n                this.reinitialize(false);\n            }\n        }));\n        this._register(this._providers.onDidChange(() => this.reinitialize(false)));\n        this._register(this._editor.onDidChangeModelLanguage(() => this.reinitialize(true)));\n        this.reinitialize(true);\n    }\n    reinitialize(forceRefresh) {\n        const model = this._editor.getModel();\n        const isEnabled = model !== null && (this._editor.getOption(70 /* EditorOption.linkedEditing */) || this._editor.getOption(93 /* EditorOption.renameOnType */)) && this._providers.has(model);\n        if (isEnabled === this._enabled && !forceRefresh) {\n            return;\n        }\n        this._enabled = isEnabled;\n        this.clearRanges();\n        this._localToDispose.clear();\n        if (!isEnabled || model === null) {\n            return;\n        }\n        this._localToDispose.add(Event.runAndSubscribe(model.onDidChangeLanguageConfiguration, () => {\n            this._languageWordPattern = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n        }));\n        const rangeUpdateScheduler = new Delayer(this._debounceInformation.get(model));\n        const triggerRangeUpdate = () => {\n            var _a;\n            this._rangeUpdateTriggerPromise = rangeUpdateScheduler.trigger(() => this.updateRanges(), (_a = this._debounceDuration) !== null && _a !== void 0 ? _a : this._debounceInformation.get(model));\n        };\n        const rangeSyncScheduler = new Delayer(0);\n        const triggerRangeSync = (token) => {\n            this._rangeSyncTriggerPromise = rangeSyncScheduler.trigger(() => this._syncRanges(token));\n        };\n        this._localToDispose.add(this._editor.onDidChangeCursorPosition(() => {\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add(this._editor.onDidChangeModelContent((e) => {\n            if (!this._ignoreChangeEvent) {\n                if (this._currentDecorations.length > 0) {\n                    const referenceRange = this._currentDecorations.getRange(0);\n                    if (referenceRange && e.changes.every(c => referenceRange.intersectRanges(c.range))) {\n                        triggerRangeSync(this._syncRangesToken);\n                        return;\n                    }\n                }\n            }\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add({\n            dispose: () => {\n                rangeUpdateScheduler.dispose();\n                rangeSyncScheduler.dispose();\n            }\n        });\n        this.updateRanges();\n    }\n    _syncRanges(token) {\n        // delayed invocation, make sure we're still on\n        if (!this._editor.hasModel() || token !== this._syncRangesToken || this._currentDecorations.length === 0) {\n            // nothing to do\n            return;\n        }\n        const model = this._editor.getModel();\n        const referenceRange = this._currentDecorations.getRange(0);\n        if (!referenceRange || referenceRange.startLineNumber !== referenceRange.endLineNumber) {\n            return this.clearRanges();\n        }\n        const referenceValue = model.getValueInRange(referenceRange);\n        if (this._currentWordPattern) {\n            const match = referenceValue.match(this._currentWordPattern);\n            const matchLength = match ? match[0].length : 0;\n            if (matchLength !== referenceValue.length) {\n                return this.clearRanges();\n            }\n        }\n        const edits = [];\n        for (let i = 1, len = this._currentDecorations.length; i < len; i++) {\n            const mirrorRange = this._currentDecorations.getRange(i);\n            if (!mirrorRange) {\n                continue;\n            }\n            if (mirrorRange.startLineNumber !== mirrorRange.endLineNumber) {\n                edits.push({\n                    range: mirrorRange,\n                    text: referenceValue\n                });\n            }\n            else {\n                let oldValue = model.getValueInRange(mirrorRange);\n                let newValue = referenceValue;\n                let rangeStartColumn = mirrorRange.startColumn;\n                let rangeEndColumn = mirrorRange.endColumn;\n                const commonPrefixLength = strings.commonPrefixLength(oldValue, newValue);\n                rangeStartColumn += commonPrefixLength;\n                oldValue = oldValue.substr(commonPrefixLength);\n                newValue = newValue.substr(commonPrefixLength);\n                const commonSuffixLength = strings.commonSuffixLength(oldValue, newValue);\n                rangeEndColumn -= commonSuffixLength;\n                oldValue = oldValue.substr(0, oldValue.length - commonSuffixLength);\n                newValue = newValue.substr(0, newValue.length - commonSuffixLength);\n                if (rangeStartColumn !== rangeEndColumn || newValue.length !== 0) {\n                    edits.push({\n                        range: new Range(mirrorRange.startLineNumber, rangeStartColumn, mirrorRange.endLineNumber, rangeEndColumn),\n                        text: newValue\n                    });\n                }\n            }\n        }\n        if (edits.length === 0) {\n            return;\n        }\n        try {\n            this._editor.popUndoStop();\n            this._ignoreChangeEvent = true;\n            const prevEditOperationType = this._editor._getViewModel().getPrevEditOperationType();\n            this._editor.executeEdits('linkedEditing', edits);\n            this._editor._getViewModel().setPrevEditOperationType(prevEditOperationType);\n        }\n        finally {\n            this._ignoreChangeEvent = false;\n        }\n    }\n    dispose() {\n        this.clearRanges();\n        super.dispose();\n    }\n    clearRanges() {\n        this._visibleContextKey.set(false);\n        this._currentDecorations.clear();\n        if (this._currentRequestCts) {\n            this._currentRequestCts.cancel();\n            this._currentRequestCts = null;\n            this._currentRequestPosition = null;\n        }\n    }\n    async updateRanges(force = false) {\n        if (!this._editor.hasModel()) {\n            this.clearRanges();\n            return;\n        }\n        const position = this._editor.getPosition();\n        if (!this._enabled && !force || this._editor.getSelections().length > 1) {\n            // disabled or multicursor\n            this.clearRanges();\n            return;\n        }\n        const model = this._editor.getModel();\n        const modelVersionId = model.getVersionId();\n        if (this._currentRequestPosition && this._currentRequestModelVersion === modelVersionId) {\n            if (position.equals(this._currentRequestPosition)) {\n                return; // same position\n            }\n            if (this._currentDecorations.length > 0) {\n                const range = this._currentDecorations.getRange(0);\n                if (range && range.containsPosition(position)) {\n                    return; // just moving inside the existing primary range\n                }\n            }\n        }\n        // Clear existing decorations while we compute new ones\n        this.clearRanges();\n        this._currentRequestPosition = position;\n        this._currentRequestModelVersion = modelVersionId;\n        const currentRequestCts = this._currentRequestCts = new CancellationTokenSource();\n        try {\n            const sw = new StopWatch(false);\n            const response = await getLinkedEditingRanges(this._providers, model, position, currentRequestCts.token);\n            this._debounceInformation.update(model, sw.elapsed());\n            if (currentRequestCts !== this._currentRequestCts) {\n                return;\n            }\n            this._currentRequestCts = null;\n            if (modelVersionId !== model.getVersionId()) {\n                return;\n            }\n            let ranges = [];\n            if (response === null || response === void 0 ? void 0 : response.ranges) {\n                ranges = response.ranges;\n            }\n            this._currentWordPattern = (response === null || response === void 0 ? void 0 : response.wordPattern) || this._languageWordPattern;\n            let foundReferenceRange = false;\n            for (let i = 0, len = ranges.length; i < len; i++) {\n                if (Range.containsPosition(ranges[i], position)) {\n                    foundReferenceRange = true;\n                    if (i !== 0) {\n                        const referenceRange = ranges[i];\n                        ranges.splice(i, 1);\n                        ranges.unshift(referenceRange);\n                    }\n                    break;\n                }\n            }\n            if (!foundReferenceRange) {\n                // Cannot do linked editing if the ranges are not where the cursor is...\n                this.clearRanges();\n                return;\n            }\n            const decorations = ranges.map(range => ({ range: range, options: LinkedEditingContribution_1.DECORATION }));\n            this._visibleContextKey.set(true);\n            this._currentDecorations.set(decorations);\n            this._syncRangesToken++; // cancel any pending syncRanges call\n        }\n        catch (err) {\n            if (!isCancellationError(err)) {\n                onUnexpectedError(err);\n            }\n            if (this._currentRequestCts === currentRequestCts || !this._currentRequestCts) {\n                // stop if we are still the latest request\n                this.clearRanges();\n            }\n        }\n    }\n};\nLinkedEditingContribution.ID = 'editor.contrib.linkedEditing';\nLinkedEditingContribution.DECORATION = ModelDecorationOptions.register({\n    description: 'linked-editing',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    className: DECORATION_CLASS_NAME\n});\nLinkedEditingContribution = LinkedEditingContribution_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ILanguageConfigurationService),\n    __param(4, ILanguageFeatureDebounceService)\n], LinkedEditingContribution);\nexport { LinkedEditingContribution };\nexport class LinkedEditingAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.linkedEditing',\n            label: nls.localize('linkedEditing.label', \"Start Linked Editing\"),\n            alias: 'Start Linked Editing',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(_accessor, editor) {\n        const controller = LinkedEditingContribution.get(editor);\n        if (controller) {\n            return Promise.resolve(controller.updateRanges(true));\n        }\n        return Promise.resolve();\n    }\n}\nconst LinkedEditingCommand = EditorCommand.bindToContribution(LinkedEditingContribution.get);\nregisterEditorCommand(new LinkedEditingCommand({\n    id: 'cancelLinkedEditingInput',\n    precondition: CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,\n    handler: x => x.clearRanges(),\n    kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nfunction getLinkedEditingRanges(providers, model, position, token) {\n    const orderedByScore = providers.ordered(model);\n    // in order of score ask the linked editing range provider\n    // until someone response with a good result\n    // (good = not null)\n    return first(orderedByScore.map(provider => async () => {\n        try {\n            return await provider.provideLinkedEditingRanges(model, position, token);\n        }\n        catch (e) {\n            onUnexpectedExternalError(e);\n            return undefined;\n        }\n    }), result => !!result && arrays.isNonEmptyArray(result === null || result === void 0 ? void 0 : result.ranges));\n}\nexport const editorLinkedEditingBackground = registerColor('editor.linkedEditingBackground', { dark: Color.fromHex('#f00').transparent(0.3), light: Color.fromHex('#f00').transparent(0.3), hcDark: Color.fromHex('#f00').transparent(0.3), hcLight: Color.white }, nls.localize('editorLinkedEditingBackground', 'Background color when the editor auto renames on type.'));\nregisterModelAndPositionCommand('_executeLinkedEditingProvider', (_accessor, model, position) => {\n    const { linkedEditingRangeProvider } = _accessor.get(ILanguageFeaturesService);\n    return getLinkedEditingRanges(linkedEditingRangeProvider, model, position, CancellationToken.None);\n});\nregisterEditorContribution(LinkedEditingContribution.ID, LinkedEditingContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(LinkedEditingAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar LinkDetector_1;\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as resources from '../../../../base/common/resources.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport './links.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { getLinks } from './getLinks.js';\nimport * as nls from '../../../../nls.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nlet LinkDetector = LinkDetector_1 = class LinkDetector extends Disposable {\n    static get(editor) {\n        return editor.getContribution(LinkDetector_1.ID);\n    }\n    constructor(editor, openerService, notificationService, languageFeaturesService, languageFeatureDebounceService) {\n        super();\n        this.editor = editor;\n        this.openerService = openerService;\n        this.notificationService = notificationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.providers = this.languageFeaturesService.linkProvider;\n        this.debounceInformation = languageFeatureDebounceService.for(this.providers, 'Links', { min: 1000, max: 4000 });\n        this.computeLinks = this._register(new RunOnceScheduler(() => this.computeLinksNow(), 1000));\n        this.computePromise = null;\n        this.activeLinksList = null;\n        this.currentOccurrences = {};\n        this.activeLinkDecorationId = null;\n        const clickLinkGesture = this._register(new ClickLinkGesture(editor));\n        this._register(clickLinkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this._onEditorMouseMove(mouseEvent, keyboardEvent);\n        }));\n        this._register(clickLinkGesture.onExecute((e) => {\n            this.onEditorMouseUp(e);\n        }));\n        this._register(clickLinkGesture.onCancel((e) => {\n            this.cleanUpActiveLinkDecoration();\n        }));\n        this._register(editor.onDidChangeConfiguration((e) => {\n            if (!e.hasChanged(71 /* EditorOption.links */)) {\n                return;\n            }\n            // Remove any links (for the getting disabled case)\n            this.updateDecorations([]);\n            // Stop any computation (for the getting disabled case)\n            this.stop();\n            // Start computing (for the getting enabled case)\n            this.computeLinks.schedule(0);\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            if (!this.editor.hasModel()) {\n                return;\n            }\n            this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()));\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this.currentOccurrences = {};\n            this.activeLinkDecorationId = null;\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this._register(editor.onDidChangeModelLanguage((e) => {\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this._register(this.providers.onDidChange((e) => {\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this.computeLinks.schedule(0);\n    }\n    async computeLinksNow() {\n        if (!this.editor.hasModel() || !this.editor.getOption(71 /* EditorOption.links */)) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (model.isTooLargeForSyncing()) {\n            return;\n        }\n        if (!this.providers.has(model)) {\n            return;\n        }\n        if (this.activeLinksList) {\n            this.activeLinksList.dispose();\n            this.activeLinksList = null;\n        }\n        this.computePromise = createCancelablePromise(token => getLinks(this.providers, model, token));\n        try {\n            const sw = new StopWatch(false);\n            this.activeLinksList = await this.computePromise;\n            this.debounceInformation.update(model, sw.elapsed());\n            if (model.isDisposed()) {\n                return;\n            }\n            this.updateDecorations(this.activeLinksList.links);\n        }\n        catch (err) {\n            onUnexpectedError(err);\n        }\n        finally {\n            this.computePromise = null;\n        }\n    }\n    updateDecorations(links) {\n        const useMetaKey = (this.editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey');\n        const oldDecorations = [];\n        const keys = Object.keys(this.currentOccurrences);\n        for (const decorationId of keys) {\n            const occurence = this.currentOccurrences[decorationId];\n            oldDecorations.push(occurence.decorationId);\n        }\n        const newDecorations = [];\n        if (links) {\n            // Not sure why this is sometimes null\n            for (const link of links) {\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\n            }\n        }\n        this.editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations(oldDecorations, newDecorations);\n            this.currentOccurrences = {};\n            this.activeLinkDecorationId = null;\n            for (let i = 0, len = decorations.length; i < len; i++) {\n                const occurence = new LinkOccurrence(links[i], decorations[i]);\n                this.currentOccurrences[occurence.decorationId] = occurence;\n            }\n        });\n    }\n    _onEditorMouseMove(mouseEvent, withKey) {\n        const useMetaKey = (this.editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey');\n        if (this.isEnabled(mouseEvent, withKey)) {\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\n            const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n            if (occurrence) {\n                this.editor.changeDecorations((changeAccessor) => {\n                    occurrence.activate(changeAccessor, useMetaKey);\n                    this.activeLinkDecorationId = occurrence.decorationId;\n                });\n            }\n        }\n        else {\n            this.cleanUpActiveLinkDecoration();\n        }\n    }\n    cleanUpActiveLinkDecoration() {\n        const useMetaKey = (this.editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey');\n        if (this.activeLinkDecorationId) {\n            const occurrence = this.currentOccurrences[this.activeLinkDecorationId];\n            if (occurrence) {\n                this.editor.changeDecorations((changeAccessor) => {\n                    occurrence.deactivate(changeAccessor, useMetaKey);\n                });\n            }\n            this.activeLinkDecorationId = null;\n        }\n    }\n    onEditorMouseUp(mouseEvent) {\n        if (!this.isEnabled(mouseEvent)) {\n            return;\n        }\n        const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n        if (!occurrence) {\n            return;\n        }\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\n    }\n    openLinkOccurrence(occurrence, openToSide, fromUserGesture = false) {\n        if (!this.openerService) {\n            return;\n        }\n        const { link } = occurrence;\n        link.resolve(CancellationToken.None).then(uri => {\n            // Support for relative file URIs of the shape file://./relativeFile.txt or file:///./relativeFile.txt\n            if (typeof uri === 'string' && this.editor.hasModel()) {\n                const modelUri = this.editor.getModel().uri;\n                if (modelUri.scheme === Schemas.file && uri.startsWith(`${Schemas.file}:`)) {\n                    const parsedUri = URI.parse(uri);\n                    if (parsedUri.scheme === Schemas.file) {\n                        const fsPath = resources.originalFSPath(parsedUri);\n                        let relativePath = null;\n                        if (fsPath.startsWith('/./')) {\n                            relativePath = `.${fsPath.substr(1)}`;\n                        }\n                        else if (fsPath.startsWith('//./')) {\n                            relativePath = `.${fsPath.substr(2)}`;\n                        }\n                        if (relativePath) {\n                            uri = resources.joinPath(modelUri, relativePath);\n                        }\n                    }\n                }\n            }\n            return this.openerService.open(uri, { openToSide, fromUserGesture, allowContributedOpeners: true, allowCommands: true, fromWorkspace: true });\n        }, err => {\n            const messageOrError = err instanceof Error ? err.message : err;\n            // different error cases\n            if (messageOrError === 'invalid') {\n                this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\n            }\n            else if (messageOrError === 'missing') {\n                this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\n            }\n            else {\n                onUnexpectedError(err);\n            }\n        });\n    }\n    getLinkOccurrence(position) {\n        if (!this.editor.hasModel() || !position) {\n            return null;\n        }\n        const decorations = this.editor.getModel().getDecorationsInRange({\n            startLineNumber: position.lineNumber,\n            startColumn: position.column,\n            endLineNumber: position.lineNumber,\n            endColumn: position.column\n        }, 0, true);\n        for (const decoration of decorations) {\n            const currentOccurrence = this.currentOccurrences[decoration.id];\n            if (currentOccurrence) {\n                return currentOccurrence;\n            }\n        }\n        return null;\n    }\n    isEnabled(mouseEvent, withKey) {\n        return Boolean((mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */)\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\n    }\n    stop() {\n        var _a;\n        this.computeLinks.cancel();\n        if (this.activeLinksList) {\n            (_a = this.activeLinksList) === null || _a === void 0 ? void 0 : _a.dispose();\n            this.activeLinksList = null;\n        }\n        if (this.computePromise) {\n            this.computePromise.cancel();\n            this.computePromise = null;\n        }\n    }\n    dispose() {\n        super.dispose();\n        this.stop();\n    }\n};\nLinkDetector.ID = 'editor.linkDetector';\nLinkDetector = LinkDetector_1 = __decorate([\n    __param(1, IOpenerService),\n    __param(2, INotificationService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ILanguageFeatureDebounceService)\n], LinkDetector);\nexport { LinkDetector };\nconst decoration = {\n    general: ModelDecorationOptions.register({\n        description: 'detected-link',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        collapseOnReplaceEdit: true,\n        inlineClassName: 'detected-link'\n    }),\n    active: ModelDecorationOptions.register({\n        description: 'detected-link-active',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        collapseOnReplaceEdit: true,\n        inlineClassName: 'detected-link-active'\n    })\n};\nclass LinkOccurrence {\n    static decoration(link, useMetaKey) {\n        return {\n            range: link.range,\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\n        };\n    }\n    static _getOptions(link, useMetaKey, isActive) {\n        const options = { ...(isActive ? decoration.active : decoration.general) };\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\n        return options;\n    }\n    constructor(link, decorationId) {\n        this.link = link;\n        this.decorationId = decorationId;\n    }\n    activate(changeAccessor, useMetaKey) {\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\n    }\n    deactivate(changeAccessor, useMetaKey) {\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\n    }\n}\nfunction getHoverMessage(link, useMetaKey) {\n    const executeCmd = link.url && /^command:/i.test(link.url.toString());\n    const label = link.tooltip\n        ? link.tooltip\n        : executeCmd\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\n            : nls.localize('links.navigate.follow', 'Follow link');\n    const kb = useMetaKey\n        ? platform.isMacintosh\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\n        : platform.isMacintosh\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\n    if (link.url) {\n        let nativeLabel = '';\n        if (/^command:/i.test(link.url.toString())) {\n            // Don't show complete command arguments in the native tooltip\n            const match = link.url.toString().match(/^command:([^?#]+)/);\n            if (match) {\n                const commandId = match[1];\n                nativeLabel = nls.localize('tooltip.explanation', \"Execute command {0}\", commandId);\n            }\n        }\n        const hoverMessage = new MarkdownString('', true)\n            .appendLink(link.url.toString(true).replace(/ /g, '%20'), label, nativeLabel)\n            .appendMarkdown(` (${kb})`);\n        return hoverMessage;\n    }\n    else {\n        return new MarkdownString().appendText(`${label} (${kb})`);\n    }\n}\nclass OpenLinkAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.openLink',\n            label: nls.localize('label', \"Open Link\"),\n            alias: 'Open Link',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const linkDetector = LinkDetector.get(editor);\n        if (!linkDetector) {\n            return;\n        }\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        for (const sel of selections) {\n            const link = linkDetector.getLinkOccurrence(sel.getEndPosition());\n            if (link) {\n                linkDetector.openLinkOccurrence(link, false);\n            }\n        }\n    }\n}\nregisterEditorContribution(LinkDetector.ID, LinkDetector, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(OpenLinkAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class Link {\n    constructor(link, provider) {\n        this._link = link;\n        this._provider = provider;\n    }\n    toJSON() {\n        return {\n            range: this.range,\n            url: this.url,\n            tooltip: this.tooltip\n        };\n    }\n    get range() {\n        return this._link.range;\n    }\n    get url() {\n        return this._link.url;\n    }\n    get tooltip() {\n        return this._link.tooltip;\n    }\n    async resolve(token) {\n        if (this._link.url) {\n            return this._link.url;\n        }\n        if (typeof this._provider.resolveLink === 'function') {\n            return Promise.resolve(this._provider.resolveLink(this._link, token)).then(value => {\n                this._link = value || this._link;\n                if (this._link.url) {\n                    // recurse\n                    return this.resolve(token);\n                }\n                return Promise.reject(new Error('missing'));\n            });\n        }\n        return Promise.reject(new Error('missing'));\n    }\n}\nexport class LinksList {\n    constructor(tuples) {\n        this._disposables = new DisposableStore();\n        let links = [];\n        for (const [list, provider] of tuples) {\n            // merge all links\n            const newLinks = list.links.map(link => new Link(link, provider));\n            links = LinksList._union(links, newLinks);\n            // register disposables\n            if (isDisposable(list)) {\n                this._disposables.add(list);\n            }\n        }\n        this.links = links;\n    }\n    dispose() {\n        this._disposables.dispose();\n        this.links.length = 0;\n    }\n    static _union(oldLinks, newLinks) {\n        // reunite oldLinks with newLinks and remove duplicates\n        const result = [];\n        let oldIndex;\n        let oldLen;\n        let newIndex;\n        let newLen;\n        for (oldIndex = 0, newIndex = 0, oldLen = oldLinks.length, newLen = newLinks.length; oldIndex < oldLen && newIndex < newLen;) {\n            const oldLink = oldLinks[oldIndex];\n            const newLink = newLinks[newIndex];\n            if (Range.areIntersectingOrTouching(oldLink.range, newLink.range)) {\n                // Remove the oldLink\n                oldIndex++;\n                continue;\n            }\n            const comparisonResult = Range.compareRangesUsingStarts(oldLink.range, newLink.range);\n            if (comparisonResult < 0) {\n                // oldLink is before\n                result.push(oldLink);\n                oldIndex++;\n            }\n            else {\n                // newLink is before\n                result.push(newLink);\n                newIndex++;\n            }\n        }\n        for (; oldIndex < oldLen; oldIndex++) {\n            result.push(oldLinks[oldIndex]);\n        }\n        for (; newIndex < newLen; newIndex++) {\n            result.push(newLinks[newIndex]);\n        }\n        return result;\n    }\n}\nexport function getLinks(providers, model, token) {\n    const lists = [];\n    // ask all providers for links in parallel\n    const promises = providers.ordered(model).reverse().map((provider, i) => {\n        return Promise.resolve(provider.provideLinks(model, token)).then(result => {\n            if (result) {\n                lists[i] = [result, provider];\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(() => {\n        const result = new LinksList(coalesce(lists));\n        if (!token.isCancellationRequested) {\n            return result;\n        }\n        result.dispose();\n        return new LinksList([]);\n    });\n}\nCommandsRegistry.registerCommand('_executeLinkProvider', async (accessor, ...args) => {\n    let [uri, resolveCount] = args;\n    assertType(uri instanceof URI);\n    if (typeof resolveCount !== 'number') {\n        resolveCount = 0;\n    }\n    const { linkProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return [];\n    }\n    const list = await getLinks(linkProvider, model, CancellationToken.None);\n    if (!list) {\n        return [];\n    }\n    // resolve links\n    for (let i = 0; i < Math.min(resolveCount, list.links.length); i++) {\n        await list.links[i].resolve(CancellationToken.None);\n    }\n    const result = list.links.slice(0);\n    list.dispose();\n    return result;\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nclass LongLinesHelper extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._register(this._editor.onMouseDown((e) => {\n            const stopRenderingLineAfter = this._editor.getOption(117 /* EditorOption.stopRenderingLineAfter */);\n            if (stopRenderingLineAfter >= 0 && e.target.type === 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.position.column >= stopRenderingLineAfter) {\n                this._editor.updateOptions({\n                    stopRenderingLineAfter: -1\n                });\n            }\n        }));\n    }\n}\nLongLinesHelper.ID = 'editor.contrib.longLinesHelper';\nregisterEditorContribution(LongLinesHelper.ID, LongLinesHelper, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SelectionHighlighter_1;\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { CursorMoveCommands } from '../../../common/cursor/cursorMoveCommands.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CommonFindController } from '../../find/browser/findController.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getSelectionHighlightDecorationOptions } from '../../wordHighlighter/browser/highlightDecorations.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nfunction announceCursorChange(previousCursorState, cursorState) {\n    const cursorDiff = cursorState.filter(cs => !previousCursorState.find(pcs => pcs.equals(cs)));\n    if (cursorDiff.length >= 1) {\n        const cursorPositions = cursorDiff.map(cs => `line ${cs.viewState.position.lineNumber} column ${cs.viewState.position.column}`).join(', ');\n        const msg = cursorDiff.length === 1 ? nls.localize('cursorAdded', \"Cursor added: {0}\", cursorPositions) : nls.localize('cursorsAdded', \"Cursors added: {0}\", cursorPositions);\n        status(msg);\n    }\n}\nexport class InsertCursorAbove extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorAbove',\n            label: nls.localize('mutlicursor.insertAbove', \"Add Cursor Above\"),\n            alias: 'Add Cursor Above',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                linux: {\n                    primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                    secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */]\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorAbove', comment: ['&& denotes a mnemonic'] }, \"&&Add Cursor Above\"),\n                order: 2\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        let useLogicalLine = true;\n        if (args && args.logicalLine === false) {\n            useLogicalLine = false;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = viewModel.getCursorStates();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.addCursorUp(viewModel, previousCursorState, useLogicalLine));\n        viewModel.revealTopMostCursor(args.source);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class InsertCursorBelow extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorBelow',\n            label: nls.localize('mutlicursor.insertBelow', \"Add Cursor Below\"),\n            alias: 'Add Cursor Below',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                linux: {\n                    primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                    secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */]\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorBelow', comment: ['&& denotes a mnemonic'] }, \"A&&dd Cursor Below\"),\n                order: 3\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        let useLogicalLine = true;\n        if (args && args.logicalLine === false) {\n            useLogicalLine = false;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = viewModel.getCursorStates();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.addCursorDown(viewModel, previousCursorState, useLogicalLine));\n        viewModel.revealBottomMostCursor(args.source);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtEndOfEachLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorAtEndOfEachLineSelected',\n            label: nls.localize('mutlicursor.insertAtEndOfEachLineSelected', \"Add Cursors to Line Ends\"),\n            alias: 'Add Cursors to Line Ends',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 39 /* KeyCode.KeyI */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorAtEndOfEachLineSelected', comment: ['&& denotes a mnemonic'] }, \"Add C&&ursors to Line Ends\"),\n                order: 4\n            }\n        });\n    }\n    getCursorsForSelection(selection, model, result) {\n        if (selection.isEmpty()) {\n            return;\n        }\n        for (let i = selection.startLineNumber; i < selection.endLineNumber; i++) {\n            const currentLineMaxColumn = model.getLineMaxColumn(i);\n            result.push(new Selection(i, currentLineMaxColumn, i, currentLineMaxColumn));\n        }\n        if (selection.endColumn > 1) {\n            result.push(new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn));\n        }\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        const newSelections = [];\n        selections.forEach((sel) => this.getCursorsForSelection(sel, model, newSelections));\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtEndOfLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.addCursorsToBottom',\n            label: nls.localize('mutlicursor.addCursorsToBottom', \"Add Cursors To Bottom\"),\n            alias: 'Add Cursors To Bottom',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        const lineCount = editor.getModel().getLineCount();\n        const newSelections = [];\n        for (let i = selections[0].startLineNumber; i <= lineCount; i++) {\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\n        }\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtTopOfLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.addCursorsToTop',\n            label: nls.localize('mutlicursor.addCursorsToTop', \"Add Cursors To Top\"),\n            alias: 'Add Cursors To Top',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        const newSelections = [];\n        for (let i = selections[0].startLineNumber; i >= 1; i--) {\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\n        }\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class MultiCursorSessionResult {\n    constructor(selections, revealRange, revealScrollType) {\n        this.selections = selections;\n        this.revealRange = revealRange;\n        this.revealScrollType = revealScrollType;\n    }\n}\nexport class MultiCursorSession {\n    static create(editor, findController) {\n        if (!editor.hasModel()) {\n            return null;\n        }\n        const findState = findController.getState();\n        // Find widget owns entirely what we search for if:\n        //  - focus is not in the editor (i.e. it is in the find widget)\n        //  - and the search widget is visible\n        //  - and the search string is non-empty\n        if (!editor.hasTextFocus() && findState.isRevealed && findState.searchString.length > 0) {\n            // Find widget owns what is searched for\n            return new MultiCursorSession(editor, findController, false, findState.searchString, findState.wholeWord, findState.matchCase, null);\n        }\n        // Otherwise, the selection gives the search text, and the find widget gives the search settings\n        // The exception is the find state disassociation case: when beginning with a single, collapsed selection\n        let isDisconnectedFromFindController = false;\n        let wholeWord;\n        let matchCase;\n        const selections = editor.getSelections();\n        if (selections.length === 1 && selections[0].isEmpty()) {\n            isDisconnectedFromFindController = true;\n            wholeWord = true;\n            matchCase = true;\n        }\n        else {\n            wholeWord = findState.wholeWord;\n            matchCase = findState.matchCase;\n        }\n        // Selection owns what is searched for\n        const s = editor.getSelection();\n        let searchText;\n        let currentMatch = null;\n        if (s.isEmpty()) {\n            // selection is empty => expand to current word\n            const word = editor.getConfiguredWordAtPosition(s.getStartPosition());\n            if (!word) {\n                return null;\n            }\n            searchText = word.word;\n            currentMatch = new Selection(s.startLineNumber, word.startColumn, s.startLineNumber, word.endColumn);\n        }\n        else {\n            searchText = editor.getModel().getValueInRange(s).replace(/\\r\\n/g, '\\n');\n        }\n        return new MultiCursorSession(editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch);\n    }\n    constructor(_editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch) {\n        this._editor = _editor;\n        this.findController = findController;\n        this.isDisconnectedFromFindController = isDisconnectedFromFindController;\n        this.searchText = searchText;\n        this.wholeWord = wholeWord;\n        this.matchCase = matchCase;\n        this.currentMatch = currentMatch;\n    }\n    addSelectionToNextFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const nextMatch = this._getNextMatch();\n        if (!nextMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.concat(nextMatch), nextMatch, 0 /* ScrollType.Smooth */);\n    }\n    moveSelectionToNextFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const nextMatch = this._getNextMatch();\n        if (!nextMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(nextMatch), nextMatch, 0 /* ScrollType.Smooth */);\n    }\n    _getNextMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        if (this.currentMatch) {\n            const result = this.currentMatch;\n            this.currentMatch = null;\n            return result;\n        }\n        this.findController.highlightFindOptions();\n        const allSelections = this._editor.getSelections();\n        const lastAddedSelection = allSelections[allSelections.length - 1];\n        const nextMatch = this._editor.getModel().findNextMatch(this.searchText, lastAddedSelection.getEndPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false);\n        if (!nextMatch) {\n            return null;\n        }\n        return new Selection(nextMatch.range.startLineNumber, nextMatch.range.startColumn, nextMatch.range.endLineNumber, nextMatch.range.endColumn);\n    }\n    addSelectionToPreviousFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const previousMatch = this._getPreviousMatch();\n        if (!previousMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.concat(previousMatch), previousMatch, 0 /* ScrollType.Smooth */);\n    }\n    moveSelectionToPreviousFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const previousMatch = this._getPreviousMatch();\n        if (!previousMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(previousMatch), previousMatch, 0 /* ScrollType.Smooth */);\n    }\n    _getPreviousMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        if (this.currentMatch) {\n            const result = this.currentMatch;\n            this.currentMatch = null;\n            return result;\n        }\n        this.findController.highlightFindOptions();\n        const allSelections = this._editor.getSelections();\n        const lastAddedSelection = allSelections[allSelections.length - 1];\n        const previousMatch = this._editor.getModel().findPreviousMatch(this.searchText, lastAddedSelection.getStartPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false);\n        if (!previousMatch) {\n            return null;\n        }\n        return new Selection(previousMatch.range.startLineNumber, previousMatch.range.startColumn, previousMatch.range.endLineNumber, previousMatch.range.endColumn);\n    }\n    selectAll(searchScope) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this.findController.highlightFindOptions();\n        const editorModel = this._editor.getModel();\n        if (searchScope) {\n            return editorModel.findMatches(this.searchText, searchScope, false, this.matchCase, this.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        }\n        return editorModel.findMatches(this.searchText, true, false, this.matchCase, this.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n    }\n}\nexport class MultiCursorSelectionController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(MultiCursorSelectionController.ID);\n    }\n    constructor(editor) {\n        super();\n        this._sessionDispose = this._register(new DisposableStore());\n        this._editor = editor;\n        this._ignoreSelectionChange = false;\n        this._session = null;\n    }\n    dispose() {\n        this._endSession();\n        super.dispose();\n    }\n    _beginSessionIfNeeded(findController) {\n        if (!this._session) {\n            // Create a new session\n            const session = MultiCursorSession.create(this._editor, findController);\n            if (!session) {\n                return;\n            }\n            this._session = session;\n            const newState = { searchString: this._session.searchText };\n            if (this._session.isDisconnectedFromFindController) {\n                newState.wholeWordOverride = 1 /* FindOptionOverride.True */;\n                newState.matchCaseOverride = 1 /* FindOptionOverride.True */;\n                newState.isRegexOverride = 2 /* FindOptionOverride.False */;\n            }\n            findController.getState().change(newState, false);\n            this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e) => {\n                if (this._ignoreSelectionChange) {\n                    return;\n                }\n                this._endSession();\n            }));\n            this._sessionDispose.add(this._editor.onDidBlurEditorText(() => {\n                this._endSession();\n            }));\n            this._sessionDispose.add(findController.getState().onFindReplaceStateChange((e) => {\n                if (e.matchCase || e.wholeWord) {\n                    this._endSession();\n                }\n            }));\n        }\n    }\n    _endSession() {\n        this._sessionDispose.clear();\n        if (this._session && this._session.isDisconnectedFromFindController) {\n            const newState = {\n                wholeWordOverride: 0 /* FindOptionOverride.NotSet */,\n                matchCaseOverride: 0 /* FindOptionOverride.NotSet */,\n                isRegexOverride: 0 /* FindOptionOverride.NotSet */,\n            };\n            this._session.findController.getState().change(newState, false);\n        }\n        this._session = null;\n    }\n    _setSelections(selections) {\n        this._ignoreSelectionChange = true;\n        this._editor.setSelections(selections);\n        this._ignoreSelectionChange = false;\n    }\n    _expandEmptyToWord(model, selection) {\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        const word = this._editor.getConfiguredWordAtPosition(selection.getStartPosition());\n        if (!word) {\n            return selection;\n        }\n        return new Selection(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n    }\n    _applySessionResult(result) {\n        if (!result) {\n            return;\n        }\n        this._setSelections(result.selections);\n        if (result.revealRange) {\n            this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange, result.revealScrollType);\n        }\n    }\n    getSession(findController) {\n        return this._session;\n    }\n    addSelectionToNextFindMatch(findController) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._session) {\n            // If there are multiple cursors, handle the case where they do not all select the same text.\n            const allSelections = this._editor.getSelections();\n            if (allSelections.length > 1) {\n                const findState = findController.getState();\n                const matchCase = findState.matchCase;\n                const selectionsContainSameText = modelRangesContainSameText(this._editor.getModel(), allSelections, matchCase);\n                if (!selectionsContainSameText) {\n                    const model = this._editor.getModel();\n                    const resultingSelections = [];\n                    for (let i = 0, len = allSelections.length; i < len; i++) {\n                        resultingSelections[i] = this._expandEmptyToWord(model, allSelections[i]);\n                    }\n                    this._editor.setSelections(resultingSelections);\n                    return;\n                }\n            }\n        }\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.addSelectionToNextFindMatch());\n        }\n    }\n    addSelectionToPreviousFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.addSelectionToPreviousFindMatch());\n        }\n    }\n    moveSelectionToNextFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.moveSelectionToNextFindMatch());\n        }\n    }\n    moveSelectionToPreviousFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.moveSelectionToPreviousFindMatch());\n        }\n    }\n    selectAll(findController) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        let matches = null;\n        const findState = findController.getState();\n        // Special case: find widget owns entirely what we search for if:\n        // - focus is not in the editor (i.e. it is in the find widget)\n        // - and the search widget is visible\n        // - and the search string is non-empty\n        // - and we're searching for a regex\n        if (findState.isRevealed && findState.searchString.length > 0 && findState.isRegex) {\n            const editorModel = this._editor.getModel();\n            if (findState.searchScope) {\n                matches = editorModel.findMatches(findState.searchString, findState.searchScope, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n            }\n            else {\n                matches = editorModel.findMatches(findState.searchString, true, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(130 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n            }\n        }\n        else {\n            this._beginSessionIfNeeded(findController);\n            if (!this._session) {\n                return;\n            }\n            matches = this._session.selectAll(findState.searchScope);\n        }\n        if (matches.length > 0) {\n            const editorSelection = this._editor.getSelection();\n            // Have the primary cursor remain the one where the action was invoked\n            for (let i = 0, len = matches.length; i < len; i++) {\n                const match = matches[i];\n                const intersection = match.range.intersectRanges(editorSelection);\n                if (intersection) {\n                    // bingo!\n                    matches[i] = matches[0];\n                    matches[0] = match;\n                    break;\n                }\n            }\n            this._setSelections(matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn)));\n        }\n    }\n}\nMultiCursorSelectionController.ID = 'editor.contrib.multiCursorController';\nexport class MultiCursorSelectionControllerAction extends EditorAction {\n    run(accessor, editor) {\n        const multiCursorController = MultiCursorSelectionController.get(editor);\n        if (!multiCursorController) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel) {\n            const previousCursorState = viewModel.getCursorStates();\n            const findController = CommonFindController.get(editor);\n            if (findController) {\n                this._run(multiCursorController, findController);\n            }\n            else {\n                const newFindController = accessor.get(IInstantiationService).createInstance(CommonFindController, editor);\n                this._run(multiCursorController, newFindController);\n                newFindController.dispose();\n            }\n            announceCursorChange(previousCursorState, viewModel.getCursorStates());\n        }\n    }\n}\nexport class AddSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.addSelectionToNextFindMatch',\n            label: nls.localize('addSelectionToNextFindMatch', \"Add Selection To Next Find Match\"),\n            alias: 'Add Selection To Next Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 34 /* KeyCode.KeyD */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miAddSelectionToNextFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add &&Next Occurrence\"),\n                order: 5\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.addSelectionToNextFindMatch(findController);\n    }\n}\nexport class AddSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.addSelectionToPreviousFindMatch',\n            label: nls.localize('addSelectionToPreviousFindMatch', \"Add Selection To Previous Find Match\"),\n            alias: 'Add Selection To Previous Find Match',\n            precondition: undefined,\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miAddSelectionToPreviousFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add P&&revious Occurrence\"),\n                order: 6\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.addSelectionToPreviousFindMatch(findController);\n    }\n}\nexport class MoveSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.moveSelectionToNextFindMatch',\n            label: nls.localize('moveSelectionToNextFindMatch', \"Move Last Selection To Next Find Match\"),\n            alias: 'Move Last Selection To Next Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 34 /* KeyCode.KeyD */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.moveSelectionToNextFindMatch(findController);\n    }\n}\nexport class MoveSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.moveSelectionToPreviousFindMatch',\n            label: nls.localize('moveSelectionToPreviousFindMatch', \"Move Last Selection To Previous Find Match\"),\n            alias: 'Move Last Selection To Previous Find Match',\n            precondition: undefined\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.moveSelectionToPreviousFindMatch(findController);\n    }\n}\nexport class SelectHighlightsAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectHighlights',\n            label: nls.localize('selectAllOccurrencesOfFindMatch', \"Select All Occurrences of Find Match\"),\n            alias: 'Select All Occurrences of Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 42 /* KeyCode.KeyL */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miSelectHighlights', comment: ['&& denotes a mnemonic'] }, \"Select All &&Occurrences\"),\n                order: 7\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.selectAll(findController);\n    }\n}\nexport class CompatChangeAll extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.changeAll',\n            label: nls.localize('changeAll.label', \"Change All Occurrences\"),\n            alias: 'Change All Occurrences',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.editorTextFocus),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.2\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.selectAll(findController);\n    }\n}\nclass SelectionHighlighterState {\n    constructor(_model, _searchText, _matchCase, _wordSeparators, prevState) {\n        this._model = _model;\n        this._searchText = _searchText;\n        this._matchCase = _matchCase;\n        this._wordSeparators = _wordSeparators;\n        this._modelVersionId = this._model.getVersionId();\n        this._cachedFindMatches = null;\n        if (prevState\n            && this._model === prevState._model\n            && this._searchText === prevState._searchText\n            && this._matchCase === prevState._matchCase\n            && this._wordSeparators === prevState._wordSeparators\n            && this._modelVersionId === prevState._modelVersionId) {\n            this._cachedFindMatches = prevState._cachedFindMatches;\n        }\n    }\n    findMatches() {\n        if (this._cachedFindMatches === null) {\n            this._cachedFindMatches = this._model.findMatches(this._searchText, true, false, this._matchCase, this._wordSeparators, false).map(m => m.range);\n            this._cachedFindMatches.sort(Range.compareRangesUsingStarts);\n        }\n        return this._cachedFindMatches;\n    }\n}\nlet SelectionHighlighter = SelectionHighlighter_1 = class SelectionHighlighter extends Disposable {\n    constructor(editor, _languageFeaturesService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n        this.editor = editor;\n        this._isEnabled = editor.getOption(108 /* EditorOption.selectionHighlight */);\n        this._decorations = editor.createDecorationsCollection();\n        this.updateSoon = this._register(new RunOnceScheduler(() => this._update(), 300));\n        this.state = null;\n        this._register(editor.onDidChangeConfiguration((e) => {\n            this._isEnabled = editor.getOption(108 /* EditorOption.selectionHighlight */);\n        }));\n        this._register(editor.onDidChangeCursorSelection((e) => {\n            if (!this._isEnabled) {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            if (e.selection.isEmpty()) {\n                if (e.reason === 3 /* CursorChangeReason.Explicit */) {\n                    if (this.state) {\n                        // no longer valid\n                        this._setState(null);\n                    }\n                    this.updateSoon.schedule();\n                }\n                else {\n                    this._setState(null);\n                }\n            }\n            else {\n                this._update();\n            }\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this._setState(null);\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            if (this._isEnabled) {\n                this.updateSoon.schedule();\n            }\n        }));\n        const findController = CommonFindController.get(editor);\n        if (findController) {\n            this._register(findController.getState().onFindReplaceStateChange((e) => {\n                this._update();\n            }));\n        }\n        this.updateSoon.schedule();\n    }\n    _update() {\n        this._setState(SelectionHighlighter_1._createState(this.state, this._isEnabled, this.editor));\n    }\n    static _createState(oldState, isEnabled, editor) {\n        if (!isEnabled) {\n            return null;\n        }\n        if (!editor.hasModel()) {\n            return null;\n        }\n        const s = editor.getSelection();\n        if (s.startLineNumber !== s.endLineNumber) {\n            // multiline forbidden for perf reasons\n            return null;\n        }\n        const multiCursorController = MultiCursorSelectionController.get(editor);\n        if (!multiCursorController) {\n            return null;\n        }\n        const findController = CommonFindController.get(editor);\n        if (!findController) {\n            return null;\n        }\n        let r = multiCursorController.getSession(findController);\n        if (!r) {\n            const allSelections = editor.getSelections();\n            if (allSelections.length > 1) {\n                const findState = findController.getState();\n                const matchCase = findState.matchCase;\n                const selectionsContainSameText = modelRangesContainSameText(editor.getModel(), allSelections, matchCase);\n                if (!selectionsContainSameText) {\n                    return null;\n                }\n            }\n            r = MultiCursorSession.create(editor, findController);\n        }\n        if (!r) {\n            return null;\n        }\n        if (r.currentMatch) {\n            // This is an empty selection\n            // Do not interfere with semantic word highlighting in the no selection case\n            return null;\n        }\n        if (/^[ \\t]+$/.test(r.searchText)) {\n            // whitespace only selection\n            return null;\n        }\n        if (r.searchText.length > 200) {\n            // very long selection\n            return null;\n        }\n        // TODO: better handling of this case\n        const findState = findController.getState();\n        const caseSensitive = findState.matchCase;\n        // Return early if the find widget shows the exact same matches\n        if (findState.isRevealed) {\n            let findStateSearchString = findState.searchString;\n            if (!caseSensitive) {\n                findStateSearchString = findStateSearchString.toLowerCase();\n            }\n            let mySearchString = r.searchText;\n            if (!caseSensitive) {\n                mySearchString = mySearchString.toLowerCase();\n            }\n            if (findStateSearchString === mySearchString && r.matchCase === findState.matchCase && r.wholeWord === findState.wholeWord && !findState.isRegex) {\n                return null;\n            }\n        }\n        return new SelectionHighlighterState(editor.getModel(), r.searchText, r.matchCase, r.wholeWord ? editor.getOption(130 /* EditorOption.wordSeparators */) : null, oldState);\n    }\n    _setState(newState) {\n        this.state = newState;\n        if (!this.state) {\n            this._decorations.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (model.isTooLargeForTokenization()) {\n            // the file is too large, so searching word under cursor in the whole document would be blocking the UI.\n            return;\n        }\n        const allMatches = this.state.findMatches();\n        const selections = this.editor.getSelections();\n        selections.sort(Range.compareRangesUsingStarts);\n        // do not overlap with selection (issue #64 and #512)\n        const matches = [];\n        for (let i = 0, j = 0, len = allMatches.length, lenJ = selections.length; i < len;) {\n            const match = allMatches[i];\n            if (j >= lenJ) {\n                // finished all editor selections\n                matches.push(match);\n                i++;\n            }\n            else {\n                const cmp = Range.compareRangesUsingStarts(match, selections[j]);\n                if (cmp < 0) {\n                    // match is before sel\n                    if (selections[j].isEmpty() || !Range.areIntersecting(match, selections[j])) {\n                        matches.push(match);\n                    }\n                    i++;\n                }\n                else if (cmp > 0) {\n                    // sel is before match\n                    j++;\n                }\n                else {\n                    // sel is equal to match\n                    i++;\n                    j++;\n                }\n            }\n        }\n        const occurrenceHighlighting = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */) !== 'off';\n        const hasSemanticHighlights = this._languageFeaturesService.documentHighlightProvider.has(model) && occurrenceHighlighting;\n        const decorations = matches.map(r => {\n            return {\n                range: r,\n                options: getSelectionHighlightDecorationOptions(hasSemanticHighlights)\n            };\n        });\n        this._decorations.set(decorations);\n    }\n    dispose() {\n        this._setState(null);\n        super.dispose();\n    }\n};\nSelectionHighlighter.ID = 'editor.contrib.selectionHighlighter';\nSelectionHighlighter = SelectionHighlighter_1 = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SelectionHighlighter);\nexport { SelectionHighlighter };\nfunction modelRangesContainSameText(model, ranges, matchCase) {\n    const selectedText = getValueInRange(model, ranges[0], !matchCase);\n    for (let i = 1, len = ranges.length; i < len; i++) {\n        const range = ranges[i];\n        if (range.isEmpty()) {\n            return false;\n        }\n        const thisSelectedText = getValueInRange(model, range, !matchCase);\n        if (selectedText !== thisSelectedText) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction getValueInRange(model, range, toLowerCase) {\n    const text = model.getValueInRange(range);\n    return (toLowerCase ? text.toLowerCase() : text);\n}\nexport class FocusNextCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.focusNextCursor',\n            label: nls.localize('mutlicursor.focusNextCursor', \"Focus Next Cursor\"),\n            metadata: {\n                description: nls.localize('mutlicursor.focusNextCursor.description', \"Focuses the next cursor\"),\n                args: [],\n            },\n            alias: 'Focus Next Cursor',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = Array.from(viewModel.getCursorStates());\n        const firstCursor = previousCursorState.shift();\n        if (!firstCursor) {\n            return;\n        }\n        previousCursorState.push(firstCursor);\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, previousCursorState);\n        viewModel.revealPrimaryCursor(args.source, true);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class FocusPreviousCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.focusPreviousCursor',\n            label: nls.localize('mutlicursor.focusPreviousCursor', \"Focus Previous Cursor\"),\n            metadata: {\n                description: nls.localize('mutlicursor.focusPreviousCursor.description', \"Focuses the previous cursor\"),\n                args: [],\n            },\n            alias: 'Focus Previous Cursor',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = Array.from(viewModel.getCursorStates());\n        const firstCursor = previousCursorState.pop();\n        if (!firstCursor) {\n            return;\n        }\n        previousCursorState.unshift(firstCursor);\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, previousCursorState);\n        viewModel.revealPrimaryCursor(args.source, true);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nregisterEditorContribution(MultiCursorSelectionController.ID, MultiCursorSelectionController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorContribution(SelectionHighlighter.ID, SelectionHighlighter, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(InsertCursorAbove);\nregisterEditorAction(InsertCursorBelow);\nregisterEditorAction(InsertCursorAtEndOfEachLineSelected);\nregisterEditorAction(AddSelectionToNextFindMatchAction);\nregisterEditorAction(AddSelectionToPreviousFindMatchAction);\nregisterEditorAction(MoveSelectionToNextFindMatchAction);\nregisterEditorAction(MoveSelectionToPreviousFindMatchAction);\nregisterEditorAction(SelectHighlightsAction);\nregisterEditorAction(CompatChangeAll);\nregisterEditorAction(InsertCursorAtEndOfLineSelected);\nregisterEditorAction(InsertCursorAtTopOfLineSelected);\nregisterEditorAction(FocusNextCursor);\nregisterEditorAction(FocusPreviousCursor);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './highlightDecorations.css';\nimport { MinimapPosition, OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { DocumentHighlightKind } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport { activeContrastBorder, editorSelectionHighlight, minimapSelectionOccurrenceHighlight, overviewRulerSelectionHighlightForeground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst wordHighlightBackground = registerColor('editor.wordHighlightBackground', { dark: '#575757B8', light: '#57575740', hcDark: null, hcLight: null }, nls.localize('wordHighlight', 'Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\nregisterColor('editor.wordHighlightStrongBackground', { dark: '#004972B8', light: '#0e639c40', hcDark: null, hcLight: null }, nls.localize('wordHighlightStrong', 'Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\nregisterColor('editor.wordHighlightTextBackground', { light: wordHighlightBackground, dark: wordHighlightBackground, hcDark: wordHighlightBackground, hcLight: wordHighlightBackground }, nls.localize('wordHighlightText', 'Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst wordHighlightBorder = registerColor('editor.wordHighlightBorder', { light: null, dark: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('wordHighlightBorder', 'Border color of a symbol during read-access, like reading a variable.'));\nregisterColor('editor.wordHighlightStrongBorder', { light: null, dark: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('wordHighlightStrongBorder', 'Border color of a symbol during write-access, like writing to a variable.'));\nregisterColor('editor.wordHighlightTextBorder', { light: wordHighlightBorder, dark: wordHighlightBorder, hcDark: wordHighlightBorder, hcLight: wordHighlightBorder }, nls.localize('wordHighlightTextBorder', \"Border color of a textual occurrence for a symbol.\"));\nconst overviewRulerWordHighlightForeground = registerColor('editorOverviewRuler.wordHighlightForeground', { dark: '#A0A0A0CC', light: '#A0A0A0CC', hcDark: '#A0A0A0CC', hcLight: '#A0A0A0CC' }, nls.localize('overviewRulerWordHighlightForeground', 'Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst overviewRulerWordHighlightStrongForeground = registerColor('editorOverviewRuler.wordHighlightStrongForeground', { dark: '#C0A0C0CC', light: '#C0A0C0CC', hcDark: '#C0A0C0CC', hcLight: '#C0A0C0CC' }, nls.localize('overviewRulerWordHighlightStrongForeground', 'Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst overviewRulerWordHighlightTextForeground = registerColor('editorOverviewRuler.wordHighlightTextForeground', { dark: overviewRulerSelectionHighlightForeground, light: overviewRulerSelectionHighlightForeground, hcDark: overviewRulerSelectionHighlightForeground, hcLight: overviewRulerSelectionHighlightForeground }, nls.localize('overviewRulerWordHighlightTextForeground', 'Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst _WRITE_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight-strong',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlightStrong',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightStrongForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n});\nconst _TEXT_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight-text',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlightText',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightTextForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n});\nconst _SELECTION_HIGHLIGHT_OPTIONS = ModelDecorationOptions.register({\n    description: 'selection-highlight-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'selectionHighlight',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerSelectionHighlightForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n});\nconst _SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW = ModelDecorationOptions.register({\n    description: 'selection-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'selectionHighlight',\n});\nconst _REGULAR_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlight',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: MinimapPosition.Inline\n    },\n});\nexport function getHighlightDecorationOptions(kind) {\n    if (kind === DocumentHighlightKind.Write) {\n        return _WRITE_OPTIONS;\n    }\n    else if (kind === DocumentHighlightKind.Text) {\n        return _TEXT_OPTIONS;\n    }\n    else {\n        return _REGULAR_OPTIONS;\n    }\n}\nexport function getSelectionHighlightDecorationOptions(hasSemanticHighlights) {\n    // Show in overviewRuler only if model has no semantic highlighting\n    return (hasSemanticHighlights ? _SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW : _SELECTION_HIGHLIGHT_OPTIONS);\n}\nregisterThemingParticipant((theme, collector) => {\n    const selectionHighlight = theme.getColor(editorSelectionHighlight);\n    if (selectionHighlight) {\n        collector.addRule(`.monaco-editor .selectionHighlight { background-color: ${selectionHighlight.transparent(0.5)}; }`);\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { AcceptInlineEdit, JumpBackInlineEdit, JumpToInlineEdit, RejectInlineEdit, TriggerInlineEdit } from './commands.js';\nimport { InlineEditHoverParticipant } from './hoverParticipant.js';\nimport { InlineEditController } from './inlineEditController.js';\nregisterEditorAction(AcceptInlineEdit);\nregisterEditorAction(RejectInlineEdit);\nregisterEditorAction(JumpToInlineEdit);\nregisterEditorAction(JumpBackInlineEdit);\nregisterEditorAction(TriggerInlineEdit);\nregisterEditorContribution(InlineEditController.ID, InlineEditController, 3 /* EditorContributionInstantiation.Eventually */);\nHoverParticipantRegistry.register(InlineEditHoverParticipant);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { inlineEditAcceptId, inlineEditJumpBackId, inlineEditJumpToId, inlineEditRejectId } from './commandIds.js';\nimport { InlineEditController } from './inlineEditController.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nexport class AcceptInlineEdit extends EditorAction {\n    constructor() {\n        super({\n            id: inlineEditAcceptId,\n            label: 'Accept Inline Edit',\n            alias: 'Accept Inline Edit',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext),\n            kbOpts: [\n                {\n                    weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                    primary: 2 /* KeyCode.Tab */,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext, InlineEditController.cursorAtInlineEditContext)\n                }\n            ],\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Accept',\n                    group: 'primary',\n                    order: 1,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.accept();\n    }\n}\nexport class TriggerInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, ContextKeyExpr.not(InlineEditController.inlineEditVisibleKey));\n        super({\n            id: 'editor.action.inlineEdit.trigger',\n            label: 'Trigger Inline Edit',\n            alias: 'Trigger Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 86 /* KeyCode.Equal */,\n                kbExpr: activeExpr\n            },\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.trigger();\n    }\n}\nexport class JumpToInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext, ContextKeyExpr.not(InlineEditController.cursorAtInlineEditKey));\n        super({\n            id: inlineEditJumpToId,\n            label: 'Jump to Inline Edit',\n            alias: 'Jump to Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 86 /* KeyCode.Equal */,\n                kbExpr: activeExpr\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Jump To Edit',\n                    group: 'primary',\n                    order: 3,\n                    when: activeExpr\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.jumpToCurrent();\n    }\n}\nexport class JumpBackInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.cursorAtInlineEditContext);\n        super({\n            id: inlineEditJumpBackId,\n            label: 'Jump Back from Inline Edit',\n            alias: 'Jump Back from Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 10,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 86 /* KeyCode.Equal */,\n                kbExpr: activeExpr\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Jump Back',\n                    group: 'primary',\n                    order: 3,\n                    when: activeExpr\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.jumpBack();\n    }\n}\nexport class RejectInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext);\n        super({\n            id: inlineEditRejectId,\n            label: 'Reject Inline Edit',\n            alias: 'Reject Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 9 /* KeyCode.Escape */,\n                kbExpr: activeExpr\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Reject',\n                    group: 'secondary',\n                    order: 2,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.clear();\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const inlineEditAcceptId = 'editor.action.inlineEdit.accept';\nexport const inlineEditRejectId = 'editor.action.inlineEdit.reject';\nexport const inlineEditJumpToId = 'editor.action.inlineEdit.jumpTo';\nexport const inlineEditJumpBackId = 'editor.action.inlineEdit.jumpBack';\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditController_1;\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, disposableObservableValue, observableFromEvent, observableSignalFromEvent } from '../../../../base/common/observable.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { GhostTextWidget } from './ghostTextWidget.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InlineEditTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { GhostText, GhostTextPart } from '../../inlineCompletions/browser/ghostText.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { InlineEditHintsWidget } from './inlineEditHintsWidget.js';\nimport { createStyleSheet2 } from '../../../../base/browser/dom.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class InlineEditWidget {\n    constructor(widget, edit) {\n        this.widget = widget;\n        this.edit = edit;\n    }\n    dispose() {\n        this.widget.dispose();\n    }\n}\nlet InlineEditController = InlineEditController_1 = class InlineEditController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(InlineEditController_1.ID);\n    }\n    constructor(editor, instantiationService, contextKeyService, languageFeaturesService, _commandService, _configurationService) {\n        super();\n        this.editor = editor;\n        this.instantiationService = instantiationService;\n        this.contextKeyService = contextKeyService;\n        this.languageFeaturesService = languageFeaturesService;\n        this._commandService = _commandService;\n        this._configurationService = _configurationService;\n        this._isVisibleContext = InlineEditController_1.inlineEditVisibleContext.bindTo(this.contextKeyService);\n        this._isCursorAtInlineEditContext = InlineEditController_1.cursorAtInlineEditContext.bindTo(this.contextKeyService);\n        this._currentEdit = this._register(disposableObservableValue(this, undefined));\n        this._isAccepting = false;\n        this._enabled = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).enabled);\n        this._fontFamily = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).fontFamily);\n        this._backgroundColoring = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).backgroundColoring);\n        //Automatically request inline edit when the content was changed\n        //Cancel the previous request if there is one\n        //Remove the previous ghost text\n        const modelChangedSignal = observableSignalFromEvent('InlineEditController.modelContentChangedSignal', editor.onDidChangeModelContent);\n        this._register(autorun(reader => {\n            /** @description InlineEditController.modelContentChanged model */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            modelChangedSignal.read(reader);\n            this.getInlineEdit(editor, true);\n        }));\n        //Check if the cursor is at the ghost text\n        const cursorPosition = observableFromEvent(editor.onDidChangeCursorPosition, () => editor.getPosition());\n        this._register(autorun(reader => {\n            /** @description InlineEditController.cursorPositionChanged model */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            const pos = cursorPosition.read(reader);\n            if (pos) {\n                this.checkCursorPosition(pos);\n            }\n        }));\n        //Perform stuff when the current edit has changed\n        this._register(autorun((reader) => {\n            /** @description InlineEditController.update model */\n            const currentEdit = this._currentEdit.read(reader);\n            this._isCursorAtInlineEditContext.set(false);\n            if (!currentEdit) {\n                this._isVisibleContext.set(false);\n                return;\n            }\n            this._isVisibleContext.set(true);\n            const pos = editor.getPosition();\n            if (pos) {\n                this.checkCursorPosition(pos);\n            }\n        }));\n        //Clear suggestions on lost focus\n        const editorBlurSingal = observableSignalFromEvent('InlineEditController.editorBlurSignal', editor.onDidBlurEditorWidget);\n        this._register(autorun(reader => {\n            var _a;\n            /** @description InlineEditController.editorBlur */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            editorBlurSingal.read(reader);\n            // This is a hidden setting very useful for debugging\n            if (this._configurationService.getValue('editor.experimentalInlineEdit.keepOnBlur') || editor.getOption(63 /* EditorOption.inlineEdit */).keepOnBlur) {\n                return;\n            }\n            (_a = this._currentRequestCts) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._currentRequestCts = undefined;\n            this.clear(false);\n        }));\n        //Invoke provider on focus\n        const editorFocusSignal = observableSignalFromEvent('InlineEditController.editorFocusSignal', editor.onDidFocusEditorText);\n        this._register(autorun(reader => {\n            /** @description InlineEditController.editorFocus */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            editorFocusSignal.read(reader);\n            this.getInlineEdit(editor, true);\n        }));\n        //handle changes of font setting\n        const styleElement = this._register(createStyleSheet2());\n        this._register(autorun(reader => {\n            const fontFamily = this._fontFamily.read(reader);\n            styleElement.setStyle(fontFamily === '' || fontFamily === 'default' ? `` : `\n.monaco-editor .inline-edit-decoration,\n.monaco-editor .inline-edit-decoration-preview,\n.monaco-editor .inline-edit {\n\tfont-family: ${fontFamily};\n}`);\n        }));\n        this._register(new InlineEditHintsWidget(this.editor, this._currentEdit, this.instantiationService));\n    }\n    checkCursorPosition(position) {\n        var _a;\n        if (!this._currentEdit) {\n            this._isCursorAtInlineEditContext.set(false);\n            return;\n        }\n        const gt = (_a = this._currentEdit.get()) === null || _a === void 0 ? void 0 : _a.edit;\n        if (!gt) {\n            this._isCursorAtInlineEditContext.set(false);\n            return;\n        }\n        this._isCursorAtInlineEditContext.set(Range.containsPosition(gt.range, position));\n    }\n    validateInlineEdit(editor, edit) {\n        var _a, _b;\n        //Multiline inline replacing edit must replace whole lines\n        if (edit.text.includes('\\n') && edit.range.startLineNumber !== edit.range.endLineNumber && edit.range.startColumn !== edit.range.endColumn) {\n            const firstColumn = edit.range.startColumn;\n            if (firstColumn !== 1) {\n                return false;\n            }\n            const lastLine = edit.range.endLineNumber;\n            const lastColumn = edit.range.endColumn;\n            const lineLength = (_b = (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLineLength(lastLine)) !== null && _b !== void 0 ? _b : 0;\n            if (lastColumn !== lineLength + 1) {\n                return false;\n            }\n        }\n        return true;\n    }\n    async fetchInlineEdit(editor, auto) {\n        if (this._currentRequestCts) {\n            this._currentRequestCts.dispose(true);\n        }\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelVersion = model.getVersionId();\n        const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n        if (providers.length === 0) {\n            return;\n        }\n        const provider = providers[0];\n        this._currentRequestCts = new CancellationTokenSource();\n        const token = this._currentRequestCts.token;\n        const triggerKind = auto ? InlineEditTriggerKind.Automatic : InlineEditTriggerKind.Invoke;\n        const shouldDebounce = auto;\n        if (shouldDebounce) {\n            await wait(50, token);\n        }\n        if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n            return;\n        }\n        const edit = await provider.provideInlineEdit(model, { triggerKind }, token);\n        if (!edit) {\n            return;\n        }\n        if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n            return;\n        }\n        if (!this.validateInlineEdit(editor, edit)) {\n            return;\n        }\n        return edit;\n    }\n    async getInlineEdit(editor, auto) {\n        var _a;\n        this._isCursorAtInlineEditContext.set(false);\n        this.clear();\n        this._isAccepting = false;\n        const edit = await this.fetchInlineEdit(editor, auto);\n        if (!edit) {\n            return;\n        }\n        const line = edit.range.endLineNumber;\n        const column = edit.range.endColumn;\n        const ghostText = new GhostText(line, [new GhostTextPart(column, edit.text, false)]);\n        const instance = this.instantiationService.createInstance(GhostTextWidget, this.editor, {\n            ghostText: constObservable(ghostText),\n            minReservedLineCount: constObservable(0),\n            targetTextModel: constObservable((_a = this.editor.getModel()) !== null && _a !== void 0 ? _a : undefined),\n            range: constObservable(edit.range),\n            backgroundColoring: this._backgroundColoring\n        });\n        this._currentEdit.set(new InlineEditWidget(instance, edit), undefined);\n    }\n    async trigger() {\n        await this.getInlineEdit(this.editor, false);\n    }\n    async jumpBack() {\n        if (!this._jumpBackPosition) {\n            return;\n        }\n        this.editor.setPosition(this._jumpBackPosition);\n        //if position is outside viewports, scroll to it\n        this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition);\n    }\n    accept() {\n        var _a;\n        this._isAccepting = true;\n        const data = (_a = this._currentEdit.get()) === null || _a === void 0 ? void 0 : _a.edit;\n        if (!data) {\n            return;\n        }\n        //It should only happen in case of last line suggestion\n        let text = data.text;\n        if (data.text.startsWith('\\n')) {\n            text = data.text.substring(1);\n        }\n        this.editor.pushUndoStop();\n        this.editor.executeEdits('acceptCurrent', [EditOperation.replace(Range.lift(data.range), text)]);\n        if (data.accepted) {\n            this._commandService.executeCommand(data.accepted.id, ...data.accepted.arguments || []);\n        }\n        this.freeEdit(data);\n        this._currentEdit.set(undefined, undefined);\n    }\n    jumpToCurrent() {\n        var _a, _b;\n        this._jumpBackPosition = (_a = this.editor.getSelection()) === null || _a === void 0 ? void 0 : _a.getStartPosition();\n        const data = (_b = this._currentEdit.get()) === null || _b === void 0 ? void 0 : _b.edit;\n        if (!data) {\n            return;\n        }\n        const position = Position.lift({ lineNumber: data.range.startLineNumber, column: data.range.startColumn });\n        this.editor.setPosition(position);\n        //if position is outside viewports, scroll to it\n        this.editor.revealPositionInCenterIfOutsideViewport(position);\n    }\n    clear(sendRejection = true) {\n        var _a;\n        const edit = (_a = this._currentEdit.get()) === null || _a === void 0 ? void 0 : _a.edit;\n        if (edit && (edit === null || edit === void 0 ? void 0 : edit.rejected) && !this._isAccepting && sendRejection) {\n            this._commandService.executeCommand(edit.rejected.id, ...edit.rejected.arguments || []);\n        }\n        if (edit) {\n            this.freeEdit(edit);\n        }\n        this._currentEdit.set(undefined, undefined);\n    }\n    freeEdit(edit) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n        if (providers.length === 0) {\n            return;\n        }\n        providers[0].freeInlineEdit(edit);\n    }\n    shouldShowHoverAt(range) {\n        const currentEdit = this._currentEdit.get();\n        if (!currentEdit) {\n            return false;\n        }\n        const edit = currentEdit.edit;\n        const model = currentEdit.widget.model;\n        const overReplaceRange = Range.containsPosition(edit.range, range.getStartPosition()) || Range.containsPosition(edit.range, range.getEndPosition());\n        if (overReplaceRange) {\n            return true;\n        }\n        const ghostText = model.ghostText.get();\n        if (ghostText) {\n            return ghostText.parts.some(p => range.containsPosition(new Position(ghostText.lineNumber, p.column)));\n        }\n        return false;\n    }\n    shouldShowHoverAtViewZone(viewZoneId) {\n        var _a, _b;\n        return (_b = (_a = this._currentEdit.get()) === null || _a === void 0 ? void 0 : _a.widget.ownsViewZone(viewZoneId)) !== null && _b !== void 0 ? _b : false;\n    }\n};\nInlineEditController.ID = 'editor.contrib.inlineEditController';\nInlineEditController.inlineEditVisibleKey = 'inlineEditVisible';\nInlineEditController.inlineEditVisibleContext = new RawContextKey(InlineEditController_1.inlineEditVisibleKey, false);\nInlineEditController.cursorAtInlineEditKey = 'cursorAtInlineEdit';\nInlineEditController.cursorAtInlineEditContext = new RawContextKey(InlineEditController_1.cursorAtInlineEditKey, false);\nInlineEditController = InlineEditController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ICommandService),\n    __param(5, IConfigurationService)\n], InlineEditController);\nexport { InlineEditController };\nfunction wait(ms, cancellationToken) {\n    return new Promise(resolve => {\n        let d = undefined;\n        const handle = setTimeout(() => {\n            if (d) {\n                d.dispose();\n            }\n            resolve();\n        }, ms);\n        if (cancellationToken) {\n            d = cancellationToken.onCancellationRequested(() => {\n                clearTimeout(handle);\n                if (d) {\n                    d.dispose();\n                }\n                resolve();\n            });\n        }\n    });\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { derived, observableFromEvent, observableValue } from '../../../../base/common/observable.js';\nimport './inlineEdit.css';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { AdditionalLinesWidget } from '../../inlineCompletions/browser/ghostTextWidget.js';\nimport { ColumnRange, applyObservableDecorations } from '../../inlineCompletions/browser/utils.js';\nexport const INLINE_EDIT_DESCRIPTION = 'inline-edit';\nlet GhostTextWidget = class GhostTextWidget extends Disposable {\n    constructor(editor, model, languageService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.languageService = languageService;\n        this.isDisposed = observableValue(this, false);\n        this.currentTextModel = observableFromEvent(this.editor.onDidChangeModel, () => /** @description editor.model */ this.editor.getModel());\n        this.uiState = derived(this, reader => {\n            var _a;\n            if (this.isDisposed.read(reader)) {\n                return undefined;\n            }\n            const textModel = this.currentTextModel.read(reader);\n            if (textModel !== this.model.targetTextModel.read(reader)) {\n                return undefined;\n            }\n            const ghostText = this.model.ghostText.read(reader);\n            if (!ghostText) {\n                return undefined;\n            }\n            let range = (_a = this.model.range) === null || _a === void 0 ? void 0 : _a.read(reader);\n            //if range is empty, we want to remove it\n            if (range && range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn) {\n                range = undefined;\n            }\n            //check if both range and text are single line - in this case we want to do inline replacement\n            //rather than replacing whole lines\n            const isSingleLine = (range ? range.startLineNumber === range.endLineNumber : true) && ghostText.parts.length === 1 && ghostText.parts[0].lines.length === 1;\n            //check if we're just removing code\n            const isPureRemove = ghostText.parts.length === 1 && ghostText.parts[0].lines.every(l => l.length === 0);\n            const inlineTexts = [];\n            const additionalLines = [];\n            function addToAdditionalLines(lines, className) {\n                if (additionalLines.length > 0) {\n                    const lastLine = additionalLines[additionalLines.length - 1];\n                    if (className) {\n                        lastLine.decorations.push(new LineDecoration(lastLine.content.length + 1, lastLine.content.length + 1 + lines[0].length, className, 0 /* InlineDecorationType.Regular */));\n                    }\n                    lastLine.content += lines[0];\n                    lines = lines.slice(1);\n                }\n                for (const line of lines) {\n                    additionalLines.push({\n                        content: line,\n                        decorations: className ? [new LineDecoration(1, line.length + 1, className, 0 /* InlineDecorationType.Regular */)] : []\n                    });\n                }\n            }\n            const textBufferLine = textModel.getLineContent(ghostText.lineNumber);\n            let hiddenTextStartColumn = undefined;\n            let lastIdx = 0;\n            if (!isPureRemove) {\n                for (const part of ghostText.parts) {\n                    let lines = part.lines;\n                    //If remove range is set, we want to push all new liens to virtual area\n                    if (range && !isSingleLine) {\n                        addToAdditionalLines(lines, INLINE_EDIT_DESCRIPTION);\n                        lines = [];\n                    }\n                    if (hiddenTextStartColumn === undefined) {\n                        inlineTexts.push({\n                            column: part.column,\n                            text: lines[0],\n                            preview: part.preview,\n                        });\n                        lines = lines.slice(1);\n                    }\n                    else {\n                        addToAdditionalLines([textBufferLine.substring(lastIdx, part.column - 1)], undefined);\n                    }\n                    if (lines.length > 0) {\n                        addToAdditionalLines(lines, INLINE_EDIT_DESCRIPTION);\n                        if (hiddenTextStartColumn === undefined && part.column <= textBufferLine.length) {\n                            hiddenTextStartColumn = part.column;\n                        }\n                    }\n                    lastIdx = part.column - 1;\n                }\n                if (hiddenTextStartColumn !== undefined) {\n                    addToAdditionalLines([textBufferLine.substring(lastIdx)], undefined);\n                }\n            }\n            const hiddenRange = hiddenTextStartColumn !== undefined ? new ColumnRange(hiddenTextStartColumn, textBufferLine.length + 1) : undefined;\n            const lineNumber = (isSingleLine || !range) ? ghostText.lineNumber : range.endLineNumber - 1;\n            return {\n                inlineTexts,\n                additionalLines,\n                hiddenRange,\n                lineNumber,\n                additionalReservedLineCount: this.model.minReservedLineCount.read(reader),\n                targetTextModel: textModel,\n                range,\n                isSingleLine,\n                isPureRemove,\n                backgroundColoring: this.model.backgroundColoring.read(reader)\n            };\n        });\n        this.decorations = derived(this, reader => {\n            const uiState = this.uiState.read(reader);\n            if (!uiState) {\n                return [];\n            }\n            const decorations = [];\n            if (uiState.hiddenRange) {\n                decorations.push({\n                    range: uiState.hiddenRange.toRange(uiState.lineNumber),\n                    options: { inlineClassName: 'inline-edit-hidden', description: 'inline-edit-hidden', }\n                });\n            }\n            if (uiState.range) {\n                const ranges = [];\n                if (uiState.isSingleLine) {\n                    ranges.push(uiState.range);\n                }\n                else if (uiState.isPureRemove) {\n                    const lines = uiState.range.endLineNumber - uiState.range.startLineNumber;\n                    for (let i = 0; i < lines; i++) {\n                        const line = uiState.range.startLineNumber + i;\n                        const firstNonWhitespace = uiState.targetTextModel.getLineFirstNonWhitespaceColumn(line);\n                        const lastNonWhitespace = uiState.targetTextModel.getLineLastNonWhitespaceColumn(line);\n                        const range = new Range(line, firstNonWhitespace, line, lastNonWhitespace);\n                        ranges.push(range);\n                    }\n                }\n                else {\n                    const lines = uiState.range.endLineNumber - uiState.range.startLineNumber;\n                    for (let i = 0; i <= lines; i++) {\n                        const line = uiState.range.startLineNumber + i;\n                        const firstNonWhitespace = uiState.targetTextModel.getLineFirstNonWhitespaceColumn(line);\n                        const lastNonWhitespace = uiState.targetTextModel.getLineLastNonWhitespaceColumn(line);\n                        const range = new Range(line, firstNonWhitespace, line, lastNonWhitespace);\n                        ranges.push(range);\n                    }\n                }\n                const className = uiState.backgroundColoring ? 'inline-edit-remove backgroundColoring' : 'inline-edit-remove';\n                for (const range of ranges) {\n                    decorations.push({\n                        range,\n                        options: { inlineClassName: className, description: 'inline-edit-remove', }\n                    });\n                }\n            }\n            for (const p of uiState.inlineTexts) {\n                decorations.push({\n                    range: Range.fromPositions(new Position(uiState.lineNumber, p.column)),\n                    options: {\n                        description: INLINE_EDIT_DESCRIPTION,\n                        after: { content: p.text, inlineClassName: p.preview ? 'inline-edit-decoration-preview' : 'inline-edit-decoration', cursorStops: InjectedTextCursorStops.Left },\n                        showIfCollapsed: true,\n                    }\n                });\n            }\n            return decorations;\n        });\n        this.additionalLinesWidget = this._register(new AdditionalLinesWidget(this.editor, this.languageService.languageIdCodec, derived(reader => {\n            /** @description lines */\n            const uiState = this.uiState.read(reader);\n            return uiState && !uiState.isPureRemove ? {\n                lineNumber: uiState.lineNumber,\n                additionalLines: uiState.additionalLines,\n                minReservedLineCount: uiState.additionalReservedLineCount,\n                targetTextModel: uiState.targetTextModel,\n            } : undefined;\n        })));\n        this._register(toDisposable(() => { this.isDisposed.set(true, undefined); }));\n        this._register(applyObservableDecorations(this.editor, this.decorations));\n    }\n    ownsViewZone(viewZoneId) {\n        return this.additionalLinesWidget.viewZoneId === viewZoneId;\n    }\n};\nGhostTextWidget = __decorate([\n    __param(2, ILanguageService)\n], GhostTextWidget);\nexport { GhostTextWidget };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditHintsContentWidget_1;\nimport { h } from '../../../../base/browser/dom.js';\nimport { KeybindingLabel, unthemedKeybindingLabelOptions } from '../../../../base/browser/ui/keybindingLabel/keybindingLabel.js';\nimport { Separator } from '../../../../base/common/actions.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, observableFromEvent } from '../../../../base/common/observable.js';\nimport { OS } from '../../../../base/common/platform.js';\nimport './inlineEditHintsWidget.css';\nimport { Position } from '../../../common/core/position.js';\nimport { MenuEntryActionViewItem, createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { WorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nlet InlineEditHintsWidget = class InlineEditHintsWidget extends Disposable {\n    constructor(editor, model, instantiationService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.instantiationService = instantiationService;\n        this.alwaysShowToolbar = observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).showToolbar === 'always');\n        this.sessionPosition = undefined;\n        this.position = derived(this, reader => {\n            var _a, _b, _c;\n            const ghostText = (_a = this.model.read(reader)) === null || _a === void 0 ? void 0 : _a.widget.model.ghostText.read(reader);\n            if (!this.alwaysShowToolbar.read(reader) || !ghostText || ghostText.parts.length === 0) {\n                this.sessionPosition = undefined;\n                return null;\n            }\n            const firstColumn = ghostText.parts[0].column;\n            if (this.sessionPosition && this.sessionPosition.lineNumber !== ghostText.lineNumber) {\n                this.sessionPosition = undefined;\n            }\n            const position = new Position(ghostText.lineNumber, Math.min(firstColumn, (_c = (_b = this.sessionPosition) === null || _b === void 0 ? void 0 : _b.column) !== null && _c !== void 0 ? _c : Number.MAX_SAFE_INTEGER));\n            this.sessionPosition = position;\n            return position;\n        });\n        this._register(autorunWithStore((reader, store) => {\n            /** @description setup content widget */\n            const model = this.model.read(reader);\n            if (!model || !this.alwaysShowToolbar.read(reader)) {\n                return;\n            }\n            const contentWidget = store.add(this.instantiationService.createInstance(InlineEditHintsContentWidget, this.editor, true, this.position));\n            editor.addContentWidget(contentWidget);\n            store.add(toDisposable(() => editor.removeContentWidget(contentWidget)));\n        }));\n    }\n};\nInlineEditHintsWidget = __decorate([\n    __param(2, IInstantiationService)\n], InlineEditHintsWidget);\nexport { InlineEditHintsWidget };\nlet InlineEditHintsContentWidget = InlineEditHintsContentWidget_1 = class InlineEditHintsContentWidget extends Disposable {\n    constructor(editor, withBorder, _position, instantiationService, _contextKeyService, _menuService) {\n        super();\n        this.editor = editor;\n        this.withBorder = withBorder;\n        this._position = _position;\n        this._contextKeyService = _contextKeyService;\n        this._menuService = _menuService;\n        this.id = `InlineEditHintsContentWidget${InlineEditHintsContentWidget_1.id++}`;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this.nodes = h('div.inlineEditHints', { className: this.withBorder ? '.withBorder' : '' }, [\n            h('div@toolBar'),\n        ]);\n        this.inlineCompletionsActionsMenus = this._register(this._menuService.createMenu(MenuId.InlineEditActions, this._contextKeyService));\n        this.toolBar = this._register(instantiationService.createInstance(CustomizedMenuWorkbenchToolBar, this.nodes.toolBar, this.editor, MenuId.InlineEditToolbar, {\n            menuOptions: { renderShortTitle: true },\n            toolbarOptions: { primaryGroup: g => g.startsWith('primary') },\n            actionViewItemProvider: (action, options) => {\n                if (action instanceof MenuItemAction) {\n                    return instantiationService.createInstance(StatusBarViewItem, action, undefined);\n                }\n                return undefined;\n            },\n            telemetrySource: 'InlineEditToolbar',\n        }));\n        this._register(this.toolBar.onDidChangeDropdownVisibility(e => {\n            InlineEditHintsContentWidget_1._dropDownVisible = e;\n        }));\n        this._register(autorun(reader => {\n            /** @description update position */\n            this._position.read(reader);\n            this.editor.layoutContentWidget(this);\n        }));\n        this._register(autorun(reader => {\n            /** @description actions menu */\n            const extraActions = [];\n            for (const [_, group] of this.inlineCompletionsActionsMenus.getActions()) {\n                for (const action of group) {\n                    if (action instanceof MenuItemAction) {\n                        extraActions.push(action);\n                    }\n                }\n            }\n            if (extraActions.length > 0) {\n                extraActions.unshift(new Separator());\n            }\n            this.toolBar.setAdditionalSecondaryActions(extraActions);\n        }));\n    }\n    getId() { return this.id; }\n    getDomNode() {\n        return this.nodes.root;\n    }\n    getPosition() {\n        return {\n            position: this._position.get(),\n            preference: [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */],\n            positionAffinity: 3 /* PositionAffinity.LeftOfInjectedText */,\n        };\n    }\n};\nInlineEditHintsContentWidget._dropDownVisible = false;\nInlineEditHintsContentWidget.id = 0;\nInlineEditHintsContentWidget = InlineEditHintsContentWidget_1 = __decorate([\n    __param(3, IInstantiationService),\n    __param(4, IContextKeyService),\n    __param(5, IMenuService)\n], InlineEditHintsContentWidget);\nexport { InlineEditHintsContentWidget };\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            const div = h('div.keybinding').root;\n            const k = new KeybindingLabel(div, OS, { disableTitle: true, ...unthemedKeybindingLabelOptions });\n            k.set(kb);\n            this.label.textContent = this._action.label;\n            this.label.appendChild(div);\n            this.label.classList.add('inlineEditStatusBarItemLabel');\n        }\n    }\n    updateTooltip() {\n        // NOOP, disable tooltip\n    }\n}\nlet CustomizedMenuWorkbenchToolBar = class CustomizedMenuWorkbenchToolBar extends WorkbenchToolBar {\n    constructor(container, editor, menuId, options2, menuService, contextKeyService, contextMenuService, keybindingService, telemetryService) {\n        super(container, { resetMenu: menuId, ...options2 }, menuService, contextKeyService, contextMenuService, keybindingService, telemetryService);\n        this.editor = editor;\n        this.menuId = menuId;\n        this.options2 = options2;\n        this.menuService = menuService;\n        this.contextKeyService = contextKeyService;\n        this.menu = this._store.add(this.menuService.createMenu(this.menuId, this.contextKeyService, { emitEventsForSubmenuChanges: true }));\n        this.additionalActions = [];\n        this.prependedPrimaryActions = [];\n        this._store.add(this.menu.onDidChange(() => this.updateToolbar()));\n        this._store.add(this.editor.onDidChangeCursorPosition(() => this.updateToolbar()));\n        this.updateToolbar();\n    }\n    updateToolbar() {\n        var _a, _b, _c, _d, _e, _f, _g;\n        const primary = [];\n        const secondary = [];\n        createAndFillInActionBarActions(this.menu, (_a = this.options2) === null || _a === void 0 ? void 0 : _a.menuOptions, { primary, secondary }, (_c = (_b = this.options2) === null || _b === void 0 ? void 0 : _b.toolbarOptions) === null || _c === void 0 ? void 0 : _c.primaryGroup, (_e = (_d = this.options2) === null || _d === void 0 ? void 0 : _d.toolbarOptions) === null || _e === void 0 ? void 0 : _e.shouldInlineSubmenu, (_g = (_f = this.options2) === null || _f === void 0 ? void 0 : _f.toolbarOptions) === null || _g === void 0 ? void 0 : _g.useSeparatorsInPrimaryActions);\n        secondary.push(...this.additionalActions);\n        primary.unshift(...this.prependedPrimaryActions);\n        this.setActions(primary, secondary);\n    }\n    setAdditionalSecondaryActions(actions) {\n        if (equals(this.additionalActions, actions, (a, b) => a === b)) {\n            return;\n        }\n        this.additionalActions = actions;\n        this.updateToolbar();\n    }\n};\nCustomizedMenuWorkbenchToolBar = __decorate([\n    __param(4, IMenuService),\n    __param(5, IContextKeyService),\n    __param(6, IContextMenuService),\n    __param(7, IKeybindingService),\n    __param(8, ITelemetryService)\n], CustomizedMenuWorkbenchToolBar);\nexport { CustomizedMenuWorkbenchToolBar };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { constObservable } from '../../../../base/common/observable.js';\nimport { HoverForeignElementAnchor } from '../../hover/browser/hoverTypes.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { InlineEditController } from './inlineEditController.js';\nimport { InlineEditHintsContentWidget } from './inlineEditHintsWidget.js';\nexport class InlineEditHover {\n    constructor(owner, range, controller) {\n        this.owner = owner;\n        this.range = range;\n        this.controller = controller;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet InlineEditHoverParticipant = class InlineEditHoverParticipant {\n    constructor(_editor, _instantiationService, _telemetryService) {\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._telemetryService = _telemetryService;\n        this.hoverOrdinal = 5;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        const controller = InlineEditController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        const target = mouseEvent.target;\n        if (target.type === 8 /* MouseTargetType.CONTENT_VIEW_ZONE */) {\n            // handle the case where the mouse is over the view zone\n            const viewZoneData = target.detail;\n            if (controller.shouldShowHoverAtViewZone(viewZoneData.viewZoneId)) {\n                // const range = Range.fromPositions(this._editor.getModel()!.validatePosition(viewZoneData.positionBefore || viewZoneData.position));\n                const range = target.range;\n                return new HoverForeignElementAnchor(1000, this, range, mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            // handle the case where the mouse is over the empty portion of a line following ghost text\n            if (controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range, mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            // handle the case where the mouse is directly over ghost text\n            const mightBeForeignElement = target.detail.mightBeForeignElement;\n            if (mightBeForeignElement && controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range, mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        return null;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (this._editor.getOption(63 /* EditorOption.inlineEdit */).showToolbar !== 'onHover') {\n            return [];\n        }\n        const controller = InlineEditController.get(this._editor);\n        if (controller && controller.shouldShowHoverAt(anchor.range)) {\n            return [new InlineEditHover(this, anchor.range, controller)];\n        }\n        return [];\n    }\n    renderHoverParts(context, hoverParts) {\n        const disposableStore = new DisposableStore();\n        this._telemetryService.publicLog2('inlineEditHover.shown');\n        const w = this._instantiationService.createInstance(InlineEditHintsContentWidget, this._editor, false, constObservable(null));\n        context.fragment.appendChild(w.getDomNode());\n        disposableStore.add(w);\n        return disposableStore;\n    }\n};\nInlineEditHoverParticipant = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, ITelemetryService)\n], InlineEditHoverParticipant);\nexport { InlineEditHoverParticipant };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ParameterHintsController_1;\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as languages from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ParameterHintsModel } from './parameterHintsModel.js';\nimport { Context } from './provideSignatureHelp.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ParameterHintsWidget } from './parameterHintsWidget.js';\nlet ParameterHintsController = ParameterHintsController_1 = class ParameterHintsController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(ParameterHintsController_1.ID);\n    }\n    constructor(editor, instantiationService, languageFeaturesService) {\n        super();\n        this.editor = editor;\n        this.model = this._register(new ParameterHintsModel(editor, languageFeaturesService.signatureHelpProvider));\n        this._register(this.model.onChangedHints(newParameterHints => {\n            var _a;\n            if (newParameterHints) {\n                this.widget.value.show();\n                this.widget.value.render(newParameterHints);\n            }\n            else {\n                (_a = this.widget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\n            }\n        }));\n        this.widget = new Lazy(() => this._register(instantiationService.createInstance(ParameterHintsWidget, this.editor, this.model)));\n    }\n    cancel() {\n        this.model.cancel();\n    }\n    previous() {\n        var _a;\n        (_a = this.widget.rawValue) === null || _a === void 0 ? void 0 : _a.previous();\n    }\n    next() {\n        var _a;\n        (_a = this.widget.rawValue) === null || _a === void 0 ? void 0 : _a.next();\n    }\n    trigger(context) {\n        this.model.trigger(context, 0);\n    }\n};\nParameterHintsController.ID = 'editor.controller.parameterHints';\nParameterHintsController = ParameterHintsController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, ILanguageFeaturesService)\n], ParameterHintsController);\nexport { ParameterHintsController };\nexport class TriggerParameterHintsAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.triggerParameterHints',\n            label: nls.localize('parameterHints.trigger.label', \"Trigger Parameter Hints\"),\n            alias: 'Trigger Parameter Hints',\n            precondition: EditorContextKeys.hasSignatureHelpProvider,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 10 /* KeyCode.Space */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = ParameterHintsController.get(editor);\n        controller === null || controller === void 0 ? void 0 : controller.trigger({\n            triggerKind: languages.SignatureHelpTriggerKind.Invoke\n        });\n    }\n}\nregisterEditorContribution(ParameterHintsController.ID, ParameterHintsController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(TriggerParameterHintsAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 75;\nconst ParameterHintsCommand = EditorCommand.bindToContribution(ParameterHintsController.get);\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'closeParameterHints',\n    precondition: Context.Visible,\n    handler: x => x.cancel(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'showPrevParameterHint',\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\n    handler: x => x.previous(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'showNextParameterHint',\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\n    handler: x => x.next(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport * as languages from '../../../common/languages.js';\nimport { provideSignatureHelp } from './provideSignatureHelp.js';\nvar ParameterHintState;\n(function (ParameterHintState) {\n    ParameterHintState.Default = { type: 0 /* Type.Default */ };\n    class Pending {\n        constructor(request, previouslyActiveHints) {\n            this.request = request;\n            this.previouslyActiveHints = previouslyActiveHints;\n            this.type = 2 /* Type.Pending */;\n        }\n    }\n    ParameterHintState.Pending = Pending;\n    class Active {\n        constructor(hints) {\n            this.hints = hints;\n            this.type = 1 /* Type.Active */;\n        }\n    }\n    ParameterHintState.Active = Active;\n})(ParameterHintState || (ParameterHintState = {}));\nexport class ParameterHintsModel extends Disposable {\n    constructor(editor, providers, delay = ParameterHintsModel.DEFAULT_DELAY) {\n        super();\n        this._onChangedHints = this._register(new Emitter());\n        this.onChangedHints = this._onChangedHints.event;\n        this.triggerOnType = false;\n        this._state = ParameterHintState.Default;\n        this._pendingTriggers = [];\n        this._lastSignatureHelpResult = this._register(new MutableDisposable());\n        this.triggerChars = new CharacterSet();\n        this.retriggerChars = new CharacterSet();\n        this.triggerId = 0;\n        this.editor = editor;\n        this.providers = providers;\n        this.throttledDelayer = new Delayer(delay);\n        this._register(this.editor.onDidBlurEditorWidget(() => this.cancel()));\n        this._register(this.editor.onDidChangeConfiguration(() => this.onEditorConfigurationChange()));\n        this._register(this.editor.onDidChangeModel(e => this.onModelChanged()));\n        this._register(this.editor.onDidChangeModelLanguage(_ => this.onModelChanged()));\n        this._register(this.editor.onDidChangeCursorSelection(e => this.onCursorChange(e)));\n        this._register(this.editor.onDidChangeModelContent(e => this.onModelContentChange()));\n        this._register(this.providers.onDidChange(this.onModelChanged, this));\n        this._register(this.editor.onDidType(text => this.onDidType(text)));\n        this.onEditorConfigurationChange();\n        this.onModelChanged();\n    }\n    get state() { return this._state; }\n    set state(value) {\n        if (this._state.type === 2 /* ParameterHintState.Type.Pending */) {\n            this._state.request.cancel();\n        }\n        this._state = value;\n    }\n    cancel(silent = false) {\n        this.state = ParameterHintState.Default;\n        this.throttledDelayer.cancel();\n        if (!silent) {\n            this._onChangedHints.fire(undefined);\n        }\n    }\n    trigger(context, delay) {\n        const model = this.editor.getModel();\n        if (!model || !this.providers.has(model)) {\n            return;\n        }\n        const triggerId = ++this.triggerId;\n        this._pendingTriggers.push(context);\n        this.throttledDelayer.trigger(() => {\n            return this.doTrigger(triggerId);\n        }, delay)\n            .catch(onUnexpectedError);\n    }\n    next() {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        const length = this.state.hints.signatures.length;\n        const activeSignature = this.state.hints.activeSignature;\n        const last = (activeSignature % length) === (length - 1);\n        const cycle = this.editor.getOption(86 /* EditorOption.parameterHints */).cycle;\n        // If there is only one signature, or we're on last signature of list\n        if ((length < 2 || last) && !cycle) {\n            this.cancel();\n            return;\n        }\n        this.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\n    }\n    previous() {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        const length = this.state.hints.signatures.length;\n        const activeSignature = this.state.hints.activeSignature;\n        const first = activeSignature === 0;\n        const cycle = this.editor.getOption(86 /* EditorOption.parameterHints */).cycle;\n        // If there is only one signature, or we're on first signature of list\n        if ((length < 2 || first) && !cycle) {\n            this.cancel();\n            return;\n        }\n        this.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\n    }\n    updateActiveSignature(activeSignature) {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        this.state = new ParameterHintState.Active({ ...this.state.hints, activeSignature });\n        this._onChangedHints.fire(this.state.hints);\n    }\n    async doTrigger(triggerId) {\n        const isRetrigger = this.state.type === 1 /* ParameterHintState.Type.Active */ || this.state.type === 2 /* ParameterHintState.Type.Pending */;\n        const activeSignatureHelp = this.getLastActiveHints();\n        this.cancel(true);\n        if (this._pendingTriggers.length === 0) {\n            return false;\n        }\n        const context = this._pendingTriggers.reduce(mergeTriggerContexts);\n        this._pendingTriggers = [];\n        const triggerContext = {\n            triggerKind: context.triggerKind,\n            triggerCharacter: context.triggerCharacter,\n            isRetrigger: isRetrigger,\n            activeSignatureHelp: activeSignatureHelp\n        };\n        if (!this.editor.hasModel()) {\n            return false;\n        }\n        const model = this.editor.getModel();\n        const position = this.editor.getPosition();\n        this.state = new ParameterHintState.Pending(createCancelablePromise(token => provideSignatureHelp(this.providers, model, position, triggerContext, token)), activeSignatureHelp);\n        try {\n            const result = await this.state.request;\n            // Check that we are still resolving the correct signature help\n            if (triggerId !== this.triggerId) {\n                result === null || result === void 0 ? void 0 : result.dispose();\n                return false;\n            }\n            if (!result || !result.value.signatures || result.value.signatures.length === 0) {\n                result === null || result === void 0 ? void 0 : result.dispose();\n                this._lastSignatureHelpResult.clear();\n                this.cancel();\n                return false;\n            }\n            else {\n                this.state = new ParameterHintState.Active(result.value);\n                this._lastSignatureHelpResult.value = result;\n                this._onChangedHints.fire(this.state.hints);\n                return true;\n            }\n        }\n        catch (error) {\n            if (triggerId === this.triggerId) {\n                this.state = ParameterHintState.Default;\n            }\n            onUnexpectedError(error);\n            return false;\n        }\n    }\n    getLastActiveHints() {\n        switch (this.state.type) {\n            case 1 /* ParameterHintState.Type.Active */: return this.state.hints;\n            case 2 /* ParameterHintState.Type.Pending */: return this.state.previouslyActiveHints;\n            default: return undefined;\n        }\n    }\n    get isTriggered() {\n        return this.state.type === 1 /* ParameterHintState.Type.Active */\n            || this.state.type === 2 /* ParameterHintState.Type.Pending */\n            || this.throttledDelayer.isTriggered();\n    }\n    onModelChanged() {\n        this.cancel();\n        this.triggerChars.clear();\n        this.retriggerChars.clear();\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const support of this.providers.ordered(model)) {\n            for (const ch of support.signatureHelpTriggerCharacters || []) {\n                if (ch.length) {\n                    const charCode = ch.charCodeAt(0);\n                    this.triggerChars.add(charCode);\n                    // All trigger characters are also considered retrigger characters\n                    this.retriggerChars.add(charCode);\n                }\n            }\n            for (const ch of support.signatureHelpRetriggerCharacters || []) {\n                if (ch.length) {\n                    this.retriggerChars.add(ch.charCodeAt(0));\n                }\n            }\n        }\n    }\n    onDidType(text) {\n        if (!this.triggerOnType) {\n            return;\n        }\n        const lastCharIndex = text.length - 1;\n        const triggerCharCode = text.charCodeAt(lastCharIndex);\n        if (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\n            this.trigger({\n                triggerKind: languages.SignatureHelpTriggerKind.TriggerCharacter,\n                triggerCharacter: text.charAt(lastCharIndex),\n            });\n        }\n    }\n    onCursorChange(e) {\n        if (e.source === 'mouse') {\n            this.cancel();\n        }\n        else if (this.isTriggered) {\n            this.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n        }\n    }\n    onModelContentChange() {\n        if (this.isTriggered) {\n            this.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n        }\n    }\n    onEditorConfigurationChange() {\n        this.triggerOnType = this.editor.getOption(86 /* EditorOption.parameterHints */).enabled;\n        if (!this.triggerOnType) {\n            this.cancel();\n        }\n    }\n    dispose() {\n        this.cancel(true);\n        super.dispose();\n    }\n}\nParameterHintsModel.DEFAULT_DELAY = 120; // ms\nfunction mergeTriggerContexts(previous, current) {\n    switch (current.triggerKind) {\n        case languages.SignatureHelpTriggerKind.Invoke:\n            // Invoke overrides previous triggers.\n            return current;\n        case languages.SignatureHelpTriggerKind.ContentChange:\n            // Ignore content changes triggers\n            return previous;\n        case languages.SignatureHelpTriggerKind.TriggerCharacter:\n        default:\n            return current;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport * as languages from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const Context = {\n    Visible: new RawContextKey('parameterHintsVisible', false),\n    MultipleSignatures: new RawContextKey('parameterHintsMultipleSignatures', false),\n};\nexport async function provideSignatureHelp(registry, model, position, context, token) {\n    const supports = registry.ordered(model);\n    for (const support of supports) {\n        try {\n            const result = await support.provideSignatureHelp(model, position, token, context);\n            if (result) {\n                return result;\n            }\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n        }\n    }\n    return undefined;\n}\nCommandsRegistry.registerCommand('_executeSignatureHelpProvider', async (accessor, ...args) => {\n    const [uri, position, triggerCharacter] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const ref = await accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = await provideSignatureHelp(languageFeaturesService.signatureHelpProvider, ref.object.textEditorModel, Position.lift(position), {\n            triggerKind: languages.SignatureHelpTriggerKind.Invoke,\n            isRetrigger: false,\n            triggerCharacter,\n        }, CancellationToken.None);\n        if (!result) {\n            return undefined;\n        }\n        setTimeout(() => result.dispose(), 0);\n        return result.value;\n    }\n    finally {\n        ref.dispose();\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ParameterHintsWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport { assertIsDefined } from '../../../../base/common/types.js';\nimport './parameterHints.css';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { Context } from './provideSignatureHelp.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { listHighlightForeground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst $ = dom.$;\nconst parameterHintsNextIcon = registerIcon('parameter-hints-next', Codicon.chevronDown, nls.localize('parameterHintsNextIcon', 'Icon for show next parameter hint.'));\nconst parameterHintsPreviousIcon = registerIcon('parameter-hints-previous', Codicon.chevronUp, nls.localize('parameterHintsPreviousIcon', 'Icon for show previous parameter hint.'));\nlet ParameterHintsWidget = ParameterHintsWidget_1 = class ParameterHintsWidget extends Disposable {\n    constructor(editor, model, contextKeyService, openerService, languageService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.renderDisposeables = this._register(new DisposableStore());\n        this.visible = false;\n        this.announcedLabel = null;\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.markdownRenderer = this._register(new MarkdownRenderer({ editor }, languageService, openerService));\n        this.keyVisible = Context.Visible.bindTo(contextKeyService);\n        this.keyMultipleSignatures = Context.MultipleSignatures.bindTo(contextKeyService);\n    }\n    createParameterHintDOMNodes() {\n        const element = $('.editor-widget.parameter-hints-widget');\n        const wrapper = dom.append(element, $('.phwrapper'));\n        wrapper.tabIndex = -1;\n        const controls = dom.append(wrapper, $('.controls'));\n        const previous = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsPreviousIcon)));\n        const overloads = dom.append(controls, $('.overloads'));\n        const next = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsNextIcon)));\n        this._register(dom.addDisposableListener(previous, 'click', e => {\n            dom.EventHelper.stop(e);\n            this.previous();\n        }));\n        this._register(dom.addDisposableListener(next, 'click', e => {\n            dom.EventHelper.stop(e);\n            this.next();\n        }));\n        const body = $('.body');\n        const scrollbar = new DomScrollableElement(body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        this._register(scrollbar);\n        wrapper.appendChild(scrollbar.getDomNode());\n        const signature = dom.append(body, $('.signature'));\n        const docs = dom.append(body, $('.docs'));\n        element.style.userSelect = 'text';\n        this.domNodes = {\n            element,\n            signature,\n            overloads,\n            docs,\n            scrollbar,\n        };\n        this.editor.addContentWidget(this);\n        this.hide();\n        this._register(this.editor.onDidChangeCursorSelection(e => {\n            if (this.visible) {\n                this.editor.layoutContentWidget(this);\n            }\n        }));\n        const updateFont = () => {\n            if (!this.domNodes) {\n                return;\n            }\n            const fontInfo = this.editor.getOption(50 /* EditorOption.fontInfo */);\n            this.domNodes.element.style.fontSize = `${fontInfo.fontSize}px`;\n            this.domNodes.element.style.lineHeight = `${fontInfo.lineHeight / fontInfo.fontSize}`;\n        };\n        updateFont();\n        this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor), $ => $.filter(e => e.hasChanged(50 /* EditorOption.fontInfo */)))(updateFont));\n        this._register(this.editor.onDidLayoutChange(e => this.updateMaxHeight()));\n        this.updateMaxHeight();\n    }\n    show() {\n        if (this.visible) {\n            return;\n        }\n        if (!this.domNodes) {\n            this.createParameterHintDOMNodes();\n        }\n        this.keyVisible.set(true);\n        this.visible = true;\n        setTimeout(() => {\n            var _a;\n            (_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.element.classList.add('visible');\n        }, 100);\n        this.editor.layoutContentWidget(this);\n    }\n    hide() {\n        var _a;\n        this.renderDisposeables.clear();\n        if (!this.visible) {\n            return;\n        }\n        this.keyVisible.reset();\n        this.visible = false;\n        this.announcedLabel = null;\n        (_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.element.classList.remove('visible');\n        this.editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this.visible) {\n            return {\n                position: this.editor.getPosition(),\n                preference: [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */]\n            };\n        }\n        return null;\n    }\n    render(hints) {\n        var _a;\n        this.renderDisposeables.clear();\n        if (!this.domNodes) {\n            return;\n        }\n        const multiple = hints.signatures.length > 1;\n        this.domNodes.element.classList.toggle('multiple', multiple);\n        this.keyMultipleSignatures.set(multiple);\n        this.domNodes.signature.innerText = '';\n        this.domNodes.docs.innerText = '';\n        const signature = hints.signatures[hints.activeSignature];\n        if (!signature) {\n            return;\n        }\n        const code = dom.append(this.domNodes.signature, $('.code'));\n        const fontInfo = this.editor.getOption(50 /* EditorOption.fontInfo */);\n        code.style.fontSize = `${fontInfo.fontSize}px`;\n        code.style.fontFamily = fontInfo.fontFamily;\n        const hasParameters = signature.parameters.length > 0;\n        const activeParameterIndex = (_a = signature.activeParameter) !== null && _a !== void 0 ? _a : hints.activeParameter;\n        if (!hasParameters) {\n            const label = dom.append(code, $('span'));\n            label.textContent = signature.label;\n        }\n        else {\n            this.renderParameters(code, signature, activeParameterIndex);\n        }\n        const activeParameter = signature.parameters[activeParameterIndex];\n        if (activeParameter === null || activeParameter === void 0 ? void 0 : activeParameter.documentation) {\n            const documentation = $('span.documentation');\n            if (typeof activeParameter.documentation === 'string') {\n                documentation.textContent = activeParameter.documentation;\n            }\n            else {\n                const renderedContents = this.renderMarkdownDocs(activeParameter.documentation);\n                documentation.appendChild(renderedContents.element);\n            }\n            dom.append(this.domNodes.docs, $('p', {}, documentation));\n        }\n        if (signature.documentation === undefined) {\n            /** no op */\n        }\n        else if (typeof signature.documentation === 'string') {\n            dom.append(this.domNodes.docs, $('p', {}, signature.documentation));\n        }\n        else {\n            const renderedContents = this.renderMarkdownDocs(signature.documentation);\n            dom.append(this.domNodes.docs, renderedContents.element);\n        }\n        const hasDocs = this.hasDocs(signature, activeParameter);\n        this.domNodes.signature.classList.toggle('has-docs', hasDocs);\n        this.domNodes.docs.classList.toggle('empty', !hasDocs);\n        this.domNodes.overloads.textContent =\n            String(hints.activeSignature + 1).padStart(hints.signatures.length.toString().length, '0') + '/' + hints.signatures.length;\n        if (activeParameter) {\n            let labelToAnnounce = '';\n            const param = signature.parameters[activeParameterIndex];\n            if (Array.isArray(param.label)) {\n                labelToAnnounce = signature.label.substring(param.label[0], param.label[1]);\n            }\n            else {\n                labelToAnnounce = param.label;\n            }\n            if (param.documentation) {\n                labelToAnnounce += typeof param.documentation === 'string' ? `, ${param.documentation}` : `, ${param.documentation.value}`;\n            }\n            if (signature.documentation) {\n                labelToAnnounce += typeof signature.documentation === 'string' ? `, ${signature.documentation}` : `, ${signature.documentation.value}`;\n            }\n            // Select method gets called on every user type while parameter hints are visible.\n            // We do not want to spam the user with same announcements, so we only announce if the current parameter changed.\n            if (this.announcedLabel !== labelToAnnounce) {\n                aria.alert(nls.localize('hint', \"{0}, hint\", labelToAnnounce));\n                this.announcedLabel = labelToAnnounce;\n            }\n        }\n        this.editor.layoutContentWidget(this);\n        this.domNodes.scrollbar.scanDomNode();\n    }\n    renderMarkdownDocs(markdown) {\n        const renderedContents = this.renderDisposeables.add(this.markdownRenderer.render(markdown, {\n            asyncRenderCallback: () => {\n                var _a;\n                (_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.scrollbar.scanDomNode();\n            }\n        }));\n        renderedContents.element.classList.add('markdown-docs');\n        return renderedContents;\n    }\n    hasDocs(signature, activeParameter) {\n        if (activeParameter && typeof activeParameter.documentation === 'string' && assertIsDefined(activeParameter.documentation).length > 0) {\n            return true;\n        }\n        if (activeParameter && typeof activeParameter.documentation === 'object' && assertIsDefined(activeParameter.documentation).value.length > 0) {\n            return true;\n        }\n        if (signature.documentation && typeof signature.documentation === 'string' && assertIsDefined(signature.documentation).length > 0) {\n            return true;\n        }\n        if (signature.documentation && typeof signature.documentation === 'object' && assertIsDefined(signature.documentation.value).length > 0) {\n            return true;\n        }\n        return false;\n    }\n    renderParameters(parent, signature, activeParameterIndex) {\n        const [start, end] = this.getParameterLabelOffsets(signature, activeParameterIndex);\n        const beforeSpan = document.createElement('span');\n        beforeSpan.textContent = signature.label.substring(0, start);\n        const paramSpan = document.createElement('span');\n        paramSpan.textContent = signature.label.substring(start, end);\n        paramSpan.className = 'parameter active';\n        const afterSpan = document.createElement('span');\n        afterSpan.textContent = signature.label.substring(end);\n        dom.append(parent, beforeSpan, paramSpan, afterSpan);\n    }\n    getParameterLabelOffsets(signature, paramIdx) {\n        const param = signature.parameters[paramIdx];\n        if (!param) {\n            return [0, 0];\n        }\n        else if (Array.isArray(param.label)) {\n            return param.label;\n        }\n        else if (!param.label.length) {\n            return [0, 0];\n        }\n        else {\n            const regex = new RegExp(`(\\\\W|^)${escapeRegExpCharacters(param.label)}(?=\\\\W|$)`, 'g');\n            regex.test(signature.label);\n            const idx = regex.lastIndex - param.label.length;\n            return idx >= 0\n                ? [idx, regex.lastIndex]\n                : [0, 0];\n        }\n    }\n    next() {\n        this.editor.focus();\n        this.model.next();\n    }\n    previous() {\n        this.editor.focus();\n        this.model.previous();\n    }\n    getDomNode() {\n        if (!this.domNodes) {\n            this.createParameterHintDOMNodes();\n        }\n        return this.domNodes.element;\n    }\n    getId() {\n        return ParameterHintsWidget_1.ID;\n    }\n    updateMaxHeight() {\n        if (!this.domNodes) {\n            return;\n        }\n        const height = Math.max(this.editor.getLayoutInfo().height / 4, 250);\n        const maxHeight = `${height}px`;\n        this.domNodes.element.style.maxHeight = maxHeight;\n        const wrapper = this.domNodes.element.getElementsByClassName('phwrapper');\n        if (wrapper.length) {\n            wrapper[0].style.maxHeight = maxHeight;\n        }\n    }\n};\nParameterHintsWidget.ID = 'editor.widget.parameterHintsWidget';\nParameterHintsWidget = ParameterHintsWidget_1 = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, IOpenerService),\n    __param(4, ILanguageService)\n], ParameterHintsWidget);\nexport { ParameterHintsWidget };\nregisterColor('editorHoverWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hcDark: listHighlightForeground, hcLight: listHighlightForeground }, nls.localize('editorHoverWidgetHighlightForeground', 'Foreground color of the active item in the parameter hint.'));\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar RenameController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextResourceConfigurationService } from '../../../common/services/textResourceConfiguration.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nimport { Action2, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CONTEXT_RENAME_INPUT_FOCUSED, CONTEXT_RENAME_INPUT_VISIBLE, RenameInputField } from './renameInputField.js';\nclass RenameSkeleton {\n    constructor(model, position, registry) {\n        this.model = model;\n        this.position = position;\n        this._providerRenameIdx = 0;\n        this._providers = registry.ordered(model);\n    }\n    hasProvider() {\n        return this._providers.length > 0;\n    }\n    async resolveRenameLocation(token) {\n        const rejects = [];\n        for (this._providerRenameIdx = 0; this._providerRenameIdx < this._providers.length; this._providerRenameIdx++) {\n            const provider = this._providers[this._providerRenameIdx];\n            if (!provider.resolveRenameLocation) {\n                break;\n            }\n            const res = await provider.resolveRenameLocation(this.model, this.position, token);\n            if (!res) {\n                continue;\n            }\n            if (res.rejectReason) {\n                rejects.push(res.rejectReason);\n                continue;\n            }\n            return res;\n        }\n        // we are here when no provider prepared a location which means we can\n        // just rely on the word under cursor and start with the first provider\n        this._providerRenameIdx = 0;\n        const word = this.model.getWordAtPosition(this.position);\n        if (!word) {\n            return {\n                range: Range.fromPositions(this.position),\n                text: '',\n                rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n            };\n        }\n        return {\n            range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\n            text: word.word,\n            rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n        };\n    }\n    async provideRenameEdits(newName, token) {\n        return this._provideRenameEdits(newName, this._providerRenameIdx, [], token);\n    }\n    async _provideRenameEdits(newName, i, rejects, token) {\n        const provider = this._providers[i];\n        if (!provider) {\n            return {\n                edits: [],\n                rejectReason: rejects.join('\\n')\n            };\n        }\n        const result = await provider.provideRenameEdits(this.model, this.position, newName, token);\n        if (!result) {\n            return this._provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token);\n        }\n        else if (result.rejectReason) {\n            return this._provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token);\n        }\n        return result;\n    }\n}\nexport async function rename(registry, model, position, newName) {\n    const skeleton = new RenameSkeleton(model, position, registry);\n    const loc = await skeleton.resolveRenameLocation(CancellationToken.None);\n    if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n        return { edits: [], rejectReason: loc.rejectReason };\n    }\n    return skeleton.provideRenameEdits(newName, CancellationToken.None);\n}\n// ---  register actions and commands\nlet RenameController = RenameController_1 = class RenameController {\n    static get(editor) {\n        return editor.getContribution(RenameController_1.ID);\n    }\n    constructor(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService, _languageFeaturesService, _telemetryService) {\n        this.editor = editor;\n        this._instaService = _instaService;\n        this._notificationService = _notificationService;\n        this._bulkEditService = _bulkEditService;\n        this._progressService = _progressService;\n        this._logService = _logService;\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._telemetryService = _telemetryService;\n        this._disposableStore = new DisposableStore();\n        this._cts = new CancellationTokenSource();\n        this._renameInputField = this._disposableStore.add(this._instaService.createInstance(RenameInputField, this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview']));\n    }\n    dispose() {\n        this._disposableStore.dispose();\n        this._cts.dispose(true);\n    }\n    async run() {\n        var _a, _b;\n        const trace = this._logService.trace.bind(this._logService, '[rename]');\n        // set up cancellation token to prevent reentrant rename, this\n        // is the parent to the resolve- and rename-tokens\n        this._cts.dispose(true);\n        this._cts = new CancellationTokenSource();\n        if (!this.editor.hasModel()) {\n            trace('editor has no model');\n            return undefined;\n        }\n        const position = this.editor.getPosition();\n        const skeleton = new RenameSkeleton(this.editor.getModel(), position, this._languageFeaturesService.renameProvider);\n        if (!skeleton.hasProvider()) {\n            trace('skeleton has no provider');\n            return undefined;\n        }\n        // part 1 - resolve rename location\n        const cts1 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, undefined, this._cts.token);\n        let loc;\n        try {\n            trace('resolving rename location');\n            const resolveLocationOperation = skeleton.resolveRenameLocation(cts1.token);\n            this._progressService.showWhile(resolveLocationOperation, 250);\n            loc = await resolveLocationOperation;\n            trace('resolved rename location');\n        }\n        catch (e) {\n            trace('resolve rename location failed', JSON.stringify(e, null, '\\t'));\n            (_a = MessageController.get(this.editor)) === null || _a === void 0 ? void 0 : _a.showMessage(e || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\n            return undefined;\n        }\n        finally {\n            cts1.dispose();\n        }\n        if (!loc) {\n            trace('returning early - no loc');\n            return undefined;\n        }\n        if (loc.rejectReason) {\n            trace(`returning early - rejected with reason: ${loc.rejectReason}`, loc.rejectReason);\n            (_b = MessageController.get(this.editor)) === null || _b === void 0 ? void 0 : _b.showMessage(loc.rejectReason, position);\n            return undefined;\n        }\n        if (cts1.token.isCancellationRequested) {\n            trace('returning early - cts1 cancelled');\n            return undefined;\n        }\n        // part 2 - do rename at location\n        const cts2 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, loc.range, this._cts.token);\n        const model = this.editor.getModel(); // @ulugbekna: assumes editor still has a model, otherwise, cts1 should've been cancelled\n        const renameCandidatesCts = new CancellationTokenSource(cts2.token);\n        const newSymbolNamesProviders = this._languageFeaturesService.newSymbolNamesProvider.all(model);\n        // TODO@ulugbekna: providers should get timeout token (use createTimeoutCancellation(x))\n        const newSymbolNameProvidersResults = newSymbolNamesProviders.map(p => p.provideNewSymbolNames(model, loc.range, renameCandidatesCts.token));\n        trace(`requested new symbol names from ${newSymbolNamesProviders.length} providers`);\n        const selection = this.editor.getSelection();\n        let selectionStart = 0;\n        let selectionEnd = loc.text.length;\n        if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\n            selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\n            selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\n        }\n        trace('creating rename input field and awaiting its result');\n        const supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\n        const inputFieldResult = await this._renameInputField.getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview, newSymbolNameProvidersResults, renameCandidatesCts);\n        trace('received response from rename input field');\n        if (newSymbolNamesProviders.length > 0) { // @ulugbekna: we're interested only in telemetry for rename suggestions currently\n            this._reportTelemetry(newSymbolNamesProviders.length, model.getLanguageId(), inputFieldResult);\n        }\n        // no result, only hint to focus the editor or not\n        if (typeof inputFieldResult === 'boolean') {\n            trace(`returning early - rename input field response - ${inputFieldResult}`);\n            if (inputFieldResult) {\n                this.editor.focus();\n            }\n            cts2.dispose();\n            return undefined;\n        }\n        this.editor.focus();\n        trace('requesting rename edits');\n        const renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, cts2.token), cts2.token).then(async (renameResult) => {\n            if (!renameResult) {\n                trace('returning early - no rename edits result');\n                return;\n            }\n            if (!this.editor.hasModel()) {\n                trace('returning early - no model after rename edits are provided');\n                return;\n            }\n            if (renameResult.rejectReason) {\n                trace(`returning early - rejected with reason: ${renameResult.rejectReason}`);\n                this._notificationService.info(renameResult.rejectReason);\n                return;\n            }\n            // collapse selection to active end\n            this.editor.setSelection(Range.fromPositions(this.editor.getSelection().getPosition()));\n            trace('applying edits');\n            this._bulkEditService.apply(renameResult, {\n                editor: this.editor,\n                showPreview: inputFieldResult.wantsPreview,\n                label: nls.localize('label', \"Renaming '{0}' to '{1}'\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                code: 'undoredo.rename',\n                quotableLabel: nls.localize('quotableLabel', \"Renaming {0} to {1}\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                respectAutoSaveConfig: true\n            }).then(result => {\n                trace('edits applied');\n                if (result.ariaSummary) {\n                    alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\n                }\n            }).catch(err => {\n                trace(`error when applying edits ${JSON.stringify(err, null, '\\t')}`);\n                this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\n                this._logService.error(err);\n            });\n        }, err => {\n            trace('error when providing rename edits', JSON.stringify(err, null, '\\t'));\n            this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\n            this._logService.error(err);\n        }).finally(() => {\n            cts2.dispose();\n        });\n        trace('returning rename operation');\n        this._progressService.showWhile(renameOperation, 250);\n        return renameOperation;\n    }\n    acceptRenameInput(wantsPreview) {\n        this._renameInputField.acceptInput(wantsPreview);\n    }\n    cancelRenameInput() {\n        this._renameInputField.cancelInput(true, 'cancelRenameInput command');\n    }\n    focusNextRenameSuggestion() {\n        this._renameInputField.focusNextRenameSuggestion();\n    }\n    focusPreviousRenameSuggestion() {\n        this._renameInputField.focusPreviousRenameSuggestion();\n    }\n    _reportTelemetry(nRenameSuggestionProviders, languageId, inputFieldResult) {\n        const value = typeof inputFieldResult === 'boolean'\n            ? {\n                kind: 'cancelled',\n                languageId,\n                nRenameSuggestionProviders,\n            }\n            : {\n                kind: 'accepted',\n                languageId,\n                nRenameSuggestionProviders,\n                source: inputFieldResult.source,\n                nRenameSuggestions: inputFieldResult.nRenameSuggestions,\n                wantsPreview: inputFieldResult.wantsPreview,\n            };\n        this._telemetryService.publicLog2('renameInvokedEvent', value);\n    }\n};\nRenameController.ID = 'editor.contrib.renameController';\nRenameController = RenameController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, INotificationService),\n    __param(3, IBulkEditService),\n    __param(4, IEditorProgressService),\n    __param(5, ILogService),\n    __param(6, ITextResourceConfigurationService),\n    __param(7, ILanguageFeaturesService),\n    __param(8, ITelemetryService)\n], RenameController);\n// ---- action implementation\nexport class RenameAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.rename',\n            label: nls.localize('rename.label', \"Rename Symbol\"),\n            alias: 'Rename Symbol',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.1\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(accessor, editor) {\n        const logService = accessor.get(ILogService);\n        const controller = RenameController.get(editor);\n        if (controller) {\n            logService.trace('[RenameAction] got controller, running...');\n            return controller.run();\n        }\n        logService.trace('[RenameAction] returning early - controller missing');\n        return Promise.resolve();\n    }\n}\nregisterEditorContribution(RenameController.ID, RenameController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(RenameAction);\nconst RenameCommand = EditorCommand.bindToContribution(RenameController.get);\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.acceptRenameInput(false),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInputWithPreview',\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\n    handler: x => x.acceptRenameInput(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 1024 /* KeyMod.Shift */ + 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'cancelRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.cancelRenameInput(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterAction2(class FocusNextRenameSuggestion extends Action2 {\n    constructor() {\n        super({\n            id: 'focusNextRenameSuggestion',\n            title: {\n                ...nls.localize2('focusNextRenameSuggestion', \"Focus Next Rename Suggestion\"),\n            },\n            precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n            keybinding: [\n                {\n                    primary: 2 /* KeyCode.Tab */,\n                    secondary: [18 /* KeyCode.DownArrow */],\n                    weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n                }\n            ]\n        });\n    }\n    run(accessor) {\n        const currentEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (!currentEditor) {\n            return;\n        }\n        const controller = RenameController.get(currentEditor);\n        if (!controller) {\n            return;\n        }\n        controller.focusNextRenameSuggestion();\n    }\n});\nregisterAction2(class FocusPreviousRenameSuggestion extends Action2 {\n    constructor() {\n        super({\n            id: 'focusPreviousRenameSuggestion',\n            title: {\n                ...nls.localize2('focusPreviousRenameSuggestion', \"Focus Previous Rename Suggestion\"),\n            },\n            precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n            keybinding: [\n                {\n                    when: CONTEXT_RENAME_INPUT_FOCUSED,\n                    primary: 2 /* KeyCode.Tab */ | 4 /* KeyCode.Shift */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n                },\n                {\n                    when: CONTEXT_RENAME_INPUT_FOCUSED.toNegated(),\n                    primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */,\n                    secondary: [16 /* KeyCode.UpArrow */],\n                    weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n                }\n            ]\n        });\n    }\n    run(accessor) {\n        const currentEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (!currentEditor) {\n            return;\n        }\n        const controller = RenameController.get(currentEditor);\n        if (!controller) {\n            return;\n        }\n        controller.focusPreviousRenameSuggestion();\n    }\n});\n// ---- api bridge command\nregisterModelAndPositionCommand('_executeDocumentRenameProvider', function (accessor, model, position, ...args) {\n    const [newName] = args;\n    assertType(typeof newName === 'string');\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    return rename(renameProvider, model, position, newName);\n});\nregisterModelAndPositionCommand('_executePrepareRename', async function (accessor, model, position) {\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    const skeleton = new RenameSkeleton(model, position, renameProvider);\n    const loc = await skeleton.resolveRenameLocation(CancellationToken.None);\n    if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n        throw new Error(loc.rejectReason);\n    }\n    return loc;\n});\n//todo@jrieken use editor options world\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    id: 'editor',\n    properties: {\n        'editor.rename.enablePreview': {\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\n            default: true,\n            type: 'boolean'\n        }\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { addDisposableListener, getClientArea, getDomNodePagePosition, getTotalHeight, getTotalWidth } from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { renderIcon } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { raceCancellation } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { assertType, isDefined } from '../../../../base/common/types.js';\nimport './renameInputField.css';\nimport { Position } from '../../../common/core/position.js';\nimport { NewSymbolNameTag } from '../../../common/languages.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { defaultListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, widgetBorder, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\n/** for debugging */\nconst _sticky = false;\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nexport const CONTEXT_RENAME_INPUT_FOCUSED = new RawContextKey('renameInputFocused', false, localize('renameInputFocused', \"Whether the rename input widget is focused\"));\nlet RenameInputField = class RenameInputField {\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService, _logService) {\n        this._editor = _editor;\n        this._acceptKeybindings = _acceptKeybindings;\n        this._themeService = _themeService;\n        this._keybindingService = _keybindingService;\n        this._logService = _logService;\n        this._disposables = new DisposableStore();\n        this.allowEditorOverflow = true;\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._focusedContextKey = CONTEXT_RENAME_INPUT_FOCUSED.bindTo(contextKeyService);\n        this._editor.addContentWidget(this);\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return '__renameInputWidget';\n    }\n    getDomNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'monaco-editor rename-box';\n            this._input = document.createElement('input');\n            this._input.className = 'rename-input';\n            this._input.type = 'text';\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n            this._disposables.add(addDisposableListener(this._input, 'focus', () => { this._focusedContextKey.set(true); }));\n            this._disposables.add(addDisposableListener(this._input, 'blur', () => { this._focusedContextKey.reset(); }));\n            this._domNode.appendChild(this._input);\n            this._candidatesView = this._disposables.add(new CandidatesView(this._domNode, {\n                fontInfo: this._editor.getOption(50 /* EditorOption.fontInfo */),\n                onSelectionChange: () => this.acceptInput(false) // we don't allow preview with mouse click for now\n            }));\n            this._label = document.createElement('div');\n            this._label.className = 'rename-label';\n            this._domNode.appendChild(this._label);\n            this._updateFont();\n            this._updateStyles(this._themeService.getColorTheme());\n        }\n        return this._domNode;\n    }\n    _updateStyles(theme) {\n        var _a, _b, _c, _d;\n        if (!this._input || !this._domNode) {\n            return;\n        }\n        const widgetShadowColor = theme.getColor(widgetShadow);\n        const widgetBorderColor = theme.getColor(widgetBorder);\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n        this._domNode.style.border = widgetBorderColor ? `1px solid ${widgetBorderColor}` : '';\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\n        const border = theme.getColor(inputBorder);\n        this._input.style.borderWidth = border ? '1px' : '0px';\n        this._input.style.borderStyle = border ? 'solid' : 'none';\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\n    }\n    _updateFont() {\n        if (!this._input || !this._label || !this._candidatesView) {\n            return;\n        }\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._input.style.fontFamily = fontInfo.fontFamily;\n        this._input.style.fontWeight = fontInfo.fontWeight;\n        this._input.style.fontSize = `${fontInfo.fontSize}px`;\n        this._candidatesView.updateFont(fontInfo);\n        this._label.style.fontSize = `${this._computeLabelFontSize(fontInfo.fontSize)}px`;\n    }\n    _computeLabelFontSize(editorFontSize) {\n        return editorFontSize * 0.8;\n    }\n    getPosition() {\n        if (!this._visible) {\n            return null;\n        }\n        if (!this._editor.hasModel() || // @ulugbekna: shouldn't happen\n            !this._editor.getDomNode() // @ulugbekna: can happen during tests based on suggestWidget's similar predicate check\n        ) {\n            return null;\n        }\n        const bodyBox = getClientArea(this.getDomNode().ownerDocument.body);\n        const editorBox = getDomNodePagePosition(this._editor.getDomNode());\n        const cursorBoxTop = this._getTopForPosition();\n        this._nPxAvailableAbove = cursorBoxTop + editorBox.top;\n        this._nPxAvailableBelow = bodyBox.height - this._nPxAvailableAbove;\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const { totalHeight: candidateViewHeight } = CandidateView.getLayoutInfo({ lineHeight });\n        const positionPreference = this._nPxAvailableBelow > candidateViewHeight * 6 /* approximate # of candidates to fit in (inclusive of rename input box & rename label) */\n            ? [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n            : [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */];\n        return {\n            position: this._position,\n            preference: positionPreference,\n        };\n    }\n    beforeRender() {\n        var _a, _b;\n        const [accept, preview] = this._acceptKeybindings;\n        this._label.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n        this._domNode.style.minWidth = `200px`; // to prevent from widening when candidates come in\n        return null;\n    }\n    afterRender(position) {\n        this._trace('invoking afterRender, position: ', position ? 'not null' : 'null');\n        if (position === null) {\n            // cancel rename when input widget isn't rendered anymore\n            this.cancelInput(true, 'afterRender (because position is null)');\n            return;\n        }\n        if (!this._editor.hasModel() || // shouldn't happen\n            !this._editor.getDomNode() // can happen during tests based on suggestWidget's similar predicate check\n        ) {\n            return;\n        }\n        assertType(this._candidatesView);\n        assertType(this._nPxAvailableAbove !== undefined);\n        assertType(this._nPxAvailableBelow !== undefined);\n        const inputBoxHeight = getTotalHeight(this._input);\n        const labelHeight = getTotalHeight(this._label);\n        let totalHeightAvailable;\n        if (position === 2 /* ContentWidgetPositionPreference.BELOW */) {\n            totalHeightAvailable = this._nPxAvailableBelow;\n        }\n        else {\n            totalHeightAvailable = this._nPxAvailableAbove;\n        }\n        this._candidatesView.layout({\n            height: totalHeightAvailable - labelHeight - inputBoxHeight,\n            width: getTotalWidth(this._input),\n        });\n    }\n    acceptInput(wantsPreview) {\n        var _a;\n        this._trace(`invoking acceptInput`);\n        (_a = this._currentAcceptInput) === null || _a === void 0 ? void 0 : _a.call(this, wantsPreview);\n    }\n    cancelInput(focusEditor, caller) {\n        var _a;\n        this._trace(`invoking cancelInput, caller: ${caller}, _currentCancelInput: ${this._currentAcceptInput ? 'not undefined' : 'undefined'}`);\n        (_a = this._currentCancelInput) === null || _a === void 0 ? void 0 : _a.call(this, focusEditor);\n    }\n    focusNextRenameSuggestion() {\n        var _a;\n        (_a = this._candidatesView) === null || _a === void 0 ? void 0 : _a.focusNext();\n    }\n    focusPreviousRenameSuggestion() {\n        var _a;\n        if (!((_a = this._candidatesView) === null || _a === void 0 ? void 0 : _a.focusPrevious())) {\n            this._input.focus();\n        }\n    }\n    /**\n     * @returns a `boolean` standing for `shouldFocusEditor`, if user didn't pick a new name, or a {@link RenameInputFieldResult}\n     */\n    getInput(where, value, selectionStart, selectionEnd, supportPreview, candidates, cts) {\n        this._domNode.classList.toggle('preview', supportPreview);\n        this._position = new Position(where.startLineNumber, where.startColumn);\n        this._input.value = value;\n        this._input.setAttribute('selectionStart', selectionStart.toString());\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20); // determines width\n        const disposeOnDone = new DisposableStore();\n        disposeOnDone.add(toDisposable(() => cts.dispose(true))); // @ulugbekna: this may result in `this.cancelInput` being called twice, but it should be safe since we set it to undefined after 1st call\n        this._updateRenameCandidates(candidates, value, cts.token);\n        return new Promise(resolve => {\n            this._currentCancelInput = (focusEditor) => {\n                var _a;\n                this._trace('invoking _currentCancelInput');\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                (_a = this._candidatesView) === null || _a === void 0 ? void 0 : _a.clearCandidates();\n                resolve(focusEditor);\n                return true;\n            };\n            this._currentAcceptInput = (wantsPreview) => {\n                this._trace('invoking _currentAcceptInput');\n                assertType(this._input !== undefined);\n                assertType(this._candidatesView !== undefined);\n                const nRenameSuggestions = this._candidatesView.nCandidates;\n                let newName;\n                let source;\n                const focusedCandidate = this._candidatesView.focusedCandidate;\n                if (focusedCandidate !== undefined) {\n                    this._trace('using new name from renameSuggestion');\n                    newName = focusedCandidate;\n                    source = 'renameSuggestion';\n                }\n                else {\n                    this._trace('using new name from inputField');\n                    newName = this._input.value;\n                    source = 'inputField';\n                }\n                if (newName === value || newName.trim().length === 0 /* is just whitespace */) {\n                    this.cancelInput(true, '_currentAcceptInput (because newName === value || newName.trim().length === 0)');\n                    return;\n                }\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                this._candidatesView.clearCandidates();\n                resolve({\n                    newName,\n                    wantsPreview: supportPreview && wantsPreview,\n                    source,\n                    nRenameSuggestions,\n                });\n            };\n            disposeOnDone.add(cts.token.onCancellationRequested(() => this.cancelInput(true, 'cts.token.onCancellationRequested')));\n            if (!_sticky) {\n                disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => { var _a; return this.cancelInput(!((_a = this._domNode) === null || _a === void 0 ? void 0 : _a.ownerDocument.hasFocus()), 'editor.onDidBlurEditorWidget'); }));\n            }\n            this._show();\n        }).finally(() => {\n            disposeOnDone.dispose();\n            this._hide();\n        });\n    }\n    _show() {\n        this._trace('invoking _show');\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n        this._visible = true;\n        this._visibleContextKey.set(true);\n        this._editor.layoutContentWidget(this);\n        setTimeout(() => {\n            this._input.focus();\n            this._input.setSelectionRange(parseInt(this._input.getAttribute('selectionStart')), parseInt(this._input.getAttribute('selectionEnd')));\n        }, 100);\n    }\n    async _updateRenameCandidates(candidates, currentName, token) {\n        const trace = (...args) => this._trace('_updateRenameCandidates', ...args);\n        trace('start');\n        const namesListResults = await raceCancellation(Promise.allSettled(candidates), token);\n        if (namesListResults === undefined) {\n            trace('returning early - received updateRenameCandidates results - undefined');\n            return;\n        }\n        const newNames = namesListResults.flatMap(namesListResult => namesListResult.status === 'fulfilled' && isDefined(namesListResult.value)\n            ? namesListResult.value\n            : []);\n        trace(`received updateRenameCandidates results - total (unfiltered) ${newNames.length} candidates.`);\n        // deduplicate and filter out the current value\n        const distinctNames = arrays.distinct(newNames, v => v.newSymbolName);\n        trace(`distinct candidates - ${distinctNames.length} candidates.`);\n        const validDistinctNames = distinctNames.filter(({ newSymbolName }) => { var _a; return newSymbolName.trim().length > 0 && newSymbolName !== ((_a = this._input) === null || _a === void 0 ? void 0 : _a.value) && newSymbolName !== currentName; });\n        trace(`valid distinct candidates - ${newNames.length} candidates.`);\n        if (validDistinctNames.length < 1) {\n            trace('returning early - no valid distinct candidates');\n            return;\n        }\n        // show the candidates\n        trace('setting candidates');\n        this._candidatesView.setCandidates(validDistinctNames);\n        // ask editor to re-layout given that the widget is now of a different size after rendering rename candidates\n        trace('asking editor to re-layout');\n        this._editor.layoutContentWidget(this);\n    }\n    _hide() {\n        this._trace('invoked _hide');\n        this._visible = false;\n        this._visibleContextKey.reset();\n        this._editor.layoutContentWidget(this);\n    }\n    _getTopForPosition() {\n        const visibleRanges = this._editor.getVisibleRanges();\n        let firstLineInViewport;\n        if (visibleRanges.length > 0) {\n            firstLineInViewport = visibleRanges[0].startLineNumber;\n        }\n        else {\n            this._logService.warn('RenameInputField#_getTopForPosition: this should not happen - visibleRanges is empty');\n            firstLineInViewport = Math.max(1, this._position.lineNumber - 5); // @ulugbekna: fallback to current line minus 5\n        }\n        return this._editor.getTopForLineNumber(this._position.lineNumber) - this._editor.getTopForLineNumber(firstLineInViewport);\n    }\n    _trace(...args) {\n        this._logService.trace('RenameInputField', ...args);\n    }\n};\nRenameInputField = __decorate([\n    __param(2, IThemeService),\n    __param(3, IKeybindingService),\n    __param(4, IContextKeyService),\n    __param(5, ILogService)\n], RenameInputField);\nexport { RenameInputField };\nclass CandidatesView {\n    constructor(parent, opts) {\n        this._disposables = new DisposableStore();\n        this._availableHeight = 0;\n        this._minimumWidth = 0;\n        this._lineHeight = opts.fontInfo.lineHeight;\n        this._typicalHalfwidthCharacterWidth = opts.fontInfo.typicalHalfwidthCharacterWidth;\n        this._listContainer = document.createElement('div');\n        this._listContainer.style.fontFamily = opts.fontInfo.fontFamily;\n        this._listContainer.style.fontWeight = opts.fontInfo.fontWeight;\n        this._listContainer.style.fontSize = `${opts.fontInfo.fontSize}px`;\n        parent.appendChild(this._listContainer);\n        const that = this;\n        const virtualDelegate = new class {\n            getTemplateId(element) {\n                return 'candidate';\n            }\n            getHeight(element) {\n                return that._candidateViewHeight;\n            }\n        };\n        const renderer = new class {\n            constructor() {\n                this.templateId = 'candidate';\n            }\n            renderTemplate(container) {\n                return new CandidateView(container, { lineHeight: that._lineHeight });\n            }\n            renderElement(candidate, index, templateData) {\n                templateData.model = candidate;\n            }\n            disposeTemplate(templateData) {\n                templateData.dispose();\n            }\n        };\n        this._listWidget = new List('NewSymbolNameCandidates', this._listContainer, virtualDelegate, [renderer], {\n            keyboardSupport: false, // @ulugbekna: because we handle keyboard events through proper commands & keybinding service, see `rename.ts`\n            mouseSupport: true,\n            multipleSelectionSupport: false,\n        });\n        this._disposables.add(this._listWidget.onDidChangeSelection(e => {\n            if (e.elements.length > 0) {\n                opts.onSelectionChange();\n            }\n        }));\n        this._disposables.add(this._listWidget.onDidBlur(e => {\n            this._listWidget.setFocus([]);\n        }));\n        this._listWidget.style(defaultListStyles);\n    }\n    dispose() {\n        this._listWidget.dispose();\n        this._disposables.dispose();\n    }\n    // height - max height allowed by parent element\n    layout({ height, width }) {\n        this._availableHeight = height;\n        this._minimumWidth = width;\n    }\n    setCandidates(candidates) {\n        // insert candidates into list widget\n        this._listWidget.splice(0, 0, candidates);\n        // adjust list widget layout\n        const height = this._pickListHeight(candidates.length);\n        const width = this._pickListWidth(candidates);\n        this._listWidget.layout(height, width);\n        // adjust list container layout\n        this._listContainer.style.height = `${height}px`;\n        this._listContainer.style.width = `${width}px`;\n        aria.status(localize('renameSuggestionsReceivedAria', \"Received {0} rename suggestions\", candidates.length));\n    }\n    clearCandidates() {\n        this._listContainer.style.height = '0px';\n        this._listContainer.style.width = '0px';\n        this._listWidget.splice(0, this._listWidget.length, []);\n    }\n    get nCandidates() {\n        return this._listWidget.length;\n    }\n    get focusedCandidate() {\n        if (this._listWidget.length === 0) {\n            return;\n        }\n        const selectedElement = this._listWidget.getSelectedElements()[0];\n        if (selectedElement !== undefined) {\n            return selectedElement.newSymbolName;\n        }\n        const focusedElement = this._listWidget.getFocusedElements()[0];\n        if (focusedElement !== undefined) {\n            return focusedElement.newSymbolName;\n        }\n        return;\n    }\n    updateFont(fontInfo) {\n        this._listContainer.style.fontFamily = fontInfo.fontFamily;\n        this._listContainer.style.fontWeight = fontInfo.fontWeight;\n        this._listContainer.style.fontSize = `${fontInfo.fontSize}px`;\n        this._lineHeight = fontInfo.lineHeight;\n        this._listWidget.rerender();\n    }\n    focusNext() {\n        if (this._listWidget.length === 0) {\n            return;\n        }\n        if (this._listWidget.isDOMFocused()) {\n            this._listWidget.focusNext();\n        }\n        else {\n            this._listWidget.domFocus();\n            this._listWidget.focusFirst();\n        }\n        this._listWidget.reveal(this._listWidget.getFocus()[0]);\n    }\n    /**\n     * @returns true if focus is moved to previous element\n     */\n    focusPrevious() {\n        if (this._listWidget.length === 0) {\n            return false;\n        }\n        this._listWidget.domFocus();\n        const focusedIx = this._listWidget.getFocus()[0];\n        if (focusedIx !== 0) {\n            this._listWidget.focusPrevious();\n            this._listWidget.reveal(this._listWidget.getFocus()[0]);\n        }\n        return focusedIx > 0;\n    }\n    get _candidateViewHeight() {\n        const { totalHeight } = CandidateView.getLayoutInfo({ lineHeight: this._lineHeight });\n        return totalHeight;\n    }\n    _pickListHeight(nCandidates) {\n        const heightToFitAllCandidates = this._candidateViewHeight * nCandidates;\n        const MAX_N_CANDIDATES = 7; // @ulugbekna: max # of candidates we want to show at once\n        const height = Math.min(heightToFitAllCandidates, this._availableHeight, this._candidateViewHeight * MAX_N_CANDIDATES);\n        return height;\n    }\n    _pickListWidth(candidates) {\n        const longestCandidateWidth = Math.ceil(Math.max(...candidates.map(c => c.newSymbolName.length)) * this._typicalHalfwidthCharacterWidth);\n        const width = Math.max(this._minimumWidth, 4 /* padding */ + 16 /* sparkle icon */ + 5 /* margin-left */ + longestCandidateWidth + 10 /* (possibly visible) scrollbar width */ // TODO@ulugbekna: approximate calc - clean this up\n        );\n        return width;\n    }\n}\nclass CandidateView {\n    constructor(parent, { lineHeight }) {\n        this.domNode = document.createElement('div');\n        this.domNode.style.display = `flex`;\n        this.domNode.style.alignItems = `center`;\n        this.domNode.style.height = `${lineHeight}px`;\n        this.domNode.style.padding = `${CandidateView._PADDING}px`;\n        this._icon = document.createElement('div');\n        this._icon.style.display = `flex`;\n        this._icon.style.alignItems = `center`;\n        this._icon.style.width = this._icon.style.height = `${lineHeight * 0.8}px`;\n        this.domNode.appendChild(this._icon);\n        this._label = document.createElement('div');\n        this._icon.style.display = `flex`;\n        this._icon.style.alignItems = `center`;\n        this._label.style.marginLeft = '5px';\n        this.domNode.appendChild(this._label);\n        parent.appendChild(this.domNode);\n    }\n    set model(value) {\n        var _a;\n        // @ulugbekna: a hack to always include sparkle for now\n        const alwaysIncludeSparkle = true;\n        // update icon\n        if (alwaysIncludeSparkle || ((_a = value.tags) === null || _a === void 0 ? void 0 : _a.includes(NewSymbolNameTag.AIGenerated))) {\n            if (this._icon.children.length === 0) {\n                this._icon.appendChild(renderIcon(Codicon.sparkle));\n            }\n        }\n        else {\n            if (this._icon.children.length === 1) {\n                this._icon.removeChild(this._icon.children[0]);\n            }\n        }\n        this._label.innerText = value.newSymbolName;\n    }\n    static getLayoutInfo({ lineHeight }) {\n        const totalHeight = lineHeight + CandidateView._PADDING * 2 /* top & bottom padding */;\n        return { totalHeight };\n    }\n    dispose() {\n    }\n}\n// TODO@ulugbekna: accessibility\nCandidateView._PADDING = 2;\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ModelSemanticColoring_1;\nimport { Disposable, dispose } from '../../../../base/common/lifecycle.js';\nimport * as errors from '../../../../base/common/errors.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { getDocumentSemanticTokens, hasDocumentSemanticTokensProvider, isSemanticTokens, isSemanticTokensEdits } from '../common/getSemanticTokens.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { SEMANTIC_HIGHLIGHTING_SETTING_ID, isSemanticColoringEnabled } from '../common/semanticTokensConfig.js';\nlet DocumentSemanticTokensFeature = class DocumentSemanticTokensFeature extends Disposable {\n    constructor(semanticTokensStylingService, modelService, themeService, configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._watchers = Object.create(null);\n        const register = (model) => {\n            this._watchers[model.uri.toString()] = new ModelSemanticColoring(model, semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService);\n        };\n        const deregister = (model, modelSemanticColoring) => {\n            modelSemanticColoring.dispose();\n            delete this._watchers[model.uri.toString()];\n        };\n        const handleSettingOrThemeChange = () => {\n            for (const model of modelService.getModels()) {\n                const curr = this._watchers[model.uri.toString()];\n                if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                    if (!curr) {\n                        register(model);\n                    }\n                }\n                else {\n                    if (curr) {\n                        deregister(model, curr);\n                    }\n                }\n            }\n        };\n        modelService.getModels().forEach(model => {\n            if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                register(model);\n            }\n        });\n        this._register(modelService.onModelAdded((model) => {\n            if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                register(model);\n            }\n        }));\n        this._register(modelService.onModelRemoved((model) => {\n            const curr = this._watchers[model.uri.toString()];\n            if (curr) {\n                deregister(model, curr);\n            }\n        }));\n        this._register(configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                handleSettingOrThemeChange();\n            }\n        }));\n        this._register(themeService.onDidColorThemeChange(handleSettingOrThemeChange));\n    }\n    dispose() {\n        // Dispose all watchers\n        for (const watcher of Object.values(this._watchers)) {\n            watcher.dispose();\n        }\n        super.dispose();\n    }\n};\nDocumentSemanticTokensFeature = __decorate([\n    __param(0, ISemanticTokensStylingService),\n    __param(1, IModelService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], DocumentSemanticTokensFeature);\nexport { DocumentSemanticTokensFeature };\nlet ModelSemanticColoring = ModelSemanticColoring_1 = class ModelSemanticColoring extends Disposable {\n    constructor(model, _semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._isDisposed = false;\n        this._model = model;\n        this._provider = languageFeaturesService.documentSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentSemanticTokens', { min: ModelSemanticColoring_1.REQUEST_MIN_DELAY, max: ModelSemanticColoring_1.REQUEST_MAX_DELAY });\n        this._fetchDocumentSemanticTokens = this._register(new RunOnceScheduler(() => this._fetchDocumentSemanticTokensNow(), ModelSemanticColoring_1.REQUEST_MIN_DELAY));\n        this._currentDocumentResponse = null;\n        this._currentDocumentRequestCancellationTokenSource = null;\n        this._documentProvidersChangeListeners = [];\n        this._providersChangedDuringRequest = false;\n        this._register(this._model.onDidChangeContent(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeAttached(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeLanguage(() => {\n            // clear any outstanding state\n            if (this._currentDocumentResponse) {\n                this._currentDocumentResponse.dispose();\n                this._currentDocumentResponse = null;\n            }\n            if (this._currentDocumentRequestCancellationTokenSource) {\n                this._currentDocumentRequestCancellationTokenSource.cancel();\n                this._currentDocumentRequestCancellationTokenSource = null;\n            }\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(0);\n        }));\n        const bindDocumentChangeListeners = () => {\n            dispose(this._documentProvidersChangeListeners);\n            this._documentProvidersChangeListeners = [];\n            for (const provider of this._provider.all(model)) {\n                if (typeof provider.onDidChange === 'function') {\n                    this._documentProvidersChangeListeners.push(provider.onDidChange(() => {\n                        if (this._currentDocumentRequestCancellationTokenSource) {\n                            // there is already a request running,\n                            this._providersChangedDuringRequest = true;\n                            return;\n                        }\n                        this._fetchDocumentSemanticTokens.schedule(0);\n                    }));\n                }\n            }\n        };\n        bindDocumentChangeListeners();\n        this._register(this._provider.onDidChange(() => {\n            bindDocumentChangeListeners();\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._register(themeService.onDidColorThemeChange(_ => {\n            // clear out existing tokens\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._fetchDocumentSemanticTokens.schedule(0);\n    }\n    dispose() {\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            this._currentDocumentRequestCancellationTokenSource.cancel();\n            this._currentDocumentRequestCancellationTokenSource = null;\n        }\n        dispose(this._documentProvidersChangeListeners);\n        this._documentProvidersChangeListeners = [];\n        this._setDocumentSemanticTokens(null, null, null, []);\n        this._isDisposed = true;\n        super.dispose();\n    }\n    _fetchDocumentSemanticTokensNow() {\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            // there is already a request running, let it finish...\n            return;\n        }\n        if (!hasDocumentSemanticTokensProvider(this._provider, this._model)) {\n            // there is no provider\n            if (this._currentDocumentResponse) {\n                // there are semantic tokens set\n                this._model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!this._model.isAttachedToEditor()) {\n            // this document is not visible, there is no need to fetch semantic tokens for it\n            return;\n        }\n        const cancellationTokenSource = new CancellationTokenSource();\n        const lastProvider = this._currentDocumentResponse ? this._currentDocumentResponse.provider : null;\n        const lastResultId = this._currentDocumentResponse ? this._currentDocumentResponse.resultId || null : null;\n        const request = getDocumentSemanticTokens(this._provider, this._model, lastProvider, lastResultId, cancellationTokenSource.token);\n        this._currentDocumentRequestCancellationTokenSource = cancellationTokenSource;\n        this._providersChangedDuringRequest = false;\n        const pendingChanges = [];\n        const contentChangeListener = this._model.onDidChangeContent((e) => {\n            pendingChanges.push(e);\n        });\n        const sw = new StopWatch(false);\n        request.then((res) => {\n            this._debounceInformation.update(this._model, sw.elapsed());\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (!res) {\n                this._setDocumentSemanticTokens(null, null, null, pendingChanges);\n            }\n            else {\n                const { provider, tokens } = res;\n                const styling = this._semanticTokensStylingService.getStyling(provider);\n                this._setDocumentSemanticTokens(provider, tokens || null, styling, pendingChanges);\n            }\n        }, (err) => {\n            const isExpectedError = err && (errors.isCancellationError(err) || (typeof err.message === 'string' && err.message.indexOf('busy') !== -1));\n            if (!isExpectedError) {\n                errors.onUnexpectedError(err);\n            }\n            // Semantic tokens eats up all errors and considers errors to mean that the result is temporarily not available\n            // The API does not have a special error kind to express this...\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (pendingChanges.length > 0 || this._providersChangedDuringRequest) {\n                // More changes occurred while the request was running\n                if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                    this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n                }\n            }\n        });\n    }\n    static _copy(src, srcOffset, dest, destOffset, length) {\n        // protect against overflows\n        length = Math.min(length, dest.length - destOffset, src.length - srcOffset);\n        for (let i = 0; i < length; i++) {\n            dest[destOffset + i] = src[srcOffset + i];\n        }\n    }\n    _setDocumentSemanticTokens(provider, tokens, styling, pendingChanges) {\n        const currentResponse = this._currentDocumentResponse;\n        const rescheduleIfNeeded = () => {\n            if ((pendingChanges.length > 0 || this._providersChangedDuringRequest) && !this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        };\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._isDisposed) {\n            // disposed!\n            if (provider && tokens) {\n                provider.releaseDocumentSemanticTokens(tokens.resultId);\n            }\n            return;\n        }\n        if (!provider || !styling) {\n            this._model.tokenization.setSemanticTokens(null, false);\n            return;\n        }\n        if (!tokens) {\n            this._model.tokenization.setSemanticTokens(null, true);\n            rescheduleIfNeeded();\n            return;\n        }\n        if (isSemanticTokensEdits(tokens)) {\n            if (!currentResponse) {\n                // not possible!\n                this._model.tokenization.setSemanticTokens(null, true);\n                return;\n            }\n            if (tokens.edits.length === 0) {\n                // nothing to do!\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: currentResponse.data\n                };\n            }\n            else {\n                let deltaLength = 0;\n                for (const edit of tokens.edits) {\n                    deltaLength += (edit.data ? edit.data.length : 0) - edit.deleteCount;\n                }\n                const srcData = currentResponse.data;\n                const destData = new Uint32Array(srcData.length + deltaLength);\n                let srcLastStart = srcData.length;\n                let destLastStart = destData.length;\n                for (let i = tokens.edits.length - 1; i >= 0; i--) {\n                    const edit = tokens.edits[i];\n                    if (edit.start > srcData.length) {\n                        styling.warnInvalidEditStart(currentResponse.resultId, tokens.resultId, i, edit.start, srcData.length);\n                        // The edits are invalid and there's no way to recover\n                        this._model.tokenization.setSemanticTokens(null, true);\n                        return;\n                    }\n                    const copyCount = srcLastStart - (edit.start + edit.deleteCount);\n                    if (copyCount > 0) {\n                        ModelSemanticColoring_1._copy(srcData, srcLastStart - copyCount, destData, destLastStart - copyCount, copyCount);\n                        destLastStart -= copyCount;\n                    }\n                    if (edit.data) {\n                        ModelSemanticColoring_1._copy(edit.data, 0, destData, destLastStart - edit.data.length, edit.data.length);\n                        destLastStart -= edit.data.length;\n                    }\n                    srcLastStart = edit.start;\n                }\n                if (srcLastStart > 0) {\n                    ModelSemanticColoring_1._copy(srcData, 0, destData, 0, srcLastStart);\n                }\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: destData\n                };\n            }\n        }\n        if (isSemanticTokens(tokens)) {\n            this._currentDocumentResponse = new SemanticTokensResponse(provider, tokens.resultId, tokens.data);\n            const result = toMultilineTokens2(tokens, styling, this._model.getLanguageId());\n            // Adjust incoming semantic tokens\n            if (pendingChanges.length > 0) {\n                // More changes occurred while the request was running\n                // We need to:\n                // 1. Adjust incoming semantic tokens\n                // 2. Request them again\n                for (const change of pendingChanges) {\n                    for (const area of result) {\n                        for (const singleChange of change.changes) {\n                            area.applyEdit(singleChange.range, singleChange.text);\n                        }\n                    }\n                }\n            }\n            this._model.tokenization.setSemanticTokens(result, true);\n        }\n        else {\n            this._model.tokenization.setSemanticTokens(null, true);\n        }\n        rescheduleIfNeeded();\n    }\n};\nModelSemanticColoring.REQUEST_MIN_DELAY = 300;\nModelSemanticColoring.REQUEST_MAX_DELAY = 2000;\nModelSemanticColoring = ModelSemanticColoring_1 = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, ILanguageFeatureDebounceService),\n    __param(4, ILanguageFeaturesService)\n], ModelSemanticColoring);\nclass SemanticTokensResponse {\n    constructor(provider, resultId, data) {\n        this.provider = provider;\n        this.resultId = resultId;\n        this.data = data;\n    }\n    dispose() {\n        this.provider.releaseDocumentSemanticTokens(this.resultId);\n    }\n}\nregisterEditorFeature(DocumentSemanticTokensFeature);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { encodeSemanticTokensDto } from '../../../common/services/semanticTokensDto.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport function isSemanticTokens(v) {\n    return v && !!(v.data);\n}\nexport function isSemanticTokensEdits(v) {\n    return v && Array.isArray(v.edits);\n}\nexport class DocumentSemanticTokensResult {\n    constructor(provider, tokens, error) {\n        this.provider = provider;\n        this.tokens = tokens;\n        this.error = error;\n    }\n}\nexport function hasDocumentSemanticTokensProvider(registry, model) {\n    return registry.has(model);\n}\nfunction getDocumentSemanticTokensProviders(registry, model) {\n    const groups = registry.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport async function getDocumentSemanticTokens(registry, model, lastProvider, lastResultId, token) {\n    const providers = getDocumentSemanticTokensProviders(registry, model);\n    // Get tokens from all providers at the same time.\n    const results = await Promise.all(providers.map(async (provider) => {\n        let result;\n        let error = null;\n        try {\n            result = await provider.provideDocumentSemanticTokens(model, (provider === lastProvider ? lastResultId : null), token);\n        }\n        catch (err) {\n            error = err;\n            result = null;\n        }\n        if (!result || (!isSemanticTokens(result) && !isSemanticTokensEdits(result))) {\n            result = null;\n        }\n        return new DocumentSemanticTokensResult(provider, result, error);\n    }));\n    // Try to return the first result with actual tokens or\n    // the first result which threw an error (!!)\n    for (const result of results) {\n        if (result.error) {\n            throw result.error;\n        }\n        if (result.tokens) {\n            return result;\n        }\n    }\n    // Return the first result, even if it doesn't have tokens\n    if (results.length > 0) {\n        return results[0];\n    }\n    return null;\n}\nfunction _getDocumentSemanticTokensProviderHighestGroup(registry, model) {\n    const result = registry.orderedGroups(model);\n    return (result.length > 0 ? result[0] : null);\n}\nclass DocumentRangeSemanticTokensResult {\n    constructor(provider, tokens) {\n        this.provider = provider;\n        this.tokens = tokens;\n    }\n}\nexport function hasDocumentRangeSemanticTokensProvider(providers, model) {\n    return providers.has(model);\n}\nfunction getDocumentRangeSemanticTokensProviders(providers, model) {\n    const groups = providers.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport async function getDocumentRangeSemanticTokens(registry, model, range, token) {\n    const providers = getDocumentRangeSemanticTokensProviders(registry, model);\n    // Get tokens from all providers at the same time.\n    const results = await Promise.all(providers.map(async (provider) => {\n        let result;\n        try {\n            result = await provider.provideDocumentRangeSemanticTokens(model, range, token);\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n            result = null;\n        }\n        if (!result || !isSemanticTokens(result)) {\n            result = null;\n        }\n        return new DocumentRangeSemanticTokensResult(provider, result);\n    }));\n    // Try to return the first result with actual tokens\n    for (const result of results) {\n        if (result.tokens) {\n            return result;\n        }\n    }\n    // Return the first result, even if it doesn't have tokens\n    if (results.length > 0) {\n        return results[0];\n    }\n    return null;\n}\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokensLegend', async (accessor, ...args) => {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = _getDocumentSemanticTokensProviderHighestGroup(documentSemanticTokensProvider, model);\n    if (!providers) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokensLegend', uri);\n    }\n    return providers[0].getLegend();\n});\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokens', async (accessor, ...args) => {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    if (!hasDocumentSemanticTokensProvider(documentSemanticTokensProvider, model)) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokens', uri, model.getFullModelRange());\n    }\n    const r = await getDocumentSemanticTokens(documentSemanticTokensProvider, model, null, null, CancellationToken.None);\n    if (!r) {\n        return undefined;\n    }\n    const { provider, tokens } = r;\n    if (!tokens || !isSemanticTokens(tokens)) {\n        return undefined;\n    }\n    const buff = encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: tokens.data\n    });\n    if (tokens.resultId) {\n        provider.releaseDocumentSemanticTokens(tokens.resultId);\n    }\n    return buff;\n});\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokensLegend', async (accessor, ...args) => {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = getDocumentRangeSemanticTokensProviders(documentRangeSemanticTokensProvider, model);\n    if (providers.length === 0) {\n        // no providers\n        return undefined;\n    }\n    if (providers.length === 1) {\n        // straight forward case, just a single provider\n        return providers[0].getLegend();\n    }\n    if (!range || !Range.isIRange(range)) {\n        // if no range is provided, we cannot support multiple providers\n        // as we cannot fall back to the one which would give results\n        // => return the first legend for backwards compatibility and print a warning\n        console.warn(`provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in`);\n        return providers[0].getLegend();\n    }\n    const result = await getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result) {\n        return undefined;\n    }\n    return result.provider.getLegend();\n});\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokens', async (accessor, ...args) => {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    assertType(Range.isIRange(range));\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const result = await getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result || !result.tokens) {\n        // there is no provider or it didn't return tokens\n        return undefined;\n    }\n    return encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: result.tokens.data\n    });\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport * as platform from '../../../base/common/platform.js';\nfunction reverseEndianness(arr) {\n    for (let i = 0, len = arr.length; i < len; i += 4) {\n        // flip bytes 0<->3 and 1<->2\n        const b0 = arr[i + 0];\n        const b1 = arr[i + 1];\n        const b2 = arr[i + 2];\n        const b3 = arr[i + 3];\n        arr[i + 0] = b3;\n        arr[i + 1] = b2;\n        arr[i + 2] = b1;\n        arr[i + 3] = b0;\n    }\n}\nfunction toLittleEndianBuffer(arr) {\n    const uint8Arr = new Uint8Array(arr.buffer, arr.byteOffset, arr.length * 4);\n    if (!platform.isLittleEndian()) {\n        // the byte order must be changed\n        reverseEndianness(uint8Arr);\n    }\n    return VSBuffer.wrap(uint8Arr);\n}\nexport function encodeSemanticTokensDto(semanticTokens) {\n    const dest = new Uint32Array(encodeSemanticTokensDtoSize(semanticTokens));\n    let offset = 0;\n    dest[offset++] = semanticTokens.id;\n    if (semanticTokens.type === 'full') {\n        dest[offset++] = 1 /* EncodedSemanticTokensType.Full */;\n        dest[offset++] = semanticTokens.data.length;\n        dest.set(semanticTokens.data, offset);\n        offset += semanticTokens.data.length;\n    }\n    else {\n        dest[offset++] = 2 /* EncodedSemanticTokensType.Delta */;\n        dest[offset++] = semanticTokens.deltas.length;\n        for (const delta of semanticTokens.deltas) {\n            dest[offset++] = delta.start;\n            dest[offset++] = delta.deleteCount;\n            if (delta.data) {\n                dest[offset++] = delta.data.length;\n                dest.set(delta.data, offset);\n                offset += delta.data.length;\n            }\n            else {\n                dest[offset++] = 0;\n            }\n        }\n    }\n    return toLittleEndianBuffer(dest);\n}\nfunction encodeSemanticTokensDtoSize(semanticTokens) {\n    let result = 0;\n    result += (+1 // id\n        + 1 // type\n    );\n    if (semanticTokens.type === 'full') {\n        result += (+1 // data length\n            + semanticTokens.data.length);\n    }\n    else {\n        result += (+1 // delta count\n        );\n        result += (+1 // start\n            + 1 // deleteCount\n            + 1 // data length\n        ) * semanticTokens.deltas.length;\n        for (const delta of semanticTokens.deltas) {\n            if (delta.data) {\n                result += delta.data.length;\n            }\n        }\n    }\n    return result;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const SEMANTIC_HIGHLIGHTING_SETTING_ID = 'editor.semanticHighlighting';\nexport function isSemanticColoringEnabled(model, themeService, configurationService) {\n    var _a;\n    const setting = (_a = configurationService.getValue(SEMANTIC_HIGHLIGHTING_SETTING_ID, { overrideIdentifier: model.getLanguageId(), resource: model.uri })) === null || _a === void 0 ? void 0 : _a.enabled;\n    if (typeof setting === 'boolean') {\n        return setting;\n    }\n    return themeService.getColorTheme().semanticHighlighting;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { getDocumentRangeSemanticTokens, hasDocumentRangeSemanticTokensProvider } from '../common/getSemanticTokens.js';\nimport { isSemanticColoringEnabled, SEMANTIC_HIGHLIGHTING_SETTING_ID } from '../common/semanticTokensConfig.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nlet ViewportSemanticTokensContribution = class ViewportSemanticTokensContribution extends Disposable {\n    constructor(editor, _semanticTokensStylingService, _themeService, _configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._themeService = _themeService;\n        this._configurationService = _configurationService;\n        this._editor = editor;\n        this._provider = languageFeaturesService.documentRangeSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentRangeSemanticTokens', { min: 100, max: 500 });\n        this._tokenizeViewport = this._register(new RunOnceScheduler(() => this._tokenizeViewportNow(), 100));\n        this._outstandingRequests = [];\n        const scheduleTokenizeViewport = () => {\n            if (this._editor.hasModel()) {\n                this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()));\n            }\n        };\n        this._register(this._editor.onDidScrollChange(() => {\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._provider.onDidChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                this._cancelAll();\n                scheduleTokenizeViewport();\n            }\n        }));\n        this._register(this._themeService.onDidColorThemeChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        scheduleTokenizeViewport();\n    }\n    _cancelAll() {\n        for (const request of this._outstandingRequests) {\n            request.cancel();\n        }\n        this._outstandingRequests = [];\n    }\n    _removeOutstandingRequest(req) {\n        for (let i = 0, len = this._outstandingRequests.length; i < len; i++) {\n            if (this._outstandingRequests[i] === req) {\n                this._outstandingRequests.splice(i, 1);\n                return;\n            }\n        }\n    }\n    _tokenizeViewportNow() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (model.tokenization.hasCompleteSemanticTokens()) {\n            return;\n        }\n        if (!isSemanticColoringEnabled(model, this._themeService, this._configurationService)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!hasDocumentRangeSemanticTokensProvider(this._provider, model)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        this._outstandingRequests = this._outstandingRequests.concat(visibleRanges.map(range => this._requestRange(model, range)));\n    }\n    _requestRange(model, range) {\n        const requestVersionId = model.getVersionId();\n        const request = createCancelablePromise(token => Promise.resolve(getDocumentRangeSemanticTokens(this._provider, model, range, token)));\n        const sw = new StopWatch(false);\n        request.then((r) => {\n            this._debounceInformation.update(model, sw.elapsed());\n            if (!r || !r.tokens || model.isDisposed() || model.getVersionId() !== requestVersionId) {\n                return;\n            }\n            const { provider, tokens: result } = r;\n            const styling = this._semanticTokensStylingService.getStyling(provider);\n            model.tokenization.setPartialSemanticTokens(range, toMultilineTokens2(result, styling, model.getLanguageId()));\n        }).then(() => this._removeOutstandingRequest(request), () => this._removeOutstandingRequest(request));\n        return request;\n    }\n};\nViewportSemanticTokensContribution.ID = 'editor.contrib.viewportSemanticTokens';\nViewportSemanticTokensContribution = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], ViewportSemanticTokensContribution);\nexport { ViewportSemanticTokensContribution };\nregisterEditorContribution(ViewportSemanticTokensContribution.ID, ViewportSemanticTokensContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SmartSelectController_1;\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\nimport { WordSelectionRangeProvider } from './wordSelections.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nclass SelectionRanges {\n    constructor(index, ranges) {\n        this.index = index;\n        this.ranges = ranges;\n    }\n    mov(fwd) {\n        const index = this.index + (fwd ? 1 : -1);\n        if (index < 0 || index >= this.ranges.length) {\n            return this;\n        }\n        const res = new SelectionRanges(index, this.ranges);\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\n            // next range equals this range, retry with next-next\n            return res.mov(fwd);\n        }\n        return res;\n    }\n}\nlet SmartSelectController = SmartSelectController_1 = class SmartSelectController {\n    static get(editor) {\n        return editor.getContribution(SmartSelectController_1.ID);\n    }\n    constructor(_editor, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._ignoreSelection = false;\n    }\n    dispose() {\n        var _a;\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n    async run(forward) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const selections = this._editor.getSelections();\n        const model = this._editor.getModel();\n        if (!this._state) {\n            await provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider, model, selections.map(s => s.getPosition()), this._editor.getOption(113 /* EditorOption.smartSelect */), CancellationToken.None).then(ranges => {\n                var _a;\n                if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\n                    // invalid result\n                    return;\n                }\n                if (!this._editor.hasModel() || !arrays.equals(this._editor.getSelections(), selections, (a, b) => a.equalsSelection(b))) {\n                    // invalid editor state\n                    return;\n                }\n                for (let i = 0; i < ranges.length; i++) {\n                    ranges[i] = ranges[i].filter(range => {\n                        // filter ranges inside the selection\n                        return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\n                    });\n                    // prepend current selection\n                    ranges[i].unshift(selections[i]);\n                }\n                this._state = ranges.map(ranges => new SelectionRanges(0, ranges));\n                // listen to caret move and forget about state\n                (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                this._selectionListener = this._editor.onDidChangeCursorPosition(() => {\n                    var _a;\n                    if (!this._ignoreSelection) {\n                        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                        this._state = undefined;\n                    }\n                });\n            });\n        }\n        if (!this._state) {\n            // no state\n            return;\n        }\n        this._state = this._state.map(state => state.mov(forward));\n        const newSelections = this._state.map(state => Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()));\n        this._ignoreSelection = true;\n        try {\n            this._editor.setSelections(newSelections);\n        }\n        finally {\n            this._ignoreSelection = false;\n        }\n    }\n};\nSmartSelectController.ID = 'editor.contrib.smartSelectController';\nSmartSelectController = SmartSelectController_1 = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SmartSelectController);\nexport { SmartSelectController };\nclass AbstractSmartSelect extends EditorAction {\n    constructor(forward, opts) {\n        super(opts);\n        this._forward = forward;\n    }\n    async run(_accessor, editor) {\n        const controller = SmartSelectController.get(editor);\n        if (controller) {\n            await controller.run(this._forward);\n        }\n    }\n}\nclass GrowSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(true, {\n            id: 'editor.action.smartSelect.expand',\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\n            alias: 'Expand Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\n                order: 2\n            }\n        });\n    }\n}\n// renamed command id\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\nclass ShrinkSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(false, {\n            id: 'editor.action.smartSelect.shrink',\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\n            alias: 'Shrink Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\n                order: 3\n            }\n        });\n    }\n}\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(GrowSelectionAction);\nregisterEditorAction(ShrinkSelectionAction);\nexport async function provideSelectionRanges(registry, model, positions, options, token) {\n    const providers = registry.all(model)\n        .concat(new WordSelectionRangeProvider(options.selectSubwords)); // ALWAYS have word based selection range\n    if (providers.length === 1) {\n        // add word selection and bracket selection when no provider exists\n        providers.unshift(new BracketSelectionRangeProvider());\n    }\n    const work = [];\n    const allRawRanges = [];\n    for (const provider of providers) {\n        work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(allProviderRanges => {\n            if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\n                for (let i = 0; i < positions.length; i++) {\n                    if (!allRawRanges[i]) {\n                        allRawRanges[i] = [];\n                    }\n                    for (const oneProviderRanges of allProviderRanges[i]) {\n                        if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\n                            allRawRanges[i].push(Range.lift(oneProviderRanges.range));\n                        }\n                    }\n                }\n            }\n        }, onUnexpectedExternalError));\n    }\n    await Promise.all(work);\n    return allRawRanges.map(oneRawRanges => {\n        if (oneRawRanges.length === 0) {\n            return [];\n        }\n        // sort all by start/end position\n        oneRawRanges.sort((a, b) => {\n            if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\n                return 1;\n            }\n            else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\n                return -1;\n            }\n            else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\n                return -1;\n            }\n            else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        });\n        // remove ranges that don't contain the former range or that are equal to the\n        // former range\n        const oneRanges = [];\n        let last;\n        for (const range of oneRawRanges) {\n            if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\n                oneRanges.push(range);\n                last = range;\n            }\n        }\n        if (!options.selectLeadingAndTrailingWhitespace) {\n            return oneRanges;\n        }\n        // add ranges that expand trivia at line starts and ends whenever a range\n        // wraps onto the a new line\n        const oneRangesWithTrivia = [oneRanges[0]];\n        for (let i = 1; i < oneRanges.length; i++) {\n            const prev = oneRanges[i - 1];\n            const cur = oneRanges[i];\n            if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\n                // add line/block range without leading/failing whitespace\n                const rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\n                if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\n                    oneRangesWithTrivia.push(rangeNoWhitespace);\n                }\n                // add line/block range\n                const rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\n                if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\n                    oneRangesWithTrivia.push(rangeFull);\n                }\n            }\n            oneRangesWithTrivia.push(cur);\n        }\n        return oneRangesWithTrivia;\n    });\n}\nCommandsRegistry.registerCommand('_executeSelectionRangeProvider', async function (accessor, ...args) {\n    const [resource, positions] = args;\n    assertType(URI.isUri(resource));\n    const registry = accessor.get(ILanguageFeaturesService).selectionRangeProvider;\n    const reference = await accessor.get(ITextModelService).createModelReference(resource);\n    try {\n        return provideSelectionRanges(registry, reference.object.textEditorModel, positions, { selectLeadingAndTrailingWhitespace: true, selectSubwords: true }, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isLowerAsciiLetter, isUpperAsciiLetter } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nexport class WordSelectionRangeProvider {\n    constructor(selectSubwords = true) {\n        this.selectSubwords = selectSubwords;\n    }\n    provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            if (this.selectSubwords) {\n                this._addInWordRanges(bucket, model, position);\n            }\n            this._addWordRanges(bucket, model, position);\n            this._addWhitespaceLine(bucket, model, position);\n            bucket.push({ range: model.getFullModelRange() });\n        }\n        return result;\n    }\n    _addInWordRanges(bucket, model, pos) {\n        const obj = model.getWordAtPosition(pos);\n        if (!obj) {\n            return;\n        }\n        const { word, startColumn } = obj;\n        const offset = pos.column - startColumn;\n        let start = offset;\n        let end = offset;\n        let lastCh = 0;\n        // LEFT anchor (start)\n        for (; start >= 0; start--) {\n            const ch = word.charCodeAt(start);\n            if ((start !== offset) && (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */)) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            lastCh = ch;\n        }\n        start += 1;\n        // RIGHT anchor (end)\n        for (; end < word.length; end++) {\n            const ch = word.charCodeAt(end);\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            else if (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            lastCh = ch;\n        }\n        if (start < end) {\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\n        }\n    }\n    _addWordRanges(bucket, model, pos) {\n        const word = model.getWordAtPosition(pos);\n        if (word) {\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\n        }\n    }\n    _addWhitespaceLine(bucket, model, pos) {\n        if (model.getLineLength(pos.lineNumber) > 0\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ToggleStickyScroll, FocusStickyScroll, SelectEditor, SelectPreviousStickyScrollLine, SelectNextStickyScrollLine, GoToStickyScrollLine } from './stickyScrollActions.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\nregisterEditorContribution(StickyScrollController.ID, StickyScrollController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterAction2(ToggleStickyScroll);\nregisterAction2(FocusStickyScroll);\nregisterAction2(SelectPreviousStickyScrollLine);\nregisterAction2(SelectNextStickyScrollLine);\nregisterAction2(GoToStickyScrollLine);\nregisterAction2(SelectEditor);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Categories } from '../../../../platform/action/common/actionCommonCategories.js';\nimport { Action2, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nexport class ToggleStickyScroll extends Action2 {\n    constructor() {\n        super({\n            id: 'editor.action.toggleStickyScroll',\n            title: {\n                ...localize2('toggleEditorStickyScroll', \"Toggle Editor Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'mitoggleStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Editor Sticky Scroll\"),\n            },\n            category: Categories.View,\n            toggled: {\n                condition: ContextKeyExpr.equals('config.editor.stickyScroll.enabled', true),\n                title: localize('stickyScroll', \"Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'miStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Sticky Scroll\"),\n            },\n            menu: [\n                { id: MenuId.CommandPalette },\n                { id: MenuId.MenubarAppearanceMenu, group: '4_editor', order: 3 },\n                { id: MenuId.StickyScrollContext }\n            ]\n        });\n    }\n    async run(accessor) {\n        const configurationService = accessor.get(IConfigurationService);\n        const newValue = !configurationService.getValue('editor.stickyScroll.enabled');\n        return configurationService.updateValue('editor.stickyScroll.enabled', newValue);\n    }\n}\nconst weight = 100 /* KeybindingWeight.EditorContrib */;\nexport class FocusStickyScroll extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.focusStickyScroll',\n            title: {\n                ...localize2('focusStickyScroll', \"Focus Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'mifocusStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Focus Sticky Scroll\"),\n            },\n            precondition: ContextKeyExpr.and(ContextKeyExpr.has('config.editor.stickyScroll.enabled'), EditorContextKeys.stickyScrollVisible),\n            menu: [\n                { id: MenuId.CommandPalette },\n            ]\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n}\nexport class SelectNextStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectNextStickyScrollLine',\n            title: localize2('selectNextStickyScrollLine.title', \"Select next sticky scroll line\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 18 /* KeyCode.DownArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focusNext();\n    }\n}\nexport class SelectPreviousStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectPreviousStickyScrollLine',\n            title: localize2('selectPreviousStickyScrollLine.title', \"Select previous sticky scroll line\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 16 /* KeyCode.UpArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.focusPrevious();\n    }\n}\nexport class GoToStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.goToFocusedStickyScrollLine',\n            title: localize2('goToFocusedStickyScrollLine.title', \"Go to focused sticky scroll line\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 3 /* KeyCode.Enter */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.goToFocused();\n    }\n}\nexport class SelectEditor extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectEditor',\n            title: localize2('selectEditor.title', \"Select Editor\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 9 /* KeyCode.Escape */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        var _a;\n        (_a = StickyScrollController.get(editor)) === null || _a === void 0 ? void 0 : _a.selectEditor();\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { localize2 } from '../../../nls.js';\nexport const Categories = Object.freeze({\n    View: localize2('view', 'View'),\n    Help: localize2('help', 'Help'),\n    Test: localize2('test', 'Test'),\n    File: localize2('file', 'File'),\n    Preferences: localize2('preferences', 'Preferences'),\n    Developer: localize2({ key: 'developer', comment: ['A developer on Code itself or someone diagnosing issues in Code'] }, \"Developer\"),\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar StickyScrollController_1;\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { FoldingController } from '../../folding/browser/folding.js';\nimport { toggleCollapseState } from '../../folding/browser/foldingModel.js';\nlet StickyScrollController = StickyScrollController_1 = class StickyScrollController extends Disposable {\n    constructor(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextMenuService = _contextMenuService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instaService = _instaService;\n        this._contextKeyService = _contextKeyService;\n        this._sessionStore = new DisposableStore();\n        this._foldingModel = null;\n        this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n        this._candidateDefinitionsLength = -1;\n        this._focusedStickyElementIndex = -1;\n        this._enabled = false;\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n        this._endLineNumbers = [];\n        this._showEndForLine = null;\n        this._stickyScrollWidget = new StickyScrollWidget(this._editor);\n        this._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n        this._register(this._stickyScrollWidget);\n        this._register(this._stickyLineCandidateProvider);\n        this._widgetState = new StickyScrollWidgetState([], [], 0);\n        this._onDidResize();\n        this._readConfiguration();\n        const stickyScrollDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(115 /* EditorOption.stickyScroll */)\n                || e.hasChanged(73 /* EditorOption.minimap */)\n                || e.hasChanged(67 /* EditorOption.lineHeight */)\n                || e.hasChanged(110 /* EditorOption.showFoldingControls */)) {\n                this._readConfiguration();\n            }\n        }));\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.CONTEXT_MENU, async (event) => {\n            this._onContextMenu(dom.getWindow(stickyScrollDomNode), event);\n        }));\n        this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n        this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n        const focusTracker = this._register(dom.trackFocus(stickyScrollDomNode));\n        this._register(focusTracker.onDidBlur(_ => {\n            // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n            // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n            if (this._positionRevealed === false && stickyScrollDomNode.clientHeight === 0) {\n                this._focusedStickyElementIndex = -1;\n                this.focus();\n            }\n            // In all other casees, dispose the focus on the sticky scroll\n            else {\n                this._disposeFocusStickyScrollStore();\n            }\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        this._registerMouseListeners();\n        // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.MOUSE_DOWN, (e) => {\n            this._onMouseDown = true;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(StickyScrollController_1.ID);\n    }\n    _disposeFocusStickyScrollStore() {\n        var _a;\n        this._stickyScrollFocusedContextKey.set(false);\n        (_a = this._focusDisposableStore) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n    }\n    focus() {\n        // If the mouse is down, do not focus on the sticky scroll\n        if (this._onMouseDown) {\n            this._onMouseDown = false;\n            this._editor.focus();\n            return;\n        }\n        const focusState = this._stickyScrollFocusedContextKey.get();\n        if (focusState === true) {\n            return;\n        }\n        this._focused = true;\n        this._focusDisposableStore = new DisposableStore();\n        this._stickyScrollFocusedContextKey.set(true);\n        this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    focusNext() {\n        if (this._focusedStickyElementIndex < this._stickyScrollWidget.lineNumberCount - 1) {\n            this._focusNav(true);\n        }\n    }\n    focusPrevious() {\n        if (this._focusedStickyElementIndex > 0) {\n            this._focusNav(false);\n        }\n    }\n    selectEditor() {\n        this._editor.focus();\n    }\n    // True is next, false is previous\n    _focusNav(direction) {\n        this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    goToFocused() {\n        const lineNumbers = this._stickyScrollWidget.lineNumbers;\n        this._disposeFocusStickyScrollStore();\n        this._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n    }\n    _revealPosition(position) {\n        this._reveaInEditor(position, () => this._editor.revealPosition(position));\n    }\n    _revealLineInCenterIfOutsideViewport(position) {\n        this._reveaInEditor(position, () => this._editor.revealLineInCenterIfOutsideViewport(position.lineNumber, 0 /* ScrollType.Smooth */));\n    }\n    _reveaInEditor(position, revealFunction) {\n        if (this._focused) {\n            this._disposeFocusStickyScrollStore();\n        }\n        this._positionRevealed = true;\n        revealFunction();\n        this._editor.setSelection(Range.fromPositions(position));\n        this._editor.focus();\n    }\n    _registerMouseListeners() {\n        const sessionStore = this._register(new DisposableStore());\n        const gesture = this._register(new ClickLinkGesture(this._editor, {\n            extractLineNumberFromMouseEvent: (e) => {\n                const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n                return position ? position.lineNumber : 0;\n            }\n        }));\n        const getMouseEventTarget = (mouseEvent) => {\n            if (!this._editor.hasModel()) {\n                return null;\n            }\n            if (mouseEvent.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || mouseEvent.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return null;\n            }\n            const mouseTargetElement = mouseEvent.target.element;\n            if (!mouseTargetElement || mouseTargetElement.innerText !== mouseTargetElement.innerHTML) {\n                // not on a span element rendering text\n                return null;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(mouseTargetElement);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return null;\n            }\n            return {\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column + mouseTargetElement.innerText.length),\n                textElement: mouseTargetElement\n            };\n        };\n        const stickyScrollWidgetDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.CLICK, (mouseEvent) => {\n            if (mouseEvent.ctrlKey || mouseEvent.altKey || mouseEvent.metaKey) {\n                // modifier pressed\n                return;\n            }\n            if (!mouseEvent.leftButton) {\n                // not left click\n                return;\n            }\n            if (mouseEvent.shiftKey) {\n                // shift click\n                const lineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (lineIndex === null) {\n                    return;\n                }\n                const position = new Position(this._endLineNumbers[lineIndex], 1);\n                this._revealLineInCenterIfOutsideViewport(position);\n                return;\n            }\n            const isInFoldingIconDomNode = this._stickyScrollWidget.isInFoldingIconDomNode(mouseEvent.target);\n            if (isInFoldingIconDomNode) {\n                // clicked on folding icon\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                this._toggleFoldingRegionForLine(lineNumber);\n                return;\n            }\n            const isInStickyLine = this._stickyScrollWidget.isInStickyLine(mouseEvent.target);\n            if (!isInStickyLine) {\n                return;\n            }\n            // normal click\n            let position = this._stickyScrollWidget.getEditorPositionFromNode(mouseEvent.target);\n            if (!position) {\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                if (lineNumber === null) {\n                    // not hovering a sticky scroll line\n                    return;\n                }\n                position = new Position(lineNumber, 1);\n            }\n            this._revealPosition(position);\n        }));\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_MOVE, (mouseEvent) => {\n            if (mouseEvent.shiftKey) {\n                const currentEndForLineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (currentEndForLineIndex === null || this._showEndForLine !== null && this._showEndForLine === currentEndForLineIndex) {\n                    return;\n                }\n                this._showEndForLine = currentEndForLineIndex;\n                this._renderStickyScroll();\n                return;\n            }\n            if (this._showEndForLine !== null) {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(dom.addDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_LEAVE, (e) => {\n            if (this._showEndForLine !== null) {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n            const mouseTarget = getMouseEventTarget(mouseEvent);\n            if (!mouseTarget || !mouseEvent.hasTriggerModifier || !this._editor.hasModel()) {\n                sessionStore.clear();\n                return;\n            }\n            const { range, textElement } = mouseTarget;\n            if (!range.equalsRange(this._stickyRangeProjectedOnEditor)) {\n                this._stickyRangeProjectedOnEditor = range;\n                sessionStore.clear();\n            }\n            else if (textElement.style.textDecoration === 'underline') {\n                return;\n            }\n            const cancellationToken = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n            let currentHTMLChild;\n            getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(range.startLineNumber, range.startColumn + 1), cancellationToken.token).then((candidateDefinitions => {\n                if (cancellationToken.token.isCancellationRequested) {\n                    return;\n                }\n                if (candidateDefinitions.length !== 0) {\n                    this._candidateDefinitionsLength = candidateDefinitions.length;\n                    const childHTML = textElement;\n                    if (currentHTMLChild !== childHTML) {\n                        sessionStore.clear();\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                    else if (!currentHTMLChild) {\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                }\n                else {\n                    sessionStore.clear();\n                }\n            }));\n        }));\n        this._register(gesture.onCancel(() => {\n            sessionStore.clear();\n        }));\n        this._register(gesture.onExecute(async (e) => {\n            if (e.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || e.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return;\n            }\n            if (!this._editor.hasModel() || !this._stickyRangeProjectedOnEditor) {\n                return;\n            }\n            if (this._candidateDefinitionsLength > 1) {\n                if (this._focused) {\n                    this._disposeFocusStickyScrollStore();\n                }\n                this._revealPosition({ lineNumber: position.lineNumber, column: 1 });\n            }\n            this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n        }));\n    }\n    _onContextMenu(targetWindow, e) {\n        const event = new StandardMouseEvent(targetWindow, e);\n        this._contextMenuService.showContextMenu({\n            menuId: MenuId.StickyScrollContext,\n            getAnchor: () => event,\n        });\n    }\n    _toggleFoldingRegionForLine(line) {\n        if (!this._foldingModel || line === null) {\n            return;\n        }\n        const stickyLine = this._stickyScrollWidget.getRenderedStickyLine(line);\n        const foldingIcon = stickyLine === null || stickyLine === void 0 ? void 0 : stickyLine.foldingIcon;\n        if (!foldingIcon) {\n            return;\n        }\n        toggleCollapseState(this._foldingModel, Number.MAX_VALUE, [line]);\n        foldingIcon.isCollapsed = !foldingIcon.isCollapsed;\n        const scrollTop = (foldingIcon.isCollapsed ?\n            this._editor.getTopForLineNumber(foldingIcon.foldingEndLine)\n            : this._editor.getTopForLineNumber(foldingIcon.foldingStartLine))\n            - this._editor.getOption(67 /* EditorOption.lineHeight */) * stickyLine.index + 1;\n        this._editor.setScrollTop(scrollTop);\n        this._renderStickyScroll(line);\n    }\n    _readConfiguration() {\n        const options = this._editor.getOption(115 /* EditorOption.stickyScroll */);\n        if (options.enabled === false) {\n            this._editor.removeOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.clear();\n            this._enabled = false;\n            return;\n        }\n        else if (options.enabled && !this._enabled) {\n            // When sticky scroll was just enabled, add the listeners on the sticky scroll\n            this._editor.addOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.add(this._editor.onDidScrollChange((e) => {\n                if (e.scrollTopChanged) {\n                    this._showEndForLine = null;\n                    this._renderStickyScroll();\n                }\n            }));\n            this._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n            this._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n            this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => {\n                this._showEndForLine = null;\n                this._renderStickyScroll();\n            }));\n            this._enabled = true;\n        }\n        const lineNumberOption = this._editor.getOption(68 /* EditorOption.lineNumbers */);\n        if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            this._sessionStore.add(this._editor.onDidChangeCursorPosition(() => {\n                this._showEndForLine = null;\n                this._renderStickyScroll(0);\n            }));\n        }\n    }\n    _needsUpdate(event) {\n        const stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n        for (const stickyLineNumber of stickyLineNumbers) {\n            for (const range of event.ranges) {\n                if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    _onTokensChange(event) {\n        if (this._needsUpdate(event)) {\n            // Rebuilding the whole widget from line 0\n            this._renderStickyScroll(0);\n        }\n    }\n    _onDidResize() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        // Make sure sticky scroll doesn't take up more than 25% of the editor\n        const theoreticalLines = layoutInfo.height / this._editor.getOption(67 /* EditorOption.lineHeight */);\n        this._maxStickyLines = Math.round(theoreticalLines * .25);\n    }\n    async _renderStickyScroll(rebuildFromLine) {\n        var _a, _b;\n        const model = this._editor.getModel();\n        if (!model || model.isTooLargeForTokenization()) {\n            this._foldingModel = null;\n            this._stickyScrollWidget.setState(undefined, null);\n            return;\n        }\n        const stickyLineVersion = this._stickyLineCandidateProvider.getVersionId();\n        if (stickyLineVersion === undefined || stickyLineVersion === model.getVersionId()) {\n            this._foldingModel = (_b = await ((_a = FoldingController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.getFoldingModel())) !== null && _b !== void 0 ? _b : null;\n            this._widgetState = this.findScrollWidgetState();\n            this._stickyScrollVisibleContextKey.set(!(this._widgetState.startLineNumbers.length === 0));\n            if (!this._focused) {\n                this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n            }\n            else {\n                // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n                if (this._focusedStickyElementIndex === -1) {\n                    this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                    this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                    if (this._focusedStickyElementIndex !== -1) {\n                        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                    }\n                }\n                else {\n                    const focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n                    this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n                    // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n                    if (this._stickyScrollWidget.lineNumberCount === 0) {\n                        this._focusedStickyElementIndex = -1;\n                    }\n                    else {\n                        const previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n                        // If the line number is still there, do not change anything\n                        // If the line number is not there, set the new focused line to be the last line\n                        if (!previousFocusedLineNumberExists) {\n                            this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                        }\n                        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                    }\n                }\n            }\n        }\n    }\n    findScrollWidgetState() {\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(115 /* EditorOption.stickyScroll */).maxLineCount);\n        const scrollTop = this._editor.getScrollTop();\n        let lastLineRelativePosition = 0;\n        const startLineNumbers = [];\n        const endLineNumbers = [];\n        const arrayVisibleRanges = this._editor.getVisibleRanges();\n        if (arrayVisibleRanges.length !== 0) {\n            const fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n            const candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n            for (const range of candidateRanges) {\n                const start = range.startLineNumber;\n                const end = range.endLineNumber;\n                const depth = range.nestingDepth;\n                if (end - start > 0) {\n                    const topOfElementAtDepth = (depth - 1) * lineHeight;\n                    const bottomOfElementAtDepth = depth * lineHeight;\n                    const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n                    const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n                    const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n                    if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                        lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n                        break;\n                    }\n                    else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                    }\n                    if (startLineNumbers.length === maxNumberStickyLines) {\n                        break;\n                    }\n                }\n            }\n        }\n        this._endLineNumbers = endLineNumbers;\n        return new StickyScrollWidgetState(startLineNumbers, endLineNumbers, lastLineRelativePosition, this._showEndForLine);\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n};\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = StickyScrollController_1 = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageConfigurationService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, IContextKeyService)\n], StickyScrollController);\nexport { StickyScrollController };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './stickyScroll.css';\nimport { getColumnOfNodeOffset } from '../../../browser/viewParts/lines/viewLine.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { foldingCollapsedIcon, foldingExpandedIcon } from '../../folding/browser/foldingDecorations.js';\nexport class StickyScrollWidgetState {\n    constructor(startLineNumbers, endLineNumbers, lastLineRelativePosition, showEndForLine = null) {\n        this.startLineNumbers = startLineNumbers;\n        this.endLineNumbers = endLineNumbers;\n        this.lastLineRelativePosition = lastLineRelativePosition;\n        this.showEndForLine = showEndForLine;\n    }\n    equals(other) {\n        return !!other\n            && this.lastLineRelativePosition === other.lastLineRelativePosition\n            && this.showEndForLine === other.showEndForLine\n            && equals(this.startLineNumbers, other.startLineNumbers)\n            && equals(this.endLineNumbers, other.endLineNumbers);\n    }\n}\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', { createHTML: value => value });\nconst STICKY_INDEX_ATTR = 'data-sticky-line-index';\nconst STICKY_IS_LINE_ATTR = 'data-sticky-is-line';\nconst STICKY_IS_LINE_NUMBER_ATTR = 'data-sticky-is-line-number';\nconst STICKY_IS_FOLDING_ICON_ATTR = 'data-sticky-is-folding-icon';\nexport class StickyScrollWidget extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._foldingIconStore = new DisposableStore();\n        this._rootDomNode = document.createElement('div');\n        this._lineNumbersDomNode = document.createElement('div');\n        this._linesDomNodeScrollable = document.createElement('div');\n        this._linesDomNode = document.createElement('div');\n        this._lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        this._renderedStickyLines = [];\n        this._lineNumbers = [];\n        this._lastLineRelativePosition = 0;\n        this._minContentWidthInPx = 0;\n        this._isOnGlyphMargin = false;\n        this._lineNumbersDomNode.className = 'sticky-widget-line-numbers';\n        this._lineNumbersDomNode.setAttribute('role', 'none');\n        this._linesDomNode.className = 'sticky-widget-lines';\n        this._linesDomNode.setAttribute('role', 'list');\n        this._linesDomNodeScrollable.className = 'sticky-widget-lines-scrollable';\n        this._linesDomNodeScrollable.appendChild(this._linesDomNode);\n        this._rootDomNode.className = 'sticky-widget';\n        this._rootDomNode.classList.toggle('peek', _editor instanceof EmbeddedCodeEditorWidget);\n        this._rootDomNode.appendChild(this._lineNumbersDomNode);\n        this._rootDomNode.appendChild(this._linesDomNodeScrollable);\n        const updateScrollLeftPosition = () => {\n            this._linesDomNode.style.left = this._editor.getOption(115 /* EditorOption.stickyScroll */).scrollWithEditor ? `-${this._editor.getScrollLeft()}px` : '0px';\n        };\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(115 /* EditorOption.stickyScroll */)) {\n                updateScrollLeftPosition();\n            }\n            if (e.hasChanged(67 /* EditorOption.lineHeight */)) {\n                this._lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n            }\n        }));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollLeftChanged) {\n                updateScrollLeftPosition();\n            }\n            if (e.scrollWidthChanged) {\n                this._updateWidgetWidth();\n            }\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            updateScrollLeftPosition();\n            this._updateWidgetWidth();\n        }));\n        this._register(this._foldingIconStore);\n        updateScrollLeftPosition();\n        this._register(this._editor.onDidLayoutChange((e) => {\n            this._updateWidgetWidth();\n        }));\n        this._updateWidgetWidth();\n    }\n    get lineNumbers() {\n        return this._lineNumbers;\n    }\n    get lineNumberCount() {\n        return this._lineNumbers.length;\n    }\n    getRenderedStickyLine(lineNumber) {\n        return this._renderedStickyLines.find(stickyLine => stickyLine.lineNumber === lineNumber);\n    }\n    getCurrentLines() {\n        return this._lineNumbers;\n    }\n    setState(_state, foldingModel, _rebuildFromLine) {\n        if (_rebuildFromLine === undefined &&\n            ((!this._previousState && !_state) || (this._previousState && this._previousState.equals(_state)))) {\n            return;\n        }\n        const isWidgetHeightZero = this._isWidgetHeightZero(_state);\n        const state = isWidgetHeightZero ? undefined : _state;\n        const rebuildFromLine = isWidgetHeightZero ? 0 : this._findLineToRebuildWidgetFrom(_state, _rebuildFromLine);\n        this._renderRootNode(state, foldingModel, rebuildFromLine);\n        this._previousState = _state;\n    }\n    _isWidgetHeightZero(state) {\n        if (!state) {\n            return true;\n        }\n        const futureWidgetHeight = state.startLineNumbers.length * this._lineHeight + state.lastLineRelativePosition;\n        if (futureWidgetHeight > 0) {\n            this._lastLineRelativePosition = state.lastLineRelativePosition;\n            const lineNumbers = [...state.startLineNumbers];\n            if (state.showEndForLine !== null) {\n                lineNumbers[state.showEndForLine] = state.endLineNumbers[state.showEndForLine];\n            }\n            this._lineNumbers = lineNumbers;\n        }\n        else {\n            this._lastLineRelativePosition = 0;\n            this._lineNumbers = [];\n        }\n        return futureWidgetHeight === 0;\n    }\n    _findLineToRebuildWidgetFrom(state, _rebuildFromLine) {\n        if (!state || !this._previousState) {\n            return 0;\n        }\n        if (_rebuildFromLine !== undefined) {\n            return _rebuildFromLine;\n        }\n        const previousState = this._previousState;\n        const indexOfLinesAlreadyRendered = state.startLineNumbers.findIndex(startLineNumber => !previousState.startLineNumbers.includes(startLineNumber));\n        return (indexOfLinesAlreadyRendered === -1) ? 0 : indexOfLinesAlreadyRendered;\n    }\n    _updateWidgetWidth() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        this._lineNumbersDomNode.style.width = `${lineNumbersWidth}px`;\n        this._linesDomNodeScrollable.style.setProperty('--vscode-editorStickyScroll-scrollableWidth', `${this._editor.getScrollWidth() - layoutInfo.verticalScrollbarWidth}px`);\n        this._rootDomNode.style.width = `${layoutInfo.width - layoutInfo.verticalScrollbarWidth}px`;\n    }\n    _clearStickyLinesFromLine(clearFromLine) {\n        this._foldingIconStore.clear();\n        // Removing only the lines that need to be rerendered\n        for (let i = clearFromLine; i < this._renderedStickyLines.length; i++) {\n            const stickyLine = this._renderedStickyLines[i];\n            stickyLine.lineNumberDomNode.remove();\n            stickyLine.lineDomNode.remove();\n        }\n        // Keep the lines that need to be updated\n        this._renderedStickyLines = this._renderedStickyLines.slice(0, clearFromLine);\n        this._rootDomNode.style.display = 'none';\n    }\n    _useFoldingOpacityTransition(requireTransitions) {\n        this._lineNumbersDomNode.style.setProperty('--vscode-editorStickyScroll-foldingOpacityTransition', `opacity ${requireTransitions ? 0.5 : 0}s`);\n    }\n    _setFoldingIconsVisibility(allVisible) {\n        for (const line of this._renderedStickyLines) {\n            const foldingIcon = line.foldingIcon;\n            if (!foldingIcon) {\n                continue;\n            }\n            foldingIcon.setVisible(allVisible ? true : foldingIcon.isCollapsed);\n        }\n    }\n    async _renderRootNode(state, foldingModel, rebuildFromLine) {\n        this._clearStickyLinesFromLine(rebuildFromLine);\n        if (!state) {\n            return;\n        }\n        // For existing sticky lines update the top and z-index\n        for (const stickyLine of this._renderedStickyLines) {\n            this._updateTopAndZIndexOfStickyLine(stickyLine);\n        }\n        // For new sticky lines\n        const layoutInfo = this._editor.getLayoutInfo();\n        const linesToRender = this._lineNumbers.slice(rebuildFromLine);\n        for (const [index, line] of linesToRender.entries()) {\n            const stickyLine = this._renderChildNode(index + rebuildFromLine, line, foldingModel, layoutInfo);\n            if (!stickyLine) {\n                continue;\n            }\n            this._linesDomNode.appendChild(stickyLine.lineDomNode);\n            this._lineNumbersDomNode.appendChild(stickyLine.lineNumberDomNode);\n            this._renderedStickyLines.push(stickyLine);\n        }\n        if (foldingModel) {\n            this._setFoldingHoverListeners();\n            this._useFoldingOpacityTransition(!this._isOnGlyphMargin);\n        }\n        const widgetHeight = this._lineNumbers.length * this._lineHeight + this._lastLineRelativePosition;\n        this._rootDomNode.style.display = 'block';\n        this._lineNumbersDomNode.style.height = `${widgetHeight}px`;\n        this._linesDomNodeScrollable.style.height = `${widgetHeight}px`;\n        this._rootDomNode.style.height = `${widgetHeight}px`;\n        this._rootDomNode.style.marginLeft = '0px';\n        this._minContentWidthInPx = Math.max(...this._renderedStickyLines.map(l => l.scrollWidth)) + layoutInfo.verticalScrollbarWidth;\n        this._editor.layoutOverlayWidget(this);\n    }\n    _setFoldingHoverListeners() {\n        const showFoldingControls = this._editor.getOption(110 /* EditorOption.showFoldingControls */);\n        if (showFoldingControls !== 'mouseover') {\n            return;\n        }\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_ENTER, () => {\n            this._isOnGlyphMargin = true;\n            this._setFoldingIconsVisibility(true);\n        }));\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_LEAVE, () => {\n            this._isOnGlyphMargin = false;\n            this._useFoldingOpacityTransition(true);\n            this._setFoldingIconsVisibility(false);\n        }));\n    }\n    _renderChildNode(index, line, foldingModel, layoutInfo) {\n        const viewModel = this._editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        const viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n        const lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n        const lineNumberOption = this._editor.getOption(68 /* EditorOption.lineNumbers */);\n        let actualInlineDecorations;\n        try {\n            actualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n        }\n        catch (err) {\n            actualInlineDecorations = [];\n        }\n        const renderLineInput = new RenderLineInput(true, true, lineRenderingData.content, lineRenderingData.continuesWithWrappedLine, lineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0, lineRenderingData.tokens, actualInlineDecorations, lineRenderingData.tabSize, lineRenderingData.startVisibleColumn, 1, 1, 1, 500, 'none', true, true, null);\n        const sb = new StringBuilder(2000);\n        const renderOutput = renderViewLine(renderLineInput, sb);\n        let newLine;\n        if (_ttPolicy) {\n            newLine = _ttPolicy.createHTML(sb.build());\n        }\n        else {\n            newLine = sb.build();\n        }\n        const lineHTMLNode = document.createElement('span');\n        lineHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineHTMLNode.setAttribute(STICKY_IS_LINE_ATTR, '');\n        lineHTMLNode.setAttribute('role', 'listitem');\n        lineHTMLNode.tabIndex = 0;\n        lineHTMLNode.className = 'sticky-line-content';\n        lineHTMLNode.classList.add(`stickyLine${line}`);\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.innerHTML = newLine;\n        const lineNumberHTMLNode = document.createElement('span');\n        lineNumberHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineNumberHTMLNode.setAttribute(STICKY_IS_LINE_NUMBER_ATTR, '');\n        lineNumberHTMLNode.className = 'sticky-line-number';\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        lineNumberHTMLNode.style.width = `${lineNumbersWidth}px`;\n        const innerLineNumberHTML = document.createElement('span');\n        if (lineNumberOption.renderType === 1 /* RenderLineNumbersType.On */ || lineNumberOption.renderType === 3 /* RenderLineNumbersType.Interval */ && line % 10 === 0) {\n            innerLineNumberHTML.innerText = line.toString();\n        }\n        else if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            innerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition().lineNumber).toString();\n        }\n        innerLineNumberHTML.className = 'sticky-line-number-inner';\n        innerLineNumberHTML.style.lineHeight = `${this._lineHeight}px`;\n        innerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n        innerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n        lineNumberHTMLNode.appendChild(innerLineNumberHTML);\n        const foldingIcon = this._renderFoldingIconForLine(foldingModel, line);\n        if (foldingIcon) {\n            lineNumberHTMLNode.appendChild(foldingIcon.domNode);\n        }\n        this._editor.applyFontInfo(lineHTMLNode);\n        this._editor.applyFontInfo(innerLineNumberHTML);\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineNumberHTMLNode.style.height = `${this._lineHeight}px`;\n        lineHTMLNode.style.height = `${this._lineHeight}px`;\n        const renderedLine = new RenderedStickyLine(index, line, lineHTMLNode, lineNumberHTMLNode, foldingIcon, renderOutput.characterMapping, lineHTMLNode.scrollWidth);\n        return this._updateTopAndZIndexOfStickyLine(renderedLine);\n    }\n    _updateTopAndZIndexOfStickyLine(stickyLine) {\n        var _a;\n        const index = stickyLine.index;\n        const lineHTMLNode = stickyLine.lineDomNode;\n        const lineNumberHTMLNode = stickyLine.lineNumberDomNode;\n        const isLastLine = index === this._lineNumbers.length - 1;\n        const lastLineZIndex = '0';\n        const intermediateLineZIndex = '1';\n        lineHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        lineNumberHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        const lastLineTop = `${index * this._lineHeight + this._lastLineRelativePosition + (((_a = stickyLine.foldingIcon) === null || _a === void 0 ? void 0 : _a.isCollapsed) ? 1 : 0)}px`;\n        const intermediateLineTop = `${index * this._lineHeight}px`;\n        lineHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        lineNumberHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        return stickyLine;\n    }\n    _renderFoldingIconForLine(foldingModel, line) {\n        const showFoldingControls = this._editor.getOption(110 /* EditorOption.showFoldingControls */);\n        if (!foldingModel || showFoldingControls === 'never') {\n            return;\n        }\n        const foldingRegions = foldingModel.regions;\n        const indexOfFoldingRegion = foldingRegions.findRange(line);\n        const startLineNumber = foldingRegions.getStartLineNumber(indexOfFoldingRegion);\n        const isFoldingScope = line === startLineNumber;\n        if (!isFoldingScope) {\n            return;\n        }\n        const isCollapsed = foldingRegions.isCollapsed(indexOfFoldingRegion);\n        const foldingIcon = new StickyFoldingIcon(isCollapsed, startLineNumber, foldingRegions.getEndLineNumber(indexOfFoldingRegion), this._lineHeight);\n        foldingIcon.setVisible(this._isOnGlyphMargin ? true : (isCollapsed || showFoldingControls === 'always'));\n        foldingIcon.domNode.setAttribute(STICKY_IS_FOLDING_ICON_ATTR, '');\n        return foldingIcon;\n    }\n    getId() {\n        return 'editor.contrib.stickyScrollWidget';\n    }\n    getDomNode() {\n        return this._rootDomNode;\n    }\n    getPosition() {\n        return {\n            preference: null\n        };\n    }\n    getMinContentWidthInPx() {\n        return this._minContentWidthInPx;\n    }\n    focusLineWithIndex(index) {\n        if (0 <= index && index < this._renderedStickyLines.length) {\n            this._renderedStickyLines[index].lineDomNode.focus();\n        }\n    }\n    /**\n     * Given a leaf dom node, tries to find the editor position.\n     */\n    getEditorPositionFromNode(spanDomNode) {\n        if (!spanDomNode || spanDomNode.children.length > 0) {\n            // This is not a leaf node\n            return null;\n        }\n        const renderedStickyLine = this._getRenderedStickyLineFromChildDomNode(spanDomNode);\n        if (!renderedStickyLine) {\n            return null;\n        }\n        const column = getColumnOfNodeOffset(renderedStickyLine.characterMapping, spanDomNode, 0);\n        return new Position(renderedStickyLine.lineNumber, column);\n    }\n    getLineNumberFromChildDomNode(domNode) {\n        var _a, _b;\n        return (_b = (_a = this._getRenderedStickyLineFromChildDomNode(domNode)) === null || _a === void 0 ? void 0 : _a.lineNumber) !== null && _b !== void 0 ? _b : null;\n    }\n    _getRenderedStickyLineFromChildDomNode(domNode) {\n        const index = this.getLineIndexFromChildDomNode(domNode);\n        if (index === null || index < 0 || index >= this._renderedStickyLines.length) {\n            return null;\n        }\n        return this._renderedStickyLines[index];\n    }\n    /**\n     * Given a child dom node, tries to find the line number attribute that was stored in the node.\n     * @returns the attribute value or null if none is found.\n     */\n    getLineIndexFromChildDomNode(domNode) {\n        const lineIndex = this._getAttributeValue(domNode, STICKY_INDEX_ATTR);\n        return lineIndex ? parseInt(lineIndex, 10) : null;\n    }\n    /**\n     * Given a child dom node, tries to find if it is (contained in) a sticky line.\n     * @returns a boolean.\n     */\n    isInStickyLine(domNode) {\n        const isInLine = this._getAttributeValue(domNode, STICKY_IS_LINE_ATTR);\n        return isInLine !== undefined;\n    }\n    /**\n     * Given a child dom node, tries to find if this dom node is (contained in) a sticky folding icon.\n     * @returns a boolean.\n     */\n    isInFoldingIconDomNode(domNode) {\n        const isInFoldingIcon = this._getAttributeValue(domNode, STICKY_IS_FOLDING_ICON_ATTR);\n        return isInFoldingIcon !== undefined;\n    }\n    /**\n     * Given the dom node, finds if it or its parent sequence contains the given attribute.\n     * @returns the attribute value or undefined.\n     */\n    _getAttributeValue(domNode, attribute) {\n        while (domNode && domNode !== this._rootDomNode) {\n            const line = domNode.getAttribute(attribute);\n            if (line !== null) {\n                return line;\n            }\n            domNode = domNode.parentElement;\n        }\n        return;\n    }\n}\nclass RenderedStickyLine {\n    constructor(index, lineNumber, lineDomNode, lineNumberDomNode, foldingIcon, characterMapping, scrollWidth) {\n        this.index = index;\n        this.lineNumber = lineNumber;\n        this.lineDomNode = lineDomNode;\n        this.lineNumberDomNode = lineNumberDomNode;\n        this.foldingIcon = foldingIcon;\n        this.characterMapping = characterMapping;\n        this.scrollWidth = scrollWidth;\n    }\n}\nclass StickyFoldingIcon {\n    constructor(isCollapsed, foldingStartLine, foldingEndLine, dimension) {\n        this.isCollapsed = isCollapsed;\n        this.foldingStartLine = foldingStartLine;\n        this.foldingEndLine = foldingEndLine;\n        this.dimension = dimension;\n        this.domNode = document.createElement('div');\n        this.domNode.style.width = `${dimension}px`;\n        this.domNode.style.height = `${dimension}px`;\n        this.domNode.className = ThemeIcon.asClassName(isCollapsed ? foldingCollapsedIcon : foldingExpandedIcon);\n    }\n    setVisible(visible) {\n        this.domNode.style.cursor = visible ? 'pointer' : 'default';\n        this.domNode.style.opacity = visible ? '1' : '0';\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { StickyModelProvider } from './stickyScrollModelProvider.js';\nexport class StickyLineCandidate {\n    constructor(startLineNumber, endLineNumber, nestingDepth) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n        this.nestingDepth = nestingDepth;\n    }\n}\nlet StickyLineCandidateProvider = class StickyLineCandidateProvider extends Disposable {\n    constructor(editor, _languageFeaturesService, _languageConfigurationService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._onDidChangeStickyScroll = this._register(new Emitter());\n        this.onDidChangeStickyScroll = this._onDidChangeStickyScroll.event;\n        this._options = null;\n        this._model = null;\n        this._cts = null;\n        this._stickyModelProvider = null;\n        this._editor = editor;\n        this._sessionStore = this._register(new DisposableStore());\n        this._updateSoon = this._register(new RunOnceScheduler(() => this.update(), 50));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(115 /* EditorOption.stickyScroll */)) {\n                this.readConfiguration();\n            }\n        }));\n        this.readConfiguration();\n    }\n    readConfiguration() {\n        this._stickyModelProvider = null;\n        this._sessionStore.clear();\n        this._options = this._editor.getOption(115 /* EditorOption.stickyScroll */);\n        if (!this._options.enabled) {\n            return;\n        }\n        this._stickyModelProvider = this._sessionStore.add(new StickyModelProvider(this._editor, this._languageConfigurationService, this._languageFeaturesService, this._options.defaultModel));\n        this._sessionStore.add(this._editor.onDidChangeModel(() => {\n            // We should not show an old model for a different file, it will always be wrong.\n            // So we clear the model here immediately and then trigger an update.\n            this._model = null;\n            this._onDidChangeStickyScroll.fire();\n            this.update();\n        }));\n        this._sessionStore.add(this._editor.onDidChangeHiddenAreas(() => this.update()));\n        this._sessionStore.add(this._editor.onDidChangeModelContent(() => this._updateSoon.schedule()));\n        this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => this.update()));\n        this.update();\n    }\n    getVersionId() {\n        var _a;\n        return (_a = this._model) === null || _a === void 0 ? void 0 : _a.version;\n    }\n    async update() {\n        var _a;\n        (_a = this._cts) === null || _a === void 0 ? void 0 : _a.dispose(true);\n        this._cts = new CancellationTokenSource();\n        await this.updateStickyModel(this._cts.token);\n        this._onDidChangeStickyScroll.fire();\n    }\n    async updateStickyModel(token) {\n        if (!this._editor.hasModel() || !this._stickyModelProvider || this._editor.getModel().isTooLargeForTokenization()) {\n            this._model = null;\n            return;\n        }\n        const textModel = this._editor.getModel();\n        const modelVersionId = textModel.getVersionId();\n        const model = await this._stickyModelProvider.update(textModel, modelVersionId, token);\n        if (token.isCancellationRequested) {\n            // the computation was canceled, so do not overwrite the model\n            return;\n        }\n        this._model = model;\n    }\n    updateIndex(index) {\n        if (index === -1) {\n            index = 0;\n        }\n        else if (index < 0) {\n            index = -index - 2;\n        }\n        return index;\n    }\n    getCandidateStickyLinesIntersectingFromStickyModel(range, outlineModel, result, depth, lastStartLineNumber) {\n        if (outlineModel.children.length === 0) {\n            return;\n        }\n        let lastLine = lastStartLineNumber;\n        const childrenStartLines = [];\n        for (let i = 0; i < outlineModel.children.length; i++) {\n            const child = outlineModel.children[i];\n            if (child.range) {\n                childrenStartLines.push(child.range.startLineNumber);\n            }\n        }\n        const lowerBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber, (a, b) => { return a - b; }));\n        const upperBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber + depth, (a, b) => { return a - b; }));\n        for (let i = lowerBound; i <= upperBound; i++) {\n            const child = outlineModel.children[i];\n            if (!child) {\n                return;\n            }\n            if (child.range) {\n                const childStartLine = child.range.startLineNumber;\n                const childEndLine = child.range.endLineNumber;\n                if (range.startLineNumber <= childEndLine + 1 && childStartLine - 1 <= range.endLineNumber && childStartLine !== lastLine) {\n                    lastLine = childStartLine;\n                    result.push(new StickyLineCandidate(childStartLine, childEndLine - 1, depth + 1));\n                    this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth + 1, childStartLine);\n                }\n            }\n            else {\n                this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth, lastStartLineNumber);\n            }\n        }\n    }\n    getCandidateStickyLinesIntersecting(range) {\n        var _a, _b;\n        if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.element)) {\n            return [];\n        }\n        let stickyLineCandidates = [];\n        this.getCandidateStickyLinesIntersectingFromStickyModel(range, this._model.element, stickyLineCandidates, 0, -1);\n        const hiddenRanges = (_b = this._editor._getViewModel()) === null || _b === void 0 ? void 0 : _b.getHiddenAreas();\n        if (hiddenRanges) {\n            for (const hiddenRange of hiddenRanges) {\n                stickyLineCandidates = stickyLineCandidates.filter(stickyLine => !(stickyLine.startLineNumber >= hiddenRange.startLineNumber && stickyLine.endLineNumber <= hiddenRange.endLineNumber + 1));\n            }\n        }\n        return stickyLineCandidates;\n    }\n};\nStickyLineCandidateProvider = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageConfigurationService)\n], StickyLineCandidateProvider);\nexport { StickyLineCandidateProvider };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { OutlineElement, OutlineGroup, OutlineModel } from '../../documentSymbols/browser/outlineModel.js';\nimport { createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { FoldingController, RangesLimitReporter } from '../../folding/browser/folding.js';\nimport { SyntaxRangeProvider } from '../../folding/browser/syntaxRangeProvider.js';\nimport { IndentRangeProvider } from '../../folding/browser/indentRangeProvider.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nvar ModelProvider;\n(function (ModelProvider) {\n    ModelProvider[\"OUTLINE_MODEL\"] = \"outlineModel\";\n    ModelProvider[\"FOLDING_PROVIDER_MODEL\"] = \"foldingProviderModel\";\n    ModelProvider[\"INDENTATION_MODEL\"] = \"indentationModel\";\n})(ModelProvider || (ModelProvider = {}));\nvar Status;\n(function (Status) {\n    Status[Status[\"VALID\"] = 0] = \"VALID\";\n    Status[Status[\"INVALID\"] = 1] = \"INVALID\";\n    Status[Status[\"CANCELED\"] = 2] = \"CANCELED\";\n})(Status || (Status = {}));\nlet StickyModelProvider = class StickyModelProvider extends Disposable {\n    constructor(_editor, _languageConfigurationService, _languageFeaturesService, defaultModel) {\n        super();\n        this._editor = _editor;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._modelProviders = [];\n        this._modelPromise = null;\n        this._updateScheduler = this._register(new Delayer(300));\n        this._updateOperation = this._register(new DisposableStore());\n        const stickyModelFromCandidateOutlineProvider = new StickyModelFromCandidateOutlineProvider(_languageFeaturesService);\n        const stickyModelFromSyntaxFoldingProvider = new StickyModelFromCandidateSyntaxFoldingProvider(this._editor, _languageFeaturesService);\n        const stickyModelFromIndentationFoldingProvider = new StickyModelFromCandidateIndentationFoldingProvider(this._editor, _languageConfigurationService);\n        switch (defaultModel) {\n            case ModelProvider.OUTLINE_MODEL:\n                this._modelProviders.push(stickyModelFromCandidateOutlineProvider);\n                this._modelProviders.push(stickyModelFromSyntaxFoldingProvider);\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n            case ModelProvider.FOLDING_PROVIDER_MODEL:\n                this._modelProviders.push(stickyModelFromSyntaxFoldingProvider);\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n            case ModelProvider.INDENTATION_MODEL:\n                this._modelProviders.push(stickyModelFromIndentationFoldingProvider);\n                break;\n        }\n    }\n    _cancelModelPromise() {\n        if (this._modelPromise) {\n            this._modelPromise.cancel();\n            this._modelPromise = null;\n        }\n    }\n    async update(textModel, textModelVersionId, token) {\n        this._updateOperation.clear();\n        this._updateOperation.add({\n            dispose: () => {\n                this._cancelModelPromise();\n                this._updateScheduler.cancel();\n            }\n        });\n        this._cancelModelPromise();\n        return await this._updateScheduler.trigger(async () => {\n            for (const modelProvider of this._modelProviders) {\n                const { statusPromise, modelPromise } = modelProvider.computeStickyModel(textModel, textModelVersionId, token);\n                this._modelPromise = modelPromise;\n                const status = await statusPromise;\n                if (this._modelPromise !== modelPromise) {\n                    return null;\n                }\n                switch (status) {\n                    case Status.CANCELED:\n                        this._updateOperation.clear();\n                        return null;\n                    case Status.VALID:\n                        return modelProvider.stickyModel;\n                }\n            }\n            return null;\n        }).catch((error) => {\n            onUnexpectedError(error);\n            return null;\n        });\n    }\n};\nStickyModelProvider = __decorate([\n    __param(1, ILanguageConfigurationService),\n    __param(2, ILanguageFeaturesService)\n], StickyModelProvider);\nexport { StickyModelProvider };\nclass StickyModelCandidateProvider {\n    constructor() {\n        this._stickyModel = null;\n    }\n    get stickyModel() {\n        return this._stickyModel;\n    }\n    _invalid() {\n        this._stickyModel = null;\n        return Status.INVALID;\n    }\n    computeStickyModel(textModel, modelVersionId, token) {\n        if (token.isCancellationRequested || !this.isProviderValid(textModel)) {\n            return { statusPromise: this._invalid(), modelPromise: null };\n        }\n        const providerModelPromise = createCancelablePromise(token => this.createModelFromProvider(textModel, modelVersionId, token));\n        return {\n            statusPromise: providerModelPromise.then(providerModel => {\n                if (!this.isModelValid(providerModel)) {\n                    return this._invalid();\n                }\n                if (token.isCancellationRequested) {\n                    return Status.CANCELED;\n                }\n                this._stickyModel = this.createStickyModel(textModel, modelVersionId, token, providerModel);\n                return Status.VALID;\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return Status.CANCELED;\n            }),\n            modelPromise: providerModelPromise\n        };\n    }\n    /**\n     * Method which checks whether the model returned by the provider is valid and can be used to compute a sticky model.\n     * This method by default returns true.\n     * @param model model returned by the provider\n     * @returns boolean indicating whether the model is valid\n     */\n    isModelValid(model) {\n        return true;\n    }\n    /**\n     * Method which checks whether the provider is valid before applying it to find the provider model.\n     * This method by default returns true.\n     * @param textModel text-model of the editor\n     * @returns boolean indicating whether the provider is valid\n     */\n    isProviderValid(textModel) {\n        return true;\n    }\n}\nlet StickyModelFromCandidateOutlineProvider = class StickyModelFromCandidateOutlineProvider extends StickyModelCandidateProvider {\n    constructor(_languageFeaturesService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        return OutlineModel.create(this._languageFeaturesService.documentSymbolProvider, textModel, token);\n    }\n    createStickyModel(textModel, modelVersionId, token, model) {\n        var _a;\n        const { stickyOutlineElement, providerID } = this._stickyModelFromOutlineModel(model, (_a = this._stickyModel) === null || _a === void 0 ? void 0 : _a.outlineProviderId);\n        return new StickyModel(textModel.uri, modelVersionId, stickyOutlineElement, providerID);\n    }\n    isModelValid(model) {\n        return model && model.children.size > 0;\n    }\n    _stickyModelFromOutlineModel(outlineModel, preferredProvider) {\n        let outlineElements;\n        // When several possible outline providers\n        if (Iterable.first(outlineModel.children.values()) instanceof OutlineGroup) {\n            const provider = Iterable.find(outlineModel.children.values(), outlineGroupOfModel => outlineGroupOfModel.id === preferredProvider);\n            if (provider) {\n                outlineElements = provider.children;\n            }\n            else {\n                let tempID = '';\n                let maxTotalSumOfRanges = -1;\n                let optimalOutlineGroup = undefined;\n                for (const [_key, outlineGroup] of outlineModel.children.entries()) {\n                    const totalSumRanges = this._findSumOfRangesOfGroup(outlineGroup);\n                    if (totalSumRanges > maxTotalSumOfRanges) {\n                        optimalOutlineGroup = outlineGroup;\n                        maxTotalSumOfRanges = totalSumRanges;\n                        tempID = outlineGroup.id;\n                    }\n                }\n                preferredProvider = tempID;\n                outlineElements = optimalOutlineGroup.children;\n            }\n        }\n        else {\n            outlineElements = outlineModel.children;\n        }\n        const stickyChildren = [];\n        const outlineElementsArray = Array.from(outlineElements.values()).sort((element1, element2) => {\n            const range1 = new StickyRange(element1.symbol.range.startLineNumber, element1.symbol.range.endLineNumber);\n            const range2 = new StickyRange(element2.symbol.range.startLineNumber, element2.symbol.range.endLineNumber);\n            return this._comparator(range1, range2);\n        });\n        for (const outlineElement of outlineElementsArray) {\n            stickyChildren.push(this._stickyModelFromOutlineElement(outlineElement, outlineElement.symbol.selectionRange.startLineNumber));\n        }\n        const stickyOutlineElement = new StickyElement(undefined, stickyChildren, undefined);\n        return {\n            stickyOutlineElement: stickyOutlineElement,\n            providerID: preferredProvider\n        };\n    }\n    _stickyModelFromOutlineElement(outlineElement, previousStartLine) {\n        const children = [];\n        for (const child of outlineElement.children.values()) {\n            if (child.symbol.selectionRange.startLineNumber !== child.symbol.range.endLineNumber) {\n                if (child.symbol.selectionRange.startLineNumber !== previousStartLine) {\n                    children.push(this._stickyModelFromOutlineElement(child, child.symbol.selectionRange.startLineNumber));\n                }\n                else {\n                    for (const subchild of child.children.values()) {\n                        children.push(this._stickyModelFromOutlineElement(subchild, child.symbol.selectionRange.startLineNumber));\n                    }\n                }\n            }\n        }\n        children.sort((child1, child2) => this._comparator(child1.range, child2.range));\n        const range = new StickyRange(outlineElement.symbol.selectionRange.startLineNumber, outlineElement.symbol.range.endLineNumber);\n        return new StickyElement(range, children, undefined);\n    }\n    _comparator(range1, range2) {\n        if (range1.startLineNumber !== range2.startLineNumber) {\n            return range1.startLineNumber - range2.startLineNumber;\n        }\n        else {\n            return range2.endLineNumber - range1.endLineNumber;\n        }\n    }\n    _findSumOfRangesOfGroup(outline) {\n        let res = 0;\n        for (const child of outline.children.values()) {\n            res += this._findSumOfRangesOfGroup(child);\n        }\n        if (outline instanceof OutlineElement) {\n            return res + outline.symbol.range.endLineNumber - outline.symbol.selectionRange.startLineNumber;\n        }\n        else {\n            return res;\n        }\n    }\n};\nStickyModelFromCandidateOutlineProvider = __decorate([\n    __param(0, ILanguageFeaturesService)\n], StickyModelFromCandidateOutlineProvider);\nclass StickyModelFromCandidateFoldingProvider extends StickyModelCandidateProvider {\n    constructor(editor) {\n        super();\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n    }\n    createStickyModel(textModel, modelVersionId, token, model) {\n        const foldingElement = this._fromFoldingRegions(model);\n        return new StickyModel(textModel.uri, modelVersionId, foldingElement, undefined);\n    }\n    isModelValid(model) {\n        return model !== null;\n    }\n    _fromFoldingRegions(foldingRegions) {\n        const length = foldingRegions.length;\n        const orderedStickyElements = [];\n        // The root sticky outline element\n        const stickyOutlineElement = new StickyElement(undefined, [], undefined);\n        for (let i = 0; i < length; i++) {\n            // Finding the parent index of the current range\n            const parentIndex = foldingRegions.getParentIndex(i);\n            let parentNode;\n            if (parentIndex !== -1) {\n                // Access the reference of the parent node\n                parentNode = orderedStickyElements[parentIndex];\n            }\n            else {\n                // In that case the parent node is the root node\n                parentNode = stickyOutlineElement;\n            }\n            const child = new StickyElement(new StickyRange(foldingRegions.getStartLineNumber(i), foldingRegions.getEndLineNumber(i) + 1), [], parentNode);\n            parentNode.children.push(child);\n            orderedStickyElements.push(child);\n        }\n        return stickyOutlineElement;\n    }\n}\nlet StickyModelFromCandidateIndentationFoldingProvider = class StickyModelFromCandidateIndentationFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, _languageConfigurationService) {\n        super(editor);\n        this._languageConfigurationService = _languageConfigurationService;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        const provider = new IndentRangeProvider(textModel, this._languageConfigurationService, this._foldingLimitReporter);\n        return provider.compute(token);\n    }\n};\nStickyModelFromCandidateIndentationFoldingProvider = __decorate([\n    __param(1, ILanguageConfigurationService)\n], StickyModelFromCandidateIndentationFoldingProvider);\nlet StickyModelFromCandidateSyntaxFoldingProvider = class StickyModelFromCandidateSyntaxFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, _languageFeaturesService) {\n        super(editor);\n        this._languageFeaturesService = _languageFeaturesService;\n    }\n    isProviderValid(textModel) {\n        const selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, textModel);\n        return selectedProviders.length > 0;\n    }\n    createModelFromProvider(textModel, modelVersionId, token) {\n        const selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, textModel);\n        const provider = new SyntaxRangeProvider(textModel, selectedProviders, () => this.createModelFromProvider(textModel, modelVersionId, token), this._foldingLimitReporter, undefined);\n        return provider.compute(token);\n    }\n};\nStickyModelFromCandidateSyntaxFoldingProvider = __decorate([\n    __param(1, ILanguageFeaturesService)\n], StickyModelFromCandidateSyntaxFoldingProvider);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class StickyRange {\n    constructor(startLineNumber, endLineNumber) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n    }\n}\nexport class StickyElement {\n    constructor(\n    /**\n     * Range of line numbers spanned by the current scope\n     */\n    range, \n    /**\n     * Must be sorted by start line number\n    */\n    children, \n    /**\n     * Parent sticky outline element\n     */\n    parent) {\n        this.range = range;\n        this.children = children;\n        this.parent = parent;\n    }\n}\nexport class StickyModel {\n    constructor(uri, version, element, outlineProviderId) {\n        this.uri = uri;\n        this.version = version;\n        this.element = element;\n        this.outlineProviderId = outlineProviderId;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { Disposable, RefCountedDisposable } from '../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CompletionModel, LineContext } from './completionModel.js';\nimport { CompletionOptions, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { SuggestModel } from './suggestModel.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nclass SuggestInlineCompletion {\n    constructor(range, insertText, filterText, additionalTextEdits, command, completion) {\n        this.range = range;\n        this.insertText = insertText;\n        this.filterText = filterText;\n        this.additionalTextEdits = additionalTextEdits;\n        this.command = command;\n        this.completion = completion;\n    }\n}\nlet InlineCompletionResults = class InlineCompletionResults extends RefCountedDisposable {\n    constructor(model, line, word, completionModel, completions, _suggestMemoryService) {\n        super(completions.disposable);\n        this.model = model;\n        this.line = line;\n        this.word = word;\n        this.completionModel = completionModel;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    canBeReused(model, line, word) {\n        return this.model === model // same model\n            && this.line === line\n            && this.word.word.length > 0\n            && this.word.startColumn === word.startColumn && this.word.endColumn < word.endColumn // same word\n            && this.completionModel.getIncompleteProvider().size === 0; // no incomplete results\n    }\n    get items() {\n        var _a;\n        const result = [];\n        // Split items by preselected index. This ensures the memory-selected item shows first and that better/worst\n        // ranked items are before/after\n        const { items } = this.completionModel;\n        const selectedIndex = this._suggestMemoryService.select(this.model, { lineNumber: this.line, column: this.word.endColumn + this.completionModel.lineContext.characterCountDelta }, items);\n        const first = Iterable.slice(items, selectedIndex);\n        const second = Iterable.slice(items, 0, selectedIndex);\n        let resolveCount = 5;\n        for (const item of Iterable.concat(first, second)) {\n            if (item.score === FuzzyScore.Default) {\n                // skip items that have no overlap\n                continue;\n            }\n            const range = new Range(item.editStart.lineNumber, item.editStart.column, item.editInsertEnd.lineNumber, item.editInsertEnd.column + this.completionModel.lineContext.characterCountDelta // end PLUS character delta\n            );\n            const insertText = item.completion.insertTextRules && (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                ? { snippet: item.completion.insertText }\n                : item.completion.insertText;\n            result.push(new SuggestInlineCompletion(range, insertText, (_a = item.filterTextLow) !== null && _a !== void 0 ? _a : item.labelLow, item.completion.additionalTextEdits, item.completion.command, item));\n            // resolve the first N suggestions eagerly\n            if (resolveCount-- >= 0) {\n                item.resolve(CancellationToken.None);\n            }\n        }\n        return result;\n    }\n};\nInlineCompletionResults = __decorate([\n    __param(5, ISuggestMemoryService)\n], InlineCompletionResults);\nlet SuggestInlineCompletions = class SuggestInlineCompletions extends Disposable {\n    constructor(_languageFeatureService, _clipboardService, _suggestMemoryService, _editorService) {\n        super();\n        this._languageFeatureService = _languageFeatureService;\n        this._clipboardService = _clipboardService;\n        this._suggestMemoryService = _suggestMemoryService;\n        this._editorService = _editorService;\n        this._store.add(_languageFeatureService.inlineCompletionsProvider.register('*', this));\n    }\n    async provideInlineCompletions(model, position, context, token) {\n        var _a;\n        if (context.selectedSuggestionInfo) {\n            return;\n        }\n        let editor;\n        for (const candidate of this._editorService.listCodeEditors()) {\n            if (candidate.getModel() === model) {\n                editor = candidate;\n                break;\n            }\n        }\n        if (!editor) {\n            return;\n        }\n        const config = editor.getOption(89 /* EditorOption.quickSuggestions */);\n        if (QuickSuggestionsOptions.isAllOff(config)) {\n            // quick suggest is off (for this model/language)\n            return;\n        }\n        model.tokenization.tokenizeIfCheap(position.lineNumber);\n        const lineTokens = model.tokenization.getLineTokens(position.lineNumber);\n        const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(position.column - 1 - 1, 0)));\n        if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'inline') {\n            // quick suggest is off (for this token)\n            return undefined;\n        }\n        // We consider non-empty leading words and trigger characters. The latter only\n        // when no word is being typed (word characters superseed trigger characters)\n        let wordInfo = model.getWordAtPosition(position);\n        let triggerCharacterInfo;\n        if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word)) {\n            triggerCharacterInfo = this._getTriggerCharacterInfo(model, position);\n        }\n        if (!(wordInfo === null || wordInfo === void 0 ? void 0 : wordInfo.word) && !triggerCharacterInfo) {\n            // not at word, not a trigger character\n            return;\n        }\n        // ensure that we have word information and that we are at the end of a word\n        // otherwise we stop because we don't want to do quick suggestions inside words\n        if (!wordInfo) {\n            wordInfo = model.getWordUntilPosition(position);\n        }\n        if (wordInfo.endColumn !== position.column) {\n            return;\n        }\n        let result;\n        const leadingLineContents = model.getValueInRange(new Range(position.lineNumber, 1, position.lineNumber, position.column));\n        if (!triggerCharacterInfo && ((_a = this._lastResult) === null || _a === void 0 ? void 0 : _a.canBeReused(model, position.lineNumber, wordInfo))) {\n            // reuse a previous result iff possible, only a refilter is needed\n            // TODO@jrieken this can be improved further and only incomplete results can be updated\n            // console.log(`REUSE with ${wordInfo.word}`);\n            const newLineContext = new LineContext(leadingLineContents, position.column - this._lastResult.word.endColumn);\n            this._lastResult.completionModel.lineContext = newLineContext;\n            this._lastResult.acquire();\n            result = this._lastResult;\n        }\n        else {\n            // refesh model is required\n            const completions = await provideSuggestionItems(this._languageFeatureService.completionProvider, model, position, new CompletionOptions(undefined, SuggestModel.createSuggestFilter(editor).itemKind, triggerCharacterInfo === null || triggerCharacterInfo === void 0 ? void 0 : triggerCharacterInfo.providers), triggerCharacterInfo && { triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */, triggerCharacter: triggerCharacterInfo.ch }, token);\n            let clipboardText;\n            if (completions.needsClipboard) {\n                clipboardText = await this._clipboardService.readText();\n            }\n            const completionModel = new CompletionModel(completions.items, position.column, new LineContext(leadingLineContents, 0), WordDistance.None, editor.getOption(118 /* EditorOption.suggest */), editor.getOption(112 /* EditorOption.snippetSuggestions */), { boostFullMatch: false, firstMatchCanBeWeak: false }, clipboardText);\n            result = new InlineCompletionResults(model, position.lineNumber, wordInfo, completionModel, completions, this._suggestMemoryService);\n        }\n        this._lastResult = result;\n        return result;\n    }\n    handleItemDidShow(_completions, item) {\n        item.completion.resolve(CancellationToken.None);\n    }\n    freeInlineCompletions(result) {\n        result.release();\n    }\n    _getTriggerCharacterInfo(model, position) {\n        var _a;\n        const ch = model.getValueInRange(Range.fromPositions({ lineNumber: position.lineNumber, column: position.column - 1 }, position));\n        const providers = new Set();\n        for (const provider of this._languageFeatureService.completionProvider.all(model)) {\n            if ((_a = provider.triggerCharacters) === null || _a === void 0 ? void 0 : _a.includes(ch)) {\n                providers.add(provider);\n            }\n        }\n        if (providers.size === 0) {\n            return undefined;\n        }\n        return { providers, ch };\n    }\n};\nSuggestInlineCompletions = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IClipboardService),\n    __param(2, ISuggestMemoryService),\n    __param(3, ICodeEditorService)\n], SuggestInlineCompletions);\nexport { SuggestInlineCompletions };\nregisterEditorFeature(SuggestInlineCompletions);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport * as nls from '../../../../nls.js';\nclass ForceRetokenizeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.forceRetokenize',\n            label: nls.localize('forceRetokenize', \"Developer: Force Retokenize\"),\n            alias: 'Developer: Force Retokenize',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        model.tokenization.resetTokenization();\n        const sw = new StopWatch();\n        model.tokenization.forceTokenization(model.getLineCount());\n        sw.stop();\n        console.log(`tokenization took ${sw.elapsed()}`);\n    }\n}\nregisterEditorAction(ForceRetokenizeAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { TabFocus } from '../../../browser/config/tabFocus.js';\nimport * as nls from '../../../../nls.js';\nimport { Action2, registerAction2 } from '../../../../platform/actions/common/actions.js';\nexport class ToggleTabFocusModeAction extends Action2 {\n    constructor() {\n        super({\n            id: ToggleTabFocusModeAction.ID,\n            title: nls.localize2({ key: 'toggle.tabMovesFocus', comment: ['Turn on/off use of tab key for moving focus around VS Code'] }, 'Toggle Tab Key Moves Focus'),\n            precondition: undefined,\n            keybinding: {\n                primary: 2048 /* KeyMod.CtrlCmd */ | 43 /* KeyCode.KeyM */,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 43 /* KeyCode.KeyM */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            f1: true\n        });\n    }\n    run() {\n        const oldValue = TabFocus.getTabFocusMode();\n        const newValue = !oldValue;\n        TabFocus.setTabFocusMode(newValue);\n        if (newValue) {\n            alert(nls.localize('toggle.tabMovesFocus.on', \"Pressing Tab will now move focus to the next focusable element\"));\n        }\n        else {\n            alert(nls.localize('toggle.tabMovesFocus.off', \"Pressing Tab will now insert the tab character\"));\n        }\n    }\n}\nToggleTabFocusModeAction.ID = 'editor.action.toggleTabFocusMode';\nregisterAction2(ToggleTabFocusModeAction);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { InvisibleCharacters, isBasicASCII } from '../../../../base/common/strings.js';\nimport './unicodeHighlighter.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { inUntrustedWorkspace, unicodeHighlightConfigKeys } from '../../../common/config/editorOptions.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { UnicodeTextModelHighlighter } from '../../../common/services/unicodeTextModelHighlighter.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { isModelDecorationInComment, isModelDecorationInString, isModelDecorationVisible } from '../../../common/viewModel/viewModelDecorations.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { MarkdownHover, renderMarkdownHovers } from '../../hover/browser/markdownHoverParticipant.js';\nimport { BannerController } from './bannerController.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IWorkspaceTrustManagementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nexport const warningIcon = registerIcon('extensions-warning-message', Codicon.warning, nls.localize('warningIcon', 'Icon shown with a warning message in the extensions editor.'));\nlet UnicodeHighlighter = class UnicodeHighlighter extends Disposable {\n    constructor(_editor, _editorWorkerService, _workspaceTrustService, instantiationService) {\n        super();\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._workspaceTrustService = _workspaceTrustService;\n        this._highlighter = null;\n        this._bannerClosed = false;\n        this._updateState = (state) => {\n            if (state && state.hasMore) {\n                if (this._bannerClosed) {\n                    return;\n                }\n                // This document contains many non-basic ASCII characters.\n                const max = Math.max(state.ambiguousCharacterCount, state.nonBasicAsciiCharacterCount, state.invisibleCharacterCount);\n                let data;\n                if (state.nonBasicAsciiCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters', 'This document contains many non-basic ASCII unicode characters'),\n                        command: new DisableHighlightingOfNonBasicAsciiCharactersAction(),\n                    };\n                }\n                else if (state.ambiguousCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters', 'This document contains many ambiguous unicode characters'),\n                        command: new DisableHighlightingOfAmbiguousCharactersAction(),\n                    };\n                }\n                else if (state.invisibleCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters', 'This document contains many invisible unicode characters'),\n                        command: new DisableHighlightingOfInvisibleCharactersAction(),\n                    };\n                }\n                else {\n                    throw new Error('Unreachable');\n                }\n                this._bannerController.show({\n                    id: 'unicodeHighlightBanner',\n                    message: data.message,\n                    icon: warningIcon,\n                    actions: [\n                        {\n                            label: data.command.shortLabel,\n                            href: `command:${data.command.id}`\n                        }\n                    ],\n                    onClose: () => {\n                        this._bannerClosed = true;\n                    },\n                });\n            }\n            else {\n                this._bannerController.hide();\n            }\n        };\n        this._bannerController = this._register(instantiationService.createInstance(BannerController, _editor));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._bannerClosed = false;\n            this._updateHighlighter();\n        }));\n        this._options = _editor.getOption(125 /* EditorOption.unicodeHighlighting */);\n        this._register(_workspaceTrustService.onDidChangeTrust(e => {\n            this._updateHighlighter();\n        }));\n        this._register(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(125 /* EditorOption.unicodeHighlighting */)) {\n                this._options = _editor.getOption(125 /* EditorOption.unicodeHighlighting */);\n                this._updateHighlighter();\n            }\n        }));\n        this._updateHighlighter();\n    }\n    dispose() {\n        if (this._highlighter) {\n            this._highlighter.dispose();\n            this._highlighter = null;\n        }\n        super.dispose();\n    }\n    _updateHighlighter() {\n        this._updateState(null);\n        if (this._highlighter) {\n            this._highlighter.dispose();\n            this._highlighter = null;\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const options = resolveOptions(this._workspaceTrustService.isWorkspaceTrusted(), this._options);\n        if ([\n            options.nonBasicASCII,\n            options.ambiguousCharacters,\n            options.invisibleCharacters,\n        ].every((option) => option === false)) {\n            // Don't do anything if the feature is fully disabled\n            return;\n        }\n        const highlightOptions = {\n            nonBasicASCII: options.nonBasicASCII,\n            ambiguousCharacters: options.ambiguousCharacters,\n            invisibleCharacters: options.invisibleCharacters,\n            includeComments: options.includeComments,\n            includeStrings: options.includeStrings,\n            allowedCodePoints: Object.keys(options.allowedCharacters).map(c => c.codePointAt(0)),\n            allowedLocales: Object.keys(options.allowedLocales).map(locale => {\n                if (locale === '_os') {\n                    const osLocale = new Intl.NumberFormat().resolvedOptions().locale;\n                    return osLocale;\n                }\n                else if (locale === '_vscode') {\n                    return platform.language;\n                }\n                return locale;\n            }),\n        };\n        if (this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)) {\n            this._highlighter = new DocumentUnicodeHighlighter(this._editor, highlightOptions, this._updateState, this._editorWorkerService);\n        }\n        else {\n            this._highlighter = new ViewportUnicodeHighlighter(this._editor, highlightOptions, this._updateState);\n        }\n    }\n    getDecorationInfo(decoration) {\n        if (this._highlighter) {\n            return this._highlighter.getDecorationInfo(decoration);\n        }\n        return null;\n    }\n};\nUnicodeHighlighter.ID = 'editor.contrib.unicodeHighlighter';\nUnicodeHighlighter = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IWorkspaceTrustManagementService),\n    __param(3, IInstantiationService)\n], UnicodeHighlighter);\nexport { UnicodeHighlighter };\nfunction resolveOptions(trusted, options) {\n    return {\n        nonBasicASCII: options.nonBasicASCII === inUntrustedWorkspace ? !trusted : options.nonBasicASCII,\n        ambiguousCharacters: options.ambiguousCharacters,\n        invisibleCharacters: options.invisibleCharacters,\n        includeComments: options.includeComments === inUntrustedWorkspace ? !trusted : options.includeComments,\n        includeStrings: options.includeStrings === inUntrustedWorkspace ? !trusted : options.includeStrings,\n        allowedCharacters: options.allowedCharacters,\n        allowedLocales: options.allowedLocales,\n    };\n}\nlet DocumentUnicodeHighlighter = class DocumentUnicodeHighlighter extends Disposable {\n    constructor(_editor, _options, _updateState, _editorWorkerService) {\n        super();\n        this._editor = _editor;\n        this._options = _options;\n        this._updateState = _updateState;\n        this._editorWorkerService = _editorWorkerService;\n        this._model = this._editor.getModel();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateSoon = this._register(new RunOnceScheduler(() => this._update(), 250));\n        this._register(this._editor.onDidChangeModelContent(() => {\n            this._updateSoon.schedule();\n        }));\n        this._updateSoon.schedule();\n    }\n    dispose() {\n        this._decorations.clear();\n        super.dispose();\n    }\n    _update() {\n        if (this._model.isDisposed()) {\n            return;\n        }\n        if (!this._model.mightContainNonBasicASCII()) {\n            this._decorations.clear();\n            return;\n        }\n        const modelVersionId = this._model.getVersionId();\n        this._editorWorkerService\n            .computedUnicodeHighlights(this._model.uri, this._options)\n            .then((info) => {\n            if (this._model.isDisposed()) {\n                return;\n            }\n            if (this._model.getVersionId() !== modelVersionId) {\n                // model changed in the meantime\n                return;\n            }\n            this._updateState(info);\n            const decorations = [];\n            if (!info.hasMore) {\n                // Don't show decoration if there are too many.\n                // In this case, a banner is shown.\n                for (const range of info.ranges) {\n                    decorations.push({\n                        range: range,\n                        options: Decorations.instance.getDecorationFromOptions(this._options),\n                    });\n                }\n            }\n            this._decorations.set(decorations);\n        });\n    }\n    getDecorationInfo(decoration) {\n        if (!this._decorations.has(decoration)) {\n            return null;\n        }\n        const model = this._editor.getModel();\n        if (!isModelDecorationVisible(model, decoration)) {\n            return null;\n        }\n        const text = model.getValueInRange(decoration.range);\n        return {\n            reason: computeReason(text, this._options),\n            inComment: isModelDecorationInComment(model, decoration),\n            inString: isModelDecorationInString(model, decoration),\n        };\n    }\n};\nDocumentUnicodeHighlighter = __decorate([\n    __param(3, IEditorWorkerService)\n], DocumentUnicodeHighlighter);\nclass ViewportUnicodeHighlighter extends Disposable {\n    constructor(_editor, _options, _updateState) {\n        super();\n        this._editor = _editor;\n        this._options = _options;\n        this._updateState = _updateState;\n        this._model = this._editor.getModel();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateSoon = this._register(new RunOnceScheduler(() => this._update(), 250));\n        this._register(this._editor.onDidLayoutChange(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidScrollChange(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidChangeHiddenAreas(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidChangeModelContent(() => {\n            this._updateSoon.schedule();\n        }));\n        this._updateSoon.schedule();\n    }\n    dispose() {\n        this._decorations.clear();\n        super.dispose();\n    }\n    _update() {\n        if (this._model.isDisposed()) {\n            return;\n        }\n        if (!this._model.mightContainNonBasicASCII()) {\n            this._decorations.clear();\n            return;\n        }\n        const ranges = this._editor.getVisibleRanges();\n        const decorations = [];\n        const totalResult = {\n            ranges: [],\n            ambiguousCharacterCount: 0,\n            invisibleCharacterCount: 0,\n            nonBasicAsciiCharacterCount: 0,\n            hasMore: false,\n        };\n        for (const range of ranges) {\n            const result = UnicodeTextModelHighlighter.computeUnicodeHighlights(this._model, this._options, range);\n            for (const r of result.ranges) {\n                totalResult.ranges.push(r);\n            }\n            totalResult.ambiguousCharacterCount += totalResult.ambiguousCharacterCount;\n            totalResult.invisibleCharacterCount += totalResult.invisibleCharacterCount;\n            totalResult.nonBasicAsciiCharacterCount += totalResult.nonBasicAsciiCharacterCount;\n            totalResult.hasMore = totalResult.hasMore || result.hasMore;\n        }\n        if (!totalResult.hasMore) {\n            // Don't show decorations if there are too many.\n            // A banner will be shown instead.\n            for (const range of totalResult.ranges) {\n                decorations.push({ range, options: Decorations.instance.getDecorationFromOptions(this._options) });\n            }\n        }\n        this._updateState(totalResult);\n        this._decorations.set(decorations);\n    }\n    getDecorationInfo(decoration) {\n        if (!this._decorations.has(decoration)) {\n            return null;\n        }\n        const model = this._editor.getModel();\n        const text = model.getValueInRange(decoration.range);\n        if (!isModelDecorationVisible(model, decoration)) {\n            return null;\n        }\n        return {\n            reason: computeReason(text, this._options),\n            inComment: isModelDecorationInComment(model, decoration),\n            inString: isModelDecorationInString(model, decoration),\n        };\n    }\n}\nconst configureUnicodeHighlightOptionsStr = nls.localize('unicodeHighlight.configureUnicodeHighlightOptions', 'Configure Unicode Highlight Options');\nlet UnicodeHighlighterHoverParticipant = class UnicodeHighlighterHoverParticipant {\n    constructor(_editor, _languageService, _openerService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this.hoverOrdinal = 5;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const unicodeHighlighter = this._editor.getContribution(UnicodeHighlighter.ID);\n        if (!unicodeHighlighter) {\n            return [];\n        }\n        const result = [];\n        const existedReason = new Set();\n        let index = 300;\n        for (const d of lineDecorations) {\n            const highlightInfo = unicodeHighlighter.getDecorationInfo(d);\n            if (!highlightInfo) {\n                continue;\n            }\n            const char = model.getValueInRange(d.range);\n            // text refers to a single character.\n            const codePoint = char.codePointAt(0);\n            const codePointStr = formatCodePointMarkdown(codePoint);\n            let reason;\n            switch (highlightInfo.reason.kind) {\n                case 0 /* UnicodeHighlighterReasonKind.Ambiguous */: {\n                    if (isBasicASCII(highlightInfo.reason.confusableWith)) {\n                        reason = nls.localize('unicodeHighlight.characterIsAmbiguousASCII', 'The character {0} could be confused with the ASCII character {1}, which is more common in source code.', codePointStr, formatCodePointMarkdown(highlightInfo.reason.confusableWith.codePointAt(0)));\n                    }\n                    else {\n                        reason = nls.localize('unicodeHighlight.characterIsAmbiguous', 'The character {0} could be confused with the character {1}, which is more common in source code.', codePointStr, formatCodePointMarkdown(highlightInfo.reason.confusableWith.codePointAt(0)));\n                    }\n                    break;\n                }\n                case 1 /* UnicodeHighlighterReasonKind.Invisible */:\n                    reason = nls.localize('unicodeHighlight.characterIsInvisible', 'The character {0} is invisible.', codePointStr);\n                    break;\n                case 2 /* UnicodeHighlighterReasonKind.NonBasicAscii */:\n                    reason = nls.localize('unicodeHighlight.characterIsNonBasicAscii', 'The character {0} is not a basic ASCII character.', codePointStr);\n                    break;\n            }\n            if (existedReason.has(reason)) {\n                continue;\n            }\n            existedReason.add(reason);\n            const adjustSettingsArgs = {\n                codePoint: codePoint,\n                reason: highlightInfo.reason,\n                inComment: highlightInfo.inComment,\n                inString: highlightInfo.inString,\n            };\n            const adjustSettings = nls.localize('unicodeHighlight.adjustSettings', 'Adjust settings');\n            const uri = `command:${ShowExcludeOptions.ID}?${encodeURIComponent(JSON.stringify(adjustSettingsArgs))}`;\n            const markdown = new MarkdownString('', true)\n                .appendMarkdown(reason)\n                .appendText(' ')\n                .appendLink(uri, adjustSettings, configureUnicodeHighlightOptionsStr);\n            result.push(new MarkdownHover(this, d.range, [markdown], false, index++));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderMarkdownHovers(context, hoverParts, this._editor, this._languageService, this._openerService);\n    }\n};\nUnicodeHighlighterHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService)\n], UnicodeHighlighterHoverParticipant);\nexport { UnicodeHighlighterHoverParticipant };\nfunction codePointToHex(codePoint) {\n    return `U+${codePoint.toString(16).padStart(4, '0')}`;\n}\nfunction formatCodePointMarkdown(codePoint) {\n    let value = `\\`${codePointToHex(codePoint)}\\``;\n    if (!InvisibleCharacters.isInvisibleCharacter(codePoint)) {\n        // Don't render any control characters or any invisible characters, as they cannot be seen anyways.\n        value += ` \"${`${renderCodePointAsInlineCode(codePoint)}`}\"`;\n    }\n    return value;\n}\nfunction renderCodePointAsInlineCode(codePoint) {\n    if (codePoint === 96 /* CharCode.BackTick */) {\n        return '`` ` ``';\n    }\n    return '`' + String.fromCodePoint(codePoint) + '`';\n}\nfunction computeReason(char, options) {\n    return UnicodeTextModelHighlighter.computeUnicodeHighlightReason(char, options);\n}\nclass Decorations {\n    constructor() {\n        this.map = new Map();\n    }\n    getDecorationFromOptions(options) {\n        return this.getDecoration(!options.includeComments, !options.includeStrings);\n    }\n    getDecoration(hideInComments, hideInStrings) {\n        const key = `${hideInComments}${hideInStrings}`;\n        let options = this.map.get(key);\n        if (!options) {\n            options = ModelDecorationOptions.createDynamic({\n                description: 'unicode-highlight',\n                stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n                className: 'unicode-highlight',\n                showIfCollapsed: true,\n                overviewRuler: null,\n                minimap: null,\n                hideInCommentTokens: hideInComments,\n                hideInStringTokens: hideInStrings,\n            });\n            this.map.set(key, options);\n        }\n        return options;\n    }\n}\nDecorations.instance = new Decorations();\nexport class DisableHighlightingInCommentsAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingInComments', 'Disable highlighting of characters in comments'),\n            alias: 'Disable highlighting of characters in comments',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingInComments.shortLabel', 'Disable Highlight In Comments');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.includeComments, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nexport class DisableHighlightingInStringsAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingInStrings', 'Disable highlighting of characters in strings'),\n            alias: 'Disable highlighting of characters in strings',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingInStrings.shortLabel', 'Disable Highlight In Strings');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.includeStrings, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nexport class DisableHighlightingOfAmbiguousCharactersAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters', 'Disable highlighting of ambiguous characters'),\n            alias: 'Disable highlighting of ambiguous characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel', 'Disable Ambiguous Highlight');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.ambiguousCharacters, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nDisableHighlightingOfAmbiguousCharactersAction.ID = 'editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters';\nexport class DisableHighlightingOfInvisibleCharactersAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfInvisibleCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfInvisibleCharacters', 'Disable highlighting of invisible characters'),\n            alias: 'Disable highlighting of invisible characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel', 'Disable Invisible Highlight');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.invisibleCharacters, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nDisableHighlightingOfInvisibleCharactersAction.ID = 'editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters';\nexport class DisableHighlightingOfNonBasicAsciiCharactersAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfNonBasicAsciiCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters', 'Disable highlighting of non basic ASCII characters'),\n            alias: 'Disable highlighting of non basic ASCII characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel', 'Disable Non ASCII Highlight');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor === null || accessor === void 0 ? void 0 : accessor.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.nonBasicASCII, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nDisableHighlightingOfNonBasicAsciiCharactersAction.ID = 'editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters';\nexport class ShowExcludeOptions extends EditorAction {\n    constructor() {\n        super({\n            id: ShowExcludeOptions.ID,\n            label: nls.localize('action.unicodeHighlight.showExcludeOptions', \"Show Exclude Options\"),\n            alias: 'Show Exclude Options',\n            precondition: undefined\n        });\n    }\n    async run(accessor, editor, args) {\n        const { codePoint, reason, inString, inComment } = args;\n        const char = String.fromCodePoint(codePoint);\n        const quickPickService = accessor.get(IQuickInputService);\n        const configurationService = accessor.get(IConfigurationService);\n        function getExcludeCharFromBeingHighlightedLabel(codePoint) {\n            if (InvisibleCharacters.isInvisibleCharacter(codePoint)) {\n                return nls.localize('unicodeHighlight.excludeInvisibleCharFromBeingHighlighted', 'Exclude {0} (invisible character) from being highlighted', codePointToHex(codePoint));\n            }\n            return nls.localize('unicodeHighlight.excludeCharFromBeingHighlighted', 'Exclude {0} from being highlighted', `${codePointToHex(codePoint)} \"${char}\"`);\n        }\n        const options = [];\n        if (reason.kind === 0 /* UnicodeHighlighterReasonKind.Ambiguous */) {\n            for (const locale of reason.notAmbiguousInLocales) {\n                options.push({\n                    label: nls.localize(\"unicodeHighlight.allowCommonCharactersInLanguage\", \"Allow unicode characters that are more common in the language \\\"{0}\\\".\", locale),\n                    run: async () => {\n                        excludeLocaleFromBeingHighlighted(configurationService, [locale]);\n                    },\n                });\n            }\n        }\n        options.push({\n            label: getExcludeCharFromBeingHighlightedLabel(codePoint),\n            run: () => excludeCharFromBeingHighlighted(configurationService, [codePoint])\n        });\n        if (inComment) {\n            const action = new DisableHighlightingInCommentsAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else if (inString) {\n            const action = new DisableHighlightingInStringsAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        if (reason.kind === 0 /* UnicodeHighlighterReasonKind.Ambiguous */) {\n            const action = new DisableHighlightingOfAmbiguousCharactersAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else if (reason.kind === 1 /* UnicodeHighlighterReasonKind.Invisible */) {\n            const action = new DisableHighlightingOfInvisibleCharactersAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else if (reason.kind === 2 /* UnicodeHighlighterReasonKind.NonBasicAscii */) {\n            const action = new DisableHighlightingOfNonBasicAsciiCharactersAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else {\n            expectNever(reason);\n        }\n        const result = await quickPickService.pick(options, { title: configureUnicodeHighlightOptionsStr });\n        if (result) {\n            await result.run();\n        }\n    }\n}\nShowExcludeOptions.ID = 'editor.action.unicodeHighlight.showExcludeOptions';\nasync function excludeCharFromBeingHighlighted(configurationService, charCodes) {\n    const existingValue = configurationService.getValue(unicodeHighlightConfigKeys.allowedCharacters);\n    let value;\n    if ((typeof existingValue === 'object') && existingValue) {\n        value = existingValue;\n    }\n    else {\n        value = {};\n    }\n    for (const charCode of charCodes) {\n        value[String.fromCodePoint(charCode)] = true;\n    }\n    await configurationService.updateValue(unicodeHighlightConfigKeys.allowedCharacters, value, 2 /* ConfigurationTarget.USER */);\n}\nasync function excludeLocaleFromBeingHighlighted(configurationService, locales) {\n    var _a;\n    const existingValue = (_a = configurationService.inspect(unicodeHighlightConfigKeys.allowedLocales).user) === null || _a === void 0 ? void 0 : _a.value;\n    let value;\n    if ((typeof existingValue === 'object') && existingValue) {\n        // Copy value, as the existing value is read only\n        value = Object.assign({}, existingValue);\n    }\n    else {\n        value = {};\n    }\n    for (const locale of locales) {\n        value[locale] = true;\n    }\n    await configurationService.updateValue(unicodeHighlightConfigKeys.allowedLocales, value, 2 /* ConfigurationTarget.USER */);\n}\nfunction expectNever(value) {\n    throw new Error(`Unexpected value: ${value}`);\n}\nregisterEditorAction(DisableHighlightingOfAmbiguousCharactersAction);\nregisterEditorAction(DisableHighlightingOfInvisibleCharactersAction);\nregisterEditorAction(DisableHighlightingOfNonBasicAsciiCharactersAction);\nregisterEditorAction(ShowExcludeOptions);\nregisterEditorContribution(UnicodeHighlighter.ID, UnicodeHighlighter, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nHoverParticipantRegistry.register(UnicodeHighlighterHoverParticipant);\n", "var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './bannerController.css';\nimport { $, append, clearNode } from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { Link } from '../../../../platform/opener/browser/link.js';\nimport { widgetClose } from '../../../../platform/theme/common/iconRegistry.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst BANNER_ELEMENT_HEIGHT = 26;\nlet BannerController = class BannerController extends Disposable {\n    constructor(_editor, instantiationService) {\n        super();\n        this._editor = _editor;\n        this.instantiationService = instantiationService;\n        this.banner = this._register(this.instantiationService.createInstance(Banner));\n    }\n    hide() {\n        this._editor.setBanner(null, 0);\n        this.banner.clear();\n    }\n    show(item) {\n        this.banner.show({\n            ...item,\n            onClose: () => {\n                var _a;\n                this.hide();\n                (_a = item.onClose) === null || _a === void 0 ? void 0 : _a.call(item);\n            }\n        });\n        this._editor.setBanner(this.banner.element, BANNER_ELEMENT_HEIGHT);\n    }\n};\nBannerController = __decorate([\n    __param(1, IInstantiationService)\n], BannerController);\nexport { BannerController };\n// TODO@hediet: Investigate if this can be reused by the workspace banner (bannerPart.ts).\nlet Banner = class Banner extends Disposable {\n    constructor(instantiationService) {\n        super();\n        this.instantiationService = instantiationService;\n        this.markdownRenderer = this.instantiationService.createInstance(MarkdownRenderer, {});\n        this.element = $('div.editor-banner');\n        this.element.tabIndex = 0;\n    }\n    getAriaLabel(item) {\n        if (item.ariaLabel) {\n            return item.ariaLabel;\n        }\n        if (typeof item.message === 'string') {\n            return item.message;\n        }\n        return undefined;\n    }\n    getBannerMessage(message) {\n        if (typeof message === 'string') {\n            const element = $('span');\n            element.innerText = message;\n            return element;\n        }\n        return this.markdownRenderer.render(message).element;\n    }\n    clear() {\n        clearNode(this.element);\n    }\n    show(item) {\n        // Clear previous item\n        clearNode(this.element);\n        // Banner aria label\n        const ariaLabel = this.getAriaLabel(item);\n        if (ariaLabel) {\n            this.element.setAttribute('aria-label', ariaLabel);\n        }\n        // Icon\n        const iconContainer = append(this.element, $('div.icon-container'));\n        iconContainer.setAttribute('aria-hidden', 'true');\n        if (item.icon) {\n            iconContainer.appendChild($(`div${ThemeIcon.asCSSSelector(item.icon)}`));\n        }\n        // Message\n        const messageContainer = append(this.element, $('div.message-container'));\n        messageContainer.setAttribute('aria-hidden', 'true');\n        messageContainer.appendChild(this.getBannerMessage(item.message));\n        // Message Actions\n        this.messageActionsContainer = append(this.element, $('div.message-actions-container'));\n        if (item.actions) {\n            for (const action of item.actions) {\n                this._register(this.instantiationService.createInstance(Link, this.messageActionsContainer, { ...action, tabIndex: -1 }, {}));\n            }\n        }\n        // Action\n        const actionBarContainer = append(this.element, $('div.action-container'));\n        this.actionBar = this._register(new ActionBar(actionBarContainer));\n        this.actionBar.push(this._register(new Action('banner.close', 'Close Banner', ThemeIcon.asClassName(widgetClose), true, () => {\n            if (typeof item.onClose === 'function') {\n                item.onClose();\n            }\n        })), { icon: true, label: false });\n        this.actionBar.setFocusable(false);\n    }\n};\nBanner = __decorate([\n    __param(0, IInstantiationService)\n], Banner);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { $, append, EventHelper } from '../../../base/browser/dom.js';\nimport { DomEmitter } from '../../../base/browser/event.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { EventType as TouchEventType, Gesture } from '../../../base/browser/touch.js';\nimport { Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { IOpenerService } from '../common/opener.js';\nimport './link.css';\nlet Link = class Link extends Disposable {\n    get enabled() {\n        return this._enabled;\n    }\n    set enabled(enabled) {\n        if (enabled) {\n            this.el.setAttribute('aria-disabled', 'false');\n            this.el.tabIndex = 0;\n            this.el.style.pointerEvents = 'auto';\n            this.el.style.opacity = '1';\n            this.el.style.cursor = 'pointer';\n            this._enabled = false;\n        }\n        else {\n            this.el.setAttribute('aria-disabled', 'true');\n            this.el.tabIndex = -1;\n            this.el.style.pointerEvents = 'none';\n            this.el.style.opacity = '0.4';\n            this.el.style.cursor = 'default';\n            this._enabled = true;\n        }\n        this._enabled = enabled;\n    }\n    constructor(container, _link, options = {}, openerService) {\n        var _a;\n        super();\n        this._link = _link;\n        this._enabled = true;\n        this.el = append(container, $('a.monaco-link', {\n            tabIndex: (_a = _link.tabIndex) !== null && _a !== void 0 ? _a : 0,\n            href: _link.href,\n            title: _link.title\n        }, _link.label));\n        this.el.setAttribute('role', 'button');\n        const onClickEmitter = this._register(new DomEmitter(this.el, 'click'));\n        const onKeyPress = this._register(new DomEmitter(this.el, 'keypress'));\n        const onEnterPress = Event.chain(onKeyPress.event, $ => $.map(e => new StandardKeyboardEvent(e))\n            .filter(e => e.keyCode === 3 /* KeyCode.Enter */));\n        const onTap = this._register(new DomEmitter(this.el, TouchEventType.Tap)).event;\n        this._register(Gesture.addTarget(this.el));\n        const onOpen = Event.any(onClickEmitter.event, onEnterPress, onTap);\n        this._register(onOpen(e => {\n            if (!this.enabled) {\n                return;\n            }\n            EventHelper.stop(e, true);\n            if (options === null || options === void 0 ? void 0 : options.opener) {\n                options.opener(this._link.href);\n            }\n            else {\n                openerService.open(this._link.href, { allowCommands: true });\n            }\n        }));\n        this.enabled = true;\n    }\n};\nLink = __decorate([\n    __param(3, IOpenerService)\n], Link);\nexport { Link };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport * as nls from '../../../../nls.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nconst ignoreUnusualLineTerminators = 'ignoreUnusualLineTerminators';\nfunction writeIgnoreState(codeEditorService, model, state) {\n    codeEditorService.setModelProperty(model.uri, ignoreUnusualLineTerminators, state);\n}\nfunction readIgnoreState(codeEditorService, model) {\n    return codeEditorService.getModelProperty(model.uri, ignoreUnusualLineTerminators);\n}\nlet UnusualLineTerminatorsDetector = class UnusualLineTerminatorsDetector extends Disposable {\n    constructor(_editor, _dialogService, _codeEditorService) {\n        super();\n        this._editor = _editor;\n        this._dialogService = _dialogService;\n        this._codeEditorService = _codeEditorService;\n        this._isPresentingDialog = false;\n        this._config = this._editor.getOption(126 /* EditorOption.unusualLineTerminators */);\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(126 /* EditorOption.unusualLineTerminators */)) {\n                this._config = this._editor.getOption(126 /* EditorOption.unusualLineTerminators */);\n                this._checkForUnusualLineTerminators();\n            }\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._checkForUnusualLineTerminators();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            if (e.isUndoing) {\n                // skip checking in case of undoing\n                return;\n            }\n            this._checkForUnusualLineTerminators();\n        }));\n        this._checkForUnusualLineTerminators();\n    }\n    async _checkForUnusualLineTerminators() {\n        if (this._config === 'off') {\n            return;\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model.mightContainUnusualLineTerminators()) {\n            return;\n        }\n        const ignoreState = readIgnoreState(this._codeEditorService, model);\n        if (ignoreState === true) {\n            // this model should be ignored\n            return;\n        }\n        if (this._editor.getOption(91 /* EditorOption.readOnly */)) {\n            // read only editor => sorry!\n            return;\n        }\n        if (this._config === 'auto') {\n            // just do it!\n            model.removeUnusualLineTerminators(this._editor.getSelections());\n            return;\n        }\n        if (this._isPresentingDialog) {\n            // we're currently showing the dialog, which is async.\n            // avoid spamming the user\n            return;\n        }\n        let result;\n        try {\n            this._isPresentingDialog = true;\n            result = await this._dialogService.confirm({\n                title: nls.localize('unusualLineTerminators.title', \"Unusual Line Terminators\"),\n                message: nls.localize('unusualLineTerminators.message', \"Detected unusual line terminators\"),\n                detail: nls.localize('unusualLineTerminators.detail', \"The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\\n\\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.\", basename(model.uri)),\n                primaryButton: nls.localize({ key: 'unusualLineTerminators.fix', comment: ['&& denotes a mnemonic'] }, \"&&Remove Unusual Line Terminators\"),\n                cancelButton: nls.localize('unusualLineTerminators.ignore', \"Ignore\")\n            });\n        }\n        finally {\n            this._isPresentingDialog = false;\n        }\n        if (!result.confirmed) {\n            // this model should be ignored\n            writeIgnoreState(this._codeEditorService, model, true);\n            return;\n        }\n        model.removeUnusualLineTerminators(this._editor.getSelections());\n    }\n};\nUnusualLineTerminatorsDetector.ID = 'editor.contrib.unusualLineTerminatorsDetector';\nUnusualLineTerminatorsDetector = __decorate([\n    __param(1, IDialogService),\n    __param(2, ICodeEditorService)\n], UnusualLineTerminatorsDetector);\nexport { UnusualLineTerminatorsDetector };\nregisterEditorContribution(UnusualLineTerminatorsDetector.ID, UnusualLineTerminatorsDetector, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar WordHighlighter_1, WordHighlighterContribution_1;\nimport * as nls from '../../../../nls.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, first, timeout } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { DocumentHighlightKind } from '../../../common/languages.js';\nimport { shouldSynchronizeModel } from '../../../common/model.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getHighlightDecorationOptions } from './highlightDecorations.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { score } from '../../../common/languageSelector.js';\n// import { TextualMultiDocumentHighlightFeature } from 'vs/editor/contrib/wordHighlighter/browser/textualHighlightProvider';\n// import { registerEditorFeature } from 'vs/editor/common/editorFeatures';\nconst ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\nexport function getOccurrencesAtPosition(registry, model, position, token) {\n    const orderedByScore = registry.ordered(model);\n    // in order of score ask the occurrences provider\n    // until someone response with a good result\n    // (good = none empty array)\n    return first(orderedByScore.map(provider => () => {\n        return Promise.resolve(provider.provideDocumentHighlights(model, position, token))\n            .then(undefined, onUnexpectedExternalError);\n    }), arrays.isNonEmptyArray).then(result => {\n        if (result) {\n            const map = new ResourceMap();\n            map.set(model.uri, result);\n            return map;\n        }\n        return new ResourceMap();\n    });\n}\nexport function getOccurrencesAcrossMultipleModels(registry, model, position, wordSeparators, token, otherModels) {\n    const orderedByScore = registry.ordered(model);\n    // in order of score ask the occurrences provider\n    // until someone response with a good result\n    // (good = none empty array)\n    return first(orderedByScore.map(provider => () => {\n        const filteredModels = otherModels.filter(otherModel => {\n            return shouldSynchronizeModel(otherModel);\n        }).filter(otherModel => {\n            return score(provider.selector, otherModel.uri, otherModel.getLanguageId(), true, undefined, undefined) > 0;\n        });\n        return Promise.resolve(provider.provideMultiDocumentHighlights(model, position, filteredModels, token))\n            .then(undefined, onUnexpectedExternalError);\n    }), (t) => t instanceof ResourceMap && t.size > 0);\n}\nclass OccurenceAtPositionRequest {\n    constructor(_model, _selection, _wordSeparators) {\n        this._model = _model;\n        this._selection = _selection;\n        this._wordSeparators = _wordSeparators;\n        this._wordRange = this._getCurrentWordRange(_model, _selection);\n        this._result = null;\n    }\n    get result() {\n        if (!this._result) {\n            this._result = createCancelablePromise(token => this._compute(this._model, this._selection, this._wordSeparators, token));\n        }\n        return this._result;\n    }\n    _getCurrentWordRange(model, selection) {\n        const word = model.getWordAtPosition(selection.getPosition());\n        if (word) {\n            return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n        }\n        return null;\n    }\n    isValid(model, selection, decorations) {\n        const lineNumber = selection.startLineNumber;\n        const startColumn = selection.startColumn;\n        const endColumn = selection.endColumn;\n        const currentWordRange = this._getCurrentWordRange(model, selection);\n        let requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\n        // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\n        // (Same symbol)\n        for (let i = 0, len = decorations.length; !requestIsValid && i < len; i++) {\n            const range = decorations.getRange(i);\n            if (range && range.startLineNumber === lineNumber) {\n                if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\n                    requestIsValid = true;\n                }\n            }\n        }\n        return requestIsValid;\n    }\n    cancel() {\n        this.result.cancel();\n    }\n}\nclass SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators, providers) {\n        super(model, selection, wordSeparators);\n        this._providers = providers;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return getOccurrencesAtPosition(this._providers, model, selection.getPosition(), token).then(value => {\n            if (!value) {\n                return new ResourceMap();\n            }\n            return value;\n        });\n    }\n}\nclass MultiModelOccurenceRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators, providers, otherModels) {\n        super(model, selection, wordSeparators);\n        this._providers = providers;\n        this._otherModels = otherModels;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return getOccurrencesAcrossMultipleModels(this._providers, model, selection.getPosition(), wordSeparators, token, this._otherModels).then(value => {\n            if (!value) {\n                return new ResourceMap();\n            }\n            return value;\n        });\n    }\n}\nclass TextualOccurenceRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, word, wordSeparators, otherModels) {\n        super(model, selection, wordSeparators);\n        this._otherModels = otherModels;\n        this._selectionIsEmpty = selection.isEmpty();\n        this._word = word;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return timeout(250, token).then(() => {\n            const result = new ResourceMap();\n            let wordResult;\n            if (this._word) {\n                wordResult = this._word;\n            }\n            else {\n                wordResult = model.getWordAtPosition(selection.getPosition());\n            }\n            if (!wordResult) {\n                return new ResourceMap();\n            }\n            const allModels = [model, ...this._otherModels];\n            for (const otherModel of allModels) {\n                if (otherModel.isDisposed()) {\n                    continue;\n                }\n                const matches = otherModel.findMatches(wordResult.word, true, false, true, wordSeparators, false);\n                const highlights = matches.map(m => ({\n                    range: m.range,\n                    kind: DocumentHighlightKind.Text\n                }));\n                if (highlights) {\n                    result.set(otherModel.uri, highlights);\n                }\n            }\n            return result;\n        });\n    }\n    isValid(model, selection, decorations) {\n        const currentSelectionIsEmpty = selection.isEmpty();\n        if (this._selectionIsEmpty !== currentSelectionIsEmpty) {\n            return false;\n        }\n        return super.isValid(model, selection, decorations);\n    }\n}\nfunction computeOccurencesAtPosition(registry, model, selection, word, wordSeparators) {\n    if (registry.has(model)) {\n        return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators, registry);\n    }\n    return new TextualOccurenceRequest(model, selection, word, wordSeparators, []);\n}\nfunction computeOccurencesMultiModel(registry, model, selection, word, wordSeparators, otherModels) {\n    if (registry.has(model)) {\n        return new MultiModelOccurenceRequest(model, selection, wordSeparators, registry, otherModels);\n    }\n    return new TextualOccurenceRequest(model, selection, word, wordSeparators, otherModels);\n}\nregisterModelAndPositionCommand('_executeDocumentHighlights', async (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const map = await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, position, CancellationToken.None);\n    return map === null || map === void 0 ? void 0 : map.get(model.uri);\n});\nlet WordHighlighter = WordHighlighter_1 = class WordHighlighter {\n    constructor(editor, providers, multiProviders, contextKeyService, codeEditorService) {\n        this.toUnhook = new DisposableStore();\n        this.workerRequestTokenId = 0;\n        this.workerRequestCompleted = false;\n        this.workerRequestValue = new ResourceMap();\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n        this.editor = editor;\n        this.providers = providers;\n        this.multiDocumentProviders = multiProviders;\n        this.codeEditorService = codeEditorService;\n        this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\n        this._ignorePositionChangeEvent = false;\n        this.occurrencesHighlight = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n        this.model = this.editor.getModel();\n        this.toUnhook.add(editor.onDidChangeCursorPosition((e) => {\n            if (this._ignorePositionChangeEvent) {\n                // We are changing the position => ignore this event\n                return;\n            }\n            if (this.occurrencesHighlight === 'off') {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            this._onPositionChanged(e);\n        }));\n        this.toUnhook.add(editor.onDidFocusEditorText((e) => {\n            if (this.occurrencesHighlight === 'off') {\n                // Early exit if nothing needs to be done\n                return;\n            }\n            if (!this.workerRequest) {\n                this._run();\n            }\n        }));\n        this.toUnhook.add(editor.onDidChangeModelContent((e) => {\n            this._stopAll();\n        }));\n        this.toUnhook.add(editor.onDidChangeModel((e) => {\n            if (!e.newModelUrl && e.oldModelUrl) {\n                this._stopSingular();\n            }\n            else {\n                if (WordHighlighter_1.query) {\n                    this._run();\n                }\n            }\n        }));\n        this.toUnhook.add(editor.onDidChangeConfiguration((e) => {\n            const newValue = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n            if (this.occurrencesHighlight !== newValue) {\n                this.occurrencesHighlight = newValue;\n                this._stopAll();\n            }\n        }));\n        this.decorations = this.editor.createDecorationsCollection();\n        this.workerRequestTokenId = 0;\n        this.workerRequest = null;\n        this.workerRequestCompleted = false;\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n        // if there is a query already, highlight off that query\n        if (WordHighlighter_1.query) {\n            this._run();\n        }\n    }\n    hasDecorations() {\n        return (this.decorations.length > 0);\n    }\n    restore() {\n        if (this.occurrencesHighlight === 'off') {\n            return;\n        }\n        this._run();\n    }\n    _getSortedHighlights() {\n        return (this.decorations.getRanges()\n            .sort(Range.compareRangesUsingStarts));\n    }\n    moveNext() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index + 1) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    moveBack() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index - 1 + highlights.length) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    _removeSingleDecorations() {\n        // return if no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const currentDecorationIDs = WordHighlighter_1.storedDecorations.get(this.editor.getModel().uri);\n        if (!currentDecorationIDs) {\n            return;\n        }\n        this.editor.removeDecorations(currentDecorationIDs);\n        WordHighlighter_1.storedDecorations.delete(this.editor.getModel().uri);\n        if (this.decorations.length > 0) {\n            this.decorations.clear();\n            this._hasWordHighlights.set(false);\n        }\n    }\n    _removeAllDecorations() {\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        const deleteURI = [];\n        // iterate over editors and store models in currentModels\n        for (const editor of currentEditors) {\n            if (!editor.hasModel()) {\n                continue;\n            }\n            const currentDecorationIDs = WordHighlighter_1.storedDecorations.get(editor.getModel().uri);\n            if (!currentDecorationIDs) {\n                continue;\n            }\n            editor.removeDecorations(currentDecorationIDs);\n            deleteURI.push(editor.getModel().uri);\n            const editorHighlighterContrib = WordHighlighterContribution.get(editor);\n            if (!(editorHighlighterContrib === null || editorHighlighterContrib === void 0 ? void 0 : editorHighlighterContrib.wordHighlighter)) {\n                continue;\n            }\n            if (editorHighlighterContrib.wordHighlighter.decorations.length > 0) {\n                editorHighlighterContrib.wordHighlighter.decorations.clear();\n                editorHighlighterContrib.wordHighlighter.workerRequest = null;\n                editorHighlighterContrib.wordHighlighter._hasWordHighlights.set(false);\n            }\n        }\n        for (const uri of deleteURI) {\n            WordHighlighter_1.storedDecorations.delete(uri);\n        }\n    }\n    _stopSingular() {\n        var _a, _b, _c, _d;\n        // Remove any existing decorations + a possible query, and re - run to update decorations\n        this._removeSingleDecorations();\n        if (this.editor.hasTextFocus()) {\n            if (((_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri.scheme) !== Schemas.vscodeNotebookCell && ((_c = (_b = WordHighlighter_1.query) === null || _b === void 0 ? void 0 : _b.modelInfo) === null || _c === void 0 ? void 0 : _c.model.uri.scheme) !== Schemas.vscodeNotebookCell) { // clear query if focused non-nb editor\n                WordHighlighter_1.query = null;\n                this._run(); // TODO: @Yoyokrazy -- investigate why we need a full rerun here. likely addressed a case/patch in the first iteration of this feature\n            }\n            else { // remove modelInfo to account for nb cell being disposed\n                if ((_d = WordHighlighter_1.query) === null || _d === void 0 ? void 0 : _d.modelInfo) {\n                    WordHighlighter_1.query.modelInfo = null;\n                }\n            }\n        }\n        // Cancel any renderDecorationsTimer\n        if (this.renderDecorationsTimer !== -1) {\n            clearTimeout(this.renderDecorationsTimer);\n            this.renderDecorationsTimer = -1;\n        }\n        // Cancel any worker request\n        if (this.workerRequest !== null) {\n            this.workerRequest.cancel();\n            this.workerRequest = null;\n        }\n        // Invalidate any worker request callback\n        if (!this.workerRequestCompleted) {\n            this.workerRequestTokenId++;\n            this.workerRequestCompleted = true;\n        }\n    }\n    _stopAll() {\n        // Remove any existing decorations\n        // TODO: @Yoyokrazy -- this triggers as notebooks scroll, causing highlights to disappear momentarily.\n        // maybe a nb type check?\n        this._removeAllDecorations();\n        // Cancel any renderDecorationsTimer\n        if (this.renderDecorationsTimer !== -1) {\n            clearTimeout(this.renderDecorationsTimer);\n            this.renderDecorationsTimer = -1;\n        }\n        // Cancel any worker request\n        if (this.workerRequest !== null) {\n            this.workerRequest.cancel();\n            this.workerRequest = null;\n        }\n        // Invalidate any worker request callback\n        if (!this.workerRequestCompleted) {\n            this.workerRequestTokenId++;\n            this.workerRequestCompleted = true;\n        }\n    }\n    _onPositionChanged(e) {\n        var _a;\n        // disabled\n        if (this.occurrencesHighlight === 'off') {\n            this._stopAll();\n            return;\n        }\n        // ignore typing & other\n        // need to check if the model is a notebook cell, should not stop if nb\n        if (e.reason !== 3 /* CursorChangeReason.Explicit */ && ((_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri.scheme) !== Schemas.vscodeNotebookCell) {\n            this._stopAll();\n            return;\n        }\n        this._run();\n    }\n    _getWord() {\n        const editorSelection = this.editor.getSelection();\n        const lineNumber = editorSelection.startLineNumber;\n        const startColumn = editorSelection.startColumn;\n        if (this.model.isDisposed()) {\n            return null;\n        }\n        return this.model.getWordAtPosition({\n            lineNumber: lineNumber,\n            column: startColumn\n        });\n    }\n    getOtherModelsToHighlight(model) {\n        if (!model) {\n            return [];\n        }\n        // notebook case\n        const isNotebookEditor = model.uri.scheme === Schemas.vscodeNotebookCell;\n        if (isNotebookEditor) {\n            const currentModels = [];\n            const currentEditors = this.codeEditorService.listCodeEditors();\n            for (const editor of currentEditors) {\n                const tempModel = editor.getModel();\n                if (tempModel && tempModel !== model && tempModel.uri.scheme === Schemas.vscodeNotebookCell) {\n                    currentModels.push(tempModel);\n                }\n            }\n            return currentModels;\n        }\n        // inline case\n        // ? current works when highlighting outside of an inline diff, highlighting in.\n        // ? broken when highlighting within a diff editor. highlighting the main editor does not work\n        // ? editor group service could be useful here\n        const currentModels = [];\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        for (const editor of currentEditors) {\n            if (!isDiffEditor(editor)) {\n                continue;\n            }\n            const diffModel = editor.getModel();\n            if (!diffModel) {\n                continue;\n            }\n            if (model === diffModel.modified) { // embedded inline chat diff would pass this, allowing highlights\n                //? currentModels.push(diffModel.original);\n                currentModels.push(diffModel.modified);\n            }\n        }\n        if (currentModels.length) { // no matching editors have been found\n            return currentModels;\n        }\n        // multi-doc OFF\n        if (this.occurrencesHighlight === 'singleFile') {\n            return [];\n        }\n        // multi-doc ON\n        for (const editor of currentEditors) {\n            const tempModel = editor.getModel();\n            const isValidModel = tempModel && tempModel !== model;\n            if (isValidModel) {\n                currentModels.push(tempModel);\n            }\n        }\n        return currentModels;\n    }\n    _run() {\n        var _a;\n        let workerRequestIsValid;\n        const hasTextFocus = this.editor.hasTextFocus();\n        if (!hasTextFocus) { // new nb cell scrolled in, didChangeModel fires\n            if (!WordHighlighter_1.query) { // no previous query, nothing to highlight off of\n                return;\n            }\n        }\n        else { // has text focus\n            const editorSelection = this.editor.getSelection();\n            // ignore multiline selection\n            if (!editorSelection || editorSelection.startLineNumber !== editorSelection.endLineNumber) {\n                WordHighlighter_1.query = null;\n                this._stopAll();\n                return;\n            }\n            const startColumn = editorSelection.startColumn;\n            const endColumn = editorSelection.endColumn;\n            const word = this._getWord();\n            // The selection must be inside a word or surround one word at most\n            if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\n                // no previous query, nothing to highlight\n                WordHighlighter_1.query = null;\n                this._stopAll();\n                return;\n            }\n            // All the effort below is trying to achieve this:\n            // - when cursor is moved to a word, trigger immediately a findOccurrences request\n            // - 250ms later after the last cursor move event, render the occurrences\n            // - no flickering!\n            workerRequestIsValid = (this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this.decorations));\n            WordHighlighter_1.query = {\n                modelInfo: {\n                    model: this.model,\n                    selection: editorSelection,\n                },\n                word: word\n            };\n        }\n        // There are 4 cases:\n        // a) old workerRequest is valid & completed, renderDecorationsTimer fired\n        // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\n        // c) old workerRequest is valid, but not completed\n        // d) old workerRequest is not valid\n        // For a) no action is needed\n        // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\n        this.lastCursorPositionChangeTime = (new Date()).getTime();\n        if (workerRequestIsValid) {\n            if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\n                // case b)\n                // Delay the firing of renderDecorationsTimer by an extra 250 ms\n                clearTimeout(this.renderDecorationsTimer);\n                this.renderDecorationsTimer = -1;\n                this._beginRenderDecorations();\n            }\n        }\n        else {\n            // case d)\n            // Stop all previous actions and start fresh\n            this._stopAll();\n            const myRequestId = ++this.workerRequestTokenId;\n            this.workerRequestCompleted = false;\n            const otherModelsToHighlight = this.getOtherModelsToHighlight(this.editor.getModel());\n            // when reaching here, there are two possible states.\n            // \t\t1) we have text focus, and a valid query was updated.\n            // \t\t2) we do not have text focus, and a valid query is cached.\n            // the query will ALWAYS have the correct data for the current highlight request, so it can always be passed to the workerRequest safely\n            if (!WordHighlighter_1.query.modelInfo || WordHighlighter_1.query.modelInfo.model.isDisposed()) {\n                return;\n            }\n            this.workerRequest = this.computeWithModel(WordHighlighter_1.query.modelInfo.model, WordHighlighter_1.query.modelInfo.selection, WordHighlighter_1.query.word, otherModelsToHighlight);\n            (_a = this.workerRequest) === null || _a === void 0 ? void 0 : _a.result.then(data => {\n                if (myRequestId === this.workerRequestTokenId) {\n                    this.workerRequestCompleted = true;\n                    this.workerRequestValue = data || [];\n                    this._beginRenderDecorations();\n                }\n            }, onUnexpectedError);\n        }\n    }\n    computeWithModel(model, selection, word, otherModels) {\n        if (!otherModels.length) {\n            return computeOccurencesAtPosition(this.providers, model, selection, word, this.editor.getOption(130 /* EditorOption.wordSeparators */));\n        }\n        else {\n            return computeOccurencesMultiModel(this.multiDocumentProviders, model, selection, word, this.editor.getOption(130 /* EditorOption.wordSeparators */), otherModels);\n        }\n    }\n    _beginRenderDecorations() {\n        const currentTime = (new Date()).getTime();\n        const minimumRenderTime = this.lastCursorPositionChangeTime + 250;\n        if (currentTime >= minimumRenderTime) {\n            // Synchronous\n            this.renderDecorationsTimer = -1;\n            this.renderDecorations();\n        }\n        else {\n            // Asynchronous\n            this.renderDecorationsTimer = setTimeout(() => {\n                this.renderDecorations();\n            }, (minimumRenderTime - currentTime));\n        }\n    }\n    renderDecorations() {\n        var _a, _b, _c;\n        this.renderDecorationsTimer = -1;\n        // create new loop, iterate over current editors using this.codeEditorService.listCodeEditors(),\n        // if the URI of that codeEditor is in the map, then add the decorations to the decorations array\n        // then set the decorations for the editor\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        for (const editor of currentEditors) {\n            const editorHighlighterContrib = WordHighlighterContribution.get(editor);\n            if (!editorHighlighterContrib) {\n                continue;\n            }\n            const newDecorations = [];\n            const uri = (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.uri;\n            if (uri && this.workerRequestValue.has(uri)) {\n                const oldDecorationIDs = WordHighlighter_1.storedDecorations.get(uri);\n                const newDocumentHighlights = this.workerRequestValue.get(uri);\n                if (newDocumentHighlights) {\n                    for (const highlight of newDocumentHighlights) {\n                        if (!highlight.range) {\n                            continue;\n                        }\n                        newDecorations.push({\n                            range: highlight.range,\n                            options: getHighlightDecorationOptions(highlight.kind)\n                        });\n                    }\n                }\n                let newDecorationIDs = [];\n                editor.changeDecorations((changeAccessor) => {\n                    newDecorationIDs = changeAccessor.deltaDecorations(oldDecorationIDs !== null && oldDecorationIDs !== void 0 ? oldDecorationIDs : [], newDecorations);\n                });\n                WordHighlighter_1.storedDecorations = WordHighlighter_1.storedDecorations.set(uri, newDecorationIDs);\n                if (newDecorations.length > 0) {\n                    (_b = editorHighlighterContrib.wordHighlighter) === null || _b === void 0 ? void 0 : _b.decorations.set(newDecorations);\n                    (_c = editorHighlighterContrib.wordHighlighter) === null || _c === void 0 ? void 0 : _c._hasWordHighlights.set(true);\n                }\n            }\n        }\n    }\n    dispose() {\n        this._stopSingular();\n        this.toUnhook.dispose();\n    }\n};\nWordHighlighter.storedDecorations = new ResourceMap();\nWordHighlighter.query = null;\nWordHighlighter = WordHighlighter_1 = __decorate([\n    __param(4, ICodeEditorService)\n], WordHighlighter);\nlet WordHighlighterContribution = WordHighlighterContribution_1 = class WordHighlighterContribution extends Disposable {\n    static get(editor) {\n        return editor.getContribution(WordHighlighterContribution_1.ID);\n    }\n    constructor(editor, contextKeyService, languageFeaturesService, codeEditorService) {\n        super();\n        this._wordHighlighter = null;\n        const createWordHighlighterIfPossible = () => {\n            if (editor.hasModel() && !editor.getModel().isTooLargeForTokenization()) {\n                this._wordHighlighter = new WordHighlighter(editor, languageFeaturesService.documentHighlightProvider, languageFeaturesService.multiDocumentHighlightProvider, contextKeyService, codeEditorService);\n            }\n        };\n        this._register(editor.onDidChangeModel((e) => {\n            if (this._wordHighlighter) {\n                this._wordHighlighter.dispose();\n                this._wordHighlighter = null;\n            }\n            createWordHighlighterIfPossible();\n        }));\n        createWordHighlighterIfPossible();\n    }\n    get wordHighlighter() {\n        return this._wordHighlighter;\n    }\n    saveViewState() {\n        if (this._wordHighlighter && this._wordHighlighter.hasDecorations()) {\n            return true;\n        }\n        return false;\n    }\n    moveNext() {\n        var _a;\n        (_a = this._wordHighlighter) === null || _a === void 0 ? void 0 : _a.moveNext();\n    }\n    moveBack() {\n        var _a;\n        (_a = this._wordHighlighter) === null || _a === void 0 ? void 0 : _a.moveBack();\n    }\n    restoreViewState(state) {\n        if (this._wordHighlighter && state) {\n            this._wordHighlighter.restore();\n        }\n    }\n    dispose() {\n        if (this._wordHighlighter) {\n            this._wordHighlighter.dispose();\n            this._wordHighlighter = null;\n        }\n        super.dispose();\n    }\n};\nWordHighlighterContribution.ID = 'editor.contrib.wordHighlighter';\nWordHighlighterContribution = WordHighlighterContribution_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ICodeEditorService)\n], WordHighlighterContribution);\nexport { WordHighlighterContribution };\nclass WordHighlightNavigationAction extends EditorAction {\n    constructor(next, opts) {\n        super(opts);\n        this._isNext = next;\n    }\n    run(accessor, editor) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        if (this._isNext) {\n            controller.moveNext();\n        }\n        else {\n            controller.moveBack();\n        }\n    }\n}\nclass NextWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.wordHighlight.next',\n            label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\n            alias: 'Go to Next Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass PrevWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.wordHighlight.prev',\n            label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\n            alias: 'Go to Previous Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass TriggerWordHighlightAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.wordHighlight.trigger',\n            label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\n            alias: 'Trigger Symbol Highlight',\n            precondition: ctxHasWordHighlights.toNegated(),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.restoreViewState(true);\n    }\n}\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(NextWordHighlightAction);\nregisterEditorAction(PrevWordHighlightAction);\nregisterEditorAction(TriggerWordHighlightAction);\n// registerEditorFeature(TextualMultiDocumentHighlightFeature);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand } from '../../../common/commands/replaceCommand.js';\nimport { EditorOptions } from '../../../common/config/editorOptions.js';\nimport { CursorState } from '../../../common/cursorCommon.js';\nimport { WordOperations } from '../../../common/cursor/cursorWordOperations.js';\nimport { getMapForWordSeparators } from '../../../common/core/wordCharacterClassifier.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { CONTEXT_ACCESSIBILITY_MODE_ENABLED } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IsWindowsContext } from '../../../../platform/contextkey/common/contextkeys.js';\nexport class MoveWordCommand extends EditorCommand {\n    constructor(opts) {\n        super(opts);\n        this._inSelectionMode = opts.inSelectionMode;\n        this._wordNavigationType = opts.wordNavigationType;\n    }\n    runEditorCommand(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(130 /* EditorOption.wordSeparators */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const result = selections.map((sel) => {\n            const inPosition = new Position(sel.positionLineNumber, sel.positionColumn);\n            const outPosition = this._move(wordSeparators, model, inPosition, this._wordNavigationType);\n            return this._moveTo(sel, outPosition, this._inSelectionMode);\n        });\n        model.pushStackElement();\n        editor._getViewModel().setCursorStates('moveWordCommand', 3 /* CursorChangeReason.Explicit */, result.map(r => CursorState.fromModelSelection(r)));\n        if (result.length === 1) {\n            const pos = new Position(result[0].positionLineNumber, result[0].positionColumn);\n            editor.revealPosition(pos, 0 /* ScrollType.Smooth */);\n        }\n    }\n    _moveTo(from, to, inSelectionMode) {\n        if (inSelectionMode) {\n            // move just position\n            return new Selection(from.selectionStartLineNumber, from.selectionStartColumn, to.lineNumber, to.column);\n        }\n        else {\n            // move everything\n            return new Selection(to.lineNumber, to.column, to.lineNumber, to.column);\n        }\n    }\n}\nexport class WordLeftCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordOperations.moveWordLeft(wordSeparators, model, position, wordNavigationType);\n    }\n}\nexport class WordRightCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordOperations.moveWordRight(wordSeparators, model, position, wordNavigationType);\n    }\n}\nexport class CursorWordStartLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartLeft',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndLeft',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordLeft extends WordLeftCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 1 /* WordNavigationType.WordStartFast */,\n            id: 'cursorWordLeft',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 15 /* KeyCode.LeftArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordStartLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartLeftSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndLeftSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordLeftSelect extends WordLeftCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 1 /* WordNavigationType.WordStartFast */,\n            id: 'cursorWordLeftSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Accessibility navigation commands should only be enabled on windows since they are tuned to what NVDA expects\nexport class CursorWordAccessibilityLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityLeft',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class CursorWordAccessibilityLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityLeftSelect',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class CursorWordStartRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartRight',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndRight extends WordRightCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndRight',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 17 /* KeyCode.RightArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordRight',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordStartRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartRightSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndRightSelect extends WordRightCommand {\n    constructor() {\n        var _a;\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndRightSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordRightSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordAccessibilityRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityRight',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class CursorWordAccessibilityRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityRightSelect',\n            precondition: undefined\n        });\n    }\n    _move(_, model, position, wordNavigationType) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\n    }\n}\nexport class DeleteWordCommand extends EditorCommand {\n    constructor(opts) {\n        super(opts);\n        this._whitespaceHeuristics = opts.whitespaceHeuristics;\n        this._wordNavigationType = opts.wordNavigationType;\n    }\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(130 /* EditorOption.wordSeparators */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const autoClosingBrackets = editor.getOption(6 /* EditorOption.autoClosingBrackets */);\n        const autoClosingQuotes = editor.getOption(11 /* EditorOption.autoClosingQuotes */);\n        const autoClosingPairs = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getAutoClosingPairs();\n        const viewModel = editor._getViewModel();\n        const commands = selections.map((sel) => {\n            const deleteRange = this._delete({\n                wordSeparators,\n                model,\n                selection: sel,\n                whitespaceHeuristics: this._whitespaceHeuristics,\n                autoClosingDelete: editor.getOption(9 /* EditorOption.autoClosingDelete */),\n                autoClosingBrackets,\n                autoClosingQuotes,\n                autoClosingPairs,\n                autoClosedCharacters: viewModel.getCursorAutoClosedCharacters()\n            }, this._wordNavigationType);\n            return new ReplaceCommand(deleteRange, '');\n        });\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class DeleteWordLeftCommand extends DeleteWordCommand {\n    _delete(ctx, wordNavigationType) {\n        const r = WordOperations.deleteWordLeft(ctx, wordNavigationType);\n        if (r) {\n            return r;\n        }\n        return new Range(1, 1, 1, 1);\n    }\n}\nexport class DeleteWordRightCommand extends DeleteWordCommand {\n    _delete(ctx, wordNavigationType) {\n        const r = WordOperations.deleteWordRight(ctx, wordNavigationType);\n        if (r) {\n            return r;\n        }\n        const lineCount = ctx.model.getLineCount();\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\n    }\n}\nexport class DeleteWordStartLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordStartLeft',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordEndLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordEndLeft',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordLeft',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1 /* KeyCode.Backspace */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class DeleteWordStartRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordStartRight',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordEndRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordEndRight',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordRight',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 20 /* KeyCode.Delete */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 20 /* KeyCode.Delete */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class DeleteInsideWord extends EditorAction {\n    constructor() {\n        super({\n            id: 'deleteInsideWord',\n            precondition: EditorContextKeys.writable,\n            label: nls.localize('deleteInsideWord', \"Delete Word\"),\n            alias: 'Delete Word'\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(130 /* EditorOption.wordSeparators */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const commands = selections.map((sel) => {\n            const deleteRange = WordOperations.deleteInsideWord(wordSeparators, model, sel);\n            return new ReplaceCommand(deleteRange, '');\n        });\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nregisterEditorCommand(new CursorWordStartLeft());\nregisterEditorCommand(new CursorWordEndLeft());\nregisterEditorCommand(new CursorWordLeft());\nregisterEditorCommand(new CursorWordStartLeftSelect());\nregisterEditorCommand(new CursorWordEndLeftSelect());\nregisterEditorCommand(new CursorWordLeftSelect());\nregisterEditorCommand(new CursorWordStartRight());\nregisterEditorCommand(new CursorWordEndRight());\nregisterEditorCommand(new CursorWordRight());\nregisterEditorCommand(new CursorWordStartRightSelect());\nregisterEditorCommand(new CursorWordEndRightSelect());\nregisterEditorCommand(new CursorWordRightSelect());\nregisterEditorCommand(new CursorWordAccessibilityLeft());\nregisterEditorCommand(new CursorWordAccessibilityLeftSelect());\nregisterEditorCommand(new CursorWordAccessibilityRight());\nregisterEditorCommand(new CursorWordAccessibilityRightSelect());\nregisterEditorCommand(new DeleteWordStartLeft());\nregisterEditorCommand(new DeleteWordEndLeft());\nregisterEditorCommand(new DeleteWordLeft());\nregisterEditorCommand(new DeleteWordStartRight());\nregisterEditorCommand(new DeleteWordEndRight());\nregisterEditorCommand(new DeleteWordRight());\nregisterEditorAction(DeleteInsideWord);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { WordPartOperations } from '../../../common/cursor/cursorWordOperations.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { DeleteWordCommand, MoveWordCommand } from '../../wordOperations/browser/wordOperations.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nexport class DeleteWordPartLeft extends DeleteWordCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordPartLeft',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _delete(ctx, wordNavigationType) {\n        const r = WordPartOperations.deleteWordPartLeft(ctx);\n        if (r) {\n            return r;\n        }\n        return new Range(1, 1, 1, 1);\n    }\n}\nexport class DeleteWordPartRight extends DeleteWordCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordPartRight',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 20 /* KeyCode.Delete */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _delete(ctx, wordNavigationType) {\n        const r = WordPartOperations.deleteWordPartRight(ctx);\n        if (r) {\n            return r;\n        }\n        const lineCount = ctx.model.getLineCount();\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\n    }\n}\nexport class WordPartLeftCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordPartOperations.moveWordPartLeft(wordSeparators, model, position);\n    }\n}\nexport class CursorWordPartLeft extends WordPartLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordPartLeft',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Register previous id for compatibility purposes\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeft', 'cursorWordPartLeft');\nexport class CursorWordPartLeftSelect extends WordPartLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordPartLeftSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Register previous id for compatibility purposes\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeftSelect', 'cursorWordPartLeftSelect');\nexport class WordPartRightCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType) {\n        return WordPartOperations.moveWordPartRight(wordSeparators, model, position);\n    }\n}\nexport class CursorWordPartRight extends WordPartRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordPartRight',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordPartRightSelect extends WordPartRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordPartRightSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nregisterEditorCommand(new DeleteWordPartLeft());\nregisterEditorCommand(new DeleteWordPartRight());\nregisterEditorCommand(new CursorWordPartLeft());\nregisterEditorCommand(new CursorWordPartLeftSelect());\nregisterEditorCommand(new CursorWordPartRight());\nregisterEditorCommand(new CursorWordPartRightSelect());\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nexport class ReadOnlyMessageController extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._register(this.editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit()));\n    }\n    _onDidAttemptReadOnlyEdit() {\n        const messageController = MessageController.get(this.editor);\n        if (messageController && this.editor.hasModel()) {\n            let message = this.editor.getOptions().get(92 /* EditorOption.readOnlyMessage */);\n            if (!message) {\n                if (this.editor.isSimpleWidget) {\n                    message = new MarkdownString(nls.localize('editor.simple.readonly', \"Cannot edit in read-only input\"));\n                }\n                else {\n                    message = new MarkdownString(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"));\n                }\n            }\n            messageController.showMessage(message, this.editor.getPosition());\n        }\n    }\n}\nReadOnlyMessageController.ID = 'editor.contrib.readOnlyMessageController';\nregisterEditorContribution(ReadOnlyMessageController.ID, ReadOnlyMessageController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './iPadShowKeyboard.css';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { isIOS } from '../../../../base/common/platform.js';\nexport class IPadShowKeyboard extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this.widget = null;\n        if (isIOS) {\n            this._register(editor.onDidChangeConfiguration(() => this.update()));\n            this.update();\n        }\n    }\n    update() {\n        const shouldHaveWidget = (!this.editor.getOption(91 /* EditorOption.readOnly */));\n        if (!this.widget && shouldHaveWidget) {\n            this.widget = new ShowKeyboardWidget(this.editor);\n        }\n        else if (this.widget && !shouldHaveWidget) {\n            this.widget.dispose();\n            this.widget = null;\n        }\n    }\n    dispose() {\n        super.dispose();\n        if (this.widget) {\n            this.widget.dispose();\n            this.widget = null;\n        }\n    }\n}\nIPadShowKeyboard.ID = 'editor.contrib.iPadShowKeyboard';\nclass ShowKeyboardWidget extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._domNode = document.createElement('textarea');\n        this._domNode.className = 'iPadShowKeyboard';\n        this._register(dom.addDisposableListener(this._domNode, 'touchstart', (e) => {\n            this.editor.focus();\n        }));\n        this._register(dom.addDisposableListener(this._domNode, 'focus', (e) => {\n            this.editor.focus();\n        }));\n        this.editor.addOverlayWidget(this);\n    }\n    dispose() {\n        this.editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    // ----- IOverlayWidget API\n    getId() {\n        return ShowKeyboardWidget.ID;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            preference: 1 /* OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER */\n        };\n    }\n}\nShowKeyboardWidget.ID = 'editor.contrib.ShowKeyboardWidget';\nregisterEditorContribution(IPadShowKeyboard.ID, IPadShowKeyboard, 3 /* EditorContributionInstantiation.Eventually */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './editor.all.js';\nimport './standalone/browser/iPadShowKeyboard/iPadShowKeyboard.js';\nimport './standalone/browser/inspectTokens/inspectTokens.js';\nimport './standalone/browser/quickAccess/standaloneHelpQuickAccess.js';\nimport './standalone/browser/quickAccess/standaloneGotoLineQuickAccess.js';\nimport './standalone/browser/quickAccess/standaloneGotoSymbolQuickAccess.js';\nimport './standalone/browser/quickAccess/standaloneCommandsQuickAccess.js';\nimport './standalone/browser/referenceSearch/standaloneReferenceSearch.js';\nimport './standalone/browser/toggleHighContrast/toggleHighContrast.js';\nexport * from './editor.api.js';\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { Extensions } from '../../../../platform/quickinput/common/quickAccess.js';\nimport { QuickHelpNLS } from '../../../common/standaloneStrings.js';\nimport { HelpQuickAccessProvider } from '../../../../platform/quickinput/browser/helpQuickAccess.js';\nRegistry.as(Extensions.Quickaccess).registerQuickAccessProvider({\n    ctor: HelpQuickAccessProvider,\n    prefix: '',\n    helpEntries: [{ description: QuickHelpNLS.helpQuickAccessActionLabel }]\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar HelpQuickAccessProvider_1;\nimport { localize } from '../../../nls.js';\nimport { Registry } from '../../registry/common/platform.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\nimport { Extensions } from '../common/quickAccess.js';\nimport { IQuickInputService } from '../common/quickInput.js';\nlet HelpQuickAccessProvider = HelpQuickAccessProvider_1 = class HelpQuickAccessProvider {\n    constructor(quickInputService, keybindingService) {\n        this.quickInputService = quickInputService;\n        this.keybindingService = keybindingService;\n        this.registry = Registry.as(Extensions.Quickaccess);\n    }\n    provide(picker) {\n        const disposables = new DisposableStore();\n        // Open a picker with the selected value if picked\n        disposables.add(picker.onDidAccept(() => {\n            const [item] = picker.selectedItems;\n            if (item) {\n                this.quickInputService.quickAccess.show(item.prefix, { preserveValue: true });\n            }\n        }));\n        // Also open a picker when we detect the user typed the exact\n        // name of a provider (e.g. `?term` for terminals)\n        disposables.add(picker.onDidChangeValue(value => {\n            const providerDescriptor = this.registry.getQuickAccessProvider(value.substr(HelpQuickAccessProvider_1.PREFIX.length));\n            if (providerDescriptor && providerDescriptor.prefix && providerDescriptor.prefix !== HelpQuickAccessProvider_1.PREFIX) {\n                this.quickInputService.quickAccess.show(providerDescriptor.prefix, { preserveValue: true });\n            }\n        }));\n        // Fill in all providers\n        picker.items = this.getQuickAccessProviders().filter(p => p.prefix !== HelpQuickAccessProvider_1.PREFIX);\n        return disposables;\n    }\n    getQuickAccessProviders() {\n        const providers = this.registry\n            .getQuickAccessProviders()\n            .sort((providerA, providerB) => providerA.prefix.localeCompare(providerB.prefix))\n            .flatMap(provider => this.createPicks(provider));\n        return providers;\n    }\n    createPicks(provider) {\n        return provider.helpEntries.map(helpEntry => {\n            const prefix = helpEntry.prefix || provider.prefix;\n            const label = prefix || '\\u2026' /* ... */;\n            return {\n                prefix,\n                label,\n                keybinding: helpEntry.commandId ? this.keybindingService.lookupKeybinding(helpEntry.commandId) : undefined,\n                ariaLabel: localize('helpPickAriaLabel', \"{0}, {1}\", label, helpEntry.description),\n                description: helpEntry.description\n            };\n        });\n    }\n};\nHelpQuickAccessProvider.PREFIX = '?';\nHelpQuickAccessProvider = HelpQuickAccessProvider_1 = __decorate([\n    __param(0, IQuickInputService),\n    __param(1, IKeybindingService)\n], HelpQuickAccessProvider);\nexport { HelpQuickAccessProvider };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor } from '../../../browser/editorBrowser.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nexport class AbstractGotoLineQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor() {\n        super({ canAcceptInBackground: true });\n    }\n    provideWithoutTextEditor(picker) {\n        const label = localize('cannotRunGotoLine', \"Open a text editor first to go to a line.\");\n        picker.items = [{ label }];\n        picker.ariaLabel = label;\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto line once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item) {\n                if (!this.isValidLineNumber(editor, item.lineNumber)) {\n                    return;\n                }\n                this.gotoLocation(context, { range: this.toRange(item.lineNumber, item.column), keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // React to picker changes\n        const updatePickerAndEditor = () => {\n            const position = this.parsePosition(editor, picker.value.trim().substr(AbstractGotoLineQuickAccessProvider.PREFIX.length));\n            const label = this.getPickLabel(editor, position.lineNumber, position.column);\n            // Picker\n            picker.items = [{\n                    lineNumber: position.lineNumber,\n                    column: position.column,\n                    label\n                }];\n            // ARIA Label\n            picker.ariaLabel = label;\n            // Clear decorations for invalid range\n            if (!this.isValidLineNumber(editor, position.lineNumber)) {\n                this.clearDecorations(editor);\n                return;\n            }\n            // Reveal\n            const range = this.toRange(position.lineNumber, position.column);\n            editor.revealRangeInCenter(range, 0 /* ScrollType.Smooth */);\n            // Decorate\n            this.addDecorations(editor, range);\n        };\n        updatePickerAndEditor();\n        disposables.add(picker.onDidChangeValue(() => updatePickerAndEditor()));\n        // Adjust line number visibility as needed\n        const codeEditor = getCodeEditor(editor);\n        if (codeEditor) {\n            const options = codeEditor.getOptions();\n            const lineNumbers = options.get(68 /* EditorOption.lineNumbers */);\n            if (lineNumbers.renderType === 2 /* RenderLineNumbersType.Relative */) {\n                codeEditor.updateOptions({ lineNumbers: 'on' });\n                disposables.add(toDisposable(() => codeEditor.updateOptions({ lineNumbers: 'relative' })));\n            }\n        }\n        return disposables;\n    }\n    toRange(lineNumber = 1, column = 1) {\n        return {\n            startLineNumber: lineNumber,\n            startColumn: column,\n            endLineNumber: lineNumber,\n            endColumn: column\n        };\n    }\n    parsePosition(editor, value) {\n        // Support line-col formats of `line,col`, `line:col`, `line#col`\n        const numbers = value.split(/,|:|#/).map(part => parseInt(part, 10)).filter(part => !isNaN(part));\n        const endLine = this.lineCount(editor) + 1;\n        return {\n            lineNumber: numbers[0] > 0 ? numbers[0] : endLine + numbers[0],\n            column: numbers[1]\n        };\n    }\n    getPickLabel(editor, lineNumber, column) {\n        // Location valid: indicate this as picker label\n        if (this.isValidLineNumber(editor, lineNumber)) {\n            if (this.isValidColumn(editor, lineNumber, column)) {\n                return localize('gotoLineColumnLabel', \"Go to line {0} and character {1}.\", lineNumber, column);\n            }\n            return localize('gotoLineLabel', \"Go to line {0}.\", lineNumber);\n        }\n        // Location invalid: show generic label\n        const position = editor.getPosition() || { lineNumber: 1, column: 1 };\n        const lineCount = this.lineCount(editor);\n        if (lineCount > 1) {\n            return localize('gotoLineLabelEmptyWithLimit', \"Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.\", position.lineNumber, position.column, lineCount);\n        }\n        return localize('gotoLineLabelEmpty', \"Current Line: {0}, Character: {1}. Type a line number to navigate to.\", position.lineNumber, position.column);\n    }\n    isValidLineNumber(editor, lineNumber) {\n        if (!lineNumber || typeof lineNumber !== 'number') {\n            return false;\n        }\n        return lineNumber > 0 && lineNumber <= this.lineCount(editor);\n    }\n    isValidColumn(editor, lineNumber, column) {\n        if (!column || typeof column !== 'number') {\n            return false;\n        }\n        const model = this.getModel(editor);\n        if (!model) {\n            return false;\n        }\n        const positionCandidate = { lineNumber, column };\n        return model.validatePosition(positionCandidate).equals(positionCandidate);\n    }\n    lineCount(editor) {\n        var _a, _b;\n        return (_b = (_a = this.getModel(editor)) === null || _a === void 0 ? void 0 : _a.getLineCount()) !== null && _b !== void 0 ? _b : 0;\n    }\n}\nAbstractGotoLineQuickAccessProvider.PREFIX = ':';\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createSingleCallFunction } from '../../../../base/common/functional.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor, isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\n/**\n * A reusable quick access provider for the editor with support\n * for adding decorations for navigating in the currently active file\n * (for example \"Go to line\", \"Go to symbol\").\n */\nexport class AbstractEditorNavigationQuickAccessProvider {\n    constructor(options) {\n        this.options = options;\n        //#endregion\n        //#region Decorations Utils\n        this.rangeHighlightDecorationId = undefined;\n    }\n    //#region Provider methods\n    provide(picker, token) {\n        var _a;\n        const disposables = new DisposableStore();\n        // Apply options if any\n        picker.canAcceptInBackground = !!((_a = this.options) === null || _a === void 0 ? void 0 : _a.canAcceptInBackground);\n        // Disable filtering & sorting, we control the results\n        picker.matchOnLabel = picker.matchOnDescription = picker.matchOnDetail = picker.sortByLabel = false;\n        // Provide based on current active editor\n        const pickerDisposable = disposables.add(new MutableDisposable());\n        pickerDisposable.value = this.doProvide(picker, token);\n        // Re-create whenever the active editor changes\n        disposables.add(this.onDidActiveTextEditorControlChange(() => {\n            // Clear old\n            pickerDisposable.value = undefined;\n            // Add new\n            pickerDisposable.value = this.doProvide(picker, token);\n        }));\n        return disposables;\n    }\n    doProvide(picker, token) {\n        var _a;\n        const disposables = new DisposableStore();\n        // With text control\n        const editor = this.activeTextEditorControl;\n        if (editor && this.canProvideWithTextEditor(editor)) {\n            const context = { editor };\n            // Restore any view state if this picker was closed\n            // without actually going to a line\n            const codeEditor = getCodeEditor(editor);\n            if (codeEditor) {\n                // Remember view state and update it when the cursor position\n                // changes even later because it could be that the user has\n                // configured quick access to remain open when focus is lost and\n                // we always want to restore the current location.\n                let lastKnownEditorViewState = (_a = editor.saveViewState()) !== null && _a !== void 0 ? _a : undefined;\n                disposables.add(codeEditor.onDidChangeCursorPosition(() => {\n                    var _a;\n                    lastKnownEditorViewState = (_a = editor.saveViewState()) !== null && _a !== void 0 ? _a : undefined;\n                }));\n                context.restoreViewState = () => {\n                    if (lastKnownEditorViewState && editor === this.activeTextEditorControl) {\n                        editor.restoreViewState(lastKnownEditorViewState);\n                    }\n                };\n                disposables.add(createSingleCallFunction(token.onCancellationRequested)(() => { var _a; return (_a = context.restoreViewState) === null || _a === void 0 ? void 0 : _a.call(context); }));\n            }\n            // Clean up decorations on dispose\n            disposables.add(toDisposable(() => this.clearDecorations(editor)));\n            // Ask subclass for entries\n            disposables.add(this.provideWithTextEditor(context, picker, token));\n        }\n        // Without text control\n        else {\n            disposables.add(this.provideWithoutTextEditor(picker, token));\n        }\n        return disposables;\n    }\n    /**\n     * Subclasses to implement if they can operate on the text editor.\n     */\n    canProvideWithTextEditor(editor) {\n        return true;\n    }\n    gotoLocation({ editor }, options) {\n        editor.setSelection(options.range);\n        editor.revealRangeInCenter(options.range, 0 /* ScrollType.Smooth */);\n        if (!options.preserveFocus) {\n            editor.focus();\n        }\n        const model = editor.getModel();\n        if (model && 'getLineContent' in model) {\n            status(`${model.getLineContent(options.range.startLineNumber)}`);\n        }\n    }\n    getModel(editor) {\n        var _a;\n        return isDiffEditor(editor) ?\n            (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.modified :\n            editor.getModel();\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            // Reset old decorations if any\n            const deleteDecorations = [];\n            if (this.rangeHighlightDecorationId) {\n                deleteDecorations.push(this.rangeHighlightDecorationId.overviewRulerDecorationId);\n                deleteDecorations.push(this.rangeHighlightDecorationId.rangeHighlightId);\n                this.rangeHighlightDecorationId = undefined;\n            }\n            // Add new decorations for the range\n            const newDecorations = [\n                // highlight the entire line on the range\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                // also add overview ruler highlight\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ];\n            const [rangeHighlightId, overviewRulerDecorationId] = changeAccessor.deltaDecorations(deleteDecorations, newDecorations);\n            this.rangeHighlightDecorationId = { rangeHighlightId, overviewRulerDecorationId };\n        });\n    }\n    clearDecorations(editor) {\n        const rangeHighlightDecorationId = this.rangeHighlightDecorationId;\n        if (rangeHighlightDecorationId) {\n            editor.changeDecorations(changeAccessor => {\n                changeAccessor.deltaDecorations([\n                    rangeHighlightDecorationId.overviewRulerDecorationId,\n                    rangeHighlightDecorationId.rangeHighlightId\n                ], []);\n            });\n            this.rangeHighlightDecorationId = undefined;\n        }\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { AbstractGotoLineQuickAccessProvider } from '../../../contrib/quickAccess/browser/gotoLineQuickAccess.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { Extensions } from '../../../../platform/quickinput/common/quickAccess.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { GoToLineNLS } from '../../../common/standaloneStrings.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nlet StandaloneGotoLineQuickAccessProvider = class StandaloneGotoLineQuickAccessProvider extends AbstractGotoLineQuickAccessProvider {\n    constructor(editorService) {\n        super();\n        this.editorService = editorService;\n        this.onDidActiveTextEditorControlChange = Event.None;\n    }\n    get activeTextEditorControl() {\n        var _a;\n        return (_a = this.editorService.getFocusedCodeEditor()) !== null && _a !== void 0 ? _a : undefined;\n    }\n};\nStandaloneGotoLineQuickAccessProvider = __decorate([\n    __param(0, ICodeEditorService)\n], StandaloneGotoLineQuickAccessProvider);\nexport { StandaloneGotoLineQuickAccessProvider };\nexport class GotoLineAction extends EditorAction {\n    constructor() {\n        super({\n            id: GotoLineAction.ID,\n            label: GoToLineNLS.gotoLineActionLabel,\n            alias: 'Go to Line/Column...',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 37 /* KeyCode.KeyG */,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 37 /* KeyCode.KeyG */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor) {\n        accessor.get(IQuickInputService).quickAccess.show(StandaloneGotoLineQuickAccessProvider.PREFIX);\n    }\n}\nGotoLineAction.ID = 'editor.action.gotoLine';\nregisterEditorAction(GotoLineAction);\nRegistry.as(Extensions.Quickaccess).registerQuickAccessProvider({\n    ctor: StandaloneGotoLineQuickAccessProvider,\n    prefix: StandaloneGotoLineQuickAccessProvider.PREFIX,\n    helpEntries: [{ description: GoToLineNLS.gotoLineActionLabel, commandId: GotoLineAction.ID }]\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar AbstractGotoSymbolQuickAccessProvider_1;\nimport { DeferredPromise } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { pieceToQuery, prepareQuery, scoreFuzzy2 } from '../../../../base/common/fuzzyScorer.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { format, trim } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SymbolKinds, getAriaLabelForSymbol } from '../../../common/languages.js';\nimport { IOutlineModelService } from '../../documentSymbols/browser/outlineModel.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { findLast } from '../../../../base/common/arraysFind.js';\nlet AbstractGotoSymbolQuickAccessProvider = AbstractGotoSymbolQuickAccessProvider_1 = class AbstractGotoSymbolQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor(_languageFeaturesService, _outlineModelService, options = Object.create(null)) {\n        super(options);\n        this._languageFeaturesService = _languageFeaturesService;\n        this._outlineModelService = _outlineModelService;\n        this.options = options;\n        this.options.canAcceptInBackground = true;\n    }\n    provideWithoutTextEditor(picker) {\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutEditor', \"To go to a symbol, first open a text editor with symbol information.\"));\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const model = this.getModel(editor);\n        if (!model) {\n            return Disposable.None;\n        }\n        // Provide symbols from model if available in registry\n        if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n            return this.doProvideWithEditorSymbols(context, model, picker, token);\n        }\n        // Otherwise show an entry for a model without registry\n        // But give a chance to resolve the symbols at a later\n        // point if possible\n        return this.doProvideWithoutEditorSymbols(context, model, picker, token);\n    }\n    doProvideWithoutEditorSymbols(context, model, picker, token) {\n        const disposables = new DisposableStore();\n        // Generic pick for not having any symbol information\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutSymbolProvider', \"The active text editor does not provide symbol information.\"));\n        // Wait for changes to the registry and see if eventually\n        // we do get symbols. This can happen if the picker is opened\n        // very early after the model has loaded but before the\n        // language registry is ready.\n        // https://github.com/microsoft/vscode/issues/70607\n        (async () => {\n            const result = await this.waitForLanguageSymbolRegistry(model, disposables);\n            if (!result || token.isCancellationRequested) {\n                return;\n            }\n            disposables.add(this.doProvideWithEditorSymbols(context, model, picker, token));\n        })();\n        return disposables;\n    }\n    provideLabelPick(picker, label) {\n        picker.items = [{ label, index: 0, kind: 14 /* SymbolKind.String */ }];\n        picker.ariaLabel = label;\n    }\n    async waitForLanguageSymbolRegistry(model, disposables) {\n        if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n            return true;\n        }\n        const symbolProviderRegistryPromise = new DeferredPromise();\n        // Resolve promise when registry knows model\n        const symbolProviderListener = disposables.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => {\n            if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                symbolProviderListener.dispose();\n                symbolProviderRegistryPromise.complete(true);\n            }\n        }));\n        // Resolve promise when we get disposed too\n        disposables.add(toDisposable(() => symbolProviderRegistryPromise.complete(false)));\n        return symbolProviderRegistryPromise.p;\n    }\n    doProvideWithEditorSymbols(context, model, picker, token) {\n        var _a;\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto symbol once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // Goto symbol side by side if enabled\n        disposables.add(picker.onDidTriggerItemButton(({ item }) => {\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, forceSideBySide: true });\n                picker.hide();\n            }\n        }));\n        // Resolve symbols from document once and reuse this\n        // request for all filtering and typing then on\n        const symbolsPromise = this.getDocumentSymbols(model, token);\n        // Set initial picks and update on type\n        let picksCts = undefined;\n        const updatePickerItems = async (positionToEnclose) => {\n            // Cancel any previous ask for picks and busy\n            picksCts === null || picksCts === void 0 ? void 0 : picksCts.dispose(true);\n            picker.busy = false;\n            // Create new cancellation source for this run\n            picksCts = new CancellationTokenSource(token);\n            // Collect symbol picks\n            picker.busy = true;\n            try {\n                const query = prepareQuery(picker.value.substr(AbstractGotoSymbolQuickAccessProvider_1.PREFIX.length).trim());\n                const items = await this.doGetSymbolPicks(symbolsPromise, query, undefined, picksCts.token);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                if (items.length > 0) {\n                    picker.items = items;\n                    if (positionToEnclose && query.original.length === 0) {\n                        const candidate = findLast(items, item => Boolean(item.type !== 'separator' && item.range && Range.containsPosition(item.range.decoration, positionToEnclose)));\n                        if (candidate) {\n                            picker.activeItems = [candidate];\n                        }\n                    }\n                }\n                else {\n                    if (query.original.length > 0) {\n                        this.provideLabelPick(picker, localize('noMatchingSymbolResults', \"No matching editor symbols\"));\n                    }\n                    else {\n                        this.provideLabelPick(picker, localize('noSymbolResults', \"No editor symbols\"));\n                    }\n                }\n            }\n            finally {\n                if (!token.isCancellationRequested) {\n                    picker.busy = false;\n                }\n            }\n        };\n        disposables.add(picker.onDidChangeValue(() => updatePickerItems(undefined)));\n        updatePickerItems((_a = editor.getSelection()) === null || _a === void 0 ? void 0 : _a.getPosition());\n        // Reveal and decorate when active item changes\n        disposables.add(picker.onDidChangeActive(() => {\n            const [item] = picker.activeItems;\n            if (item && item.range) {\n                // Reveal\n                editor.revealRangeInCenter(item.range.selection, 0 /* ScrollType.Smooth */);\n                // Decorate\n                this.addDecorations(editor, item.range.decoration);\n            }\n        }));\n        return disposables;\n    }\n    async doGetSymbolPicks(symbolsPromise, query, options, token) {\n        var _a, _b;\n        const symbols = await symbolsPromise;\n        if (token.isCancellationRequested) {\n            return [];\n        }\n        const filterBySymbolKind = query.original.indexOf(AbstractGotoSymbolQuickAccessProvider_1.SCOPE_PREFIX) === 0;\n        const filterPos = filterBySymbolKind ? 1 : 0;\n        // Split between symbol and container query\n        let symbolQuery;\n        let containerQuery;\n        if (query.values && query.values.length > 1) {\n            symbolQuery = pieceToQuery(query.values[0]); // symbol: only match on first part\n            containerQuery = pieceToQuery(query.values.slice(1)); // container: match on all but first parts\n        }\n        else {\n            symbolQuery = query;\n        }\n        // Convert to symbol picks and apply filtering\n        let buttons;\n        const openSideBySideDirection = (_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.openSideBySideDirection) === null || _b === void 0 ? void 0 : _b.call(_a);\n        if (openSideBySideDirection) {\n            buttons = [{\n                    iconClass: openSideBySideDirection === 'right' ? ThemeIcon.asClassName(Codicon.splitHorizontal) : ThemeIcon.asClassName(Codicon.splitVertical),\n                    tooltip: openSideBySideDirection === 'right' ? localize('openToSide', \"Open to the Side\") : localize('openToBottom', \"Open to the Bottom\")\n                }];\n        }\n        const filteredSymbolPicks = [];\n        for (let index = 0; index < symbols.length; index++) {\n            const symbol = symbols[index];\n            const symbolLabel = trim(symbol.name);\n            const symbolLabelWithIcon = `$(${SymbolKinds.toIcon(symbol.kind).id}) ${symbolLabel}`;\n            const symbolLabelIconOffset = symbolLabelWithIcon.length - symbolLabel.length;\n            let containerLabel = symbol.containerName;\n            if (options === null || options === void 0 ? void 0 : options.extraContainerLabel) {\n                if (containerLabel) {\n                    containerLabel = `${options.extraContainerLabel} \u2022 ${containerLabel}`;\n                }\n                else {\n                    containerLabel = options.extraContainerLabel;\n                }\n            }\n            let symbolScore = undefined;\n            let symbolMatches = undefined;\n            let containerScore = undefined;\n            let containerMatches = undefined;\n            if (query.original.length > filterPos) {\n                // First: try to score on the entire query, it is possible that\n                // the symbol matches perfectly (e.g. searching for \"change log\"\n                // can be a match on a markdown symbol \"change log\"). In that\n                // case we want to skip the container query altogether.\n                let skipContainerQuery = false;\n                if (symbolQuery !== query) {\n                    [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, { ...query, values: undefined /* disable multi-query support */ }, filterPos, symbolLabelIconOffset);\n                    if (typeof symbolScore === 'number') {\n                        skipContainerQuery = true; // since we consumed the query, skip any container matching\n                    }\n                }\n                // Otherwise: score on the symbol query and match on the container later\n                if (typeof symbolScore !== 'number') {\n                    [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, symbolQuery, filterPos, symbolLabelIconOffset);\n                    if (typeof symbolScore !== 'number') {\n                        continue;\n                    }\n                }\n                // Score by container if specified\n                if (!skipContainerQuery && containerQuery) {\n                    if (containerLabel && containerQuery.original.length > 0) {\n                        [containerScore, containerMatches] = scoreFuzzy2(containerLabel, containerQuery);\n                    }\n                    if (typeof containerScore !== 'number') {\n                        continue;\n                    }\n                    if (typeof symbolScore === 'number') {\n                        symbolScore += containerScore; // boost symbolScore by containerScore\n                    }\n                }\n            }\n            const deprecated = symbol.tags && symbol.tags.indexOf(1 /* SymbolTag.Deprecated */) >= 0;\n            filteredSymbolPicks.push({\n                index,\n                kind: symbol.kind,\n                score: symbolScore,\n                label: symbolLabelWithIcon,\n                ariaLabel: getAriaLabelForSymbol(symbol.name, symbol.kind),\n                description: containerLabel,\n                highlights: deprecated ? undefined : {\n                    label: symbolMatches,\n                    description: containerMatches\n                },\n                range: {\n                    selection: Range.collapseToStart(symbol.selectionRange),\n                    decoration: symbol.range\n                },\n                strikethrough: deprecated,\n                buttons\n            });\n        }\n        // Sort by score\n        const sortedFilteredSymbolPicks = filteredSymbolPicks.sort((symbolA, symbolB) => filterBySymbolKind ?\n            this.compareByKindAndScore(symbolA, symbolB) :\n            this.compareByScore(symbolA, symbolB));\n        // Add separator for types\n        // - @  only total number of symbols\n        // - @: grouped by symbol kind\n        let symbolPicks = [];\n        if (filterBySymbolKind) {\n            let lastSymbolKind = undefined;\n            let lastSeparator = undefined;\n            let lastSymbolKindCounter = 0;\n            function updateLastSeparatorLabel() {\n                if (lastSeparator && typeof lastSymbolKind === 'number' && lastSymbolKindCounter > 0) {\n                    lastSeparator.label = format(NLS_SYMBOL_KIND_CACHE[lastSymbolKind] || FALLBACK_NLS_SYMBOL_KIND, lastSymbolKindCounter);\n                }\n            }\n            for (const symbolPick of sortedFilteredSymbolPicks) {\n                // Found new kind\n                if (lastSymbolKind !== symbolPick.kind) {\n                    // Update last separator with number of symbols we found for kind\n                    updateLastSeparatorLabel();\n                    lastSymbolKind = symbolPick.kind;\n                    lastSymbolKindCounter = 1;\n                    // Add new separator for new kind\n                    lastSeparator = { type: 'separator' };\n                    symbolPicks.push(lastSeparator);\n                }\n                // Existing kind, keep counting\n                else {\n                    lastSymbolKindCounter++;\n                }\n                // Add to final result\n                symbolPicks.push(symbolPick);\n            }\n            // Update last separator with number of symbols we found for kind\n            updateLastSeparatorLabel();\n        }\n        else if (sortedFilteredSymbolPicks.length > 0) {\n            symbolPicks = [\n                { label: localize('symbols', \"symbols ({0})\", filteredSymbolPicks.length), type: 'separator' },\n                ...sortedFilteredSymbolPicks\n            ];\n        }\n        return symbolPicks;\n    }\n    compareByScore(symbolA, symbolB) {\n        if (typeof symbolA.score !== 'number' && typeof symbolB.score === 'number') {\n            return 1;\n        }\n        else if (typeof symbolA.score === 'number' && typeof symbolB.score !== 'number') {\n            return -1;\n        }\n        if (typeof symbolA.score === 'number' && typeof symbolB.score === 'number') {\n            if (symbolA.score > symbolB.score) {\n                return -1;\n            }\n            else if (symbolA.score < symbolB.score) {\n                return 1;\n            }\n        }\n        if (symbolA.index < symbolB.index) {\n            return -1;\n        }\n        else if (symbolA.index > symbolB.index) {\n            return 1;\n        }\n        return 0;\n    }\n    compareByKindAndScore(symbolA, symbolB) {\n        const kindA = NLS_SYMBOL_KIND_CACHE[symbolA.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        const kindB = NLS_SYMBOL_KIND_CACHE[symbolB.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        // Sort by type first if scoped search\n        const result = kindA.localeCompare(kindB);\n        if (result === 0) {\n            return this.compareByScore(symbolA, symbolB);\n        }\n        return result;\n    }\n    async getDocumentSymbols(document, token) {\n        const model = await this._outlineModelService.getOrCreate(document, token);\n        return token.isCancellationRequested ? [] : model.asListOfDocumentSymbols();\n    }\n};\nAbstractGotoSymbolQuickAccessProvider.PREFIX = '@';\nAbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX = ':';\nAbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY = `${AbstractGotoSymbolQuickAccessProvider_1.PREFIX}${AbstractGotoSymbolQuickAccessProvider_1.SCOPE_PREFIX}`;\nAbstractGotoSymbolQuickAccessProvider = AbstractGotoSymbolQuickAccessProvider_1 = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IOutlineModelService)\n], AbstractGotoSymbolQuickAccessProvider);\nexport { AbstractGotoSymbolQuickAccessProvider };\n// #region NLS Helpers\nconst FALLBACK_NLS_SYMBOL_KIND = localize('property', \"properties ({0})\");\nconst NLS_SYMBOL_KIND_CACHE = {\n    [5 /* SymbolKind.Method */]: localize('method', \"methods ({0})\"),\n    [11 /* SymbolKind.Function */]: localize('function', \"functions ({0})\"),\n    [8 /* SymbolKind.Constructor */]: localize('_constructor', \"constructors ({0})\"),\n    [12 /* SymbolKind.Variable */]: localize('variable', \"variables ({0})\"),\n    [4 /* SymbolKind.Class */]: localize('class', \"classes ({0})\"),\n    [22 /* SymbolKind.Struct */]: localize('struct', \"structs ({0})\"),\n    [23 /* SymbolKind.Event */]: localize('event', \"events ({0})\"),\n    [24 /* SymbolKind.Operator */]: localize('operator', \"operators ({0})\"),\n    [10 /* SymbolKind.Interface */]: localize('interface', \"interfaces ({0})\"),\n    [2 /* SymbolKind.Namespace */]: localize('namespace', \"namespaces ({0})\"),\n    [3 /* SymbolKind.Package */]: localize('package', \"packages ({0})\"),\n    [25 /* SymbolKind.TypeParameter */]: localize('typeParameter', \"type parameters ({0})\"),\n    [1 /* SymbolKind.Module */]: localize('modules', \"modules ({0})\"),\n    [6 /* SymbolKind.Property */]: localize('property', \"properties ({0})\"),\n    [9 /* SymbolKind.Enum */]: localize('enum', \"enumerations ({0})\"),\n    [21 /* SymbolKind.EnumMember */]: localize('enumMember', \"enumeration members ({0})\"),\n    [14 /* SymbolKind.String */]: localize('string', \"strings ({0})\"),\n    [0 /* SymbolKind.File */]: localize('file', \"files ({0})\"),\n    [17 /* SymbolKind.Array */]: localize('array', \"arrays ({0})\"),\n    [15 /* SymbolKind.Number */]: localize('number', \"numbers ({0})\"),\n    [16 /* SymbolKind.Boolean */]: localize('boolean', \"booleans ({0})\"),\n    [18 /* SymbolKind.Object */]: localize('object', \"objects ({0})\"),\n    [19 /* SymbolKind.Key */]: localize('key', \"keys ({0})\"),\n    [7 /* SymbolKind.Field */]: localize('field', \"fields ({0})\"),\n    [13 /* SymbolKind.Constant */]: localize('constant', \"constants ({0})\")\n};\n//#endregion\n", "import { createMatches as createFuzzyMatches, fuzzyScore } from './filters.js';\nimport { sep } from './path.js';\nimport { isWindows } from './platform.js';\nimport { stripWildcards } from './strings.js';\nconst NO_SCORE2 = [undefined, []];\nexport function scoreFuzzy2(target, query, patternStart = 0, wordStart = 0) {\n    // Score: multiple inputs\n    const preparedQuery = query;\n    if (preparedQuery.values && preparedQuery.values.length > 1) {\n        return doScoreFuzzy2Multiple(target, preparedQuery.values, patternStart, wordStart);\n    }\n    // Score: single input\n    return doScoreFuzzy2Single(target, query, patternStart, wordStart);\n}\nfunction doScoreFuzzy2Multiple(target, query, patternStart, wordStart) {\n    let totalScore = 0;\n    const totalMatches = [];\n    for (const queryPiece of query) {\n        const [score, matches] = doScoreFuzzy2Single(target, queryPiece, patternStart, wordStart);\n        if (typeof score !== 'number') {\n            // if a single query value does not match, return with\n            // no score entirely, we require all queries to match\n            return NO_SCORE2;\n        }\n        totalScore += score;\n        totalMatches.push(...matches);\n    }\n    // if we have a score, ensure that the positions are\n    // sorted in ascending order and distinct\n    return [totalScore, normalizeMatches(totalMatches)];\n}\nfunction doScoreFuzzy2Single(target, query, patternStart, wordStart) {\n    const score = fuzzyScore(query.original, query.originalLowercase, patternStart, target, target.toLowerCase(), wordStart, { firstMatchCanBeWeak: true, boostFullMatch: true });\n    if (!score) {\n        return NO_SCORE2;\n    }\n    return [score[0], createFuzzyMatches(score)];\n}\nconst NO_ITEM_SCORE = Object.freeze({ score: 0 });\nfunction normalizeMatches(matches) {\n    // sort matches by start to be able to normalize\n    const sortedMatches = matches.sort((matchA, matchB) => {\n        return matchA.start - matchB.start;\n    });\n    // merge matches that overlap\n    const normalizedMatches = [];\n    let currentMatch = undefined;\n    for (const match of sortedMatches) {\n        // if we have no current match or the matches\n        // do not overlap, we take it as is and remember\n        // it for future merging\n        if (!currentMatch || !matchOverlaps(currentMatch, match)) {\n            currentMatch = match;\n            normalizedMatches.push(match);\n        }\n        // otherwise we merge the matches\n        else {\n            currentMatch.start = Math.min(currentMatch.start, match.start);\n            currentMatch.end = Math.max(currentMatch.end, match.end);\n        }\n    }\n    return normalizedMatches;\n}\nfunction matchOverlaps(matchA, matchB) {\n    if (matchA.end < matchB.start) {\n        return false; // A ends before B starts\n    }\n    if (matchB.end < matchA.start) {\n        return false; // B ends before A starts\n    }\n    return true;\n}\n/*\n * If a query is wrapped in quotes, the user does not want to\n * use fuzzy search for this query.\n */\nfunction queryExpectsExactMatch(query) {\n    return query.startsWith('\"') && query.endsWith('\"');\n}\n/**\n * Helper function to prepare a search value for scoring by removing unwanted characters\n * and allowing to score on multiple pieces separated by whitespace character.\n */\nconst MULTIPLE_QUERY_VALUES_SEPARATOR = ' ';\nexport function prepareQuery(original) {\n    if (typeof original !== 'string') {\n        original = '';\n    }\n    const originalLowercase = original.toLowerCase();\n    const { pathNormalized, normalized, normalizedLowercase } = normalizeQuery(original);\n    const containsPathSeparator = pathNormalized.indexOf(sep) >= 0;\n    const expectExactMatch = queryExpectsExactMatch(original);\n    let values = undefined;\n    const originalSplit = original.split(MULTIPLE_QUERY_VALUES_SEPARATOR);\n    if (originalSplit.length > 1) {\n        for (const originalPiece of originalSplit) {\n            const expectExactMatchPiece = queryExpectsExactMatch(originalPiece);\n            const { pathNormalized: pathNormalizedPiece, normalized: normalizedPiece, normalizedLowercase: normalizedLowercasePiece } = normalizeQuery(originalPiece);\n            if (normalizedPiece) {\n                if (!values) {\n                    values = [];\n                }\n                values.push({\n                    original: originalPiece,\n                    originalLowercase: originalPiece.toLowerCase(),\n                    pathNormalized: pathNormalizedPiece,\n                    normalized: normalizedPiece,\n                    normalizedLowercase: normalizedLowercasePiece,\n                    expectContiguousMatch: expectExactMatchPiece\n                });\n            }\n        }\n    }\n    return { original, originalLowercase, pathNormalized, normalized, normalizedLowercase, values, containsPathSeparator, expectContiguousMatch: expectExactMatch };\n}\nfunction normalizeQuery(original) {\n    let pathNormalized;\n    if (isWindows) {\n        pathNormalized = original.replace(/\\//g, sep); // Help Windows users to search for paths when using slash\n    }\n    else {\n        pathNormalized = original.replace(/\\\\/g, sep); // Help macOS/Linux users to search for paths when using backslash\n    }\n    // we remove quotes here because quotes are used for exact match search\n    const normalized = stripWildcards(pathNormalized).replace(/\\s|\"/g, '');\n    return {\n        pathNormalized,\n        normalized,\n        normalizedLowercase: normalized.toLowerCase()\n    };\n}\nexport function pieceToQuery(arg1) {\n    if (Array.isArray(arg1)) {\n        return prepareQuery(arg1.map(piece => piece.original).join(MULTIPLE_QUERY_VALUES_SEPARATOR));\n    }\n    return prepareQuery(arg1.original);\n}\n//#endregion\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport '../../../contrib/symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport { AbstractGotoSymbolQuickAccessProvider } from '../../../contrib/quickAccess/browser/gotoSymbolQuickAccess.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { Extensions } from '../../../../platform/quickinput/common/quickAccess.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { QuickOutlineNLS } from '../../../common/standaloneStrings.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IQuickInputService, ItemActivation } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IOutlineModelService } from '../../../contrib/documentSymbols/browser/outlineModel.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nlet StandaloneGotoSymbolQuickAccessProvider = class StandaloneGotoSymbolQuickAccessProvider extends AbstractGotoSymbolQuickAccessProvider {\n    constructor(editorService, languageFeaturesService, outlineModelService) {\n        super(languageFeaturesService, outlineModelService);\n        this.editorService = editorService;\n        this.onDidActiveTextEditorControlChange = Event.None;\n    }\n    get activeTextEditorControl() {\n        var _a;\n        return (_a = this.editorService.getFocusedCodeEditor()) !== null && _a !== void 0 ? _a : undefined;\n    }\n};\nStandaloneGotoSymbolQuickAccessProvider = __decorate([\n    __param(0, ICodeEditorService),\n    __param(1, ILanguageFeaturesService),\n    __param(2, IOutlineModelService)\n], StandaloneGotoSymbolQuickAccessProvider);\nexport { StandaloneGotoSymbolQuickAccessProvider };\nexport class GotoSymbolAction extends EditorAction {\n    constructor() {\n        super({\n            id: GotoSymbolAction.ID,\n            label: QuickOutlineNLS.quickOutlineActionLabel,\n            alias: 'Go to Symbol...',\n            precondition: EditorContextKeys.hasDocumentSymbolProvider,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 45 /* KeyCode.KeyO */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: 'navigation',\n                order: 3\n            }\n        });\n    }\n    run(accessor) {\n        accessor.get(IQuickInputService).quickAccess.show(AbstractGotoSymbolQuickAccessProvider.PREFIX, { itemActivation: ItemActivation.NONE });\n    }\n}\nGotoSymbolAction.ID = 'editor.action.quickOutline';\nregisterEditorAction(GotoSymbolAction);\nRegistry.as(Extensions.Quickaccess).registerQuickAccessProvider({\n    ctor: StandaloneGotoSymbolQuickAccessProvider,\n    prefix: AbstractGotoSymbolQuickAccessProvider.PREFIX,\n    helpEntries: [\n        { description: QuickOutlineNLS.quickOutlineActionLabel, prefix: AbstractGotoSymbolQuickAccessProvider.PREFIX, commandId: GotoSymbolAction.ID },\n        { description: QuickOutlineNLS.quickOutlineByCategoryActionLabel, prefix: AbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY }\n    ]\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { Extensions } from '../../../../platform/quickinput/common/quickAccess.js';\nimport { QuickCommandNLS } from '../../../common/standaloneStrings.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { AbstractEditorCommandsQuickAccessProvider } from '../../../contrib/quickAccess/browser/commandsQuickAccess.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nlet StandaloneCommandsQuickAccessProvider = class StandaloneCommandsQuickAccessProvider extends AbstractEditorCommandsQuickAccessProvider {\n    get activeTextEditorControl() { var _a; return (_a = this.codeEditorService.getFocusedCodeEditor()) !== null && _a !== void 0 ? _a : undefined; }\n    constructor(instantiationService, codeEditorService, keybindingService, commandService, telemetryService, dialogService) {\n        super({ showAlias: false }, instantiationService, keybindingService, commandService, telemetryService, dialogService);\n        this.codeEditorService = codeEditorService;\n    }\n    async getCommandPicks() {\n        return this.getCodeEditorCommandPicks();\n    }\n    hasAdditionalCommandPicks() {\n        return false;\n    }\n    async getAdditionalCommandPicks() {\n        return [];\n    }\n};\nStandaloneCommandsQuickAccessProvider = __decorate([\n    __param(0, IInstantiationService),\n    __param(1, ICodeEditorService),\n    __param(2, IKeybindingService),\n    __param(3, ICommandService),\n    __param(4, ITelemetryService),\n    __param(5, IDialogService)\n], StandaloneCommandsQuickAccessProvider);\nexport { StandaloneCommandsQuickAccessProvider };\nexport class GotoLineAction extends EditorAction {\n    constructor() {\n        super({\n            id: GotoLineAction.ID,\n            label: QuickCommandNLS.quickCommandActionLabel,\n            alias: 'Command Palette',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 59 /* KeyCode.F1 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: 'z_commands',\n                order: 1\n            }\n        });\n    }\n    run(accessor) {\n        accessor.get(IQuickInputService).quickAccess.show(StandaloneCommandsQuickAccessProvider.PREFIX);\n    }\n}\nGotoLineAction.ID = 'editor.action.quickCommand';\nregisterEditorAction(GotoLineAction);\nRegistry.as(Extensions.Quickaccess).registerQuickAccessProvider({\n    ctor: StandaloneCommandsQuickAccessProvider,\n    prefix: StandaloneCommandsQuickAccessProvider.PREFIX,\n    helpEntries: [{ description: QuickCommandNLS.quickCommandHelp, commandId: GotoLineAction.ID }]\n});\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { stripIcons } from '../../../../base/common/iconLabels.js';\nimport { AbstractCommandsQuickAccessProvider } from '../../../../platform/quickinput/browser/commandsQuickAccess.js';\nexport class AbstractEditorCommandsQuickAccessProvider extends AbstractCommandsQuickAccessProvider {\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\n        super(options, instantiationService, keybindingService, commandService, telemetryService, dialogService);\n    }\n    getCodeEditorCommandPicks() {\n        const activeTextEditorControl = this.activeTextEditorControl;\n        if (!activeTextEditorControl) {\n            return [];\n        }\n        const editorCommandPicks = [];\n        for (const editorAction of activeTextEditorControl.getSupportedActions()) {\n            editorCommandPicks.push({\n                commandId: editorAction.id,\n                commandAlias: editorAction.alias,\n                label: stripIcons(editorAction.label) || editorAction.id,\n            });\n        }\n        return editorCommandPicks;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as arrays from './arrays.js';\nimport * as types from './types.js';\nimport * as nls from '../../nls.js';\nfunction exceptionToErrorMessage(exception, verbose) {\n    if (verbose && (exception.stack || exception.stacktrace)) {\n        return nls.localize('stackTrace.format', \"{0}: {1}\", detectSystemErrorMessage(exception), stackToString(exception.stack) || stackToString(exception.stacktrace));\n    }\n    return detectSystemErrorMessage(exception);\n}\nfunction stackToString(stack) {\n    if (Array.isArray(stack)) {\n        return stack.join('\\n');\n    }\n    return stack;\n}\nfunction detectSystemErrorMessage(exception) {\n    // Custom node.js error from us\n    if (exception.code === 'ERR_UNC_HOST_NOT_ALLOWED') {\n        return `${exception.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`;\n    }\n    // See https://nodejs.org/api/errors.html#errors_class_system_error\n    if (typeof exception.code === 'string' && typeof exception.errno === 'number' && typeof exception.syscall === 'string') {\n        return nls.localize('nodeExceptionMessage', \"A system error occurred ({0})\", exception.message);\n    }\n    return exception.message || nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\n}\n/**\n * Tries to generate a human readable error message out of the error. If the verbose parameter\n * is set to true, the error message will include stacktrace details if provided.\n *\n * @returns A string containing the error message.\n */\nexport function toErrorMessage(error = null, verbose = false) {\n    if (!error) {\n        return nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\n    }\n    if (Array.isArray(error)) {\n        const errors = arrays.coalesce(error);\n        const msg = toErrorMessage(errors[0], verbose);\n        if (errors.length > 1) {\n            return nls.localize('error.moreErrors', \"{0} ({1} errors in total)\", msg, errors.length);\n        }\n        return msg;\n    }\n    if (types.isString(error)) {\n        return error;\n    }\n    if (error.detail) {\n        const detail = error.detail;\n        if (detail.error) {\n            return exceptionToErrorMessage(detail.error, verbose);\n        }\n        if (detail.exception) {\n            return exceptionToErrorMessage(detail.exception, verbose);\n        }\n    }\n    if (error.stack) {\n        return exceptionToErrorMessage(error, verbose);\n    }\n    if (error.message) {\n        return error.message;\n    }\n    return nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar AbstractCommandsQuickAccessProvider_1, CommandsHistory_1;\nimport { toErrorMessage } from '../../../base/common/errorMessage.js';\nimport { isCancellationError } from '../../../base/common/errors.js';\nimport { matchesContiguousSubString, matchesPrefix, matchesWords, or } from '../../../base/common/filters.js';\nimport { createSingleCallFunction } from '../../../base/common/functional.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../base/common/map.js';\nimport { TfIdfCalculator, normalizeTfIdfScores } from '../../../base/common/tfIdf.js';\nimport { localize } from '../../../nls.js';\nimport { ICommandService } from '../../commands/common/commands.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IDialogService } from '../../dialogs/common/dialogs.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\nimport { PickerQuickAccessProvider } from './pickerQuickAccess.js';\nimport { IStorageService, WillSaveStateReason } from '../../storage/common/storage.js';\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\nlet AbstractCommandsQuickAccessProvider = AbstractCommandsQuickAccessProvider_1 = class AbstractCommandsQuickAccessProvider extends PickerQuickAccessProvider {\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\n        super(AbstractCommandsQuickAccessProvider_1.PREFIX, options);\n        this.instantiationService = instantiationService;\n        this.keybindingService = keybindingService;\n        this.commandService = commandService;\n        this.telemetryService = telemetryService;\n        this.dialogService = dialogService;\n        this.commandsHistory = this._register(this.instantiationService.createInstance(CommandsHistory));\n        this.options = options;\n    }\n    async _getPicks(filter, _disposables, token, runOptions) {\n        var _a, _b, _c, _d;\n        // Ask subclass for all command picks\n        const allCommandPicks = await this.getCommandPicks(token);\n        if (token.isCancellationRequested) {\n            return [];\n        }\n        const runTfidf = createSingleCallFunction(() => {\n            const tfidf = new TfIdfCalculator();\n            tfidf.updateDocuments(allCommandPicks.map(commandPick => ({\n                key: commandPick.commandId,\n                textChunks: [this.getTfIdfChunk(commandPick)]\n            })));\n            const result = tfidf.calculateScores(filter, token);\n            return normalizeTfIdfScores(result)\n                .filter(score => score.score > AbstractCommandsQuickAccessProvider_1.TFIDF_THRESHOLD)\n                .slice(0, AbstractCommandsQuickAccessProvider_1.TFIDF_MAX_RESULTS);\n        });\n        // Filter\n        const filteredCommandPicks = [];\n        for (const commandPick of allCommandPicks) {\n            const labelHighlights = (_a = AbstractCommandsQuickAccessProvider_1.WORD_FILTER(filter, commandPick.label)) !== null && _a !== void 0 ? _a : undefined;\n            const aliasHighlights = commandPick.commandAlias ? (_b = AbstractCommandsQuickAccessProvider_1.WORD_FILTER(filter, commandPick.commandAlias)) !== null && _b !== void 0 ? _b : undefined : undefined;\n            // Add if matching in label or alias\n            if (labelHighlights || aliasHighlights) {\n                commandPick.highlights = {\n                    label: labelHighlights,\n                    detail: this.options.showAlias ? aliasHighlights : undefined\n                };\n                filteredCommandPicks.push(commandPick);\n            }\n            // Also add if we have a 100% command ID match\n            else if (filter === commandPick.commandId) {\n                filteredCommandPicks.push(commandPick);\n            }\n            // Handle tf-idf scoring for the rest if there's a filter\n            else if (filter.length >= 3) {\n                const tfidf = runTfidf();\n                if (token.isCancellationRequested) {\n                    return [];\n                }\n                // Add if we have a tf-idf score\n                const tfidfScore = tfidf.find(score => score.key === commandPick.commandId);\n                if (tfidfScore) {\n                    commandPick.tfIdfScore = tfidfScore.score;\n                    filteredCommandPicks.push(commandPick);\n                }\n            }\n        }\n        // Add description to commands that have duplicate labels\n        const mapLabelToCommand = new Map();\n        for (const commandPick of filteredCommandPicks) {\n            const existingCommandForLabel = mapLabelToCommand.get(commandPick.label);\n            if (existingCommandForLabel) {\n                commandPick.description = commandPick.commandId;\n                existingCommandForLabel.description = existingCommandForLabel.commandId;\n            }\n            else {\n                mapLabelToCommand.set(commandPick.label, commandPick);\n            }\n        }\n        // Sort by MRU order and fallback to name otherwise\n        filteredCommandPicks.sort((commandPickA, commandPickB) => {\n            // If a result came from tf-idf, we want to put that towards the bottom\n            if (commandPickA.tfIdfScore && commandPickB.tfIdfScore) {\n                if (commandPickA.tfIdfScore === commandPickB.tfIdfScore) {\n                    return commandPickA.label.localeCompare(commandPickB.label); // prefer lexicographically smaller command\n                }\n                return commandPickB.tfIdfScore - commandPickA.tfIdfScore; // prefer higher tf-idf score\n            }\n            else if (commandPickA.tfIdfScore) {\n                return 1; // first command has a score but other doesn't so other wins\n            }\n            else if (commandPickB.tfIdfScore) {\n                return -1; // other command has a score but first doesn't so first wins\n            }\n            const commandACounter = this.commandsHistory.peek(commandPickA.commandId);\n            const commandBCounter = this.commandsHistory.peek(commandPickB.commandId);\n            if (commandACounter && commandBCounter) {\n                return commandACounter > commandBCounter ? -1 : 1; // use more recently used command before older\n            }\n            if (commandACounter) {\n                return -1; // first command was used, so it wins over the non used one\n            }\n            if (commandBCounter) {\n                return 1; // other command was used so it wins over the command\n            }\n            if (this.options.suggestedCommandIds) {\n                const commandASuggestion = this.options.suggestedCommandIds.has(commandPickA.commandId);\n                const commandBSuggestion = this.options.suggestedCommandIds.has(commandPickB.commandId);\n                if (commandASuggestion && commandBSuggestion) {\n                    return 0; // honor the order of the array\n                }\n                if (commandASuggestion) {\n                    return -1; // first command was suggested, so it wins over the non suggested one\n                }\n                if (commandBSuggestion) {\n                    return 1; // other command was suggested so it wins over the command\n                }\n            }\n            // both commands were never used, so we sort by name\n            return commandPickA.label.localeCompare(commandPickB.label);\n        });\n        const commandPicks = [];\n        let addOtherSeparator = false;\n        let addSuggestedSeparator = true;\n        let addCommonlyUsedSeparator = !!this.options.suggestedCommandIds;\n        for (let i = 0; i < filteredCommandPicks.length; i++) {\n            const commandPick = filteredCommandPicks[i];\n            // Separator: recently used\n            if (i === 0 && this.commandsHistory.peek(commandPick.commandId)) {\n                commandPicks.push({ type: 'separator', label: localize('recentlyUsed', \"recently used\") });\n                addOtherSeparator = true;\n            }\n            if (addSuggestedSeparator && commandPick.tfIdfScore !== undefined) {\n                commandPicks.push({ type: 'separator', label: localize('suggested', \"similar commands\") });\n                addSuggestedSeparator = false;\n            }\n            // Separator: commonly used\n            if (addCommonlyUsedSeparator && commandPick.tfIdfScore === undefined && !this.commandsHistory.peek(commandPick.commandId) && ((_c = this.options.suggestedCommandIds) === null || _c === void 0 ? void 0 : _c.has(commandPick.commandId))) {\n                commandPicks.push({ type: 'separator', label: localize('commonlyUsed', \"commonly used\") });\n                addOtherSeparator = true;\n                addCommonlyUsedSeparator = false;\n            }\n            // Separator: other commands\n            if (addOtherSeparator && commandPick.tfIdfScore === undefined && !this.commandsHistory.peek(commandPick.commandId) && !((_d = this.options.suggestedCommandIds) === null || _d === void 0 ? void 0 : _d.has(commandPick.commandId))) {\n                commandPicks.push({ type: 'separator', label: localize('morecCommands', \"other commands\") });\n                addOtherSeparator = false;\n            }\n            // Command\n            commandPicks.push(this.toCommandPick(commandPick, runOptions));\n        }\n        if (!this.hasAdditionalCommandPicks(filter, token)) {\n            return commandPicks;\n        }\n        return {\n            picks: commandPicks,\n            additionalPicks: (async () => {\n                var _a;\n                const additionalCommandPicks = await this.getAdditionalCommandPicks(allCommandPicks, filteredCommandPicks, filter, token);\n                if (token.isCancellationRequested) {\n                    return [];\n                }\n                const commandPicks = additionalCommandPicks.map(commandPick => this.toCommandPick(commandPick, runOptions));\n                // Basically, if we haven't already added a separator, we add one before the additional picks so long\n                // as one hasn't been added to the start of the array.\n                if (addSuggestedSeparator && ((_a = commandPicks[0]) === null || _a === void 0 ? void 0 : _a.type) !== 'separator') {\n                    commandPicks.unshift({ type: 'separator', label: localize('suggested', \"similar commands\") });\n                }\n                return commandPicks;\n            })()\n        };\n    }\n    toCommandPick(commandPick, runOptions) {\n        if (commandPick.type === 'separator') {\n            return commandPick;\n        }\n        const keybinding = this.keybindingService.lookupKeybinding(commandPick.commandId);\n        const ariaLabel = keybinding ?\n            localize('commandPickAriaLabelWithKeybinding', \"{0}, {1}\", commandPick.label, keybinding.getAriaLabel()) :\n            commandPick.label;\n        return {\n            ...commandPick,\n            ariaLabel,\n            detail: this.options.showAlias && commandPick.commandAlias !== commandPick.label ? commandPick.commandAlias : undefined,\n            keybinding,\n            accept: async () => {\n                var _a, _b;\n                // Add to history\n                this.commandsHistory.push(commandPick.commandId);\n                // Telementry\n                this.telemetryService.publicLog2('workbenchActionExecuted', {\n                    id: commandPick.commandId,\n                    from: (_a = runOptions === null || runOptions === void 0 ? void 0 : runOptions.from) !== null && _a !== void 0 ? _a : 'quick open'\n                });\n                // Run\n                try {\n                    ((_b = commandPick.args) === null || _b === void 0 ? void 0 : _b.length)\n                        ? await this.commandService.executeCommand(commandPick.commandId, ...commandPick.args)\n                        : await this.commandService.executeCommand(commandPick.commandId);\n                }\n                catch (error) {\n                    if (!isCancellationError(error)) {\n                        this.dialogService.error(localize('canNotRun', \"Command '{0}' resulted in an error\", commandPick.label), toErrorMessage(error));\n                    }\n                }\n            }\n        };\n    }\n    // TF-IDF string to be indexed\n    getTfIdfChunk({ label, commandAlias, commandDescription }) {\n        let chunk = label;\n        if (commandAlias && commandAlias !== label) {\n            chunk += ` - ${commandAlias}`;\n        }\n        if (commandDescription && commandDescription.value !== label) {\n            // If the original is the same as the value, don't add it\n            chunk += ` - ${commandDescription.value === commandDescription.original ? commandDescription.value : `${commandDescription.value} (${commandDescription.original})`}`;\n        }\n        return chunk;\n    }\n};\nAbstractCommandsQuickAccessProvider.PREFIX = '>';\nAbstractCommandsQuickAccessProvider.TFIDF_THRESHOLD = 0.5;\nAbstractCommandsQuickAccessProvider.TFIDF_MAX_RESULTS = 5;\nAbstractCommandsQuickAccessProvider.WORD_FILTER = or(matchesPrefix, matchesWords, matchesContiguousSubString);\nAbstractCommandsQuickAccessProvider = AbstractCommandsQuickAccessProvider_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService),\n    __param(3, ICommandService),\n    __param(4, ITelemetryService),\n    __param(5, IDialogService)\n], AbstractCommandsQuickAccessProvider);\nexport { AbstractCommandsQuickAccessProvider };\nlet CommandsHistory = CommandsHistory_1 = class CommandsHistory extends Disposable {\n    constructor(storageService, configurationService) {\n        super();\n        this.storageService = storageService;\n        this.configurationService = configurationService;\n        this.configuredCommandsHistoryLength = 0;\n        this.updateConfiguration();\n        this.load();\n        this.registerListeners();\n    }\n    registerListeners() {\n        this._register(this.configurationService.onDidChangeConfiguration(e => this.updateConfiguration(e)));\n        this._register(this.storageService.onWillSaveState(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                // Commands history is very dynamic and so we limit impact\n                // on storage to only save on shutdown. This helps reduce\n                // the overhead of syncing this data across machines.\n                this.saveState();\n            }\n        }));\n    }\n    updateConfiguration(e) {\n        if (e && !e.affectsConfiguration('workbench.commandPalette.history')) {\n            return;\n        }\n        this.configuredCommandsHistoryLength = CommandsHistory_1.getConfiguredCommandHistoryLength(this.configurationService);\n        if (CommandsHistory_1.cache && CommandsHistory_1.cache.limit !== this.configuredCommandsHistoryLength) {\n            CommandsHistory_1.cache.limit = this.configuredCommandsHistoryLength;\n            CommandsHistory_1.hasChanges = true;\n        }\n    }\n    load() {\n        const raw = this.storageService.get(CommandsHistory_1.PREF_KEY_CACHE, 0 /* StorageScope.PROFILE */);\n        let serializedCache;\n        if (raw) {\n            try {\n                serializedCache = JSON.parse(raw);\n            }\n            catch (error) {\n                // invalid data\n            }\n        }\n        const cache = CommandsHistory_1.cache = new LRUCache(this.configuredCommandsHistoryLength, 1);\n        if (serializedCache) {\n            let entries;\n            if (serializedCache.usesLRU) {\n                entries = serializedCache.entries;\n            }\n            else {\n                entries = serializedCache.entries.sort((a, b) => a.value - b.value);\n            }\n            entries.forEach(entry => cache.set(entry.key, entry.value));\n        }\n        CommandsHistory_1.counter = this.storageService.getNumber(CommandsHistory_1.PREF_KEY_COUNTER, 0 /* StorageScope.PROFILE */, CommandsHistory_1.counter);\n    }\n    push(commandId) {\n        if (!CommandsHistory_1.cache) {\n            return;\n        }\n        CommandsHistory_1.cache.set(commandId, CommandsHistory_1.counter++); // set counter to command\n        CommandsHistory_1.hasChanges = true;\n    }\n    peek(commandId) {\n        var _a;\n        return (_a = CommandsHistory_1.cache) === null || _a === void 0 ? void 0 : _a.peek(commandId);\n    }\n    saveState() {\n        if (!CommandsHistory_1.cache) {\n            return;\n        }\n        if (!CommandsHistory_1.hasChanges) {\n            return;\n        }\n        const serializedCache = { usesLRU: true, entries: [] };\n        CommandsHistory_1.cache.forEach((value, key) => serializedCache.entries.push({ key, value }));\n        this.storageService.store(CommandsHistory_1.PREF_KEY_CACHE, JSON.stringify(serializedCache), 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n        this.storageService.store(CommandsHistory_1.PREF_KEY_COUNTER, CommandsHistory_1.counter, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n        CommandsHistory_1.hasChanges = false;\n    }\n    static getConfiguredCommandHistoryLength(configurationService) {\n        var _a, _b;\n        const config = configurationService.getValue();\n        const configuredCommandHistoryLength = (_b = (_a = config.workbench) === null || _a === void 0 ? void 0 : _a.commandPalette) === null || _b === void 0 ? void 0 : _b.history;\n        if (typeof configuredCommandHistoryLength === 'number') {\n            return configuredCommandHistoryLength;\n        }\n        return CommandsHistory_1.DEFAULT_COMMANDS_HISTORY_LENGTH;\n    }\n};\nCommandsHistory.DEFAULT_COMMANDS_HISTORY_LENGTH = 50;\nCommandsHistory.PREF_KEY_CACHE = 'commandPalette.mru.cache';\nCommandsHistory.PREF_KEY_COUNTER = 'commandPalette.mru.counter';\nCommandsHistory.counter = 1;\nCommandsHistory.hasChanges = false;\nCommandsHistory = CommandsHistory_1 = __decorate([\n    __param(0, IStorageService),\n    __param(1, IConfigurationService)\n], CommandsHistory);\nexport { CommandsHistory };\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nfunction countMapFrom(values) {\n    var _a;\n    const map = new Map();\n    for (const value of values) {\n        map.set(value, ((_a = map.get(value)) !== null && _a !== void 0 ? _a : 0) + 1);\n    }\n    return map;\n}\n/**\n * Implementation of tf-idf (term frequency-inverse document frequency) for a set of\n * documents where each document contains one or more chunks of text.\n * Each document is identified by a key, and the score for each document is computed\n * by taking the max score over all the chunks in the document.\n */\nexport class TfIdfCalculator {\n    constructor() {\n        /**\n         * Total number of chunks\n         */\n        this.chunkCount = 0;\n        this.chunkOccurrences = new Map();\n        this.documents = new Map();\n    }\n    calculateScores(query, token) {\n        const embedding = this.computeEmbedding(query);\n        const idfCache = new Map();\n        const scores = [];\n        // For each document, generate one score\n        for (const [key, doc] of this.documents) {\n            if (token.isCancellationRequested) {\n                return [];\n            }\n            for (const chunk of doc.chunks) {\n                const score = this.computeSimilarityScore(chunk, embedding, idfCache);\n                if (score > 0) {\n                    scores.push({ key, score });\n                }\n            }\n        }\n        return scores;\n    }\n    /**\n     * Count how many times each term (word) appears in a string.\n     */\n    static termFrequencies(input) {\n        return countMapFrom(TfIdfCalculator.splitTerms(input));\n    }\n    /**\n     * Break a string into terms (words).\n     */\n    static *splitTerms(input) {\n        const normalize = (word) => word.toLowerCase();\n        // Only match on words that are at least 3 characters long and start with a letter\n        for (const [word] of input.matchAll(/\\b\\p{Letter}[\\p{Letter}\\d]{2,}\\b/gu)) {\n            yield normalize(word);\n            const camelParts = word.replace(/([a-z])([A-Z])/g, '$1 $2').split(/\\s+/g);\n            if (camelParts.length > 1) {\n                for (const part of camelParts) {\n                    // Require at least 3 letters in the parts of a camel case word\n                    if (part.length > 2 && /\\p{Letter}{3,}/gu.test(part)) {\n                        yield normalize(part);\n                    }\n                }\n            }\n        }\n    }\n    updateDocuments(documents) {\n        var _a;\n        for (const { key } of documents) {\n            this.deleteDocument(key);\n        }\n        for (const doc of documents) {\n            const chunks = [];\n            for (const text of doc.textChunks) {\n                // TODO: See if we can compute the tf lazily\n                // The challenge is that we need to also update the `chunkOccurrences`\n                // and all of those updates need to get flushed before the real TF-IDF of\n                // anything is computed.\n                const tf = TfIdfCalculator.termFrequencies(text);\n                // Update occurrences list\n                for (const term of tf.keys()) {\n                    this.chunkOccurrences.set(term, ((_a = this.chunkOccurrences.get(term)) !== null && _a !== void 0 ? _a : 0) + 1);\n                }\n                chunks.push({ text, tf });\n            }\n            this.chunkCount += chunks.length;\n            this.documents.set(doc.key, { chunks });\n        }\n        return this;\n    }\n    deleteDocument(key) {\n        const doc = this.documents.get(key);\n        if (!doc) {\n            return;\n        }\n        this.documents.delete(key);\n        this.chunkCount -= doc.chunks.length;\n        // Update term occurrences for the document\n        for (const chunk of doc.chunks) {\n            for (const term of chunk.tf.keys()) {\n                const currentOccurrences = this.chunkOccurrences.get(term);\n                if (typeof currentOccurrences === 'number') {\n                    const newOccurrences = currentOccurrences - 1;\n                    if (newOccurrences <= 0) {\n                        this.chunkOccurrences.delete(term);\n                    }\n                    else {\n                        this.chunkOccurrences.set(term, newOccurrences);\n                    }\n                }\n            }\n        }\n    }\n    computeSimilarityScore(chunk, queryEmbedding, idfCache) {\n        // Compute the dot product between the chunk's embedding and the query embedding\n        // Note that the chunk embedding is computed lazily on a per-term basis.\n        // This lets us skip a large number of calculations because the majority\n        // of chunks do not share any terms with the query.\n        let sum = 0;\n        for (const [term, termTfidf] of Object.entries(queryEmbedding)) {\n            const chunkTf = chunk.tf.get(term);\n            if (!chunkTf) {\n                // Term does not appear in chunk so it has no contribution\n                continue;\n            }\n            let chunkIdf = idfCache.get(term);\n            if (typeof chunkIdf !== 'number') {\n                chunkIdf = this.computeIdf(term);\n                idfCache.set(term, chunkIdf);\n            }\n            const chunkTfidf = chunkTf * chunkIdf;\n            sum += chunkTfidf * termTfidf;\n        }\n        return sum;\n    }\n    computeEmbedding(input) {\n        const tf = TfIdfCalculator.termFrequencies(input);\n        return this.computeTfidf(tf);\n    }\n    computeIdf(term) {\n        var _a;\n        const chunkOccurrences = (_a = this.chunkOccurrences.get(term)) !== null && _a !== void 0 ? _a : 0;\n        return chunkOccurrences > 0\n            ? Math.log((this.chunkCount + 1) / chunkOccurrences)\n            : 0;\n    }\n    computeTfidf(termFrequencies) {\n        const embedding = Object.create(null);\n        for (const [word, occurrences] of termFrequencies) {\n            const idf = this.computeIdf(word);\n            if (idf > 0) {\n                embedding[word] = occurrences * idf;\n            }\n        }\n        return embedding;\n    }\n}\n/**\n * Normalize the scores to be between 0 and 1 and sort them decending.\n * @param scores array of scores from {@link TfIdfCalculator.calculateScores}\n * @returns normalized scores\n */\nexport function normalizeTfIdfScores(scores) {\n    var _a, _b;\n    // copy of scores\n    const result = scores.slice(0);\n    // sort descending\n    result.sort((a, b) => b.score - a.score);\n    // normalize\n    const max = (_b = (_a = result[0]) === null || _a === void 0 ? void 0 : _a.score) !== null && _b !== void 0 ? _b : 0;\n    if (max > 0) {\n        for (const score of result) {\n            score.score /= max;\n        }\n    }\n    return result;\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { timeout } from '../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { isFunction } from '../../../base/common/types.js';\nexport var TriggerAction;\n(function (TriggerAction) {\n    /**\n     * Do nothing after the button was clicked.\n     */\n    TriggerAction[TriggerAction[\"NO_ACTION\"] = 0] = \"NO_ACTION\";\n    /**\n     * Close the picker.\n     */\n    TriggerAction[TriggerAction[\"CLOSE_PICKER\"] = 1] = \"CLOSE_PICKER\";\n    /**\n     * Update the results of the picker.\n     */\n    TriggerAction[TriggerAction[\"REFRESH_PICKER\"] = 2] = \"REFRESH_PICKER\";\n    /**\n     * Remove the item from the picker.\n     */\n    TriggerAction[TriggerAction[\"REMOVE_ITEM\"] = 3] = \"REMOVE_ITEM\";\n})(TriggerAction || (TriggerAction = {}));\nfunction isPicksWithActive(obj) {\n    const candidate = obj;\n    return Array.isArray(candidate.items);\n}\nfunction isFastAndSlowPicks(obj) {\n    const candidate = obj;\n    return !!candidate.picks && candidate.additionalPicks instanceof Promise;\n}\nexport class PickerQuickAccessProvider extends Disposable {\n    constructor(prefix, options) {\n        super();\n        this.prefix = prefix;\n        this.options = options;\n    }\n    provide(picker, token, runOptions) {\n        var _a;\n        const disposables = new DisposableStore();\n        // Apply options if any\n        picker.canAcceptInBackground = !!((_a = this.options) === null || _a === void 0 ? void 0 : _a.canAcceptInBackground);\n        // Disable filtering & sorting, we control the results\n        picker.matchOnLabel = picker.matchOnDescription = picker.matchOnDetail = picker.sortByLabel = false;\n        // Set initial picks and update on type\n        let picksCts = undefined;\n        const picksDisposable = disposables.add(new MutableDisposable());\n        const updatePickerItems = async () => {\n            var _a;\n            const picksDisposables = picksDisposable.value = new DisposableStore();\n            // Cancel any previous ask for picks and busy\n            picksCts === null || picksCts === void 0 ? void 0 : picksCts.dispose(true);\n            picker.busy = false;\n            // Create new cancellation source for this run\n            picksCts = new CancellationTokenSource(token);\n            // Collect picks and support both long running and short or combined\n            const picksToken = picksCts.token;\n            let picksFilter = picker.value.substring(this.prefix.length);\n            if (!((_a = this.options) === null || _a === void 0 ? void 0 : _a.shouldSkipTrimPickFilter)) {\n                picksFilter = picksFilter.trim();\n            }\n            const providedPicks = this._getPicks(picksFilter, picksDisposables, picksToken, runOptions);\n            const applyPicks = (picks, skipEmpty) => {\n                var _a;\n                let items;\n                let activeItem = undefined;\n                if (isPicksWithActive(picks)) {\n                    items = picks.items;\n                    activeItem = picks.active;\n                }\n                else {\n                    items = picks;\n                }\n                if (items.length === 0) {\n                    if (skipEmpty) {\n                        return false;\n                    }\n                    // We show the no results pick if we have no input to prevent completely empty pickers #172613\n                    if ((picksFilter.length > 0 || picker.hideInput) && ((_a = this.options) === null || _a === void 0 ? void 0 : _a.noResultsPick)) {\n                        if (isFunction(this.options.noResultsPick)) {\n                            items = [this.options.noResultsPick(picksFilter)];\n                        }\n                        else {\n                            items = [this.options.noResultsPick];\n                        }\n                    }\n                }\n                picker.items = items;\n                if (activeItem) {\n                    picker.activeItems = [activeItem];\n                }\n                return true;\n            };\n            const applyFastAndSlowPicks = async (fastAndSlowPicks) => {\n                let fastPicksApplied = false;\n                let slowPicksApplied = false;\n                await Promise.all([\n                    // Fast Picks: if `mergeDelay` is configured, in order to reduce\n                    // amount of flicker, we race against the slow picks over some delay\n                    // and then set the fast picks.\n                    // If the slow picks are faster, we reduce the flicker by only\n                    // setting the items once.\n                    (async () => {\n                        if (typeof fastAndSlowPicks.mergeDelay === 'number') {\n                            await timeout(fastAndSlowPicks.mergeDelay);\n                            if (picksToken.isCancellationRequested) {\n                                return;\n                            }\n                        }\n                        if (!slowPicksApplied) {\n                            fastPicksApplied = applyPicks(fastAndSlowPicks.picks, true /* skip over empty to reduce flicker */);\n                        }\n                    })(),\n                    // Slow Picks: we await the slow picks and then set them at\n                    // once together with the fast picks, but only if we actually\n                    // have additional results.\n                    (async () => {\n                        picker.busy = true;\n                        try {\n                            const awaitedAdditionalPicks = await fastAndSlowPicks.additionalPicks;\n                            if (picksToken.isCancellationRequested) {\n                                return;\n                            }\n                            let picks;\n                            let activePick = undefined;\n                            if (isPicksWithActive(fastAndSlowPicks.picks)) {\n                                picks = fastAndSlowPicks.picks.items;\n                                activePick = fastAndSlowPicks.picks.active;\n                            }\n                            else {\n                                picks = fastAndSlowPicks.picks;\n                            }\n                            let additionalPicks;\n                            let additionalActivePick = undefined;\n                            if (isPicksWithActive(awaitedAdditionalPicks)) {\n                                additionalPicks = awaitedAdditionalPicks.items;\n                                additionalActivePick = awaitedAdditionalPicks.active;\n                            }\n                            else {\n                                additionalPicks = awaitedAdditionalPicks;\n                            }\n                            if (additionalPicks.length > 0 || !fastPicksApplied) {\n                                // If we do not have any activePick or additionalActivePick\n                                // we try to preserve the currently active pick from the\n                                // fast results. This fixes an issue where the user might\n                                // have made a pick active before the additional results\n                                // kick in.\n                                // See https://github.com/microsoft/vscode/issues/102480\n                                let fallbackActivePick = undefined;\n                                if (!activePick && !additionalActivePick) {\n                                    const fallbackActivePickCandidate = picker.activeItems[0];\n                                    if (fallbackActivePickCandidate && picks.indexOf(fallbackActivePickCandidate) !== -1) {\n                                        fallbackActivePick = fallbackActivePickCandidate;\n                                    }\n                                }\n                                applyPicks({\n                                    items: [...picks, ...additionalPicks],\n                                    active: activePick || additionalActivePick || fallbackActivePick\n                                });\n                            }\n                        }\n                        finally {\n                            if (!picksToken.isCancellationRequested) {\n                                picker.busy = false;\n                            }\n                            slowPicksApplied = true;\n                        }\n                    })()\n                ]);\n            };\n            // No Picks\n            if (providedPicks === null) {\n                // Ignore\n            }\n            // Fast and Slow Picks\n            else if (isFastAndSlowPicks(providedPicks)) {\n                await applyFastAndSlowPicks(providedPicks);\n            }\n            // Fast Picks\n            else if (!(providedPicks instanceof Promise)) {\n                applyPicks(providedPicks);\n            }\n            // Slow Picks\n            else {\n                picker.busy = true;\n                try {\n                    const awaitedPicks = await providedPicks;\n                    if (picksToken.isCancellationRequested) {\n                        return;\n                    }\n                    if (isFastAndSlowPicks(awaitedPicks)) {\n                        await applyFastAndSlowPicks(awaitedPicks);\n                    }\n                    else {\n                        applyPicks(awaitedPicks);\n                    }\n                }\n                finally {\n                    if (!picksToken.isCancellationRequested) {\n                        picker.busy = false;\n                    }\n                }\n            }\n        };\n        disposables.add(picker.onDidChangeValue(() => updatePickerItems()));\n        updatePickerItems();\n        // Accept the pick on accept and hide picker\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (typeof (item === null || item === void 0 ? void 0 : item.accept) === 'function') {\n                if (!event.inBackground) {\n                    picker.hide(); // hide picker unless we accept in background\n                }\n                item.accept(picker.keyMods, event);\n            }\n        }));\n        // Trigger the pick with button index if button triggered\n        disposables.add(picker.onDidTriggerItemButton(async ({ button, item }) => {\n            var _a, _b;\n            if (typeof item.trigger === 'function') {\n                const buttonIndex = (_b = (_a = item.buttons) === null || _a === void 0 ? void 0 : _a.indexOf(button)) !== null && _b !== void 0 ? _b : -1;\n                if (buttonIndex >= 0) {\n                    const result = item.trigger(buttonIndex, picker.keyMods);\n                    const action = (typeof result === 'number') ? result : await result;\n                    if (token.isCancellationRequested) {\n                        return;\n                    }\n                    switch (action) {\n                        case TriggerAction.NO_ACTION:\n                            break;\n                        case TriggerAction.CLOSE_PICKER:\n                            picker.hide();\n                            break;\n                        case TriggerAction.REFRESH_PICKER:\n                            updatePickerItems();\n                            break;\n                        case TriggerAction.REMOVE_ITEM: {\n                            const index = picker.items.indexOf(item);\n                            if (index !== -1) {\n                                const items = picker.items.slice();\n                                const removed = items.splice(index, 1);\n                                const activeItems = picker.activeItems.filter(activeItem => activeItem !== removed[0]);\n                                const keepScrollPositionBefore = picker.keepScrollPosition;\n                                picker.keepScrollPosition = true;\n                                picker.items = items;\n                                if (activeItems) {\n                                    picker.activeItems = activeItems;\n                                }\n                                picker.keepScrollPosition = keepScrollPositionBefore;\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n        }));\n        return disposables;\n    }\n}\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { ReferencesController } from '../../../contrib/gotoSymbol/browser/peek/referencesController.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nlet StandaloneReferencesController = class StandaloneReferencesController extends ReferencesController {\n    constructor(editor, contextKeyService, editorService, notificationService, instantiationService, storageService, configurationService) {\n        super(true, editor, contextKeyService, editorService, notificationService, instantiationService, storageService, configurationService);\n    }\n};\nStandaloneReferencesController = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ICodeEditorService),\n    __param(3, INotificationService),\n    __param(4, IInstantiationService),\n    __param(5, IStorageService),\n    __param(6, IConfigurationService)\n], StandaloneReferencesController);\nexport { StandaloneReferencesController };\nregisterEditorContribution(ReferencesController.ID, StandaloneReferencesController, 4 /* EditorContributionInstantiation.Lazy */);\n", "/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { IStandaloneThemeService } from '../../common/standaloneTheme.js';\nimport { ToggleHighContrastNLS } from '../../../common/standaloneStrings.js';\nimport { isDark, isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { HC_BLACK_THEME_NAME, HC_LIGHT_THEME_NAME, VS_DARK_THEME_NAME, VS_LIGHT_THEME_NAME } from '../standaloneThemeService.js';\nclass ToggleHighContrast extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.toggleHighContrast',\n            label: ToggleHighContrastNLS.toggleHighContrast,\n            alias: 'Toggle High Contrast Theme',\n            precondition: undefined\n        });\n        this._originalThemeName = null;\n    }\n    run(accessor, editor) {\n        const standaloneThemeService = accessor.get(IStandaloneThemeService);\n        const currentTheme = standaloneThemeService.getColorTheme();\n        if (isHighContrast(currentTheme.type)) {\n            // We must toggle back to the integrator's theme\n            standaloneThemeService.setTheme(this._originalThemeName || (isDark(currentTheme.type) ? VS_DARK_THEME_NAME : VS_LIGHT_THEME_NAME));\n            this._originalThemeName = null;\n        }\n        else {\n            standaloneThemeService.setTheme(isDark(currentTheme.type) ? HC_BLACK_THEME_NAME : HC_LIGHT_THEME_NAME);\n            this._originalThemeName = currentTheme.themeName;\n        }\n    }\n}\nregisterEditorAction(ToggleHighContrast);\n", "let monacoEditor;\n/**\n * Get the Monaco editor module\n *\n * @returns The Monaco editor module\n */\nexport function getMonaco() {\n    if (!monacoEditor) {\n        throw new Error('Monaco is undefined. Call setMonaco(monaco) first.');\n    }\n    return monacoEditor;\n}\n/**\n * Set the Monaco editor module to use.\n *\n * @param monaco The Monaco editor module\n */\nexport function setMonaco(monaco) {\n    monacoEditor = monaco;\n}\n", "import { getMonaco } from './monaco.js';\n/**\n * Convert a Monaco editor marker severity to an LSP diagnostic severity.\n *\n * @param severity The Monaco marker severity to convert.\n * @returns The marker severity as an LSP diagnostic severity.\n */\nexport function fromMarkerSeverity(severity) {\n    const { MarkerSeverity } = getMonaco();\n    if (severity === MarkerSeverity.Error) {\n        return 1;\n    }\n    if (severity === MarkerSeverity.Warning) {\n        return 2;\n    }\n    if (severity === MarkerSeverity.Info) {\n        return 3;\n    }\n    // Severity === MarkerSeverity.Hint\n    return 4;\n}\n/**\n * Convert an LSP diagnostic severity to a Monaco editor marker severity.\n *\n * @param severity The LSP diagnostic severity to convert.\n * @returns The diagnostic severity as Monaco editor marker severity.\n */\nexport function toMarkerSeverity(severity) {\n    const { MarkerSeverity } = getMonaco();\n    if (severity === 1) {\n        return MarkerSeverity.Error;\n    }\n    if (severity === 2) {\n        return MarkerSeverity.Warning;\n    }\n    if (severity === 3) {\n        return MarkerSeverity.Info;\n    }\n    // Severity === 4\n    return MarkerSeverity.Hint;\n}\n", "/**\n * Convert a Monaco editor marker tag to an LSP diagnostic tag.\n *\n * @param tag The Monaco marker tag to convert.\n * @returns The marker tag as an LSP diagnostic tag.\n */\nexport function fromMarkerTag(tag) {\n    return tag;\n}\n/**\n * Convert an LSP diagnostic tag to a Monaco editor marker tag.\n *\n * @param tag The LSP diagnostic tag to convert.\n * @returns The diagnostic tag as Monaco editor marker tag.\n */\nexport function toMarkerTag(tag) {\n    return tag;\n}\n", "/**\n * Convert a Monaco editor range to an LSP range.\n *\n * @param range The Monaco range to convert.\n * @returns The range as an LSP range.\n */\nexport function fromRange(range) {\n    return {\n        start: { line: range.startLineNumber - 1, character: range.startColumn - 1 },\n        end: { line: range.endLineNumber - 1, character: range.endColumn - 1 }\n    };\n}\n/**\n * Convert an LSP range to a Monaco editor range.\n *\n * @param range The LSP range to convert.\n * @returns The range as Monaco editor range.\n */\nexport function toRange(range) {\n    return {\n        startLineNumber: range.start.line + 1,\n        startColumn: range.start.character + 1,\n        endLineNumber: range.end.line + 1,\n        endColumn: range.end.character + 1\n    };\n}\n", "import { getMonaco } from './monaco.js';\nimport { fromRange, toRange } from './range.js';\n/**\n * Convert a Monaco editor related information to an LSP diagnostic related information.\n *\n * @param relatedInformation The Monaco related information to convert.\n * @returns The related information as an LSP diagnostic related information.\n */\nexport function fromRelatedInformation(relatedInformation) {\n    return {\n        location: {\n            range: fromRange(relatedInformation),\n            uri: String(relatedInformation.resource)\n        },\n        message: relatedInformation.message\n    };\n}\n/**\n * Convert an LSP diagnostic related information to a Monaco editor related information.\n *\n * @param relatedInformation The LSP diagnostic related information to convert.\n * @returns The diagnostic related information as Monaco editor related information.\n */\nexport function toRelatedInformation(relatedInformation) {\n    const { Uri } = getMonaco();\n    return {\n        ...toRange(relatedInformation.location.range),\n        message: relatedInformation.message,\n        resource: Uri.parse(relatedInformation.location.uri)\n    };\n}\n", "import { fromMarkerSeverity, toMarkerSeverity } from './markerSeverity.js';\nimport { fromMarkerTag, toMarkerTag } from './markerTag.js';\nimport { getMonaco } from './monaco.js';\nimport { fromRange, toRange } from './range.js';\nimport { fromRelatedInformation, toRelatedInformation } from './relatedInformation.js';\n/**\n * Convert a Monaco editor marker data to an LSP diagnostic.\n *\n * @param markerData The Monaco marker data to convert.\n * @returns The marker data as an LSP diagnostic.\n */\nexport function fromMarkerData(markerData) {\n    const diagnostic = {\n        message: markerData.message,\n        range: fromRange(markerData),\n        severity: fromMarkerSeverity(markerData.severity)\n    };\n    if (typeof markerData.code === 'string') {\n        diagnostic.code = markerData.code;\n    }\n    else if (markerData.code != null) {\n        diagnostic.code = markerData.code.value;\n        diagnostic.codeDescription = { href: String(markerData.code.target) };\n    }\n    if (markerData.relatedInformation) {\n        diagnostic.relatedInformation = markerData.relatedInformation.map(fromRelatedInformation);\n    }\n    if (markerData.tags) {\n        diagnostic.tags = markerData.tags.map(fromMarkerTag);\n    }\n    if (markerData.source != null) {\n        diagnostic.source = markerData.source;\n    }\n    return diagnostic;\n}\n/**\n * Convert an LSP diagnostic to a Monaco editor marker data.\n *\n * @param diagnostic The LSP diagnostic to convert.\n * @param options Additional options needed to construct the Monaco marker data.\n * @returns The diagnostic as Monaco editor marker data.\n */\nexport function toMarkerData(diagnostic, options) {\n    var _a;\n    const { MarkerSeverity, Uri } = getMonaco();\n    const markerData = {\n        ...toRange(diagnostic.range),\n        message: diagnostic.message,\n        severity: diagnostic.severity\n            ? toMarkerSeverity(diagnostic.severity)\n            : (_a = options === null || options === void 0 ? void 0 : options.defaultSeverity) !== null && _a !== void 0 ? _a : MarkerSeverity.Error\n    };\n    if (diagnostic.code != null) {\n        markerData.code =\n            diagnostic.codeDescription == null\n                ? String(diagnostic.code)\n                : { value: String(diagnostic.code), target: Uri.parse(diagnostic.codeDescription.href) };\n    }\n    if (diagnostic.relatedInformation) {\n        markerData.relatedInformation = diagnostic.relatedInformation.map(toRelatedInformation);\n    }\n    if (diagnostic.tags) {\n        markerData.tags = diagnostic.tags.map(toMarkerTag);\n    }\n    if (diagnostic.source != null) {\n        markerData.source = diagnostic.source;\n    }\n    return markerData;\n}\n", "/**\n * Convert a Monaco editor command to an LSP command.\n *\n * @param command The Monaco command to convert.\n * @returns The command as an LSP command.\n */\nexport function fromCommand(command) {\n    const result = {\n        title: command.title,\n        command: command.id\n    };\n    if (command.arguments) {\n        result.arguments = command.arguments;\n    }\n    return result;\n}\n/**\n * Convert an LSP command to a Monaco editor command.\n *\n * @param command The LSP command to convert.\n * @returns The command as Monaco editor command.\n */\nexport function toCommand(command) {\n    const result = {\n        title: command.title,\n        id: command.command\n    };\n    if (command.arguments) {\n        result.arguments = command.arguments;\n    }\n    return result;\n}\n", "/**\n * Convert a Monaco editor color to an LSP color.\n *\n * @param color The Monaco color to convert.\n * @returns The color as an LSP color.\n */\nexport function fromColor(color) {\n    return {\n        red: color.red,\n        blue: color.blue,\n        green: color.green,\n        alpha: color.alpha\n    };\n}\n/**\n * Convert an LSP color to a Monaco editor color.\n *\n * @param color The LSP color to convert.\n * @returns The color as Monaco editor color.\n */\nexport function toColor(color) {\n    return {\n        red: color.red,\n        blue: color.blue,\n        green: color.green,\n        alpha: color.alpha\n    };\n}\n", "import { fromColor, toColor } from './color.js';\nimport { fromRange, toRange } from './range.js';\n/**\n * Convert a Monaco editor color information to an LSP color information.\n *\n * @param colorInformation The Monaco color information to convert.\n * @returns The color information as an LSP color information.\n */\nexport function fromColorInformation(colorInformation) {\n    return {\n        range: fromRange(colorInformation.range),\n        color: fromColor(colorInformation.color)\n    };\n}\n/**\n * Convert an LSP color information to a Monaco editor color information.\n *\n * @param colorInformation The LSP color information to convert.\n * @returns The color information as Monaco editor color information.\n */\nexport function toColorInformation(colorInformation) {\n    return {\n        range: toRange(colorInformation.range),\n        color: toColor(colorInformation.color)\n    };\n}\n", "import { getMonaco } from './monaco.js';\n/**\n * Convert a Monaco editor completion trigger kind to an LSP completion trigger kind.\n *\n * @param kind The Monaco completion trigger kind to convert.\n * @returns The completion trigger kind as an LSP completion trigger kind.\n */\nexport function fromCompletionTriggerKind(kind) {\n    const { CompletionTriggerKind } = getMonaco().languages;\n    if (kind === CompletionTriggerKind.Invoke) {\n        return 1;\n    }\n    if (kind === CompletionTriggerKind.TriggerCharacter) {\n        return 2;\n    }\n    // Kind === TriggerForIncompleteCompletions.\n    return 3;\n}\n/**\n * Convert an LSP completion trigger kind to a Monaco editor completion trigger kind.\n *\n * @param kind The LSP completion trigger kind to convert.\n * @returns The completion trigger kind as Monaco editor completion trigger kind.\n */\nexport function toCompletionTriggerKind(kind) {\n    const { CompletionTriggerKind } = getMonaco().languages;\n    if (kind === 1) {\n        return CompletionTriggerKind.Invoke;\n    }\n    if (kind === 2) {\n        return CompletionTriggerKind.TriggerCharacter;\n    }\n    // Kind === 3\n    return CompletionTriggerKind.TriggerForIncompleteCompletions;\n}\n", "import { fromCompletionTriggerKind, toCompletionTriggerKind } from './completionTriggerKind.js';\n/**\n * Convert a Monaco editor completion context to an LSP completion context.\n *\n * @param completionContext The Monaco completion context to convert.\n * @returns The completion context as an LSP completion context.\n */\nexport function fromCompletionContext(completionContext) {\n    const result = {\n        triggerKind: fromCompletionTriggerKind(completionContext.triggerKind)\n    };\n    if (completionContext.triggerCharacter != null) {\n        result.triggerCharacter = completionContext.triggerCharacter;\n    }\n    return result;\n}\n/**\n * Convert an LSP completion context to a Monaco editor completion context.\n *\n * @param completionContext The LSP completion context to convert.\n * @returns The completion context as Monaco editor completion context.\n */\nexport function toCompletionContext(completionContext) {\n    const result = {\n        triggerKind: toCompletionTriggerKind(completionContext.triggerKind)\n    };\n    if (completionContext.triggerCharacter != null) {\n        result.triggerCharacter = completionContext.triggerCharacter;\n    }\n    return result;\n}\n", "import { getMonaco } from './monaco.js';\n/**\n * Convert a Monaco editor completion item kind to an LSP completion item kind.\n *\n * @param kind The Monaco completion item kind to convert.\n * @returns The completion item kind as an LSP completion item kind.\n */\nexport function fromCompletionItemKind(kind) {\n    const { CompletionItemKind } = getMonaco().languages;\n    if (kind === CompletionItemKind.Text) {\n        return 1;\n    }\n    if (kind === CompletionItemKind.Method) {\n        return 2;\n    }\n    if (kind === CompletionItemKind.Function) {\n        return 3;\n    }\n    if (kind === CompletionItemKind.Constructor) {\n        return 4;\n    }\n    if (kind === CompletionItemKind.Field) {\n        return 5;\n    }\n    if (kind === CompletionItemKind.Variable) {\n        return 6;\n    }\n    if (kind === CompletionItemKind.Class) {\n        return 7;\n    }\n    if (kind === CompletionItemKind.Interface) {\n        return 8;\n    }\n    if (kind === CompletionItemKind.Module) {\n        return 9;\n    }\n    if (kind === CompletionItemKind.Property) {\n        return 10;\n    }\n    if (kind === CompletionItemKind.Unit) {\n        return 11;\n    }\n    if (kind === CompletionItemKind.Value) {\n        return 12;\n    }\n    if (kind === CompletionItemKind.Enum) {\n        return 13;\n    }\n    if (kind === CompletionItemKind.Keyword) {\n        return 14;\n    }\n    if (kind === CompletionItemKind.Snippet) {\n        return 15;\n    }\n    if (kind === CompletionItemKind.Color) {\n        return 16;\n    }\n    if (kind === CompletionItemKind.File) {\n        return 17;\n    }\n    if (kind === CompletionItemKind.Reference) {\n        return 18;\n    }\n    if (kind === CompletionItemKind.Folder) {\n        return 19;\n    }\n    if (kind === CompletionItemKind.EnumMember) {\n        return 20;\n    }\n    if (kind === CompletionItemKind.Constant) {\n        return 21;\n    }\n    if (kind === CompletionItemKind.Struct) {\n        return 22;\n    }\n    if (kind === CompletionItemKind.Event) {\n        return 23;\n    }\n    if (kind === CompletionItemKind.Operator) {\n        return 24;\n    }\n    if (kind === CompletionItemKind.TypeParameter) {\n        return 25;\n    }\n}\n/**\n * Convert an LSP completion item kind to a Monaco editor completion item kind.\n *\n * @param kind The LSP completion item kind to convert.\n * @returns The completion item kind as Monaco editor completion item kind.\n */\nexport function toCompletionItemKind(kind) {\n    const { CompletionItemKind } = getMonaco().languages;\n    if (kind === 1) {\n        return CompletionItemKind.Text;\n    }\n    if (kind === 2) {\n        return CompletionItemKind.Method;\n    }\n    if (kind === 3) {\n        return CompletionItemKind.Function;\n    }\n    if (kind === 4) {\n        return CompletionItemKind.Constructor;\n    }\n    if (kind === 5) {\n        return CompletionItemKind.Field;\n    }\n    if (kind === 6) {\n        return CompletionItemKind.Variable;\n    }\n    if (kind === 7) {\n        return CompletionItemKind.Class;\n    }\n    if (kind === 8) {\n        return CompletionItemKind.Interface;\n    }\n    if (kind === 9) {\n        return CompletionItemKind.Module;\n    }\n    if (kind === 10) {\n        return CompletionItemKind.Property;\n    }\n    if (kind === 11) {\n        return CompletionItemKind.Unit;\n    }\n    if (kind === 12) {\n        return CompletionItemKind.Value;\n    }\n    if (kind === 13) {\n        return CompletionItemKind.Enum;\n    }\n    if (kind === 14) {\n        return CompletionItemKind.Keyword;\n    }\n    if (kind === 15) {\n        return CompletionItemKind.Snippet;\n    }\n    if (kind === 16) {\n        return CompletionItemKind.Color;\n    }\n    if (kind === 17) {\n        return CompletionItemKind.File;\n    }\n    if (kind === 18) {\n        return CompletionItemKind.Reference;\n    }\n    if (kind === 19) {\n        return CompletionItemKind.Folder;\n    }\n    if (kind === 20) {\n        return CompletionItemKind.EnumMember;\n    }\n    if (kind === 21) {\n        return CompletionItemKind.Constant;\n    }\n    if (kind === 22) {\n        return CompletionItemKind.Struct;\n    }\n    if (kind === 23) {\n        return CompletionItemKind.Event;\n    }\n    if (kind === 24) {\n        return CompletionItemKind.Operator;\n    }\n    // Kind === 25\n    return CompletionItemKind.TypeParameter;\n}\n", "/**\n * Convert a Monaco editor completion item tag to an LSP completion item tag.\n *\n * @param tag The Monaco completion item tag to convert.\n * @returns The completion item tag as an LSP completion item tag.\n */\nexport function fromCompletionItemTag(tag) {\n    return tag;\n}\n/**\n * Convert an LSP completion item tag to a Monaco editor completion item tag.\n *\n * @param tag The LSP completion item tag to convert.\n * @returns The completion item tag as Monaco editor completion item tag.\n */\nexport function toCompletionItemTag(tag) {\n    return tag;\n}\n", "/**\n * Convert a Monaco editor markdown string to an LSP markup content.\n *\n * @param markdownString The Monaco markdown string to convert.\n * @returns The markdown string as an LSP markup content.\n */\nexport function fromMarkdownString(markdownString) {\n    return {\n        kind: 'markdown',\n        value: markdownString.value\n    };\n}\n/**\n * Convert an LSP markup content to a Monaco editor markdown string.\n *\n * @param markupContent The LSP markup content to convert.\n * @returns The markup content as a Monaco editor markdown string.\n */\nexport function toMarkdownString(markupContent) {\n    return {\n        value: markupContent.value\n    };\n}\n", "import { fromRange, toRange } from './range.js';\n/**\n * Convert a Monaco editor single edit operation to an LSP text edit.\n *\n * @param singleEditOperation The Monaco single edit operation to convert.\n * @returns The single edit operation as an LSP text edit.\n */\nexport function fromSingleEditOperation(singleEditOperation) {\n    var _a;\n    return {\n        newText: (_a = singleEditOperation.text) !== null && _a !== void 0 ? _a : '',\n        range: fromRange(singleEditOperation.range)\n    };\n}\n/**\n * Convert an LSP text edit to a Monaco editor single edit operation.\n *\n * @param textEdit The LSP text edit to convert.\n * @returns The text edit as Monaco editor single edit operation.\n */\nexport function toSingleEditOperation(textEdit) {\n    return {\n        range: toRange(textEdit.range),\n        text: textEdit.newText\n    };\n}\n", "import { fromCommand, toCommand } from './command.js';\nimport { fromCompletionItemKind, toCompletionItemKind } from './completionItemKind.js';\nimport { fromCompletionItemTag, toCompletionItemTag } from './completionItemTag.js';\nimport { fromMarkdownString, toMarkdownString } from './markdownString.js';\nimport { getMonaco } from './monaco.js';\nimport { fromRange, toRange } from './range.js';\nimport { fromSingleEditOperation, toSingleEditOperation } from './singleEditOperation.js';\n/**\n * Convert a Monaco editor completion item range to an LSP completion item text edit.\n *\n * @param edit The Monaco completion item range to convert.\n * @param newText The text of the text edit.\n * @returns The completion item range as an LSP completion item text edit.\n */\nfunction fromCompletionItemRange(edit, newText) {\n    if ('insert' in edit) {\n        return {\n            newText,\n            insert: fromRange(edit.insert),\n            replace: fromRange(edit.replace)\n        };\n    }\n    return {\n        newText,\n        range: fromRange(edit)\n    };\n}\n/**\n * Convert a Monaco editor completion item to an LSP completion item.\n *\n * @param completionItem The Monaco completion item to convert.\n * @returns The completion item as an LSP completion item.\n */\nexport function fromCompletionItem(completionItem) {\n    const { CompletionItemInsertTextRule } = getMonaco().languages;\n    const result = {\n        kind: fromCompletionItemKind(completionItem.kind),\n        label: typeof completionItem.label === 'string' ? completionItem.label : completionItem.label.label,\n        textEdit: fromCompletionItemRange(completionItem.range, completionItem.insertText)\n    };\n    if (completionItem.additionalTextEdits) {\n        result.additionalTextEdits = completionItem.additionalTextEdits.map(fromSingleEditOperation);\n    }\n    if (completionItem.command) {\n        result.command = fromCommand(completionItem.command);\n    }\n    if (completionItem.commitCharacters) {\n        result.commitCharacters = completionItem.commitCharacters;\n    }\n    if (completionItem.detail != null) {\n        result.detail = completionItem.detail;\n    }\n    if (typeof completionItem.documentation === 'string') {\n        result.documentation = completionItem.documentation;\n    }\n    else if (completionItem.documentation) {\n        result.documentation = fromMarkdownString(completionItem.documentation);\n    }\n    if (completionItem.filterText != null) {\n        result.filterText = completionItem.filterText;\n    }\n    if (completionItem.insertTextRules === CompletionItemInsertTextRule.InsertAsSnippet) {\n        result.insertTextFormat = 2;\n    }\n    else if (completionItem.insertTextRules === CompletionItemInsertTextRule.KeepWhitespace) {\n        result.insertTextMode = 2;\n    }\n    if (completionItem.preselect != null) {\n        result.preselect = completionItem.preselect;\n    }\n    if (completionItem.sortText != null) {\n        result.sortText = completionItem.sortText;\n    }\n    if (completionItem.tags) {\n        result.tags = completionItem.tags.map(fromCompletionItemTag);\n    }\n    return result;\n}\n/**\n * Convert an LSP completion item text edit to a Monaco editor range.\n *\n * @param edit The LSP completion item text edit to convert.\n * @returns The completion item text edit as Monaco editor range.\n */\nfunction toCompletionItemRange(edit) {\n    if ('range' in edit) {\n        return toRange(edit.range);\n    }\n    if ('insert' in edit && 'replace' in edit) {\n        return {\n            insert: toRange(edit.insert),\n            replace: toRange(edit.replace)\n        };\n    }\n    return toRange(edit);\n}\n/**\n * Convert an LSP completion item to a Monaco editor completion item.\n *\n * @param completionItem The LSP completion item to convert.\n * @param options Additional options needed to construct the Monaco completion item.\n * @returns The completion item as Monaco editor completion item.\n */\nexport function toCompletionItem(completionItem, options) {\n    var _a, _b, _c, _d, _e;\n    const { CompletionItemInsertTextRule, CompletionItemKind } = getMonaco().languages;\n    const itemDefaults = (_a = options.itemDefaults) !== null && _a !== void 0 ? _a : {};\n    const textEdit = (_b = completionItem.textEdit) !== null && _b !== void 0 ? _b : itemDefaults.editRange;\n    const commitCharacters = (_c = completionItem.commitCharacters) !== null && _c !== void 0 ? _c : itemDefaults.commitCharacters;\n    const insertTextFormat = (_d = completionItem.insertTextFormat) !== null && _d !== void 0 ? _d : itemDefaults.insertTextFormat;\n    const insertTextMode = (_e = completionItem.insertTextMode) !== null && _e !== void 0 ? _e : itemDefaults.insertTextMode;\n    let text = completionItem.insertText;\n    let range;\n    if (textEdit) {\n        range = toCompletionItemRange(textEdit);\n        if ('newText' in textEdit) {\n            text = textEdit.newText;\n        }\n    }\n    else {\n        range = { ...options.range };\n    }\n    const result = {\n        insertText: text !== null && text !== void 0 ? text : '',\n        kind: completionItem.kind == null\n            ? CompletionItemKind.Text\n            : toCompletionItemKind(completionItem.kind),\n        label: completionItem.label,\n        range\n    };\n    if (completionItem.additionalTextEdits) {\n        result.additionalTextEdits = completionItem.additionalTextEdits.map(toSingleEditOperation);\n    }\n    if (completionItem.command) {\n        result.command = toCommand(completionItem.command);\n    }\n    if (commitCharacters) {\n        result.commitCharacters = commitCharacters;\n    }\n    if (completionItem.detail != null) {\n        result.detail = completionItem.detail;\n    }\n    if (typeof completionItem.documentation === 'string') {\n        result.documentation = completionItem.documentation;\n    }\n    else if (completionItem.documentation) {\n        result.documentation = toMarkdownString(completionItem.documentation);\n    }\n    if (completionItem.filterText != null) {\n        result.filterText = completionItem.filterText;\n    }\n    if (insertTextFormat === 2) {\n        result.insertTextRules = CompletionItemInsertTextRule.InsertAsSnippet;\n    }\n    else if (insertTextMode === 2) {\n        result.insertTextRules = CompletionItemInsertTextRule.KeepWhitespace;\n    }\n    if (completionItem.preselect != null) {\n        result.preselect = completionItem.preselect;\n    }\n    if (completionItem.sortText != null) {\n        result.sortText = completionItem.sortText;\n    }\n    if (completionItem.tags) {\n        result.tags = completionItem.tags.map(toCompletionItemTag);\n    }\n    return result;\n}\n", "import { fromCompletionItem, toCompletionItem } from './completionItem.js';\n/**\n * Convert a Monaco editor completion list to an LSP completion list.\n *\n * @param completionList The Monaco completion list to convert.\n * @returns The completion list as an LSP completion list.\n */\nexport function fromCompletionList(completionList) {\n    return {\n        isIncomplete: Boolean(completionList.incomplete),\n        items: completionList.suggestions.map(fromCompletionItem)\n    };\n}\n/**\n * Convert an LSP completion list to a Monaco editor completion list.\n *\n * @param completionList The LSP completion list to convert.\n * @param options Additional options needed to construct the Monaco completion list.\n * @returns The completion list as Monaco editor completion list.\n */\nexport function toCompletionList(completionList, options) {\n    return {\n        incomplete: Boolean(completionList.isIncomplete),\n        suggestions: completionList.items.map((item) => toCompletionItem(item, { range: options.range, itemDefaults: completionList.itemDefaults }))\n    };\n}\n", "import { fromMarkdownString, toMarkdownString } from './markdownString.js';\nimport { fromRange, toRange } from './range.js';\n/**\n * Convert a Monaco editor hover to an LSP hover.\n *\n * @param hover The Monaco hover to convert.\n * @returns The hover as an LSP hover.\n */\nexport function fromHover(hover) {\n    const result = {\n        contents: fromMarkdownString(hover.contents[0])\n    };\n    if (hover.range) {\n        result.range = fromRange(hover.range);\n    }\n    return result;\n}\n/**\n * Get value of a marked string.\n *\n * @param value The marked string to get the value from.\n * @returns The value of the marked string.\n */\nfunction getDeprecatedMarkupValue(value) {\n    if (typeof value === 'string') {\n        return { value };\n    }\n    return { value: `\\`\\`\\`${value.language}\\n${value.value}\\n\\`\\`\\`` };\n}\n/**\n * Convert LSP hover item contents to a Monaco markdown string.\n *\n * @param contents The LSP hover contents to convert.\n * @returns The hover contents as a Monaco markdown string.\n */\nfunction toHoverContents(contents) {\n    if (typeof contents === 'string' || 'language' in contents) {\n        return [getDeprecatedMarkupValue(contents)];\n    }\n    if (Array.isArray(contents)) {\n        return contents.map(getDeprecatedMarkupValue);\n    }\n    return [toMarkdownString(contents)];\n}\n/**\n * Convert an LSP hover to a Monaco editor hover.\n *\n * @param hover The LSP hover to convert.\n * @returns The hover as Monaco editor hover.\n */\nexport function toHover(hover) {\n    const result = {\n        contents: toHoverContents(hover.contents)\n    };\n    if (hover.range) {\n        result.range = toRange(hover.range);\n    }\n    return result;\n}\n", "/**\n * Convert a Monaco editor position to an LSP range.\n *\n * @param position The Monaco position to convert.\n * @returns The position as an LSP position.\n */\nexport function fromPosition(position) {\n    return { character: position.column - 1, line: position.lineNumber - 1 };\n}\n/**\n * Convert an LSP position to a Monaco editor position.\n *\n * @param position The LSP position to convert.\n * @returns The position as Monaco editor position.\n */\nexport function toPosition(position) {\n    return { lineNumber: position.line + 1, column: position.character + 1 };\n}\n", "/**\n * Register a marker data provider that can provide marker data for a model.\n *\n * @param monaco The Monaco editor module.\n * @param languageSelector The language id to register the provider for.\n * @param provider The provider that can provide marker data.\n * @returns A disposable.\n */\nexport function registerMarkerDataProvider(monaco, languageSelector, provider) {\n    const listeners = new Map();\n    const matchesLanguage = (model) => {\n        if (languageSelector === '*') {\n            return true;\n        }\n        const languageId = model.getLanguageId();\n        return Array.isArray(languageSelector)\n            ? languageSelector.includes(languageId)\n            : languageSelector === languageId;\n    };\n    const doValidate = async (model) => {\n        const markers = await provider.provideMarkerData(model);\n        // The model have have been disposed by the time marker data has been fetched.\n        if (!model.isDisposed() && matchesLanguage(model)) {\n            monaco.editor.setModelMarkers(model, provider.owner, markers ?? []);\n        }\n    };\n    const onModelAdd = (model) => {\n        if (!matchesLanguage(model)) {\n            return;\n        }\n        let handle;\n        listeners.set(String(model.uri), model.onDidChangeContent(() => {\n            clearTimeout(handle);\n            handle = setTimeout(() => {\n                doValidate(model);\n            }, 500);\n        }));\n        doValidate(model);\n    };\n    const onModelRemoved = (model) => {\n        monaco.editor.setModelMarkers(model, provider.owner, []);\n        const uriStr = String(model.uri);\n        const listener = listeners.get(uriStr);\n        if (listener) {\n            listener.dispose();\n            listeners.delete(uriStr);\n        }\n    };\n    const disposables = [\n        monaco.editor.onDidCreateModel(onModelAdd),\n        monaco.editor.onWillDisposeModel((model) => {\n            onModelRemoved(model);\n            provider.doReset?.(model);\n        }),\n        monaco.editor.onDidChangeModelLanguage((event) => {\n            onModelRemoved(event.model);\n            onModelAdd(event.model);\n            provider.doReset?.(event.model);\n        }),\n    ];\n    for (const model of monaco.editor.getModels()) {\n        onModelAdd(model);\n    }\n    return {\n        dispose() {\n            for (const uri of listeners.keys()) {\n                onModelRemoved(monaco.editor.getModel(monaco.Uri.parse(uri)));\n            }\n            while (disposables.length) {\n                disposables.pop().dispose();\n            }\n        },\n    };\n}\n", "/**\n * Create a worker manager.\n *\n * A worker manager is an object which deals with Monaco based web workers, such as cleanups and\n * idle timeouts.\n *\n * @param monaco - The Monaco editor module.\n * @param options - The options of the worker manager.\n * @returns The worker manager.\n */\nexport function createWorkerManager(monaco, options) {\n    let { createData, interval = 30_000, label, moduleId, stopWhenIdleFor = 120_000 } = options;\n    let worker;\n    let lastUsedTime = 0;\n    let disposed = false;\n    const stopWorker = () => {\n        if (worker) {\n            worker.dispose();\n            worker = undefined;\n        }\n    };\n    const intervalId = setInterval(() => {\n        if (!worker) {\n            return;\n        }\n        const timePassedSinceLastUsed = Date.now() - lastUsedTime;\n        if (timePassedSinceLastUsed > stopWhenIdleFor) {\n            stopWorker();\n        }\n    }, interval);\n    return {\n        dispose() {\n            disposed = true;\n            clearInterval(intervalId);\n            stopWorker();\n        },\n        getWorker(...resources) {\n            if (disposed) {\n                throw new Error('Worker manager has been disposed');\n            }\n            lastUsedTime = Date.now();\n            if (!worker) {\n                worker = monaco.editor.createWebWorker({\n                    createData,\n                    label,\n                    moduleId,\n                });\n            }\n            return worker.withSyncedResources(resources);\n        },\n        updateCreateData(newCreateData) {\n            createData = newCreateData;\n            stopWorker();\n        },\n    };\n}\n", "/**\n * Take input from [0, n] and return it as [0, 1]\n * @hidden\n */\nexport function bound01(n, max) {\n    if (isOnePointZero(n)) {\n        n = '100%';\n    }\n    var isPercent = isPercentage(n);\n    n = max === 360 ? n : Math.min(max, Math.max(0, parseFloat(n)));\n    // Automatically convert percentage into number\n    if (isPercent) {\n        n = parseInt(String(n * max), 10) / 100;\n    }\n    // Handle floating point rounding errors\n    if (Math.abs(n - max) < 0.000001) {\n        return 1;\n    }\n    // Convert into [0, 1] range if it isn't already\n    if (max === 360) {\n        // If n is a hue given in degrees,\n        // wrap around out-of-range values into [0, 360] range\n        // then convert into [0, 1].\n        n = (n < 0 ? (n % max) + max : n % max) / parseFloat(String(max));\n    }\n    else {\n        // If n not a hue given in degrees\n        // Convert into [0, 1] range if it isn't already.\n        n = (n % max) / parseFloat(String(max));\n    }\n    return n;\n}\n/**\n * Force a number between 0 and 1\n * @hidden\n */\nexport function clamp01(val) {\n    return Math.min(1, Math.max(0, val));\n}\n/**\n * Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n * <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\n * @hidden\n */\nexport function isOnePointZero(n) {\n    return typeof n === 'string' && n.indexOf('.') !== -1 && parseFloat(n) === 1;\n}\n/**\n * Check to see if string passed in is a percentage\n * @hidden\n */\nexport function isPercentage(n) {\n    return typeof n === 'string' && n.indexOf('%') !== -1;\n}\n/**\n * Return a valid alpha value [0,1] with all invalid values being set to 1\n * @hidden\n */\nexport function boundAlpha(a) {\n    a = parseFloat(a);\n    if (isNaN(a) || a < 0 || a > 1) {\n        a = 1;\n    }\n    return a;\n}\n/**\n * Replace a decimal with it's percentage value\n * @hidden\n */\nexport function convertToPercentage(n) {\n    if (n <= 1) {\n        return \"\".concat(Number(n) * 100, \"%\");\n    }\n    return n;\n}\n/**\n * Force a hex value to have 2 characters\n * @hidden\n */\nexport function pad2(c) {\n    return c.length === 1 ? '0' + c : String(c);\n}\n", "import { bound01, pad2 } from './util.js';\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n/**\n * Handle bounds / percentage checking to conform to CSS color spec\n * <http://www.w3.org/TR/css3-color/>\n * *Assumes:* r, g, b in [0, 255] or [0, 1]\n * *Returns:* { r, g, b } in [0, 255]\n */\nexport function rgbToRgb(r, g, b) {\n    return {\n        r: bound01(r, 255) * 255,\n        g: bound01(g, 255) * 255,\n        b: bound01(b, 255) * 255,\n    };\n}\n/**\n * Converts an RGB color value to HSL.\n * *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n * *Returns:* { h, s, l } in [0,1]\n */\nexport function rgbToHsl(r, g, b) {\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var h = 0;\n    var s = 0;\n    var l = (max + min) / 2;\n    if (max === min) {\n        s = 0;\n        h = 0; // achromatic\n    }\n    else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n            case r:\n                h = (g - b) / d + (g < b ? 6 : 0);\n                break;\n            case g:\n                h = (b - r) / d + 2;\n                break;\n            case b:\n                h = (r - g) / d + 4;\n                break;\n            default:\n                break;\n        }\n        h /= 6;\n    }\n    return { h: h, s: s, l: l };\n}\nfunction hue2rgb(p, q, t) {\n    if (t < 0) {\n        t += 1;\n    }\n    if (t > 1) {\n        t -= 1;\n    }\n    if (t < 1 / 6) {\n        return p + (q - p) * (6 * t);\n    }\n    if (t < 1 / 2) {\n        return q;\n    }\n    if (t < 2 / 3) {\n        return p + (q - p) * (2 / 3 - t) * 6;\n    }\n    return p;\n}\n/**\n * Converts an HSL color value to RGB.\n *\n * *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n * *Returns:* { r, g, b } in the set [0, 255]\n */\nexport function hslToRgb(h, s, l) {\n    var r;\n    var g;\n    var b;\n    h = bound01(h, 360);\n    s = bound01(s, 100);\n    l = bound01(l, 100);\n    if (s === 0) {\n        // achromatic\n        g = l;\n        b = l;\n        r = l;\n    }\n    else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1 / 3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1 / 3);\n    }\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n/**\n * Converts an RGB color value to HSV\n *\n * *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n * *Returns:* { h, s, v } in [0,1]\n */\nexport function rgbToHsv(r, g, b) {\n    r = bound01(r, 255);\n    g = bound01(g, 255);\n    b = bound01(b, 255);\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var h = 0;\n    var v = max;\n    var d = max - min;\n    var s = max === 0 ? 0 : d / max;\n    if (max === min) {\n        h = 0; // achromatic\n    }\n    else {\n        switch (max) {\n            case r:\n                h = (g - b) / d + (g < b ? 6 : 0);\n                break;\n            case g:\n                h = (b - r) / d + 2;\n                break;\n            case b:\n                h = (r - g) / d + 4;\n                break;\n            default:\n                break;\n        }\n        h /= 6;\n    }\n    return { h: h, s: s, v: v };\n}\n/**\n * Converts an HSV color value to RGB.\n *\n * *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n * *Returns:* { r, g, b } in the set [0, 255]\n */\nexport function hsvToRgb(h, s, v) {\n    h = bound01(h, 360) * 6;\n    s = bound01(s, 100);\n    v = bound01(v, 100);\n    var i = Math.floor(h);\n    var f = h - i;\n    var p = v * (1 - s);\n    var q = v * (1 - f * s);\n    var t = v * (1 - (1 - f) * s);\n    var mod = i % 6;\n    var r = [v, q, p, p, t, v][mod];\n    var g = [t, v, v, q, p, p][mod];\n    var b = [p, p, t, v, v, q][mod];\n    return { r: r * 255, g: g * 255, b: b * 255 };\n}\n/**\n * Converts an RGB color to hex\n *\n * Assumes r, g, and b are contained in the set [0, 255]\n * Returns a 3 or 6 character hex\n */\nexport function rgbToHex(r, g, b, allow3Char) {\n    var hex = [\n        pad2(Math.round(r).toString(16)),\n        pad2(Math.round(g).toString(16)),\n        pad2(Math.round(b).toString(16)),\n    ];\n    // Return a 3 character hex if possible\n    if (allow3Char &&\n        hex[0].startsWith(hex[0].charAt(1)) &&\n        hex[1].startsWith(hex[1].charAt(1)) &&\n        hex[2].startsWith(hex[2].charAt(1))) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n    }\n    return hex.join('');\n}\n/**\n * Converts an RGBA color plus alpha transparency to hex\n *\n * Assumes r, g, b are contained in the set [0, 255] and\n * a in [0, 1]. Returns a 4 or 8 character rgba hex\n */\n// eslint-disable-next-line max-params\nexport function rgbaToHex(r, g, b, a, allow4Char) {\n    var hex = [\n        pad2(Math.round(r).toString(16)),\n        pad2(Math.round(g).toString(16)),\n        pad2(Math.round(b).toString(16)),\n        pad2(convertDecimalToHex(a)),\n    ];\n    // Return a 4 character hex if possible\n    if (allow4Char &&\n        hex[0].startsWith(hex[0].charAt(1)) &&\n        hex[1].startsWith(hex[1].charAt(1)) &&\n        hex[2].startsWith(hex[2].charAt(1)) &&\n        hex[3].startsWith(hex[3].charAt(1))) {\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n    }\n    return hex.join('');\n}\n/**\n * Converts an RGBA color to an ARGB Hex8 string\n * Rarely used, but required for \"toFilter()\"\n */\nexport function rgbaToArgbHex(r, g, b, a) {\n    var hex = [\n        pad2(convertDecimalToHex(a)),\n        pad2(Math.round(r).toString(16)),\n        pad2(Math.round(g).toString(16)),\n        pad2(Math.round(b).toString(16)),\n    ];\n    return hex.join('');\n}\n/** Converts a decimal to a hex value */\nexport function convertDecimalToHex(d) {\n    return Math.round(parseFloat(d) * 255).toString(16);\n}\n/** Converts a hex value to a decimal */\nexport function convertHexToDecimal(h) {\n    return parseIntFromHex(h) / 255;\n}\n/** Parse a base-16 hex value into a base-10 integer */\nexport function parseIntFromHex(val) {\n    return parseInt(val, 16);\n}\nexport function numberInputToObject(color) {\n    return {\n        r: color >> 16,\n        g: (color & 0xff00) >> 8,\n        b: color & 0xff,\n    };\n}\n", "// https://github.com/bahamas10/css-color-names/blob/master/css-color-names.json\n/**\n * @hidden\n */\nexport var names = {\n    aliceblue: '#f0f8ff',\n    antiquewhite: '#faebd7',\n    aqua: '#00ffff',\n    aquamarine: '#7fffd4',\n    azure: '#f0ffff',\n    beige: '#f5f5dc',\n    bisque: '#ffe4c4',\n    black: '#000000',\n    blanchedalmond: '#ffebcd',\n    blue: '#0000ff',\n    blueviolet: '#8a2be2',\n    brown: '#a52a2a',\n    burlywood: '#deb887',\n    cadetblue: '#5f9ea0',\n    chartreuse: '#7fff00',\n    chocolate: '#d2691e',\n    coral: '#ff7f50',\n    cornflowerblue: '#6495ed',\n    cornsilk: '#fff8dc',\n    crimson: '#dc143c',\n    cyan: '#00ffff',\n    darkblue: '#00008b',\n    darkcyan: '#008b8b',\n    darkgoldenrod: '#b8860b',\n    darkgray: '#a9a9a9',\n    darkgreen: '#006400',\n    darkgrey: '#a9a9a9',\n    darkkhaki: '#bdb76b',\n    darkmagenta: '#8b008b',\n    darkolivegreen: '#556b2f',\n    darkorange: '#ff8c00',\n    darkorchid: '#9932cc',\n    darkred: '#8b0000',\n    darksalmon: '#e9967a',\n    darkseagreen: '#8fbc8f',\n    darkslateblue: '#483d8b',\n    darkslategray: '#2f4f4f',\n    darkslategrey: '#2f4f4f',\n    darkturquoise: '#00ced1',\n    darkviolet: '#9400d3',\n    deeppink: '#ff1493',\n    deepskyblue: '#00bfff',\n    dimgray: '#696969',\n    dimgrey: '#696969',\n    dodgerblue: '#1e90ff',\n    firebrick: '#b22222',\n    floralwhite: '#fffaf0',\n    forestgreen: '#228b22',\n    fuchsia: '#ff00ff',\n    gainsboro: '#dcdcdc',\n    ghostwhite: '#f8f8ff',\n    goldenrod: '#daa520',\n    gold: '#ffd700',\n    gray: '#808080',\n    green: '#008000',\n    greenyellow: '#adff2f',\n    grey: '#808080',\n    honeydew: '#f0fff0',\n    hotpink: '#ff69b4',\n    indianred: '#cd5c5c',\n    indigo: '#4b0082',\n    ivory: '#fffff0',\n    khaki: '#f0e68c',\n    lavenderblush: '#fff0f5',\n    lavender: '#e6e6fa',\n    lawngreen: '#7cfc00',\n    lemonchiffon: '#fffacd',\n    lightblue: '#add8e6',\n    lightcoral: '#f08080',\n    lightcyan: '#e0ffff',\n    lightgoldenrodyellow: '#fafad2',\n    lightgray: '#d3d3d3',\n    lightgreen: '#90ee90',\n    lightgrey: '#d3d3d3',\n    lightpink: '#ffb6c1',\n    lightsalmon: '#ffa07a',\n    lightseagreen: '#20b2aa',\n    lightskyblue: '#87cefa',\n    lightslategray: '#778899',\n    lightslategrey: '#778899',\n    lightsteelblue: '#b0c4de',\n    lightyellow: '#ffffe0',\n    lime: '#00ff00',\n    limegreen: '#32cd32',\n    linen: '#faf0e6',\n    magenta: '#ff00ff',\n    maroon: '#800000',\n    mediumaquamarine: '#66cdaa',\n    mediumblue: '#0000cd',\n    mediumorchid: '#ba55d3',\n    mediumpurple: '#9370db',\n    mediumseagreen: '#3cb371',\n    mediumslateblue: '#7b68ee',\n    mediumspringgreen: '#00fa9a',\n    mediumturquoise: '#48d1cc',\n    mediumvioletred: '#c71585',\n    midnightblue: '#191970',\n    mintcream: '#f5fffa',\n    mistyrose: '#ffe4e1',\n    moccasin: '#ffe4b5',\n    navajowhite: '#ffdead',\n    navy: '#000080',\n    oldlace: '#fdf5e6',\n    olive: '#808000',\n    olivedrab: '#6b8e23',\n    orange: '#ffa500',\n    orangered: '#ff4500',\n    orchid: '#da70d6',\n    palegoldenrod: '#eee8aa',\n    palegreen: '#98fb98',\n    paleturquoise: '#afeeee',\n    palevioletred: '#db7093',\n    papayawhip: '#ffefd5',\n    peachpuff: '#ffdab9',\n    peru: '#cd853f',\n    pink: '#ffc0cb',\n    plum: '#dda0dd',\n    powderblue: '#b0e0e6',\n    purple: '#800080',\n    rebeccapurple: '#663399',\n    red: '#ff0000',\n    rosybrown: '#bc8f8f',\n    royalblue: '#4169e1',\n    saddlebrown: '#8b4513',\n    salmon: '#fa8072',\n    sandybrown: '#f4a460',\n    seagreen: '#2e8b57',\n    seashell: '#fff5ee',\n    sienna: '#a0522d',\n    silver: '#c0c0c0',\n    skyblue: '#87ceeb',\n    slateblue: '#6a5acd',\n    slategray: '#708090',\n    slategrey: '#708090',\n    snow: '#fffafa',\n    springgreen: '#00ff7f',\n    steelblue: '#4682b4',\n    tan: '#d2b48c',\n    teal: '#008080',\n    thistle: '#d8bfd8',\n    tomato: '#ff6347',\n    turquoise: '#40e0d0',\n    violet: '#ee82ee',\n    wheat: '#f5deb3',\n    white: '#ffffff',\n    whitesmoke: '#f5f5f5',\n    yellow: '#ffff00',\n    yellowgreen: '#9acd32',\n};\n", "/* eslint-disable @typescript-eslint/no-redundant-type-constituents */\nimport { convertHexToDecimal, hslToRgb, hsvToRgb, parseIntFromHex, rgbToRgb, } from './conversion.js';\nimport { names } from './css-color-names.js';\nimport { boundAlpha, convertToPercentage } from './util.js';\n/**\n * Given a string or object, convert that input to RGB\n *\n * Possible string inputs:\n * ```\n * \"red\"\n * \"#f00\" or \"f00\"\n * \"#ff0000\" or \"ff0000\"\n * \"#ff000000\" or \"ff000000\"\n * \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n * \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n * \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n * \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n * \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n * \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n * \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n * ```\n */\nexport function inputToRGB(color) {\n    var rgb = { r: 0, g: 0, b: 0 };\n    var a = 1;\n    var s = null;\n    var v = null;\n    var l = null;\n    var ok = false;\n    var format = false;\n    if (typeof color === 'string') {\n        color = stringInputToObject(color);\n    }\n    if (typeof color === 'object') {\n        if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n            rgb = rgbToRgb(color.r, color.g, color.b);\n            ok = true;\n            format = String(color.r).substr(-1) === '%' ? 'prgb' : 'rgb';\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n            s = convertToPercentage(color.s);\n            v = convertToPercentage(color.v);\n            rgb = hsvToRgb(color.h, s, v);\n            ok = true;\n            format = 'hsv';\n        }\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n            s = convertToPercentage(color.s);\n            l = convertToPercentage(color.l);\n            rgb = hslToRgb(color.h, s, l);\n            ok = true;\n            format = 'hsl';\n        }\n        if (Object.prototype.hasOwnProperty.call(color, 'a')) {\n            a = color.a;\n        }\n    }\n    a = boundAlpha(a);\n    return {\n        ok: ok,\n        format: color.format || format,\n        r: Math.min(255, Math.max(rgb.r, 0)),\n        g: Math.min(255, Math.max(rgb.g, 0)),\n        b: Math.min(255, Math.max(rgb.b, 0)),\n        a: a,\n    };\n}\n// <http://www.w3.org/TR/css3-values/#integers>\nvar CSS_INTEGER = '[-\\\\+]?\\\\d+%?';\n// <http://www.w3.org/TR/css3-values/#number-value>\nvar CSS_NUMBER = '[-\\\\+]?\\\\d*\\\\.\\\\d+%?';\n// Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\nvar CSS_UNIT = \"(?:\".concat(CSS_NUMBER, \")|(?:\").concat(CSS_INTEGER, \")\");\n// Actual matching.\n// Parentheses and commas are optional, but not required.\n// Whitespace can take the place of commas or opening paren\nvar PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\".concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")\\\\s*\\\\)?\");\nvar PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\".concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")[,|\\\\s]+(\").concat(CSS_UNIT, \")\\\\s*\\\\)?\");\nvar matchers = {\n    CSS_UNIT: new RegExp(CSS_UNIT),\n    rgb: new RegExp('rgb' + PERMISSIVE_MATCH3),\n    rgba: new RegExp('rgba' + PERMISSIVE_MATCH4),\n    hsl: new RegExp('hsl' + PERMISSIVE_MATCH3),\n    hsla: new RegExp('hsla' + PERMISSIVE_MATCH4),\n    hsv: new RegExp('hsv' + PERMISSIVE_MATCH3),\n    hsva: new RegExp('hsva' + PERMISSIVE_MATCH4),\n    hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n    hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n};\n/**\n * Permissive string parsing.  Take in a number of formats, and output an object\n * based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\n */\nexport function stringInputToObject(color) {\n    color = color.trim().toLowerCase();\n    if (color.length === 0) {\n        return false;\n    }\n    var named = false;\n    if (names[color]) {\n        color = names[color];\n        named = true;\n    }\n    else if (color === 'transparent') {\n        return { r: 0, g: 0, b: 0, a: 0, format: 'name' };\n    }\n    // Try to match string input using regular expressions.\n    // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n    // Just return an object and let the conversion functions handle that.\n    // This way the result will be the same whether the tinycolor is initialized with string or object.\n    var match = matchers.rgb.exec(color);\n    if (match) {\n        return { r: match[1], g: match[2], b: match[3] };\n    }\n    match = matchers.rgba.exec(color);\n    if (match) {\n        return { r: match[1], g: match[2], b: match[3], a: match[4] };\n    }\n    match = matchers.hsl.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], l: match[3] };\n    }\n    match = matchers.hsla.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], l: match[3], a: match[4] };\n    }\n    match = matchers.hsv.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], v: match[3] };\n    }\n    match = matchers.hsva.exec(color);\n    if (match) {\n        return { h: match[1], s: match[2], v: match[3], a: match[4] };\n    }\n    match = matchers.hex8.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            a: convertHexToDecimal(match[4]),\n            format: named ? 'name' : 'hex8',\n        };\n    }\n    match = matchers.hex6.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1]),\n            g: parseIntFromHex(match[2]),\n            b: parseIntFromHex(match[3]),\n            format: named ? 'name' : 'hex',\n        };\n    }\n    match = matchers.hex4.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1] + match[1]),\n            g: parseIntFromHex(match[2] + match[2]),\n            b: parseIntFromHex(match[3] + match[3]),\n            a: convertHexToDecimal(match[4] + match[4]),\n            format: named ? 'name' : 'hex8',\n        };\n    }\n    match = matchers.hex3.exec(color);\n    if (match) {\n        return {\n            r: parseIntFromHex(match[1] + match[1]),\n            g: parseIntFromHex(match[2] + match[2]),\n            b: parseIntFromHex(match[3] + match[3]),\n            format: named ? 'name' : 'hex',\n        };\n    }\n    return false;\n}\n/**\n * Check to see if it looks like a CSS unit\n * (see `matchers` above for definition).\n */\nexport function isValidCSSUnit(color) {\n    return Boolean(matchers.CSS_UNIT.exec(String(color)));\n}\n", "import { numberInputToObject, rgbaToHex, rgbToHex, rgbToHsl, rgbToHsv } from './conversion.js';\nimport { names } from './css-color-names.js';\nimport { inputToRGB } from './format-input';\nimport { bound01, boundAlpha, clamp01 } from './util.js';\nvar TinyColor = /** @class */ (function () {\n    function TinyColor(color, opts) {\n        if (color === void 0) { color = ''; }\n        if (opts === void 0) { opts = {}; }\n        var _a;\n        // If input is already a tinycolor, return itself\n        if (color instanceof TinyColor) {\n            // eslint-disable-next-line no-constructor-return\n            return color;\n        }\n        if (typeof color === 'number') {\n            color = numberInputToObject(color);\n        }\n        this.originalInput = color;\n        var rgb = inputToRGB(color);\n        this.originalInput = color;\n        this.r = rgb.r;\n        this.g = rgb.g;\n        this.b = rgb.b;\n        this.a = rgb.a;\n        this.roundA = Math.round(100 * this.a) / 100;\n        this.format = (_a = opts.format) !== null && _a !== void 0 ? _a : rgb.format;\n        this.gradientType = opts.gradientType;\n        // Don't let the range of [0,255] come back in [0,1].\n        // Potentially lose a little bit of precision here, but will fix issues where\n        // .5 gets interpreted as half of the total, instead of half of 1\n        // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n        if (this.r < 1) {\n            this.r = Math.round(this.r);\n        }\n        if (this.g < 1) {\n            this.g = Math.round(this.g);\n        }\n        if (this.b < 1) {\n            this.b = Math.round(this.b);\n        }\n        this.isValid = rgb.ok;\n    }\n    TinyColor.prototype.isDark = function () {\n        return this.getBrightness() < 128;\n    };\n    TinyColor.prototype.isLight = function () {\n        return !this.isDark();\n    };\n    /**\n     * Returns the perceived brightness of the color, from 0-255.\n     */\n    TinyColor.prototype.getBrightness = function () {\n        // http://www.w3.org/TR/AERT#color-contrast\n        var rgb = this.toRgb();\n        return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n    };\n    /**\n     * Returns the perceived luminance of a color, from 0-1.\n     */\n    TinyColor.prototype.getLuminance = function () {\n        // http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n        var rgb = this.toRgb();\n        var R;\n        var G;\n        var B;\n        var RsRGB = rgb.r / 255;\n        var GsRGB = rgb.g / 255;\n        var BsRGB = rgb.b / 255;\n        if (RsRGB <= 0.03928) {\n            R = RsRGB / 12.92;\n        }\n        else {\n            // eslint-disable-next-line prefer-exponentiation-operator\n            R = Math.pow((RsRGB + 0.055) / 1.055, 2.4);\n        }\n        if (GsRGB <= 0.03928) {\n            G = GsRGB / 12.92;\n        }\n        else {\n            // eslint-disable-next-line prefer-exponentiation-operator\n            G = Math.pow((GsRGB + 0.055) / 1.055, 2.4);\n        }\n        if (BsRGB <= 0.03928) {\n            B = BsRGB / 12.92;\n        }\n        else {\n            // eslint-disable-next-line prefer-exponentiation-operator\n            B = Math.pow((BsRGB + 0.055) / 1.055, 2.4);\n        }\n        return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n    };\n    /**\n     * Returns the alpha value of a color, from 0-1.\n     */\n    TinyColor.prototype.getAlpha = function () {\n        return this.a;\n    };\n    /**\n     * Sets the alpha value on the current color.\n     *\n     * @param alpha - The new alpha value. The accepted range is 0-1.\n     */\n    TinyColor.prototype.setAlpha = function (alpha) {\n        this.a = boundAlpha(alpha);\n        this.roundA = Math.round(100 * this.a) / 100;\n        return this;\n    };\n    /**\n     * Returns whether the color is monochrome.\n     */\n    TinyColor.prototype.isMonochrome = function () {\n        var s = this.toHsl().s;\n        return s === 0;\n    };\n    /**\n     * Returns the object as a HSVA object.\n     */\n    TinyColor.prototype.toHsv = function () {\n        var hsv = rgbToHsv(this.r, this.g, this.b);\n        return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this.a };\n    };\n    /**\n     * Returns the hsva values interpolated into a string with the following format:\n     * \"hsva(xxx, xxx, xxx, xx)\".\n     */\n    TinyColor.prototype.toHsvString = function () {\n        var hsv = rgbToHsv(this.r, this.g, this.b);\n        var h = Math.round(hsv.h * 360);\n        var s = Math.round(hsv.s * 100);\n        var v = Math.round(hsv.v * 100);\n        return this.a === 1 ? \"hsv(\".concat(h, \", \").concat(s, \"%, \").concat(v, \"%)\") : \"hsva(\".concat(h, \", \").concat(s, \"%, \").concat(v, \"%, \").concat(this.roundA, \")\");\n    };\n    /**\n     * Returns the object as a HSLA object.\n     */\n    TinyColor.prototype.toHsl = function () {\n        var hsl = rgbToHsl(this.r, this.g, this.b);\n        return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this.a };\n    };\n    /**\n     * Returns the hsla values interpolated into a string with the following format:\n     * \"hsla(xxx, xxx, xxx, xx)\".\n     */\n    TinyColor.prototype.toHslString = function () {\n        var hsl = rgbToHsl(this.r, this.g, this.b);\n        var h = Math.round(hsl.h * 360);\n        var s = Math.round(hsl.s * 100);\n        var l = Math.round(hsl.l * 100);\n        return this.a === 1 ? \"hsl(\".concat(h, \", \").concat(s, \"%, \").concat(l, \"%)\") : \"hsla(\".concat(h, \", \").concat(s, \"%, \").concat(l, \"%, \").concat(this.roundA, \")\");\n    };\n    /**\n     * Returns the hex value of the color.\n     * @param allow3Char will shorten hex value to 3 char if possible\n     */\n    TinyColor.prototype.toHex = function (allow3Char) {\n        if (allow3Char === void 0) { allow3Char = false; }\n        return rgbToHex(this.r, this.g, this.b, allow3Char);\n    };\n    /**\n     * Returns the hex value of the color -with a # prefixed.\n     * @param allow3Char will shorten hex value to 3 char if possible\n     */\n    TinyColor.prototype.toHexString = function (allow3Char) {\n        if (allow3Char === void 0) { allow3Char = false; }\n        return '#' + this.toHex(allow3Char);\n    };\n    /**\n     * Returns the hex 8 value of the color.\n     * @param allow4Char will shorten hex value to 4 char if possible\n     */\n    TinyColor.prototype.toHex8 = function (allow4Char) {\n        if (allow4Char === void 0) { allow4Char = false; }\n        return rgbaToHex(this.r, this.g, this.b, this.a, allow4Char);\n    };\n    /**\n     * Returns the hex 8 value of the color -with a # prefixed.\n     * @param allow4Char will shorten hex value to 4 char if possible\n     */\n    TinyColor.prototype.toHex8String = function (allow4Char) {\n        if (allow4Char === void 0) { allow4Char = false; }\n        return '#' + this.toHex8(allow4Char);\n    };\n    /**\n     * Returns the shorter hex value of the color depends on its alpha -with a # prefixed.\n     * @param allowShortChar will shorten hex value to 3 or 4 char if possible\n     */\n    TinyColor.prototype.toHexShortString = function (allowShortChar) {\n        if (allowShortChar === void 0) { allowShortChar = false; }\n        return this.a === 1 ? this.toHexString(allowShortChar) : this.toHex8String(allowShortChar);\n    };\n    /**\n     * Returns the object as a RGBA object.\n     */\n    TinyColor.prototype.toRgb = function () {\n        return {\n            r: Math.round(this.r),\n            g: Math.round(this.g),\n            b: Math.round(this.b),\n            a: this.a,\n        };\n    };\n    /**\n     * Returns the RGBA values interpolated into a string with the following format:\n     * \"RGBA(xxx, xxx, xxx, xx)\".\n     */\n    TinyColor.prototype.toRgbString = function () {\n        var r = Math.round(this.r);\n        var g = Math.round(this.g);\n        var b = Math.round(this.b);\n        return this.a === 1 ? \"rgb(\".concat(r, \", \").concat(g, \", \").concat(b, \")\") : \"rgba(\".concat(r, \", \").concat(g, \", \").concat(b, \", \").concat(this.roundA, \")\");\n    };\n    /**\n     * Returns the object as a RGBA object.\n     */\n    TinyColor.prototype.toPercentageRgb = function () {\n        var fmt = function (x) { return \"\".concat(Math.round(bound01(x, 255) * 100), \"%\"); };\n        return {\n            r: fmt(this.r),\n            g: fmt(this.g),\n            b: fmt(this.b),\n            a: this.a,\n        };\n    };\n    /**\n     * Returns the RGBA relative values interpolated into a string\n     */\n    TinyColor.prototype.toPercentageRgbString = function () {\n        var rnd = function (x) { return Math.round(bound01(x, 255) * 100); };\n        return this.a === 1\n            ? \"rgb(\".concat(rnd(this.r), \"%, \").concat(rnd(this.g), \"%, \").concat(rnd(this.b), \"%)\")\n            : \"rgba(\".concat(rnd(this.r), \"%, \").concat(rnd(this.g), \"%, \").concat(rnd(this.b), \"%, \").concat(this.roundA, \")\");\n    };\n    /**\n     * The 'real' name of the color -if there is one.\n     */\n    TinyColor.prototype.toName = function () {\n        if (this.a === 0) {\n            return 'transparent';\n        }\n        if (this.a < 1) {\n            return false;\n        }\n        var hex = '#' + rgbToHex(this.r, this.g, this.b, false);\n        for (var _i = 0, _a = Object.entries(names); _i < _a.length; _i++) {\n            var _b = _a[_i], key = _b[0], value = _b[1];\n            if (hex === value) {\n                return key;\n            }\n        }\n        return false;\n    };\n    TinyColor.prototype.toString = function (format) {\n        var formatSet = Boolean(format);\n        format = format !== null && format !== void 0 ? format : this.format;\n        var formattedString = false;\n        var hasAlpha = this.a < 1 && this.a >= 0;\n        var needsAlphaFormat = !formatSet && hasAlpha && (format.startsWith('hex') || format === 'name');\n        if (needsAlphaFormat) {\n            // Special case for \"transparent\", all other non-alpha formats\n            // will return rgba when there is transparency.\n            if (format === 'name' && this.a === 0) {\n                return this.toName();\n            }\n            return this.toRgbString();\n        }\n        if (format === 'rgb') {\n            formattedString = this.toRgbString();\n        }\n        if (format === 'prgb') {\n            formattedString = this.toPercentageRgbString();\n        }\n        if (format === 'hex' || format === 'hex6') {\n            formattedString = this.toHexString();\n        }\n        if (format === 'hex3') {\n            formattedString = this.toHexString(true);\n        }\n        if (format === 'hex4') {\n            formattedString = this.toHex8String(true);\n        }\n        if (format === 'hex8') {\n            formattedString = this.toHex8String();\n        }\n        if (format === 'name') {\n            formattedString = this.toName();\n        }\n        if (format === 'hsl') {\n            formattedString = this.toHslString();\n        }\n        if (format === 'hsv') {\n            formattedString = this.toHsvString();\n        }\n        return formattedString || this.toHexString();\n    };\n    TinyColor.prototype.toNumber = function () {\n        return (Math.round(this.r) << 16) + (Math.round(this.g) << 8) + Math.round(this.b);\n    };\n    TinyColor.prototype.clone = function () {\n        return new TinyColor(this.toString());\n    };\n    /**\n     * Lighten the color a given amount. Providing 100 will always return white.\n     * @param amount - valid between 1-100\n     */\n    TinyColor.prototype.lighten = function (amount) {\n        if (amount === void 0) { amount = 10; }\n        var hsl = this.toHsl();\n        hsl.l += amount / 100;\n        hsl.l = clamp01(hsl.l);\n        return new TinyColor(hsl);\n    };\n    /**\n     * Brighten the color a given amount, from 0 to 100.\n     * @param amount - valid between 1-100\n     */\n    TinyColor.prototype.brighten = function (amount) {\n        if (amount === void 0) { amount = 10; }\n        var rgb = this.toRgb();\n        rgb.r = Math.max(0, Math.min(255, rgb.r - Math.round(255 * -(amount / 100))));\n        rgb.g = Math.max(0, Math.min(255, rgb.g - Math.round(255 * -(amount / 100))));\n        rgb.b = Math.max(0, Math.min(255, rgb.b - Math.round(255 * -(amount / 100))));\n        return new TinyColor(rgb);\n    };\n    /**\n     * Darken the color a given amount, from 0 to 100.\n     * Providing 100 will always return black.\n     * @param amount - valid between 1-100\n     */\n    TinyColor.prototype.darken = function (amount) {\n        if (amount === void 0) { amount = 10; }\n        var hsl = this.toHsl();\n        hsl.l -= amount / 100;\n        hsl.l = clamp01(hsl.l);\n        return new TinyColor(hsl);\n    };\n    /**\n     * Mix the color with pure white, from 0 to 100.\n     * Providing 0 will do nothing, providing 100 will always return white.\n     * @param amount - valid between 1-100\n     */\n    TinyColor.prototype.tint = function (amount) {\n        if (amount === void 0) { amount = 10; }\n        return this.mix('white', amount);\n    };\n    /**\n     * Mix the color with pure black, from 0 to 100.\n     * Providing 0 will do nothing, providing 100 will always return black.\n     * @param amount - valid between 1-100\n     */\n    TinyColor.prototype.shade = function (amount) {\n        if (amount === void 0) { amount = 10; }\n        return this.mix('black', amount);\n    };\n    /**\n     * Desaturate the color a given amount, from 0 to 100.\n     * Providing 100 will is the same as calling greyscale\n     * @param amount - valid between 1-100\n     */\n    TinyColor.prototype.desaturate = function (amount) {\n        if (amount === void 0) { amount = 10; }\n        var hsl = this.toHsl();\n        hsl.s -= amount / 100;\n        hsl.s = clamp01(hsl.s);\n        return new TinyColor(hsl);\n    };\n    /**\n     * Saturate the color a given amount, from 0 to 100.\n     * @param amount - valid between 1-100\n     */\n    TinyColor.prototype.saturate = function (amount) {\n        if (amount === void 0) { amount = 10; }\n        var hsl = this.toHsl();\n        hsl.s += amount / 100;\n        hsl.s = clamp01(hsl.s);\n        return new TinyColor(hsl);\n    };\n    /**\n     * Completely desaturates a color into greyscale.\n     * Same as calling `desaturate(100)`\n     */\n    TinyColor.prototype.greyscale = function () {\n        return this.desaturate(100);\n    };\n    /**\n     * Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n     * Values outside of this range will be wrapped into this range.\n     */\n    TinyColor.prototype.spin = function (amount) {\n        var hsl = this.toHsl();\n        var hue = (hsl.h + amount) % 360;\n        hsl.h = hue < 0 ? 360 + hue : hue;\n        return new TinyColor(hsl);\n    };\n    /**\n     * Mix the current color a given amount with another color, from 0 to 100.\n     * 0 means no mixing (return current color).\n     */\n    TinyColor.prototype.mix = function (color, amount) {\n        if (amount === void 0) { amount = 50; }\n        var rgb1 = this.toRgb();\n        var rgb2 = new TinyColor(color).toRgb();\n        var p = amount / 100;\n        var rgba = {\n            r: (rgb2.r - rgb1.r) * p + rgb1.r,\n            g: (rgb2.g - rgb1.g) * p + rgb1.g,\n            b: (rgb2.b - rgb1.b) * p + rgb1.b,\n            a: (rgb2.a - rgb1.a) * p + rgb1.a,\n        };\n        return new TinyColor(rgba);\n    };\n    TinyColor.prototype.analogous = function (results, slices) {\n        if (results === void 0) { results = 6; }\n        if (slices === void 0) { slices = 30; }\n        var hsl = this.toHsl();\n        var part = 360 / slices;\n        var ret = [this];\n        for (hsl.h = (hsl.h - ((part * results) >> 1) + 720) % 360; --results;) {\n            hsl.h = (hsl.h + part) % 360;\n            ret.push(new TinyColor(hsl));\n        }\n        return ret;\n    };\n    /**\n     * taken from https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js\n     */\n    TinyColor.prototype.complement = function () {\n        var hsl = this.toHsl();\n        hsl.h = (hsl.h + 180) % 360;\n        return new TinyColor(hsl);\n    };\n    TinyColor.prototype.monochromatic = function (results) {\n        if (results === void 0) { results = 6; }\n        var hsv = this.toHsv();\n        var h = hsv.h;\n        var s = hsv.s;\n        var v = hsv.v;\n        var res = [];\n        var modification = 1 / results;\n        while (results--) {\n            res.push(new TinyColor({ h: h, s: s, v: v }));\n            v = (v + modification) % 1;\n        }\n        return res;\n    };\n    TinyColor.prototype.splitcomplement = function () {\n        var hsl = this.toHsl();\n        var h = hsl.h;\n        return [\n            this,\n            new TinyColor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l }),\n            new TinyColor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l }),\n        ];\n    };\n    /**\n     * Compute how the color would appear on a background\n     */\n    TinyColor.prototype.onBackground = function (background) {\n        var fg = this.toRgb();\n        var bg = new TinyColor(background).toRgb();\n        var alpha = fg.a + bg.a * (1 - fg.a);\n        return new TinyColor({\n            r: (fg.r * fg.a + bg.r * bg.a * (1 - fg.a)) / alpha,\n            g: (fg.g * fg.a + bg.g * bg.a * (1 - fg.a)) / alpha,\n            b: (fg.b * fg.a + bg.b * bg.a * (1 - fg.a)) / alpha,\n            a: alpha,\n        });\n    };\n    /**\n     * Alias for `polyad(3)`\n     */\n    TinyColor.prototype.triad = function () {\n        return this.polyad(3);\n    };\n    /**\n     * Alias for `polyad(4)`\n     */\n    TinyColor.prototype.tetrad = function () {\n        return this.polyad(4);\n    };\n    /**\n     * Get polyad colors, like (for 1, 2, 3, 4, 5, 6, 7, 8, etc...)\n     * monad, dyad, triad, tetrad, pentad, hexad, heptad, octad, etc...\n     */\n    TinyColor.prototype.polyad = function (n) {\n        var hsl = this.toHsl();\n        var h = hsl.h;\n        var result = [this];\n        var increment = 360 / n;\n        for (var i = 1; i < n; i++) {\n            result.push(new TinyColor({ h: (h + i * increment) % 360, s: hsl.s, l: hsl.l }));\n        }\n        return result;\n    };\n    /**\n     * compare color vs current color\n     */\n    TinyColor.prototype.equals = function (color) {\n        return this.toRgbString() === new TinyColor(color).toRgbString();\n    };\n    return TinyColor;\n}());\nexport { TinyColor };\n// kept for backwards compatability with v1\nexport function tinycolor(color, opts) {\n    if (color === void 0) { color = ''; }\n    if (opts === void 0) { opts = {}; }\n    return new TinyColor(color, opts);\n}\n", "import { TinyColor } from './index.js';\nimport { convertToPercentage } from './util.js';\n/**\n * If input is an object, force 1 into \"1.0\" to handle ratios properly\n * String input requires \"1.0\" as input, so 1 will be treated as 1\n */\nexport function fromRatio(ratio, opts) {\n    var newColor = {\n        r: convertToPercentage(ratio.r),\n        g: convertToPercentage(ratio.g),\n        b: convertToPercentage(ratio.b),\n    };\n    if (ratio.a !== undefined) {\n        newColor.a = Number(ratio.a);\n    }\n    return new TinyColor(newColor, opts);\n}\n/** old random function */\nexport function legacyRandom() {\n    return new TinyColor({\n        r: Math.random(),\n        g: Math.random(),\n        b: Math.random(),\n    });\n}\n", "import { setMonaco } from 'monaco-languageserver-types';\nimport { registerMarkerDataProvider } from 'monaco-marker-data-provider';\nimport { MonacoTailwindcssOptions } from 'monaco-tailwindcss';\nimport { createWorkerManager } from 'monaco-worker-manager';\n\nimport {\n  createColorProvider,\n  createCompletionItemProvider,\n  createHoverProvider,\n  createMarkerDataProvider,\n} from './languageFeatures.js';\nimport { TailwindcssWorker } from './tailwindcss.worker.js';\n\nexport const defaultLanguageSelector = ['css', 'javascript', 'html', 'mdx', 'typescript'] as const;\n\nexport { tailwindcssData } from './cssData.js';\n\nexport const configureMonacoTailwindcss: typeof import('monaco-tailwindcss').configureMonacoTailwindcss =\n  (monaco, { languageSelector = defaultLanguageSelector, tailwindConfig } = {}) => {\n    setMonaco(monaco);\n\n    const workerManager = createWorkerManager<TailwindcssWorker, MonacoTailwindcssOptions>(monaco, {\n      label: 'tailwindcss',\n      moduleId: 'monaco-tailwindcss/tailwindcss.worker',\n      createData: { tailwindConfig },\n    });\n\n    const disposables = [\n      workerManager,\n      monaco.languages.registerColorProvider(\n        languageSelector,\n        createColorProvider(monaco, workerManager.getWorker),\n      ),\n      monaco.languages.registerCompletionItemProvider(\n        languageSelector,\n        createCompletionItemProvider(workerManager.getWorker),\n      ),\n      monaco.languages.registerHoverProvider(\n        languageSelector,\n        createHoverProvider(workerManager.getWorker),\n      ),\n    ];\n\n    // Monaco editor doesn\u2019t provide a function to match language selectors, so let\u2019s just support\n    // strings here.\n    for (const language of Array.isArray(languageSelector)\n      ? languageSelector\n      : [languageSelector]) {\n      if (typeof language === 'string') {\n        disposables.push(\n          registerMarkerDataProvider(\n            monaco,\n            language,\n            createMarkerDataProvider(workerManager.getWorker),\n          ),\n        );\n      }\n    }\n\n    return {\n      dispose() {\n        for (const disposable of disposables) {\n          disposable.dispose();\n        }\n      },\n\n      setTailwindConfig(newTailwindConfig) {\n        workerManager.updateCreateData({ tailwindConfig: newTailwindConfig });\n      },\n\n      async generateStylesFromContent(css, contents) {\n        const client = await workerManager.getWorker();\n\n        return client.generateStylesFromContent(\n          css,\n          contents.map((content) => (typeof content === 'string' ? { content } : content)),\n        );\n      },\n    };\n  };\n", "import { fromRatio, names as namedColors } from '@ctrl/tinycolor';\nimport {\n  fromCompletionContext,\n  fromCompletionItem,\n  fromPosition,\n  toColorInformation,\n  toCompletionItem,\n  toCompletionList,\n  toHover,\n  toMarkerData,\n} from 'monaco-languageserver-types';\nimport { MarkerDataProvider } from 'monaco-marker-data-provider';\nimport { editor, languages, MonacoEditor } from 'monaco-types';\nimport { WorkerGetter } from 'monaco-worker-manager';\n\nimport { TailwindcssWorker } from './tailwindcss.worker.js';\n\ntype WorkerAccessor = WorkerGetter<TailwindcssWorker>;\n\nconst colorNames = Object.values(namedColors);\nconst editableColorRegex = new RegExp(\n  `-\\\\[(${colorNames.join('|')}|((?:#|rgba?\\\\(|hsla?\\\\())[^\\\\]]+)\\\\]$`,\n);\nconst stylesheet = document.createElement('style');\ndocument.head.append(stylesheet);\n\nfunction colorValueToHex(value: number): string {\n  return Math.round(value * 255)\n    .toString(16)\n    .padStart(2, '0');\n}\n\nfunction createColorClass(color: languages.IColor): string {\n  const hex = `${colorValueToHex(color.red)}${colorValueToHex(color.green)}${colorValueToHex(\n    color.blue,\n  )}`;\n  const className = `tailwindcss-color-decoration-${hex}`;\n  const selector = `.${className}`;\n  for (const rule of stylesheet.sheet!.cssRules) {\n    if ((rule as CSSStyleRule).selectorText === selector) {\n      return className;\n    }\n  }\n  stylesheet.sheet!.insertRule(`${selector}{background-color:#${hex}}`);\n  return className;\n}\n\nexport function createColorProvider(\n  monaco: MonacoEditor,\n  getWorker: WorkerAccessor,\n): languages.DocumentColorProvider {\n  const modelMap = new WeakMap<editor.ITextModel, string[]>();\n\n  monaco.editor.onWillDisposeModel((model) => {\n    modelMap.delete(model);\n  });\n\n  return {\n    async provideDocumentColors(model) {\n      const worker = await getWorker(model.uri);\n\n      const editableColors: languages.IColorInformation[] = [];\n      const nonEditableColors: languages.IColorInformation[] = [];\n      const colors = await worker.getDocumentColors(String(model.uri), model.getLanguageId());\n      for (const lsColor of colors) {\n        const monacoColor = toColorInformation(lsColor);\n        const text = model.getValueInRange(monacoColor.range);\n        if (editableColorRegex.test(text)) {\n          editableColors.push(monacoColor);\n        } else {\n          nonEditableColors.push(monacoColor);\n        }\n      }\n\n      modelMap.set(\n        model,\n        model.deltaDecorations(\n          modelMap.get(model) ?? [],\n          nonEditableColors.map(({ color, range }) => ({\n            range,\n            options: {\n              before: {\n                content: '\\u00A0',\n                inlineClassName: `${createColorClass(color)} colorpicker-color-decoration`,\n                inlineClassNameAffectsLetterSpacing: true,\n              },\n            },\n          })),\n        ),\n      );\n\n      return editableColors;\n    },\n\n    provideColorPresentations(model, colorInformation) {\n      const className = model.getValueInRange(colorInformation.range);\n      const match = new RegExp(\n        `-\\\\[(${colorNames.join('|')}|(?:(?:#|rgba?\\\\(|hsla?\\\\())[^\\\\]]+)\\\\]$`,\n        'i',\n      ).exec(className);\n\n      if (!match) {\n        return [];\n      }\n\n      const [currentColor] = match;\n\n      const isNamedColor = colorNames.includes(currentColor);\n      const color = fromRatio({\n        r: colorInformation.color.red,\n        g: colorInformation.color.green,\n        b: colorInformation.color.blue,\n        a: colorInformation.color.alpha,\n      });\n\n      let hexValue = color.toHex8String(\n        !isNamedColor && (currentColor.length === 4 || currentColor.length === 5),\n      );\n      if (hexValue.length === 5) {\n        hexValue = hexValue.replace(/f$/, '');\n      } else if (hexValue.length === 9) {\n        hexValue = hexValue.replace(/ff$/, '');\n      }\n\n      const rgbValue = color.toRgbString().replace(/ /g, '');\n      const hslValue = color.toHslString().replace(/ /g, '');\n      const prefix = className.slice(0, Math.max(0, match.index));\n\n      return [\n        { label: `${prefix}-[${hexValue}]` },\n        { label: `${prefix}-[${rgbValue}]` },\n        { label: `${prefix}-[${hslValue}]` },\n      ];\n    },\n  };\n}\n\nexport function createHoverProvider(getWorker: WorkerAccessor): languages.HoverProvider {\n  return {\n    async provideHover(model, position) {\n      const worker = await getWorker(model.uri);\n\n      const hover = await worker.doHover(\n        String(model.uri),\n        model.getLanguageId(),\n        fromPosition(position),\n      );\n\n      return hover && toHover(hover);\n    },\n  };\n}\n\nexport function createCompletionItemProvider(\n  getWorker: WorkerAccessor,\n): languages.CompletionItemProvider {\n  return {\n    async provideCompletionItems(model, position, context) {\n      const worker = await getWorker(model.uri);\n\n      const completionList = await worker.doComplete(\n        String(model.uri),\n        model.getLanguageId(),\n        fromPosition(position),\n        fromCompletionContext(context),\n      );\n\n      if (!completionList) {\n        return;\n      }\n\n      const wordInfo = model.getWordUntilPosition(position);\n\n      return toCompletionList(completionList, {\n        range: {\n          startLineNumber: position.lineNumber,\n          startColumn: wordInfo.startColumn,\n          endLineNumber: position.lineNumber,\n          endColumn: wordInfo.endColumn,\n        },\n      });\n    },\n\n    async resolveCompletionItem(item) {\n      const worker = await getWorker();\n\n      const result = await worker.resolveCompletionItem(fromCompletionItem(item));\n\n      return toCompletionItem(result, { range: item.range });\n    },\n  };\n}\n\nexport function createMarkerDataProvider(getWorker: WorkerAccessor): MarkerDataProvider {\n  return {\n    owner: 'tailwindcss',\n    async provideMarkerData(model) {\n      const worker = await getWorker(model.uri);\n\n      const diagnostics = await worker.doValidate(String(model.uri), model.getLanguageId());\n\n      return diagnostics.map((diagnostic) => toMarkerData(diagnostic));\n    },\n  };\n}\n", "import { languages } from 'monaco-types';\n\nfunction createTailwindDirective(name: string, value: string): languages.css.IAtDirectiveData {\n  return {\n    name: `@${name}`,\n    description: { kind: 'markdown', value },\n    references: [\n      {\n        name: `@${name} documentation`,\n        url: `https://tailwindcss.com/docs/functions-and-directives#${name}`,\n      },\n    ],\n  };\n}\n\n// The descriptions have been taken from\n// https://github.com/tailwindlabs/tailwindcss.com/blob/master/src/pages/docs/functions-and-directives.mdx\n\nconst tailwindDirective = createTailwindDirective(\n  'tailwind',\n  `Use the \\`@tailwind\\` directive to insert Tailwind's \\`base\\`, \\`components\\`, \\`utilities\\` and \\`variants\\` styles into your CSS.\n\n\\`\\`\\`css\n/**\n * This injects Tailwind's base styles and any base styles registered by\n * plugins.\n */\n@tailwind base;\n\n/**\n * This injects Tailwind's component classes and any component classes\n * registered by plugins.\n */\n@tailwind components;\n\n/**\n * This injects Tailwind's utility classes and any utility classes registered\n * by plugins.\n */\n@tailwind utilities;\n\n/**\n * Use this directive to control where Tailwind injects the hover, focus,\n * responsive, dark mode, and other variants of each class.\n *\n * If omitted, Tailwind will append these classes to the very end of\n * your stylesheet by default.\n */\n@tailwind variants;\n\\`\\`\\``,\n);\n\nconst layerDirective = createTailwindDirective(\n  'layer',\n  `Use the \\`@layer\\` directive to tell Tailwind which \"bucket\" a set of custom styles belong to. Valid layers are \\`base\\`, \\`components\\`, and \\`utilities\\`.\n\n\\`\\`\\`css\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  h1 {\n    @apply text-2xl;\n  }\n  h2 {\n    @apply text-xl;\n  }\n}\n\n@layer components {\n  .btn-blue {\n    @apply bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded;\n  }\n}\n\n@layer utilities {\n  .filter-none {\n    filter: none;\n  }\n  .filter-grayscale {\n    filter: grayscale(100%);\n  }\n}\n\\`\\`\\`\n\nTailwind will automatically move any CSS within a \\`@layer\\` directive to the same place as the corresponding \\`@tailwind\\` rule, so you don't have to worry about authoring your CSS in a specific order to avoid specificity issues.\n\nAny custom CSS added to a layer will only be included in the final build if that CSS is actually used in your HTML, just like all of the classes built in to Tailwind by default.\n\nWrapping any custom CSS in a \\`@layer\\` directive also makes it possible to use modifiers with those rules, like \\`hover:\\` and \\`focus:\\` or responsive modifiers like \\`md:\\` and \\`lg:\\`.`,\n);\n\nconst applyDirective = createTailwindDirective(\n  'apply',\n  `Use \\`@apply\\` to inline any existing utility classes into your own custom CSS.\n\nThis is useful when you need to write custom CSS (like to override the styles in a third-party library) but still want to work with your design tokens and use the same syntax you're used to using in your HTML.\n\n\\`\\`\\`css\n.select2-dropdown {\n  @apply rounded-b-lg shadow-md;\n}\n.select2-search {\n  @apply border border-gray-300 rounded;\n}\n.select2-results__group {\n  @apply text-lg font-bold text-gray-900;\n}\n\\`\\`\\`\n\nAny rules inlined with \\`@apply\\` will have \\`!important\\` **removed** by default to avoid specificity issues:\n\n\\`\\`\\`css\n/* Input */\n.foo {\n  color: blue !important;\n}\n\n.bar {\n  @apply foo;\n}\n\n/* Output */\n.foo {\n  color: blue !important;\n}\n\n.bar {\n  color: blue;\n}\n\\`\\`\\`\n\nIf you'd like to \\`@apply\\` an existing class and make it \\`!important\\`, simply add \\`!important\\` to the end of the declaration:\n\n\\`\\`\\`css\n/* Input */\n.btn {\n  @apply font-bold py-2 px-4 rounded !important;\n}\n\n/* Output */\n.btn {\n  font-weight: 700 !important;\n  padding-top: .5rem !important;\n  padding-bottom: .5rem !important;\n  padding-right: 1rem !important;\n  padding-left: 1rem !important;\n  border-radius: .25rem !important;\n}\n\\`\\`\\`\n\nNote that if you're using Sass/SCSS, you'll need to use Sass' interpolation feature to get this to work:\n\n\\`\\`\\`css\n.btn {\n  @apply font-bold py-2 px-4 rounded #{!important};\n}\n\\`\\`\\``,\n);\n\nconst configDirective = createTailwindDirective(\n  'config',\n  `Use the \\`@config\\` directive to specify which config file Tailwind should use when compiling CSS file. This is useful for projects that need to use different configuration files for different CSS entry points.\n\n\\`\\`\\`css\n@config \"./tailwind.site.config.js\";\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\\`\\`\\`\n\n\\`\\`\\`css\n@config \"./tailwind.admin.config.js\";\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\\`\\`\\`\n\nThe path you provide to the \\`@config\\` directive is relative to that CSS file, and will take precedence over a path defined in your PostCSS configuration or in the Tailwind CLI.`,\n);\n\nexport const tailwindcssData: languages.css.CSSDataV1 = {\n  version: 1.1,\n  atDirectives: [tailwindDirective, layerDirective, applyDirective, configDirective],\n};\n", "/**\n * Check if given code is a number\n */\nfunction isNumber$1(code) {\n    return code > 47 && code < 58;\n}\n/**\n * Check if given character code is alpha code (letter through A to Z)\n */\nfunction isAlpha$1(code, from, to) {\n    from = from || 65; // A\n    to = to || 90; // Z\n    code &= ~32; // quick hack to convert any char code to uppercase char code\n    return code >= from && code <= to;\n}\nfunction isAlphaNumericWord(code) {\n    return isNumber$1(code) || isAlphaWord(code);\n}\nfunction isAlphaWord(code) {\n    return code === 95 /* _ */ || isAlpha$1(code);\n}\n/**\n * Check for Umlauts i.e. \u00E4, \u00C4, \u00F6, \u00D6, \u00FC and \u00DC\n */\nfunction isUmlaut(code) {\n    return code === 196\n        || code == 214\n        || code === 220\n        || code === 228\n        || code === 246\n        || code === 252;\n}\n/**\n * Check if given character code is a white-space character: a space character\n * or line breaks\n */\nfunction isWhiteSpace$3(code) {\n    return code === 32 /* space */\n        || code === 9 /* tab */\n        || code === 160; /* non-breaking space */\n}\n/**\n * Check if given character code is a space character\n */\nfunction isSpace(code) {\n    return isWhiteSpace$3(code)\n        || code === 10 /* LF */\n        || code === 13; /* CR */\n}\n/**\n * Check if given character code is a quote character\n */\nfunction isQuote$2(code) {\n    return code === 39 /* ' */ || code === 34 /* \" */;\n}\n\n/**\n * A streaming, character code-based string reader\n */\nclass Scanner {\n    constructor(str, start, end) {\n        if (end == null && typeof str === 'string') {\n            end = str.length;\n        }\n        this.string = str;\n        this.pos = this.start = start || 0;\n        this.end = end || 0;\n    }\n    /**\n     * Returns true only if the stream is at the end of the file.\n     */\n    eof() {\n        return this.pos >= this.end;\n    }\n    /**\n     * Creates a new stream instance which is limited to given `start` and `end`\n     * range. E.g. its `eof()` method will look at `end` property, not actual\n     * stream end\n     */\n    limit(start, end) {\n        return new Scanner(this.string, start, end);\n    }\n    /**\n     * Returns the next character code in the stream without advancing it.\n     * Will return NaN at the end of the file.\n     */\n    peek() {\n        return this.string.charCodeAt(this.pos);\n    }\n    /**\n     * Returns the next character in the stream and advances it.\n     * Also returns <code>undefined</code> when no more characters are available.\n     */\n    next() {\n        if (this.pos < this.string.length) {\n            return this.string.charCodeAt(this.pos++);\n        }\n    }\n    /**\n     * `match` can be a character code or a function that takes a character code\n     * and returns a boolean. If the next character in the stream 'matches'\n     * the given argument, it is consumed and returned.\n     * Otherwise, `false` is returned.\n     */\n    eat(match) {\n        const ch = this.peek();\n        const ok = typeof match === 'function' ? match(ch) : ch === match;\n        if (ok) {\n            this.next();\n        }\n        return ok;\n    }\n    /**\n     * Repeatedly calls <code>eat</code> with the given argument, until it\n     * fails. Returns <code>true</code> if any characters were eaten.\n     */\n    eatWhile(match) {\n        const start = this.pos;\n        while (!this.eof() && this.eat(match)) { /* */ }\n        return this.pos !== start;\n    }\n    /**\n     * Backs up the stream n characters. Backing it up further than the\n     * start of the current token will cause things to break, so be careful.\n     */\n    backUp(n) {\n        this.pos -= (n || 1);\n    }\n    /**\n     * Get the string between the start of the current token and the\n     * current stream position.\n     */\n    current() {\n        return this.substring(this.start, this.pos);\n    }\n    /**\n     * Returns substring for given range\n     */\n    substring(start, end) {\n        return this.string.slice(start, end);\n    }\n    /**\n     * Creates error object with current stream state\n     */\n    error(message, pos = this.pos) {\n        return new ScannerError(`${message} at ${pos + 1}`, pos, this.string);\n    }\n}\nclass ScannerError extends Error {\n    constructor(message, pos, str) {\n        super(message);\n        this.pos = pos;\n        this.string = str;\n    }\n}\n\nfunction tokenScanner$1(tokens) {\n    return {\n        tokens,\n        start: 0,\n        pos: 0,\n        size: tokens.length\n    };\n}\nfunction peek$3(scanner) {\n    return scanner.tokens[scanner.pos];\n}\nfunction next(scanner) {\n    return scanner.tokens[scanner.pos++];\n}\nfunction slice(scanner, from = scanner.start, to = scanner.pos) {\n    return scanner.tokens.slice(from, to);\n}\nfunction readable$1(scanner) {\n    return scanner.pos < scanner.size;\n}\nfunction consume$2(scanner, test) {\n    const token = peek$3(scanner);\n    if (token && test(token)) {\n        scanner.pos++;\n        return true;\n    }\n    return false;\n}\nfunction error$1(scanner, message, token = peek$3(scanner)) {\n    if (token && token.start != null) {\n        message += ` at ${token.start}`;\n    }\n    const err = new Error(message);\n    err['pos'] = token && token.start;\n    return err;\n}\n\nfunction abbreviation(abbr, options = {}) {\n    const scanner = tokenScanner$1(abbr);\n    const result = statements(scanner, options);\n    if (readable$1(scanner)) {\n        throw error$1(scanner, 'Unexpected character');\n    }\n    return result;\n}\nfunction statements(scanner, options) {\n    const result = {\n        type: 'TokenGroup',\n        elements: []\n    };\n    let ctx = result;\n    let node;\n    const stack = [];\n    while (readable$1(scanner)) {\n        if (node = element$2(scanner, options) || group(scanner, options)) {\n            ctx.elements.push(node);\n            if (consume$2(scanner, isChildOperator)) {\n                stack.push(ctx);\n                ctx = node;\n            }\n            else if (consume$2(scanner, isSiblingOperator$1)) {\n                continue;\n            }\n            else if (consume$2(scanner, isClimbOperator)) {\n                do {\n                    if (stack.length) {\n                        ctx = stack.pop();\n                    }\n                } while (consume$2(scanner, isClimbOperator));\n            }\n        }\n        else {\n            break;\n        }\n    }\n    return result;\n}\n/**\n * Consumes group from given scanner\n */\nfunction group(scanner, options) {\n    if (consume$2(scanner, isGroupStart)) {\n        const result = statements(scanner, options);\n        const token = next(scanner);\n        if (isBracket$2(token, 'group', false)) {\n            result.repeat = repeater$1(scanner);\n        }\n        return result;\n    }\n}\n/**\n * Consumes single element from given scanner\n */\nfunction element$2(scanner, options) {\n    let attr;\n    const elem = {\n        type: 'TokenElement',\n        name: void 0,\n        attributes: void 0,\n        value: void 0,\n        repeat: void 0,\n        selfClose: false,\n        elements: []\n    };\n    if (elementName(scanner, options)) {\n        elem.name = slice(scanner);\n    }\n    while (readable$1(scanner)) {\n        scanner.start = scanner.pos;\n        if (!elem.repeat && !isEmpty(elem) && consume$2(scanner, isRepeater)) {\n            elem.repeat = scanner.tokens[scanner.pos - 1];\n        }\n        else if (!elem.value && text(scanner)) {\n            elem.value = getText(scanner);\n        }\n        else if (attr = shortAttribute(scanner, 'id', options) || shortAttribute(scanner, 'class', options) || attributeSet(scanner)) {\n            if (!elem.attributes) {\n                elem.attributes = Array.isArray(attr) ? attr.slice() : [attr];\n            }\n            else {\n                elem.attributes = elem.attributes.concat(attr);\n            }\n        }\n        else {\n            if (!isEmpty(elem) && consume$2(scanner, isCloseOperator)) {\n                elem.selfClose = true;\n                if (!elem.repeat && consume$2(scanner, isRepeater)) {\n                    elem.repeat = scanner.tokens[scanner.pos - 1];\n                }\n            }\n            break;\n        }\n    }\n    return !isEmpty(elem) ? elem : void 0;\n}\n/**\n * Consumes attribute set from given scanner\n */\nfunction attributeSet(scanner) {\n    if (consume$2(scanner, isAttributeSetStart)) {\n        const attributes = [];\n        let attr;\n        while (readable$1(scanner)) {\n            if (attr = attribute(scanner)) {\n                attributes.push(attr);\n            }\n            else if (consume$2(scanner, isAttributeSetEnd)) {\n                break;\n            }\n            else if (!consume$2(scanner, isWhiteSpace$2)) {\n                throw error$1(scanner, `Unexpected \"${peek$3(scanner).type}\" token`);\n            }\n        }\n        return attributes;\n    }\n}\n/**\n * Consumes attribute shorthand (class or id) from given scanner\n */\nfunction shortAttribute(scanner, type, options) {\n    if (isOperator$1(peek$3(scanner), type)) {\n        scanner.pos++;\n        // Consume multiple operators\n        let count = 1;\n        while (isOperator$1(peek$3(scanner), type)) {\n            scanner.pos++;\n            count++;\n        }\n        const attr = {\n            name: [createLiteral$1(type)]\n        };\n        if (count > 1) {\n            attr.multiple = true;\n        }\n        // Consume expression after shorthand start for React-like components\n        if (options.jsx && text(scanner)) {\n            attr.value = getText(scanner);\n            attr.expression = true;\n        }\n        else {\n            attr.value = literal$1$1(scanner) ? slice(scanner) : void 0;\n        }\n        return attr;\n    }\n}\n/**\n * Consumes single attribute from given scanner\n */\nfunction attribute(scanner) {\n    if (quoted(scanner)) {\n        // Consumed quoted value: it\u2019s a value for default attribute\n        return {\n            value: slice(scanner)\n        };\n    }\n    if (literal$1$1(scanner, true)) {\n        const name = slice(scanner);\n        let value;\n        if (consume$2(scanner, isEquals)) {\n            if (quoted(scanner) || literal$1$1(scanner, true)) {\n                value = slice(scanner);\n            }\n        }\n        return { name, value };\n    }\n}\nfunction repeater$1(scanner) {\n    return isRepeater(peek$3(scanner))\n        ? scanner.tokens[scanner.pos++]\n        : void 0;\n}\n/**\n * Consumes quoted value from given scanner, if possible\n */\nfunction quoted(scanner) {\n    const start = scanner.pos;\n    const quote = peek$3(scanner);\n    if (isQuote$1(quote)) {\n        scanner.pos++;\n        while (readable$1(scanner)) {\n            if (isQuote$1(next(scanner), quote.single)) {\n                scanner.start = start;\n                return true;\n            }\n        }\n        throw error$1(scanner, 'Unclosed quote', quote);\n    }\n    return false;\n}\n/**\n * Consumes literal (unquoted value) from given scanner\n */\nfunction literal$1$1(scanner, allowBrackets) {\n    const start = scanner.pos;\n    const brackets = {\n        attribute: 0,\n        expression: 0,\n        group: 0\n    };\n    while (readable$1(scanner)) {\n        const token = peek$3(scanner);\n        if (brackets.expression) {\n            // If we\u2019re inside expression, we should consume all content in it\n            if (isBracket$2(token, 'expression')) {\n                brackets[token.context] += token.open ? 1 : -1;\n            }\n        }\n        else if (isQuote$1(token) || isOperator$1(token) || isWhiteSpace$2(token) || isRepeater(token)) {\n            break;\n        }\n        else if (isBracket$2(token)) {\n            if (!allowBrackets) {\n                break;\n            }\n            if (token.open) {\n                brackets[token.context]++;\n            }\n            else if (!brackets[token.context]) {\n                // Stop if found unmatched closing brace: it must be handled\n                // by parent consumer\n                break;\n            }\n            else {\n                brackets[token.context]--;\n            }\n        }\n        scanner.pos++;\n    }\n    if (start !== scanner.pos) {\n        scanner.start = start;\n        return true;\n    }\n    return false;\n}\n/**\n * Consumes element name from given scanner\n */\nfunction elementName(scanner, options) {\n    const start = scanner.pos;\n    if (options.jsx && consume$2(scanner, isCapitalizedLiteral)) {\n        // Check for edge case: consume immediate capitalized class names\n        // for React-like components, e.g. `Foo.Bar.Baz`\n        while (readable$1(scanner)) {\n            const { pos } = scanner;\n            if (!consume$2(scanner, isClassNameOperator) || !consume$2(scanner, isCapitalizedLiteral)) {\n                scanner.pos = pos;\n                break;\n            }\n        }\n    }\n    while (readable$1(scanner) && consume$2(scanner, isElementName$1)) {\n        // empty\n    }\n    if (scanner.pos !== start) {\n        scanner.start = start;\n        return true;\n    }\n    return false;\n}\n/**\n * Consumes text value from given scanner\n */\nfunction text(scanner) {\n    const start = scanner.pos;\n    if (consume$2(scanner, isTextStart)) {\n        let brackets = 0;\n        while (readable$1(scanner)) {\n            const token = next(scanner);\n            if (isBracket$2(token, 'expression')) {\n                if (token.open) {\n                    brackets++;\n                }\n                else if (!brackets) {\n                    break;\n                }\n                else {\n                    brackets--;\n                }\n            }\n        }\n        scanner.start = start;\n        return true;\n    }\n    return false;\n}\nfunction getText(scanner) {\n    let from = scanner.start;\n    let to = scanner.pos;\n    if (isBracket$2(scanner.tokens[from], 'expression', true)) {\n        from++;\n    }\n    if (isBracket$2(scanner.tokens[to - 1], 'expression', false)) {\n        to--;\n    }\n    return slice(scanner, from, to);\n}\nfunction isBracket$2(token, context, isOpen) {\n    return Boolean(token && token.type === 'Bracket'\n        && (!context || token.context === context)\n        && (isOpen == null || token.open === isOpen));\n}\nfunction isOperator$1(token, type) {\n    return Boolean(token && token.type === 'Operator' && (!type || token.operator === type));\n}\nfunction isQuote$1(token, isSingle) {\n    return Boolean(token && token.type === 'Quote' && (isSingle == null || token.single === isSingle));\n}\nfunction isWhiteSpace$2(token) {\n    return Boolean(token && token.type === 'WhiteSpace');\n}\nfunction isEquals(token) {\n    return isOperator$1(token, 'equal');\n}\nfunction isRepeater(token) {\n    return Boolean(token && token.type === 'Repeater');\n}\nfunction isLiteral$2(token) {\n    return token.type === 'Literal';\n}\nfunction isCapitalizedLiteral(token) {\n    if (isLiteral$2(token)) {\n        const ch = token.value.charCodeAt(0);\n        return ch >= 65 && ch <= 90;\n    }\n    return false;\n}\nfunction isElementName$1(token) {\n    return token.type === 'Literal' || token.type === 'RepeaterNumber' || token.type === 'RepeaterPlaceholder';\n}\nfunction isClassNameOperator(token) {\n    return isOperator$1(token, 'class');\n}\nfunction isAttributeSetStart(token) {\n    return isBracket$2(token, 'attribute', true);\n}\nfunction isAttributeSetEnd(token) {\n    return isBracket$2(token, 'attribute', false);\n}\nfunction isTextStart(token) {\n    return isBracket$2(token, 'expression', true);\n}\nfunction isGroupStart(token) {\n    return isBracket$2(token, 'group', true);\n}\nfunction createLiteral$1(value) {\n    return { type: 'Literal', value };\n}\nfunction isEmpty(elem) {\n    return !elem.name && !elem.value && !elem.attributes;\n}\nfunction isChildOperator(token) {\n    return isOperator$1(token, 'child');\n}\nfunction isSiblingOperator$1(token) {\n    return isOperator$1(token, 'sibling');\n}\nfunction isClimbOperator(token) {\n    return isOperator$1(token, 'climb');\n}\nfunction isCloseOperator(token) {\n    return isOperator$1(token, 'close');\n}\n\nvar Chars$3;\n(function (Chars) {\n    /** `{` character */\n    Chars[Chars[\"CurlyBracketOpen\"] = 123] = \"CurlyBracketOpen\";\n    /** `}` character */\n    Chars[Chars[\"CurlyBracketClose\"] = 125] = \"CurlyBracketClose\";\n    /** `\\\\` character */\n    Chars[Chars[\"Escape\"] = 92] = \"Escape\";\n    /** `=` character */\n    Chars[Chars[\"Equals\"] = 61] = \"Equals\";\n    /** `[` character */\n    Chars[Chars[\"SquareBracketOpen\"] = 91] = \"SquareBracketOpen\";\n    /** `]` character */\n    Chars[Chars[\"SquareBracketClose\"] = 93] = \"SquareBracketClose\";\n    /** `*` character */\n    Chars[Chars[\"Asterisk\"] = 42] = \"Asterisk\";\n    /** `#` character */\n    Chars[Chars[\"Hash\"] = 35] = \"Hash\";\n    /** `$` character */\n    Chars[Chars[\"Dollar\"] = 36] = \"Dollar\";\n    /** `-` character */\n    Chars[Chars[\"Dash\"] = 45] = \"Dash\";\n    /** `.` character */\n    Chars[Chars[\"Dot\"] = 46] = \"Dot\";\n    /** `/` character */\n    Chars[Chars[\"Slash\"] = 47] = \"Slash\";\n    /** `:` character */\n    Chars[Chars[\"Colon\"] = 58] = \"Colon\";\n    /** `!` character */\n    Chars[Chars[\"Excl\"] = 33] = \"Excl\";\n    /** `@` character */\n    Chars[Chars[\"At\"] = 64] = \"At\";\n    /** `_` character */\n    Chars[Chars[\"Underscore\"] = 95] = \"Underscore\";\n    /** `(` character */\n    Chars[Chars[\"RoundBracketOpen\"] = 40] = \"RoundBracketOpen\";\n    /** `)` character */\n    Chars[Chars[\"RoundBracketClose\"] = 41] = \"RoundBracketClose\";\n    /** `+` character */\n    Chars[Chars[\"Sibling\"] = 43] = \"Sibling\";\n    /** `>` character */\n    Chars[Chars[\"Child\"] = 62] = \"Child\";\n    /** `^` character */\n    Chars[Chars[\"Climb\"] = 94] = \"Climb\";\n    /** `'` character */\n    Chars[Chars[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    /** `\"\"` character */\n    Chars[Chars[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n})(Chars$3 || (Chars$3 = {}));\n/**\n * If consumes escape character, sets current stream range to escaped value\n */\nfunction escaped(scanner) {\n    if (scanner.eat(Chars$3.Escape)) {\n        scanner.start = scanner.pos;\n        if (!scanner.eof()) {\n            scanner.pos++;\n        }\n        return true;\n    }\n    return false;\n}\n\nfunction tokenize$1(source) {\n    const scanner = new Scanner(source);\n    const result = [];\n    const ctx = {\n        group: 0,\n        attribute: 0,\n        expression: 0,\n        quote: 0\n    };\n    let ch = 0;\n    let token;\n    while (!scanner.eof()) {\n        ch = scanner.peek();\n        token = getToken$1(scanner, ctx);\n        if (token) {\n            result.push(token);\n            if (token.type === 'Quote') {\n                ctx.quote = ch === ctx.quote ? 0 : ch;\n            }\n            else if (token.type === 'Bracket') {\n                ctx[token.context] += token.open ? 1 : -1;\n            }\n        }\n        else {\n            throw scanner.error('Unexpected character');\n        }\n    }\n    return result;\n}\n/**\n * Returns next token from given scanner, if possible\n */\nfunction getToken$1(scanner, ctx) {\n    return field$2(scanner, ctx)\n        || repeaterPlaceholder(scanner)\n        || repeaterNumber(scanner)\n        || repeater(scanner)\n        || whiteSpace$1(scanner)\n        || literal$2(scanner, ctx)\n        || operator$1(scanner)\n        || quote(scanner)\n        || bracket$1(scanner);\n}\n/**\n * Consumes literal from given scanner\n */\nfunction literal$2(scanner, ctx) {\n    const start = scanner.pos;\n    const expressionStart = ctx.expression;\n    let value = '';\n    while (!scanner.eof()) {\n        // Consume escaped sequence no matter of context\n        if (escaped(scanner)) {\n            value += scanner.current();\n            continue;\n        }\n        const ch = scanner.peek();\n        if (ch === Chars$3.Slash && !ctx.quote && !ctx.expression && !ctx.attribute) {\n            // Special case for `/` character between numbers in class names\n            const prev = scanner.string.charCodeAt(scanner.pos - 1);\n            const next = scanner.string.charCodeAt(scanner.pos + 1);\n            if (isNumber$1(prev) && isNumber$1(next)) {\n                value += scanner.string[scanner.pos++];\n                continue;\n            }\n        }\n        if (ch === ctx.quote || ch === Chars$3.Dollar || isAllowedOperator(ch, ctx)) {\n            // 1. Found matching quote\n            // 2. The `$` character has special meaning in every context\n            // 3. Depending on context, some characters should be treated as operators\n            break;\n        }\n        if (expressionStart) {\n            // Consume nested expressions, e.g. span{{foo}}\n            if (ch === Chars$3.CurlyBracketOpen) {\n                ctx.expression++;\n            }\n            else if (ch === Chars$3.CurlyBracketClose) {\n                if (ctx.expression > expressionStart) {\n                    ctx.expression--;\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else if (!ctx.quote) {\n            // Consuming element name\n            if (!ctx.attribute && !isElementName(ch)) {\n                break;\n            }\n            if (isAllowedSpace(ch, ctx) || isAllowedRepeater(ch, ctx) || isQuote$2(ch) || bracketType(ch)) {\n                // Stop for characters not allowed in unquoted literal\n                break;\n            }\n        }\n        value += scanner.string[scanner.pos++];\n    }\n    if (start !== scanner.pos) {\n        scanner.start = start;\n        return {\n            type: 'Literal',\n            value,\n            start,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes white space characters as string literal from given scanner\n */\nfunction whiteSpace$1(scanner) {\n    const start = scanner.pos;\n    if (scanner.eatWhile(isSpace)) {\n        return {\n            type: 'WhiteSpace',\n            start,\n            end: scanner.pos,\n            value: scanner.substring(start, scanner.pos)\n        };\n    }\n}\n/**\n * Consumes quote from given scanner\n */\nfunction quote(scanner) {\n    const ch = scanner.peek();\n    if (isQuote$2(ch)) {\n        return {\n            type: 'Quote',\n            single: ch === Chars$3.SingleQuote,\n            start: scanner.pos++,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes bracket from given scanner\n */\nfunction bracket$1(scanner) {\n    const ch = scanner.peek();\n    const context = bracketType(ch);\n    if (context) {\n        return {\n            type: 'Bracket',\n            open: isOpenBracket$2(ch),\n            context,\n            start: scanner.pos++,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes operator from given scanner\n */\nfunction operator$1(scanner) {\n    const op = operatorType$1(scanner.peek());\n    if (op) {\n        return {\n            type: 'Operator',\n            operator: op,\n            start: scanner.pos++,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes node repeat token from current stream position and returns its\n * parsed value\n */\nfunction repeater(scanner) {\n    const start = scanner.pos;\n    if (scanner.eat(Chars$3.Asterisk)) {\n        scanner.start = scanner.pos;\n        let count = 1;\n        let implicit = false;\n        if (scanner.eatWhile(isNumber$1)) {\n            count = Number(scanner.current());\n        }\n        else {\n            implicit = true;\n        }\n        return {\n            type: 'Repeater',\n            count,\n            value: 0,\n            implicit,\n            start,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes repeater placeholder `$#` from given scanner\n */\nfunction repeaterPlaceholder(scanner) {\n    const start = scanner.pos;\n    if (scanner.eat(Chars$3.Dollar) && scanner.eat(Chars$3.Hash)) {\n        return {\n            type: 'RepeaterPlaceholder',\n            value: void 0,\n            start,\n            end: scanner.pos\n        };\n    }\n    scanner.pos = start;\n}\n/**\n * Consumes numbering token like `$` from given scanner state\n */\nfunction repeaterNumber(scanner) {\n    const start = scanner.pos;\n    if (scanner.eatWhile(Chars$3.Dollar)) {\n        const size = scanner.pos - start;\n        let reverse = false;\n        let base = 1;\n        let parent = 0;\n        if (scanner.eat(Chars$3.At)) {\n            // Consume numbering modifiers\n            while (scanner.eat(Chars$3.Climb)) {\n                parent++;\n            }\n            reverse = scanner.eat(Chars$3.Dash);\n            scanner.start = scanner.pos;\n            if (scanner.eatWhile(isNumber$1)) {\n                base = Number(scanner.current());\n            }\n        }\n        scanner.start = start;\n        return {\n            type: 'RepeaterNumber',\n            size,\n            reverse,\n            base,\n            parent,\n            start,\n            end: scanner.pos\n        };\n    }\n}\nfunction field$2(scanner, ctx) {\n    const start = scanner.pos;\n    // Fields are allowed inside expressions and attributes\n    if ((ctx.expression || ctx.attribute) && scanner.eat(Chars$3.Dollar) && scanner.eat(Chars$3.CurlyBracketOpen)) {\n        scanner.start = scanner.pos;\n        let index;\n        let name = '';\n        if (scanner.eatWhile(isNumber$1)) {\n            // It\u2019s a field\n            index = Number(scanner.current());\n            name = scanner.eat(Chars$3.Colon) ? consumePlaceholder$2(scanner) : '';\n        }\n        else if (isAlpha$1(scanner.peek())) {\n            // It\u2019s a variable\n            name = consumePlaceholder$2(scanner);\n        }\n        if (scanner.eat(Chars$3.CurlyBracketClose)) {\n            return {\n                type: 'Field',\n                index, name,\n                start,\n                end: scanner.pos\n            };\n        }\n        throw scanner.error('Expecting }');\n    }\n    // If we reached here then there\u2019s no valid field here, revert\n    // back to starting position\n    scanner.pos = start;\n}\n/**\n * Consumes a placeholder: value right after `:` in field. Could be empty\n */\nfunction consumePlaceholder$2(stream) {\n    const stack = [];\n    stream.start = stream.pos;\n    while (!stream.eof()) {\n        if (stream.eat(Chars$3.CurlyBracketOpen)) {\n            stack.push(stream.pos);\n        }\n        else if (stream.eat(Chars$3.CurlyBracketClose)) {\n            if (!stack.length) {\n                stream.pos--;\n                break;\n            }\n            stack.pop();\n        }\n        else {\n            stream.pos++;\n        }\n    }\n    if (stack.length) {\n        stream.pos = stack.pop();\n        throw stream.error(`Expecting }`);\n    }\n    return stream.current();\n}\n/**\n * Check if given character code is an operator and it\u2019s allowed in current context\n */\nfunction isAllowedOperator(ch, ctx) {\n    const op = operatorType$1(ch);\n    if (!op || ctx.quote || ctx.expression) {\n        // No operators inside quoted values or expressions\n        return false;\n    }\n    // Inside attributes, only `equals` is allowed\n    return !ctx.attribute || op === 'equal';\n}\n/**\n * Check if given character is a space character and is allowed to be consumed\n * as a space token in current context\n */\nfunction isAllowedSpace(ch, ctx) {\n    return isSpace(ch) && !ctx.expression;\n}\n/**\n * Check if given character can be consumed as repeater in current context\n */\nfunction isAllowedRepeater(ch, ctx) {\n    return ch === Chars$3.Asterisk && !ctx.attribute && !ctx.expression;\n}\n/**\n * If given character is a bracket, returns it\u2019s type\n */\nfunction bracketType(ch) {\n    if (ch === Chars$3.RoundBracketOpen || ch === Chars$3.RoundBracketClose) {\n        return 'group';\n    }\n    if (ch === Chars$3.SquareBracketOpen || ch === Chars$3.SquareBracketClose) {\n        return 'attribute';\n    }\n    if (ch === Chars$3.CurlyBracketOpen || ch === Chars$3.CurlyBracketClose) {\n        return 'expression';\n    }\n}\n/**\n * If given character is an operator, returns it\u2019s type\n */\nfunction operatorType$1(ch) {\n    return (ch === Chars$3.Child && 'child')\n        || (ch === Chars$3.Sibling && 'sibling')\n        || (ch === Chars$3.Climb && 'climb')\n        || (ch === Chars$3.Dot && 'class')\n        || (ch === Chars$3.Hash && 'id')\n        || (ch === Chars$3.Slash && 'close')\n        || (ch === Chars$3.Equals && 'equal')\n        || void 0;\n}\n/**\n * Check if given character is an open bracket\n */\nfunction isOpenBracket$2(ch) {\n    return ch === Chars$3.CurlyBracketOpen\n        || ch === Chars$3.SquareBracketOpen\n        || ch === Chars$3.RoundBracketOpen;\n}\n/**\n * Check if given character is allowed in element name\n */\nfunction isElementName(ch) {\n    return isAlphaNumericWord(ch)\n        || isUmlaut(ch)\n        || ch === Chars$3.Dash\n        || ch === Chars$3.Colon\n        || ch === Chars$3.Excl;\n}\n\nconst operators = {\n    child: '>',\n    class: '.',\n    climb: '^',\n    id: '#',\n    equal: '=',\n    close: '/',\n    sibling: '+'\n};\nconst tokenVisitor = {\n    Literal(token) {\n        return token.value;\n    },\n    Quote(token) {\n        return token.single ? '\\'' : '\"';\n    },\n    Bracket(token) {\n        if (token.context === 'attribute') {\n            return token.open ? '[' : ']';\n        }\n        else if (token.context === 'expression') {\n            return token.open ? '{' : '}';\n        }\n        else {\n            return token.open ? '(' : '}';\n        }\n    },\n    Operator(token) {\n        return operators[token.operator];\n    },\n    Field(token, state) {\n        if (token.index != null) {\n            // It\u2019s a field: by default, return TextMate-compatible field\n            return token.name\n                ? `\\${${token.index}:${token.name}}`\n                : `\\${${token.index}`;\n        }\n        else if (token.name) {\n            // It\u2019s a variable\n            return state.getVariable(token.name);\n        }\n        return '';\n    },\n    RepeaterPlaceholder(token, state) {\n        // Find closest implicit repeater\n        let repeater;\n        for (let i = state.repeaters.length - 1; i >= 0; i--) {\n            if (state.repeaters[i].implicit) {\n                repeater = state.repeaters[i];\n                break;\n            }\n        }\n        state.inserted = true;\n        return state.getText(repeater && repeater.value);\n    },\n    RepeaterNumber(token, state) {\n        let value = 1;\n        const lastIx = state.repeaters.length - 1;\n        // const repeaterIx = Math.max(0, state.repeaters.length - 1 - token.parent);\n        const repeater = state.repeaters[lastIx];\n        if (repeater) {\n            value = token.reverse\n                ? token.base + repeater.count - repeater.value - 1\n                : token.base + repeater.value;\n            if (token.parent) {\n                const parentIx = Math.max(0, lastIx - token.parent);\n                if (parentIx !== lastIx) {\n                    const parentRepeater = state.repeaters[parentIx];\n                    value += repeater.count * parentRepeater.value;\n                }\n            }\n        }\n        let result = String(value);\n        while (result.length < token.size) {\n            result = '0' + result;\n        }\n        return result;\n    },\n    WhiteSpace(token) {\n        return token.value;\n    }\n};\n/**\n * Converts given value token to string\n */\nfunction stringify$1(token, state) {\n    if (!tokenVisitor[token.type]) {\n        throw new Error(`Unknown token ${token.type}`);\n    }\n    return tokenVisitor[token.type](token, state);\n}\n\nconst urlRegex = /^((https?:|ftp:|file:)?\\/\\/|(www|ftp)\\.)[^ ]*$/;\nconst emailRegex = /^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,5}$/;\n/**\n * Converts given token-based abbreviation into simplified and unrolled node-based\n * abbreviation\n */\nfunction convert(abbr, options = {}) {\n    let textInserted = false;\n    let cleanText;\n    if (options.text) {\n        if (Array.isArray(options.text)) {\n            cleanText = options.text.filter(s => s.trim());\n        }\n        else {\n            cleanText = options.text;\n        }\n    }\n    const result = {\n        type: 'Abbreviation',\n        children: convertGroup(abbr, {\n            inserted: false,\n            repeaters: [],\n            text: options.text,\n            cleanText,\n            repeatGuard: options.maxRepeat || Number.POSITIVE_INFINITY,\n            getText(pos) {\n                var _a;\n                textInserted = true;\n                let value;\n                if (Array.isArray(options.text)) {\n                    if (pos !== undefined && pos >= 0 && pos < cleanText.length) {\n                        return cleanText[pos];\n                    }\n                    value = pos !== undefined ? options.text[pos] : options.text.join('\\n');\n                }\n                else {\n                    value = (_a = options.text) !== null && _a !== void 0 ? _a : '';\n                }\n                return value;\n            },\n            getVariable(name) {\n                const varValue = options.variables && options.variables[name];\n                return varValue != null ? varValue : name;\n            }\n        })\n    };\n    if (options.text != null && !textInserted) {\n        // Text given but no implicitly repeated elements: insert it into\n        // deepest child\n        const deepest = deepestNode(last$1(result.children));\n        if (deepest) {\n            const text = Array.isArray(options.text) ? options.text.join('\\n') : options.text;\n            insertText(deepest, text);\n            if (deepest.name === 'a' && options.href) {\n                // Automatically update value of `<a>` element if inserting URL or email\n                insertHref(deepest, text);\n            }\n        }\n    }\n    return result;\n}\n/**\n * Converts given statement to abbreviation nodes\n */\nfunction convertStatement(node, state) {\n    let result = [];\n    if (node.repeat) {\n        // Node is repeated: we should create copies of given node\n        // and supply context token with actual repeater state\n        const original = node.repeat;\n        const repeat = Object.assign({}, original);\n        repeat.count = repeat.implicit && Array.isArray(state.text)\n            ? state.cleanText.length\n            : (repeat.count || 1);\n        let items;\n        state.repeaters.push(repeat);\n        for (let i = 0; i < repeat.count; i++) {\n            repeat.value = i;\n            node.repeat = repeat;\n            items = isGroup(node)\n                ? convertGroup(node, state)\n                : convertElement(node, state);\n            if (repeat.implicit && !state.inserted) {\n                // It\u2019s an implicit repeater but no repeater placeholders found inside,\n                // we should insert text into deepest node\n                const target = last$1(items);\n                const deepest = target && deepestNode(target);\n                if (deepest) {\n                    insertText(deepest, state.getText(repeat.value));\n                }\n            }\n            result = result.concat(items);\n            // We should output at least one repeated item even if it\u2019s reached\n            // repeat limit\n            if (--state.repeatGuard <= 0) {\n                break;\n            }\n        }\n        state.repeaters.pop();\n        node.repeat = original;\n        if (repeat.implicit) {\n            state.inserted = true;\n        }\n    }\n    else {\n        result = result.concat(isGroup(node) ? convertGroup(node, state) : convertElement(node, state));\n    }\n    return result;\n}\nfunction convertElement(node, state) {\n    let children = [];\n    const elem = {\n        type: 'AbbreviationNode',\n        name: node.name && stringifyName(node.name, state),\n        value: node.value && stringifyValue$1(node.value, state),\n        attributes: void 0,\n        children,\n        repeat: node.repeat && Object.assign({}, node.repeat),\n        selfClosing: node.selfClose,\n    };\n    let result = [elem];\n    for (const child of node.elements) {\n        children = children.concat(convertStatement(child, state));\n    }\n    if (node.attributes) {\n        elem.attributes = [];\n        for (const attr of node.attributes) {\n            elem.attributes.push(convertAttribute(attr, state));\n        }\n    }\n    // In case if current node is a text-only snippet without fields, we should\n    // put all children as siblings\n    if (!elem.name && !elem.attributes && elem.value && !elem.value.some(isField$1)) {\n        // XXX it\u2019s unclear that `children` is not bound to `elem`\n        // due to concat operation\n        result = result.concat(children);\n    }\n    else {\n        elem.children = children;\n    }\n    return result;\n}\nfunction convertGroup(node, state) {\n    let result = [];\n    for (const child of node.elements) {\n        result = result.concat(convertStatement(child, state));\n    }\n    if (node.repeat) {\n        result = attachRepeater(result, node.repeat);\n    }\n    return result;\n}\nfunction convertAttribute(node, state) {\n    let implied = false;\n    let isBoolean = false;\n    let valueType = node.expression ? 'expression' : 'raw';\n    let value;\n    const name = node.name && stringifyName(node.name, state);\n    if (name && name[0] === '!') {\n        implied = true;\n    }\n    if (name && name[name.length - 1] === '.') {\n        isBoolean = true;\n    }\n    if (node.value) {\n        const tokens = node.value.slice();\n        if (isQuote$1(tokens[0])) {\n            // It\u2019s a quoted value: remove quotes from output but mark attribute\n            // value as quoted\n            const quote = tokens.shift();\n            if (tokens.length && last$1(tokens).type === quote.type) {\n                tokens.pop();\n            }\n            valueType = quote.single ? 'singleQuote' : 'doubleQuote';\n        }\n        else if (isBracket$2(tokens[0], 'expression', true)) {\n            // Value is expression: remove brackets but mark value type\n            valueType = 'expression';\n            tokens.shift();\n            if (isBracket$2(last$1(tokens), 'expression', false)) {\n                tokens.pop();\n            }\n        }\n        value = stringifyValue$1(tokens, state);\n    }\n    return {\n        name: isBoolean || implied\n            ? name.slice(implied ? 1 : 0, isBoolean ? -1 : void 0)\n            : name,\n        value,\n        boolean: isBoolean,\n        implied,\n        valueType,\n        multiple: node.multiple\n    };\n}\n/**\n * Converts given token list to string\n */\nfunction stringifyName(tokens, state) {\n    let str = '';\n    for (let i = 0; i < tokens.length; i++) {\n        str += stringify$1(tokens[i], state);\n    }\n    return str;\n}\n/**\n * Converts given token list to value list\n */\nfunction stringifyValue$1(tokens, state) {\n    const result = [];\n    let str = '';\n    for (let i = 0, token; i < tokens.length; i++) {\n        token = tokens[i];\n        if (isField$1(token)) {\n            // We should keep original fields in output since some editors has their\n            // own syntax for field or doesn\u2019t support fields at all so we should\n            // capture actual field location in output stream\n            if (str) {\n                result.push(str);\n                str = '';\n            }\n            result.push(token);\n        }\n        else {\n            str += stringify$1(token, state);\n        }\n    }\n    if (str) {\n        result.push(str);\n    }\n    return result;\n}\nfunction isGroup(node) {\n    return node.type === 'TokenGroup';\n}\nfunction isField$1(token) {\n    return typeof token === 'object' && token.type === 'Field' && token.index != null;\n}\nfunction last$1(arr) {\n    return arr[arr.length - 1];\n}\nfunction deepestNode(node) {\n    return node.children.length ? deepestNode(last$1(node.children)) : node;\n}\nfunction insertText(node, text) {\n    if (node.value) {\n        const lastToken = last$1(node.value);\n        if (typeof lastToken === 'string') {\n            node.value[node.value.length - 1] += text;\n        }\n        else {\n            node.value.push(text);\n        }\n    }\n    else {\n        node.value = [text];\n    }\n}\nfunction insertHref(node, text) {\n    var _a;\n    let href = '';\n    if (urlRegex.test(text)) {\n        href = text;\n        if (!/\\w+:/.test(href) && !href.startsWith('//')) {\n            href = `http://${href}`;\n        }\n    }\n    else if (emailRegex.test(text)) {\n        href = `mailto:${text}`;\n    }\n    const hrefAttribute = (_a = node.attributes) === null || _a === void 0 ? void 0 : _a.find(attr => attr.name === 'href');\n    if (!hrefAttribute) {\n        if (!node.attributes) {\n            node.attributes = [];\n        }\n        node.attributes.push({ name: 'href', value: [href], valueType: 'doubleQuote' });\n    }\n    else if (!hrefAttribute.value) {\n        hrefAttribute.value = [href];\n    }\n}\nfunction attachRepeater(items, repeater) {\n    for (const item of items) {\n        if (!item.repeat) {\n            item.repeat = Object.assign({}, repeater);\n        }\n    }\n    return items;\n}\n\n/**\n * Parses given abbreviation into node tree\n */\nfunction parseAbbreviation(abbr, options) {\n    try {\n        const tokens = typeof abbr === 'string' ? tokenize$1(abbr) : abbr;\n        return convert(abbreviation(tokens, options), options);\n    }\n    catch (err) {\n        if (err instanceof ScannerError && typeof abbr === 'string') {\n            err.message += `\\n${abbr}\\n${'-'.repeat(err.pos)}^`;\n        }\n        throw err;\n    }\n}\n\nvar OperatorType;\n(function (OperatorType) {\n    OperatorType[\"Sibling\"] = \"+\";\n    OperatorType[\"Important\"] = \"!\";\n    OperatorType[\"ArgumentDelimiter\"] = \",\";\n    OperatorType[\"ValueDelimiter\"] = \"-\";\n    OperatorType[\"PropertyDelimiter\"] = \":\";\n})(OperatorType || (OperatorType = {}));\n\nvar Chars$2;\n(function (Chars) {\n    /** `#` character */\n    Chars[Chars[\"Hash\"] = 35] = \"Hash\";\n    /** `$` character */\n    Chars[Chars[\"Dollar\"] = 36] = \"Dollar\";\n    /** `-` character */\n    Chars[Chars[\"Dash\"] = 45] = \"Dash\";\n    /** `.` character */\n    Chars[Chars[\"Dot\"] = 46] = \"Dot\";\n    /** `:` character */\n    Chars[Chars[\"Colon\"] = 58] = \"Colon\";\n    /** `,` character */\n    Chars[Chars[\"Comma\"] = 44] = \"Comma\";\n    /** `!` character */\n    Chars[Chars[\"Excl\"] = 33] = \"Excl\";\n    /** `@` character */\n    Chars[Chars[\"At\"] = 64] = \"At\";\n    /** `%` character */\n    Chars[Chars[\"Percent\"] = 37] = \"Percent\";\n    /** `_` character */\n    Chars[Chars[\"Underscore\"] = 95] = \"Underscore\";\n    /** `(` character */\n    Chars[Chars[\"RoundBracketOpen\"] = 40] = \"RoundBracketOpen\";\n    /** `)` character */\n    Chars[Chars[\"RoundBracketClose\"] = 41] = \"RoundBracketClose\";\n    /** `{` character */\n    Chars[Chars[\"CurlyBracketOpen\"] = 123] = \"CurlyBracketOpen\";\n    /** `}` character */\n    Chars[Chars[\"CurlyBracketClose\"] = 125] = \"CurlyBracketClose\";\n    /** `+` character */\n    Chars[Chars[\"Sibling\"] = 43] = \"Sibling\";\n    /** `'` character */\n    Chars[Chars[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    /** `\"` character */\n    Chars[Chars[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n    /** `t` character */\n    Chars[Chars[\"Transparent\"] = 116] = \"Transparent\";\n    /** `/` character */\n    Chars[Chars[\"Slash\"] = 47] = \"Slash\";\n})(Chars$2 || (Chars$2 = {}));\n\nfunction tokenize(abbr, isValue) {\n    let brackets = 0;\n    let token;\n    const scanner = new Scanner(abbr);\n    const tokens = [];\n    while (!scanner.eof()) {\n        token = getToken(scanner, brackets === 0 && !isValue);\n        if (!token) {\n            throw scanner.error('Unexpected character');\n        }\n        if (token.type === 'Bracket') {\n            if (!brackets && token.open) {\n                mergeTokens(scanner, tokens);\n            }\n            brackets += token.open ? 1 : -1;\n            if (brackets < 0) {\n                throw scanner.error('Unexpected bracket', token.start);\n            }\n        }\n        tokens.push(token);\n        // Forcibly consume next operator after unit-less numeric value or color:\n        // next dash `-` must be used as value delimiter\n        if (shouldConsumeDashAfter(token) && (token = operator(scanner))) {\n            tokens.push(token);\n        }\n    }\n    return tokens;\n}\n/**\n * Returns next token from given scanner, if possible\n */\nfunction getToken(scanner, short) {\n    return field$1(scanner)\n        || customProperty(scanner)\n        || numberValue(scanner)\n        || colorValue(scanner)\n        || stringValue(scanner)\n        || bracket(scanner)\n        || operator(scanner)\n        || whiteSpace(scanner)\n        || literal$1(scanner, short);\n}\nfunction field$1(scanner) {\n    const start = scanner.pos;\n    if (scanner.eat(Chars$2.Dollar) && scanner.eat(Chars$2.CurlyBracketOpen)) {\n        scanner.start = scanner.pos;\n        let index;\n        let name = '';\n        if (scanner.eatWhile(isNumber$1)) {\n            // It\u2019s a field\n            index = Number(scanner.current());\n            name = scanner.eat(Chars$2.Colon) ? consumePlaceholder$1(scanner) : '';\n        }\n        else if (isAlpha$1(scanner.peek())) {\n            // It\u2019s a variable\n            name = consumePlaceholder$1(scanner);\n        }\n        if (scanner.eat(Chars$2.CurlyBracketClose)) {\n            return {\n                type: 'Field',\n                index, name,\n                start,\n                end: scanner.pos\n            };\n        }\n        throw scanner.error('Expecting }');\n    }\n    // If we reached here then there\u2019s no valid field here, revert\n    // back to starting position\n    scanner.pos = start;\n}\n/**\n * Consumes a placeholder: value right after `:` in field. Could be empty\n */\nfunction consumePlaceholder$1(stream) {\n    const stack = [];\n    stream.start = stream.pos;\n    while (!stream.eof()) {\n        if (stream.eat(Chars$2.CurlyBracketOpen)) {\n            stack.push(stream.pos);\n        }\n        else if (stream.eat(Chars$2.CurlyBracketClose)) {\n            if (!stack.length) {\n                stream.pos--;\n                break;\n            }\n            stack.pop();\n        }\n        else {\n            stream.pos++;\n        }\n    }\n    if (stack.length) {\n        stream.pos = stack.pop();\n        throw stream.error(`Expecting }`);\n    }\n    return stream.current();\n}\n/**\n * Consumes literal from given scanner\n * @param short Use short notation for consuming value.\n * The difference between \u201Cshort\u201D and \u201Cfull\u201D notation is that first one uses\n * alpha characters only and used for extracting keywords from abbreviation,\n * while \u201Cfull\u201D notation also supports numbers and dashes\n */\nfunction literal$1(scanner, short) {\n    const start = scanner.pos;\n    if (scanner.eat(isIdentPrefix)) {\n        // SCSS or LESS variable\n        // NB a bit dirty hack: if abbreviation starts with identifier prefix,\n        // consume alpha characters only to allow embedded variables\n        scanner.eatWhile(start ? isKeyword : isLiteral$1);\n    }\n    else if (scanner.eat(isAlphaWord)) {\n        scanner.eatWhile(short ? isLiteral$1 : isKeyword);\n    }\n    else {\n        // Allow dots only at the beginning of literal\n        scanner.eat(Chars$2.Dot);\n        scanner.eatWhile(isLiteral$1);\n    }\n    if (start !== scanner.pos) {\n        scanner.start = start;\n        return createLiteral(scanner, scanner.start = start);\n    }\n}\nfunction createLiteral(scanner, start = scanner.start, end = scanner.pos) {\n    return {\n        type: 'Literal',\n        value: scanner.substring(start, end),\n        start,\n        end\n    };\n}\n/**\n * Consumes numeric CSS value (number with optional unit) from current stream,\n * if possible\n */\nfunction numberValue(scanner) {\n    const start = scanner.pos;\n    if (consumeNumber(scanner)) {\n        scanner.start = start;\n        const rawValue = scanner.current();\n        // eat unit, which can be a % or alpha word\n        scanner.start = scanner.pos;\n        scanner.eat(Chars$2.Percent) || scanner.eatWhile(isAlphaWord);\n        return {\n            type: 'NumberValue',\n            value: Number(rawValue),\n            rawValue,\n            unit: scanner.current(),\n            start,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes quoted string value from given scanner\n */\nfunction stringValue(scanner) {\n    const ch = scanner.peek();\n    const start = scanner.pos;\n    let finished = false;\n    if (isQuote$2(ch)) {\n        scanner.pos++;\n        while (!scanner.eof()) {\n            // Do not throw error on malformed string\n            if (scanner.eat(ch)) {\n                finished = true;\n                break;\n            }\n            else {\n                scanner.pos++;\n            }\n        }\n        scanner.start = start;\n        return {\n            type: 'StringValue',\n            value: scanner.substring(start + 1, scanner.pos - (finished ? 1 : 0)),\n            quote: ch === Chars$2.SingleQuote ? 'single' : 'double',\n            start,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes a color token from given string\n */\nfunction colorValue(scanner) {\n    // supported color variations:\n    // #abc   \u2192 #aabbccc\n    // #0     \u2192 #000000\n    // #fff.5 \u2192 rgba(255, 255, 255, 0.5)\n    // #t     \u2192 transparent\n    const start = scanner.pos;\n    if (scanner.eat(Chars$2.Hash)) {\n        const valueStart = scanner.pos;\n        let color = '';\n        let alpha = '';\n        if (scanner.eatWhile(isHex)) {\n            color = scanner.substring(valueStart, scanner.pos);\n            alpha = colorAlpha(scanner);\n        }\n        else if (scanner.eat(Chars$2.Transparent)) {\n            color = '0';\n            alpha = colorAlpha(scanner) || '0';\n        }\n        else {\n            alpha = colorAlpha(scanner);\n        }\n        if (color || alpha || scanner.eof()) {\n            const { r, g, b, a } = parseColor(color, alpha);\n            return {\n                type: 'ColorValue',\n                r, g, b, a,\n                raw: scanner.substring(start + 1, scanner.pos),\n                start,\n                end: scanner.pos\n            };\n        }\n        else {\n            // Consumed # but no actual value: invalid color value, treat it as literal\n            return createLiteral(scanner, start);\n        }\n    }\n    scanner.pos = start;\n}\n/**\n * Consumes alpha value of color: `.1`\n */\nfunction colorAlpha(scanner) {\n    const start = scanner.pos;\n    if (scanner.eat(Chars$2.Dot)) {\n        scanner.start = start;\n        if (scanner.eatWhile(isNumber$1)) {\n            return scanner.current();\n        }\n        return '1';\n    }\n    return '';\n}\n/**\n * Consumes white space characters as string literal from given scanner\n */\nfunction whiteSpace(scanner) {\n    const start = scanner.pos;\n    if (scanner.eatWhile(isSpace)) {\n        return {\n            type: 'WhiteSpace',\n            start,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes custom CSS property: --foo-bar\n */\nfunction customProperty(scanner) {\n    const start = scanner.pos;\n    if (scanner.eat(Chars$2.Dash) && scanner.eat(Chars$2.Dash)) {\n        scanner.start = start;\n        scanner.eatWhile(isKeyword);\n        return {\n            type: 'CustomProperty',\n            value: scanner.current(),\n            start,\n            end: scanner.pos\n        };\n    }\n    scanner.pos = start;\n}\n/**\n * Consumes bracket from given scanner\n */\nfunction bracket(scanner) {\n    const ch = scanner.peek();\n    if (isBracket$1(ch)) {\n        return {\n            type: 'Bracket',\n            open: ch === Chars$2.RoundBracketOpen,\n            start: scanner.pos++,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Consumes operator from given scanner\n */\nfunction operator(scanner) {\n    const op = operatorType(scanner.peek());\n    if (op) {\n        return {\n            type: 'Operator',\n            operator: op,\n            start: scanner.pos++,\n            end: scanner.pos\n        };\n    }\n}\n/**\n * Eats number value from given stream\n * @return Returns `true` if number was consumed\n */\nfunction consumeNumber(stream) {\n    const start = stream.pos;\n    stream.eat(Chars$2.Dash);\n    const afterNegative = stream.pos;\n    const hasDecimal = stream.eatWhile(isNumber$1);\n    const prevPos = stream.pos;\n    if (stream.eat(Chars$2.Dot)) {\n        // It\u2019s perfectly valid to have numbers like `1.`, which enforces\n        // value to float unit type\n        const hasFloat = stream.eatWhile(isNumber$1);\n        if (!hasDecimal && !hasFloat) {\n            // Lone dot\n            stream.pos = prevPos;\n        }\n    }\n    // Edge case: consumed dash only: not a number, bail-out\n    if (stream.pos === afterNegative) {\n        stream.pos = start;\n    }\n    return stream.pos !== start;\n}\nfunction isIdentPrefix(code) {\n    return code === Chars$2.At || code === Chars$2.Dollar;\n}\n/**\n * If given character is an operator, returns it\u2019s type\n */\nfunction operatorType(ch) {\n    return (ch === Chars$2.Sibling && OperatorType.Sibling)\n        || (ch === Chars$2.Excl && OperatorType.Important)\n        || (ch === Chars$2.Comma && OperatorType.ArgumentDelimiter)\n        || (ch === Chars$2.Colon && OperatorType.PropertyDelimiter)\n        || (ch === Chars$2.Dash && OperatorType.ValueDelimiter)\n        || void 0;\n}\n/**\n * Check if given code is a hex value (/0-9a-f/)\n */\nfunction isHex(code) {\n    return isNumber$1(code) || isAlpha$1(code, 65, 70); // A-F\n}\nfunction isKeyword(code) {\n    return isAlphaNumericWord(code) || code === Chars$2.Dash;\n}\nfunction isBracket$1(code) {\n    return code === Chars$2.RoundBracketOpen || code === Chars$2.RoundBracketClose;\n}\nfunction isLiteral$1(code) {\n    return isAlphaWord(code) || code === Chars$2.Percent || code === Chars$2.Slash;\n}\n/**\n * Parses given color value from abbreviation into RGBA format\n */\nfunction parseColor(value, alpha) {\n    let r = '0';\n    let g = '0';\n    let b = '0';\n    let a = Number(alpha != null && alpha !== '' ? alpha : 1);\n    if (value === 't') {\n        a = 0;\n    }\n    else {\n        switch (value.length) {\n            case 0:\n                break;\n            case 1:\n                r = g = b = value + value;\n                break;\n            case 2:\n                r = g = b = value;\n                break;\n            case 3:\n                r = value[0] + value[0];\n                g = value[1] + value[1];\n                b = value[2] + value[2];\n                break;\n            default:\n                value += value;\n                r = value.slice(0, 2);\n                g = value.slice(2, 4);\n                b = value.slice(4, 6);\n        }\n    }\n    return {\n        r: parseInt(r, 16),\n        g: parseInt(g, 16),\n        b: parseInt(b, 16),\n        a\n    };\n}\n/**\n * Check if scanner reader must consume dash after given token.\n * Used in cases where user must explicitly separate numeric values\n */\nfunction shouldConsumeDashAfter(token) {\n    return token.type === 'ColorValue' || (token.type === 'NumberValue' && !token.unit);\n}\n/**\n * Merges last adjacent tokens into a single literal.\n * This function is used to overcome edge case when function name was parsed\n * as a list of separate tokens. For example, a `scale3d()` value will be\n * parsed as literal and number tokens (`scale` and `3d`) which is a perfectly\n * valid abbreviation but undesired result. This function will detect last adjacent\n * literal and number values and combine them into single literal\n */\nfunction mergeTokens(scanner, tokens) {\n    let start = 0;\n    let end = 0;\n    while (tokens.length) {\n        const token = last(tokens);\n        if (token.type === 'Literal' || token.type === 'NumberValue') {\n            start = token.start;\n            if (!end) {\n                end = token.end;\n            }\n            tokens.pop();\n        }\n        else {\n            break;\n        }\n    }\n    if (start !== end) {\n        tokens.push(createLiteral(scanner, start, end));\n    }\n}\nfunction last(arr) {\n    return arr[arr.length - 1];\n}\n\nfunction tokenScanner(tokens) {\n    return {\n        tokens,\n        start: 0,\n        pos: 0,\n        size: tokens.length\n    };\n}\nfunction peek$2(scanner) {\n    return scanner.tokens[scanner.pos];\n}\nfunction readable(scanner) {\n    return scanner.pos < scanner.size;\n}\nfunction consume$1(scanner, test) {\n    if (test(peek$2(scanner))) {\n        scanner.pos++;\n        return true;\n    }\n    return false;\n}\nfunction error(scanner, message, token = peek$2(scanner)) {\n    if (token && token.start != null) {\n        message += ` at ${token.start}`;\n    }\n    const err = new Error(message);\n    err['pos'] = token && token.start;\n    return err;\n}\n\nfunction parser(tokens, options = {}) {\n    const scanner = tokenScanner(tokens);\n    const result = [];\n    let property;\n    while (readable(scanner)) {\n        if (property = consumeProperty(scanner, options)) {\n            result.push(property);\n        }\n        else if (!consume$1(scanner, isSiblingOperator)) {\n            throw error(scanner, 'Unexpected token');\n        }\n    }\n    return result;\n}\n/**\n * Consumes single CSS property\n */\nfunction consumeProperty(scanner, options) {\n    let name;\n    let important = false;\n    let valueFragment;\n    const value = [];\n    const token = peek$2(scanner);\n    const valueMode = !!options.value;\n    if (!valueMode && isLiteral(token) && !isFunctionStart(scanner)) {\n        scanner.pos++;\n        name = token.value;\n        // Consume any following value delimiter after property name\n        consume$1(scanner, isValueDelimiter);\n    }\n    // Skip whitespace right after property name, if any\n    if (valueMode) {\n        consume$1(scanner, isWhiteSpace$1);\n    }\n    while (readable(scanner)) {\n        if (consume$1(scanner, isImportant)) {\n            important = true;\n        }\n        else if (valueFragment = consumeValue(scanner, valueMode)) {\n            value.push(valueFragment);\n        }\n        else if (!consume$1(scanner, isFragmentDelimiter)) {\n            break;\n        }\n    }\n    if (name || value.length || important) {\n        return { name, value, important };\n    }\n}\n/**\n * Consumes single value fragment, e.g. all value tokens before comma\n */\nfunction consumeValue(scanner, inArgument) {\n    const result = [];\n    let token;\n    let args;\n    while (readable(scanner)) {\n        token = peek$2(scanner);\n        if (isValue(token)) {\n            scanner.pos++;\n            if (isLiteral(token) && (args = consumeArguments(scanner))) {\n                result.push({\n                    type: 'FunctionCall',\n                    name: token.value,\n                    arguments: args\n                });\n            }\n            else {\n                result.push(token);\n            }\n        }\n        else if (isValueDelimiter(token) || (inArgument && isWhiteSpace$1(token))) {\n            scanner.pos++;\n        }\n        else {\n            break;\n        }\n    }\n    return result.length\n        ? { type: 'CSSValue', value: result }\n        : void 0;\n}\nfunction consumeArguments(scanner) {\n    const start = scanner.pos;\n    if (consume$1(scanner, isOpenBracket$1)) {\n        const args = [];\n        let value;\n        while (readable(scanner) && !consume$1(scanner, isCloseBracket$1)) {\n            if (value = consumeValue(scanner, true)) {\n                args.push(value);\n            }\n            else if (!consume$1(scanner, isWhiteSpace$1) && !consume$1(scanner, isArgumentDelimiter)) {\n                throw error(scanner, 'Unexpected token');\n            }\n        }\n        scanner.start = start;\n        return args;\n    }\n}\nfunction isLiteral(token) {\n    return token && token.type === 'Literal';\n}\nfunction isBracket(token, open) {\n    return token && token.type === 'Bracket' && (open == null || token.open === open);\n}\nfunction isOpenBracket$1(token) {\n    return isBracket(token, true);\n}\nfunction isCloseBracket$1(token) {\n    return isBracket(token, false);\n}\nfunction isWhiteSpace$1(token) {\n    return token && token.type === 'WhiteSpace';\n}\nfunction isOperator(token, operator) {\n    return token && token.type === 'Operator' && (!operator || token.operator === operator);\n}\nfunction isSiblingOperator(token) {\n    return isOperator(token, OperatorType.Sibling);\n}\nfunction isArgumentDelimiter(token) {\n    return isOperator(token, OperatorType.ArgumentDelimiter);\n}\nfunction isFragmentDelimiter(token) {\n    return isArgumentDelimiter(token);\n}\nfunction isImportant(token) {\n    return isOperator(token, OperatorType.Important);\n}\nfunction isValue(token) {\n    return token.type === 'StringValue'\n        || token.type === 'ColorValue'\n        || token.type === 'NumberValue'\n        || token.type === 'Literal'\n        || token.type === 'Field'\n        || token.type === 'CustomProperty';\n}\nfunction isValueDelimiter(token) {\n    return isOperator(token, OperatorType.PropertyDelimiter)\n        || isOperator(token, OperatorType.ValueDelimiter);\n}\nfunction isFunctionStart(scanner) {\n    const t1 = scanner.tokens[scanner.pos];\n    const t2 = scanner.tokens[scanner.pos + 1];\n    return t1 && t2 && isLiteral(t1) && t2.type === 'Bracket';\n}\n\n/**\n * Parses given abbreviation into property set\n */\nfunction parse$2(abbr, options) {\n    try {\n        const tokens = typeof abbr === 'string' ? tokenize(abbr, options && options.value) : abbr;\n        return parser(tokens, options);\n    }\n    catch (err) {\n        if (err instanceof ScannerError && typeof abbr === 'string') {\n            err.message += `\\n${abbr}\\n${'-'.repeat(err.pos)}^`;\n        }\n        throw err;\n    }\n}\n\n/**\n * Merges attributes in current node: de-duplicates attributes with the same name\n * and merges class names\n */\nfunction mergeAttributes(node, config) {\n    if (!node.attributes) {\n        return;\n    }\n    const attributes = [];\n    const lookup = {};\n    for (const attr of node.attributes) {\n        if (attr.name) {\n            const attrName = attr.name;\n            if (attrName in lookup) {\n                const prev = lookup[attrName];\n                if (attrName === 'class') {\n                    prev.value = mergeValue(prev.value, attr.value, ' ');\n                }\n                else {\n                    mergeDeclarations(prev, attr, config);\n                }\n            }\n            else {\n                // Create new attribute instance so we can safely modify it later\n                attributes.push(lookup[attrName] = Object.assign({}, attr));\n            }\n        }\n        else {\n            attributes.push(attr);\n        }\n    }\n    node.attributes = attributes;\n}\n/**\n * Merges two token lists into single list. Adjacent strings are merged together\n */\nfunction mergeValue(prev, next, glue) {\n    if (prev && next) {\n        if (prev.length && glue) {\n            append(prev, glue);\n        }\n        for (const t of next) {\n            append(prev, t);\n        }\n        return prev;\n    }\n    const result = prev || next;\n    return result && result.slice();\n}\n/**\n * Merges data from `src` attribute into `dest` and returns it\n */\nfunction mergeDeclarations(dest, src, config) {\n    dest.name = src.name;\n    if (!config.options['output.reverseAttributes']) {\n        dest.value = src.value;\n    }\n    // Keep high-priority properties\n    if (!dest.implied) {\n        dest.implied = src.implied;\n    }\n    if (!dest.boolean) {\n        dest.boolean = src.boolean;\n    }\n    if (dest.valueType !== 'expression') {\n        dest.valueType = src.valueType;\n    }\n    return dest;\n}\nfunction append(tokens, value) {\n    const lastIx = tokens.length - 1;\n    if (typeof tokens[lastIx] === 'string' && typeof value === 'string') {\n        tokens[lastIx] += value;\n    }\n    else {\n        tokens.push(value);\n    }\n}\n\n/**\n * Walks over each child node of given markup abbreviation AST node (not including\n * given one) and invokes `fn` on each node.\n * The `fn` callback accepts context node, list of ancestor nodes and optional\n * state object\n */\nfunction walk$1(node, fn, state) {\n    const ancestors = [node];\n    const callback = (ctx) => {\n        fn(ctx, ancestors, state);\n        ancestors.push(ctx);\n        ctx.children.forEach(callback);\n        ancestors.pop();\n    };\n    node.children.forEach(callback);\n}\n/**\n * Finds node which is the deepest for in current node or node itself.\n */\nfunction findDeepest(node) {\n    let parent;\n    while (node.children.length) {\n        parent = node;\n        node = node.children[node.children.length - 1];\n    }\n    return { parent, node };\n}\nfunction isNode(node) {\n    return node.type === 'AbbreviationNode';\n}\n\n/**\n * Finds matching snippet from `registry` and resolves it into a parsed abbreviation.\n * Resolved node is then updated or replaced with matched abbreviation tree.\n *\n * A HTML registry basically contains aliases to another Emmet abbreviations,\n * e.g. a predefined set of name, attributes and so on, possibly a complex\n * abbreviation with multiple elements. So we have to get snippet, parse it\n * and recursively resolve it.\n */\nfunction resolveSnippets(abbr, config) {\n    const stack = [];\n    const reversed = config.options['output.reverseAttributes'];\n    const resolve = (child) => {\n        const snippet = child.name && config.snippets[child.name];\n        // A snippet in stack means circular reference.\n        // It can be either a user error or a perfectly valid snippet like\n        // \"img\": \"img[src alt]/\", e.g. an element with predefined shape.\n        // In any case, simply stop parsing and keep element as is\n        if (!snippet || stack.includes(snippet)) {\n            return null;\n        }\n        const snippetAbbr = parseAbbreviation(snippet, config);\n        stack.push(snippet);\n        walkResolve(snippetAbbr, resolve);\n        stack.pop();\n        // Add attributes from current node into every top-level node of parsed abbreviation\n        for (const topNode of snippetAbbr.children) {\n            if (child.attributes) {\n                const from = topNode.attributes || [];\n                const to = child.attributes || [];\n                topNode.attributes = reversed ? to.concat(from) : from.concat(to);\n            }\n            mergeNodes(child, topNode);\n        }\n        return snippetAbbr;\n    };\n    walkResolve(abbr, resolve);\n    return abbr;\n}\nfunction walkResolve(node, resolve, config) {\n    let children = [];\n    for (const child of node.children) {\n        const resolved = resolve(child);\n        if (resolved) {\n            children = children.concat(resolved.children);\n            const deepest = findDeepest(resolved);\n            if (isNode(deepest.node)) {\n                deepest.node.children = deepest.node.children.concat(walkResolve(child, resolve));\n            }\n        }\n        else {\n            children.push(child);\n            child.children = walkResolve(child, resolve);\n        }\n    }\n    return node.children = children;\n}\n/**\n * Adds data from first node into second node\n */\nfunction mergeNodes(from, to) {\n    if (from.selfClosing) {\n        to.selfClosing = true;\n    }\n    if (from.value != null) {\n        to.value = from.value;\n    }\n    if (from.repeat) {\n        to.repeat = from.repeat;\n    }\n}\n\nconst expressionStart = '{';\nconst expressionEnd = '}';\nfunction createOutputStream(options, level = 0) {\n    return {\n        options,\n        value: '',\n        level,\n        offset: 0,\n        line: 0,\n        column: 0\n    };\n}\n/**\n * Pushes plain string into output stream without newline processing\n */\nfunction push(stream, text) {\n    const processText = stream.options['output.text'];\n    _push(stream, processText(text, stream.offset, stream.line, stream.column));\n}\n/**\n * Pushes given string with possible newline formatting into output\n */\nfunction pushString(stream, value) {\n    // If given value contains newlines, we should push content line-by-line and\n    // use `pushNewline()` to maintain proper line/column state\n    const lines = splitByLines$1(value);\n    for (let i = 0, il = lines.length - 1; i <= il; i++) {\n        push(stream, lines[i]);\n        if (i !== il) {\n            pushNewline(stream, true);\n        }\n    }\n}\n/**\n * Pushes new line into given output stream\n */\nfunction pushNewline(stream, indent) {\n    const baseIndent = stream.options['output.baseIndent'];\n    const newline = stream.options['output.newline'];\n    push(stream, newline + baseIndent);\n    stream.line++;\n    stream.column = baseIndent.length;\n    if (indent) {\n        pushIndent(stream, indent === true ? stream.level : indent);\n    }\n}\n/**\n * Adds indentation of `size` to current output stream\n */\nfunction pushIndent(stream, size = stream.level) {\n    const indent = stream.options['output.indent'];\n    push(stream, indent.repeat(Math.max(size, 0)));\n}\n/**\n * Pushes field/tabstop into output stream\n */\nfunction pushField(stream, index, placeholder) {\n    const field = stream.options['output.field'];\n    // NB: use `_push` instead of `push` to skip text processing\n    _push(stream, field(index, placeholder, stream.offset, stream.line, stream.column));\n}\n/**\n * Returns given tag name formatted according to given config\n */\nfunction tagName(name, config) {\n    return strCase(name, config.options['output.tagCase']);\n}\n/**\n * Returns given attribute name formatted according to given config\n */\nfunction attrName(name, config) {\n    return strCase(name, config.options['output.attributeCase']);\n}\n/**\n * Returns character for quoting value of given attribute\n */\nfunction attrQuote(attr, config, isOpen) {\n    if (attr.valueType === 'expression') {\n        return isOpen ? expressionStart : expressionEnd;\n    }\n    return config.options['output.attributeQuotes'] === 'single' ? '\\'' : '\"';\n}\n/**\n * Check if given attribute is boolean\n */\nfunction isBooleanAttribute(attr, config) {\n    return attr.boolean\n        || config.options['output.booleanAttributes'].includes((attr.name || '').toLowerCase());\n}\n/**\n * Returns a token for self-closing tag, depending on current options\n */\nfunction selfClose(config) {\n    switch (config.options['output.selfClosingStyle']) {\n        case 'xhtml': return ' /';\n        case 'xml': return '/';\n        default: return '';\n    }\n}\n/**\n * Check if given tag name belongs to inline-level element\n * @param node Parsed node or tag name\n */\nfunction isInline(node, config) {\n    if (typeof node === 'string') {\n        return config.options.inlineElements.includes(node.toLowerCase());\n    }\n    // inline node is a node either with inline-level name or text-only node\n    return node.name ? isInline(node.name, config) : Boolean(node.value && !node.attributes);\n}\n/**\n * Splits given text by lines\n */\nfunction splitByLines$1(text) {\n    return text.split(/\\r\\n|\\r|\\n/g);\n}\n/**\n * Pushes raw string into output stream without any processing\n */\nfunction _push(stream, text) {\n    stream.value += text;\n    stream.offset += text.length;\n    stream.column += text.length;\n}\nfunction strCase(str, type) {\n    if (type) {\n        return type === 'upper' ? str.toUpperCase() : str.toLowerCase();\n    }\n    return str;\n}\n\nconst elementMap = {\n    p: 'span',\n    ul: 'li',\n    ol: 'li',\n    table: 'tr',\n    tr: 'td',\n    tbody: 'tr',\n    thead: 'tr',\n    tfoot: 'tr',\n    colgroup: 'col',\n    select: 'option',\n    optgroup: 'option',\n    audio: 'source',\n    video: 'source',\n    object: 'param',\n    map: 'area'\n};\nfunction implicitTag(node, ancestors, config) {\n    if (!node.name && node.attributes) {\n        resolveImplicitTag(node, ancestors, config);\n    }\n}\nfunction resolveImplicitTag(node, ancestors, config) {\n    const parent = getParentElement(ancestors);\n    const contextName = config.context ? config.context.name : '';\n    const parentName = lowercase(parent ? parent.name : contextName);\n    node.name = elementMap[parentName]\n        || (isInline(parentName, config) ? 'span' : 'div');\n}\nfunction lowercase(str) {\n    return (str || '').toLowerCase();\n}\n/**\n * Returns closest element node from given ancestors list\n */\nfunction getParentElement(ancestors) {\n    for (let i = ancestors.length - 1; i >= 0; i--) {\n        const elem = ancestors[i];\n        if (isNode(elem)) {\n            return elem;\n        }\n    }\n}\n\nvar latin = {\n\t\"common\": [\"lorem\", \"ipsum\", \"dolor\", \"sit\", \"amet\", \"consectetur\", \"adipisicing\", \"elit\"],\n\t\"words\": [\"exercitationem\", \"perferendis\", \"perspiciatis\", \"laborum\", \"eveniet\",\n\t\t\"sunt\", \"iure\", \"nam\", \"nobis\", \"eum\", \"cum\", \"officiis\", \"excepturi\",\n\t\t\"odio\", \"consectetur\", \"quasi\", \"aut\", \"quisquam\", \"vel\", \"eligendi\",\n\t\t\"itaque\", \"non\", \"odit\", \"tempore\", \"quaerat\", \"dignissimos\",\n\t\t\"facilis\", \"neque\", \"nihil\", \"expedita\", \"vitae\", \"vero\", \"ipsum\",\n\t\t\"nisi\", \"animi\", \"cumque\", \"pariatur\", \"velit\", \"modi\", \"natus\",\n\t\t\"iusto\", \"eaque\", \"sequi\", \"illo\", \"sed\", \"ex\", \"et\", \"voluptatibus\",\n\t\t\"tempora\", \"veritatis\", \"ratione\", \"assumenda\", \"incidunt\", \"nostrum\",\n\t\t\"placeat\", \"aliquid\", \"fuga\", \"provident\", \"praesentium\", \"rem\",\n\t\t\"necessitatibus\", \"suscipit\", \"adipisci\", \"quidem\", \"possimus\",\n\t\t\"voluptas\", \"debitis\", \"sint\", \"accusantium\", \"unde\", \"sapiente\",\n\t\t\"voluptate\", \"qui\", \"aspernatur\", \"laudantium\", \"soluta\", \"amet\",\n\t\t\"quo\", \"aliquam\", \"saepe\", \"culpa\", \"libero\", \"ipsa\", \"dicta\",\n\t\t\"reiciendis\", \"nesciunt\", \"doloribus\", \"autem\", \"impedit\", \"minima\",\n\t\t\"maiores\", \"repudiandae\", \"ipsam\", \"obcaecati\", \"ullam\", \"enim\",\n\t\t\"totam\", \"delectus\", \"ducimus\", \"quis\", \"voluptates\", \"dolores\",\n\t\t\"molestiae\", \"harum\", \"dolorem\", \"quia\", \"voluptatem\", \"molestias\",\n\t\t\"magni\", \"distinctio\", \"omnis\", \"illum\", \"dolorum\", \"voluptatum\", \"ea\",\n\t\t\"quas\", \"quam\", \"corporis\", \"quae\", \"blanditiis\", \"atque\", \"deserunt\",\n\t\t\"laboriosam\", \"earum\", \"consequuntur\", \"hic\", \"cupiditate\",\n\t\t\"quibusdam\", \"accusamus\", \"ut\", \"rerum\", \"error\", \"minus\", \"eius\",\n\t\t\"ab\", \"ad\", \"nemo\", \"fugit\", \"officia\", \"at\", \"in\", \"id\", \"quos\",\n\t\t\"reprehenderit\", \"numquam\", \"iste\", \"fugiat\", \"sit\", \"inventore\",\n\t\t\"beatae\", \"repellendus\", \"magnam\", \"recusandae\", \"quod\", \"explicabo\",\n\t\t\"doloremque\", \"aperiam\", \"consequatur\", \"asperiores\", \"commodi\",\n\t\t\"optio\", \"dolor\", \"labore\", \"temporibus\", \"repellat\", \"veniam\",\n\t\t\"architecto\", \"est\", \"esse\", \"mollitia\", \"nulla\", \"a\", \"similique\",\n\t\t\"eos\", \"alias\", \"dolore\", \"tenetur\", \"deleniti\", \"porro\", \"facere\",\n\t\t\"maxime\", \"corrupti\"]\n};\n\nvar ru = {\n\t\"common\": [\"\u0434\u0430\u043B\u0435\u043A\u043E-\u0434\u0430\u043B\u0435\u043A\u043E\", \"\u0437\u0430\", \"\u0441\u043B\u043E\u0432\u0435\u0441\u043D\u044B\u043C\u0438\", \"\u0433\u043E\u0440\u0430\u043C\u0438\", \"\u0432 \u0441\u0442\u0440\u0430\u043D\u0435\", \"\u0433\u043B\u0430\u0441\u043D\u044B\u0445\", \"\u0438 \u0441\u043E\u0433\u043B\u0430\u0441\u043D\u044B\u0445\", \"\u0436\u0438\u0432\u0443\u0442\", \"\u0440\u044B\u0431\u043D\u044B\u0435\", \"\u0442\u0435\u043A\u0441\u0442\u044B\"],\n\t\"words\": [\"\u0432\u0434\u0430\u043B\u0438\", \"\u043E\u0442 \u0432\u0441\u0435\u0445\", \"\u043E\u043D\u0438\", \"\u0431\u0443\u043A\u0432\u0435\u043D\u043D\u044B\u0445\", \"\u0434\u043E\u043C\u0430\u0445\", \"\u043D\u0430 \u0431\u0435\u0440\u0435\u0433\u0443\", \"\u0441\u0435\u043C\u0430\u043D\u0442\u0438\u043A\u0430\",\n\t\t\"\u0431\u043E\u043B\u044C\u0448\u043E\u0433\u043E\", \"\u044F\u0437\u044B\u043A\u043E\u0432\u043E\u0433\u043E\", \"\u043E\u043A\u0435\u0430\u043D\u0430\", \"\u043C\u0430\u043B\u0435\u043D\u044C\u043A\u0438\u0439\", \"\u0440\u0443\u0447\u0435\u0435\u043A\", \"\u0434\u0430\u043B\u044C\",\n\t\t\"\u0436\u0443\u0440\u0447\u0438\u0442\", \"\u043F\u043E \u0432\u0441\u0435\u0439\", \"\u043E\u0431\u0435\u0441\u043F\u0435\u0447\u0438\u0432\u0430\u0435\u0442\", \"\u0435\u0435\",\"\u0432\u0441\u0435\u043C\u0438\", \"\u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u044B\u043C\u0438\",\n\t\t\"\u043F\u0440\u0430\u0432\u0438\u043B\u0430\u043C\u0438\", \"\u044D\u0442\u0430\", \"\u043F\u0430\u0440\u0430\u0434\u0438\u0433\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0430\u044F\", \"\u0441\u0442\u0440\u0430\u043D\u0430\", \"\u043A\u043E\u0442\u043E\u0440\u043E\u0439\", \"\u0436\u0430\u0440\u0435\u043D\u043D\u044B\u0435\",\n\t\t\"\u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u044F\", \"\u0437\u0430\u043B\u0435\u0442\u0430\u044E\u0442\", \"\u043F\u0440\u044F\u043C\u043E\", \"\u0440\u043E\u0442\", \"\u0434\u0430\u0436\u0435\", \"\u0432\u0441\u0435\u043C\u043E\u0433\u0443\u0449\u0430\u044F\",\n\t\t\"\u043F\u0443\u043D\u043A\u0442\u0443\u0430\u0446\u0438\u044F\", \"\u043D\u0435\", \"\u0438\u043C\u0435\u0435\u0442\", \"\u0432\u043B\u0430\u0441\u0442\u0438\", \"\u043D\u0430\u0434\", \"\u0440\u044B\u0431\u043D\u044B\u043C\u0438\", \"\u0442\u0435\u043A\u0441\u0442\u0430\u043C\u0438\",\n\t\t\"\u0432\u0435\u0434\u0443\u0449\u0438\u043C\u0438\", \"\u0431\u0435\u0437\u043E\u0440\u0444\u043E\u0433\u0440\u0430\u0444\u0438\u0447\u043D\u044B\u0439\", \"\u043E\u0431\u0440\u0430\u0437\", \"\u0436\u0438\u0437\u043D\u0438\", \"\u043E\u0434\u043D\u0430\u0436\u0434\u044B\", \"\u043E\u0434\u043D\u0430\",\n\t\t\"\u043C\u0430\u043B\u0435\u043D\u044C\u043A\u0430\u044F\", \"\u0441\u0442\u0440\u043E\u0447\u043A\u0430\",\"\u0440\u044B\u0431\u043D\u043E\u0433\u043E\", \"\u0442\u0435\u043A\u0441\u0442\u0430\", \"\u0438\u043C\u0435\u043D\u0438\", \"lorem\", \"ipsum\",\n\t\t\"\u0440\u0435\u0448\u0438\u043B\u0430\", \"\u0432\u044B\u0439\u0442\u0438\", \"\u0431\u043E\u043B\u044C\u0448\u043E\u0439\", \"\u043C\u0438\u0440\", \"\u0433\u0440\u0430\u043C\u043C\u0430\u0442\u0438\u043A\u0438\", \"\u0432\u0435\u043B\u0438\u043A\u0438\u0439\", \"\u043E\u043A\u0441\u043C\u043E\u043A\u0441\",\n\t\t\"\u043F\u0440\u0435\u0434\u0443\u043F\u0440\u0435\u0436\u0434\u0430\u043B\", \"\u043E\", \"\u0437\u043B\u044B\u0445\", \"\u0437\u0430\u043F\u044F\u0442\u044B\u0445\", \"\u0434\u0438\u043A\u0438\u0445\", \"\u0437\u043D\u0430\u043A\u0430\u0445\", \"\u0432\u043E\u043F\u0440\u043E\u0441\u0430\",\n\t\t\"\u043A\u043E\u0432\u0430\u0440\u043D\u044B\u0445\", \"\u0442\u043E\u0447\u043A\u0430\u0445\", \"\u0437\u0430\u043F\u044F\u0442\u043E\u0439\", \"\u043D\u043E\", \"\u0442\u0435\u043A\u0441\u0442\", \"\u0434\u0430\u043B\", \"\u0441\u0431\u0438\u0442\u044C\",\n\t\t\"\u0441\u0435\u0431\u044F\", \"\u0442\u043E\u043B\u043A\u0443\", \"\u043E\u043D\", \"\u0441\u043E\u0431\u0440\u0430\u043B\", \"\u0441\u0435\u043C\u044C\", \"\u0441\u0432\u043E\u0438\u0445\", \"\u0437\u0430\u0433\u043B\u0430\u0432\u043D\u044B\u0445\", \"\u0431\u0443\u043A\u0432\",\n\t\t\"\u043F\u043E\u0434\u043F\u043E\u044F\u0441\u0430\u043B\", \"\u0438\u043D\u0438\u0446\u0438\u0430\u043B\", \"\u0437\u0430\", \"\u043F\u043E\u044F\u0441\", \"\u043F\u0443\u0441\u0442\u0438\u043B\u0441\u044F\", \"\u0434\u043E\u0440\u043E\u0433\u0443\",\n\t\t\"\u0432\u0437\u043E\u0431\u0440\u0430\u0432\u0448\u0438\u0441\u044C\", \"\u043F\u0435\u0440\u0432\u0443\u044E\", \"\u0432\u0435\u0440\u0448\u0438\u043D\u0443\", \"\u043A\u0443\u0440\u0441\u0438\u0432\u043D\u044B\u0445\", \"\u0433\u043E\u0440\", \"\u0431\u0440\u043E\u0441\u0438\u043B\",\n\t\t\"\u043F\u043E\u0441\u043B\u0435\u0434\u043D\u0438\u0439\", \"\u0432\u0437\u0433\u043B\u044F\u0434\", \"\u043D\u0430\u0437\u0430\u0434\", \"\u0441\u0438\u043B\u0443\u044D\u0442\", \"\u0441\u0432\u043E\u0435\u0433\u043E\", \"\u0440\u043E\u0434\u043D\u043E\u0433\u043E\", \"\u0433\u043E\u0440\u043E\u0434\u0430\",\n\t\t\"\u0431\u0443\u043A\u0432\u043E\u0433\u0440\u0430\u0434\", \"\u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A\", \"\u0434\u0435\u0440\u0435\u0432\u043D\u0438\", \"\u0430\u043B\u0444\u0430\u0432\u0438\u0442\", \"\u043F\u043E\u0434\u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A\", \"\u0441\u0432\u043E\u0435\u0433\u043E\",\n\t\t\"\u043F\u0435\u0440\u0435\u0443\u043B\u043A\u0430\", \"\u0433\u0440\u0443\u0441\u0442\u043D\u044B\u0439\", \"\u0440\u0435\u0442\u043E\u0440\u0438\u0447\u0435\u0441\u043A\u0438\u0439\", \"\u0432\u043E\u043F\u0440\u043E\u0441\", \"\u0441\u043A\u0430\u0442\u0438\u043B\u0441\u044F\", \"\u0435\u0433\u043E\",\n\t\t\"\u0449\u0435\u043A\u0435\", \"\u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u043B\", \"\u0441\u0432\u043E\u0439\", \"\u043F\u0443\u0442\u044C\", \"\u0434\u043E\u0440\u043E\u0433\u0435\", \"\u0432\u0441\u0442\u0440\u0435\u0442\u0438\u043B\", \"\u0440\u0443\u043A\u043E\u043F\u0438\u0441\u044C\",\n\t\t\"\u043E\u043D\u0430\", \"\u043F\u0440\u0435\u0434\u0443\u043F\u0440\u0435\u0434\u0438\u043B\u0430\",  \"\u043C\u043E\u0435\u0439\", \"\u0432\u0441\u0435\", \"\u043F\u0435\u0440\u0435\u043F\u0438\u0441\u044B\u0432\u0430\u0435\u0442\u0441\u044F\", \"\u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E\",\n\t\t\"\u0440\u0430\u0437\", \"\u0435\u0434\u0438\u043D\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0435\", \"\u0447\u0442\u043E\", \"\u043C\u0435\u043D\u044F\", \"\u043E\u0441\u0442\u0430\u043B\u043E\u0441\u044C\", \"\u044D\u0442\u043E\", \"\u043F\u0440\u0438\u0441\u0442\u0430\u0432\u043A\u0430\",\n\t\t\"\u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0430\u0439\u0441\u044F\", \"\u0442\u044B\", \"\u043B\u0443\u0447\u0448\u0435\", \"\u0441\u0432\u043E\u044E\", \"\u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u0443\u044E\", \"\u0441\u0442\u0440\u0430\u043D\u0443\", \"\u043F\u043E\u0441\u043B\u0443\u0448\u0430\u0432\u0448\u0438\u0441\u044C\",\n\t\t\"\u0440\u0443\u043A\u043E\u043F\u0438\u0441\u0438\", \"\u043D\u0430\u0448\", \"\u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u043B\", \"\u0441\u0432\u043E\u0439\", \"\u043F\u0443\u0442\u044C\", \"\u0432\u0441\u043A\u043E\u0440\u0435\", \"\u0435\u043C\u0443\",\n\t\t\"\u043F\u043E\u0432\u0441\u0442\u0440\u0435\u0447\u0430\u043B\u0441\u044F\", \"\u043A\u043E\u0432\u0430\u0440\u043D\u044B\u0439\", \"\u0441\u043E\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043B\u044C\", \"\u0440\u0435\u043A\u043B\u0430\u043C\u043D\u044B\u0445\", \"\u0442\u0435\u043A\u0441\u0442\u043E\u0432\",\n\t\t\"\u043D\u0430\u043F\u043E\u0438\u0432\u0448\u0438\u0439\", \"\u044F\u0437\u044B\u043A\u043E\u043C\", \"\u0440\u0435\u0447\u044C\u044E\", \"\u0437\u0430\u043C\u0430\u043D\u0438\u0432\u0448\u0438\u0439\", \"\u0441\u0432\u043E\u0435\", \"\u0430\u0433\u0435\u043D\u0442\u0441\u0442\u0432\u043E\",\n\t\t\"\u043A\u043E\u0442\u043E\u0440\u043E\u0435\", \"\u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043B\u043E\", \"\u0441\u043D\u043E\u0432\u0430\", \"\u0441\u043D\u043E\u0432\u0430\", \"\u0441\u0432\u043E\u0438\u0445\", \"\u043F\u0440\u043E\u0435\u043A\u0442\u0430\u0445\",\n\t\t\"\u0435\u0441\u043B\u0438\", \"\u043F\u0435\u0440\u0435\u043F\u0438\u0441\u0430\u043B\u0438\", \"\u0442\u043E\", \"\u0436\u0438\u0432\u0435\u0442\", \"\u0442\u0430\u043C\", \"\u0434\u043E\", \"\u0441\u0438\u0445\", \"\u043F\u043E\u0440\"]\n};\n\nvar sp = {\n\t\"common\": [\"mujer\", \"uno\", \"dolor\", \"m\u00E1s\", \"de\", \"poder\", \"mismo\", \"si\"],\n\t\"words\": [\"ejercicio\", \"preferencia\", \"perspicacia\", \"laboral\", \"pa\u00F1o\",\n\t\t\"suntuoso\", \"molde\", \"namibia\", \"planeador\", \"mirar\", \"dem\u00E1s\", \"oficinista\", \"excepci\u00F3n\",\n\t\t\"odio\", \"consecuencia\", \"casi\", \"auto\", \"chicharra\", \"velo\", \"elixir\",\n\t\t\"ataque\", \"no\", \"odio\", \"temporal\", \"cu\u00F3rum\", \"dign\u00EDsimo\",\n\t\t\"facilismo\", \"letra\", \"nihilista\", \"expedici\u00F3n\", \"alma\", \"alveolar\", \"aparte\",\n\t\t\"le\u00F3n\", \"animal\", \"como\", \"paria\", \"belleza\", \"modo\", \"natividad\",\n\t\t\"justo\", \"ataque\", \"s\u00E9quito\", \"pillo\", \"sed\", \"ex\", \"y\", \"voluminoso\",\n\t\t\"temporalidad\", \"verdades\", \"racional\", \"asunci\u00F3n\", \"incidente\", \"marejada\",\n\t\t\"placenta\", \"amanecer\", \"fuga\", \"previsor\", \"presentaci\u00F3n\", \"lejos\",\n\t\t\"necesariamente\", \"sospechoso\", \"adiposidad\", \"quind\u00EDo\", \"p\u00F3cima\",\n\t\t\"voluble\", \"d\u00E9bito\", \"sinti\u00F3\", \"accesorio\", \"falda\", \"sapiencia\",\n\t\t\"volutas\", \"queso\", \"permacultura\", \"laudo\", \"soluciones\", \"entero\",\n\t\t\"pan\", \"litro\", \"tonelada\", \"culpa\", \"libertario\", \"mosca\", \"dictado\",\n\t\t\"reincidente\", \"nascimiento\", \"dolor\", \"escolar\", \"impedimento\", \"m\u00EDnima\",\n\t\t\"mayores\", \"repugnante\", \"dulce\", \"obcecado\", \"monta\u00F1a\", \"enigma\",\n\t\t\"total\", \"delet\u00E9reo\", \"d\u00E9cima\", \"c\u00E1bala\", \"fotograf\u00EDa\", \"dolores\",\n\t\t\"molesto\", \"olvido\", \"paciencia\", \"resiliencia\", \"voluntad\", \"molestias\",\n\t\t\"magn\u00EDfico\", \"distinci\u00F3n\", \"ovni\", \"marejada\", \"cerro\", \"torre\", \"y\",\n\t\t\"abogada\", \"manantial\", \"corporal\", \"agua\", \"crep\u00FAsculo\", \"ataque\", \"desierto\",\n\t\t\"laboriosamente\", \"angustia\", \"afortunado\", \"alma\", \"encefalograma\",\n\t\t\"materialidad\", \"cosas\", \"o\", \"renuncia\", \"error\", \"menos\", \"conejo\",\n\t\t\"abad\u00EDa\", \"analfabeto\", \"remo\", \"fugacidad\", \"oficio\", \"en\", \"alm\u00E1cigo\", \"vos\", \"pan\",\n\t\t\"represi\u00F3n\", \"n\u00FAmeros\", \"triste\", \"refugiado\", \"trote\", \"inventor\",\n\t\t\"corchea\", \"repelente\", \"magma\", \"recusado\", \"patr\u00F3n\", \"expl\u00EDcito\",\n\t\t\"paloma\", \"s\u00EDndrome\", \"inmune\", \"autoinmune\", \"comodidad\",\n\t\t\"ley\", \"vietnamita\", \"demonio\", \"tasmania\", \"repeler\", \"ap\u00E9ndice\",\n\t\t\"arquitecto\", \"columna\", \"yugo\", \"computador\", \"mula\", \"a\", \"prop\u00F3sito\",\n\t\t\"fantas\u00EDa\", \"alias\", \"rayo\", \"tenedor\", \"deleznable\", \"ventana\", \"cara\",\n\t\t\"anemia\", \"corrupto\"]\n};\n\nconst vocabularies = { ru, sp, latin };\nconst reLorem = /^lorem([a-z]*)(\\d*)(-\\d*)?$/i;\nfunction lorem(node, ancestors, config) {\n    let m;\n    if (node.name && (m = node.name.match(reLorem))) {\n        const db = vocabularies[m[1]] || vocabularies.latin;\n        const minWordCount = m[2] ? Math.max(1, Number(m[2])) : 30;\n        const maxWordCount = m[3] ? Math.max(minWordCount, Number(m[3].slice(1))) : minWordCount;\n        const wordCount = rand(minWordCount, maxWordCount);\n        const repeat = node.repeat || findRepeater(ancestors);\n        node.name = node.attributes = void 0;\n        node.value = [paragraph(db, wordCount, !repeat || repeat.value === 0)];\n        if (node.repeat && ancestors.length > 1) {\n            resolveImplicitTag(node, ancestors, config);\n        }\n    }\n}\n/**\n * Returns random integer between <code>from</code> and <code>to</code> values\n */\nfunction rand(from, to) {\n    return Math.floor(Math.random() * (to - from) + from);\n}\nfunction sample(arr, count) {\n    const len = arr.length;\n    const iterations = Math.min(len, count);\n    const result = [];\n    while (result.length < iterations) {\n        const str = arr[rand(0, len)];\n        if (!result.includes(str)) {\n            result.push(str);\n        }\n    }\n    return result;\n}\nfunction choice(val) {\n    return val[rand(0, val.length - 1)];\n}\nfunction sentence(words, end) {\n    if (words.length) {\n        words = [capitalize(words[0])].concat(words.slice(1));\n    }\n    return words.join(' ') + (end || choice('?!...')); // more dots than question marks\n}\nfunction capitalize(word) {\n    return word[0].toUpperCase() + word.slice(1);\n}\n/**\n * Insert commas at randomly selected words. This function modifies values\n * inside `words` array\n */\nfunction insertCommas(words) {\n    if (words.length < 2) {\n        return words;\n    }\n    words = words.slice();\n    const len = words.length;\n    const hasComma = /,$/;\n    let totalCommas = 0;\n    if (len > 3 && len <= 6) {\n        totalCommas = rand(0, 1);\n    }\n    else if (len > 6 && len <= 12) {\n        totalCommas = rand(0, 2);\n    }\n    else {\n        totalCommas = rand(1, 4);\n    }\n    for (let i = 0, pos; i < totalCommas; i++) {\n        pos = rand(0, len - 2);\n        if (!hasComma.test(words[pos])) {\n            words[pos] += ',';\n        }\n    }\n    return words;\n}\n/**\n * Generate a paragraph of \"Lorem ipsum\" text\n * @param dict Words dictionary\n * @param wordCount Words count in paragraph\n * @param startWithCommon Should paragraph start with common \"lorem ipsum\" sentence.\n */\nfunction paragraph(dict, wordCount, startWithCommon) {\n    const result = [];\n    let totalWords = 0;\n    let words;\n    if (startWithCommon && dict.common) {\n        words = dict.common.slice(0, wordCount);\n        totalWords += words.length;\n        result.push(sentence(insertCommas(words), '.'));\n    }\n    while (totalWords < wordCount) {\n        words = sample(dict.words, Math.min(rand(2, 30), wordCount - totalWords));\n        totalWords += words.length;\n        result.push(sentence(insertCommas(words)));\n    }\n    return result.join(' ');\n}\nfunction findRepeater(ancestors) {\n    for (let i = ancestors.length - 1; i >= 0; i--) {\n        const element = ancestors[i];\n        if (element.type === 'AbbreviationNode' && element.repeat) {\n            return element.repeat;\n        }\n    }\n}\n\n/**\n * XSL transformer: removes `select` attributes from certain nodes that contain\n * children\n */\nfunction xsl(node) {\n    if (matchesName(node.name) && node.attributes && (node.children.length || node.value)) {\n        node.attributes = node.attributes.filter(isAllowed);\n    }\n}\nfunction isAllowed(attr) {\n    return attr.name !== 'select';\n}\nfunction matchesName(name) {\n    return name === 'xsl:variable' || name === 'xsl:with-param';\n}\n\nconst reElement = /^(-+)([a-z0-9]+[a-z0-9-]*)/i;\nconst reModifier = /^(_+)([a-z0-9]+[a-z0-9-_]*)/i;\nconst blockCandidates1 = (className) => /^[a-z]\\-/i.test(className);\nconst blockCandidates2 = (className) => /^[a-z]/i.test(className);\nfunction bem(node, ancestors, config) {\n    expandClassNames(node);\n    expandShortNotation(node, ancestors, config);\n}\n/**\n * Expands existing class names in BEM notation in given `node`.\n * For example, if node contains `b__el_mod` class name, this method ensures\n * that element contains `b__el` class as well\n */\nfunction expandClassNames(node) {\n    const data = getBEMData(node);\n    const classNames = [];\n    for (const cl of data.classNames) {\n        // remove all modifiers and element prefixes from class name to get a base element name\n        const ix = cl.indexOf('_');\n        if (ix > 0 && !cl.startsWith('-')) {\n            classNames.push(cl.slice(0, ix));\n            classNames.push(cl.slice(ix));\n        }\n        else {\n            classNames.push(cl);\n        }\n    }\n    if (classNames.length) {\n        data.classNames = classNames.filter(uniqueClass);\n        data.block = findBlockName(data.classNames);\n        updateClass(node, data.classNames.join(' '));\n    }\n}\n/**\n * Expands short BEM notation, e.g. `-element` and `_modifier`\n */\nfunction expandShortNotation(node, ancestors, config) {\n    const data = getBEMData(node);\n    const classNames = [];\n    const { options } = config;\n    const path = ancestors.slice(1).concat(node);\n    for (let cl of data.classNames) {\n        let prefix = '';\n        let m;\n        const originalClass = cl;\n        // parse element definition (could be only one)\n        if (m = cl.match(reElement)) {\n            prefix = getBlockName(path, m[1].length, config.context) + options['bem.element'] + m[2];\n            classNames.push(prefix);\n            cl = cl.slice(m[0].length);\n        }\n        // parse modifiers definitions\n        if (m = cl.match(reModifier)) {\n            if (!prefix) {\n                prefix = getBlockName(path, m[1].length);\n                classNames.push(prefix);\n            }\n            classNames.push(`${prefix}${options['bem.modifier']}${m[2]}`);\n            cl = cl.slice(m[0].length);\n        }\n        if (cl === originalClass) {\n            // class name wasn\u2019t modified: it\u2019s not a BEM-specific class,\n            // add it as-is into output\n            classNames.push(originalClass);\n        }\n    }\n    const arrClassNames = classNames.filter(uniqueClass);\n    if (arrClassNames.length) {\n        updateClass(node, arrClassNames.join(' '));\n    }\n}\n/**\n * Returns BEM data from given abbreviation node\n */\nfunction getBEMData(node) {\n    if (!node._bem) {\n        let classValue = '';\n        if (node.attributes) {\n            for (const attr of node.attributes) {\n                if (attr.name === 'class' && attr.value) {\n                    classValue = stringifyValue(attr.value);\n                    break;\n                }\n            }\n        }\n        node._bem = parseBEM(classValue);\n    }\n    return node._bem;\n}\nfunction getBEMDataFromContext(context) {\n    if (!context._bem) {\n        context._bem = parseBEM(context.attributes && context.attributes.class || '');\n    }\n    return context._bem;\n}\n/**\n * Parses BEM data from given class name\n */\nfunction parseBEM(classValue) {\n    const classNames = classValue ? classValue.split(/\\s+/) : [];\n    return {\n        classNames,\n        block: findBlockName(classNames)\n    };\n}\n/**\n * Returns block name for given `node` by `prefix`, which tells the depth of\n * of parent node lookup\n */\nfunction getBlockName(ancestors, depth = 0, context) {\n    const maxParentIx = 0;\n    let parentIx = Math.max(ancestors.length - depth, maxParentIx);\n    do {\n        const parent = ancestors[parentIx];\n        if (parent) {\n            const data = getBEMData(parent);\n            if (data.block) {\n                return data.block;\n            }\n        }\n    } while (maxParentIx < parentIx--);\n    if (context) {\n        const data = getBEMDataFromContext(context);\n        if (data.block) {\n            return data.block;\n        }\n    }\n    return '';\n}\nfunction findBlockName(classNames) {\n    return find(classNames, blockCandidates1)\n        || find(classNames, blockCandidates2)\n        || void 0;\n}\n/**\n * Finds class name from given list which may be used as block name\n */\nfunction find(classNames, filter) {\n    for (const cl of classNames) {\n        if (reElement.test(cl) || reModifier.test(cl)) {\n            break;\n        }\n        if (filter(cl)) {\n            return cl;\n        }\n    }\n}\nfunction updateClass(node, value) {\n    for (const attr of node.attributes) {\n        if (attr.name === 'class') {\n            attr.value = [value];\n            break;\n        }\n    }\n}\nfunction stringifyValue(value) {\n    let result = '';\n    for (const t of value) {\n        result += typeof t === 'string' ? t : t.name;\n    }\n    return result;\n}\nfunction uniqueClass(item, ix, arr) {\n    return !!item && arr.indexOf(item) === ix;\n}\n\nfunction walk(abbr, visitor, state) {\n    const callback = (ctx, index, items) => {\n        const { parent, current } = state;\n        state.parent = current;\n        state.current = ctx;\n        visitor(ctx, index, items, state, next);\n        state.current = current;\n        state.parent = parent;\n    };\n    const next = (node, index, items) => {\n        state.ancestors.push(state.current);\n        callback(node, index, items);\n        state.ancestors.pop();\n    };\n    abbr.children.forEach(callback);\n}\nfunction createWalkState(config) {\n    return {\n        // @ts-ignore: Will set value in iterator\n        current: null,\n        parent: void 0,\n        ancestors: [],\n        config,\n        field: 1,\n        out: createOutputStream(config.options)\n    };\n}\n\nconst caret = [{ type: 'Field', index: 0, name: '' }];\n/**\n * Check if given node is a snippet: a node without name and attributes\n */\nfunction isSnippet(node) {\n    return node ? !node.name && !node.attributes : false;\n}\n/**\n * Check if given node is inline-level element, e.g. element with explicitly\n * defined node name\n */\nfunction isInlineElement(node, config) {\n    return node ? isInline(node, config) : false;\n}\n/**\n * Check if given value token is a field\n */\nfunction isField(token) {\n    return typeof token === 'object' && token.type === 'Field';\n}\nfunction pushTokens(tokens, state) {\n    const { out } = state;\n    let largestIndex = -1;\n    for (const t of tokens) {\n        if (typeof t === 'string') {\n            pushString(out, t);\n        }\n        else {\n            pushField(out, state.field + t.index, t.name);\n            if (t.index > largestIndex) {\n                largestIndex = t.index;\n            }\n        }\n    }\n    if (largestIndex !== -1) {\n        state.field += largestIndex + 1;\n    }\n}\n/**\n * Splits given value token by lines: returns array where each entry is a token list\n * for a single line\n */\nfunction splitByLines(tokens) {\n    const result = [];\n    let line = [];\n    for (const t of tokens) {\n        if (typeof t === 'string') {\n            const lines = t.split(/\\r\\n?|\\n/g);\n            line.push(lines.shift() || '');\n            while (lines.length) {\n                result.push(line);\n                line = [lines.shift() || ''];\n            }\n        }\n        else {\n            line.push(t);\n        }\n    }\n    line.length && result.push(line);\n    return result;\n}\n/**\n * Check if given attribute should be outputted\n */\nfunction shouldOutputAttribute(attr) {\n    // In case if attribute is implied, check if it has a defined value:\n    // either non-empty value or quoted empty value\n    return !attr.implied || attr.valueType !== 'raw' || (!!attr.value && attr.value.length > 0);\n}\n\nvar TemplateChars;\n(function (TemplateChars) {\n    /** `[` character */\n    TemplateChars[TemplateChars[\"Start\"] = 91] = \"Start\";\n    /** `]` character */\n    TemplateChars[TemplateChars[\"End\"] = 93] = \"End\";\n    /* `_` character */\n    TemplateChars[TemplateChars[\"Underscore\"] = 95] = \"Underscore\";\n    /* `-` character */\n    TemplateChars[TemplateChars[\"Dash\"] = 45] = \"Dash\";\n})(TemplateChars || (TemplateChars = {}));\n/**\n * Splits given string into template tokens.\n * Template is a string which contains placeholders which are uppercase names\n * between `[` and `]`, for example: `[PLACEHOLDER]`.\n * Unlike other templates, a placeholder may contain extra characters before and\n * after name: `[%PLACEHOLDER.]`. If data for `PLACEHOLDER` is defined, it will\n * be outputted with with these extra character, otherwise will be completely omitted.\n */\nfunction template(text) {\n    const tokens = [];\n    const scanner = { pos: 0, text };\n    let placeholder;\n    let offset = scanner.pos;\n    let pos = scanner.pos;\n    while (scanner.pos < scanner.text.length) {\n        pos = scanner.pos;\n        if (placeholder = consumePlaceholder(scanner)) {\n            if (offset !== scanner.pos) {\n                tokens.push(text.slice(offset, pos));\n            }\n            tokens.push(placeholder);\n            offset = scanner.pos;\n        }\n        else {\n            scanner.pos++;\n        }\n    }\n    if (offset !== scanner.pos) {\n        tokens.push(text.slice(offset));\n    }\n    return tokens;\n}\n/**\n * Consumes placeholder like `[#ID]` from given scanner\n */\nfunction consumePlaceholder(scanner) {\n    if (peek$1(scanner) === TemplateChars.Start) {\n        const start = ++scanner.pos;\n        let namePos = start;\n        let afterPos = start;\n        let stack = 1;\n        while (scanner.pos < scanner.text.length) {\n            const code = peek$1(scanner);\n            if (isTokenStart(code)) {\n                namePos = scanner.pos;\n                while (isToken(peek$1(scanner))) {\n                    scanner.pos++;\n                }\n                afterPos = scanner.pos;\n            }\n            else {\n                if (code === TemplateChars.Start) {\n                    stack++;\n                }\n                else if (code === TemplateChars.End) {\n                    if (--stack === 0) {\n                        return {\n                            before: scanner.text.slice(start, namePos),\n                            after: scanner.text.slice(afterPos, scanner.pos++),\n                            name: scanner.text.slice(namePos, afterPos)\n                        };\n                    }\n                }\n                scanner.pos++;\n            }\n        }\n    }\n}\nfunction peek$1(scanner, pos = scanner.pos) {\n    return scanner.text.charCodeAt(pos);\n}\nfunction isTokenStart(code) {\n    return code >= 65 && code <= 90; // A-Z\n}\nfunction isToken(code) {\n    return isTokenStart(code)\n        || (code > 47 && code < 58) /* 0-9 */\n        || code === TemplateChars.Underscore\n        || code === TemplateChars.Dash;\n}\n\nfunction createCommentState(config) {\n    const { options } = config;\n    return {\n        enabled: options['comment.enabled'],\n        trigger: options['comment.trigger'],\n        before: options['comment.before'] ? template(options['comment.before']) : void 0,\n        after: options['comment.after'] ? template(options['comment.after']) : void 0\n    };\n}\n/**\n * Adds comment prefix for given node, if required\n */\nfunction commentNodeBefore(node, state) {\n    if (shouldComment(node, state) && state.comment.before) {\n        output(node, state.comment.before, state);\n    }\n}\n/**\n * Adds comment suffix for given node, if required\n */\nfunction commentNodeAfter(node, state) {\n    if (shouldComment(node, state) && state.comment.after) {\n        output(node, state.comment.after, state);\n    }\n}\n/**\n * Check if given node should be commented\n */\nfunction shouldComment(node, state) {\n    const { comment } = state;\n    if (!comment.enabled || !comment.trigger || !node.name || !node.attributes) {\n        return false;\n    }\n    for (const attr of node.attributes) {\n        if (attr.name && comment.trigger.includes(attr.name)) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Pushes given template tokens into output stream\n */\nfunction output(node, tokens, state) {\n    const attrs = {};\n    const { out } = state;\n    // Collect attributes payload\n    for (const attr of node.attributes) {\n        if (attr.name && attr.value) {\n            attrs[attr.name.toUpperCase()] = attr.value;\n        }\n    }\n    // Output parsed tokens\n    for (const token of tokens) {\n        if (typeof token === 'string') {\n            pushString(out, token);\n        }\n        else if (attrs[token.name]) {\n            pushString(out, token.before);\n            pushTokens(attrs[token.name], state);\n            pushString(out, token.after);\n        }\n    }\n}\n\nconst htmlTagRegex = /^<([\\w\\-:]+)[\\s>]/;\nconst reservedKeywords = new Set([\n    'for', 'while', 'of', 'async', 'await', 'const', 'let', 'var', 'continue',\n    'break', 'debugger', 'do', 'export', 'import', 'in', 'instanceof', 'new', 'return',\n    'switch', 'this', 'throw', 'try', 'catch', 'typeof', 'void', 'with', 'yield'\n]);\nfunction html(abbr, config) {\n    const state = createWalkState(config);\n    state.comment = createCommentState(config);\n    walk(abbr, element$1, state);\n    return state.out.value;\n}\n/**\n * Outputs `node` content to output stream of `state`\n * @param node Context node\n * @param index Index of `node` in `items`\n * @param items List of `node`\u2019s siblings\n * @param state Current walk state\n */\nfunction element$1(node, index, items, state, next) {\n    const { out, config } = state;\n    const format = shouldFormat$1(node, index, items, state);\n    // Pick offset level for current node\n    const level = getIndent(state);\n    out.level += level;\n    format && pushNewline(out, true);\n    if (node.name) {\n        const name = tagName(node.name, config);\n        commentNodeBefore(node, state);\n        pushString(out, `<${name}`);\n        if (node.attributes) {\n            for (const attr of node.attributes) {\n                if (shouldOutputAttribute(attr)) {\n                    pushAttribute(attr, state);\n                }\n            }\n        }\n        if (node.selfClosing && !node.children.length && !node.value) {\n            pushString(out, `${selfClose(config)}>`);\n        }\n        else {\n            pushString(out, '>');\n            if (!pushSnippet(node, state, next)) {\n                if (node.value) {\n                    const innerFormat = node.value.some(hasNewline) || startsWithBlockTag(node.value, config);\n                    innerFormat && pushNewline(state.out, ++out.level);\n                    pushTokens(node.value, state);\n                    innerFormat && pushNewline(state.out, --out.level);\n                }\n                node.children.forEach(next);\n                if (!node.value && !node.children.length) {\n                    const innerFormat = config.options['output.formatLeafNode']\n                        || config.options['output.formatForce'].includes(node.name);\n                    innerFormat && pushNewline(state.out, ++out.level);\n                    pushTokens(caret, state);\n                    innerFormat && pushNewline(state.out, --out.level);\n                }\n            }\n            pushString(out, `</${name}>`);\n            commentNodeAfter(node, state);\n        }\n    }\n    else if (!pushSnippet(node, state, next) && node.value) {\n        // A text-only node (snippet)\n        pushTokens(node.value, state);\n        node.children.forEach(next);\n    }\n    if (format && index === items.length - 1 && state.parent) {\n        const offset = isSnippet(state.parent) ? 0 : 1;\n        pushNewline(out, out.level - offset);\n    }\n    out.level -= level;\n}\n/**\n * Outputs given attribute\u2019s content into output stream\n */\nfunction pushAttribute(attr, state) {\n    const { out, config } = state;\n    if (attr.name) {\n        const attributes = config.options['markup.attributes'];\n        const valuePrefix = config.options['markup.valuePrefix'];\n        let { name, value } = attr;\n        let lQuote = attrQuote(attr, config, true);\n        let rQuote = attrQuote(attr, config);\n        if (attributes) {\n            name = getMultiValue(name, attributes, attr.multiple) || name;\n        }\n        name = attrName(name, config);\n        if (config.options['jsx.enabled'] && attr.multiple) {\n            lQuote = expressionStart;\n            rQuote = expressionEnd;\n        }\n        const prefix = valuePrefix\n            ? getMultiValue(attr.name, valuePrefix, attr.multiple)\n            : null;\n        if (prefix && (value === null || value === void 0 ? void 0 : value.length) === 1 && typeof value[0] === 'string') {\n            // Add given prefix in object notation\n            const val = value[0];\n            value = [isPropKey(val) ? `${prefix}.${val}` : `${prefix}['${val}']`];\n            if (config.options['jsx.enabled']) {\n                lQuote = expressionStart;\n                rQuote = expressionEnd;\n            }\n        }\n        if (isBooleanAttribute(attr, config) && !value) {\n            // If attribute value is omitted and it\u2019s a boolean value, check for\n            // `compactBoolean` option: if it\u2019s disabled, set value to attribute name\n            // (XML style)\n            if (!config.options['output.compactBoolean']) {\n                value = [name];\n            }\n        }\n        else if (!value) {\n            value = caret;\n        }\n        pushString(out, ' ' + name);\n        if (value) {\n            pushString(out, '=' + lQuote);\n            pushTokens(value, state);\n            pushString(out, rQuote);\n        }\n        else if (config.options['output.selfClosingStyle'] !== 'html') {\n            pushString(out, '=' + lQuote + rQuote);\n        }\n    }\n}\nfunction pushSnippet(node, state, next) {\n    if (node.value && node.children.length) {\n        // We have a value and child nodes. In case if value contains fields,\n        // we should output children as a content of first field\n        const fieldIx = node.value.findIndex(isField);\n        if (fieldIx !== -1) {\n            pushTokens(node.value.slice(0, fieldIx), state);\n            const line = state.out.line;\n            let pos = fieldIx + 1;\n            node.children.forEach(next);\n            // If there was a line change, trim leading whitespace for better result\n            if (state.out.line !== line && typeof node.value[pos] === 'string') {\n                pushString(state.out, node.value[pos++].trimLeft());\n            }\n            pushTokens(node.value.slice(pos), state);\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Check if given node should be formatted in its parent context\n */\nfunction shouldFormat$1(node, index, items, state) {\n    const { config, parent } = state;\n    if (!config.options['output.format']) {\n        return false;\n    }\n    if (index === 0 && !parent) {\n        // Do not format very first node\n        return false;\n    }\n    // Do not format single child of snippet\n    if (parent && isSnippet(parent) && items.length === 1) {\n        return false;\n    }\n    /**\n     * Adjacent text-only/snippet nodes\n     */\n    if (isSnippet(node)) {\n        // Adjacent text-only/snippet nodes\n        const format = isSnippet(items[index - 1]) || isSnippet(items[index + 1])\n            // Has newlines: looks like wrapping code fragment\n            || node.value.some(hasNewline)\n            // Format as wrapper: contains children which will be outputted as field content\n            || (node.value.some(isField) && node.children.length);\n        if (format) {\n            return true;\n        }\n    }\n    if (isInline(node, config)) {\n        // Check if inline node is the next sibling of block-level node\n        if (index === 0) {\n            // First node in parent: format if it\u2019s followed by a block-level element\n            for (let i = 0; i < items.length; i++) {\n                if (!isInline(items[i], config)) {\n                    return true;\n                }\n            }\n        }\n        else if (!isInline(items[index - 1], config)) {\n            // Node is right after block-level element\n            return true;\n        }\n        if (config.options['output.inlineBreak']) {\n            // check for adjacent inline elements before and after current element\n            let adjacentInline = 1;\n            let before = index;\n            let after = index;\n            while (isInlineElement(items[--before], config)) {\n                adjacentInline++;\n            }\n            while (isInlineElement(items[++after], config)) {\n                adjacentInline++;\n            }\n            if (adjacentInline >= config.options['output.inlineBreak']) {\n                return true;\n            }\n        }\n        // Edge case: inline node contains node that should receive formatting\n        for (let i = 0, il = node.children.length; i < il; i++) {\n            if (shouldFormat$1(node.children[i], i, node.children, state)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    return true;\n}\n/**\n * Returns indentation offset for given node\n */\nfunction getIndent(state) {\n    const { config, parent } = state;\n    if (!parent || isSnippet(parent) || (parent.name && config.options['output.formatSkip'].includes(parent.name))) {\n        return 0;\n    }\n    return 1;\n}\n/**\n * Check if given node value contains newlines\n */\nfunction hasNewline(value) {\n    return typeof value === 'string' && /\\r|\\n/.test(value);\n}\n/**\n * Check if given node value starts with block-level tag\n */\nfunction startsWithBlockTag(value, config) {\n    if (value.length && typeof value[0] === 'string') {\n        const matches = htmlTagRegex.exec(value[0]);\n        if ((matches === null || matches === void 0 ? void 0 : matches.length) && !config.options['inlineElements'].includes(matches[1].toLowerCase())) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction getMultiValue(key, data, multiple) {\n    return (multiple && data[`${key}*`]) || data[key];\n}\nfunction isPropKey(name) {\n    return !reservedKeywords.has(name) && /^[a-zA-Z_$][\\w_$]*$/.test(name);\n}\n\nfunction indentFormat(abbr, config, options) {\n    const state = createWalkState(config);\n    state.options = options || {};\n    walk(abbr, element, state);\n    return state.out.value;\n}\n/**\n * Outputs `node` content to output stream of `state`\n * @param node Context node\n * @param index Index of `node` in `items`\n * @param items List of `node`\u2019s siblings\n * @param state Current walk state\n */\nfunction element(node, index, items, state, next) {\n    const { out, options } = state;\n    const { primary, secondary } = collectAttributes(node);\n    // Pick offset level for current node\n    const level = state.parent ? 1 : 0;\n    out.level += level;\n    // Do not indent top-level elements\n    if (shouldFormat(node, index, items, state)) {\n        pushNewline(out, true);\n    }\n    if (node.name && (node.name !== 'div' || !primary.length)) {\n        pushString(out, (options.beforeName || '') + node.name + (options.afterName || ''));\n    }\n    pushPrimaryAttributes(primary, state);\n    pushSecondaryAttributes(secondary.filter(shouldOutputAttribute), state);\n    if (node.selfClosing && !node.value && !node.children.length) {\n        if (state.options.selfClose) {\n            pushString(out, state.options.selfClose);\n        }\n    }\n    else {\n        pushValue(node, state);\n        node.children.forEach(next);\n    }\n    out.level -= level;\n}\n/**\n * From given node, collects all attributes as `primary` (id, class) and\n * `secondary` (all the rest) lists. In most indent-based syntaxes, primary attribute\n * has special syntax\n */\nfunction collectAttributes(node) {\n    const primary = [];\n    const secondary = [];\n    if (node.attributes) {\n        for (const attr of node.attributes) {\n            if (isPrimaryAttribute(attr)) {\n                primary.push(attr);\n            }\n            else {\n                secondary.push(attr);\n            }\n        }\n    }\n    return { primary, secondary };\n}\n/**\n * Outputs given attributes as primary into output stream\n */\nfunction pushPrimaryAttributes(attrs, state) {\n    for (const attr of attrs) {\n        if (attr.value) {\n            if (attr.name === 'class') {\n                pushString(state.out, '.');\n                // All whitespace characters must be replaced with dots in class names\n                const tokens = attr.value.map(t => typeof t === 'string' ? t.replace(/\\s+/g, '.') : t);\n                pushTokens(tokens, state);\n            }\n            else {\n                // ID attribute\n                pushString(state.out, '#');\n                pushTokens(attr.value, state);\n            }\n        }\n    }\n}\n/**\n * Outputs given attributes as secondary into output stream\n */\nfunction pushSecondaryAttributes(attrs, state) {\n    if (attrs.length) {\n        const { out, config, options } = state;\n        options.beforeAttribute && pushString(out, options.beforeAttribute);\n        for (let i = 0; i < attrs.length; i++) {\n            const attr = attrs[i];\n            pushString(out, attrName(attr.name || '', config));\n            if (isBooleanAttribute(attr, config) && !attr.value) {\n                if (!config.options['output.compactBoolean'] && options.booleanValue) {\n                    pushString(out, '=' + options.booleanValue);\n                }\n            }\n            else {\n                pushString(out, '=' + attrQuote(attr, config, true));\n                pushTokens(attr.value || caret, state);\n                pushString(out, attrQuote(attr, config));\n            }\n            if (i !== attrs.length - 1 && options.glueAttribute) {\n                pushString(out, options.glueAttribute);\n            }\n        }\n        options.afterAttribute && pushString(out, options.afterAttribute);\n    }\n}\n/**\n * Outputs given node value into state output stream\n */\nfunction pushValue(node, state) {\n    // We should either output value or add caret but for leaf nodes only (no children)\n    if (!node.value && node.children.length) {\n        return;\n    }\n    const value = node.value || caret;\n    const lines = splitByLines(value);\n    const { out, options } = state;\n    if (lines.length === 1) {\n        if (node.name || node.attributes) {\n            push(out, ' ');\n        }\n        pushTokens(value, state);\n    }\n    else {\n        // We should format multi-line value with terminating `|` character\n        // and same line length\n        const lineLengths = [];\n        let maxLength = 0;\n        // Calculate lengths of all lines and max line length\n        for (const line of lines) {\n            const len = valueLength(line);\n            lineLengths.push(len);\n            if (len > maxLength) {\n                maxLength = len;\n            }\n        }\n        // Output each line, padded to max length\n        out.level++;\n        for (let i = 0; i < lines.length; i++) {\n            pushNewline(out, true);\n            options.beforeTextLine && push(out, options.beforeTextLine);\n            pushTokens(lines[i], state);\n            if (options.afterTextLine) {\n                push(out, ' '.repeat(maxLength - lineLengths[i]));\n                push(out, options.afterTextLine);\n            }\n        }\n        out.level--;\n    }\n}\nfunction isPrimaryAttribute(attr) {\n    return attr.name === 'class' || attr.name === 'id';\n}\n/**\n * Calculates string length from given tokens\n */\nfunction valueLength(tokens) {\n    let len = 0;\n    for (const token of tokens) {\n        len += typeof token === 'string' ? token.length : token.name.length;\n    }\n    return len;\n}\nfunction shouldFormat(node, index, items, state) {\n    // Do not format first top-level element or snippets\n    if (!state.parent && index === 0) {\n        return false;\n    }\n    return !isSnippet(node);\n}\n\nfunction haml(abbr, config) {\n    return indentFormat(abbr, config, {\n        beforeName: '%',\n        beforeAttribute: '(',\n        afterAttribute: ')',\n        glueAttribute: ' ',\n        afterTextLine: ' |',\n        booleanValue: 'true',\n        selfClose: '/'\n    });\n}\n\nfunction slim(abbr, config) {\n    return indentFormat(abbr, config, {\n        beforeAttribute: ' ',\n        glueAttribute: ' ',\n        beforeTextLine: '| ',\n        selfClose: '/'\n    });\n}\n\nfunction pug(abbr, config) {\n    return indentFormat(abbr, config, {\n        beforeAttribute: '(',\n        afterAttribute: ')',\n        glueAttribute: ', ',\n        beforeTextLine: '| ',\n        selfClose: config.options['output.selfClosingStyle'] === 'xml' ? '/' : ''\n    });\n}\n\nconst formatters = { html, haml, slim, pug };\n/**\n * Parses given Emmet abbreviation into a final abbreviation tree with all\n * required transformations applied\n */\nfunction parse$1(abbr, config) {\n    let oldTextValue;\n    if (typeof abbr === 'string') {\n        const parseOpt = Object.assign({}, config);\n        if (config.options['jsx.enabled']) {\n            parseOpt.jsx = true;\n        }\n        if (config.options['markup.href']) {\n            parseOpt.href = true;\n        }\n        abbr = parseAbbreviation(abbr, parseOpt);\n        // remove text field before snippets(abbr, config) call\n        // as abbreviation(abbr, parseOpt) already handled it\n        oldTextValue = config.text;\n        config.text = undefined;\n    }\n    // Run abbreviation resolve in two passes:\n    // 1. Map each node to snippets, which are abbreviations as well. A single snippet\n    // may produce multiple nodes\n    // 2. Transform every resolved node\n    abbr = resolveSnippets(abbr, config);\n    walk$1(abbr, transform, config);\n    config.text = oldTextValue !== null && oldTextValue !== void 0 ? oldTextValue : config.text;\n    return abbr;\n}\n/**\n * Converts given abbreviation to string according to provided `config`\n */\nfunction stringify(abbr, config) {\n    const formatter = formatters[config.syntax] || html;\n    return formatter(abbr, config);\n}\n/**\n * Modifies given node and prepares it for output\n */\nfunction transform(node, ancestors, config) {\n    implicitTag(node, ancestors, config);\n    mergeAttributes(node, config);\n    lorem(node, ancestors, config);\n    if (config.syntax === 'xsl') {\n        xsl(node);\n    }\n    if (config.options['bem.enabled']) {\n        bem(node, ancestors, config);\n    }\n}\n\nvar CSSSnippetType;\n(function (CSSSnippetType) {\n    CSSSnippetType[\"Raw\"] = \"Raw\";\n    CSSSnippetType[\"Property\"] = \"Property\";\n})(CSSSnippetType || (CSSSnippetType = {}));\nconst reProperty = /^([a-z-]+)(?:\\s*:\\s*([^\\n\\r;]+?);*)?$/;\nconst opt = { value: true };\n/**\n * Creates structure for holding resolved CSS snippet\n */\nfunction createSnippet(key, value) {\n    // A snippet could be a raw text snippet (e.g. arbitrary text string) or a\n    // CSS property with possible values separated by `|`.\n    // In latter case, we have to parse snippet as CSS abbreviation\n    const m = value.match(reProperty);\n    if (m) {\n        const keywords = {};\n        const parsed = m[2] ? m[2].split('|').map(parseValue) : [];\n        for (const item of parsed) {\n            for (const cssVal of item) {\n                collectKeywords(cssVal, keywords);\n            }\n        }\n        return {\n            type: CSSSnippetType.Property,\n            key,\n            property: m[1],\n            value: parsed,\n            keywords,\n            dependencies: []\n        };\n    }\n    return { type: CSSSnippetType.Raw, key, value };\n}\n/**\n * Nests more specific CSS properties into shorthand ones, e.g.\n * `background-position-x` -> `background-position` -> `background`\n */\nfunction nest(snippets) {\n    snippets = snippets.slice().sort(snippetsSort);\n    const stack = [];\n    let prev;\n    // For sorted list of CSS properties, create dependency graph where each\n    // shorthand property contains its more specific one, e.g.\n    // background -> background-position -> background-position-x\n    for (const cur of snippets.filter(isProperty)) {\n        // Check if current property belongs to one from parent stack.\n        // Since `snippets` array is sorted, items are perfectly aligned\n        // from shorthands to more specific variants\n        while (stack.length) {\n            prev = stack[stack.length - 1];\n            if (cur.property.startsWith(prev.property)\n                && cur.property.charCodeAt(prev.property.length) === 45 /* - */) {\n                prev.dependencies.push(cur);\n                stack.push(cur);\n                break;\n            }\n            stack.pop();\n        }\n        if (!stack.length) {\n            stack.push(cur);\n        }\n    }\n    return snippets;\n}\n/**\n * A sorting function for array of snippets\n */\nfunction snippetsSort(a, b) {\n    if (a.key === b.key) {\n        return 0;\n    }\n    return a.key < b.key ? -1 : 1;\n}\nfunction parseValue(value) {\n    return parse$2(value.trim(), opt)[0].value;\n}\nfunction isProperty(snippet) {\n    return snippet.type === CSSSnippetType.Property;\n}\nfunction collectKeywords(cssVal, dest) {\n    for (const v of cssVal.value) {\n        if (v.type === 'Literal') {\n            dest[v.value] = v;\n        }\n        else if (v.type === 'FunctionCall') {\n            dest[v.name] = v;\n        }\n        else if (v.type === 'Field') {\n            // Create literal from field, if available\n            const value = v.name.trim();\n            if (value) {\n                dest[value] = { type: 'Literal', value };\n            }\n        }\n    }\n}\n\n/**\n * Calculates how close `str1` matches `str2` using fuzzy match.\n * How matching works:\n * \u2013 first characters of both `str1` and `str2` *must* match\n * \u2013 `str1` length larger than `str2` length is allowed only when `unmatched` is true\n * \u2013 ideal match is when `str1` equals to `str2` (score: 1)\n * \u2013 next best match is `str2` starts with `str1` (score: 1 \u00D7 percent of matched characters)\n * \u2013 other scores depend on how close characters of `str1` to the beginning of `str2`\n * @param partialMatch Allow length `str1` to be greater than `str2` length\n */\nfunction scoreMatch(str1, str2, partialMatch = false) {\n    str1 = str1.toLowerCase();\n    str2 = str2.toLowerCase();\n    if (str1 === str2) {\n        return 1;\n    }\n    // Both strings MUST start with the same character\n    if (!str1 || !str2 || str1.charCodeAt(0) !== str2.charCodeAt(0)) {\n        return 0;\n    }\n    const str1Len = str1.length;\n    const str2Len = str2.length;\n    if (!partialMatch && str1Len > str2Len) {\n        return 0;\n    }\n    // Characters from `str1` which are closer to the beginning of a `str2` should\n    // have higher score.\n    // For example, if `str2` is `abcde`, it\u2019s max score is:\n    // 5 + 4 + 3 + 2 + 1 = 15 (sum of character positions in reverse order)\n    // Matching `abd` against `abcde` should produce:\n    // 5 + 4 + 2 = 11\n    // Acronym bonus for match right after `-`. Matching `abd` against `abc-de`\n    // should produce:\n    // 6 + 5 + 4 (use `d` position in `abd`, not in abc-de`)\n    const minLength = Math.min(str1Len, str2Len);\n    const maxLength = Math.max(str1Len, str2Len);\n    let i = 1;\n    let j = 1;\n    let score = maxLength;\n    let ch1 = 0;\n    let ch2 = 0;\n    let found = false;\n    let acronym = false;\n    while (i < str1Len) {\n        ch1 = str1.charCodeAt(i);\n        found = false;\n        acronym = false;\n        while (j < str2Len) {\n            ch2 = str2.charCodeAt(j);\n            if (ch1 === ch2) {\n                found = true;\n                score += maxLength - (acronym ? i : j);\n                break;\n            }\n            // add acronym bonus for exactly next match after unmatched `-`\n            acronym = ch2 === 45 /* - */;\n            j++;\n        }\n        if (!found) {\n            if (!partialMatch) {\n                return 0;\n            }\n            break;\n        }\n        i++;\n    }\n    const matchRatio = i / maxLength;\n    const delta = maxLength - minLength;\n    const maxScore = sum(maxLength) - sum(delta);\n    return (score * matchRatio) / maxScore;\n}\n/**\n * Calculates sum of first `n` numbers, e.g. 1+2+3+...n\n */\nfunction sum(n) {\n    return n * (n + 1) / 2;\n}\n\nfunction color(token, shortHex) {\n    if (!token.r && !token.g && !token.b && !token.a) {\n        return 'transparent';\n    }\n    else if (token.a === 1) {\n        return asHex(token, shortHex);\n    }\n    return asRGB(token);\n}\n/**\n * Output given color as hex value\n * @param short Produce short value (e.g. #fff instead of #ffffff), if possible\n */\nfunction asHex(token, short) {\n    const fn = (short && isShortHex(token.r) && isShortHex(token.g) && isShortHex(token.b))\n        ? toShortHex : toHex;\n    return '#' + fn(token.r) + fn(token.g) + fn(token.b);\n}\n/**\n * Output current color as `rgba?(...)` CSS color\n */\nfunction asRGB(token) {\n    const values = [token.r, token.g, token.b];\n    if (token.a !== 1) {\n        values.push(frac(token.a, 8));\n    }\n    return `${values.length === 3 ? 'rgb' : 'rgba'}(${values.join(', ')})`;\n}\nfunction frac(num, digits = 4) {\n    return num.toFixed(digits).replace(/\\.?0+$/, '');\n}\nfunction isShortHex(hex) {\n    return !(hex % 17);\n}\nfunction toShortHex(num) {\n    return (num >> 4).toString(16);\n}\nfunction toHex(num) {\n    return pad(num.toString(16), 2);\n}\nfunction pad(value, len) {\n    while (value.length < len) {\n        value = '0' + value;\n    }\n    return value;\n}\n\nconst CSSAbbreviationScope = {\n    /** Include all possible snippets in match */\n    Global: '@@global',\n    /** Include raw snippets only (e.g. no properties) in abbreviation match */\n    Section: '@@section',\n    /** Include properties only in abbreviation match */\n    Property: '@@property',\n    /** Resolve abbreviation in context of CSS property value */\n    Value: '@@value',\n};\nfunction css(abbr, config) {\n    var _a;\n    const out = createOutputStream(config.options);\n    const format = config.options['output.format'];\n    if (((_a = config.context) === null || _a === void 0 ? void 0 : _a.name) === CSSAbbreviationScope.Section) {\n        // For section context, filter out unmatched snippets\n        abbr = abbr.filter(node => node.snippet);\n    }\n    for (let i = 0; i < abbr.length; i++) {\n        if (format && i !== 0) {\n            pushNewline(out, true);\n        }\n        property(abbr[i], out, config);\n    }\n    return out.value;\n}\n/**\n * Outputs given abbreviation node into output stream\n */\nfunction property(node, out, config) {\n    const isJSON = config.options['stylesheet.json'];\n    if (node.name) {\n        // It\u2019s a CSS property\n        const name = isJSON ? toCamelCase(node.name) : node.name;\n        pushString(out, name + config.options['stylesheet.between']);\n        if (node.value.length) {\n            propertyValue(node, out, config);\n        }\n        else {\n            pushField(out, 0, '');\n        }\n        if (isJSON) {\n            // For CSS-in-JS, always finalize property with comma\n            // NB: seems like `important` is not available in CSS-in-JS syntaxes\n            push(out, ',');\n        }\n        else {\n            outputImportant(node, out, true);\n            push(out, config.options['stylesheet.after']);\n        }\n    }\n    else {\n        // It\u2019s a regular snippet, output plain tokens without any additional formatting\n        for (const cssVal of node.value) {\n            for (const v of cssVal.value) {\n                outputToken(v, out, config);\n            }\n        }\n        outputImportant(node, out, node.value.length > 0);\n    }\n}\nfunction propertyValue(node, out, config) {\n    const isJSON = config.options['stylesheet.json'];\n    const num = isJSON ? getSingleNumeric(node) : null;\n    if (num && (!num.unit || num.unit === 'px')) {\n        // For CSS-in-JS, if property contains single numeric value, output it\n        // as JS number\n        push(out, String(num.value));\n    }\n    else {\n        const quote = getQuote(config);\n        isJSON && push(out, quote);\n        for (let i = 0; i < node.value.length; i++) {\n            if (i !== 0) {\n                push(out, ', ');\n            }\n            outputValue(node.value[i], out, config);\n        }\n        isJSON && push(out, quote);\n    }\n}\nfunction outputImportant(node, out, separator) {\n    if (node.important) {\n        if (separator) {\n            push(out, ' ');\n        }\n        push(out, '!important');\n    }\n}\nfunction outputValue(value, out, config) {\n    for (let i = 0, prevEnd = -1; i < value.value.length; i++) {\n        const token = value.value[i];\n        // Handle edge case: a field is written close to previous token like this: `foo${bar}`.\n        // We should not add delimiter here\n        if (i !== 0 && (token.type !== 'Field' || token.start !== prevEnd)) {\n            push(out, ' ');\n        }\n        outputToken(token, out, config);\n        prevEnd = token['end'];\n    }\n}\nfunction outputToken(token, out, config) {\n    if (token.type === 'ColorValue') {\n        push(out, color(token, config.options['stylesheet.shortHex']));\n    }\n    else if (token.type === 'Literal' || token.type === 'CustomProperty') {\n        pushString(out, token.value);\n    }\n    else if (token.type === 'NumberValue') {\n        pushString(out, frac(token.value, 4) + token.unit);\n    }\n    else if (token.type === 'StringValue') {\n        const quote = token.quote === 'double' ? '\"' : '\\'';\n        pushString(out, quote + token.value + quote);\n    }\n    else if (token.type === 'Field') {\n        pushField(out, token.index, token.name);\n    }\n    else if (token.type === 'FunctionCall') {\n        push(out, token.name + '(');\n        for (let i = 0; i < token.arguments.length; i++) {\n            if (i) {\n                push(out, ', ');\n            }\n            outputValue(token.arguments[i], out, config);\n        }\n        push(out, ')');\n    }\n}\n/**\n * If value of given property is a single numeric value, returns this token\n */\nfunction getSingleNumeric(node) {\n    if (node.value.length === 1) {\n        const cssVal = node.value[0];\n        if (cssVal.value.length === 1 && cssVal.value[0].type === 'NumberValue') {\n            return cssVal.value[0];\n        }\n    }\n}\n/**\n * Converts kebab-case string to camelCase\n */\nfunction toCamelCase(str) {\n    return str.replace(/\\-(\\w)/g, (_, letter) => letter.toUpperCase());\n}\nfunction getQuote(config) {\n    return config.options['stylesheet.jsonDoubleQuotes'] ? '\"' : '\\'';\n}\n\nconst gradientName = 'lg';\n/**\n * Parses given Emmet abbreviation into a final abbreviation tree with all\n * required transformations applied\n */\nfunction parse(abbr, config) {\n    var _a;\n    const snippets = ((_a = config.cache) === null || _a === void 0 ? void 0 : _a.stylesheetSnippets) || convertSnippets(config.snippets);\n    if (config.cache) {\n        config.cache.stylesheetSnippets = snippets;\n    }\n    if (typeof abbr === 'string') {\n        abbr = parse$2(abbr, { value: isValueScope(config) });\n    }\n    const filteredSnippets = getSnippetsForScope(snippets, config);\n    for (const node of abbr) {\n        resolveNode(node, filteredSnippets, config);\n    }\n    return abbr;\n}\n/**\n * Converts given raw snippets into internal snippets representation\n */\nfunction convertSnippets(snippets) {\n    const result = [];\n    for (const key of Object.keys(snippets)) {\n        result.push(createSnippet(key, snippets[key]));\n    }\n    return nest(result);\n}\n/**\n * Resolves given node: finds matched CSS snippets using fuzzy match and resolves\n * keyword aliases from node value\n */\nfunction resolveNode(node, snippets, config) {\n    if (!resolveGradient(node, config)) {\n        const score = config.options['stylesheet.fuzzySearchMinScore'];\n        if (isValueScope(config)) {\n            // Resolve as value of given CSS property\n            const propName = config.context.name;\n            const snippet = snippets.find(s => s.type === CSSSnippetType.Property && s.property === propName);\n            resolveValueKeywords(node, config, snippet, score);\n            node.snippet = snippet;\n        }\n        else if (node.name) {\n            const snippet = findBestMatch(node.name, snippets, score, true);\n            node.snippet = snippet;\n            if (snippet) {\n                if (snippet.type === CSSSnippetType.Property) {\n                    resolveAsProperty(node, snippet, config);\n                }\n                else {\n                    resolveAsSnippet(node, snippet);\n                }\n            }\n        }\n    }\n    if (node.name || config.context) {\n        // Resolve numeric values for CSS properties only\n        resolveNumericValue(node, config);\n    }\n    return node;\n}\n/**\n * Resolves CSS gradient shortcut from given property, if possible\n */\nfunction resolveGradient(node, config) {\n    let gradientFn = null;\n    const cssVal = node.value.length === 1 ? node.value[0] : null;\n    if (cssVal && cssVal.value.length === 1) {\n        const v = cssVal.value[0];\n        if (v.type === 'FunctionCall' && v.name === gradientName) {\n            gradientFn = v;\n        }\n    }\n    if (gradientFn || node.name === gradientName) {\n        if (!gradientFn) {\n            gradientFn = {\n                type: 'FunctionCall',\n                name: 'linear-gradient',\n                arguments: [cssValue(field(0, ''))]\n            };\n        }\n        else {\n            gradientFn = Object.assign(Object.assign({}, gradientFn), { name: 'linear-gradient' });\n        }\n        if (!config.context) {\n            node.name = 'background-image';\n        }\n        node.value = [cssValue(gradientFn)];\n        return true;\n    }\n    return false;\n}\n/**\n * Resolves given parsed abbreviation node as CSS property\n */\nfunction resolveAsProperty(node, snippet, config) {\n    const abbr = node.name;\n    // Check for unmatched part of abbreviation\n    // For example, in `dib` abbreviation the matched part is `d` and `ib` should\n    // be considered as inline value. If unmatched fragment exists, we should check\n    // if it matches actual value of snippet. If either explicit value is specified\n    // or unmatched fragment did not resolve to to a keyword, we should consider\n    // matched snippet as invalid\n    const inlineValue = getUnmatchedPart(abbr, snippet.key);\n    if (inlineValue) {\n        if (node.value.length) {\n            // Already have value: unmatched part indicates matched snippet is invalid\n            return node;\n        }\n        const kw = resolveKeyword(inlineValue, config, snippet);\n        if (!kw) {\n            return node;\n        }\n        node.value.push(cssValue(kw));\n    }\n    node.name = snippet.property;\n    if (node.value.length) {\n        // Replace keyword alias from current abbreviation node with matched keyword\n        resolveValueKeywords(node, config, snippet);\n    }\n    else if (snippet.value.length) {\n        const defaultValue = snippet.value[0];\n        // https://github.com/emmetio/emmet/issues/558\n        // We should auto-select inserted value only if there\u2019s multiple value\n        // choice\n        node.value = snippet.value.length === 1 || defaultValue.some(hasField)\n            ? defaultValue\n            : defaultValue.map(n => wrapWithField(n, config));\n    }\n    return node;\n}\nfunction resolveValueKeywords(node, config, snippet, minScore) {\n    for (const cssVal of node.value) {\n        const value = [];\n        for (const token of cssVal.value) {\n            if (token.type === 'Literal') {\n                value.push(resolveKeyword(token.value, config, snippet, minScore) || token);\n            }\n            else if (token.type === 'FunctionCall') {\n                // For function calls, we should find matching function call\n                // and merge arguments\n                const match = resolveKeyword(token.name, config, snippet, minScore);\n                if (match && match.type === 'FunctionCall') {\n                    value.push(Object.assign(Object.assign({}, match), { arguments: token.arguments.concat(match.arguments.slice(token.arguments.length)) }));\n                }\n                else {\n                    value.push(token);\n                }\n            }\n            else {\n                value.push(token);\n            }\n        }\n        cssVal.value = value;\n    }\n}\n/**\n * Resolves given parsed abbreviation node as a snippet: a plain code chunk\n */\nfunction resolveAsSnippet(node, snippet) {\n    // When resolving snippets, we have to do the following:\n    // 1. Replace field placeholders with actual field tokens.\n    // 2. If input values given, put them instead of fields\n    let offset = 0;\n    let m;\n    const reField = /\\$\\{(\\d+)(:[^}]+)?\\}/g;\n    const inputValue = node.value[0];\n    const outputValue = [];\n    while (m = reField.exec(snippet.value)) {\n        if (offset !== m.index) {\n            outputValue.push(literal(snippet.value.slice(offset, m.index)));\n        }\n        offset = m.index + m[0].length;\n        if (inputValue && inputValue.value.length) {\n            outputValue.push(inputValue.value.shift());\n        }\n        else {\n            outputValue.push(field(Number(m[1]), m[2] ? m[2].slice(1) : ''));\n        }\n    }\n    const tail = snippet.value.slice(offset);\n    if (tail) {\n        outputValue.push(literal(tail));\n    }\n    node.name = void 0;\n    node.value = [cssValue(...outputValue)];\n    return node;\n}\n/**\n * Finds best matching item from `items` array\n * @param abbr  Abbreviation to match\n * @param items List of items for match\n * @param minScore The minimum score the best matched item should have to be a valid match.\n */\nfunction findBestMatch(abbr, items, minScore = 0, partialMatch = false) {\n    let matchedItem = null;\n    let maxScore = 0;\n    for (const item of items) {\n        const score = scoreMatch(abbr, getScoringPart(item), partialMatch);\n        if (score === 1) {\n            // direct hit, no need to look further\n            return item;\n        }\n        if (score && score >= maxScore) {\n            maxScore = score;\n            matchedItem = item;\n        }\n    }\n    return maxScore >= minScore ? matchedItem : null;\n}\nfunction getScoringPart(item) {\n    return typeof item === 'string' ? item : item.key;\n}\n/**\n * Returns a part of `abbr` that wasn\u2019t directly matched against `str`.\n * For example, if abbreviation `poas` is matched against `position`,\n * the unmatched part will be `as` since `a` wasn\u2019t found in string stream\n */\nfunction getUnmatchedPart(abbr, str) {\n    for (let i = 0, lastPos = 0; i < abbr.length; i++) {\n        lastPos = str.indexOf(abbr[i], lastPos);\n        if (lastPos === -1) {\n            return abbr.slice(i);\n        }\n        lastPos++;\n    }\n    return '';\n}\n/**\n * Resolves given keyword shorthand into matched snippet keyword or global keyword,\n * if possible\n */\nfunction resolveKeyword(kw, config, snippet, minScore) {\n    let ref;\n    if (snippet) {\n        if (ref = findBestMatch(kw, Object.keys(snippet.keywords), minScore)) {\n            return snippet.keywords[ref];\n        }\n        for (const dep of snippet.dependencies) {\n            if (ref = findBestMatch(kw, Object.keys(dep.keywords), minScore)) {\n                return dep.keywords[ref];\n            }\n        }\n    }\n    if (ref = findBestMatch(kw, config.options['stylesheet.keywords'], minScore)) {\n        return literal(ref);\n    }\n    return null;\n}\n/**\n * Resolves numeric values in given abbreviation node\n */\nfunction resolveNumericValue(node, config) {\n    const aliases = config.options['stylesheet.unitAliases'];\n    const unitless = config.options['stylesheet.unitless'];\n    for (const v of node.value) {\n        for (const t of v.value) {\n            if (t.type === 'NumberValue') {\n                if (t.unit) {\n                    t.unit = aliases[t.unit] || t.unit;\n                }\n                else if (t.value !== 0 && !unitless.includes(node.name)) {\n                    t.unit = t.rawValue.includes('.')\n                        ? config.options['stylesheet.floatUnit']\n                        : config.options['stylesheet.intUnit'];\n                }\n            }\n        }\n    }\n}\n/**\n * Constructs CSS value token\n */\nfunction cssValue(...args) {\n    return {\n        type: 'CSSValue',\n        value: args\n    };\n}\n/**\n * Constructs literal token\n */\nfunction literal(value) {\n    return { type: 'Literal', value };\n}\n/**\n * Constructs field token\n */\nfunction field(index, name) {\n    return { type: 'Field', index, name };\n}\n/**\n * Check if given value contains fields\n */\nfunction hasField(value) {\n    for (const v of value.value) {\n        if (v.type === 'Field' || (v.type === 'FunctionCall' && v.arguments.some(hasField))) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Wraps tokens of given abbreviation with fields\n */\nfunction wrapWithField(node, config, state = { index: 1 }) {\n    let value = [];\n    for (const v of node.value) {\n        switch (v.type) {\n            case 'ColorValue':\n                value.push(field(state.index++, color(v, config.options['stylesheet.shortHex'])));\n                break;\n            case 'Literal':\n                value.push(field(state.index++, v.value));\n                break;\n            case 'NumberValue':\n                value.push(field(state.index++, `${v.value}${v.unit}`));\n                break;\n            case 'StringValue':\n                const q = v.quote === 'single' ? '\\'' : '\"';\n                value.push(field(state.index++, q + v.value + q));\n                break;\n            case 'FunctionCall':\n                value.push(field(state.index++, v.name), literal('('));\n                for (let i = 0, il = v.arguments.length; i < il; i++) {\n                    value = value.concat(wrapWithField(v.arguments[i], config, state).value);\n                    if (i !== il - 1) {\n                        value.push(literal(', '));\n                    }\n                }\n                value.push(literal(')'));\n                break;\n            default:\n                value.push(v);\n        }\n    }\n    return Object.assign(Object.assign({}, node), { value });\n}\n/**\n * Check if abbreviation should be expanded in CSS value context\n */\nfunction isValueScope(config) {\n    if (config.context) {\n        return config.context.name === CSSAbbreviationScope.Value || !config.context.name.startsWith('@@');\n    }\n    return false;\n}\n/**\n * Returns snippets for given scope\n */\nfunction getSnippetsForScope(snippets, config) {\n    if (config.context) {\n        if (config.context.name === CSSAbbreviationScope.Section) {\n            return snippets.filter(s => s.type === CSSSnippetType.Raw);\n        }\n        if (config.context.name === CSSAbbreviationScope.Property) {\n            return snippets.filter(s => s.type === CSSSnippetType.Property);\n        }\n    }\n    return snippets;\n}\n\nvar markupSnippets = {\n\t\"a\": \"a[href]\",\n\t\"a:blank\": \"a[href='http://${0}' target='_blank' rel='noopener noreferrer']\",\n\t\"a:link\": \"a[href='http://${0}']\",\n\t\"a:mail\": \"a[href='mailto:${0}']\",\n\t\"a:tel\": \"a[href='tel:+${0}']\",\n\t\"abbr\": \"abbr[title]\",\n\t\"acr|acronym\": \"acronym[title]\",\n\t\"base\": \"base[href]/\",\n\t\"basefont\": \"basefont/\",\n\t\"br\": \"br/\",\n\t\"frame\": \"frame/\",\n\t\"hr\": \"hr/\",\n\t\"bdo\": \"bdo[dir]\",\n\t\"bdo:r\": \"bdo[dir=rtl]\",\n\t\"bdo:l\": \"bdo[dir=ltr]\",\n\t\"col\": \"col/\",\n\t\"link\": \"link[rel=stylesheet href]/\",\n\t\"link:css\": \"link[href='${1:style}.css']\",\n\t\"link:print\": \"link[href='${1:print}.css' media=print]\",\n\t\"link:favicon\": \"link[rel='shortcut icon' type=image/x-icon href='${1:favicon.ico}']\",\n\t\"link:mf|link:manifest\": \"link[rel='manifest' href='${1:manifest.json}']\",\n\t\"link:touch\": \"link[rel=apple-touch-icon href='${1:favicon.png}']\",\n\t\"link:rss\": \"link[rel=alternate type=application/rss+xml title=RSS href='${1:rss.xml}']\",\n\t\"link:atom\": \"link[rel=alternate type=application/atom+xml title=Atom href='${1:atom.xml}']\",\n\t\"link:im|link:import\": \"link[rel=import href='${1:component}.html']\",\n\t\"meta\": \"meta/\",\n\t\"meta:utf\": \"meta[http-equiv=Content-Type content='text/html;charset=UTF-8']\",\n\t\"meta:vp\": \"meta[name=viewport content='width=${1:device-width}, initial-scale=${2:1.0}']\",\n\t\"meta:compat\": \"meta[http-equiv=X-UA-Compatible content='${1:IE=7}']\",\n\t\"meta:edge\": \"meta:compat[content='${1:ie=edge}']\",\n\t\"meta:redirect\": \"meta[http-equiv=refresh content='0; url=${1:http://example.com}']\",\n\t\"meta:refresh\": \"meta[http-equiv=refresh content='${1:5}']\",\n\t\"meta:kw\": \"meta[name=keywords content]\",\n\t\"meta:desc\": \"meta[name=description content]\",\n\t\"style\": \"style\",\n\t\"script\": \"script\",\n\t\"script:src\": \"script[src]\",\n\t\"script:module\": \"script[type=module src]\",\n\t\"img\": \"img[src alt]/\",\n\t\"img:s|img:srcset\": \"img[srcset src alt]\",\n\t\"img:z|img:sizes\": \"img[sizes srcset src alt]\",\n\t\"picture\": \"picture\",\n\t\"src|source\": \"source/\",\n\t\"src:sc|source:src\": \"source[src type]\",\n\t\"src:s|source:srcset\": \"source[srcset]\",\n\t\"src:t|source:type\": \"source[srcset type='${1:image/}']\",\n\t\"src:z|source:sizes\": \"source[sizes srcset]\",\n\t\"src:m|source:media\": \"source[media='(${1:min-width: })' srcset]\",\n\t\"src:mt|source:media:type\": \"source:media[type='${2:image/}']\",\n\t\"src:mz|source:media:sizes\": \"source:media[sizes srcset]\",\n\t\"src:zt|source:sizes:type\": \"source[sizes srcset type='${1:image/}']\",\n\t\"iframe\": \"iframe[src frameborder=0]\",\n\t\"embed\": \"embed[src type]/\",\n\t\"object\": \"object[data type]\",\n\t\"param\": \"param[name value]/\",\n\t\"map\": \"map[name]\",\n\t\"area\": \"area[shape coords href alt]/\",\n\t\"area:d\": \"area[shape=default]\",\n\t\"area:c\": \"area[shape=circle]\",\n\t\"area:r\": \"area[shape=rect]\",\n\t\"area:p\": \"area[shape=poly]\",\n\t\"form\": \"form[action]\",\n\t\"form:get\": \"form[method=get]\",\n\t\"form:post\": \"form[method=post]\",\n\t\"label\": \"label[for]\",\n\t\"input\": \"input[type=${1:text}]/\",\n\t\"inp\": \"input[name=${1} id=${1}]\",\n\t\"input:h|input:hidden\": \"input[type=hidden name]\",\n\t\"input:t|input:text\": \"inp[type=text]\",\n\t\"input:search\": \"inp[type=search]\",\n\t\"input:email\": \"inp[type=email]\",\n\t\"input:url\": \"inp[type=url]\",\n\t\"input:p|input:password\": \"inp[type=password]\",\n\t\"input:datetime\": \"inp[type=datetime]\",\n\t\"input:date\": \"inp[type=date]\",\n\t\"input:datetime-local\": \"inp[type=datetime-local]\",\n\t\"input:month\": \"inp[type=month]\",\n\t\"input:week\": \"inp[type=week]\",\n\t\"input:time\": \"inp[type=time]\",\n\t\"input:tel\": \"inp[type=tel]\",\n\t\"input:number\": \"inp[type=number]\",\n\t\"input:color\": \"inp[type=color]\",\n\t\"input:c|input:checkbox\": \"inp[type=checkbox]\",\n\t\"input:r|input:radio\": \"inp[type=radio]\",\n\t\"input:range\": \"inp[type=range]\",\n\t\"input:f|input:file\": \"inp[type=file]\",\n\t\"input:s|input:submit\": \"input[type=submit value]\",\n\t\"input:i|input:image\": \"input[type=image src alt]\",\n\t\"input:b|input:btn|input:button\": \"input[type=button value]\",\n\t\"input:reset\": \"input:button[type=reset]\",\n\t\"isindex\": \"isindex/\",\n\t\"select\": \"select[name=${1} id=${1}]\",\n\t\"select:d|select:disabled\": \"select[disabled.]\",\n\t\"opt|option\": \"option[value]\",\n\t\"textarea\": \"textarea[name=${1} id=${1} cols=${2:30} rows=${3:10}]\",\n\t\"marquee\": \"marquee[behavior direction]\",\n\t\"menu:c|menu:context\": \"menu[type=context]\",\n\t\"menu:t|menu:toolbar\": \"menu[type=toolbar]\",\n\t\"video\": \"video[src]\",\n\t\"audio\": \"audio[src]\",\n\t\"html:xml\": \"html[xmlns=http://www.w3.org/1999/xhtml]\",\n\t\"keygen\": \"keygen/\",\n\t\"command\": \"command/\",\n\t\"btn:s|button:s|button:submit\" : \"button[type=submit]\",\n\t\"btn:r|button:r|button:reset\" : \"button[type=reset]\",\n\t\"btn:b|button:b|button:button\" : \"button[type=button]\",\n\t\"btn:d|button:d|button:disabled\" : \"button[disabled.]\",\n\t\"fst:d|fset:d|fieldset:d|fieldset:disabled\" : \"fieldset[disabled.]\",\n\n\t\"bq\": \"blockquote\",\n\t\"fig\": \"figure\",\n\t\"figc\": \"figcaption\",\n\t\"pic\": \"picture\",\n\t\"ifr\": \"iframe\",\n\t\"emb\": \"embed\",\n\t\"obj\": \"object\",\n\t\"cap\": \"caption\",\n\t\"colg\": \"colgroup\",\n\t\"fst\": \"fieldset\",\n\t\"btn\": \"button\",\n\t\"optg\": \"optgroup\",\n\t\"tarea\": \"textarea\",\n\t\"leg\": \"legend\",\n\t\"sect\": \"section\",\n\t\"art\": \"article\",\n\t\"hdr\": \"header\",\n\t\"ftr\": \"footer\",\n\t\"adr\": \"address\",\n\t\"dlg\": \"dialog\",\n\t\"str\": \"strong\",\n\t\"prog\": \"progress\",\n\t\"mn\": \"main\",\n\t\"tem\": \"template\",\n\t\"fset\": \"fieldset\",\n\t\"datal\": \"datalist\",\n\t\"kg\": \"keygen\",\n\t\"out\": \"output\",\n\t\"det\": \"details\",\n\t\"sum\": \"summary\",\n\t\"cmd\": \"command\",\n\t\"data\": \"data[value]\",\n\t\"meter\": \"meter[value]\",\n\t\"time\": \"time[datetime]\",\n\n\t\"ri:d|ri:dpr\": \"img:s\",\n\t\"ri:v|ri:viewport\": \"img:z\",\n\t\"ri:a|ri:art\": \"pic>src:m+img\",\n\t\"ri:t|ri:type\": \"pic>src:t+img\",\n\n\t\"!!!\": \"{<!DOCTYPE html>}\",\n\t\"doc\": \"html[lang=${lang}]>(head>meta[charset=${charset}]+meta:vp+title{${1:Document}})+body\",\n\t\"!|html:5\": \"!!!+doc\",\n\n\t\"c\": \"{<!-- ${0} -->}\",\n\t\"cc:ie\": \"{<!--[if IE]>${0}<![endif]-->}\",\n\t\"cc:noie\": \"{<!--[if !IE]><!-->${0}<!--<![endif]-->}\"\n};\n\nvar stylesheetSnippets = {\n\t\"@f\": \"@font-face {\\n\\tfont-family: ${1};\\n\\tsrc: url(${2});\\n}\",\n\t\"@ff\": \"@font-face {\\n\\tfont-family: '${1:FontName}';\\n\\tsrc: url('${2:FileName}.eot');\\n\\tsrc: url('${2:FileName}.eot?#iefix') format('embedded-opentype'),\\n\\t\\t url('${2:FileName}.woff') format('woff'),\\n\\t\\t url('${2:FileName}.ttf') format('truetype'),\\n\\t\\t url('${2:FileName}.svg#${1:FontName}') format('svg');\\n\\tfont-style: ${3:normal};\\n\\tfont-weight: ${4:normal};\\n}\",\n\t\"@i|@import\": \"@import url(${0});\",\n\t\"@kf\": \"@keyframes ${1:identifier} {\\n\\t${2}\\n}\",\n\t\"@m|@media\": \"@media ${1:screen} {\\n\\t${0}\\n}\",\n\t\"ac\": \"align-content:start|end|flex-start|flex-end|center|space-between|space-around|stretch|space-evenly\",\n\t\"ai\": \"align-items:start|end|flex-start|flex-end|center|baseline|stretch\",\n\t\"anim\": \"animation:${1:name} ${2:duration} ${3:timing-function} ${4:delay} ${5:iteration-count} ${6:direction} ${7:fill-mode}\",\n\t\"animdel\": \"animation-delay:time\",\n\t\"animdir\": \"animation-direction:normal|reverse|alternate|alternate-reverse\",\n\t\"animdur\": \"animation-duration:${1:0}s\",\n\t\"animfm\": \"animation-fill-mode:both|forwards|backwards\",\n\t\"animic\": \"animation-iteration-count:1|infinite\",\n\t\"animn\": \"animation-name\",\n\t\"animps\": \"animation-play-state:running|paused\",\n\t\"animtf\": \"animation-timing-function:linear|ease|ease-in|ease-out|ease-in-out|cubic-bezier(${1:0.1}, ${2:0.7}, ${3:1.0}, ${3:0.1})\",\n\t\"ap\": \"appearance:none\",\n\t\"as\": \"align-self:start|end|auto|flex-start|flex-end|center|baseline|stretch\",\n\t\"b\": \"bottom\",\n\t\"bd\": \"border:${1:1px} ${2:solid} ${3:#000}\",\n\t\"bdb\": \"border-bottom:${1:1px} ${2:solid} ${3:#000}\",\n\t\"bdbc\": \"border-bottom-color:${1:#000}\",\n\t\"bdbi\": \"border-bottom-image:url(${0})\",\n\t\"bdbk\": \"border-break:close\",\n\t\"bdbli\": \"border-bottom-left-image:url(${0})|continue\",\n\t\"bdblrs\": \"border-bottom-left-radius\",\n\t\"bdbri\": \"border-bottom-right-image:url(${0})|continue\",\n\t\"bdbrrs\": \"border-bottom-right-radius\",\n\t\"bdbs\": \"border-bottom-style\",\n\t\"bdbw\": \"border-bottom-width\",\n\t\"bdc\": \"border-color:${1:#000}\",\n\t\"bdci\": \"border-corner-image:url(${0})|continue\",\n\t\"bdcl\": \"border-collapse:collapse|separate\",\n\t\"bdf\": \"border-fit:repeat|clip|scale|stretch|overwrite|overflow|space\",\n\t\"bdi\": \"border-image:url(${0})\",\n\t\"bdl\": \"border-left:${1:1px} ${2:solid} ${3:#000}\",\n\t\"bdlc\": \"border-left-color:${1:#000}\",\n\t\"bdlen\": \"border-length\",\n\t\"bdli\": \"border-left-image:url(${0})\",\n\t\"bdls\": \"border-left-style\",\n\t\"bdlw\": \"border-left-width\",\n\t\"bdr\": \"border-right:${1:1px} ${2:solid} ${3:#000}\",\n\t\"bdrc\": \"border-right-color:${1:#000}\",\n\t\"bdri\": \"border-right-image:url(${0})\",\n\t\"bdrs\": \"border-radius\",\n\t\"bdrst\": \"border-right-style\",\n\t\"bdrw\": \"border-right-width\",\n\t\"bds\": \"border-style:none|hidden|dotted|dashed|solid|double|dot-dash|dot-dot-dash|wave|groove|ridge|inset|outset\",\n\t\"bdsp\": \"border-spacing\",\n\t\"bdt\": \"border-top:${1:1px} ${2:solid} ${3:#000}\",\n\t\"bdtc\": \"border-top-color:${1:#000}\",\n\t\"bdti\": \"border-top-image:url(${0})\",\n\t\"bdtli\": \"border-top-left-image:url(${0})|continue\",\n\t\"bdtlrs\": \"border-top-left-radius\",\n\t\"bdtri\": \"border-top-right-image:url(${0})|continue\",\n\t\"bdtrrs\": \"border-top-right-radius\",\n\t\"bdts\": \"border-top-style\",\n\t\"bdtw\": \"border-top-width\",\n\t\"bdw\": \"border-width\",\n  \"bbs\": \"border-block-start\",\n  \"bbe\": \"border-block-end\",\n  \"bis\": \"border-inline-start\",\n  \"bie\": \"border-inline-end\",\n\t\"bfv\": \"backface-visibility:hidden|visible\",\n\t\"bg\": \"background:${1:#000}\",\n\t\"bg:n\": \"background: none\",\n\t\"bga\": \"background-attachment:fixed|scroll\",\n\t\"bgbk\": \"background-break:bounding-box|each-box|continuous\",\n\t\"bgc\": \"background-color:${1:#fff}\",\n\t\"bgcp\": \"background-clip:padding-box|border-box|content-box|no-clip\",\n\t\"bgi\": \"background-image:url(${0})\",\n\t\"bgo\": \"background-origin:padding-box|border-box|content-box\",\n\t\"bgp\": \"background-position:${1:0} ${2:0}\",\n\t\"bgpx\": \"background-position-x\",\n\t\"bgpy\": \"background-position-y\",\n\t\"bgr\": \"background-repeat:no-repeat|repeat-x|repeat-y|space|round\",\n\t\"bgsz\": \"background-size:contain|cover\",\n  \"bs\": \"block-size\",\n\t\"bxsh\": \"box-shadow:${1:inset }${2:hoff} ${3:voff} ${4:blur} ${5:#000}|none\",\n\t\"bxsz\": \"box-sizing:border-box|content-box|border-box\",\n\t\"c\": \"color:${1:#000}\",\n\t\"cr\": \"color:rgb(${1:0}, ${2:0}, ${3:0})\",\n\t\"cra\": \"color:rgba(${1:0}, ${2:0}, ${3:0}, ${4:.5})\",\n\t\"cl\": \"clear:both|left|right|none\",\n\t\"cm\": \"/* ${0} */\",\n\t\"cnt\": \"content:'${0}'|normal|open-quote|no-open-quote|close-quote|no-close-quote|attr(${0})|counter(${0})|counters(${0})\",\n\t\"coi\": \"counter-increment\",\n\t\"colm\": \"columns\",\n\t\"colmc\": \"column-count\",\n\t\"colmf\": \"column-fill\",\n\t\"colmg\": \"column-gap\",\n\t\"colmr\": \"column-rule\",\n\t\"colmrc\": \"column-rule-color\",\n\t\"colmrs\": \"column-rule-style\",\n\t\"colmrw\": \"column-rule-width\",\n\t\"colms\": \"column-span\",\n\t\"colmw\": \"column-width\",\n\t\"cor\": \"counter-reset\",\n\t\"cp\": \"clip:auto|rect(${1:top} ${2:right} ${3:bottom} ${4:left})\",\n\t\"cps\": \"caption-side:top|bottom\",\n\t\"cur\": \"cursor:pointer|auto|default|crosshair|hand|help|move|pointer|text\",\n\t\"d\": \"display:block|none|flex|inline-flex|inline|inline-block|grid|inline-grid|subgrid|list-item|run-in|contents|table|inline-table|table-caption|table-column|table-column-group|table-header-group|table-footer-group|table-row|table-row-group|table-cell|ruby|ruby-base|ruby-base-group|ruby-text|ruby-text-group\",\n\t\"ec\": \"empty-cells:show|hide\",\n\t\"f\": \"font:${1:1em} ${2:sans-serif}\",\n\t\"fd\": \"font-display:auto|block|swap|fallback|optional\",\n\t\"fef\": \"font-effect:none|engrave|emboss|outline\",\n\t\"fem\": \"font-emphasize\",\n\t\"femp\": \"font-emphasize-position:before|after\",\n\t\"fems\": \"font-emphasize-style:none|accent|dot|circle|disc\",\n\t\"ff\": \"font-family:serif|sans-serif|cursive|fantasy|monospace\",\n\t\"fft\": \"font-family:\\\"Times New Roman\\\", Times, Baskerville, Georgia, serif\",\n\t\"ffa\": \"font-family:Arial, \\\"Helvetica Neue\\\", Helvetica, sans-serif\",\n\t\"ffv\": \"font-family:Verdana, Geneva, sans-serif\",\n\t\"fl\": \"float:left|right|none\",\n\t\"fs\": \"font-style:italic|normal|oblique\",\n\t\"fsm\": \"font-smoothing:antialiased|subpixel-antialiased|none\",\n\t\"fst\": \"font-stretch:normal|ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded\",\n\t\"fv\": \"font-variant:normal|small-caps\",\n\t\"fvs\": \"font-variation-settings:normal|inherit|initial|unset\",\n\t\"fw\": \"font-weight:normal|bold|bolder|lighter\",\n\t\"fx\": \"flex\",\n\t\"fxb\": \"flex-basis:fill|max-content|min-content|fit-content|content\",\n\t\"fxd\": \"flex-direction:row|row-reverse|column|column-reverse\",\n\t\"fxf\": \"flex-flow\",\n\t\"fxg\": \"flex-grow\",\n\t\"fxsh\": \"flex-shrink\",\n\t\"fxw\": \"flex-wrap:nowrap|wrap|wrap-reverse\",\n\t\"fsz\": \"font-size\",\n\t\"fsza\": \"font-size-adjust\",\n\t\"g\": \"gap\",\n\t\"gtc\": \"grid-template-columns:repeat(${0})|minmax()\",\n\t\"gtr\": \"grid-template-rows:repeat(${0})|minmax()\",\n\t\"gta\": \"grid-template-areas\",\n\t\"gt\": \"grid-template\",\n\t\"gg\": \"grid-gap\",\n\t\"gcg\": \"grid-column-gap\",\n\t\"grg\": \"grid-row-gap\",\n\t\"gac\": \"grid-auto-columns:auto|minmax()\",\n\t\"gar\": \"grid-auto-rows:auto|minmax()\",\n\t\"gaf\": \"grid-auto-flow:row|column|dense|inherit|initial|unset\",\n\t\"gd\": \"grid\",\n\t\"gc\": \"grid-column\",\n\t\"gcs\": \"grid-column-start\",\n\t\"gce\": \"grid-column-end\",\n\t\"gr\": \"grid-row\",\n\t\"grs\": \"grid-row-start\",\n\t\"gre\": \"grid-row-end\",\n\t\"ga\": \"grid-area\",\n\t\"h\": \"height\",\n  \"is\": \"inline-size\",\n\t\"jc\": \"justify-content:start|end|stretch|flex-start|flex-end|center|space-between|space-around|space-evenly\",\n\t\"ji\": \"justify-items:start|end|center|stretch\",\n\t\"js\": \"justify-self:start|end|center|stretch\",\n\t\"l\": \"left\",\n\t\"lg\": \"background-image:linear-gradient(${1})\",\n\t\"lh\": \"line-height\",\n\t\"lis\": \"list-style\",\n\t\"lisi\": \"list-style-image\",\n\t\"lisp\": \"list-style-position:inside|outside\",\n\t\"list\": \"list-style-type:disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman\",\n\t\"lts\": \"letter-spacing:normal\",\n\t\"m\": \"margin\",\n\t\"mah\": \"max-height\",\n\t\"mar\": \"max-resolution\",\n\t\"maw\": \"max-width\",\n\t\"mb\": \"margin-bottom\",\n\t\"mih\": \"min-height\",\n\t\"mir\": \"min-resolution\",\n\t\"miw\": \"min-width\",\n\t\"ml\": \"margin-left\",\n\t\"mr\": \"margin-right\",\n\t\"mt\": \"margin-top\",\n  \"mbs\": \"margin-block-start\",\n  \"mbe\": \"margin-block-end\",\n  \"mis\": \"margin-inline-start\",\n  \"mie\": \"margin-inline-end\",\n\t\"ol\": \"outline\",\n\t\"olc\": \"outline-color:${1:#000}|invert\",\n\t\"olo\": \"outline-offset\",\n\t\"ols\": \"outline-style:none|dotted|dashed|solid|double|groove|ridge|inset|outset\",\n\t\"olw\": \"outline-width:thin|medium|thick\",\n\t\"op|opa\": \"opacity\",\n\t\"ord\": \"order\",\n\t\"ori\": \"orientation:landscape|portrait\",\n\t\"orp\": \"orphans\",\n\t\"ov\": \"overflow:hidden|visible|hidden|scroll|auto\",\n\t\"ovs\": \"overflow-style:scrollbar|auto|scrollbar|panner|move|marquee\",\n\t\"ovx\": \"overflow-x:hidden|visible|hidden|scroll|auto\",\n\t\"ovy\": \"overflow-y:hidden|visible|hidden|scroll|auto\",\n\t\"p\": \"padding\",\n\t\"pb\": \"padding-bottom\",\n\t\"pgba\": \"page-break-after:auto|always|left|right\",\n\t\"pgbb\": \"page-break-before:auto|always|left|right\",\n\t\"pgbi\": \"page-break-inside:auto|avoid\",\n\t\"pl\": \"padding-left\",\n\t\"pos\": \"position:relative|absolute|relative|fixed|static\",\n\t\"pr\": \"padding-right\",\n\t\"pt\": \"padding-top\",\n  \"pbs\": \"padding-block-start\",\n  \"pbe\": \"padding-block-end\",\n  \"pis\": \"padding-inline-start\",\n  \"pie\": \"padding-inline-end\",\n  \"spbs\": \"scroll-padding-block-start\",\n  \"spbe\": \"scroll-padding-block-end\",\n  \"spis\": \"scroll-padding-inline-start\",\n  \"spie\": \"scroll-padding-inline-end\",\n\t\"q\": \"quotes\",\n\t\"qen\": \"quotes:'\\\\201C' '\\\\201D' '\\\\2018' '\\\\2019'\",\n\t\"qru\": \"quotes:'\\\\00AB' '\\\\00BB' '\\\\201E' '\\\\201C'\",\n\t\"r\": \"right\",\n\t\"rsz\": \"resize:none|both|horizontal|vertical\",\n\t\"t\": \"top\",\n\t\"ta\": \"text-align:left|center|right|justify\",\n\t\"tal\": \"text-align-last:left|center|right\",\n\t\"tbl\": \"table-layout:fixed\",\n\t\"td\": \"text-decoration:none|underline|overline|line-through\",\n\t\"te\": \"text-emphasis:none|accent|dot|circle|disc|before|after\",\n\t\"th\": \"text-height:auto|font-size|text-size|max-size\",\n\t\"ti\": \"text-indent\",\n\t\"tj\": \"text-justify:auto|inter-word|inter-ideograph|inter-cluster|distribute|kashida|tibetan\",\n\t\"to\": \"text-outline:${1:0} ${2:0} ${3:#000}\",\n\t\"tov\": \"text-overflow:ellipsis|clip\",\n\t\"tr\": \"text-replace\",\n\t\"trf\": \"transform:${1}|skewX(${1:angle})|skewY(${1:angle})|scale(${1:x}, ${2:y})|scaleX(${1:x})|scaleY(${1:y})|scaleZ(${1:z})|scale3d(${1:x}, ${2:y}, ${3:z})|rotate(${1:angle})|rotateX(${1:angle})|rotateY(${1:angle})|rotateZ(${1:angle})|translate(${1:x}, ${2:y})|translateX(${1:x})|translateY(${1:y})|translateZ(${1:z})|translate3d(${1:tx}, ${2:ty}, ${3:tz})\",\n\t\"trfo\": \"transform-origin\",\n\t\"trfs\": \"transform-style:preserve-3d\",\n\t\"trs\": \"transition:${1:prop} ${2:time}\",\n\t\"trsde\": \"transition-delay:${1:time}\",\n\t\"trsdu\": \"transition-duration:${1:time}\",\n\t\"trsp\": \"transition-property:${1:prop}\",\n\t\"trstf\": \"transition-timing-function:${1:fn}\",\n\t\"tsh\": \"text-shadow:${1:hoff} ${2:voff} ${3:blur} ${4:#000}\",\n\t\"tt\": \"text-transform:uppercase|lowercase|capitalize|none\",\n\t\"tw\": \"text-wrap:none|normal|unrestricted|suppress\",\n\t\"us\": \"user-select:none\",\n\t\"v\": \"visibility:hidden|visible|collapse\",\n\t\"va\": \"vertical-align:top|super|text-top|middle|baseline|bottom|text-bottom|sub\",\n\t\"w\": \"width\",\n\t\"whs\": \"white-space:nowrap|pre|pre-wrap|pre-line|normal\",\n\t\"whsc\": \"white-space-collapse:normal|keep-all|loose|break-strict|break-all\",\n\t\"wid\": \"widows\",\n\t\"wm\": \"writing-mode:lr-tb|lr-tb|lr-bt|rl-tb|rl-bt|tb-rl|tb-lr|bt-lr|bt-rl\",\n\t\"wob\": \"word-break:normal|keep-all|break-all\",\n\t\"wos\": \"word-spacing\",\n\t\"wow\": \"word-wrap:none|unrestricted|suppress|break-word|normal\",\n\t\"z\": \"z-index\",\n\t\"zom\": \"zoom:1\"\n};\n\nvar xslSnippets = {\n    \"tm|tmatch\": \"xsl:template[match mode]\",\n    \"tn|tname\": \"xsl:template[name]\",\n    \"call\": \"xsl:call-template[name]\",\n    \"ap\": \"xsl:apply-templates[select mode]\",\n    \"api\": \"xsl:apply-imports\",\n    \"imp\": \"xsl:import[href]\",\n    \"inc\": \"xsl:include[href]\",\n    \"ch\": \"xsl:choose\",\n    \"wh|xsl:when\": \"xsl:when[test]\",\n    \"ot\": \"xsl:otherwise\",\n    \"if\": \"xsl:if[test]\",\n    \"par\": \"xsl:param[name]\",\n    \"pare\": \"xsl:param[name select]\",\n    \"var\": \"xsl:variable[name]\",\n    \"vare\": \"xsl:variable[name select]\",\n    \"wp\": \"xsl:with-param[name select]\",\n    \"key\": \"xsl:key[name match use]\",\n    \"elem\": \"xsl:element[name]\",\n    \"attr\": \"xsl:attribute[name]\",\n    \"attrs\": \"xsl:attribute-set[name]\",\n    \"cp\": \"xsl:copy[select]\",\n    \"co\": \"xsl:copy-of[select]\",\n    \"val\": \"xsl:value-of[select]\",\n    \"for|each\": \"xsl:for-each[select]\",\n    \"tex\": \"xsl:text\",\n    \"com\": \"xsl:comment\",\n    \"msg\": \"xsl:message[terminate=no]\",\n    \"fall\": \"xsl:fallback\",\n    \"num\": \"xsl:number[value]\",\n    \"nam\": \"namespace-alias[stylesheet-prefix result-prefix]\",\n    \"pres\": \"xsl:preserve-space[elements]\",\n    \"strip\": \"xsl:strip-space[elements]\",\n    \"proc\": \"xsl:processing-instruction[name]\",\n    \"sort\": \"xsl:sort[select order]\",\n    \"choose\": \"xsl:choose>xsl:when+xsl:otherwise\",\n    \"xsl\": \"!!!+xsl:stylesheet[version=1.0 xmlns:xsl=http://www.w3.org/1999/XSL/Transform]>{\\n|}\",\n    \"!!!\": \"{<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>}\"\n};\n\nvar pugSnippets = {\n\t\"!!!\": \"{doctype html}\"\n};\n\nvar variables = {\n\t\"lang\": \"en\",\n\t\"locale\": \"en-US\",\n\t\"charset\": \"UTF-8\",\n\t\"indentation\": \"\\t\",\n\t\"newline\": \"\\n\"\n};\n\n/**\n * Default syntaxes for abbreviation types\n */\nconst defaultSyntaxes = {\n    markup: 'html',\n    stylesheet: 'css'\n};\nconst defaultOptions$1 = {\n    'inlineElements': [\n        'a', 'abbr', 'acronym', 'applet', 'b', 'basefont', 'bdo',\n        'big', 'br', 'button', 'cite', 'code', 'del', 'dfn', 'em', 'font', 'i',\n        'iframe', 'img', 'input', 'ins', 'kbd', 'label', 'map', 'object', 'q',\n        's', 'samp', 'select', 'small', 'span', 'strike', 'strong', 'sub', 'sup',\n        'textarea', 'tt', 'u', 'var'\n    ],\n    'output.indent': '\\t',\n    'output.baseIndent': '',\n    'output.newline': '\\n',\n    'output.tagCase': '',\n    'output.attributeCase': '',\n    'output.attributeQuotes': 'double',\n    'output.format': true,\n    'output.formatLeafNode': false,\n    'output.formatSkip': ['html'],\n    'output.formatForce': ['body'],\n    'output.inlineBreak': 3,\n    'output.compactBoolean': false,\n    'output.booleanAttributes': [\n        'contenteditable', 'seamless', 'async', 'autofocus',\n        'autoplay', 'checked', 'controls', 'defer', 'disabled', 'formnovalidate',\n        'hidden', 'ismap', 'loop', 'multiple', 'muted', 'novalidate', 'readonly',\n        'required', 'reversed', 'selected', 'typemustmatch'\n    ],\n    'output.reverseAttributes': false,\n    'output.selfClosingStyle': 'html',\n    'output.field': (index, placeholder) => placeholder,\n    'output.text': text => text,\n    'markup.href': true,\n    'comment.enabled': false,\n    'comment.trigger': ['id', 'class'],\n    'comment.before': '',\n    'comment.after': '\\n<!-- /[#ID][.CLASS] -->',\n    'bem.enabled': false,\n    'bem.element': '__',\n    'bem.modifier': '_',\n    'jsx.enabled': false,\n    'stylesheet.keywords': ['auto', 'inherit', 'unset', 'none'],\n    'stylesheet.unitless': ['z-index', 'line-height', 'opacity', 'font-weight', 'zoom', 'flex', 'flex-grow', 'flex-shrink'],\n    'stylesheet.shortHex': true,\n    'stylesheet.between': ': ',\n    'stylesheet.after': ';',\n    'stylesheet.intUnit': 'px',\n    'stylesheet.floatUnit': 'em',\n    'stylesheet.unitAliases': { e: 'em', p: '%', x: 'ex', r: 'rem' },\n    'stylesheet.json': false,\n    'stylesheet.jsonDoubleQuotes': false,\n    'stylesheet.fuzzySearchMinScore': 0\n};\nconst defaultConfig = {\n    type: 'markup',\n    syntax: 'html',\n    variables,\n    snippets: {},\n    options: defaultOptions$1\n};\n/**\n * Default per-syntax config\n */\nconst syntaxConfig = {\n    markup: {\n        snippets: parseSnippets(markupSnippets),\n    },\n    xhtml: {\n        options: {\n            'output.selfClosingStyle': 'xhtml'\n        }\n    },\n    xml: {\n        options: {\n            'output.selfClosingStyle': 'xml'\n        }\n    },\n    xsl: {\n        snippets: parseSnippets(xslSnippets),\n        options: {\n            'output.selfClosingStyle': 'xml'\n        }\n    },\n    jsx: {\n        options: {\n            'jsx.enabled': true,\n            'markup.attributes': {\n                'class': 'className',\n                'class*': 'styleName',\n                'for': 'htmlFor'\n            },\n            'markup.valuePrefix': {\n                'class*': 'styles'\n            }\n        }\n    },\n    vue: {\n        options: {\n            'markup.attributes': {\n                'class*': ':class',\n            }\n        }\n    },\n    svelte: {\n        options: {\n            'jsx.enabled': true\n        }\n    },\n    pug: {\n        snippets: parseSnippets(pugSnippets)\n    },\n    stylesheet: {\n        snippets: parseSnippets(stylesheetSnippets)\n    },\n    sass: {\n        options: {\n            'stylesheet.after': ''\n        }\n    },\n    stylus: {\n        options: {\n            'stylesheet.between': ' ',\n            'stylesheet.after': '',\n        }\n    }\n};\n/**\n * Parses raw snippets definitions with possibly multiple keys into a plan\n * snippet map\n */\nfunction parseSnippets(snippets) {\n    const result = {};\n    Object.keys(snippets).forEach(k => {\n        for (const name of k.split('|')) {\n            result[name] = snippets[k];\n        }\n    });\n    return result;\n}\nfunction resolveConfig(config = {}, globals = {}) {\n    const type = config.type || 'markup';\n    const syntax = config.syntax || defaultSyntaxes[type];\n    return Object.assign(Object.assign(Object.assign({}, defaultConfig), config), { type,\n        syntax, variables: mergedData(type, syntax, 'variables', config, globals), snippets: mergedData(type, syntax, 'snippets', config, globals), options: mergedData(type, syntax, 'options', config, globals) });\n}\nfunction mergedData(type, syntax, key, config, globals = {}) {\n    const typeDefaults = syntaxConfig[type];\n    const typeOverride = globals[type];\n    const syntaxDefaults = syntaxConfig[syntax];\n    const syntaxOverride = globals[syntax];\n    return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, defaultConfig[key]), (typeDefaults && typeDefaults[key])), (syntaxDefaults && syntaxDefaults[key])), (typeOverride && typeOverride[key])), (syntaxOverride && syntaxOverride[key])), config[key]);\n}\n\n/**\n * Creates structure for scanning given string in backward direction\n */\nfunction backwardScanner(text, start = 0) {\n    return { text, start, pos: text.length };\n}\n/**\n * Check if given scanner position is at start of scanned text\n */\nfunction sol(scanner) {\n    return scanner.pos === scanner.start;\n}\n/**\n * \u201CPeeks\u201D character code an current scanner location without advancing it\n */\nfunction peek(scanner, offset = 0) {\n    return scanner.text.charCodeAt(scanner.pos - 1 + offset);\n}\n/**\n * Returns current character code and moves character location one symbol back\n */\nfunction previous(scanner) {\n    if (!sol(scanner)) {\n        return scanner.text.charCodeAt(--scanner.pos);\n    }\n}\n/**\n * Consumes current character code if it matches given `match` code or function\n */\nfunction consume(scanner, match) {\n    if (sol(scanner)) {\n        return false;\n    }\n    const ok = typeof match === 'function'\n        ? match(peek(scanner))\n        : match === peek(scanner);\n    if (ok) {\n        scanner.pos--;\n    }\n    return !!ok;\n}\nfunction consumeWhile(scanner, match) {\n    const start = scanner.pos;\n    while (consume(scanner, match)) {\n        // empty\n    }\n    return scanner.pos < start;\n}\n\nvar Chars$1;\n(function (Chars) {\n    Chars[Chars[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    Chars[Chars[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n    Chars[Chars[\"Escape\"] = 92] = \"Escape\";\n})(Chars$1 || (Chars$1 = {}));\n/**\n * Check if given character code is a quote\n */\nfunction isQuote(c) {\n    return c === Chars$1.SingleQuote || c === Chars$1.DoubleQuote;\n}\n/**\n * Consumes quoted value, if possible\n * @return Returns `true` is value was consumed\n */\nfunction consumeQuoted(scanner) {\n    const start = scanner.pos;\n    const quote = previous(scanner);\n    if (isQuote(quote)) {\n        while (!sol(scanner)) {\n            if (previous(scanner) === quote && peek(scanner) !== Chars$1.Escape) {\n                return true;\n            }\n        }\n    }\n    scanner.pos = start;\n    return false;\n}\n\nvar Brackets;\n(function (Brackets) {\n    Brackets[Brackets[\"SquareL\"] = 91] = \"SquareL\";\n    Brackets[Brackets[\"SquareR\"] = 93] = \"SquareR\";\n    Brackets[Brackets[\"RoundL\"] = 40] = \"RoundL\";\n    Brackets[Brackets[\"RoundR\"] = 41] = \"RoundR\";\n    Brackets[Brackets[\"CurlyL\"] = 123] = \"CurlyL\";\n    Brackets[Brackets[\"CurlyR\"] = 125] = \"CurlyR\";\n})(Brackets || (Brackets = {}));\nconst bracePairs = {\n    [Brackets.SquareL]: Brackets.SquareR,\n    [Brackets.RoundL]: Brackets.RoundR,\n    [Brackets.CurlyL]: Brackets.CurlyR,\n};\n\nvar Chars;\n(function (Chars) {\n    Chars[Chars[\"Tab\"] = 9] = \"Tab\";\n    Chars[Chars[\"Space\"] = 32] = \"Space\";\n    /** `-` character */\n    Chars[Chars[\"Dash\"] = 45] = \"Dash\";\n    /** `/` character */\n    Chars[Chars[\"Slash\"] = 47] = \"Slash\";\n    /** `:` character */\n    Chars[Chars[\"Colon\"] = 58] = \"Colon\";\n    /** `=` character */\n    Chars[Chars[\"Equals\"] = 61] = \"Equals\";\n    /** `<` character */\n    Chars[Chars[\"AngleLeft\"] = 60] = \"AngleLeft\";\n    /** `>` character */\n    Chars[Chars[\"AngleRight\"] = 62] = \"AngleRight\";\n})(Chars || (Chars = {}));\n/**\n * Check if given reader\u2019s current position points at the end of HTML tag\n */\nfunction isHtml(scanner) {\n    const start = scanner.pos;\n    if (!consume(scanner, Chars.AngleRight)) {\n        return false;\n    }\n    let ok = false;\n    consume(scanner, Chars.Slash); // possibly self-closed element\n    while (!sol(scanner)) {\n        consumeWhile(scanner, isWhiteSpace);\n        if (consumeIdent(scanner)) {\n            // ate identifier: could be a tag name, boolean attribute or unquoted\n            // attribute value\n            if (consume(scanner, Chars.Slash)) {\n                // either closing tag or invalid tag\n                ok = consume(scanner, Chars.AngleLeft);\n                break;\n            }\n            else if (consume(scanner, Chars.AngleLeft)) {\n                // opening tag\n                ok = true;\n                break;\n            }\n            else if (consume(scanner, isWhiteSpace)) {\n                // boolean attribute\n                continue;\n            }\n            else if (consume(scanner, Chars.Equals)) {\n                // simple unquoted value or invalid attribute\n                if (consumeIdent(scanner)) {\n                    continue;\n                }\n                break;\n            }\n            else if (consumeAttributeWithUnquotedValue(scanner)) {\n                // identifier was a part of unquoted value\n                ok = true;\n                break;\n            }\n            // invalid tag\n            break;\n        }\n        if (consumeAttribute(scanner)) {\n            continue;\n        }\n        break;\n    }\n    scanner.pos = start;\n    return ok;\n}\n/**\n * Consumes HTML attribute from given string.\n * @return `true` if attribute was consumed.\n */\nfunction consumeAttribute(scanner) {\n    return consumeAttributeWithQuotedValue(scanner) || consumeAttributeWithUnquotedValue(scanner);\n}\nfunction consumeAttributeWithQuotedValue(scanner) {\n    const start = scanner.pos;\n    if (consumeQuoted(scanner) && consume(scanner, Chars.Equals) && consumeIdent(scanner)) {\n        return true;\n    }\n    scanner.pos = start;\n    return false;\n}\nfunction consumeAttributeWithUnquotedValue(scanner) {\n    const start = scanner.pos;\n    const stack = [];\n    while (!sol(scanner)) {\n        const ch = peek(scanner);\n        if (isCloseBracket(ch)) {\n            stack.push(ch);\n        }\n        else if (isOpenBracket(ch)) {\n            if (stack.pop() !== bracePairs[ch]) {\n                // Unexpected open bracket\n                break;\n            }\n        }\n        else if (!isUnquotedValue(ch)) {\n            break;\n        }\n        scanner.pos--;\n    }\n    if (start !== scanner.pos && consume(scanner, Chars.Equals) && consumeIdent(scanner)) {\n        return true;\n    }\n    scanner.pos = start;\n    return false;\n}\n/**\n * Consumes HTML identifier from stream\n */\nfunction consumeIdent(scanner) {\n    return consumeWhile(scanner, isIdent);\n}\n/**\n * Check if given character code belongs to HTML identifier\n */\nfunction isIdent(ch) {\n    return ch === Chars.Colon || ch === Chars.Dash || isAlpha(ch) || isNumber(ch);\n}\n/**\n * Check if given character code is alpha code (letter though A to Z)\n */\nfunction isAlpha(ch) {\n    ch &= ~32; // quick hack to convert any char code to uppercase char code\n    return ch >= 65 && ch <= 90; // A-Z\n}\n/**\n * Check if given code is a number\n */\nfunction isNumber(ch) {\n    return ch > 47 && ch < 58;\n}\n/**\n * Check if given code is a whitespace\n */\nfunction isWhiteSpace(ch) {\n    return ch === Chars.Space || ch === Chars.Tab;\n}\n/**\n * Check if given code may belong to unquoted attribute value\n */\nfunction isUnquotedValue(ch) {\n    return !isNaN(ch) && ch !== Chars.Equals && !isWhiteSpace(ch) && !isQuote(ch);\n}\nfunction isOpenBracket(ch) {\n    return ch === Brackets.CurlyL || ch === Brackets.RoundL || ch === Brackets.SquareL;\n}\nfunction isCloseBracket(ch) {\n    return ch === Brackets.CurlyR || ch === Brackets.RoundR || ch === Brackets.SquareR;\n}\n\nconst code = (ch) => ch.charCodeAt(0);\nconst specialChars = '#.*:$-_!@%^+>/'.split('').map(code);\nconst defaultOptions = {\n    type: 'markup',\n    lookAhead: true,\n    prefix: ''\n};\n/**\n * Extracts Emmet abbreviation from given string.\n * The goal of this module is to extract abbreviation from current editor\u2019s line,\n * e.g. like this: `<span>.foo[title=bar|]</span>` -> `.foo[title=bar]`, where\n * `|` is a current caret position.\n * @param line A text line where abbreviation should be expanded\n * @param pos Caret position in line. If not given, uses end of line\n * @param options Extracting options\n */\nfunction extractAbbreviation$1(line, pos = line.length, options = {}) {\n    // make sure `pos` is within line range\n    const opt = Object.assign(Object.assign({}, defaultOptions), options);\n    pos = Math.min(line.length, Math.max(0, pos == null ? line.length : pos));\n    if (opt.lookAhead) {\n        pos = offsetPastAutoClosed(line, pos, opt);\n    }\n    let ch;\n    const start = getStartOffset(line, pos, opt.prefix || '');\n    if (start === -1) {\n        return void 0;\n    }\n    const scanner = backwardScanner(line, start);\n    scanner.pos = pos;\n    const stack = [];\n    while (!sol(scanner)) {\n        ch = peek(scanner);\n        if (stack.includes(Brackets.CurlyR)) {\n            if (ch === Brackets.CurlyR) {\n                stack.push(ch);\n                scanner.pos--;\n                continue;\n            }\n            if (ch !== Brackets.CurlyL) {\n                scanner.pos--;\n                continue;\n            }\n        }\n        if (isCloseBrace(ch, opt.type)) {\n            stack.push(ch);\n        }\n        else if (isOpenBrace(ch, opt.type)) {\n            if (stack.pop() !== bracePairs[ch]) {\n                // unexpected brace\n                break;\n            }\n        }\n        else if (stack.includes(Brackets.SquareR) || stack.includes(Brackets.CurlyR)) {\n            // respect all characters inside attribute sets or text nodes\n            scanner.pos--;\n            continue;\n        }\n        else if (isHtml(scanner) || !isAbbreviation(ch)) {\n            break;\n        }\n        scanner.pos--;\n    }\n    if (!stack.length && scanner.pos !== pos) {\n        // Found something, remove some invalid symbols from the\n        // beginning and return abbreviation\n        const abbreviation = line.slice(scanner.pos, pos).replace(/^[*+>^]+/, '');\n        return {\n            abbreviation,\n            location: pos - abbreviation.length,\n            start: options.prefix\n                ? start - options.prefix.length\n                : pos - abbreviation.length,\n            end: pos\n        };\n    }\n}\n/**\n * Returns new `line` index which is right after characters beyound `pos` that\n * editor will likely automatically close, e.g. }, ], and quotes\n */\nfunction offsetPastAutoClosed(line, pos, options) {\n    // closing quote is allowed only as a next character\n    if (isQuote(line.charCodeAt(pos))) {\n        pos++;\n    }\n    // offset pointer until non-autoclosed character is found\n    while (isCloseBrace(line.charCodeAt(pos), options.type)) {\n        pos++;\n    }\n    return pos;\n}\n/**\n * Returns start offset (left limit) in `line` where we should stop looking for\n * abbreviation: it\u2019s nearest to `pos` location of `prefix` token\n */\nfunction getStartOffset(line, pos, prefix) {\n    if (!prefix) {\n        return 0;\n    }\n    const scanner = backwardScanner(line);\n    const compiledPrefix = prefix.split('').map(code);\n    scanner.pos = pos;\n    let result;\n    while (!sol(scanner)) {\n        if (consumePair(scanner, Brackets.SquareR, Brackets.SquareL) || consumePair(scanner, Brackets.CurlyR, Brackets.CurlyL)) {\n            continue;\n        }\n        result = scanner.pos;\n        if (consumeArray(scanner, compiledPrefix)) {\n            return result;\n        }\n        scanner.pos--;\n    }\n    return -1;\n}\n/**\n * Consumes full character pair, if possible\n */\nfunction consumePair(scanner, close, open) {\n    const start = scanner.pos;\n    if (consume(scanner, close)) {\n        while (!sol(scanner)) {\n            if (consume(scanner, open)) {\n                return true;\n            }\n            scanner.pos--;\n        }\n    }\n    scanner.pos = start;\n    return false;\n}\n/**\n * Consumes all character codes from given array, right-to-left, if possible\n */\nfunction consumeArray(scanner, arr) {\n    const start = scanner.pos;\n    let consumed = false;\n    for (let i = arr.length - 1; i >= 0 && !sol(scanner); i--) {\n        if (!consume(scanner, arr[i])) {\n            break;\n        }\n        consumed = i === 0;\n    }\n    if (!consumed) {\n        scanner.pos = start;\n    }\n    return consumed;\n}\nfunction isAbbreviation(ch) {\n    return (ch > 64 && ch < 91) // uppercase letter\n        || (ch > 96 && ch < 123) // lowercase letter\n        || (ch > 47 && ch < 58) // number\n        || specialChars.includes(ch); // special character\n}\nfunction isOpenBrace(ch, syntax) {\n    return ch === Brackets.RoundL || (syntax === 'markup' && (ch === Brackets.SquareL || ch === Brackets.CurlyL));\n}\nfunction isCloseBrace(ch, syntax) {\n    return ch === Brackets.RoundR || (syntax === 'markup' && (ch === Brackets.SquareR || ch === Brackets.CurlyR));\n}\n\nfunction expandAbbreviation$1(abbr, config) {\n    const resolvedConfig = resolveConfig(config);\n    return resolvedConfig.type === 'stylesheet'\n        ? stylesheet(abbr, resolvedConfig)\n        : markup(abbr, resolvedConfig);\n}\n/**\n * Expands given *markup* abbreviation (e.g. regular Emmet abbreviation that\n * produces structured output like HTML) and outputs it according to options\n * provided in config\n */\nfunction markup(abbr, config) {\n    return stringify(parse$1(abbr, config), config);\n}\n/**\n * Expands given *stylesheet* abbreviation (a special Emmet abbreviation designed for\n * stylesheet languages like CSS, SASS etc.) and outputs it according to options\n * provided in config\n */\nfunction stylesheet(abbr, config) {\n    return css(parse(abbr, config), config);\n}\n\nconst cssData = {\n    \"properties\": [\"additive-symbols\", \"align-content\", \"align-items\", \"justify-items\", \"justify-self\", \"justify-items\", \"align-self\", \"all\", \"alt\", \"animation\", \"animation-delay\", \"animation-direction\", \"animation-duration\", \"animation-fill-mode\", \"animation-iteration-count\", \"animation-name\", \"animation-play-state\", \"animation-timing-function\", \"backface-visibility\", \"background\", \"background-attachment\", \"background-blend-mode\", \"background-clip\", \"background-color\", \"background-image\", \"background-origin\", \"background-position\", \"background-position-x\", \"background-position-y\", \"background-repeat\", \"background-size\", \"behavior\", \"block-size\", \"border\", \"border-block-end\", \"border-block-start\", \"border-block-end-color\", \"border-block-start-color\", \"border-block-end-style\", \"border-block-start-style\", \"border-block-end-width\", \"border-block-start-width\", \"border-bottom\", \"border-bottom-color\", \"border-bottom-left-radius\", \"border-bottom-right-radius\", \"border-bottom-style\", \"border-bottom-width\", \"border-collapse\", \"border-color\", \"border-image\", \"border-image-outset\", \"border-image-repeat\", \"border-image-slice\", \"border-image-source\", \"border-image-width\", \"border-inline-end\", \"border-inline-start\", \"border-inline-end-color\", \"border-inline-start-color\", \"border-inline-end-style\", \"border-inline-start-style\", \"border-inline-end-width\", \"border-inline-start-width\", \"border-left\", \"border-left-color\", \"border-left-style\", \"border-left-width\", \"border-radius\", \"border-right\", \"border-right-color\", \"border-right-style\", \"border-right-width\", \"border-spacing\", \"border-style\", \"border-top\", \"border-top-color\", \"border-top-left-radius\", \"border-top-right-radius\", \"border-top-style\", \"border-top-width\", \"border-width\", \"bottom\", \"box-decoration-break\", \"box-shadow\", \"box-sizing\", \"break-after\", \"break-before\", \"break-inside\", \"caption-side\", \"caret-color\", \"clear\", \"clip\", \"clip-path\", \"clip-rule\", \"color\", \"color-interpolation-filters\", \"column-count\", \"column-fill\", \"column-gap\", \"column-rule\", \"column-rule-color\", \"column-rule-style\", \"column-rule-width\", \"columns\", \"column-span\", \"column-width\", \"contain\", \"content\", \"counter-increment\", \"counter-reset\", \"cursor\", \"direction\", \"display\", \"empty-cells\", \"enable-background\", \"fallback\", \"fill\", \"fill-opacity\", \"fill-rule\", \"filter\", \"flex\", \"flex-basis\", \"flex-direction\", \"flex-flow\", \"flex-grow\", \"flex-shrink\", \"flex-wrap\", \"float\", \"flood-color\", \"flood-opacity\", \"font\", \"font-family\", \"font-feature-settings\", \"font-kerning\", \"font-language-override\", \"font-size\", \"font-size-adjust\", \"font-stretch\", \"font-style\", \"font-synthesis\", \"font-variant\", \"font-variant-alternates\", \"font-variant-caps\", \"font-variant-east-asian\", \"font-variant-ligatures\", \"font-variant-numeric\", \"font-variant-position\", \"font-weight\", \"glyph-orientation-horizontal\", \"glyph-orientation-vertical\", \"grid-area\", \"grid-auto-columns\", \"grid-auto-flow\", \"grid-auto-rows\", \"grid-column\", \"grid-column-end\", \"grid-column-gap\", \"grid-column-start\", \"grid-gap\", \"grid-row\", \"grid-row-end\", \"grid-row-gap\", \"grid-row-start\", \"grid-template\", \"grid-template-areas\", \"grid-template-columns\", \"grid-template-rows\", \"height\", \"hyphens\", \"image-orientation\", \"image-rendering\", \"ime-mode\", \"inline-size\", \"isolation\", \"justify-content\", \"kerning\", \"left\", \"letter-spacing\", \"lighting-color\", \"line-break\", \"line-height\", \"list-style\", \"list-style-image\", \"list-style-position\", \"list-style-type\", \"margin\", \"margin-block-end\", \"margin-block-start\", \"margin-bottom\", \"margin-inline-end\", \"margin-inline-start\", \"margin-left\", \"margin-right\", \"margin-top\", \"marker\", \"marker-end\", \"marker-mid\", \"marker-start\", \"mask-type\", \"max-block-size\", \"max-height\", \"max-inline-size\", \"max-width\", \"min-block-size\", \"min-height\", \"min-inline-size\", \"min-width\", \"mix-blend-mode\", \"motion\", \"motion-offset\", \"motion-path\", \"motion-rotation\", \"-moz-animation\", \"-moz-animation-delay\", \"-moz-animation-direction\", \"-moz-animation-duration\", \"-moz-animation-iteration-count\", \"-moz-animation-name\", \"-moz-animation-play-state\", \"-moz-animation-timing-function\", \"-moz-appearance\", \"-moz-backface-visibility\", \"-moz-background-clip\", \"-moz-background-inline-policy\", \"-moz-background-origin\", \"-moz-border-bottom-colors\", \"-moz-border-image\", \"-moz-border-left-colors\", \"-moz-border-right-colors\", \"-moz-border-top-colors\", \"-moz-box-align\", \"-moz-box-direction\", \"-moz-box-flex\", \"-moz-box-flexgroup\", \"-moz-box-ordinal-group\", \"-moz-box-orient\", \"-moz-box-pack\", \"-moz-box-sizing\", \"-moz-column-count\", \"-moz-column-gap\", \"-moz-column-rule\", \"-moz-column-rule-color\", \"-moz-column-rule-style\", \"-moz-column-rule-width\", \"-moz-columns\", \"-moz-column-width\", \"-moz-font-feature-settings\", \"-moz-hyphens\", \"-moz-perspective\", \"-moz-perspective-origin\", \"-moz-text-align-last\", \"-moz-text-decoration-color\", \"-moz-text-decoration-line\", \"-moz-text-decoration-style\", \"-moz-text-size-adjust\", \"-moz-transform\", \"-moz-transform-origin\", \"-moz-transition\", \"-moz-transition-delay\", \"-moz-transition-duration\", \"-moz-transition-property\", \"-moz-transition-timing-function\", \"-moz-user-focus\", \"-moz-user-select\", \"-ms-accelerator\", \"-ms-behavior\", \"-ms-block-progression\", \"-ms-content-zoom-chaining\", \"-ms-content-zooming\", \"-ms-content-zoom-limit\", \"-ms-content-zoom-limit-max\", \"-ms-content-zoom-limit-min\", \"-ms-content-zoom-snap\", \"-ms-content-zoom-snap-points\", \"-ms-content-zoom-snap-type\", \"-ms-filter\", \"-ms-flex\", \"-ms-flex-align\", \"-ms-flex-direction\", \"-ms-flex-flow\", \"-ms-flex-item-align\", \"-ms-flex-line-pack\", \"-ms-flex-order\", \"-ms-flex-pack\", \"-ms-flex-wrap\", \"-ms-flow-from\", \"-ms-flow-into\", \"-ms-grid-column\", \"-ms-grid-column-align\", \"-ms-grid-columns\", \"-ms-grid-column-span\", \"-ms-grid-layer\", \"-ms-grid-row\", \"-ms-grid-row-align\", \"-ms-grid-rows\", \"-ms-grid-row-span\", \"-ms-high-contrast-adjust\", \"-ms-hyphenate-limit-chars\", \"-ms-hyphenate-limit-lines\", \"-ms-hyphenate-limit-zone\", \"-ms-hyphens\", \"-ms-ime-mode\", \"-ms-interpolation-mode\", \"-ms-layout-grid\", \"-ms-layout-grid-char\", \"-ms-layout-grid-line\", \"-ms-layout-grid-mode\", \"-ms-layout-grid-type\", \"-ms-line-break\", \"-ms-overflow-style\", \"-ms-perspective\", \"-ms-perspective-origin\", \"-ms-perspective-origin-x\", \"-ms-perspective-origin-y\", \"-ms-progress-appearance\", \"-ms-scrollbar-3dlight-color\", \"-ms-scrollbar-arrow-color\", \"-ms-scrollbar-base-color\", \"-ms-scrollbar-darkshadow-color\", \"-ms-scrollbar-face-color\", \"-ms-scrollbar-highlight-color\", \"-ms-scrollbar-shadow-color\", \"-ms-scrollbar-track-color\", \"-ms-scroll-chaining\", \"-ms-scroll-limit\", \"-ms-scroll-limit-x-max\", \"-ms-scroll-limit-x-min\", \"-ms-scroll-limit-y-max\", \"-ms-scroll-limit-y-min\", \"-ms-scroll-rails\", \"-ms-scroll-snap-points-x\", \"-ms-scroll-snap-points-y\", \"-ms-scroll-snap-type\", \"-ms-scroll-snap-x\", \"-ms-scroll-snap-y\", \"-ms-scroll-translation\", \"-ms-text-align-last\", \"-ms-text-autospace\", \"-ms-text-combine-horizontal\", \"-ms-text-justify\", \"-ms-text-kashida-space\", \"-ms-text-overflow\", \"-ms-text-size-adjust\", \"-ms-text-underline-position\", \"-ms-touch-action\", \"-ms-touch-select\", \"-ms-transform\", \"-ms-transform-origin\", \"-ms-transform-origin-x\", \"-ms-transform-origin-y\", \"-ms-transform-origin-z\", \"-ms-user-select\", \"-ms-word-break\", \"-ms-word-wrap\", \"-ms-wrap-flow\", \"-ms-wrap-margin\", \"-ms-wrap-through\", \"-ms-writing-mode\", \"-ms-zoom\", \"-ms-zoom-animation\", \"nav-down\", \"nav-index\", \"nav-left\", \"nav-right\", \"nav-up\", \"negative\", \"-o-animation\", \"-o-animation-delay\", \"-o-animation-direction\", \"-o-animation-duration\", \"-o-animation-fill-mode\", \"-o-animation-iteration-count\", \"-o-animation-name\", \"-o-animation-play-state\", \"-o-animation-timing-function\", \"object-fit\", \"object-position\", \"-o-border-image\", \"-o-object-fit\", \"-o-object-position\", \"opacity\", \"order\", \"orphans\", \"-o-table-baseline\", \"-o-tab-size\", \"-o-text-overflow\", \"-o-transform\", \"-o-transform-origin\", \"-o-transition\", \"-o-transition-delay\", \"-o-transition-duration\", \"-o-transition-property\", \"-o-transition-timing-function\", \"offset-block-end\", \"offset-block-start\", \"offset-inline-end\", \"offset-inline-start\", \"outline\", \"outline-color\", \"outline-offset\", \"outline-style\", \"outline-width\", \"overflow\", \"overflow-wrap\", \"overflow-x\", \"overflow-y\", \"pad\", \"padding\", \"padding-bottom\", \"padding-block-end\", \"padding-block-start\", \"padding-inline-end\", \"padding-inline-start\", \"padding-left\", \"padding-right\", \"padding-top\", \"page-break-after\", \"page-break-before\", \"page-break-inside\", \"paint-order\", \"perspective\", \"perspective-origin\", \"pointer-events\", \"position\", \"prefix\", \"quotes\", \"range\", \"resize\", \"right\", \"ruby-align\", \"ruby-overhang\", \"ruby-position\", \"ruby-span\", \"scrollbar-3dlight-color\", \"scrollbar-arrow-color\", \"scrollbar-base-color\", \"scrollbar-darkshadow-color\", \"scrollbar-face-color\", \"scrollbar-highlight-color\", \"scrollbar-shadow-color\", \"scrollbar-track-color\", \"scroll-behavior\", \"scroll-snap-coordinate\", \"scroll-snap-destination\", \"scroll-snap-points-x\", \"scroll-snap-points-y\", \"scroll-snap-type\", \"shape-image-threshold\", \"shape-margin\", \"shape-outside\", \"shape-rendering\", \"size\", \"src\", \"stop-color\", \"stop-opacity\", \"stroke\", \"stroke-dasharray\", \"stroke-dashoffset\", \"stroke-linecap\", \"stroke-linejoin\", \"stroke-miterlimit\", \"stroke-opacity\", \"stroke-width\", \"suffix\", \"system\", \"symbols\", \"table-layout\", \"tab-size\", \"text-align\", \"text-align-last\", \"text-anchor\", \"text-decoration\", \"text-decoration-color\", \"text-decoration-line\", \"text-decoration-style\", \"text-indent\", \"text-justify\", \"text-orientation\", \"text-overflow\", \"text-rendering\", \"text-shadow\", \"text-transform\", \"text-underline-position\", \"top\", \"touch-action\", \"transform\", \"transform-origin\", \"transform-style\", \"transition\", \"transition-delay\", \"transition-duration\", \"transition-property\", \"transition-timing-function\", \"unicode-bidi\", \"unicode-range\", \"user-select\", \"vertical-align\", \"visibility\", \"-webkit-animation\", \"-webkit-animation-delay\", \"-webkit-animation-direction\", \"-webkit-animation-duration\", \"-webkit-animation-fill-mode\", \"-webkit-animation-iteration-count\", \"-webkit-animation-name\", \"-webkit-animation-play-state\", \"-webkit-animation-timing-function\", \"-webkit-appearance\", \"-webkit-backdrop-filter\", \"-webkit-backface-visibility\", \"-webkit-background-clip\", \"-webkit-background-composite\", \"-webkit-background-origin\", \"-webkit-border-image\", \"-webkit-box-align\", \"-webkit-box-direction\", \"-webkit-box-flex\", \"-webkit-box-flex-group\", \"-webkit-box-ordinal-group\", \"-webkit-box-orient\", \"-webkit-box-pack\", \"-webkit-box-reflect\", \"-webkit-box-sizing\", \"-webkit-break-after\", \"-webkit-break-before\", \"-webkit-break-inside\", \"-webkit-column-break-after\", \"-webkit-column-break-before\", \"-webkit-column-break-inside\", \"-webkit-column-count\", \"-webkit-column-gap\", \"-webkit-column-rule\", \"-webkit-column-rule-color\", \"-webkit-column-rule-style\", \"-webkit-column-rule-width\", \"-webkit-columns\", \"-webkit-column-span\", \"-webkit-column-width\", \"-webkit-filter\", \"-webkit-flow-from\", \"-webkit-flow-into\", \"-webkit-font-feature-settings\", \"-webkit-hyphens\", \"-webkit-line-break\", \"-webkit-margin-bottom-collapse\", \"-webkit-margin-collapse\", \"-webkit-margin-start\", \"-webkit-margin-top-collapse\", \"-webkit-mask-clip\", \"-webkit-mask-image\", \"-webkit-mask-origin\", \"-webkit-mask-repeat\", \"-webkit-mask-size\", \"-webkit-nbsp-mode\", \"-webkit-overflow-scrolling\", \"-webkit-padding-start\", \"-webkit-perspective\", \"-webkit-perspective-origin\", \"-webkit-region-fragment\", \"-webkit-tap-highlight-color\", \"-webkit-text-fill-color\", \"-webkit-text-size-adjust\", \"-webkit-text-stroke\", \"-webkit-text-stroke-color\", \"-webkit-text-stroke-width\", \"-webkit-touch-callout\", \"-webkit-transform\", \"-webkit-transform-origin\", \"-webkit-transform-origin-x\", \"-webkit-transform-origin-y\", \"-webkit-transform-origin-z\", \"-webkit-transform-style\", \"-webkit-transition\", \"-webkit-transition-delay\", \"-webkit-transition-duration\", \"-webkit-transition-property\", \"-webkit-transition-timing-function\", \"-webkit-user-drag\", \"-webkit-user-modify\", \"-webkit-user-select\", \"white-space\", \"widows\", \"width\", \"will-change\", \"word-break\", \"word-spacing\", \"word-wrap\", \"writing-mode\", \"z-index\", \"zoom\"]\n};\nconst htmlData = {\n    \"tags\": [\n        \"body\", \"head\", \"html\",\n        \"address\", \"blockquote\", \"dd\", \"div\", \"section\", \"article\", \"aside\", \"header\", \"footer\", \"nav\", \"menu\", \"dl\", \"dt\", \"fieldset\", \"form\", \"frame\", \"frameset\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"iframe\", \"noframes\", \"object\", \"ol\", \"p\", \"ul\", \"applet\", \"center\", \"dir\", \"hr\", \"pre\",\n        \"a\", \"abbr\", \"acronym\", \"area\", \"b\", \"base\", \"basefont\", \"bdo\", \"big\", \"br\", \"button\", \"caption\", \"cite\", \"code\", \"col\", \"colgroup\", \"del\", \"dfn\", \"em\", \"font\", \"i\", \"img\", \"input\", \"ins\", \"isindex\", \"kbd\", \"label\", \"legend\", \"li\", \"link\", \"map\", \"meta\", \"noscript\", \"optgroup\", \"option\", \"param\", \"q\", \"s\", \"samp\", \"script\", \"select\", \"small\", \"span\", \"strike\", \"strong\", \"style\", \"sub\", \"sup\", \"table\", \"tbody\", \"td\", \"textarea\", \"tfoot\", \"th\", \"thead\", \"title\", \"tr\", \"tt\", \"u\", \"var\",\n        \"canvas\", \"main\", \"figure\", \"plaintext\", \"figcaption\", \"hgroup\", \"details\", \"summary\"\n    ]\n};\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nconst snippetKeyCache = new Map();\nlet markupSnippetKeys;\nconst stylesheetCustomSnippetsKeyCache = new Map();\nconst htmlAbbreviationStartRegex = /^[a-z,A-Z,!,(,[,#,\\.\\{]/;\n// take off { for jsx because it interferes with the language\nconst jsxAbbreviationStartRegex = /^[a-z,A-Z,!,(,[,#,\\.]/;\nconst cssAbbreviationRegex = /^-?[a-z,A-Z,!,@,#]/;\nconst htmlAbbreviationRegex = /[a-z,A-Z\\.]/;\nconst commonlyUsedTags = [...htmlData.tags, 'lorem'];\nconst bemFilterSuffix = 'bem';\nconst filterDelimitor = '|';\nconst trimFilterSuffix = 't';\nconst commentFilterSuffix = 'c';\nconst maxFilters = 3;\n/**\n * Returns all applicable emmet expansions for abbreviation at given position in a CompletionList\n * @param model TextModel in which completions are requested\n * @param position Position in the document at which completions are requested\n * @param syntax Emmet supported language\n * @param emmetConfig Emmet Configurations as derived from VS Code\n */\nfunction doComplete(monaco, model, position, syntax, emmetConfig) {\n    var _a;\n    const isStyleSheetRes = isStyleSheet(syntax);\n    // Fetch markupSnippets so that we can provide possible abbreviation completions\n    // For example, when text at position is `a`, completions should return `a:blank`, `a:link`, `acr` etc.\n    if (!isStyleSheetRes) {\n        if (!snippetKeyCache.has(syntax)) {\n            const registry = Object.assign(Object.assign({}, getDefaultSnippets(syntax)), customSnippetsRegistry[syntax]);\n            snippetKeyCache.set(syntax, Object.keys(registry));\n        }\n        markupSnippetKeys = (_a = snippetKeyCache.get(syntax)) !== null && _a !== void 0 ? _a : [];\n    }\n    const extractOptions = {\n        lookAhead: !isStyleSheetRes,\n        type: getSyntaxType(syntax),\n    };\n    const extractedValue = extractAbbreviation(monaco, model, position, extractOptions);\n    if (!extractedValue)\n        return;\n    const { abbreviationRange, abbreviation, currentLineTillPosition, filter } = extractedValue;\n    const currentWord = getCurrentWord(currentLineTillPosition);\n    // Don't attempt to expand open tags\n    if (currentWord === abbreviation && currentLineTillPosition.endsWith(`<${abbreviation}`) && !isStyleSheetRes) {\n        return;\n    }\n    const expandOptions = getExpandOptions(syntax, filter);\n    let expandedText = '';\n    let expandedAbbr;\n    let completionItems = [];\n    // Create completion item after expanding given abbreviation\n    // if abbreviation is valid and expanded value is not noise\n    const createExpandedAbbr = (syntax, abbr) => {\n        if (!isAbbreviationValid(syntax, abbreviation))\n            return;\n        try {\n            expandedText = expandAbbreviation$1(abbr, expandOptions);\n            // manually patch https://github.com/microsoft/vscode/issues/120245 for now\n            if (isStyleSheetRes && '!important'.startsWith(abbr)) {\n                expandedText = '!important';\n            }\n        }\n        catch (e) { }\n        if (!expandedText || isExpandedTextNoise(syntax, abbr, expandedText, expandOptions.options)) {\n            return;\n        }\n        expandedAbbr = {\n            kind: monaco.languages.CompletionItemKind.Property,\n            label: abbreviation + (filter ? '|' + filter.replace(',', '|') : ''),\n            documentation: replaceTabStopsWithCursors(expandedText),\n            detail: 'Emmet abbreviation',\n            insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n            range: abbreviationRange,\n            insertText: escapeNonTabStopDollar(addFinalTabStop(expandedText)),\n        };\n        completionItems = [expandedAbbr];\n    };\n    createExpandedAbbr(syntax, abbreviation);\n    if (isStyleSheetRes) {\n        // When abbr is longer than usual emmet snippets and matches better with existing css property, then no emmet\n        if (abbreviation.length > 4 && cssData.properties.some((x) => x.startsWith(abbreviation))) {\n            return { suggestions: [], incomplete: true };\n        }\n        if (expandedAbbr && expandedText.length) {\n            expandedAbbr.range = abbreviationRange;\n            expandedAbbr.insertText = escapeNonTabStopDollar(addFinalTabStop(expandedText));\n            expandedAbbr.documentation = replaceTabStopsWithCursors(expandedText);\n            expandedAbbr.label = removeTabStops(expandedText);\n            expandedAbbr.filterText = abbreviation;\n            // Custom snippets should show up in completions if abbreviation is a prefix\n            const stylesheetCustomSnippetsKeys = stylesheetCustomSnippetsKeyCache.has(syntax)\n                ? stylesheetCustomSnippetsKeyCache.get(syntax)\n                : stylesheetCustomSnippetsKeyCache.get('css');\n            completionItems = makeSnippetSuggestion(monaco, stylesheetCustomSnippetsKeys !== null && stylesheetCustomSnippetsKeys !== void 0 ? stylesheetCustomSnippetsKeys : [], abbreviation, abbreviation, abbreviationRange, expandOptions, 'Emmet Custom Snippet', false);\n            if (!completionItems.find((x) => x.insertText === (expandedAbbr === null || expandedAbbr === void 0 ? void 0 : expandedAbbr.insertText))) {\n                // Fix for https://github.com/Microsoft/vscode/issues/28933#issuecomment-309236902\n                // When user types in propertyname, emmet uses it to match with snippet names, resulting in width -> widows or font-family -> font: family\n                // Filter out those cases here.\n                const abbrRegex = new RegExp('.*' +\n                    abbreviation\n                        .split('')\n                        .map((x) => (x === '$' || x === '+' ? '\\\\' + x : x))\n                        .join('.*') +\n                    '.*', 'i');\n                if (/\\d/.test(abbreviation) || abbrRegex.test(expandedAbbr.label)) {\n                    completionItems.push(expandedAbbr);\n                }\n            }\n        }\n    }\n    else {\n        let tagToFindMoreSuggestionsFor = abbreviation;\n        const newTagMatches = abbreviation.match(/(>|\\+)([\\w:-]+)$/);\n        if (newTagMatches && newTagMatches.length === 3) {\n            tagToFindMoreSuggestionsFor = newTagMatches[2];\n        }\n        if (syntax !== 'xml') {\n            const commonlyUsedTagSuggestions = makeSnippetSuggestion(monaco, commonlyUsedTags, tagToFindMoreSuggestionsFor, abbreviation, abbreviationRange, expandOptions, 'Emmet Abbreviation');\n            completionItems = completionItems.concat(commonlyUsedTagSuggestions);\n        }\n        if (emmetConfig.showAbbreviationSuggestions === true) {\n            const abbreviationSuggestions = makeSnippetSuggestion(monaco, markupSnippetKeys.filter((x) => !commonlyUsedTags.includes(x)), tagToFindMoreSuggestionsFor, abbreviation, abbreviationRange, expandOptions, 'Emmet Abbreviation');\n            // Workaround for the main expanded abbr not appearing before the snippet suggestions\n            if (expandedAbbr && abbreviationSuggestions.length > 0 && tagToFindMoreSuggestionsFor !== abbreviation) {\n                expandedAbbr.sortText = '0' + expandedAbbr.label;\n                abbreviationSuggestions.forEach((item) => {\n                    // Workaround for snippet suggestions items getting filtered out as the complete abbr does not start with snippetKey\n                    item.filterText = abbreviation;\n                    // Workaround for the main expanded abbr not appearing before the snippet suggestions\n                    item.sortText = '9' + abbreviation;\n                });\n            }\n            completionItems = completionItems.concat(abbreviationSuggestions);\n        }\n        // https://github.com/microsoft/vscode/issues/66680\n        if (syntax === 'html' &&\n            completionItems.length >= 2 &&\n            abbreviation.includes(':') &&\n            (expandedAbbr === null || expandedAbbr === void 0 ? void 0 : expandedAbbr.insertText) === `<${abbreviation}>\\${0}</${abbreviation}>`) {\n            completionItems = completionItems.filter((item) => item.label !== abbreviation);\n        }\n    }\n    if (emmetConfig.showSuggestionsAsSnippets === true) {\n        completionItems.forEach((x) => (x.kind = monaco.languages.CompletionItemKind.Snippet));\n    }\n    return completionItems.length ? { suggestions: completionItems, incomplete: true } : undefined;\n}\n/**\n * Create & return snippets for snippet keys that start with given prefix\n */\nfunction makeSnippetSuggestion(monaco, snippetKeys, prefix, abbreviation, abbreviationRange, expandOptions, snippetDetail, skipFullMatch = true) {\n    if (!prefix || !snippetKeys) {\n        return [];\n    }\n    const snippetCompletions = [];\n    snippetKeys.forEach((snippetKey) => {\n        if (!snippetKey.startsWith(prefix.toLowerCase()) || (skipFullMatch && snippetKey === prefix.toLowerCase())) {\n            return;\n        }\n        const currentAbbr = abbreviation + snippetKey.substr(prefix.length);\n        let expandedAbbr;\n        try {\n            expandedAbbr = expandAbbreviation$1(currentAbbr, expandOptions);\n        }\n        catch (e) { }\n        if (!expandedAbbr) {\n            return;\n        }\n        const item = {\n            kind: monaco.languages.CompletionItemKind.Property,\n            label: prefix + snippetKey.substr(prefix.length),\n            documentation: replaceTabStopsWithCursors(expandedAbbr),\n            detail: snippetDetail,\n            insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n            range: abbreviationRange,\n            insertText: escapeNonTabStopDollar(addFinalTabStop(expandedAbbr)),\n        };\n        snippetCompletions.push(item);\n    });\n    return snippetCompletions;\n}\nfunction getCurrentWord(currentLineTillPosition) {\n    if (currentLineTillPosition) {\n        const matches = currentLineTillPosition.match(/[\\w,:,-,\\.]*$/);\n        if (matches) {\n            return matches[0];\n        }\n    }\n}\nfunction replaceTabStopsWithCursors(expandedWord) {\n    return expandedWord.replace(/([^\\\\])\\$\\{\\d+\\}/g, '$1|').replace(/\\$\\{\\d+:([^\\}]+)\\}/g, '$1');\n}\nfunction removeTabStops(expandedWord) {\n    return expandedWord.replace(/([^\\\\])\\$\\{\\d+\\}/g, '$1').replace(/\\$\\{\\d+:([^\\}]+)\\}/g, '$1');\n}\nfunction escapeNonTabStopDollar(text) {\n    return text ? text.replace(/([^\\\\])(\\$)([^\\{])/g, '$1\\\\$2$3') : text;\n}\nfunction addFinalTabStop(text) {\n    if (!text || !text.trim()) {\n        return text;\n    }\n    let maxTabStop = -1;\n    let maxTabStopRanges = [];\n    let foundLastStop = false;\n    let replaceWithLastStop = false;\n    let i = 0;\n    const n = text.length;\n    try {\n        while (i < n && !foundLastStop) {\n            // Look for ${\n            if (text[i++] != '$' || text[i++] != '{') {\n                continue;\n            }\n            // Find tabstop\n            let numberStart = -1;\n            let numberEnd = -1;\n            while (i < n && /\\d/.test(text[i])) {\n                numberStart = numberStart < 0 ? i : numberStart;\n                numberEnd = i + 1;\n                i++;\n            }\n            // If ${ was not followed by a number and either } or :, then its not a tabstop\n            if (numberStart === -1 || numberEnd === -1 || i >= n || (text[i] != '}' && text[i] != ':')) {\n                continue;\n            }\n            // If ${0} was found, then break\n            const currentTabStop = text.substring(numberStart, numberEnd);\n            foundLastStop = currentTabStop === '0';\n            if (foundLastStop) {\n                break;\n            }\n            let foundPlaceholder = false;\n            if (text[i++] == ':') {\n                // TODO: Nested placeholders may break here\n                while (i < n) {\n                    if (text[i] == '}') {\n                        foundPlaceholder = true;\n                        break;\n                    }\n                    i++;\n                }\n            }\n            // Decide to replace currentTabStop with ${0} only if its the max among all tabstops and is not a placeholder\n            if (Number(currentTabStop) > Number(maxTabStop)) {\n                maxTabStop = Number(currentTabStop);\n                maxTabStopRanges = [{ numberStart, numberEnd }];\n                replaceWithLastStop = !foundPlaceholder;\n            }\n            else if (Number(currentTabStop) === maxTabStop) {\n                maxTabStopRanges.push({ numberStart, numberEnd });\n            }\n        }\n    }\n    catch (e) { }\n    if (replaceWithLastStop && !foundLastStop) {\n        for (let i = 0; i < maxTabStopRanges.length; i++) {\n            const rangeStart = maxTabStopRanges[i].numberStart;\n            const rangeEnd = maxTabStopRanges[i].numberEnd;\n            text = text.substr(0, rangeStart) + '0' + text.substr(rangeEnd);\n        }\n    }\n    return text;\n}\nlet customSnippetsRegistry = {};\nconst emmetSnippetField = (index, placeholder) => `\\${${index}${placeholder ? ':' + placeholder : ''}}`;\n/** Returns whether or not syntax is a supported stylesheet syntax, like CSS */\nfunction isStyleSheet(syntax) {\n    return syntax === 'css';\n}\n/** Returns the syntax type, either markup (e.g. for HTML) or stylesheet (e.g. for CSS) */\nfunction getSyntaxType(syntax) {\n    return isStyleSheet(syntax) ? 'stylesheet' : 'markup';\n}\n/** Returns the default syntax (html or css) to use for the snippets registry */\nfunction getDefaultSyntax(syntax) {\n    return isStyleSheet(syntax) ? 'css' : 'html';\n}\n/** Returns the default snippets that Emmet suggests */\nfunction getDefaultSnippets(syntax) {\n    const syntaxType = getSyntaxType(syntax);\n    const emptyUserConfig = { type: syntaxType, syntax };\n    const resolvedConfig = resolveConfig(emptyUserConfig);\n    // https://github.com/microsoft/vscode/issues/97632\n    // don't return markup (HTML) snippets for XML\n    return syntax === 'xml' ? {} : resolvedConfig.snippets;\n}\nfunction getFilters(text, pos) {\n    let filter;\n    for (let i = 0; i < maxFilters; i++) {\n        if (text.endsWith(`${filterDelimitor}${bemFilterSuffix}`, pos)) {\n            pos -= bemFilterSuffix.length + 1;\n            filter = filter ? bemFilterSuffix + ',' + filter : bemFilterSuffix;\n        }\n        else if (text.endsWith(`${filterDelimitor}${commentFilterSuffix}`, pos)) {\n            pos -= commentFilterSuffix.length + 1;\n            filter = filter ? commentFilterSuffix + ',' + filter : commentFilterSuffix;\n        }\n        else if (text.endsWith(`${filterDelimitor}${trimFilterSuffix}`, pos)) {\n            pos -= trimFilterSuffix.length + 1;\n            filter = filter ? trimFilterSuffix + ',' + filter : trimFilterSuffix;\n        }\n        else {\n            break;\n        }\n    }\n    return {\n        pos: pos,\n        filter: filter,\n    };\n}\n/**\n * Extracts abbreviation from the given position in the given document\n * @param model The TextModel from which abbreviation needs to be extracted\n * @param position The Position in the given document from where abbreviation needs to be extracted\n * @param options The options to pass to the @emmetio/extract-abbreviation module\n */\nfunction extractAbbreviation(monaco, model, position, options) {\n    const currentLine = model.getLineContent(position.lineNumber);\n    const currentLineTillPosition = currentLine.substr(0, position.column - 1);\n    const { pos, filter } = getFilters(currentLineTillPosition, position.column - 1);\n    const lengthOccupiedByFilter = filter ? filter.length + 1 : 0;\n    const result = extractAbbreviation$1(currentLine, pos, options);\n    if (!result)\n        return;\n    const rangeToReplace = new monaco.Range(position.lineNumber, result.location + 1, position.lineNumber, result.location + result.abbreviation.length + lengthOccupiedByFilter + 1);\n    return {\n        abbreviationRange: rangeToReplace,\n        abbreviation: result.abbreviation,\n        currentLineTillPosition,\n        filter,\n    };\n}\n/**\n * Returns a boolean denoting validity of given abbreviation in the context of given syntax\n * Not needed once https://github.com/emmetio/atom-plugin/issues/22 is fixed\n * @param syntax string\n * @param abbreviation string\n */\nfunction isAbbreviationValid(syntax, abbreviation) {\n    if (!abbreviation) {\n        return false;\n    }\n    if (isStyleSheet(syntax)) {\n        if (abbreviation.includes('#')) {\n            if (abbreviation.startsWith('#')) {\n                const hexColorRegex = /^#[\\d,a-f,A-F]{1,6}$/;\n                return hexColorRegex.test(abbreviation);\n            }\n            else if (commonlyUsedTags.includes(abbreviation.substring(0, abbreviation.indexOf('#')))) {\n                return false;\n            }\n        }\n        return cssAbbreviationRegex.test(abbreviation);\n    }\n    if (abbreviation.startsWith('!')) {\n        return !/[^!]/.test(abbreviation);\n    }\n    // Its common for users to type (sometextinsidebrackets), this should not be treated as an abbreviation\n    // Grouping in abbreviation is valid only if it's inside a text node or preceeded/succeeded with one of the symbols for nesting, sibling, repeater or climb up\n    // Also, cases such as `span[onclick=\"alert();\"]` are valid\n    if ((/\\(/.test(abbreviation) || /\\)/.test(abbreviation)) &&\n        !/\\{[^\\}\\{]*[\\(\\)]+[^\\}\\{]*\\}(?:[>\\+\\*\\^]|$)/.test(abbreviation) &&\n        !/\\(.*\\)[>\\+\\*\\^]/.test(abbreviation) &&\n        !/\\[[^\\[\\]\\(\\)]+=\".*\"\\]/.test(abbreviation) &&\n        !/[>\\+\\*\\^]\\(.*\\)/.test(abbreviation)) {\n        return false;\n    }\n    if (syntax === 'jsx') {\n        return jsxAbbreviationStartRegex.test(abbreviation) && htmlAbbreviationRegex.test(abbreviation);\n    }\n    return htmlAbbreviationStartRegex.test(abbreviation) && htmlAbbreviationRegex.test(abbreviation);\n}\nfunction isExpandedTextNoise(syntax, abbreviation, expandedText, options) {\n    var _a, _b;\n    // Unresolved css abbreviations get expanded to a blank property value\n    // Eg: abc -> abc: ; or abc:d -> abc: d; which is noise if it gets suggested for every word typed\n    if (isStyleSheet(syntax) && options) {\n        const between = (_a = options['stylesheet.between']) !== null && _a !== void 0 ? _a : ': ';\n        const after = (_b = options['stylesheet.after']) !== null && _b !== void 0 ? _b : ';';\n        // Remove overlapping between `abbreviation` and `between`, if any\n        let endPrefixIndex = abbreviation.indexOf(between[0], Math.max(abbreviation.length - between.length, 0));\n        endPrefixIndex = endPrefixIndex >= 0 ? endPrefixIndex : abbreviation.length;\n        const abbr = abbreviation.substring(0, endPrefixIndex);\n        return (expandedText === `${abbr}${between}\\${0}${after}` ||\n            expandedText.replace(/\\s/g, '') === abbreviation.replace(/\\s/g, '') + after);\n    }\n    // we don't want common html tags suggested for xml\n    if (syntax === 'xml' && commonlyUsedTags.some((tag) => tag.startsWith(abbreviation.toLowerCase()))) {\n        return true;\n    }\n    if (commonlyUsedTags.includes(abbreviation.toLowerCase()) || markupSnippetKeys.includes(abbreviation)) {\n        return false;\n    }\n    // Custom tags can have - or :\n    if (/[-,:]/.test(abbreviation) && !/--|::/.test(abbreviation) && !abbreviation.endsWith(':')) {\n        return false;\n    }\n    // Its common for users to type some text and end it with period, this should not be treated as an abbreviation\n    // Else it becomes noise.\n    // When user just types '.', return the expansion\n    // Otherwise emmet loses change to participate later\n    // For example in `.foo`. See https://github.com/Microsoft/vscode/issues/66013\n    if (abbreviation === '.') {\n        return false;\n    }\n    const dotMatches = abbreviation.match(/^([a-z,A-Z,\\d]*)\\.$/);\n    if (dotMatches) {\n        // Valid html tags such as `div.`\n        if (dotMatches[1] && htmlData.tags.includes(dotMatches[1])) {\n            return false;\n        }\n        return true;\n    }\n    // Fix for https://github.com/microsoft/vscode/issues/89746\n    // PascalCase tags are common in jsx code, which should not be treated as noise.\n    // Eg: MyAwesomComponent -> <MyAwesomComponent></MyAwesomComponent>\n    if (syntax === 'jsx' && /^([A-Z][A-Za-z0-9]*)+$/.test(abbreviation)) {\n        return false;\n    }\n    // Unresolved html abbreviations get expanded as if it were a tag\n    // Eg: abc -> <abc></abc> which is noise if it gets suggested for every word typed\n    return expandedText.toLowerCase() === `<${abbreviation.toLowerCase()}>\\${1}</${abbreviation.toLowerCase()}>`;\n}\n/**\n * Returns options to be used by emmet\n */\nfunction getExpandOptions(syntax, filter) {\n    var _a;\n    const filters = filter ? filter.split(',').map((x) => x.trim()) : [];\n    const bemEnabled = filters.includes('bem');\n    const commentEnabled = filters.includes('c');\n    const combinedOptions = {\n        'output.formatSkip': ['html'],\n        'output.formatForce': ['body'],\n        'output.field': emmetSnippetField,\n        'output.inlineBreak': 0,\n        'output.compactBoolean': false,\n        'output.reverseAttributes': false,\n        'markup.href': true,\n        'comment.enabled': commentEnabled,\n        'comment.trigger': ['id', 'class'],\n        'comment.before': '',\n        'comment.after': '\\n<!-- /[#ID][.CLASS] -->',\n        'bem.enabled': bemEnabled,\n        'bem.element': '__',\n        'bem.modifier': '_',\n        'jsx.enabled': syntax === 'jsx',\n        'stylesheet.shortHex': true,\n        'stylesheet.between': syntax === 'stylus' ? ' ' : ': ',\n        'stylesheet.after': syntax === 'sass' || syntax === 'stylus' ? '' : ';',\n        'stylesheet.intUnit': 'px',\n        'stylesheet.floatUnit': 'em',\n        'stylesheet.unitAliases': {\n            e: 'em',\n            p: '%',\n            x: 'ex',\n            r: 'rem',\n        },\n        'stylesheet.fuzzySearchMinScore': 0.3,\n        'output.format': true,\n        'output.selfClosingStyle': 'html',\n    };\n    const type = getSyntaxType(syntax);\n    const baseSyntax = getDefaultSyntax(syntax);\n    const snippets = type === 'stylesheet'\n        ? (_a = customSnippetsRegistry[syntax]) !== null && _a !== void 0 ? _a : customSnippetsRegistry[baseSyntax]\n        : customSnippetsRegistry[syntax];\n    return {\n        type,\n        options: combinedOptions,\n        variables: {},\n        snippets,\n        syntax,\n        // context: null,\n        text: undefined,\n        maxRepeat: 1000,\n        // cache: null\n    };\n}\n/**\n * Assigns snippets from one snippet file under emmet.extensionsPath to\n * customSnippetsRegistry, snippetKeyCache, and stylesheetCustomSnippetsKeyCache\n */\nfunction registerCustomSnippets(syntax, customSnippets) {\n    const baseSyntax = getDefaultSyntax(syntax);\n    if (baseSyntax !== syntax && customSnippetsRegistry[baseSyntax]) {\n        customSnippets = Object.assign({}, customSnippetsRegistry[baseSyntax], customSnippets);\n    }\n    if (isStyleSheet(syntax)) {\n        const prevSnippetKeys = stylesheetCustomSnippetsKeyCache.get(syntax);\n        const mergedSnippetKeys = Object.assign([], prevSnippetKeys, Object.keys(customSnippets));\n        stylesheetCustomSnippetsKeyCache.set(syntax, mergedSnippetKeys);\n    }\n    const prevSnippetsRegistry = customSnippetsRegistry[syntax];\n    const mergedSnippets = Object.assign({}, prevSnippetsRegistry, customSnippets);\n    customSnippetsRegistry[syntax] = mergedSnippets;\n}\n/**\n * Expands given abbreviation using given options\n * @param abbreviation string or parsed abbreviation\n * @param config options used by the @emmetio/expand-abbreviation module to expand given abbreviation\n */\nfunction expandAbbreviation(abbreviation, config) {\n    let expandedText;\n    const resolvedConfig = resolveConfig(config);\n    if (config.type === 'stylesheet') {\n        if (typeof abbreviation === 'string') {\n            expandedText = expandAbbreviation$1(abbreviation, resolvedConfig);\n        }\n        else {\n            expandedText = css(abbreviation, resolvedConfig);\n        }\n    }\n    else {\n        if (typeof abbreviation === 'string') {\n            expandedText = expandAbbreviation$1(abbreviation, resolvedConfig);\n        }\n        else {\n            expandedText = stringify(abbreviation, resolvedConfig);\n        }\n    }\n    return escapeNonTabStopDollar(addFinalTabStop(expandedText));\n}\n\nfunction isValidEmmetToken(tokens, index, syntax, language) {\n    const currentTokenType = tokens[index].type;\n    if (syntax === 'html') {\n        // prevent emmet triggered within attributes\n        return ((currentTokenType === '' && (index === 0 || tokens[index - 1].type === 'delimiter.html')) ||\n            // #7 compatible with https://github.com/NeekSandhu/monaco-textmate\n            tokens[0].type === 'text.html.basic');\n    }\n    if (syntax === 'css') {\n        if (currentTokenType === '')\n            return true;\n        // less / scss allow nesting\n        return currentTokenType === 'tag.' + language;\n    }\n    if (syntax === 'jsx') {\n        // type must be `identifier` and not at start\n        return (!!index &&\n            ['identifier.js', 'type.identifier.js', 'identifier.ts', 'type.identifier.ts'].includes(currentTokenType));\n    }\n    return false;\n}\nconst tokenEnvCache = new WeakMap();\nfunction getTokenizationEnv(model) {\n    if (tokenEnvCache.has(model))\n        return tokenEnvCache.get(model);\n    let _tokenization = \n    // monaco-editor < 0.34.0\n    model._tokenization ||\n        // monaco-editor 0.34.0\n        model.tokenization._tokenization;\n    // monaco-editor <= 0.34.0\n    let _tokenizationStateStore = _tokenization === null || _tokenization === void 0 ? void 0 : _tokenization._tokenizationStateStore;\n    // monaco-editor >= 0.35.0\n    if (!_tokenization || !_tokenizationStateStore) {\n        const _t = model.tokenization;\n        if (_t.grammarTokens) {\n            // monaco-editor >= 0.37.0\n            _tokenization = _t.grammarTokens._defaultBackgroundTokenizer;\n            _tokenizationStateStore = _tokenization._tokenizerWithStateStore;\n        }\n        else {\n            // monaco-editor >= 0.35.0 && < 0.37.0, source code was minified\n            Object.values(_t).some((val) => (_tokenization = val.tokenizeViewport && val));\n            Object.values(_tokenization).some((val) => (_tokenizationStateStore = val.tokenizationSupport && val));\n        }\n    }\n    const _tokenizationSupport = \n    // monaco-editor >= 0.32.0\n    _tokenizationStateStore.tokenizationSupport ||\n        // monaco-editor < 0.32.0\n        _tokenization._tokenizationSupport;\n    const env = {\n        _stateStore: _tokenizationStateStore,\n        _support: _tokenizationSupport,\n    };\n    tokenEnvCache.set(model, env);\n    return env;\n}\n// vscode did a complex node analysis, we just use monaco's built-in tokenizer\n// to achieve almost the same effect\nfunction isValidLocationForEmmetAbbreviation(model, position, syntax, language) {\n    var _a;\n    const { column, lineNumber } = position;\n    // get current line's tokens\n    const { _stateStore, _support } = getTokenizationEnv(model);\n    // monaco-editor < 0.37.0 uses `getBeginState` while monaco-editor >= 0.37.0 uses `getStartState`\n    // note: lineNumber difference between two api\n    const state = ((_a = _stateStore.getBeginState) === null || _a === void 0 ? void 0 : _a.call(_stateStore, lineNumber - 1).clone()) || _stateStore.getStartState(lineNumber).clone();\n    const tokenizationResult = _support.tokenize(model.getLineContent(lineNumber), true, state, 0);\n    const tokens = tokenizationResult.tokens;\n    let valid = false;\n    // get token type at current column\n    for (let i = tokens.length - 1; i >= 0; i--) {\n        if (column - 1 > tokens[i].offset) {\n            valid = isValidEmmetToken(tokens, i, syntax, language);\n            break;\n        }\n    }\n    return valid;\n}\n\n// https://github.com/microsoft/vscode/blob/main/extensions/emmet/src/util.ts#L86\nconst LANGUAGE_MODES = {\n    html: ['!', '.', '}', ':', '*', '$', ']', '/', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    jade: ['!', '.', '}', ':', '*', '$', ']', '/', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    slim: ['!', '.', '}', ':', '*', '$', ']', '/', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    haml: ['!', '.', '}', ':', '*', '$', ']', '/', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    xml: ['.', '}', '*', '$', ']', '/', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    xsl: ['!', '.', '}', '*', '$', '/', ']', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    css: [':', '!', '-', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    scss: [':', '!', '-', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    sass: [':', '!', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    less: [':', '!', '-', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    stylus: [':', '!', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    javascript: ['!', '.', '}', '*', '$', ']', '/', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n    typescript: ['!', '.', '}', '*', '$', ']', '/', '>', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n};\n// https://github.com/microsoft/vscode/blob/main/extensions/emmet/src/util.ts#L124\nconst MAPPED_MODES = {\n    handlebars: 'html',\n    php: 'html',\n    twig: 'html',\n};\nconst DEFAULT_CONFIG = {\n    showExpandedAbbreviation: 'always',\n    showAbbreviationSuggestions: true,\n    showSuggestionsAsSnippets: false,\n};\n/**\n * add completion provider\n * @param monaco monaco self\n * @param language added language\n * @param isMarkup is markup language\n * @param isLegalToken check whether given token is legal or not\n * @param getLegalEmmetSets get legal emmet substring from a string.\n */\nfunction registerProvider(monaco, languages, syntax) {\n    if (!monaco) {\n        console.error(\"emmet-monaco-es: 'monaco' should be either declared on window or passed as first parameter\");\n        return;\n    }\n    const providers = languages.map((language) => monaco.languages.registerCompletionItemProvider(language, {\n        triggerCharacters: LANGUAGE_MODES[MAPPED_MODES[language] || language],\n        provideCompletionItems: (model, position) => isValidLocationForEmmetAbbreviation(model, position, syntax, language)\n            ? doComplete(monaco, model, position, syntax, DEFAULT_CONFIG)\n            : undefined,\n    }));\n    return () => {\n        providers.forEach((provider) => provider.dispose());\n    };\n}\nfunction emmetHTML(monaco = window.monaco, languages = ['html']) {\n    return registerProvider(monaco, languages, 'html');\n}\nfunction emmetCSS(monaco = window.monaco, languages = ['css']) {\n    return registerProvider(monaco, languages, 'css');\n}\nfunction emmetJSX(monaco = window.monaco, languages = ['javascript']) {\n    return registerProvider(monaco, languages, 'jsx');\n}\n\nexport { emmetCSS, emmetHTML, emmetJSX, expandAbbreviation, registerCustomSnippets };\n", "import { IDisposable } from \"monaco-editor\";\nimport { PackageFrontendConfiguration } from \"../manifest\";\n\nexport const registerDocumentationForFusionObjects = (\n    monaco: typeof import(\"monaco-editor\"),\n    fusionObjects: PackageFrontendConfiguration[\"afx\"][\"fusionObjects\"],\n    languageId: string\n): IDisposable | undefined => {\n    const fusionObjectsWithDoc = Object.entries(fusionObjects)\n        .filter(([, { documentation }]) => documentation)\n        .map(([name]) => name);\n\n    if (!fusionObjectsWithDoc.length) {\n        return;\n    }\n\n    // - we look at the current line\n    //      and and use a from all fusionObjects composed regex\n    //      too see if there were any matches\n    // - for each map we look if it is in range of the mouse cursor.\n    // - if so we return a doc note for the fusionObject\n\n    const regex = new RegExp(`<(${fusionObjectsWithDoc.join(\"|\")})\\\\b`, \"g\");\n\n    return monaco.languages.registerHoverProvider(languageId, {\n        provideHover(model, position) {\n            const currentLine = position.lineNumber;\n            const currentCursor = position.column;\n\n            const line = model.getLineContent(currentLine);\n            if (line.trim() === \"\") {\n                return null;\n            }\n\n            const matches = line.matchAll(regex);\n\n            for (const match of matches) {\n                const [, matchedTag] = match;\n                const startPosition = match.index! + 1 + 1; // +1 to remove < // +1 to convert to column\n                const endPosition = startPosition + matchedTag.length;\n                // is in range?\n                if (\n                    currentCursor >= startPosition &&\n                    currentCursor <= endPosition\n                ) {\n                    return {\n                        range: new monaco.Range(\n                            currentLine,\n                            startPosition,\n                            currentLine,\n                            endPosition\n                        ),\n                        contents: [\n                            {\n                                value: fusionObjects[matchedTag].documentation!,\n                            },\n                        ],\n                    };\n                }\n            }\n            return null;\n        },\n    });\n};\n", "import type * as Monaco from 'monaco-editor'\n\ninterface Token {\n  readonly offset: number\n  readonly type: string\n  readonly language: string\n}\n\nfunction isValidEmmetToken(tokens: Token[], index: number, syntax: string, language: string): boolean {\n  const currentTokenType = tokens[index].type\n\n  if (syntax === 'html') {\n    // prevent emmet triggered within attributes\n    return (\n      (currentTokenType === '' && (index === 0 || tokens[index - 1].type === 'delimiter.html')) ||\n      // #7 compatible with https://github.com/NeekSandhu/monaco-textmate\n      tokens[0].type === 'text.html.basic'\n    )\n  }\n\n  if (syntax === 'css') {\n    if (currentTokenType === '') return true\n    // less / scss allow nesting\n    return currentTokenType === 'tag.' + language\n  }\n\n  if (syntax === 'jsx') {\n    // type must be `identifier` and not at start\n    return (\n      !!index &&\n      ['identifier.js', 'type.identifier.js', 'identifier.ts', 'type.identifier.ts'].includes(currentTokenType)\n    )\n  }\n\n  return false\n}\n\nconst tokenEnvCache = new WeakMap<any, { _stateStore: any; _support: any }>()\nfunction getTokenizationEnv(model: any) {\n  if (tokenEnvCache.has(model)) return tokenEnvCache.get(model)!\n\n  let _tokenization =\n    // monaco-editor < 0.34.0\n    model._tokenization ||\n    // monaco-editor 0.34.0\n    model.tokenization._tokenization\n\n  // monaco-editor <= 0.34.0\n  let _tokenizationStateStore = _tokenization?._tokenizationStateStore\n\n  // monaco-editor >= 0.35.0\n  if (!_tokenization || !_tokenizationStateStore) {\n    const _t = model.tokenization\n\n    if (_t.grammarTokens) {\n      // monaco-editor >= 0.37.0\n      _tokenization = _t.grammarTokens._defaultBackgroundTokenizer\n      _tokenizationStateStore = _tokenization._tokenizerWithStateStore\n    } else {\n      // monaco-editor >= 0.35.0 && < 0.37.0, source code was minified\n      Object.values(_t).some((val: any) => (_tokenization = val.tokenizeViewport && val))\n      Object.values(_tokenization).some((val: any) => (_tokenizationStateStore = val.tokenizationSupport && val))\n    }\n  }\n\n  const _tokenizationSupport =\n    // monaco-editor >= 0.32.0\n    _tokenizationStateStore.tokenizationSupport ||\n    // monaco-editor < 0.32.0\n    _tokenization._tokenizationSupport\n\n  const env = {\n    _stateStore: _tokenizationStateStore,\n    _support: _tokenizationSupport,\n  }\n\n  tokenEnvCache.set(model, env)\n  return env\n}\n\n// vscode did a complex node analysis, we just use monaco's built-in tokenizer\n// to achieve almost the same effect\nexport function isValidLocationForEmmetAbbreviation(\n  model: Monaco.editor.ITextModel,\n  position: Monaco.Position,\n  syntax: string,\n  language: string,\n) {\n  const { column, lineNumber } = position\n\n  // get current line's tokens\n  const { _stateStore, _support } = getTokenizationEnv(model)\n  // monaco-editor < 0.37.0 uses `getBeginState` while monaco-editor >= 0.37.0 uses `getStartState`\n  // note: lineNumber difference between two api\n  const state = _stateStore.getBeginState?.(lineNumber - 1).clone() || _stateStore.getStartState(lineNumber).clone()\n  const tokenizationResult = _support.tokenize(model.getLineContent(lineNumber), true, state, 0)\n  const tokens: Token[] = tokenizationResult.tokens\n\n  let valid = false\n\n  // get token type at current column\n  for (let i = tokens.length - 1; i >= 0; i--) {\n    if (column - 1 > tokens[i].offset) {\n      valid = isValidEmmetToken(tokens, i, syntax, language)\n\n      break\n    }\n  }\n\n  return valid\n}\n", "import { IDisposable } from \"monaco-editor\";\nimport { PackageFrontendConfiguration } from \"../manifest\";\n// not api see https://github.com/troy351/emmet-monaco-es/issues/102\nimport { isValidLocationForEmmetAbbreviation } from \"emmet-monaco-es/src/abbreviationActions\";\n\nexport const registerCompletionForFusionObjects = (\n    monaco: typeof import(\"monaco-editor\"),\n    fusionObjects: PackageFrontendConfiguration[\"afx\"][\"fusionObjects\"],\n    languageId: string\n): IDisposable | undefined => {\n    const fusionObjectsWithSnippet = Object.entries(fusionObjects).filter(\n        ([, { snippet }]) => snippet\n    );\n\n    if (!fusionObjectsWithSnippet.length) {\n        return;\n    }\n\n    return monaco.languages.registerCompletionItemProvider(languageId, {\n        triggerCharacters: [\n            \"!\",\n            \".\",\n            \"}\",\n            \":\",\n            \"*\",\n            \"$\",\n            \"]\",\n            \"/\",\n            \">\",\n            \"0\",\n            \"1\",\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\",\n            \"6\",\n            \"7\",\n            \"8\",\n            \"9\",\n        ],\n        provideCompletionItems(model, position) {\n            const word = model.getWordUntilPosition(position);\n\n            const range = {\n                startLineNumber: position.lineNumber,\n                endLineNumber: position.lineNumber,\n                startColumn: word.startColumn,\n                endColumn: word.endColumn,\n            };\n\n            if (\n                !isValidLocationForEmmetAbbreviation(\n                    model,\n                    position,\n                    \"html\",\n                    \"html\"\n                )\n            ) {\n                return;\n            }\n\n            return {\n                suggestions: fusionObjectsWithSnippet.map(\n                    ([label, { documentation, snippet }]) => ({\n                        label,\n                        range,\n                        insertText: snippet!,\n                        insertTextRules:\n                            monaco.languages.CompletionItemInsertTextRule\n                                .InsertAsSnippet,\n                        kind: monaco.languages.CompletionItemKind.Snippet,\n                        documentation,\n                    })\n                ),\n            };\n        },\n    });\n};\n", "import { PackageFrontendConfiguration } from \"../manifest\";\nimport * as monaco from \"monaco-editor\";\nimport {\n    configureMonacoTailwindcss,\n    MonacoTailwindcss,\n} from \"monaco-tailwindcss\";\nimport { emmetHTML, emmetCSS } from \"emmet-monaco-es\";\nimport {\n    conf as htmlConf,\n    language as htmlLanguage,\n    // @ts-expect-error\n} from \"monaco-editor/esm/vs/basic-languages/html/html\";\nimport { registerDocumentationForFusionObjects } from \"./registerDocumentationForFusionObjects\";\nimport { registerCompletionForFusionObjects } from \"./registerCompletionForFusionObjects\";\nimport { afxMappedLanguageId } from \"./afxMappedLanguageId\";\n\ndeclare global {\n    interface Window {\n        MonacoEnvironment?: monaco.Environment;\n    }\n}\n\nexport const initializeMonacoFromConfig = (\n    packageConfig: PackageFrontendConfiguration\n): {\n    monaco: typeof monaco;\n    monacoTailwindCss?: MonacoTailwindcss;\n} => {\n    window.MonacoEnvironment = {\n        getWorkerUrl(_workerId, label) {\n            switch (label) {\n                case \"json\":\n                    return new URL(\"json.worker.js\", import.meta.url).pathname;\n                case \"css\":\n                case \"scss\":\n                case \"less\":\n                    return new URL(\"css.worker.js\", import.meta.url).pathname;\n                case \"html\":\n                case \"handlebars\":\n                    return new URL(\"html.worker.js\", import.meta.url).pathname;\n                case \"typescript\":\n                case \"javascript\":\n                    return new URL(\"ts.worker.js\", import.meta.url).pathname;\n                case \"editorWorkerService\":\n                    return new URL(\"editor.worker.js\", import.meta.url)\n                        .pathname;\n                case \"tailwindcss\":\n                    return new URL(\n                        \"configTailwindcss.worker.js\",\n                        import.meta.url\n                    ).pathname;\n                default:\n                    throw new Error(`Unknown label ${label}`);\n            }\n        },\n    };\n\n    monaco.languages.register({\n        id: afxMappedLanguageId,\n        extensions: [\".afx\"],\n        aliases: [\"AFX\", \"afx\"],\n        mimetypes: [\"text/html\"],\n    });\n\n    monaco.languages.registerTokensProviderFactory(afxMappedLanguageId, {\n        create() {\n            return htmlLanguage;\n        },\n    });\n    monaco.languages.setLanguageConfiguration(afxMappedLanguageId, htmlConf);\n\n    const fusionObjectsConfig = packageConfig.afx.fusionObjects;\n    registerDocumentationForFusionObjects(\n        monaco,\n        fusionObjectsConfig,\n        afxMappedLanguageId\n    );\n    registerCompletionForFusionObjects(\n        monaco,\n        fusionObjectsConfig,\n        afxMappedLanguageId\n    );\n\n    let monacoTailwindCss: MonacoTailwindcss | undefined;\n\n    if (packageConfig.tailwindcss.enabled) {\n        monacoTailwindCss = configureMonacoTailwindcss(monaco, {\n            languageSelector: [\"html\", afxMappedLanguageId],\n            // configTailwindcss.worker.ts handles the input.\n            tailwindConfig: packageConfig.tailwindcss.clientConfig,\n        });\n    }\n\n    emmetHTML(monaco, [\"html\", afxMappedLanguageId]);\n    emmetCSS(monaco, [\"css\", \"scss\", \"less\"]);\n\n    return {\n        monaco,\n        monacoTailwindCss,\n    };\n};\n"],
  "mappings": "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",
  "names": ["__decorate", "__param", "TreeElement", "OutlineElement", "OutlineGroup", "OutlineModel", "IOutlineModelService", "OutlineModelService", "init_outlineModel", "__esmMin", "init_arrays", "init_cancellation", "init_errors", "init_iterator", "init_map", "init_position", "init_range", "init_languageFeatureDebounce", "init_instantiation", "init_extensions", "init_model", "init_lifecycle", "init_languageFeatures", "decorators", "target", "key", "desc", "c", "d", "i", "paramIndex", "decorator", "_a", "candidate", "container", "candidateId", "id", "element", "parent", "symbol", "label", "order", "registry", "textModel", "token", "cts", "CancellationTokenSource", "result", "provider", "promises", "index", "group", "info", "err", "onUnexpectedExternalError", "listener", "newProvider", "equals", "res", "childInfo", "uri", "count", "Iterable", "child", "roots", "a", "b", "Range", "bucket", "Position", "entries", "overrideContainerLabel", "entry", "createDecorator", "_languageFeaturesService", "debounces", "modelService", "DisposableStore", "LRUCache", "data", "source", "now", "outlineModel", "_err", "ILanguageFeaturesService", "ILanguageFeatureDebounceService", "IModelService", "registerSingleton", "InPlaceReplaceCommand", "init_inPlaceReplaceCommand", "__esmMin", "init_selection", "editRange", "originalSelection", "text", "model", "builder", "helper", "srcRange", "Selection", "require_inPlaceReplace", "__commonJSMin", "exports", "init_async", "init_errors", "init_editorState", "init_editorExtensions", "init_range", "init_selection", "init_editorContextKeys", "init_textModel", "init_editorWorker", "init_nls", "init_inPlaceReplaceCommand", "init_", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InPlaceReplaceController_1", "InPlaceReplaceController", "editor", "editorWorkerService", "source", "up", "_a", "editorSelection", "model", "selection", "state", "EditorState", "modelURI", "createCancelablePromise", "token", "result", "editRange", "Range", "highlightRange", "diff", "Selection", "command", "InPlaceReplaceCommand", "timeout", "onUnexpectedError", "ModelDecorationOptions", "IEditorWorkerService", "InPlaceReplaceUp", "EditorAction", "localize", "EditorContextKeys", "accessor", "controller", "InPlaceReplaceDown", "registerEditorContribution", "registerEditorAction", "require_contribution", "__commonJSMin", "exports", "init_arrays", "init_observable", "init_hideUnchangedRegionsFeature", "init_utils", "init_languageFeatures", "init_outlineModel", "init_lifecycle", "init_event", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "DiffEditorBreadcrumbsSource", "Disposable", "_textModel", "_languageFeaturesService", "_outlineModelService", "observableValue", "documentSymbolProviderChanged", "observableSignalFromEvent", "textModelChanged", "Event", "e", "autorunWithStore", "reader", "store", "src", "DisposableCancellationTokenSource", "model", "startRange", "m", "symbols", "s", "reverseOrder", "compareBy", "numberComparator", "ILanguageFeaturesService", "IOutlineModelService", "HideUnchangedRegionsFeature", "textModel", "instantiationService", "require_inspectTokens", "__commonJSMin", "exports", "init_", "init_dom", "init_color", "init_lifecycle", "init_editorExtensions", "init_languages", "init_encodedTokenAttributes", "init_nullTokenize", "init_language", "init_standaloneTheme", "init_standaloneStrings", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InspectTokensController_1", "InspectTokensController", "Disposable", "editor", "standaloneColorService", "languageService", "e", "TokenizationRegistry", "InspectTokensWidget", "IStandaloneThemeService", "ILanguageService", "InspectTokens", "EditorAction", "InspectTokensNLS", "accessor", "controller", "renderTokenText", "tokenText", "result", "charIndex", "len", "charCode", "getSafeTokenizationSupport", "languageIdCodec", "languageId", "tokenizationSupport", "encodedLanguageId", "NullState", "line", "hasEOL", "state", "nullTokenize", "nullTokenizeEncoded", "position", "data", "token1Index", "t", "token2Index", "lineContent", "tokenStartIndex", "tokenEndIndex", "reset", "$", "append", "metadata", "Color", "colorMap", "TokenMetadata", "tokenType", "fontStyle", "foreground", "background", "r", "lineNumber", "stateBeforeLine", "tokenizationResult1", "tokenizationResult2", "registerEditorContribution", "registerEditorAction", "editor_main_exports", "__export", "CancellationTokenSource", "Emitter", "KeyCode", "KeyMod", "MarkerSeverity", "MarkerTag", "Position", "Range", "Selection", "SelectionDirection", "Token", "Uri", "editor", "languages", "__defProp", "__getOwnPropDesc", "__getOwnPropNames", "__hasOwnProp", "__copyProps", "to", "from", "except", "desc", "key", "__reExport", "target", "mod", "secondTarget", "monaco_editor_core_exports", "editor_api_exports", "languageDefinitions", "lazyLanguageLoaders", "LazyLanguageLoader", "_LazyLanguageLoader", "languageId", "resolve", "reject", "err", "registerLanguage", "def", "languageId", "languageDefinitions", "monaco_editor_core_exports", "lazyLanguageLoader", "LazyLanguageLoader", "mod", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "registerLanguage", "__defProp", "__getOwnPropDesc", "__getOwnPropNames", "__hasOwnProp", "__copyProps", "to", "from", "except", "desc", "key", "__reExport", "target", "mod", "secondTarget", "monaco_editor_core_exports", "editor_api_exports", "LanguageServiceDefaultsImpl", "languageId", "options", "modeConfiguration", "optionsDefault", "modeConfigurationDefault", "cssDefaults", "scssDefaults", "lessDefaults", "getMode", "mode", "__defProp", "__getOwnPropDesc", "__getOwnPropNames", "__hasOwnProp", "__copyProps", "to", "from", "except", "desc", "key", "__reExport", "target", "mod", "secondTarget", "monaco_editor_core_exports", "editor_api_exports", "LanguageServiceDefaultsImpl", "languageId", "options", "modeConfiguration", "formatDefaults", "optionsDefault", "getConfigurationDefault", "htmlLanguageId", "handlebarsLanguageId", "razorLanguageId", "htmlLanguageService", "registerHTMLLanguageService", "htmlDefaults", "handlebarLanguageService", "handlebarDefaults", "razorLanguageService", "razorDefaults", "getMode", "defaults", "mode", "onLanguageListener", "LanguageServiceDefaultsImpl", "languageId", "diagnosticsOptions", "modeConfiguration", "Emitter", "options", "diagnosticDefault", "modeConfigurationDefault", "jsonDefaults", "getWorker", "getMode", "mode", "languages", "init_dom", "init_codicons", "init_editorExtensions", "init_codeEditorService", "init_editorContextKeys", "init_nls", "init_actions", "init_commands", "init_configuration", "init_contextkey", "ToggleCollapseUnchangedRegions", "Action2", "localize2", "Codicon", "ContextKeyExpr", "MenuId", "accessor", "args", "configurationService", "IConfigurationService", "newValue", "registerAction2", "ToggleShowMovedCodeBlocks", "ToggleUseInlineViewWhenSpaceIsLimited", "MenuRegistry", "localize", "EditorContextKeys", "ContextKeyEqualsExpr", "diffEditorCategory", "SwitchSide", "EditorAction2", "editor", "arg", "diffEditor", "findFocusedDiffEditor", "DiffEditorWidget", "ExitCompareMove", "CollapseAllUnchangedRegions", "ShowAllUnchangedRegions", "accessibleDiffViewerCategory", "AccessibleDiffViewerNext", "AccessibleDiffViewerPrev", "diffEditors", "ICodeEditorService", "activeElement", "getActiveElement", "d", "container", "isElementOrParentOf", "elementOrParent", "element", "e", "CommandsRegistry", "init_htmlContent", "init_keyCodes", "init_editorExtensions", "init_selection", "init_editorContextKeys", "init_nls", "init_contextkey", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SelectionAnchorController_1", "SelectionAnchorSet", "RawContextKey", "SelectionAnchorController", "editor", "contextKeyService", "position", "accessor", "Selection", "MarkdownString", "localize", "alert", "anchorPosition", "start", "end", "decorationId", "IContextKeyService", "SetSelectionAnchor", "EditorAction", "EditorContextKeys", "KeyChord", "_accessor", "_a", "GoToSelectionAnchor", "SelectFromAnchorToCursor", "CancelSelectionAnchor", "registerEditorContribution", "registerEditorAction", "init_async", "init_lifecycle", "init_editorExtensions", "init_position", "init_range", "init_selection", "init_editorContextKeys", "init_model", "init_textModel", "init_nls", "init_actions", "init_colorRegistry", "init_themeService", "overviewRulerBracketMatchForeground", "registerColor", "localize", "JumpToBracketAction", "EditorAction", "EditorContextKeys", "accessor", "editor", "_a", "BracketMatchingController", "SelectToBracketAction", "localize2", "args", "selectBrackets", "RemoveBracketsAction", "BracketsData", "position", "brackets", "options", "Disposable", "RunOnceScheduler", "e", "model", "newSelections", "selection", "newCursorPosition", "enclosingBrackets", "nextBracket", "Selection", "selectFrom", "selectTo", "Range", "open", "close", "tmp", "editSource", "newDecorations", "newDecorationsLen", "bracketData", "selections", "versionId", "previousData", "positions", "positionsLen", "i", "len", "Position", "newData", "newDataLen", "previousIndex", "previousLen", "ModelDecorationOptions", "themeColorFromId", "OverviewRulerLane", "registerEditorContribution", "registerEditorAction", "MenuRegistry", "MenuId", "init_editorExtensions", "init_editorContextKeys", "init_range", "init_selection", "MoveCaretCommand", "selection", "isMovingLeft", "model", "builder", "lineNumber", "startColumn", "endColumn", "rangeBefore", "Range", "charBefore", "rangeAfter", "charAfter", "helper", "Selection", "init_nls", "MoveCaretAction", "EditorAction", "left", "opts", "accessor", "editor", "commands", "selections", "selection", "MoveCaretCommand", "MoveCaretLeftAction", "localize", "EditorContextKeys", "MoveCaretRightAction", "registerEditorAction", "init_editorExtensions", "init_range", "init_editorContextKeys", "init_nls", "TransposeLettersAction", "EditorAction", "localize", "EditorContextKeys", "accessor", "editor", "model", "commands", "selections", "selection", "lineNumber", "column", "lastColumn", "endPosition", "MoveOperations", "middlePosition", "beginPosition", "leftChar", "Range", "rightChar", "replaceRange", "ReplaceCommand", "registerEditorAction", "init_browser", "init_dom", "init_platform", "init_editorExtensions", "init_codeEditorService", "init_editorContextKeys", "init_dom", "init_arrays", "init_async", "init_arrays", "init_iterator", "generateUuid", "getRandomValues", "bucket", "i", "_data", "_hex", "result", "createStringDataTransferItem", "stringOrPromise", "createFileDataTransferItem", "fileName", "uri", "data", "file", "generateUuid", "VSDataTransfer", "size", "_", "mimeType", "pattern", "mimes", "Iterable", "item", "matchesMimeType_normalized", "normalizeMimeType", "_a", "value", "existing", "mine", "items", "matchesMimeType", "mimeTypes", "normalizedPattern", "normalizedMimeTypes", "wildcard", "type", "subtype", "mime", "UriList", "entries", "distinct", "x", "str", "init_lifecycle", "init_mime", "init_platform", "init_mime", "init_uri", "init_platform", "CodeDataTransfers", "DragAndDropContributionRegistry", "Extensions", "Registry", "LocalSelectionTransfer", "proto", "toVSDataTransfer", "dataTransfer", "vsDataTransfer", "VSDataTransfer", "item", "type", "asStringValue", "resolve", "createStringDataTransferItem", "file", "createFileDataTransferItemFromFile", "uri", "URI", "createFileDataTransferItem", "INTERNAL_DND_MIME_TYPES", "CodeDataTransfers", "DataTransfers", "toExternalVSDataTransfer", "sourceDataTransfer", "overwriteUriList", "uriList", "Mimes", "editorData", "path", "UriList", "internal", "init_range", "init_languageFeatures", "Scanner", "ch", "value", "token", "pos", "len", "type", "Marker", "child", "Text", "others", "parent", "idx", "newChildren", "_fixParent", "children", "candidate", "TextmateSnippet", "prev", "cur", "TransformableMarker", "Placeholder", "a", "b", "index", "Choice", "ret", "marker", "Transform", "_this", "didMatch", "FormatString", "groups", "shorthandName", "ifValue", "elseValue", "match", "word", "Variable", "name", "resolver", "walk", "visitor", "stack", "all", "last", "found", "placeholder", "SnippetParser", "template", "insertFinalTabstop", "enforceFinalTabstop", "snippet", "offset", "placeholderDefaultValues", "incompletePlaceholders", "fillInIncompletePlaceholder", "defaultValues", "clone", "newChild", "p", "start", "nextToken", "choice", "values", "variable", "transform", "regexValue", "regexOptions", "escaped", "complex", "shorthand", "createCombinedWorkspaceEdit", "uri", "ranges", "edit", "_a", "_b", "_c", "_d", "range", "ResourceTextEdit", "SnippetParser", "sortEditsByYieldTo", "edits", "yieldsTo", "yTo", "other", "yieldsToMap", "arr", "visited", "tempStack", "visit", "nodes", "node", "pre", "init_editorState", "init_dom", "init_async", "init_codicons", "init_lifecycle", "init_strings", "init_themables", "init_range", "init_textModel", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "inlineProgressDecoration", "ModelDecorationOptions", "noBreakWhitespace", "InlineProgressWidget", "Disposable", "typeId", "editor", "range", "title", "delegate", "$", "iconElement", "ThemeIcon", "Codicon", "updateSize", "lineHeight", "addDisposableListener", "EventType", "e", "InlineProgressManager", "id", "_editor", "_instantiationService", "MutableDisposable", "position", "promise", "operationId", "disposableTimeout", "Range", "IInstantiationService", "init_nls", "init_contextkey", "init_instantiation", "init_dom", "init_actions", "init_event", "init_lifecycle", "init_contextkey", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "PostEditWidget_1", "PostEditWidget", "Disposable", "typeId", "editor", "visibleContext", "showCommand", "range", "edits", "onSelectNewEdit", "_contextMenuService", "contextKeyService", "_keybindingService", "toDisposable", "e", "Event", "_a", "binding", "$", "Button", "addDisposableListener", "EventType", "pos", "getDomNodePagePosition", "edit", "toAction", "IContextMenuService", "IContextKeyService", "IKeybindingService", "PostEditWidgetManager", "_id", "_editor", "_visibleContext", "_showCommand", "_instantiationService", "_bulkEditService", "MutableDisposable", "ranges", "canShowWidget", "token", "model", "combinedWorkspaceEdit", "createCombinedWorkspaceEdit", "primaryRange", "editTrackingDecoration", "editResult", "editRange", "newEditIndex", "onDidSelectEdit", "IInstantiationService", "IBulkEditService", "init_event", "init_htmlContent", "init_lifecycle", "init_editorExtensions", "init_range", "init_nls", "init_contextkey", "init_dom", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "MessageController_1", "MessageController", "editor", "contextKeyService", "_openerService", "MutableDisposable", "DisposableStore", "_a", "message", "position", "alert", "isMarkdownString", "renderMarkdown", "url", "openLinkFromMarkdown", "MessageWidget", "Event", "last", "event", "isAncestor", "getActiveElement", "addDisposableListener", "EventType", "bounds", "e", "Range", "RawContextKey", "localize", "IContextKeyService", "IOpenerService", "MessageCommand", "EditorCommand", "MessageController", "registerEditorCommand", "c", "MessageWidget", "messageWidget", "dispose", "handle", "editor", "lineNumber", "column", "text", "anchorTop", "message", "anchorBottom", "position", "registerEditorContribution", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "CopyPasteController_1", "changePasteTypeCommandId", "pasteWidgetVisibleCtx", "RawContextKey", "localize", "vscodeClipboardMime", "CopyPasteController", "Disposable", "editor", "instantiationService", "_bulkEditService", "_clipboardService", "_languageFeaturesService", "_quickInputService", "_progressService", "container", "addDisposableListener", "e", "InlineProgressManager", "PostEditWidgetManager", "preferredId", "getActiveDocument", "_a", "_b", "isWeb", "model", "selections", "enableEmptySelectionClipboard", "ranges", "wasFromEmptySelection", "Range", "toCopy", "isWindows", "defaultPastePayload", "providers", "x", "dataTransfer", "toVSDataTransfer", "providerCopyMimeTypes", "handle", "generateUuid", "promise", "createCancelablePromise", "token", "results", "coalesce", "provider", "err", "result", "mime", "value", "_c", "_d", "_e", "MessageController", "metadata", "toExternalVSDataTransfer", "allPotentialMimeTypes", "Mimes", "allProviders", "type", "matchesMimeType", "editId", "context", "p", "tokenSource", "EditorStateCancellationTokenSource", "supportedProviders", "isSupportedPasteProvider", "providerEdits", "canShowWidget", "edit", "pickedEdit", "selected", "combinedWorkspaceEdit", "createCombinedWorkspaceEdit", "rawMetadata", "_", "ClipboardEventUtils", "toMergeDataTransfer", "resources", "createStringDataTransferItem", "UriList", "raceCancellation", "edits", "sortEditsByYieldTo", "textDataTransfer", "text", "payload", "IInstantiationService", "IBulkEditService", "IClipboardService", "ILanguageFeaturesService", "IQuickInputService", "IProgressService", "isSupportedPasteProvider", "provider", "dataTransfer", "_a", "type", "init_nls", "init_actions", "init_contextkey", "CLIPBOARD_CONTEXT_MENU_GROUP", "supportsCut", "isNative", "supportsCopy", "supportsPaste", "isFirefox", "registerCommand", "command", "CutAction", "MultiCommand", "MenuId", "localize", "EditorContextKeys", "CopyAction", "MenuRegistry", "localize2", "ContextKeyExpr", "PasteAction", "ExecCommandCopyWithSyntaxHighlightingAction", "EditorAction", "accessor", "editor", "CopyOptions", "registerExecCommandImpl", "target", "browserCommand", "args", "focusedEditor", "ICodeEditorService", "emptySelectionClipboard", "selection", "getActiveDocument", "_a", "_b", "codeEditorService", "clipboardService", "IClipboardService", "CopyPasteController", "isWeb", "clipboardText", "metadata", "InMemoryClipboardMetadataManager", "pasteOnNewLine", "multicursorText", "mode", "registerEditorAction", "init_editorExtensions", "init_strings", "init_editorExtensions", "init_editorContextKeys", "init_arrays", "init_cancellation", "init_errors", "init_lifecycle", "init_uri", "init_range", "init_selection", "init_languageFeatures", "init_model", "init_editorState", "init_nls", "init_commands", "init_telemetry", "init_errors", "CodeActionKind", "value", "other", "part", "CodeActionTriggerSource", "mayIncludeActionsOfKind", "filter", "providedKind", "exclude", "excludesAction", "filtersAction", "action", "actionKind", "include", "CodeActionCommandArgs", "arg", "defaults", "defaultAutoApply", "defaultKind", "kind", "apply", "preferred", "CodeActionItem", "provider", "highlightRange", "token", "_a", "err", "onUnexpectedExternalError", "codeActionCommandId", "quickFixCommandId", "autoFixCommandId", "refactorCommandId", "sourceActionCommandId", "organizeImportsCommandId", "fixAllCommandId", "ManagedCodeActionSet", "Disposable", "a", "b", "isNonEmptyArray", "actions", "documentation", "disposables", "action", "fix", "CodeActionKind", "emptyCodeActionsResponse", "getCodeActions", "registry", "model", "rangeOrSelection", "trigger", "progress", "token", "_a", "filter", "notebookFilter", "codeActionContext", "cts", "TextModelCancellationTokenSource", "excludeNotebookCodeActions", "providers", "getCodeActionProviders", "DisposableStore", "promises", "provider", "providedCodeActions", "filteredActions", "filtersAction", "getDocumentationFromProvider", "CodeActionItem", "err", "isCancellationError", "onUnexpectedExternalError", "listener", "newProviders", "equals", "allActions", "x", "allDocumentation", "coalesce", "getAdditionalDocumentationForShowingActions", "kind", "mayIncludeActionsOfKind", "actionsToShow", "_b", "_c", "item", "only", "entry", "currentBest", "ApplyCodeActionReason", "applyCodeAction", "accessor", "codeActionReason", "options", "CancellationToken", "bulkEditService", "IBulkEditService", "commandService", "ICommandService", "telemetryService", "ITelemetryService", "notificationService", "INotificationService", "message", "asMessage", "localize", "CommandsRegistry", "resource", "itemResolveCount", "URI", "illegalArgument", "codeActionProvider", "ILanguageFeaturesService", "IModelService", "validatedRangeOrSelection", "Selection", "Range", "include", "codeActionSet", "CodeActionTriggerSource", "Progress", "resolving", "resolveCount", "i", "init_nls", "init_contextkey", "init_dom", "init_errors", "init_lazy", "init_lifecycle", "init_position", "init_textModel", "init_languageFeatures", "init_lazy", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "CodeActionKeybindingResolver_1", "CodeActionKeybindingResolver", "keybindingService", "allCodeActionBindings", "Lazy", "item", "commandArgs", "organizeImportsCommandId", "CodeActionKind", "fixAllCommandId", "CodeActionCommandArgs", "action", "binding", "candidates", "kind", "candidate", "currentBest", "refactorCommandId", "codeActionCommandId", "sourceActionCommandId", "IKeybindingService", "init_codicons", "init_nls", "init_colorRegistry", "SYMBOL_ICON_ARRAY_FOREGROUND", "registerColor", "foreground", "localize", "SYMBOL_ICON_BOOLEAN_FOREGROUND", "SYMBOL_ICON_CLASS_FOREGROUND", "SYMBOL_ICON_COLOR_FOREGROUND", "SYMBOL_ICON_CONSTANT_FOREGROUND", "SYMBOL_ICON_CONSTRUCTOR_FOREGROUND", "SYMBOL_ICON_ENUMERATOR_FOREGROUND", "SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND", "SYMBOL_ICON_EVENT_FOREGROUND", "SYMBOL_ICON_FIELD_FOREGROUND", "SYMBOL_ICON_FILE_FOREGROUND", "SYMBOL_ICON_FOLDER_FOREGROUND", "SYMBOL_ICON_FUNCTION_FOREGROUND", "SYMBOL_ICON_INTERFACE_FOREGROUND", "SYMBOL_ICON_KEY_FOREGROUND", "SYMBOL_ICON_KEYWORD_FOREGROUND", "SYMBOL_ICON_METHOD_FOREGROUND", "SYMBOL_ICON_MODULE_FOREGROUND", "SYMBOL_ICON_NAMESPACE_FOREGROUND", "SYMBOL_ICON_NULL_FOREGROUND", "SYMBOL_ICON_NUMBER_FOREGROUND", "SYMBOL_ICON_OBJECT_FOREGROUND", "SYMBOL_ICON_OPERATOR_FOREGROUND", "SYMBOL_ICON_PACKAGE_FOREGROUND", "SYMBOL_ICON_PROPERTY_FOREGROUND", "SYMBOL_ICON_REFERENCE_FOREGROUND", "SYMBOL_ICON_SNIPPET_FOREGROUND", "SYMBOL_ICON_STRING_FOREGROUND", "SYMBOL_ICON_STRUCT_FOREGROUND", "SYMBOL_ICON_TEXT_FOREGROUND", "SYMBOL_ICON_TYPEPARAMETER_FOREGROUND", "SYMBOL_ICON_UNIT_FOREGROUND", "SYMBOL_ICON_VARIABLE_FOREGROUND", "init_nls", "uncategorizedCodeActionGroup", "CodeActionKind", "localize", "codeActionGroups", "Codicon", "toMenuItems", "inputCodeActions", "showHeaders", "keybindingResolver", "action", "_a", "menuEntries", "group", "kind", "menuEntry", "allMenuItems", "init_dom", "init_codicons", "init_event", "init_lifecycle", "init_themables", "init_utils", "init_nls", "init_commands", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "LightBulbWidget_1", "LightBulbState", "Showing", "actions", "trigger", "editorPosition", "widgetPosition", "LightBulbWidget", "Disposable", "_editor", "_keybindingService", "commandService", "Emitter", "$", "Gesture", "_", "editorModel", "addStandardDisposableGenericMouseDownListener", "e", "top", "height", "getDomNodePagePosition", "lineHeight", "pad", "addDisposableListener", "Event", "_a", "_b", "_c", "_d", "autoFixCommandId", "quickFixCommandId", "atPosition", "model", "lineNumber", "column", "tabSize", "fontInfo", "lineContent", "indent", "computeIndentLevel", "lineHasSpace", "isFolded", "effectiveLineNumber", "effectiveColumnNumber", "value", "icon", "autoRun", "Codicon", "ThemeIcon", "autoFix", "localize", "IKeybindingService", "ICommandService", "init_nls", "init_dom", "init_lifecycle", "init_nls", "init_dom", "init_cancellation", "init_codicons", "init_lifecycle", "init_platform", "init_themables", "init_nls", "init_colorRegistry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "acceptSelectedActionCommand", "previewSelectedActionCommand", "HeaderRenderer", "container", "text", "element", "_index", "templateData", "_a", "_b", "_templateData", "ActionItemRenderer", "_supportsPreview", "_keybindingService", "icon", "keybinding", "KeybindingLabel", "OS", "data", "_c", "ThemeIcon", "asCssVariable", "Codicon", "stripNewlines", "setVisibility", "actionTitle", "previewTitle", "localize", "IKeybindingService", "AcceptSelectedEvent", "PreviewSelectedEvent", "getKeyboardNavigationLabel", "item", "ActionList", "Disposable", "user", "preview", "items", "_delegate", "_contextViewService", "CancellationTokenSource", "virtualDelegate", "List", "label", "e", "defaultListStyles", "didCancel", "minWidth", "numHeaders", "heightWithHeaders", "maxWidth", "itemWidths", "_", "index", "width", "maxVhPrecentage", "height", "focused", "focusIndex", "event", "result", "IContextViewService", "stripNewlines", "str", "init_actions", "init_contextkey", "init_extensions", "init_instantiation", "init_colorRegistry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "registerColor", "inputActiveOptionBackground", "localize", "ActionWidgetContextKeys", "RawContextKey", "IActionWidgetService", "createDecorator", "ActionWidgetService", "Disposable", "_contextViewService", "_contextKeyService", "_instantiationService", "MutableDisposable", "user", "supportsPreview", "items", "delegate", "anchor", "container", "actionBarActions", "visibleContext", "list", "ActionList", "didCancel", "preview", "_a", "_b", "element", "widget", "renderDisposables", "DisposableStore", "menuBlock", "block", "addDisposableListener", "EventType", "e", "pointerBlockDiv", "pointerBlock", "actionBarWidth", "actionBar", "width", "focusTracker", "trackFocus", "className", "actions", "$", "ActionBar", "IContextViewService", "IContextKeyService", "IInstantiationService", "registerSingleton", "weight", "registerAction2", "Action2", "localize2", "accessor", "widgetService", "acceptSelectedActionCommand", "previewSelectedActionCommand", "init_commands", "init_configuration", "init_contextkey", "init_instantiation", "init_colorRegistry", "init_theme", "init_themeService", "init_async", "init_errors", "init_event", "init_lifecycle", "init_resources", "init_position", "init_selection", "init_contextkey", "SUPPORTED_CODE_ACTIONS", "RawContextKey", "APPLY_FIX_ALL_COMMAND_ID", "CodeActionOracle", "Disposable", "_editor", "_markerService", "_signalChange", "_delay", "TimeoutTimer", "e", "trigger", "selection", "resources", "model", "resource", "isEqual", "CodeActionTriggerSource", "enabled", "ShowLightbulbIconMode", "lineNumber", "column", "line", "CodeActionsState", "Triggered", "position", "_cancellablePromise", "isCancellationError", "emptyCodeActionSet", "CodeActionModel", "_registry", "contextKeyService", "_progressService", "_configurationService", "MutableDisposable", "Emitter", "_a", "supportedActions", "provider", "startPosition", "actions", "createCancelablePromise", "token", "_b", "_c", "_d", "_e", "_f", "_g", "_h", "_j", "_k", "CodeActionKind", "codeActionSet", "getCodeActions", "Progress", "allCodeActions", "foundQuickfix", "action", "allMarkers", "arg", "marker", "currPosition", "trackedPosition", "distance", "currentActions", "col", "row", "startRow", "Position", "newCodeActionTrigger", "selectionAsPosition", "Selection", "actionsAtMarker", "filteredActions", "index", "self", "a", "b", "newState", "skipNotify", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "CodeActionController_1", "DECORATION_CLASS_NAME", "CodeActionController", "Disposable", "editor", "markerService", "contextKeyService", "instantiationService", "languageFeaturesService", "progressService", "_commandService", "_configurationService", "_actionWidgetService", "_instantiationService", "MutableDisposable", "CodeActionModel", "newState", "Lazy", "widget", "LightBulbWidget", "e", "CodeActionKeybindingResolver", "actions", "at", "actionItem", "command", "ApplyCodeActionReason", "_trigger", "notAvailableMessage", "triggerAction", "filter", "autoApply", "_a", "MessageController", "triggerPosition", "trigger", "action", "retrigger", "preview", "actionReason", "applyCodeAction", "CodeActionTriggerSource", "_b", "_c", "_d", "_e", "_f", "_g", "onUnexpectedError", "validActionToApply", "invalidAction", "includeDisabledActions", "options", "currentDecorations", "editorDom", "actionsToShow", "anchor", "Position", "delegate", "token", "ranges", "diagnostics", "decorations", "diagnostic", "range", "selectionText", "status", "localize", "toMenuItems", "position", "cursorCoords", "editorCoords", "getDomNodePagePosition", "x", "y", "model", "resultActions", "ModelDecorationOptions", "IMarkerService", "IContextKeyService", "IInstantiationService", "ILanguageFeaturesService", "IEditorProgressService", "ICommandService", "IConfigurationService", "IActionWidgetService", "registerThemingParticipant", "theme", "collector", "selector", "color", "editorFindMatchHighlight", "findMatchHighlightBorder", "editorFindMatchHighlightBorder", "isHighContrast", "contextKeyForSupportedActions", "kind", "ContextKeyExpr", "SUPPORTED_CODE_ACTIONS", "escapeRegExpCharacters", "argsSchema", "localize", "triggerCodeActionsForEditorSelection", "editor", "notAvailableMessage", "filter", "autoApply", "triggerAction", "CodeActionTriggerSource", "controller", "CodeActionController", "QuickFixAction", "EditorAction", "quickFixCommandId", "EditorContextKeys", "_accessor", "CodeActionCommand", "EditorCommand", "codeActionCommandId", "userArgs", "args", "CodeActionCommandArgs", "CodeActionKind", "RefactorAction", "refactorCommandId", "SourceAction", "sourceActionCommandId", "OrganizeImportsAction", "organizeImportsCommandId", "FixAllAction", "fixAllCommandId", "AutoFixAction", "autoFixCommandId", "init_nls", "init_configurationRegistry", "init_platform", "registerEditorContribution", "CodeActionController", "LightBulbWidget", "registerEditorAction", "QuickFixAction", "RefactorAction", "SourceAction", "OrganizeImportsAction", "AutoFixAction", "FixAllAction", "registerEditorCommand", "CodeActionCommand", "Registry", "Extensions", "editorConfigurationBaseNode", "localize", "init_async", "init_errors", "init_lifecycle", "init_editorExtensions", "init_editorContextKeys", "init_cancellation", "init_errors", "init_lifecycle", "init_types", "init_uri", "init_model", "init_commands", "init_languageFeatures", "CodeLensModel", "DisposableStore", "list", "provider", "symbol", "getCodeLensModel", "registry", "model", "token", "providerRanks", "result", "promises", "i", "err", "onUnexpectedExternalError", "b", "CommandsRegistry", "accessor", "args", "uri", "itemResolveCount", "assertType", "URI", "codeLensProvider", "ILanguageFeaturesService", "IModelService", "illegalArgument", "disposables", "CancellationToken", "value", "resolve", "item", "init_event", "init_map", "init_range", "init_extensions", "init_instantiation", "init_window", "init_dom", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ICodeLensCache", "createDecorator", "CacheItem", "lineCount", "data", "CodeLensCache", "storageService", "LRUCache", "oldkey", "runWhenWindowIdle", "mainWindow", "raw", "Event", "e", "WillSaveStateReason", "model", "copyItems", "item", "_a", "copyModel", "CodeLensModel", "value", "lines", "element", "lenses", "line", "Range", "IStorageService", "registerSingleton", "ICodeLensCache", "CodeLensCache", "init_dom", "init_iconLabels", "init_range", "init_textModel", "CodeLensViewZone", "afterLineNumber", "heightInPx", "onHeight", "height", "CodeLensContentWidget", "editor", "line", "lenses", "animate", "children", "hasSymbol", "i", "lens", "title", "renderLabelWithIcons", "id", "$", "reset", "link", "column", "CodeLensHelper", "decoration", "callback", "decorationId", "changeAccessor", "resultingDecorations", "len", "codeLensDecorationOptions", "ModelDecorationOptions", "CodeLensWidget", "data", "helper", "viewZoneChangeAccessor", "updateCallback", "range", "codeLensData", "Range", "symbol", "model", "symbols", "resolved", "_a", "init_nls", "init_commands", "init_languageFeatureDebounce", "init_languageFeatures", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "CodeLensContribution", "_editor", "_languageFeaturesService", "debounceService", "_commandService", "_notificationService", "_codeLensCache", "DisposableStore", "RunOnceScheduler", "e", "_a", "lineHeightFactor", "fontSize", "codeLensHeight", "fontFamily", "editorFontInfo", "style", "EDITOR_FONT_DEFAULTS", "accessor", "lens", "_b", "_c", "model", "cachedLenses", "disposableTimeout", "cachedLensesNow", "provider", "registration", "scheduler", "t1", "createCancelablePromise", "token", "getCodeLensModel", "result", "newDelay", "onUnexpectedError", "toDisposable", "decorationsAccessor", "viewZonesAccessor", "toDispose", "lastLensLineNumber", "helper", "CodeLensHelper", "l", "scrollState", "StableEditorScrollState", "command", "err", "decChangeAccessor", "viewZoneChangeAccessor", "symbols", "maxLineNumber", "groups", "lastGroup", "symbol", "line", "layoutInfo", "viewZoneAccessor", "codeLensIndex", "groupsIndex", "symbolsLineNumber", "codeLensLineNumber", "CodeLensWidget", "toResolve", "lenses", "request", "resolvePromise", "promises", "resolvedSymbols", "onUnexpectedExternalError", "ILanguageFeaturesService", "ILanguageFeatureDebounceService", "ICommandService", "INotificationService", "ICodeLensCache", "registerEditorContribution", "CodeLensContribution", "registerEditorAction", "EditorAction", "EditorContextKeys", "localize", "accessor", "editor", "quickInputService", "IQuickInputService", "commandService", "ICommandService", "notificationService", "INotificationService", "lineNumber", "codelensController", "model", "items", "lens", "item", "command", "newModel", "newLens", "_a", "err", "init_lifecycle", "init_editorExtensions", "init_range", "init_async", "init_color", "init_errors", "init_event", "init_lifecycle", "init_stopwatch", "init_strings", "init_editorExtensions", "init_range", "init_textModel", "init_languageFeatureDebounce", "init_languageFeatures", "init_cancellation", "init_errors", "init_uri", "init_range", "init_model", "init_commands", "init_languageFeatures", "init_color", "init_model", "init_languageConfigurationRegistry", "init_lifecycle", "init_languageFeatures", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "DefaultDocumentColorProvider", "modelService", "languageConfigurationService", "EditorWorkerClient", "model", "_token", "_model", "colorInfo", "range", "colorFromInfo", "alpha", "color", "Color", "RGBA", "rgb", "hsl", "hex", "colorPresentations", "DefaultDocumentColorProviderFeature", "Disposable", "_modelService", "_languageConfigurationService", "_languageFeaturesService", "IModelService", "ILanguageConfigurationService", "ILanguageFeaturesService", "registerEditorFeature", "init_configuration", "getColors", "colorProviderRegistry", "model", "token", "isDefaultColorDecoratorsEnabled", "_findColorData", "ColorDataCollector", "getColorPresentations", "colorInfo", "provider", "colors", "documentColors", "ExtColorDataCollector", "ColorPresentationsCollector", "_token", "CancellationToken", "collector", "validDocumentColorProviderFound", "defaultProvider", "colorData", "documentColorProviders", "i", "DefaultDocumentColorProvider", "e", "onUnexpectedExternalError", "_setupColorCommand", "accessor", "resource", "ILanguageFeaturesService", "IModelService", "illegalArgument", "IConfigurationService", "CommandsRegistry", "args", "URI", "color", "context", "uri", "range", "Range", "red", "green", "blue", "alpha", "init_configuration", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ColorDetector_1", "ColorDecorationInjectedTextMarker", "ColorDetector", "Disposable", "_editor", "_configurationService", "_languageFeaturesService", "languageFeatureDebounceService", "DisposableStore", "DynamicCssRules", "DecoratorLimitReporter", "e", "prevIsEnabled", "updatedColorDecoratorsSetting", "updatedDefaultColorDecoratorsSetting", "model", "languageId", "deprecatedConfig", "colorDecorators", "editor", "TimeoutTimer", "createCancelablePromise", "token", "sw", "StopWatch", "colors", "getColors", "onUnexpectedError", "colorDatas", "decorations", "ModelDecorationOptions", "changeAccessor", "id", "colorData", "limit", "red", "green", "blue", "alpha", "rgba", "RGBA", "color", "ref", "noBreakWhitespace", "limited", "position", "Range", "decoration", "IConfigurationService", "ILanguageFeaturesService", "ILanguageFeatureDebounceService", "DecoratorLimitReporter", "Emitter", "computed", "limited", "registerEditorContribution", "ColorDetector", "init_async", "init_cancellation", "init_color", "init_lifecycle", "init_range", "init_event", "ColorPickerModel", "color", "colorPresentations", "availableColorPresentations", "presentationIndex", "Emitter", "originalText", "i", "originalTextPrefix", "init_dom", "init_codicons", "init_color", "init_event", "init_lifecycle", "init_themables", "init_nls", "init_colorRegistry", "$", "ColorPickerHeader", "Disposable", "container", "model", "themeService", "showingStandaloneColorPicker", "append", "tooltip", "localize", "Color", "editorHoverBackground", "theme", "addDisposableListener", "EventType", "CloseButton", "color", "Emitter", "innerDiv", "ThemeIcon", "registerIcon", "Codicon", "ColorPickerBody", "pixelRatio", "isStandaloneColorPicker", "SaturationBox", "OpacityStrip", "HueStrip", "InsertButton", "s", "v", "hsva", "HSVA", "a", "value", "h", "e", "GlobalPointerMoveMonitor", "origin", "getDomNodePagePosition", "event", "pointerUpListener", "left", "top", "saturatedColor", "ctx", "whiteGradient", "blackGradient", "Strip", "monitor", "r", "g", "b", "opaque", "RGBA", "transparent", "ColorPickerWidget", "Widget", "standaloneColorPicker", "PixelRatio", "getWindow", "element", "init_themeService", "init_dom", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ColorHover", "owner", "range", "model", "provider", "anchor", "ColorHoverParticipant", "_editor", "_themeService", "_anchor", "_lineDecorations", "lineDecorations", "token", "AsyncIterableObject", "_token", "colorDetector", "ColorDetector", "colorData", "_createColorHover", "context", "hoverParts", "renderHoverParts", "IThemeService", "StandaloneColorPickerHover", "owner", "range", "model", "provider", "StandaloneColorPickerParticipant", "_editor", "_themeService", "defaultColorInfo", "defaultColorProvider", "colorProviderRegistry", "ColorDetector", "colors", "getColors", "CancellationToken", "foundColorInfo", "foundColorProvider", "colorData", "colorInfo", "Range", "colorProvider", "foundInEditor", "_createColorHover", "colorHoverData", "colorPickerModel", "_updateColorPresentations", "_updateEditorModel", "context", "hoverParts", "renderHoverParts", "color", "__decorate", "__param", "IThemeService", "_createColorHover", "participant", "editorModel", "colorInfo", "provider", "originalText", "red", "green", "blue", "alpha", "rgba", "RGBA", "color", "Color", "colorPresentations", "getColorPresentations", "CancellationToken", "model", "ColorPickerModel", "ColorHoverParticipant", "ColorHover", "Range", "StandaloneColorPickerHover", "renderHoverParts", "editor", "themeService", "hoverParts", "context", "Disposable", "minimumHeight", "Dimension", "disposables", "DisposableStore", "colorHover", "widget", "ColorPickerWidget", "StandaloneColorPickerParticipant", "editorUpdatedByColorPicker", "range", "_updateColorPresentations", "_updateEditorModel", "e", "_a", "_b", "textEdits", "edit", "replaceRange", "trackedRange", "colorPickerModel", "init_keyCodes", "init_lifecycle", "init_editorExtensions", "init_range", "init_editorContextKeys", "init_language", "init_async", "init_errors", "init_htmlContent", "init_lifecycle", "init_editorState", "init_editorExtensions", "init_range", "init_language", "init_resolverService", "init_event", "init_lifecycle", "init_platform", "hasModifier", "e", "modifier", "ClickLinkMouseEvent", "source", "opts", "ClickLinkKeyboardEvent", "ClickLinkOptions", "triggerKey", "triggerModifier", "triggerSideBySideKey", "triggerSideBySideModifier", "other", "createOptions", "multiCursorModifier", "isMacintosh", "ClickLinkGesture", "Disposable", "editor", "_a", "Emitter", "newOpts", "mouseEvent", "currentLineNumber", "init_dom", "init_actions", "init_codicons", "init_themables", "init_color", "init_event", "init_objects", "init_editorExtensions", "init_codeEditorService", "init_objects", "init_codeEditorService", "init_languageConfigurationRegistry", "init_languageFeatures", "init_commands", "init_contextkey", "init_instantiation", "init_themeService", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "EmbeddedCodeEditorWidget", "CodeEditorWidget", "domElement", "options", "codeEditorWidgetOptions", "parentEditor", "instantiationService", "codeEditorService", "commandService", "contextKeyService", "themeService", "notificationService", "accessibilityService", "languageConfigurationService", "languageFeaturesService", "e", "newOptions", "mixin", "IInstantiationService", "ICodeEditorService", "ICommandService", "IContextKeyService", "IThemeService", "INotificationService", "IAccessibilityService", "ILanguageConfigurationService", "ILanguageFeaturesService", "init_dom", "init_color", "init_lifecycle", "init_objects", "init_range", "init_textModel", "defaultColor", "Color", "RGBA", "defaultOptions", "WIDGET_ID", "ViewZoneDelegate", "domNode", "afterLineNumber", "afterColumn", "heightInLines", "onDomNodeTop", "onComputedHeight", "showInHiddenAreas", "ordinal", "top", "height", "OverlayWidgetDelegate", "id", "Arrow", "_editor", "removeCSSRulesContainingSelector", "value", "createCSSRule", "where", "Range", "IdGenerator", "ZoneWidget", "editor", "options", "DisposableStore", "deepClone", "mixin", "info", "width", "accessor", "styles", "frameColor", "arrowColor", "_a", "containerHeight", "layoutInfo", "range", "rangeOrPos", "ModelDecorationOptions", "lineHeight", "result", "arrowHeight", "frameThickness", "position", "viewZoneDomNode", "maxHeightInLines", "model", "isLastLine", "className", "classToReplace", "widthInPixel", "heightInPixel", "newHeightInLines", "Sash", "data", "e", "evt", "lineDelta", "roundedLineDelta", "init_nls", "init_contextkey", "init_extensions", "init_instantiation", "init_colorRegistry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "IPeekViewService", "createDecorator", "registerSingleton", "editor", "widget", "existing", "remove", "data", "PeekContext", "RawContextKey", "localize", "PeekContextController", "contextKeyService", "EmbeddedCodeEditorWidget", "IContextKeyService", "registerEditorContribution", "getOuterEditor", "accessor", "ICodeEditorService", "defaultOptions", "Color", "PeekViewWidget", "ZoneWidget", "options", "instantiationService", "Emitter", "mixin", "styles", "container", "$", "noCloseAction", "addStandardDisposableListener", "event", "append", "actionsContainer", "actionBarOptions", "ActionBar", "Action", "ThemeIcon", "Codicon", "createActionViewItem", "primaryHeading", "secondaryHeading", "clearNode", "value", "show", "hide", "heightInPixel", "widthInPixel", "headHeight", "bodyHeight", "IInstantiationService", "peekViewTitleBackground", "registerColor", "Color", "localize", "peekViewTitleForeground", "editorForeground", "peekViewTitleInfoForeground", "peekViewBorder", "editorInfoForeground", "contrastBorder", "peekViewResultsBackground", "peekViewResultsMatchForeground", "peekViewResultsFileForeground", "peekViewResultsSelectionBackground", "peekViewResultsSelectionForeground", "peekViewEditorBackground", "peekViewEditorGutterBackground", "peekViewEditorStickyScrollBackground", "peekViewResultsMatchHighlight", "peekViewEditorMatchHighlight", "peekViewEditorMatchHighlightBorder", "activeContrastBorder", "init_nls", "init_contextkey", "init_async", "init_keyCodes", "init_types", "init_uri", "init_editorState", "init_editorExtensions", "init_codeEditorService", "init_position", "init_range", "init_editorContextKeys", "init_languages", "init_async", "init_errors", "init_keyCodes", "init_lifecycle", "init_codeEditorService", "init_position", "init_range", "init_nls", "init_commands", "init_configuration", "init_contextkey", "init_instantiation", "init_keybindingsRegistry", "init_errors", "init_event", "init_lifecycle", "init_map", "init_resources", "init_strings", "init_range", "init_nls", "OneReference", "isProviderFirst", "parent", "link", "_rangeCallback", "defaultGenerator", "_a", "_b", "value", "preview", "localize", "basename", "FilePreview", "_modelReference", "range", "n", "model", "startLineNumber", "startColumn", "endLineNumber", "endColumn", "word", "beforeRange", "Range", "afterRange", "before", "inside", "after", "FileReferences", "uri", "ResourceMap", "dispose", "child", "len", "textModelResolverService", "ref", "err", "onUnexpectedError", "ReferencesModel", "links", "title", "Emitter", "providersFirst", "current", "extUri", "oneRef", "reference", "next", "idx", "childCount", "groupCount", "resource", "position", "nearest", "commonPrefixLength", "a", "b", "init_dom", "init_color", "init_event", "init_lifecycle", "init_network", "init_resources", "init_range", "init_textModel", "init_languageConfigurationRegistry", "init_modesRegistry", "init_language", "init_resolverService", "init_dom", "init_filters", "init_lifecycle", "init_resources", "init_resolverService", "init_nls", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "FileReferencesRenderer_1", "DataSource", "_resolverService", "element", "ReferencesModel", "FileReferences", "val", "ITextModelService", "Delegate", "element", "FileReferences", "FileReferencesRenderer", "OneReferenceRenderer", "StringRepresentationProvider", "_keybindingService", "_a", "OneReference", "parts", "basename", "__decorate", "__param", "IKeybindingService", "IdentityProvider", "element", "OneReference", "FileReferencesTemplate", "Disposable", "container", "_labelService", "parent", "IconLabel", "CountBadge", "append", "$", "defaultCountBadgeStyles", "matches", "dirname", "len", "localize", "__decorate", "__param", "ILabelService", "FileReferencesRenderer", "FileReferencesRenderer_1", "_instantiationService", "node", "index", "template", "createMatches", "templateData", "IInstantiationService", "OneReferenceTemplate", "container", "HighlightedLabel", "element", "score", "_a", "preview", "basename", "value", "highlight", "FuzzyScore", "createMatches", "OneReferenceRenderer", "node", "index", "templateData", "AccessibilityProvider", "localize", "init_nls", "init_instantiation", "init_themeService", "init_undoRedo", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "DecorationsManager", "_editor", "_model", "DisposableStore", "model", "ref", "reference", "newDecorations", "newDecorationsActualIndex", "len", "oneReference", "changeAccessor", "decorations", "toRemove", "decorationId", "newRange", "ignore", "Range", "lineLength", "newLineLength", "ModelDecorationOptions", "LayoutData", "raw", "ratio", "heightInLines", "data", "ReferencesTree", "WorkbenchAsyncDataTree", "ReferenceWidget", "PeekViewWidget", "editor", "_defaultTreeKeyboardSupport", "layoutData", "themeService", "_textModelResolverService", "_instantiationService", "_peekViewService", "_uriLabel", "_undoRedoService", "_keybindingService", "_languageService", "_languageConfigurationService", "Emitter", "Dimension", "dispose", "theme", "borderColor", "peekViewBorder", "Color", "peekViewTitleBackground", "peekViewTitleForeground", "peekViewTitleInfoForeground", "where", "containerElement", "append", "$", "hide", "SplitView", "options", "EmbeddedCodeEditorWidget", "TextModel", "localize", "PLAINTEXT_LANGUAGE_ID", "treeOptions", "AccessibilityProvider", "StringRepresentationProvider", "IdentityProvider", "peekViewResultsBackground", "addStandardDisposableListener", "e", "Delegate", "FileReferencesRenderer", "OneReferenceRenderer", "DataSource", "Event", "width", "Sizing", "onEvent", "element", "kind", "OneReference", "heightInPixel", "widthInPixel", "selection", "newModel", "show", "event", "FileReferences", "revealParent", "Schemas", "basenameOrAuthority", "dirname", "promise", "scrollType", "sel", "IThemeService", "ITextModelService", "IInstantiationService", "IPeekViewService", "ILabelService", "IUndoRedoService", "IKeybindingService", "ILanguageService", "ILanguageConfigurationService", "init_editorContextKeys", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ReferencesController_1", "ctxReferenceSearchVisible", "RawContextKey", "localize", "ReferencesController", "editor", "_defaultTreeKeyboardSupport", "_editor", "contextKeyService", "_editorService", "_notificationService", "_instantiationService", "_storageService", "_configurationService", "DisposableStore", "_a", "_b", "range", "modelPromise", "peekMode", "widgetPosition", "storageKey", "data", "LayoutData", "ReferenceWidget", "event", "element", "kind", "requestId", "model", "uri", "pos", "Position", "selection", "error", "fwd", "currentPosition", "source", "editorFocus", "previewEditorFocus", "reference", "focusEditor", "ref", "pinned", "Range", "openedEditor", "other", "createCancelablePromise", "_", "err", "onUnexpectedError", "sideBySide", "IContextKeyService", "ICodeEditorService", "INotificationService", "IInstantiationService", "IStorageService", "IConfigurationService", "withController", "accessor", "fn", "outerEditor", "getOuterEditor", "controller", "ReferencesController", "KeybindingsRegistry", "KeyChord", "ContextKeyExpr", "ctxReferenceSearchVisible", "PeekContext", "CommandsRegistry", "EditorContextKeys", "InputFocusedContext", "WorkbenchListFocusContextKey", "WorkbenchTreeElementCanCollapse", "WorkbenchTreeElementCanExpand", "_a", "focus", "IListService", "OneReference", "init_event", "init_lifecycle", "init_resources", "init_editorExtensions", "init_codeEditorService", "init_range", "init_nls", "init_contextkey", "init_extensions", "init_instantiation", "init_keybindingsRegistry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ctxHasSymbols", "RawContextKey", "localize", "ISymbolNavigationService", "createDecorator", "SymbolNavigationService", "contextKeyService", "_editorService", "_notificationService", "_keybindingService", "_a", "_b", "anchor", "refModel", "editorState", "EditorState", "listener", "_", "editor", "model", "position", "seenUri", "seenPosition", "reference", "isEqual", "Range", "combinedDisposable", "source", "kb", "message", "IContextKeyService", "ICodeEditorService", "INotificationService", "IKeybindingService", "registerSingleton", "registerEditorCommand", "EditorCommand", "accessor", "KeybindingsRegistry", "editorService", "DisposableStore", "Emitter", "dispose", "init_nls", "init_actions", "init_commands", "init_contextkey", "init_instantiation", "init_arrays", "init_cancellation", "init_errors", "init_editorExtensions", "init_languageFeatures", "getLocationLinks", "model", "position", "registry", "provide", "promises", "provider", "err", "onUnexpectedExternalError", "values", "coalesce", "getDefinitionsAtPosition", "token", "getDeclarationsAtPosition", "getImplementationsAtPosition", "getTypeDefinitionsAtPosition", "getReferencesAtPosition", "compact", "result", "resultWithoutDeclaration", "_sortedAndDeduped", "callback", "rawLinks", "ReferencesModel", "modelLinks", "ref", "registerModelAndPositionCommand", "accessor", "languageFeaturesService", "ILanguageFeaturesService", "promise", "CancellationToken", "init_languageFeatures", "init_iterator", "_a", "_b", "_c", "_d", "_e", "_f", "_g", "_h", "MenuRegistry", "MenuId", "localize", "SymbolNavigationAnchor", "thing", "Position", "model", "position", "SymbolNavigationAction", "EditorAction2", "opts", "result", "item", "Iterable", "ContextKeyExpr", "configuration", "accessor", "editor", "arg", "range", "notificationService", "INotificationService", "editorService", "ICodeEditorService", "progressService", "IEditorProgressService", "symbolNavService", "ISymbolNavigationService", "languageFeaturesService", "ILanguageFeaturesService", "instaService", "IInstantiationService", "anchor", "cts", "EditorStateCancellationTokenSource", "promise", "raceCancellation", "references", "_j", "alert", "altAction", "altActionId", "referenceCount", "info", "MessageController", "err", "gotoLocation", "EmbeddedCodeEditorWidget", "next", "peek", "targetEditor", "reference", "sideBySide", "highlight", "isLocationLink", "Range", "modelNow", "decorations", "target", "controller", "ReferencesController", "createCancelablePromise", "_", "DefinitionAction", "token", "ReferencesModel", "getDefinitionsAtPosition", "registerAction2", "localize2", "EditorContextKeys", "IsWebContext", "CommandsRegistry", "KeyChord", "PeekContext", "DeclarationAction", "getDeclarationsAtPosition", "TypeDefinitionAction", "getTypeDefinitionsAtPosition", "ImplementationAction", "getImplementationsAtPosition", "ReferencesAction", "getReferencesAtPosition", "GenericGoToLocationAction", "config", "_references", "_gotoMultipleBehaviour", "_model", "_position", "_token", "URI", "resource", "multiple", "noResultsMessage", "openInPeek", "assertType", "isCodeEditor", "command", "ICommandService", "codeEditorService", "control", "init_languageFeatures", "init_textModel", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "GotoDefinitionAtPositionEditorContribution_1", "GotoDefinitionAtPositionEditorContribution", "editor", "textModelResolverService", "languageService", "languageFeaturesService", "DisposableStore", "linkGesture", "ClickLinkGesture", "mouseEvent", "keyboardEvent", "error", "onUnexpectedError", "position", "e", "withKey", "_a", "word", "state", "EditorState", "createCancelablePromise", "token", "results", "linkRange", "Range", "combinedRange", "originSelectionRange", "MarkdownString", "localize", "result", "ref", "textEditorModel", "startLineNumber", "previewValue", "languageId", "rangeToUse", "previewRange", "minIndent", "endLineNumber", "endIndent", "startIndent", "maxLineNumber", "range", "hoverMessage", "newDecorations", "ModelDecorationInjectedTextOptions", "model", "getDefinitionsAtPosition", "openToSide", "accessor", "canPeek", "DefinitionAction", "contextKeyService", "IContextKeyService", "PeekContext", "ITextModelService", "ILanguageService", "ILanguageFeaturesService", "registerEditorContribution", "GotoDefinitionAtPositionEditorContribution", "init_dom", "init_arrays", "init_lifecycle", "init_position", "init_range", "init_textModel", "init_languages", "init_async", "init_errors", "init_event", "init_lifecycle", "HoverResult", "value", "isComplete", "hasLoadingMessage", "HoverOperation", "Disposable", "_editor", "_computer", "Emitter", "RunOnceScheduler", "state", "fireResult", "createCancelableAsyncIterable", "token", "item", "onUnexpectedError", "mode", "HoverRangeAnchor", "priority", "range", "initialMousePosX", "initialMousePosY", "other", "lastAnchor", "showAtPosition", "HoverForeignElementAnchor", "owner", "supportsMarkerHover", "HoverParticipantRegistry", "ctor", "init_instantiation", "init_async", "init_editorContextKeys", "init_contextkey", "init_dom", "init_event", "init_lifecycle", "ResizableHTMLElement", "Emitter", "DisposableStore", "Dimension", "Sash", "OrthogonalEdge", "currentSize", "deltaY", "deltaX", "Event", "e", "north", "east", "south", "west", "height", "width", "minHeight", "minWidth", "maxHeight", "maxWidth", "newSize", "value", "init_lifecycle", "init_position", "init_dom", "TOP_HEIGHT", "BOTTOM_HEIGHT", "ResizableContentWidget", "Disposable", "_editor", "minimumSize", "Dimension", "ResizableHTMLElement", "e", "_a", "Position", "position", "editorDomNode", "mouseBox", "getDomNodePagePosition", "editorBox", "bodyBox", "getClientArea", "mouseBottom", "widgetHeight", "showAtPosition", "_b", "maxHeightBelow", "maxHeightAbove", "maxHeight", "height", "renderingAbove", "dimension", "init_configuration", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ContentHoverController_1", "ContentHoverWidget_1", "$", "ContentHoverController", "Disposable", "_editor", "_instantiationService", "_keybindingService", "ContentHoverWidget", "participant", "HoverParticipantRegistry", "p1", "p2", "ContentHoverComputer", "HoverOperation", "result", "messages", "HoverResult", "addStandardDisposableListener", "e", "TokenizationRegistry", "anchor", "mode", "source", "focus", "mouseEvent", "insistOnKeepingHoverVisible", "hoverResult", "loadingMessage", "showAtPosition", "showAtSecondaryPosition", "highlightRange", "disposables", "DisposableStore", "statusBar", "EditorHoverStatusBar", "fragment", "colorPicker", "context", "widget", "dimensions", "hoverParts", "msg", "isBeforeContent", "m", "highlightDecoration", "toDisposable", "ContentHoverVisibleData", "editor", "anchorRange", "startColumnBoundary", "viewModel", "coordinatesConverter", "anchorViewRange", "anchorViewRangeStart", "Position", "anchorLineNumber", "renderStartColumn", "forceShowAtRange", "Range", "anchorCandidates", "HoverRangeAnchor", "epsilon", "a", "b", "range", "node", "ModelDecorationOptions", "IInstantiationService", "IKeybindingService", "HoverResult", "anchor", "messages", "isComplete", "filteredMessages", "m", "FilteredHoverResult", "original", "ContentHoverVisibleData", "initialMousePosX", "initialMousePosY", "colorPicker", "showAtPosition", "showAtSecondaryPosition", "preferAbove", "stoleFocus", "source", "isBeforeContent", "disposables", "HORIZONTAL_SCROLLING_BY", "SCROLLBAR_WIDTH", "CONTAINER_HEIGHT_PADDING", "ContentHoverWidget", "ContentHoverWidget_1", "ResizableContentWidget", "_a", "editor", "contextKeyService", "_configurationService", "_accessibilityService", "_keybindingService", "minimumHeight", "minimumWidth", "minimumSize", "Dimension", "HoverWidget", "EditorContextKeys", "append", "e", "focusTracker", "trackFocus", "container", "width", "height", "transformedWidth", "transformedHeight", "contentsDomNode", "containerDomNode", "scrollDimensions", "extraBottomPadding", "size", "_b", "maxRenderingWidth", "maxRenderingHeight", "position", "availableSpace", "maximumHeight", "hoverPart", "overflowing", "hoverElement", "initialWidth", "getClientArea", "posx", "posy", "widgetRect", "getDomNodePagePosition", "computeDistanceFromPointToRectangle", "distance", "hoverData", "fontSize", "lineHeight", "node", "_c", "_d", "widgetHeight", "getTotalHeight", "widgetPosition", "accessibleViewHint", "getHoverAccessibleViewHint", "layoutInfo", "getTotalWidth", "dimensions", "scrollTop", "fontInfo", "scrollLeft", "scrollHeight", "__decorate", "__param", "IContextKeyService", "IConfigurationService", "IAccessibilityService", "IKeybindingService", "EditorHoverStatusBar", "Disposable", "_keybindingService", "$", "append", "actionOptions", "keybinding", "keybindingLabel", "HoverAction", "element", "result", "__decorate", "__param", "IKeybindingService", "ContentHoverComputer", "value", "_editor", "_participants", "editor", "anchor", "model", "lineNumber", "maxColumn", "d", "startColumn", "endColumn", "token", "AsyncIterableObject", "lineDecorations", "participant", "result", "coalesce", "computeDistanceFromPointToRectangle", "pointX", "pointY", "left", "top", "width", "height", "x", "y", "dx", "dy", "init_dom", "init_arrays", "init_htmlContent", "init_lifecycle", "init_model", "$", "MarginHoverWidget", "Disposable", "editor", "languageService", "openerService", "DisposableStore", "HoverWidget", "MarkdownRenderer", "MarginHoverComputer", "HoverOperation", "result", "e", "node", "lineNumber", "laneOrLine", "messages", "fragment", "msg", "markdownHoverElement", "hoverContentsElement", "append", "renderedContents", "editorLayout", "topForLineNumber", "editorScrollTop", "lineHeight", "nodeHeight", "top", "left", "value", "_editor", "GlyphMarginLane", "_a", "_b", "toHoverMessage", "contents", "lineDecorations", "isLineHover", "d", "lane", "hoverMessage", "isEmptyMarkdownString", "asArray", "init_instantiation", "init_colorRegistry", "init_themeService", "init_dom", "init_arrays", "init_async", "init_htmlContent", "init_lifecycle", "init_position", "init_range", "init_language", "init_async", "init_cancellation", "init_errors", "init_editorExtensions", "init_languageFeatures", "HoverProviderResult", "provider", "hover", "ordinal", "executeProvider", "model", "position", "token", "result", "isValid", "err", "onUnexpectedExternalError", "getHover", "registry", "promises", "index", "AsyncIterableObject", "getHoverPromise", "item", "registerModelAndPositionCommand", "accessor", "languageFeaturesService", "ILanguageFeaturesService", "CancellationToken", "hasRange", "hasHtmlContent", "init_nls", "init_configuration", "init_languageFeatures", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "$", "MarkdownHover", "owner", "range", "contents", "isBeforeContent", "ordinal", "anchor", "MarkdownHoverParticipant", "_editor", "_languageService", "_openerService", "_configurationService", "_languageFeaturesService", "MarkdownString", "localize", "lineDecorations", "model", "lineNumber", "maxColumn", "result", "index", "lineLength", "languageId", "stopRenderingLineAfter", "maxTokenizationLineLength", "stopRenderingMessage", "startColumn", "endColumn", "hoverMessage", "isEmptyMarkdownString", "Range", "asArray", "token", "AsyncIterableObject", "position", "Position", "getHover", "item", "rng", "context", "hoverParts", "renderMarkdownHovers", "ILanguageService", "IOpenerService", "IConfigurationService", "ILanguageFeaturesService", "renderMarkdownHovers", "context", "hoverParts", "editor", "languageService", "openerService", "a", "b", "disposables", "DisposableStore", "hoverPart", "contents", "isEmptyMarkdownString", "markdownHoverElement", "$", "hoverContentsElement", "append", "renderer", "MarkdownRenderer", "renderedContents", "init_dom", "init_arrays", "init_async", "init_errors", "init_lifecycle", "init_resources", "init_range", "init_languageFeatures", "init_codicons", "init_lifecycle", "init_editorExtensions", "init_codeEditorService", "init_position", "init_range", "init_editorContextKeys", "init_arrays", "init_event", "init_lifecycle", "init_linkedList", "init_strings", "init_uri", "init_range", "init_extensions", "init_instantiation", "init_configuration", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "MarkerCoordinate", "marker", "index", "total", "MarkerList", "resourceFilter", "_markerService", "_configService", "Emitter", "DisposableStore", "URI", "uri", "compareOrder", "compareMarker", "b", "res", "compare", "Range", "MarkerSeverity", "updateMarker", "m", "uris", "model", "position", "fwd", "found", "idx", "binarySearch", "a", "range", "word", "oldIdx", "IMarkerService", "IConfigurationService", "IMarkerNavigationService", "createDecorator", "MarkerNavigationService", "_markerService", "_configService", "LinkedList", "resource", "provider", "result", "MarkerList", "__decorate", "__param", "IMarkerService", "IConfigurationService", "registerSingleton", "init_nls", "init_actions", "init_contextkey", "init_instantiation", "init_dom", "init_arrays", "init_color", "init_event", "init_lifecycle", "init_resources", "init_strings", "init_range", "init_nls", "init_actions", "init_contextkey", "init_instantiation", "init_codicons", "init_themables", "SeverityIcon", "className", "severity", "severity_default", "ThemeIcon", "Codicon", "init_colorRegistry", "init_themeService", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "MarkerNavigationWidget_1", "MessageWidget", "parent", "editor", "onRelatedInformation", "_openerService", "_labelService", "DisposableStore", "domNode", "addStandardDisposableListener", "event", "related", "ScrollableElement", "e", "dispose", "marker", "source", "message", "relatedInformation", "code", "sourceAndCodeLength", "lines", "splitLines", "line", "clearNode", "lastLineElement", "detailsElement", "sourceElement", "codeElement", "$", "append", "isNonEmptyArray", "relatedInformationNode", "container", "relatedResource", "relatedMessage", "fontInfo", "scrollWidth", "scrollHeight", "height", "width", "severityLabel", "MarkerSeverity", "localize", "ariaLabel", "model", "MarkerNavigationWidget", "PeekViewWidget", "_themeService", "_menuService", "instantiationService", "_contextKeyService", "Emitter", "Color", "theme", "editorMarkerNavigationBackground", "colorId", "editorMarkerNavigationError", "headerBackground", "editorMarkerNavigationErrorHeader", "editorMarkerNavigationWarning", "editorMarkerNavigationWarningHeader", "editorMarkerNavigationInfo", "editorMarkerNavigationInfoHeader", "frameColor", "headerBg", "peekViewTitleForeground", "peekViewTitleInfoForeground", "actions", "menu", "createAndFillInActionBarActions", "markerIdx", "markerCount", "range", "Range", "editorPosition", "position", "detail", "basename", "SeverityIcon", "heightInPixel", "widthInPixel", "MenuId", "IThemeService", "IOpenerService", "IMenuService", "IInstantiationService", "IContextKeyService", "ILabelService", "errorDefault", "oneOf", "editorErrorForeground", "editorErrorBorder", "warningDefault", "editorWarningForeground", "editorWarningBorder", "infoDefault", "editorInfoForeground", "editorInfoBorder", "editorMarkerNavigationError", "registerColor", "contrastBorder", "localize", "editorMarkerNavigationErrorHeader", "transparent", "editorMarkerNavigationWarning", "editorMarkerNavigationWarningHeader", "editorMarkerNavigationInfo", "editorMarkerNavigationInfoHeader", "editorMarkerNavigationBackground", "editorBackground", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "MarkerController_1", "MarkerController", "editor", "_markerNavigationService", "_contextKeyService", "_editorService", "_instantiationService", "DisposableStore", "CONTEXT_MARKERS_NAVIGATION_VISIBLE", "uri", "reusePosition", "MarkerNavigationWidget", "e", "_a", "_b", "_c", "Range", "info", "related", "focusEditor", "marker", "model", "Position", "next", "multiFile", "otherEditor", "IMarkerNavigationService", "IContextKeyService", "ICodeEditorService", "IInstantiationService", "MarkerNavigationAction", "EditorAction", "_next", "_multiFile", "opts", "_accessor", "editor", "_a", "MarkerController", "NextMarkerAction", "EditorContextKeys", "MarkerNavigationWidget", "registerIcon", "Codicon", "localize", "PrevMarkerAction", "NextMarkerInFilesAction", "MenuId", "PrevMarkerInFilesAction", "registerEditorContribution", "registerEditorAction", "CONTEXT_MARKERS_NAVIGATION_VISIBLE", "RawContextKey", "MarkerCommand", "EditorCommand", "registerEditorCommand", "x", "init_nls", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "$", "MarkerHover", "owner", "range", "marker", "anchor", "markerCodeActionTrigger", "CodeActionKind", "CodeActionTriggerSource", "MarkerHoverParticipant", "_editor", "_markerDecorationsService", "_openerService", "_languageFeaturesService", "lineDecorations", "model", "lineNumber", "maxColumn", "result", "startColumn", "endColumn", "Range", "context", "hoverParts", "Disposable", "disposables", "DisposableStore", "msg", "markerHoverForStatusbar", "a", "b", "MarkerSeverity", "markerHover", "hoverElement", "markerElement", "append", "source", "message", "code", "relatedInformation", "messageElement", "sourceAndCodeElement", "sourceElement", "codeLink", "addDisposableListener", "e", "codeElement", "detailsElement", "isNonEmptyArray", "resource", "startLineNumber", "relatedInfoContainer", "basename", "onUnexpectedError", "markerController", "MarkerController", "localize", "NextMarkerAction", "quickfixPlaceholderElement", "IMarkerData", "updatePlaceholderDisposable", "disposableTimeout", "codeActionsPromise", "toDisposable", "actions", "showing", "quickFixCommandId", "controller", "CodeActionController", "elementPosition", "getDomNodePagePosition", "createCancelablePromise", "cancellationToken", "getCodeActions", "Progress", "IMarkerDecorationsService", "IOpenerService", "ILanguageFeaturesService", "init_dom", "init_actions", "init_arrays", "init_async", "init_codicons", "init_lifecycle", "init_observable", "init_platform", "init_themables", "init_position", "init_languages", "inlineSuggestCommitId", "showPreviousInlineSuggestionActionId", "showNextInlineSuggestionActionId", "init_nls", "init_actions", "init_commands", "init_contextkey", "init_instantiation", "init_telemetry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlineSuggestionHintsContentWidget_1", "InlineCompletionsHintsWidget", "Disposable", "editor", "model", "instantiationService", "observableFromEvent", "derived", "reader", "_a", "_b", "_c", "ghostText", "firstColumn", "position", "Position", "autorunWithStore", "store", "contentWidget", "InlineSuggestionHintsContentWidget", "v", "toDisposable", "autorun", "InlineCompletionTriggerKind", "IInstantiationService", "inlineSuggestionHintsNextIcon", "registerIcon", "Codicon", "localize", "inlineSuggestionHintsPreviousIcon", "InlineSuggestionHintsContentWidget", "InlineSuggestionHintsContentWidget_1", "Disposable", "commandId", "label", "iconClassName", "action", "Action", "kb", "tooltip", "editor", "withBorder", "_position", "_currentSuggestionIdx", "_suggestionCount", "_extraCommands", "_commandService", "instantiationService", "keybindingService", "_contextKeyService", "_menuService", "h", "showPreviousInlineSuggestionActionId", "ThemeIcon", "showNextInlineSuggestionActionId", "MenuId", "RunOnceScheduler", "CustomizedMenuWorkbenchToolBar", "g", "options", "MenuItemAction", "StatusBarViewItem", "a", "ActionViewItemWithClassName", "e", "autorun", "reader", "suggestionCount", "currentSuggestionIdx", "extraCommands", "equals", "extraActions", "c", "event", "_", "group", "Separator", "__decorate", "__param", "ICommandService", "IInstantiationService", "IKeybindingService", "IContextKeyService", "IMenuService", "ActionViewItemWithClassName", "ActionViewItem", "className", "container", "StatusBarViewItem", "MenuEntryActionViewItem", "kb", "div", "h", "KeybindingLabel", "OS", "unthemedKeybindingLabelOptions", "CustomizedMenuWorkbenchToolBar", "WorkbenchToolBar", "menuId", "options2", "menuService", "contextKeyService", "contextMenuService", "keybindingService", "telemetryService", "_a", "_b", "_c", "_d", "_e", "_f", "_g", "primary", "secondary", "createAndFillInActionBarActions", "actions", "equals", "a", "b", "__decorate", "__param", "IMenuService", "IContextKeyService", "IContextMenuService", "IKeybindingService", "ITelemetryService", "init_async", "init_nls", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "HoverController_1", "_sticky", "HoverController", "Disposable", "_editor", "_instantiationService", "_openerService", "_languageService", "_keybindingService", "DisposableStore", "RunOnceScheduler", "e", "editor", "hoverOpts", "mouseEvent", "_a", "ContentHoverWidget", "MarginHoverWidget", "_b", "targetElement", "_c", "_d", "_e", "sticky", "hidingDelay", "mouseOnDecorator", "decoratorActivatedOn", "enabled", "activatedByDecoratorClick", "resolvedKeyboardEvent", "mightTriggerFocus", "InlineSuggestionHintsContentWidget", "ContentHoverController", "range", "mode", "source", "focus", "activatedByColorDecoratorClick", "IInstantiationService", "IOpenerService", "ILanguageService", "IKeybindingService", "HoverFocusBehavior", "ShowOrFocusHoverAction", "EditorAction", "localize", "EditorContextKeys", "KeyChord", "accessor", "editor", "args", "controller", "HoverController", "focusArgument", "focusOption", "showContentHover", "focus", "position", "range", "Range", "accessibilitySupportEnabled", "ShowDefinitionPreviewHoverAction", "goto", "GotoDefinitionAtPositionEditorContribution", "ScrollUpHoverAction", "ScrollDownHoverAction", "ScrollLeftHoverAction", "ScrollRightHoverAction", "PageUpHoverAction", "PageDownHoverAction", "GoToTopHoverAction", "GoToBottomHoverAction", "registerEditorContribution", "registerEditorAction", "HoverParticipantRegistry", "MarkdownHoverParticipant", "MarkerHoverParticipant", "registerThemingParticipant", "theme", "collector", "hoverBorder", "editorHoverBorder", "ColorContribution", "Disposable", "_editor", "e", "mouseEvent", "colorDecoratorsActivatedOn", "target", "ColorDecorationInjectedTextMarker", "hoverController", "HoverController", "range", "Range", "registerEditorContribution", "HoverParticipantRegistry", "ColorHoverParticipant", "init_editorExtensions", "init_nls", "init_lifecycle", "init_instantiation", "init_event", "init_languageFeatures", "init_editorExtensions", "init_editorContextKeys", "init_contextkey", "init_model", "init_languageConfigurationRegistry", "init_dom", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StandaloneColorPickerController_1", "StandaloneColorPickerWidget_1", "StandaloneColorPickerController", "Disposable", "_editor", "_contextKeyService", "_modelService", "_keybindingService", "_instantiationService", "_languageFeatureService", "_languageConfigurationService", "EditorContextKeys", "_a", "StandaloneColorPickerWidget", "editor", "IContextKeyService", "IModelService", "IKeybindingService", "IInstantiationService", "ILanguageFeaturesService", "ILanguageConfigurationService", "registerEditorContribution", "StandaloneColorPickerController", "PADDING", "CLOSE_BUTTON_WIDTH", "StandaloneColorPickerWidget", "StandaloneColorPickerWidget_1", "Disposable", "_editor", "_standaloneColorPickerVisible", "_standaloneColorPickerFocused", "_instantiationService", "_modelService", "_keybindingService", "_languageFeaturesService", "_languageConfigurationService", "_a", "Emitter", "StandaloneColorPickerParticipant", "editorSelection", "selection", "focusTracker", "trackFocus", "_", "e", "classList", "result", "positionPreference", "computeAsyncResult", "StandaloneColorPickerResult", "range", "colorInfo", "colorHoverResult", "DefaultDocumentColorProvider", "colorHover", "foundInEditor", "fragment", "statusBar", "EditorHoverStatusBar", "colorPickerWidget", "context", "widget", "colorPickerBody", "saturationBoxWidth", "widthOfOriginalColorBox", "enterButton", "colorPickerHeader", "pickedColorNode", "originalColorNode", "closeButton", "__decorate", "__param", "IInstantiationService", "IModelService", "IKeybindingService", "ILanguageFeaturesService", "ILanguageConfigurationService", "StandaloneColorPickerResult", "value", "foundInEditor", "init_editorContextKeys", "init_actions", "ShowOrFocusStandaloneColorPicker", "EditorAction2", "localize2", "localize", "MenuId", "_accessor", "editor", "_a", "StandaloneColorPickerController", "HideStandaloneColorPicker", "EditorAction", "EditorContextKeys", "InsertColorWithStandaloneColorPicker", "registerEditorAction", "registerAction2", "init_keyCodes", "init_editorExtensions", "init_range", "init_editorContextKeys", "init_languageConfigurationRegistry", "init_position", "init_range", "init_selection", "BlockCommentCommand", "selection", "insertSpace", "languageConfigurationService", "haystack", "needle", "offset", "needleLength", "haystackLength", "i", "codeA", "codeB", "startToken", "endToken", "model", "builder", "startLineNumber", "startColumn", "endLineNumber", "endColumn", "startLineText", "endLineText", "startTokenIndex", "endTokenIndex", "startLineAfterStartToken", "endLineBeforeEndToken", "ops", "Range", "op", "r", "res", "EditOperation", "Position", "languageId", "config", "helper", "inverseEditOperations", "startTokenEditOperation", "endTokenEditOperation", "Selection", "srcRange", "deltaColumn", "init_strings", "init_position", "init_range", "init_selection", "LineCommentCommand", "languageConfigurationService", "selection", "tabSize", "type", "insertSpace", "ignoreEmptyLines", "ignoreFirstLine", "model", "startLineNumber", "endLineNumber", "languageId", "config", "commentStr", "lines", "i", "lineCount", "onlyWhitespaceLines", "shouldRemoveComments", "lineData", "lineNumber", "lineContent", "lineContentStartOffset", "firstNonWhitespaceIndex", "BlockCommentCommand", "commentStrEndOffset", "builder", "data", "s", "ops", "cursorPosition", "Position", "len", "Range", "startToken", "endToken", "startTokenAllowedBeforeColumn", "startTokenIndex", "endTokenIndex", "op", "helper", "result", "Selection", "res", "EditOperation", "afterCommentStr", "currentVisibleColumn", "isTab", "columnSize", "minVisibleColumn", "j", "lenJ", "init_nls", "init_actions", "CommentLineAction", "EditorAction", "type", "opts", "accessor", "editor", "languageConfigurationService", "ILanguageConfigurationService", "model", "commands", "modelOptions", "commentsOptions", "selections", "selection", "index", "a", "b", "Range", "prev", "i", "curr", "LineCommentCommand", "ToggleCommentLineAction", "localize", "EditorContextKeys", "MenuId", "AddLineCommentAction", "KeyChord", "RemoveLineCommentAction", "BlockCommentAction", "BlockCommentCommand", "registerEditorAction", "init_dom", "init_actions", "init_lifecycle", "init_platform", "init_editorExtensions", "init_editorContextKeys", "init_nls", "init_contextkey", "init_configuration", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ContextMenuController_1", "ContextMenuController", "editor", "_contextMenuService", "_contextViewService", "_contextKeyService", "_keybindingService", "_menuService", "_configurationService", "_workspaceContextService", "DisposableStore", "e", "view", "getShadowRoot", "hasSelectionAtPosition", "selection", "anchor", "menuActions", "MenuId", "model", "menuId", "result", "menu", "groups", "group", "actions", "addedItems", "action", "SubmenuItemAction", "subActions", "SubmenuAction", "Separator", "event", "oldHoverSetting", "cursorCoords", "editorCoords", "getDomNodePagePosition", "posx", "posy", "useShadowDOM", "isIOS", "keybinding", "ActionViewItem", "customActionViewItem", "wasCancelled", "isStandaloneEditorWorkspace", "minimapOptions", "lastId", "createAction", "opts", "createSubmenuAction", "label", "createEnumAction", "enabled", "configName", "configuredValue", "options", "createRunner", "value", "option", "localize", "IContextMenuService", "IContextViewService", "IContextKeyService", "IKeybindingService", "IMenuService", "IConfigurationService", "IWorkspaceContextService", "ShowContextMenu", "EditorAction", "localize", "EditorContextKeys", "accessor", "editor", "_a", "ContextMenuController", "registerEditorContribution", "registerEditorAction", "init_lifecycle", "init_editorExtensions", "init_editorContextKeys", "init_nls", "CursorState", "selections", "other", "thisLen", "otherLen", "i", "StackElement", "cursorState", "scrollTop", "scrollLeft", "CursorUndoRedoController", "Disposable", "editor", "e", "prevState", "stackElement", "CursorUndo", "EditorAction", "localize", "EditorContextKeys", "accessor", "args", "_a", "CursorRedo", "registerEditorContribution", "registerEditorAction", "init_lifecycle", "init_platform", "init_editorExtensions", "init_position", "init_range", "init_selection", "init_textModel", "init_range", "init_selection", "DragAndDropCommand", "selection", "targetPosition", "copy", "model", "builder", "text", "Range", "Selection", "helper", "hasTriggerModifier", "e", "isMacintosh", "DragAndDropController", "Disposable", "editor", "mouseEvent", "target", "possibleSelections", "selection", "newCursorPosition", "Position", "newSelections", "primarySelection", "selectionStartLineNumber", "selectionStartColumn", "Selection", "DragAndDropCommand", "position", "Range", "ModelDecorationOptions", "registerEditorContribution", "init_editorExtensions", "init_editorContextKeys", "init_arrays", "init_lifecycle", "init_mime", "init_network", "init_resources", "init_uri", "init_languageFeatures", "init_nls", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "builtInLabel", "localize", "SimplePasteAndDropProvider", "_model", "_ranges", "dataTransfer", "context", "token", "edit", "_position", "DefaultTextProvider", "Mimes", "_token", "textEntry", "insertText", "PathProvider", "entries", "extractUriList", "uriCount", "uri", "originalText", "Schemas", "label", "RelativePathProvider", "_workspaceContextService", "relativeUris", "coalesce", "root", "relativePath", "IWorkspaceContextService", "PasteHtmlProvider", "entry", "htmlText", "urlListEntry", "strUriList", "UriList", "URI", "DefaultDropProvidersFeature", "Disposable", "languageFeaturesService", "workspaceContextService", "ILanguageFeaturesService", "DefaultPasteProvidersFeature", "Disposable", "languageFeaturesService", "workspaceContextService", "DefaultTextProvider", "PathProvider", "RelativePathProvider", "PasteHtmlProvider", "__decorate", "__param", "ILanguageFeaturesService", "IWorkspaceContextService", "init_nls", "registerEditorContribution", "CopyPasteController", "registerEditorFeature", "DefaultPasteProvidersFeature", "registerEditorCommand", "EditorCommand", "changePasteTypeCommandId", "pasteWidgetVisibleCtx", "_accessor", "editor", "_args", "_a", "registerEditorAction", "EditorAction", "localize", "EditorContextKeys", "args", "id", "init_editorExtensions", "init_nls", "init_configurationRegistry", "init_platform", "init_arrays", "init_async", "init_lifecycle", "init_range", "init_languageFeatures", "TreeViewsDnDService", "uuid", "operation", "DraggedTreeItemsIdentifier", "identifier", "init_extensions", "init_instantiation", "ITreeViewsDnDService", "createDecorator", "registerSingleton", "TreeViewsDnDService", "init_editorState", "init_nls", "init_configuration", "init_contextkey", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "DropIntoEditorController_1", "defaultProviderConfig", "changeDropTypeCommandId", "dropWidgetVisibleCtx", "RawContextKey", "localize", "DropIntoEditorController", "Disposable", "editor", "instantiationService", "_configService", "_languageFeaturesService", "_treeViewsDragAndDropService", "LocalSelectionTransfer", "InlineProgressManager", "PostEditWidgetManager", "e", "position", "dragEvent", "_a", "p", "createCancelablePromise", "token", "tokenSource", "EditorStateCancellationTokenSource", "ourDataTransfer", "model", "providers", "provider", "mime", "edits", "activeEditIndex", "canShowWidget", "Range", "dataTransfer", "results", "raceCancellation", "edit", "err", "coalesce", "sortEditsByYieldTo", "preferredProviders", "configMime", "desiredId", "editIndex", "matchesMimeType", "VSDataTransfer", "toExternalVSDataTransfer", "DraggedTreeItemsIdentifier", "data", "id", "treeDataTransfer", "type", "value", "IInstantiationService", "IConfigurationService", "ILanguageFeaturesService", "ITreeViewsDnDService", "registerEditorContribution", "DropIntoEditorController", "registerEditorCommand", "EditorCommand", "changeDropTypeCommandId", "dropWidgetVisibleCtx", "_accessor", "editor", "_args", "_a", "registerEditorFeature", "DefaultDropProvidersFeature", "Registry", "Extensions", "editorConfigurationBaseNode", "defaultProviderConfig", "localize", "init_async", "init_lifecycle", "init_strings", "init_editorExtensions", "init_editorColorRegistry", "init_editorContextKeys", "init_model", "init_arraysFind", "init_async", "init_lifecycle", "init_position", "init_range", "init_selection", "init_textModelSearch", "init_range", "init_model", "init_textModel", "init_colorRegistry", "init_themeService", "FindDecorations", "editor", "scopes", "findScopeDecorationId", "element", "newStartPosition", "decorationId", "index", "desiredRange", "candidates", "candidate", "candidateOpts", "nextMatch", "newCurrentDecorationId", "matchPosition", "i", "len", "range", "changeAccessor", "rng", "lineBeforeEnd", "lineBeforeEndMaxColumn", "Range", "findMatches", "findScopes", "accessor", "findMatchesOptions", "newOverviewRulerApproximateDecorations", "lineCount", "approxPixelsPerLine", "mergeLinesDelta", "prevStartLineNumber", "prevEndLineNumber", "newFindMatchesDecorations", "findScope", "position", "r", "result", "ModelDecorationOptions", "themeColorFromId", "overviewRulerFindMatchForeground", "OverviewRulerLane", "minimapFindMatch", "MinimapPosition", "init_range", "ReplaceAllCommand", "editorSelection", "ranges", "replaceStrings", "model", "builder", "ops", "i", "o1", "o2", "Range", "resultOps", "previousOp", "op", "helper", "init_strings", "buildReplaceStringWithCasePreserved", "matches", "pattern", "containsHyphens", "validateSpecificSpecialCharacter", "containsUnderscores", "buildReplaceStringForSpecificSpecialCharacter", "containsUppercaseCharacter", "specialCharacter", "splitPatternAtSpecialCharacter", "splitMatchAtSpecialCharacter", "replaceString", "splitValue", "index", "StaticValueReplacePattern", "staticValue", "DynamicPiecesReplacePattern", "pieces", "ReplacePattern", "value", "ReplacePiece", "matches", "preserveCase", "buildReplaceStringWithCasePreserved", "result", "i", "len", "piece", "match", "repl", "lenOps", "opIdx", "idx", "matchIndex", "remainder", "index", "caseOps", "ReplacePieceBuilder", "source", "toCharIndex", "parseReplaceString", "replaceString", "chCode", "nextChCode", "nextNextChCode", "init_contextkey", "CONTEXT_FIND_WIDGET_VISIBLE", "RawContextKey", "CONTEXT_FIND_WIDGET_NOT_VISIBLE", "CONTEXT_FIND_INPUT_FOCUSED", "CONTEXT_REPLACE_INPUT_FOCUSED", "ToggleCaseSensitiveKeybinding", "ToggleWholeWordKeybinding", "ToggleRegexKeybinding", "ToggleSearchScopeKeybinding", "TogglePreserveCaseKeybinding", "FIND_IDS", "MATCHES_LIMIT", "RESEARCH_DELAY", "FindModelBoundToEditorModel", "editor", "state", "DisposableStore", "TimeoutTimer", "FindDecorations", "RunOnceScheduler", "e", "dispose", "model", "findScope", "moveCursor", "newFindScope", "findScopes", "endLineNumber", "Range", "findMatches", "editorSelection", "currentMatchesPosition", "matchAfterSelection", "findFirstIdxMonotonousOrArrLen", "match", "range", "matchesPosition", "before", "isUsingLineStops", "lineNumber", "column", "Position", "isRecursed", "nextMatchRange", "prevMatchRange", "searchRange", "position", "prevMatch", "after", "nextMatch", "captureMatches", "forceMove", "index", "decorationRange", "parseReplaceString", "ReplacePattern", "replacePattern", "selection", "replaceString", "command", "ReplaceCommand", "limitResultCount", "searchRanges", "scope", "searchData", "SearchParams", "searchRegex", "mod", "modelText", "fullModelRange", "resultText", "preserveCase", "ReplaceCommandThatPreservesSelection", "matches", "replaceStrings", "i", "len", "ReplaceAllCommand", "m", "selections", "Selection", "source", "init_dom", "init_async", "init_colorRegistry", "FindOptionsWidget", "Widget", "editor", "state", "keybindingService", "RunOnceScheduler", "toggleStyles", "asCssVariable", "inputActiveOptionBorder", "inputActiveOptionForeground", "inputActiveOptionBackground", "CaseSensitiveToggle", "FIND_IDS", "WholeWordsToggle", "RegexToggle", "e", "somethingChanged", "addDisposableListener", "EventType", "actionId", "kb", "init_event", "init_lifecycle", "init_range", "effectiveOptionValue", "override", "value", "FindReplaceState", "Disposable", "Emitter", "matchesPosition", "matchesCount", "currentMatch", "changeEvent", "somethingChanged", "Range", "newState", "moveCursor", "updateHistory", "_a", "oldEffectiveIsRegex", "oldEffectiveWholeWords", "oldEffectiveMatchCase", "oldEffectivePreserveCase", "newSearchScope", "existingSearchScope", "MATCHES_LIMIT", "init_dom", "init_async", "init_codicons", "init_errors", "init_lifecycle", "init_platform", "init_strings", "init_range", "init_nls", "init_dom", "init_codicons", "init_event", "init_nls", "NLS_DEFAULT_LABEL", "localize", "NLS_PRESERVE_CASE_LABEL", "PreserveCaseToggle", "Toggle", "opts", "Codicon", "ReplaceInput", "Widget", "parent", "contextViewProvider", "_showOptionButtons", "options", "Emitter", "appendPreserveCaseLabel", "history", "flexibleHeight", "flexibleWidth", "flexibleMaxHeight", "HistoryInputBox", "viaKeyboard", "e", "indexes", "event", "index", "newIndex", "EventHelper", "controls", "enabled", "value", "_a", "newWidth", "init_contextkey", "init_keybindingsRegistry", "init_nls", "init_lifecycle", "init_dom", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "historyNavigationVisible", "RawContextKey", "localize", "HistoryNavigationWidgetFocusContext", "HistoryNavigationForwardsEnablementContext", "HistoryNavigationBackwardsEnablementContext", "lastFocusedWidget", "widgets", "registerAndCreateHistoryNavigationContext", "scopedContextKeyService", "widget", "disposableStore", "DisposableStore", "historyNavigationWidgetFocus", "historyNavigationForwardsEnablement", "historyNavigationBackwardsEnablement", "onDidFocus", "onDidBlur", "isActiveElement", "toDisposable", "ContextScopedFindInput", "FindInput", "container", "contextViewProvider", "options", "contextKeyService", "IContextKeyService", "ContextScopedReplaceInput", "ReplaceInput", "container", "contextViewProvider", "options", "contextKeyService", "showReplaceOptions", "scopedContextKeyService", "registerAndCreateHistoryNavigationContext", "__decorate", "__param", "IContextKeyService", "KeybindingsRegistry", "ContextKeyExpr", "HistoryNavigationWidgetFocusContext", "HistoryNavigationBackwardsEnablementContext", "historyNavigationVisible", "accessor", "lastFocusedWidget", "HistoryNavigationForwardsEnablementContext", "showHistoryKeybindingHint", "keybindingService", "_a", "_b", "init_colorRegistry", "init_themeService", "init_themables", "init_theme", "init_types", "findSelectionIcon", "registerIcon", "Codicon", "localize", "findCollapsedIcon", "findExpandedIcon", "findReplaceIcon", "findReplaceAllIcon", "findPreviousMatchIcon", "findNextMatchIcon", "NLS_FIND_DIALOG_LABEL", "NLS_FIND_INPUT_LABEL", "NLS_FIND_INPUT_PLACEHOLDER", "NLS_PREVIOUS_MATCH_BTN_LABEL", "NLS_NEXT_MATCH_BTN_LABEL", "NLS_TOGGLE_SELECTION_FIND_TITLE", "NLS_CLOSE_BTN_LABEL", "NLS_REPLACE_INPUT_LABEL", "NLS_REPLACE_INPUT_PLACEHOLDER", "NLS_REPLACE_BTN_LABEL", "NLS_REPLACE_ALL_BTN_LABEL", "NLS_TOGGLE_REPLACE_MODE_BTN_LABEL", "NLS_MATCHES_COUNT_LIMIT_TITLE", "MATCHES_LIMIT", "NLS_MATCHES_LOCATION", "NLS_NO_RESULTS", "FIND_WIDGET_INITIAL_WIDTH", "PART_WIDTH", "FIND_INPUT_AREA_WIDTH", "MAX_MATCHES_COUNT_WIDTH", "FIND_INPUT_AREA_HEIGHT", "ctrlEnterReplaceAllWarningPromptedKey", "ctrlKeyMod", "isMacintosh", "FindWidgetViewZone", "afterLineNumber", "stopPropagationForMultiLineUpwards", "event", "value", "textarea", "isMultiline", "stopPropagationForMultiLineDownwards", "FindWidget", "Widget", "codeEditor", "controller", "state", "contextViewProvider", "keybindingService", "contextKeyService", "themeService", "storageService", "notificationService", "Delayer", "toDisposable", "e", "supportLoop", "addExtraSpaceOnTop", "globalBufferTerm", "CONTEXT_FIND_INPUT_FOCUSED", "trackFocus", "CONTEXT_REPLACE_INPUT_FOCUSED", "getTotalWidth", "showRedOutline", "onUnexpectedError", "label", "matchesCount", "matchesPosition", "format", "alert", "currentMatch", "searchString", "ariaLabel", "model", "selection", "isSelection", "isChecked", "findInputIsNonEmpty", "canReplace", "isSelectionMultipleLine", "adjustEditorScrollTop", "domNode", "editorCoords", "getDomNodePagePosition", "startCoords", "startLeft", "startTop", "leftOfFindWidget", "getTopLeftOffset", "endCoords", "focusTheEditor", "targetScrollTop", "viewZone", "accessor", "adjustScroll", "newHeight", "scrollAdjustment", "layoutInfo", "editorWidth", "minimapWidth", "collapsedFindWidget", "reducedFindWidget", "narrowFindWidget", "findInputWidth", "totalheight", "totalHeight", "selections", "Range", "element", "isWindows", "isNative", "_sash", "actionId", "kb", "ContextScopedFindInput", "FIND_IDS", "showHistoryKeybindingHint", "defaultInputBoxStyles", "defaultToggleStyles", "isLinux", "SimpleButton", "assertIsDefined", "findPart", "actionsContainer", "Toggle", "asCssVariable", "inputActiveOptionBackground", "inputActiveOptionBorder", "inputActiveOptionForeground", "widgetClose", "ContextScopedReplaceInput", "replacePart", "replaceActionsContainer", "Sash", "originalWidth", "evt", "width", "maxWidth", "getComputedStyle", "currentWidth", "opts", "className", "ThemeIcon", "_a", "_b", "enabled", "expanded", "registerThemingParticipant", "theme", "collector", "findMatchHighlightBorder", "editorFindMatchHighlightBorder", "isHighContrast", "findRangeHighlightBorder", "editorFindRangeHighlightBorder", "hcBorder", "contrastBorder", "init_nls", "init_actions", "init_contextkey", "init_themeService", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "CommonFindController_1", "SEARCH_STRING_MAX_LENGTH", "getSelectionSearchString", "editor", "seedSearchStringFromSelection", "seedSearchStringFromNonEmptySelection", "selection", "wordAtPosition", "CommonFindController", "Disposable", "contextKeyService", "storageService", "clipboardService", "notificationService", "CONTEXT_FIND_WIDGET_VISIBLE", "Delayer", "FindReplaceState", "e", "shouldRestartFind", "CONTEXT_FIND_INPUT_FOCUSED", "selections", "element", "searchString", "escapeRegExpCharacters", "ignoreWhenVisible", "opts", "newState", "stateChanges", "selectionSearchString", "currentSelections", "FindModelBoundToEditorModel", "index", "_a", "localize", "text", "IContextKeyService", "IStorageService", "IClipboardService", "INotificationService", "FindController", "CommonFindController", "editor", "_contextViewService", "_contextKeyService", "_keybindingService", "_themeService", "notificationService", "_storageService", "clipboardService", "opts", "newState", "selection", "updateSearchScope", "ignoreWhenVisible", "FindWidget", "FindOptionsWidget", "__decorate", "__param", "IContextViewService", "IContextKeyService", "IKeybindingService", "IThemeService", "INotificationService", "IStorageService", "IClipboardService", "StartFindAction", "registerMultiEditorAction", "MultiEditorAction", "FIND_IDS", "localize", "ContextKeyExpr", "EditorContextKeys", "MenuId", "accessor", "editor", "args", "controller", "CommonFindController", "findArgDescription", "StartFindWithArgsAction", "EditorAction", "newState", "StartFindWithSelectionAction", "MatchFindAction", "NextMatchFindAction", "CONTEXT_FIND_INPUT_FOCUSED", "PreviousMatchFindAction", "MoveToMatchFindAction", "CONTEXT_FIND_WIDGET_VISIBLE", "matchesCount", "INotificationService", "Severity", "inputBox", "IQuickInputService", "toFindMatchIndex", "value", "index", "matchCount", "updatePickerAndEditor", "currentMatch", "changeAccessor", "range", "themeColorFromId", "overviewRulerRangeHighlight", "OverviewRulerLane", "SelectionMatchFindAction", "selectionSearchString", "getSelectionSearchString", "NextSelectionMatchFindAction", "PreviousSelectionMatchFindAction", "StartFindReplaceAction", "currentSelection", "findInputFocused", "seedSearchStringFromSelection", "shouldFocus", "registerEditorContribution", "FindController", "registerEditorAction", "FindCommand", "EditorCommand", "registerEditorCommand", "x", "ToggleCaseSensitiveKeybinding", "ToggleWholeWordKeybinding", "ToggleRegexKeybinding", "ToggleSearchScopeKeybinding", "TogglePreserveCaseKeybinding", "CONTEXT_REPLACE_INPUT_FOCUSED", "init_async", "init_cancellation", "init_errors", "init_keyCodes", "init_lifecycle", "init_strings", "init_types", "init_editorExtensions", "init_editorContextKeys", "init_languages", "init_languageConfigurationRegistry", "init_event", "foldSourceAbbr", "MAX_FOLDING_REGIONS", "MAX_LINE_NUMBER", "MASK_INDENT", "BitField", "size", "numWords", "index", "arrayIndex", "bit", "newState", "value", "FoldingRegions", "startIndexes", "endIndexes", "types", "parentIndexes", "isInsideLast", "startLineNumber", "endLineNumber", "len", "parentIndex", "source", "type", "hasChanged", "i", "FoldingRegion", "parent", "line", "low", "high", "mid", "res", "ranges", "rangesLength", "gotTypes", "range", "regions", "rangesA", "rangesB", "maxLineNumber", "getIndexedFunction", "r", "limit", "getA", "getB", "indexA", "indexB", "nextA", "nextB", "stackedRanges", "topStackedRange", "prevLineNumber", "resultRanges", "useRange", "scanIndex", "prescanB", "lineNumber", "init_hash", "FoldingModel", "textModel", "decorationProvider", "Emitter", "FoldingRegions", "toggledRegions", "r1", "r2", "processed", "accessor", "k", "dirtyRegionEndLine", "lastHiddenLine", "updateDecorationsUntil", "index", "endLineNumber", "isCollapsed", "isManual", "region", "editorDecorationId", "newCollapseState", "ranges", "newFoldingRanges", "intersects", "foldRange", "range", "i", "newRegions", "blockedLineNumers", "foldedOrManualRanges", "newRanges", "newEditorDecorations", "limit", "startLineNumber", "decorationRange", "isBlocked", "blockedLineNumber", "foldedRanges", "source", "decRange", "result", "maxLineNumber", "checksum", "state", "_a", "_b", "rangesToRestore", "lineNumber1", "lineNumber2", "hash", "lineNumber", "filter", "level", "current", "levelStack", "len", "toggleCollapseState", "foldingModel", "levels", "lineNumbers", "toToggle", "doCollapse", "regionsInside", "r", "setCollapseStateLevelsDown", "setCollapseStateLevelsUp", "regions", "setCollapseStateUp", "setCollapseStateAtLevel", "foldLevel", "blockedLineNumbers", "line", "setCollapseStateForRest", "filteredRegions", "filteredRegion", "setCollapseStateForMatchingLines", "regExp", "editorModel", "setCollapseStateForType", "type", "getParentFoldLine", "foldingRegion", "parentFoldingIdx", "getPreviousFoldLine", "expectedParentIndex", "minLineNumber", "getNextFoldLine", "init_arraysFind", "init_event", "init_range", "init_eolCounter", "HiddenRangeModel", "model", "Emitter", "_", "change", "countEOL", "updateHiddenAreas", "newHiddenAreas", "k", "lastCollapsedStart", "lastCollapsedEnd", "ranges", "startLineNumber", "endLineNumber", "Range", "line", "findRange", "selections", "hasChanges", "editorModel", "lastRange", "adjustLine", "isInside", "i", "len", "selection", "adjustedStartLine", "adjustedEndLine", "range", "findFirstIdxMonotonousOrArrLen", "r", "init_utils", "MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT", "ID_INDENT_PROVIDER", "IndentRangeProvider", "editorModel", "languageConfigurationService", "foldingRangesLimit", "cancelationToken", "foldingRules", "offSide", "markers", "computeRanges", "RangesCollector", "startLineNumber", "endLineNumber", "indent", "MAX_LINE_NUMBER", "index", "model", "limit", "startIndexes", "endIndexes", "i", "k", "FoldingRegions", "entries", "maxIndent", "n", "tabSize", "startIndex", "lineContent", "computeIndentLevel", "foldingRangesLimitDefault", "result", "pattern", "previousRegions", "line", "previous", "m", "init_nls", "init_contextkey", "init_codicons", "init_model", "init_textModel", "init_nls", "init_colorRegistry", "init_themeService", "init_themables", "foldBackground", "registerColor", "transparent", "editorSelectionBackground", "localize", "iconForeground", "foldingExpandedIcon", "registerIcon", "Codicon", "foldingCollapsedIcon", "foldingManualCollapsedIcon", "foldingManualExpandedIcon", "foldedBackgroundMinimap", "themeColorFromId", "MinimapPosition", "collapsed", "expanded", "FoldingDecorationProvider", "editor", "isCollapsed", "isHidden", "isManual", "callback", "decorationIds", "ModelDecorationOptions", "ThemeIcon", "init_errors", "init_lifecycle", "foldingContext", "ID_SYNTAX_PROVIDER", "SyntaxRangeProvider", "editorModel", "providers", "handleFoldingRangesChange", "foldingRangesLimit", "fallbackRangeProvider", "DisposableStore", "provider", "cancellationToken", "collectSyntaxRanges", "ranges", "_a", "_b", "sanitizeRanges", "model", "rangeData", "promises", "i", "nLines", "r", "onUnexpectedExternalError", "_", "RangesCollector", "startLineNumber", "endLineNumber", "type", "nestingLevel", "MAX_LINE_NUMBER", "index", "limit", "startIndexes", "endIndexes", "FoldingRegions", "entries", "maxLevel", "n", "types", "k", "level", "sorted", "d1", "d2", "diff", "collector", "top", "previous", "entry", "init_languageFeatureDebounce", "init_stopwatch", "init_languageFeatures", "init_event", "init_commands", "init_uri", "init_model", "init_configuration", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "FoldingController_1", "CONTEXT_FOLDING_ENABLED", "RawContextKey", "FoldingController", "Disposable", "editor", "languageFeaturesService", "model", "_a", "_b", "foldingRangeProviders", "contextKeyService", "languageConfigurationService", "notificationService", "languageFeatureDebounceService", "DisposableStore", "RangesLimitReporter", "options", "FoldingDecorationProvider", "e", "collapsedRegions", "provider", "state", "FoldingModel", "HiddenRangeModel", "hr", "Delayer", "RunOnceScheduler", "editorModel", "indentRangeProvider", "IndentRangeProvider", "selectedProviders", "SyntaxRangeProvider", "foldingModel", "sw", "StopWatch", "foldingRegionPromise", "createCancelablePromise", "token", "foldingRanges", "scrollState", "hasChanges", "FoldingRangeKind", "StableEditorScrollState", "selections", "selectionLineNumbers", "s", "newValue", "err", "onUnexpectedError", "hiddenRanges", "toToggle", "selection", "lineNumber", "r", "range", "iconClicked", "data", "offsetLeftInGutter", "region", "isCollapsed", "surrounding", "filter", "otherRegion", "toMaybeToggle", "recursive", "position", "IContextKeyService", "ILanguageConfigurationService", "INotificationService", "ILanguageFeatureDebounceService", "ILanguageFeaturesService", "RangesLimitReporter", "editor", "Emitter", "computed", "limited", "FoldingAction", "EditorAction", "accessor", "args", "languageConfigurationService", "ILanguageConfigurationService", "foldingController", "FoldingController", "foldingModelPromise", "foldingModel", "selection", "selections", "s", "l", "_accessor", "_editor", "foldingArgumentsConstraint", "isUndefined", "isObject", "foldingArgs", "isNumber", "isString", "UnfoldAction", "localize", "CONTEXT_FOLDING_ENABLED", "EditorContextKeys", "_foldingController", "levels", "lineNumbers", "setCollapseStateLevelsUp", "setCollapseStateLevelsDown", "UnFoldRecursivelyAction", "KeyChord", "_args", "FoldAction", "direction", "setCollapseStateUp", "ToggleFoldAction", "selectedLines", "toggleCollapseState", "FoldRecursivelyAction", "FoldAllBlockCommentsAction", "setCollapseStateForType", "FoldingRangeKind", "editorModel", "comments", "regExp", "escapeRegExpCharacters", "setCollapseStateForMatchingLines", "FoldAllRegionsAction", "foldingRules", "UnfoldAllRegionsAction", "FoldAllExceptAction", "setCollapseStateForRest", "UnfoldAllExceptAction", "FoldAllAction", "UnfoldAllAction", "FoldLevelAction", "setCollapseStateAtLevel", "level", "GotoParentFoldAction", "startLineNumber", "getParentFoldLine", "GotoPreviousFoldAction", "getPreviousFoldLine", "GotoNextFoldAction", "getNextFoldLine", "FoldRangeFromSelectionAction", "_a", "collapseRanges", "endLineNumber", "a", "b", "newRanges", "FoldingRegions", "RemoveFoldRangeFromSelectionAction", "ranges", "registerEditorContribution", "registerEditorAction", "i", "registerInstantiatedEditorAction", "CommandsRegistry", "resource", "URI", "illegalArgument", "languageFeaturesService", "ILanguageFeaturesService", "model", "IModelService", "configurationService", "IConfigurationService", "strategy", "foldingLimitReporter", "indentRangeProvider", "IndentRangeProvider", "rangeProvider", "providers", "SyntaxRangeProvider", "CancellationToken", "result", "type", "init_editorExtensions", "init_nls", "EditorFontZoomIn", "EditorAction", "localize", "accessor", "editor", "EditorZoom", "EditorFontZoomOut", "EditorFontZoomReset", "registerEditorAction", "init_arrays", "init_cancellation", "init_errors", "init_keyCodes", "init_lifecycle", "init_editorExtensions", "init_codeEditorService", "init_characterClassifier", "init_range", "init_editorContextKeys", "init_editorWorker", "init_languageFeatures", "init_nls", "init_commands", "init_contextkey", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "FormatOnType", "_editor", "_languageFeaturesService", "_workerService", "_accessibilitySignalService", "DisposableStore", "e", "model", "support", "triggerChars", "CharacterSet", "ch", "text", "lastCharCode", "position", "cts", "CancellationTokenSource", "unbind", "len", "getOnTypeFormattingEdits", "edits", "isNonEmptyArray", "AccessibilitySignal", "FormattingEdit", "ILanguageFeaturesService", "IEditorWorkerService", "IAccessibilitySignalService", "FormatOnPaste", "editor", "_languageFeaturesService", "_instantiationService", "DisposableStore", "range", "formatDocumentRangesWithSelectedProvider", "Progress", "CancellationToken", "onUnexpectedError", "__decorate", "__param", "ILanguageFeaturesService", "IInstantiationService", "FormatDocumentAction", "EditorAction", "localize", "ContextKeyExpr", "EditorContextKeys", "accessor", "instaService", "IEditorProgressService", "formatDocumentWithSelectedProvider", "FormatSelectionAction", "KeyChord", "model", "ranges", "Range", "registerEditorContribution", "FormatOnType", "registerEditorAction", "CommandsRegistry", "ICodeEditorService", "commandService", "ICommandService", "init_cancellation", "init_types", "init_uri", "init_resolverService", "init_outlineModel", "init_commands", "CommandsRegistry", "accessor", "args", "resource", "assertType", "URI", "outlineService", "IOutlineModelService", "reference", "ITextModelService", "CancellationToken", "init_editorExtensions", "init_observable", "init_base", "init_editorExtensions", "init_editorContextKeys", "init_observable", "init_strings", "init_cursorColumns", "init_contextkey", "init_lifecycle", "init_nls", "InlineCompletionContextKeys", "Disposable", "contextKeyService", "model", "autorun", "reader", "state", "isInlineCompletionVisible", "startsWithIndentation", "startsWithIndentationLessThanTabSize", "ghostText", "column", "lines", "firstLine", "indentationEndColumn", "firstNonWsIdx", "firstNonWhitespaceIndex", "tabSize", "CursorColumns", "RawContextKey", "localize", "init_dom", "init_lifecycle", "init_observable", "init_position", "init_languageFeatureDebounce", "init_languageFeatures", "init_event", "init_lifecycle", "init_observable", "init_strings", "init_position", "init_range", "init_stringBuilder", "init_language", "init_model", "init_lineTokens", "init_arrays", "init_strings", "init_errors", "init_lifecycle", "init_observable", "init_position", "init_range", "applyEdits", "text", "edits", "transformer", "PositionOffsetTransformer", "offsetEdits", "e", "range", "Range", "a", "b", "edit", "i", "position", "array", "getReadonlyEmptyArray", "ColumnRange", "startColumn", "endColumnExclusive", "BugIndicatingError", "lineNumber", "other", "applyObservableDecorations", "editor", "decorations", "d", "DisposableStore", "decorationsCollection", "autorunOpts", "reader", "addPositions", "pos1", "pos2", "Position", "subtractPositions", "lengthOfText", "line", "column", "c", "getNewRanges", "_a", "newRanges", "previousEditEndLineNumber", "lineOffset", "columnOffset", "textLength", "newRangeStart", "newRangeEnd", "Permutation", "_indexMap", "arr", "compareFn", "sortIndices", "index1", "index2", "_", "index", "inverseIndexMap", "GhostText", "lineNumber", "parts", "other", "part", "index", "lineText", "lastPart", "cappedLineText", "applyEdits", "p", "r", "GhostTextPart", "column", "text", "preview", "splitLines", "line", "GhostTextReplacement", "columnRange", "additionalReservedLineCount", "_lineText", "ghostTextsOrReplacementsEqual", "a", "b", "equals", "ghostTextOrReplacementEquals", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "GHOST_TEXT_DESCRIPTION", "GhostTextWidget", "Disposable", "editor", "model", "languageService", "observableValue", "observableFromEvent", "derived", "reader", "textModel", "ghostText", "replacedRange", "GhostTextReplacement", "inlineTexts", "additionalLines", "addToAdditionalLines", "lines", "className", "lastLine", "LineDecoration", "line", "textBufferLine", "hiddenTextStartColumn", "lastIdx", "part", "hiddenRange", "ColumnRange", "uiState", "decorations", "p", "Range", "Position", "InjectedTextCursorStops", "AdditionalLinesWidget", "toDisposable", "applyObservableDecorations", "viewZoneId", "ILanguageService", "AdditionalLinesWidget", "Disposable", "editor", "languageIdCodec", "lines", "observableSignalFromEvent", "Event", "e", "autorun", "reader", "changeAccessor", "lineNumber", "additionalLines", "minReservedLineCount", "textModel", "tabSize", "heightInLines", "domNode", "renderLines", "opts", "disableMonospaceOptimizations", "stopRenderingLineAfter", "renderWhitespace", "renderControlCharacters", "fontLigatures", "fontInfo", "lineHeight", "sb", "StringBuilder", "i", "len", "lineData", "line", "isBasicASCII", "containsRTL", "lineTokens", "LineTokens", "renderViewLine", "RenderLineInput", "EditorFontLigatures", "applyFontInfo", "html", "trustedhtml", "ttPolicy", "createTrustedTypesPolicy", "value", "init_arraysFind", "init_errors", "init_lifecycle", "init_observable", "init_strings", "init_types", "init_position", "init_range", "init_selection", "init_languages", "init_languageConfigurationRegistry", "init_cancellation", "init_filters", "init_lifecycle", "init_observable", "init_position", "init_languages", "init_languageConfigurationRegistry", "init_languageFeatures", "init_assert", "init_async", "init_cancellation", "init_map", "init_errors", "init_range", "init_brackets", "init_length", "init_parser", "init_smallImmutableSet", "init_tokenizer", "fixBracketsInLine", "tokens", "languageConfigurationService", "denseKeyProvider", "DenseKeyProvider", "bracketTokens", "LanguageAgnosticBracketTokens", "languageId", "tokenizer", "TextBufferTokenizer", "StaticTokenizerSource", "node", "parseDocument", "str", "line", "processNode", "offset", "lengthAdd", "closingTokenText", "child", "lengthZero", "lines", "lineNumber", "provideInlineCompletions", "registry", "position", "model", "context", "token", "CancellationToken", "languageConfigurationService", "defaultReplaceRange", "getDefaultRange", "providers", "multiMap", "SetMap", "provider", "getPreferredProviders", "result", "groupId", "p", "states", "seen", "findPreferredProviderCircle", "stack", "preferred", "c", "processProvider", "state", "circle", "onUnexpectedExternalError", "s", "deferredPromise", "DeferredPromise", "e", "providerResults", "itemsByHash", "lists", "completions", "list", "InlineCompletionList", "item", "inlineCompletionItem", "InlineCompletionItem", "InlineCompletionProviderResult", "hashs", "inlineCompletions", "inlineCompletion", "source", "textModel", "insertText", "snippetInfo", "range", "Range", "closeBrackets", "diff", "preBracketCompletionLength", "snippet", "SnippetParser", "Text", "assertNever", "getReadonlyEmptyArray", "filterText", "command", "additionalTextEdits", "sourceInlineCompletion", "updatedRange", "word", "maxColumn", "text", "newLine", "newTokens", "slicedTokens", "fixBracketsInLine", "init_strings", "init_range", "SingleTextEdit", "range", "text", "model", "validModelRange", "modelRange", "valueToReplace", "commonPrefixLen", "commonPrefixLength", "start", "addPositions", "lengthOfText", "Range", "base", "rangeExtends", "mode", "cursorPosition", "previewSuffixLength", "edit", "sourceLine", "sourceIndentationLength", "getLeadingWhitespace", "suggestionAddedIndentationLength", "replacedIndentation", "startPosition", "endPosition", "newStartPosition", "rangeThatDoesNotReplaceIndentation", "suggestionWithoutIndentationChange", "valueToBeReplaced", "changes", "cachingDiff", "lineNumber", "parts", "filteredChanges", "c", "previewStartInCompletionText", "insertColumn", "modifiedEnd", "nonPreviewTextEnd", "nonPreviewText", "italicText", "GhostTextPart", "GhostText", "extendingRange", "rangeToExtend", "lastRequest", "originalValue", "newValue", "smartDiff", "deletedChars", "deletedCharacters", "newChanges", "sum", "smartBracketMatching", "getMaxCharCode", "val", "maxCharCode", "i", "len", "charCode", "getUniqueCharCode", "id", "getElements", "source", "level", "group", "characters", "elements1", "elements2", "LcsDiff", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlineCompletionsSource", "Disposable", "textModel", "versionId", "_debounceValue", "languageFeaturesService", "languageConfigurationService", "MutableDisposable", "disposableObservableValue", "position", "context", "activeInlineCompletion", "_a", "_b", "request", "UpdateRequest", "updateOngoing", "source", "CancellationTokenSource", "promise", "InlineCompletionTriggerKind", "wait", "startTime", "updatedCompletions", "provideInlineCompletions", "endTime", "completions", "UpToDateInlineCompletions", "asInlineCompletion", "transaction", "tx", "updateOperation", "UpdateOperation", "ILanguageFeaturesService", "ILanguageConfigurationService", "wait", "ms", "cancellationToken", "resolve", "d", "handle", "UpdateRequest", "position", "context", "versionId", "other", "equals", "v1", "v2", "InlineCompletionTriggerKind", "UpdateOperation", "request", "cancellationTokenSource", "promise", "UpToDateInlineCompletions", "inlineCompletionProviderResult", "textModel", "derived", "reader", "changed", "i", "ids", "index", "InlineCompletionWithUpdatedRange", "inlineCompletion", "range", "addRefToSource", "id", "_a", "decorationId", "rangeVersion", "initialRange", "SingleTextEdit", "model", "cursorPosition", "minimizedReplacement", "originalValue", "filterText", "cursorPosIndex", "filterTextBefore", "filterTextAfter", "originalValueBefore", "originalValueAfter", "originalValueIndent", "matchesSubString", "length", "Position", "init_lifecycle", "init_types", "init_editorExtensions", "init_position", "init_editorContextKeys", "init_languageConfigurationRegistry", "init_languageFeatures", "init_cancellation", "init_errors", "init_filters", "init_lifecycle", "init_stopwatch", "init_types", "init_uri", "init_position", "init_range", "init_resolverService", "init_nls", "init_actions", "init_commands", "init_contextkey", "init_languageFeatures", "Context", "historyNavigationVisible", "RawContextKey", "localize", "suggestWidgetStatusbarMenu", "MenuId", "CompletionItem", "position", "completion", "container", "provider", "_a", "FuzzyScore", "Range", "Position", "token", "sub", "sw", "StopWatch", "value", "err", "isCancellationError", "CompletionOptions", "snippetSortOrder", "kindFilter", "providerFilter", "providerItemsToReuse", "showDeprecated", "_snippetSuggestSupport", "getSnippetSuggestSupport", "CompletionItemModel", "items", "needsClipboard", "durations", "disposable", "provideSuggestionItems", "registry", "model", "options", "context", "CancellationToken", "word", "defaultReplaceRange", "defaultRange", "result", "disposables", "DisposableStore", "onCompletionList", "_b", "_c", "didAddResult", "suggestion", "SnippetParser", "isDisposable", "snippetCompletions", "reuseItems", "item", "list", "providerGroup", "onUnexpectedExternalError", "CancellationError", "getSuggestionComparator", "defaultComparator", "a", "b", "snippetUpComparator", "snippetDownComparator", "_snippetComparators", "snippetConfig", "CommandsRegistry", "accessor", "args", "uri", "triggerCharacter", "maxItemsToResolve", "assertType", "URI", "completionProvider", "ILanguageFeaturesService", "ref", "ITextModelService", "resolving", "actualPosition", "completions", "showSimpleSuggestions", "editor", "QuickSuggestionsOptions", "config", "tokenType", "init_nls", "init_contextkey", "init_log", "init_arrays", "init_lifecycle", "init_strings", "init_range", "init_selection", "init_languageConfigurationRegistry", "init_textModel", "init_extpath", "init_platform", "normalizeDriveLetter", "path", "isWindowsOS", "isWindows", "hasDriveLetter", "init_path", "init_resources", "init_strings", "init_languageConfigurationRegistry", "init_nls", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "KnownSnippetVariableNames", "CompositeSnippetVariableResolver", "_delegates", "variable", "delegate", "value", "SelectionBasedVariableResolver", "_model", "_selection", "_selectionIdx", "_overtypingCapturer", "name", "isMultiline", "info", "line", "lineLeadingWhitespace", "getLeadingWhitespace", "varLeadingWhitespace", "marker", "Text", "splitLines", "whitespaceCommonLength", "commonPrefixLength", "m", "newline", "rest", "ModelBasedVariableResolver", "_labelService", "basename", "idx", "dirname", "ClipboardBasedVariableResolver", "_readClipboardText", "_selectionCount", "_spread", "clipboardText", "lines", "s", "isFalsyOrWhitespace", "CommentBasedVariableResolver", "_languageConfigurationService", "langId", "config", "ILanguageConfigurationService", "TimeBasedVariableResolver", "variable", "name", "rawTimeOffset", "sign", "hours", "hoursString", "minutes", "minutesString", "localize", "WorkspaceBasedVariableResolver", "_workspaceService", "workspaceIdentifier", "toWorkspaceIdentifier", "isEmptyWorkspaceIdentifier", "isSingleFolderWorkspaceIdentifier", "basename", "filename", "WORKSPACE_EXTENSION", "normalizeDriveLetter", "folderpath", "RandomBasedVariableResolver", "generateUuid", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SnippetSession_1", "OneSnippet", "_editor", "_snippet", "_snippetLineLeadingWhitespace", "groupBy", "Placeholder", "textChange", "model", "accessor", "placeholder", "placeholderOffset", "placeholderLen", "range", "Range", "options", "handle", "fwd", "operations", "id", "currentValue", "transformedValueLines", "EditOperation", "couldSkipThisPlaceholder", "newSelections", "activePlaceholders", "selections", "Selection", "enclosingPlaceholder", "marker", "result", "placeholdersWithEqualIndex", "ranges", "Choice", "others", "nested", "indexLastPlaceholder", "nestedPlaceholder", "ModelDecorationOptions", "_defaultOptions", "SnippetSession", "position", "adjustIndentation", "snippet", "filter", "line", "lineLeadingWhitespace", "getLeadingWhitespace", "snippetTextString", "Text", "lines", "offset", "prevChar", "newValue", "selection", "overwriteBefore", "overwriteAfter", "positionLineNumber", "positionColumn", "positionColumnBefore", "positionColumnAfter", "editor", "template", "enforceFinalTabstop", "adjustWhitespace", "clipboardText", "overtypingCapturer", "languageConfigurationService", "edits", "snippets", "workspaceService", "IWorkspaceContextService", "modelBasedVariableResolver", "ModelBasedVariableResolver", "ILabelService", "readClipboardText", "firstBeforeText", "firstAfterText", "firstLineFirstNonWhitespace", "indexedSelections", "idx", "a", "b", "extensionBefore", "extensionAfter", "snippetSelection", "SnippetParser", "start", "snippetLineLeadingWhitespace", "CompositeSnippetVariableResolver", "ClipboardBasedVariableResolver", "SelectionBasedVariableResolver", "CommentBasedVariableResolver", "TimeBasedVariableResolver", "WorkspaceBasedVariableResolver", "RandomBasedVariableResolver", "snippetEdits", "parser", "TextmateSnippet", "resolver", "lastRange", "textRange", "textNode", "newNodes", "snippetText", "snippetFragmentText", "edit", "_template", "_options", "_languageConfigurationService", "dispose", "_undoEdits", "undoEdits", "isTrivialSnippet", "oneSelection", "allPossibleSelections", "possibleSelections", "index", "array", "ILanguageConfigurationService", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SnippetController2_1", "_defaultOptions", "SnippetController2", "editor", "_editor", "_logService", "_languageFeaturesService", "contextKeyService", "_languageConfigurationService", "DisposableStore", "_a", "template", "opts", "e", "assertType", "SnippetSession", "provider", "model", "position", "Position", "activeChoice", "word", "isAnyOfOptions", "o", "suggestions", "option", "localize", "registration", "isRegistered", "disable", "enable", "showSimpleSuggestions", "resetSelection", "RawContextKey", "ILogService", "ILanguageFeaturesService", "IContextKeyService", "ILanguageConfigurationService", "registerEditorContribution", "SnippetController2", "CommandCtor", "EditorCommand", "registerEditorCommand", "ContextKeyExpr", "ctrl", "EditorContextKeys", "init_commands", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "VersionIdChangeReason", "InlineCompletionsModel", "Disposable", "textModel", "selectedSuggestItem", "textModelVersionId", "_positions", "_debounceValue", "_suggestPreviewEnabled", "_suggestPreviewMode", "_inlineSuggestMode", "_enabled", "_instantiationService", "_commandService", "_languageConfigurationService", "InlineCompletionsSource", "observableValue", "observableSignal", "derived", "reader", "_a", "Position", "derivedHandleChanges", "InlineCompletionTriggerKind", "ctx", "changeSummary", "itemToPreserveCandidate", "itemToPreserve", "suggestWidgetInlineCompletions", "suggestItem", "inlineCompletions", "transaction", "tx", "cursorPosition", "context", "selectedInlineCompletionId", "filteredCompletions", "idx", "v", "derivedOpts", "a", "b", "ghostTextsOrReplacementsEqual", "_b", "model", "suggestCompletionEdit", "augmentation", "fullEdit", "fullEditPreviewLength", "mode", "positions", "edits", "getSecondaryEdits", "ghostTexts", "edit", "isDefined", "primaryGhostText", "GhostText", "inlineCompletion", "replacement", "ghostTextOrReplacementEquals", "recomputeInitiallyAndOnChange", "lastItem", "autorun", "item", "completion", "src", "subtransaction", "suggestCompletion", "candidateInlineCompletions", "mapFindFirst", "r", "Range", "delta", "completions", "newIdx", "editor", "BugIndicatingError", "state", "EditOperation", "SnippetController2", "selections", "getEndPositionsAfterApplying", "p", "Selection", "onUnexpectedExternalError", "pos", "text", "langId", "config", "wordRegExp", "m1", "acceptUntilIndexExclusive", "m2", "m", "getAcceptUntilIndex", "ghostText", "firstPart", "ghostTextPos", "ghostTextVal", "partialGhostTextVal", "replaceRange", "newText", "primaryEdit", "SingleTextEdit", "acceptedRange", "addPositions", "lengthOfText", "itemEdit", "augmentedCompletion", "IInstantiationService", "ICommandService", "ILanguageConfigurationService", "getSecondaryEdits", "textModel", "positions", "primaryEdit", "primaryPosition", "secondaryPositions", "primaryEditStartPosition", "primaryEditEndPosition", "replacedTextAfterPrimaryCursor", "Range", "positionWithinTextEdit", "subtractPositions", "onUnexpectedError", "BugIndicatingError", "secondaryEditText", "substringPos", "pos", "posEnd", "addPositions", "textAfterSecondaryCursor", "l", "commonPrefixLength", "range", "SingleTextEdit", "text", "subtext", "lines", "splitLinesIncludeSeparators", "i", "getEndPositionsAfterApplying", "edits", "sortPerm", "Permutation", "edit1", "edit2", "sortedNewRanges", "getNewRanges", "init_event", "init_lifecycle", "init_position", "init_range", "init_languages", "init_arrays", "init_cancellation", "init_errors", "init_event", "init_keybindings", "init_lifecycle", "init_platform", "init_stopwatch", "init_types", "init_editorExtensions", "init_position", "init_range", "init_editorContextKeys", "init_async", "init_lifecycle", "init_map", "init_languages", "init_configuration", "init_extensions", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SuggestMemoryService_1", "Memory", "name", "model", "pos", "items", "topScore", "score", "suggestion", "NoMemory", "item", "LRUMemory", "LRUCache", "lineSuffix", "indexPreselect", "indexRecency", "seq", "data", "value", "CompletionItemKinds", "PrefixMemory", "TernarySearchTree", "word", "kind", "insertText", "entries", "a", "b", "SuggestMemoryService", "_storageService", "_configService", "DisposableStore", "RunOnceScheduler", "e", "WillSaveStateReason", "_a", "mode", "ctor", "scope", "raw", "IStorageService", "IConfigurationService", "ISuggestMemoryService", "createDecorator", "registerSingleton", "SuggestMemoryService", "init_contextkey", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "WordContextKey_1", "WordContextKey", "_editor", "contextKeyService", "e", "_a", "enabled", "checkForWordEnd", "model", "selection", "word", "RawContextKey", "IContextKeyService", "init_nls", "init_commands", "init_contextkey", "init_instantiation", "init_log", "init_contextkey", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SuggestAlternatives_1", "SuggestAlternatives", "_editor", "contextKeyService", "_a", "model", "index", "acceptNext", "fwd", "newIndex", "rounds", "RawContextKey", "IContextKeyService", "init_arrays", "init_lifecycle", "init_characterClassifier", "CommitCharacterController", "editor", "widget", "model", "accept", "DisposableStore", "e", "text", "ch", "selected", "isNonEmptyArray", "acceptCharacters", "CharacterSet", "init_async", "init_cancellation", "init_errors", "init_event", "init_lifecycle", "init_strings", "init_selection", "init_editorWorker", "init_arrays", "init_range", "init_linkedList", "init_position", "init_range", "BracketSelectionRangeProvider", "model", "positions", "result", "position", "bucket", "ranges", "resolve", "round", "pos", "counts", "t1", "bracket", "key", "val", "list", "LinkedList", "closing", "innerBracket", "Range", "outerBracket", "startLine", "column", "Position", "aboveLine", "WordDistance", "service", "editor", "model", "position", "ranges", "BracketSelectionRangeProvider", "wordRanges", "wordUntilPos", "anchor", "item", "word", "wordLines", "isFalsyOrEmpty", "idx", "binarySearch", "Range", "bestWordRange", "blockDistance", "range", "init_configuration", "init_contextkey", "init_log", "init_telemetry", "init_arrays", "init_filters", "init_strings", "LineContext", "leadingLineContent", "characterCountDelta", "CompletionModel", "items", "column", "lineContext", "wordDistance", "options", "snippetSuggestions", "fuzzyScoreOptions", "FuzzyScoreOptions", "clipboardText", "value", "result", "provider", "labelLengths", "word", "wordLow", "source", "target", "scoreFn", "fuzzyScore", "fuzzyScoreGracefulAggressive", "i", "item", "arr", "overwriteBefore", "wordLen", "FuzzyScore", "wordPos", "ch", "match", "compareIgnoreCase", "anyScore", "quickSelect", "a", "b", "init_languageFeatures", "init_filters", "init_types", "init_environment", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SuggestModel_1", "LineContext", "editor", "model", "pos", "word", "position", "triggerOptions", "canShowQuickSuggest", "contextKeyService", "configurationService", "InlineCompletionContextKeys", "suppressSuggestions", "canShowSuggestOnTriggerCharacters", "SuggestModel", "_editor", "_editorWorkerService", "_clipboardService", "_telemetryService", "_logService", "_contextKeyService", "_configurationService", "_languageFeaturesService", "_envService", "DisposableStore", "TimeoutTimer", "Emitter", "Selection", "editorIsComposing", "e", "dispose", "supportsByTriggerCharacter", "support", "ch", "set", "getSnippetSuggestSupport", "checkTriggerCharacter", "text", "_a", "lastChar", "isLowSurrogate", "isHighSurrogate", "supports", "providerItemsToReuse", "provider", "items", "retrigger", "prevSelection", "QuickSuggestionsOptions", "SnippetController2", "config", "lineTokens", "tokenType", "assertType", "ctx", "options", "_b", "_c", "_d", "_e", "_f", "suggestCtx", "CancellationTokenSource", "snippetSuggestions", "snippetSortOrder", "itemKindFilter", "showDeprecated", "completionOptions", "CompletionOptions", "wordDistance", "WordDistance", "completions", "provideSuggestionItems", "clipboardText", "fuzzySearchOptions", "FuzzyScoreOptions", "CompletionModel", "item", "onUnexpectedError", "durations", "result", "suggestOptions", "getLeadingWhitespace", "map", "providerFilter", "oldLineContext", "isFrozen", "shouldAutoTrigger", "IEditorWorkerService", "IClipboardService", "ITelemetryService", "ILogService", "IContextKeyService", "IConfigurationService", "ILanguageFeaturesService", "IEnvironmentService", "init_lifecycle", "OvertypingCapturer", "editor", "suggestModel", "DisposableStore", "selections", "selectionsLength", "willOvertype", "i", "model", "selection", "e", "idx", "init_dom", "init_async", "init_errors", "init_event", "init_lifecycle", "init_numbers", "init_strings", "init_dom", "init_lifecycle", "init_nls", "init_actions", "init_contextkey", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StatusBarViewItem", "MenuEntryActionViewItem", "kb", "localize", "_a", "SuggestWidgetStatus", "container", "_menuId", "instantiationService", "_menuService", "_contextKeyService", "DisposableStore", "append", "$", "actionViewItemProvider", "action", "MenuItemAction", "ActionBar", "menu", "renderMenu", "left", "right", "group", "actions", "IInstantiationService", "IMenuService", "IContextKeyService", "init_nls", "init_contextkey", "init_instantiation", "init_colorRegistry", "init_theme", "init_themeService", "init_dom", "init_codicons", "init_themables", "init_event", "init_htmlContent", "init_lifecycle", "init_nls", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "canExpandCompletionItem", "item", "SuggestDetailsWidget", "_editor", "instaService", "Emitter", "DisposableStore", "Dimension", "$", "MarkdownRenderer", "DomScrollableElement", "append", "ThemeIcon", "Codicon", "localize", "e", "options", "fontInfo", "fontFamily", "fontSize", "lineHeight", "fontWeight", "fontSizePx", "lineHeightPx", "borderWidth", "borderHeight", "explainMode", "_a", "_b", "detail", "documentation", "md", "MarkdownString", "cappedDetail", "show", "clearNode", "hide", "renderedContents", "width", "height", "newSize", "size", "much", "IInstantiationService", "SuggestDetailsOverlay", "widget", "_editor", "DisposableStore", "ResizableHTMLElement", "topLeftNow", "sizeNow", "deltaTop", "deltaLeft", "e", "updateTopLeft", "_a", "sessionEnded", "anchor", "preferAlignAtTop", "anchorBox", "size", "bodyBox", "getClientArea", "info", "defaultMinSize", "Dimension", "defaultTop", "eastPlacement", "width", "left", "maxSizeTop", "maxSizeBottom", "westPlacement", "southPacement", "top", "placements", "placement", "p", "a", "b", "bottom", "alignAtTop", "height", "maxHeight", "maxSize", "editorDomNode", "editorBoundingBox", "topLeft", "init_dom", "init_codicons", "init_themables", "init_event", "init_filters", "init_lifecycle", "init_uri", "init_languages", "init_network", "init_resources", "init_modesRegistry", "FileKind", "fileIconDirectoryRegex", "getIconClasses", "modelService", "languageService", "resource", "fileKind", "icon", "classes", "FileKind", "name", "Schemas", "DataUri", "match", "cssEscape", "dotSegments", "i", "detectedLanguageId", "detectLanguageId", "languageId", "mime", "model", "PLAINTEXT_LANGUAGE_ID", "str", "init_model", "init_language", "init_nls", "init_themeService", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "_a", "getAriaId", "index", "suggestMoreInfoIcon", "registerIcon", "Codicon", "localize", "_completionItemColor", "item", "out", "value", "match", "ItemRenderer", "_editor", "_modelService", "_languageService", "_themeService", "Emitter", "container", "disposables", "DisposableStore", "root", "icon", "append", "$", "colorspan", "text", "main", "iconContainer", "left", "right", "iconLabel", "IconLabel", "parametersLabel", "qualifierLabel", "detailsLabel", "readMore", "ThemeIcon", "options", "fontInfo", "fontFamily", "fontFeatureSettings", "fontSize", "lineHeight", "fontWeight", "letterSpacing", "fontSizePx", "lineHeightPx", "letterSpacingPx", "element", "data", "completion", "labelOptions", "createMatches", "color", "labelClasses", "getIconClasses", "URI", "FileKind", "detailClasses", "CompletionItemKinds", "stripNewLines", "show", "hide", "canExpandCompletionItem", "e", "templateData", "IModelService", "ILanguageService", "IThemeService", "stripNewLines", "str", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SuggestWidget_1", "registerColor", "editorWidgetBackground", "localize", "editorWidgetBorder", "editorSuggestWidgetForeground", "editorForeground", "quickInputListFocusForeground", "quickInputListFocusIconForeground", "editorSuggestWidgetSelectedBackground", "quickInputListFocusBackground", "listHighlightForeground", "listFocusHighlightForeground", "transparent", "PersistedWidgetSize", "_service", "editor", "EmbeddedCodeEditorWidget", "_a", "raw", "obj", "Dimension", "size", "SuggestWidget", "_storageService", "_contextKeyService", "_themeService", "instantiationService", "MutableDisposable", "TimeoutTimer", "DisposableStore", "PauseableEmitter", "Emitter", "ResizableHTMLElement", "SuggestContentWidget", "ResizeState", "persistedSize", "currentSize", "persistHeight", "persistWidth", "state", "e", "_b", "_c", "_d", "itemHeight", "defaultSize", "threshold", "width", "height", "append", "$", "details", "SuggestDetailsWidget", "SuggestDetailsOverlay", "applyIconStyle", "renderer", "ItemRenderer", "List", "_element", "item", "label", "detail", "description", "documentation", "docs", "format", "getListStyles", "activeContrastBorder", "SuggestWidgetStatus", "suggestWidgetStatusbarMenu", "applyStatusBarStyle", "t", "Context", "addStandardDisposableListener", "mouseEvent", "index", "completionModel", "theme", "isHighContrast", "createCancelablePromise", "token", "loading", "disposableTimeout", "sub", "getAriaId", "onUnexpectedError", "hide", "show", "status", "auto", "delay", "selectionIndex", "isFrozen", "isAuto", "noFocus", "visibleCount", "isEmpty", "runAtThisOrScheduleAtNextAnimationFrame", "getWindow", "canExpandCompletionItem", "dim", "minPersistedHeight", "position", "bodyBox", "getClientArea", "info", "maxWidth", "preferredWidth", "fullHeight", "minHeight", "editorBox", "getDomNodePagePosition", "cursorBox", "cursorBottom", "maxHeightBelow", "availableSpaceAbove", "maxHeightAbove", "maxHeight", "forceRenderingAboveRequiredSpace", "statusBarHeight", "fontInfo", "clamp", "borderWidth", "borderHeight", "value", "IStorageService", "IContextKeyService", "IThemeService", "IInstantiationService", "SuggestContentWidget", "_widget", "_editor", "height", "width", "borderWidth", "horizontalPadding", "Dimension", "position", "preference", "init_telemetry", "init_resources", "init_hash", "init_dom", "init_textModel", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SuggestController_1", "_sticky", "LineSuffix", "_model", "_position", "ModelDecorationOptions", "offset", "end", "accessor", "Range", "position", "range", "SuggestController", "editor", "_memoryService", "_commandService", "_contextKeyService", "_instantiationService", "_logService", "_telemetryService", "MutableDisposable", "DisposableStore", "PriorityRegistry", "s", "Emitter", "SuggestModel", "model", "pos", "items", "ctxInsertMode", "Context", "WindowIdleValue", "getWindow", "widget", "SuggestWidget", "item", "commitCharacterController", "CommitCharacterController", "ctxMakesTextEdit", "ctxHasInsertAndReplace", "ctxCanResolve", "toDisposable", "startColumn", "endColumn", "value", "Position", "e", "KeyCodeChord", "isMacintosh", "OvertypingCapturer", "SuggestAlternatives", "WordContextKey", "index", "selector", "noFocus", "options", "acceptSuggestionsOnEnter", "updateFromConfig", "acceptSuggestionOnEnter", "event", "flags", "snippetController", "SnippetController2", "modelVersionNow", "tasks", "cts", "CancellationTokenSource", "info", "isResolved", "_commandExectionDuration", "_additionalEditsAppliedAsync", "scrollState", "StableEditorScrollState", "edit", "columnDelta", "startColumnDelta", "endColumnDelta", "EditOperation", "sw", "StopWatch", "docListener", "change", "thisPosition", "oldFlags", "didType", "typeListener", "applied", "insertText", "SnippetParser", "TriggerSuggestAction", "onUnexpectedExternalError", "onUnexpectedError", "next", "itemResolved", "commandExectionDuration", "additionalEditsAppliedAsync", "_a", "_b", "_c", "hash", "basename", "extname", "toggleMode", "assertType", "replace", "overwriteBefore", "overwriteAfter", "suffixDelta", "isNonEmptyArray", "msg", "localize", "alert", "onlyFrom", "auto", "noFilter", "arg", "positionNow", "fallback", "makesTextEdit", "Event", "_", "listener", "dispose", "completionModel", "keepAlternativeSuggestions", "alternativeOverwriteConfig", "ISuggestMemoryService", "ICommandService", "IContextKeyService", "IInstantiationService", "ILogService", "ITelemetryService", "PriorityRegistry", "prioritySelector", "value", "s1", "s2", "idx", "TriggerSuggestAction", "EditorAction", "localize", "ContextKeyExpr", "EditorContextKeys", "Context", "_accessor", "editor", "args", "controller", "SuggestController", "auto", "registerEditorContribution", "registerEditorAction", "weight", "SuggestCommand", "EditorCommand", "registerEditorCommand", "x", "suggestWidgetStatusbarMenu", "CommandsRegistry", "c", "WordContextKey", "SuggestAlternatives", "SnippetController2", "arg", "isObject", "_a", "init_observable", "init_arrays", "init_arraysFind", "SuggestWidgetAdaptor", "Disposable", "editor", "suggestControllerPreselector", "checkModelVersion", "onWillAccept", "observableValue", "e", "suggestController", "SuggestController", "model", "pos", "suggestItems", "_a", "transaction", "tx", "textModel", "itemToPreselect", "position", "Position", "candidates", "suggestItem", "index", "suggestItemTextEdit", "SuggestItemInfo", "valid", "item", "result", "findFirstMaxBy", "compareBy", "s", "numberComparator", "isBoundToSuggestWidget", "bindToSuggestWidget", "Event", "suggestItemInfo", "newActive", "newInlineCompletion", "suggestItemInfoEquals", "focusedItem", "toggleMode", "insertText", "isSnippetText", "snippet", "SnippetParser", "SnippetSession", "info", "Range", "range", "completionItemKind", "other", "SelectedSuggestionInfo", "SingleTextEdit", "a", "b", "init_nls", "init_commands", "init_configuration", "init_contextkey", "init_instantiation", "init_utils", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlineCompletionsController_1", "InlineCompletionsController", "Disposable", "editor", "_instantiationService", "_contextKeyService", "_configurationService", "_commandService", "_debounceService", "_languageFeaturesService", "_accessibilitySignalService", "_keybindingService", "disposableObservableValue", "observableValue", "Position", "SuggestWidgetAdaptor", "_a", "_b", "tx", "VersionIdChangeReason", "item", "transaction", "observableFromEvent", "derived", "reader", "model", "convertItemsToStableObservables", "mapObservableArrayCached", "ghostText", "store", "GhostTextWidget", "constObservable", "v", "observableSignal", "InlineCompletionContextKeys", "autorun", "textModel", "InlineCompletionsModel", "styleElement", "createStyleSheet2", "fontFamily", "getReason", "e", "CoreEditingCommands", "inlineSuggestCommitId", "InlineSuggestionHintsContentWidget", "state", "toDisposable", "lastInlineCompletionId", "autorunHandleChanges", "context", "changeSummary", "lineText", "AccessibilitySignal", "InlineCompletionsHintsWidget", "content", "accessibleViewShowing", "accessibleViewKeybinding", "hint", "localize", "alert", "changeReason", "_c", "newModel", "selection", "range", "p", "viewZoneId", "IInstantiationService", "IContextKeyService", "IConfigurationService", "ICommandService", "ILanguageFeatureDebounceService", "ILanguageFeaturesService", "IAccessibilitySignalService", "IKeybindingService", "convertItemsToStableObservables", "items", "store", "result", "observableValue", "innerObservables", "autorun", "reader", "itemsValue", "transaction", "tx", "i", "o", "init_nls", "init_actions", "init_configuration", "init_contextkey", "ShowNextInlineSuggestionAction", "EditorAction", "localize", "ContextKeyExpr", "EditorContextKeys", "InlineCompletionContextKeys", "accessor", "editor", "_a", "controller", "InlineCompletionsController", "showNextInlineSuggestionActionId", "ShowPreviousInlineSuggestionAction", "showPreviousInlineSuggestionActionId", "TriggerInlineSuggestionAction", "asyncTransaction", "tx", "AcceptNextWordOfInlineCompletion", "MenuId", "AcceptNextLineOfInlineCompletion", "AcceptInlineCompletion", "inlineSuggestCommitId", "Context", "HideInlineCompletion", "transaction", "ToggleAlwaysShowInlineSuggestionToolbar", "Action2", "configService", "IConfigurationService", "newValue", "init_dom", "init_htmlContent", "init_lifecycle", "init_observable", "init_range", "init_language", "init_nls", "init_instantiation", "init_telemetry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlineCompletionsHover", "owner", "range", "controller", "anchor", "InlineCompletionsHoverParticipant", "_editor", "_languageService", "_openerService", "accessibilityService", "_instantiationService", "_telemetryService", "mouseEvent", "InlineCompletionsController", "viewZoneData", "HoverForeignElementAnchor", "Range", "lineDecorations", "context", "hoverParts", "disposableStore", "DisposableStore", "part", "model", "w", "InlineSuggestionHintsContentWidget", "constObservable", "v", "_a", "$", "markdownHoverElement", "hoverContentsElement", "append", "renderer", "MarkdownRenderer", "render", "code", "inlineSuggestionAvailable", "localize", "renderedContents", "MarkdownString", "autorun", "reader", "ghostText", "lineText", "reset", "ILanguageService", "IOpenerService", "IAccessibilityService", "IInstantiationService", "ITelemetryService", "init_actions", "registerEditorContribution", "InlineCompletionsController", "registerEditorAction", "TriggerInlineSuggestionAction", "ShowNextInlineSuggestionAction", "ShowPreviousInlineSuggestionAction", "AcceptNextWordOfInlineCompletion", "AcceptNextLineOfInlineCompletion", "AcceptInlineCompletion", "HideInlineCompletion", "registerAction2", "ToggleAlwaysShowInlineSuggestionToolbar", "HoverParticipantRegistry", "InlineCompletionsHoverParticipant", "init_lifecycle", "init_strings", "init_editorExtensions", "init_range", "init_selection", "init_editorContextKeys", "init_languageConfigurationRegistry", "init_model", "getSpaceCnt", "str", "tabSize", "spacesCnt", "generateIndent", "insertSpaces", "result", "tabsCnt", "i", "init_nls", "init_indentation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "getReindentEditOperations", "model", "languageConfigurationService", "startLineNumber", "endLineNumber", "inheritedIndent", "indentationRules", "text", "tabSize", "indentSize", "insertSpaces", "shiftIndent", "indentation", "count", "ShiftCommand", "unshiftIndent", "indentEdits", "globalIndent", "currentLineText", "adjustedLineContent", "oldIndentation", "getLeadingWhitespace", "EditOperation", "Selection", "normalizeIndentation", "idealIndentForNextLine", "lineNumber", "IndentationToSpacesAction", "EditorAction", "localize", "EditorContextKeys", "accessor", "editor", "modelOpts", "selection", "command", "IndentationToSpacesCommand", "IndentationToTabsAction", "IndentationToTabsCommand", "ChangeIndentationSizeAction", "displaySizeOnly", "opts", "quickInputService", "IQuickInputService", "modelService", "IModelService", "creationOpts", "picks", "n", "autoFocusIndex", "pick", "pickedVal", "IndentUsingTabs", "IndentUsingSpaces", "ChangeTabDisplaySize", "DetectIndentation", "ReindentLinesAction", "ILanguageConfigurationService", "edits", "ReindentSelectedLinesAction", "selections", "editOperations", "AutoIndentOnPasteCommand", "initialSelection", "edit", "builder", "Range", "selectionIsSet", "helper", "AutoIndentOnPaste", "_languageConfigurationService", "DisposableStore", "range", "autoIndent", "textEdits", "indentConverter", "firstLineText", "indentOfFirstLine", "getGoodIndentForLine", "newSpaceCnt", "getSpaceCnt", "oldSpaceCnt", "newIndent", "generateIndent", "indentMetadata", "getIndentMetadata", "firstLineNumber", "indentOfSecondLine", "column", "newSpaceCntOfSecondLine", "oldSpaceCntOfSecondLine", "spaceCntOffset", "lineContent", "originalIndent", "newSpacesCnt", "cmd", "nonWhitespaceColumn", "tokens", "firstNonWhitespaceTokenIndex", "getIndentationEditOperations", "model", "builder", "tabSize", "tabsToSpaces", "spaces", "i", "spacesRegExp", "lineNumber", "lineCount", "lastIndentationColumn", "originalIndentationRange", "Range", "originalIndentation", "newIndentation", "IndentationToSpacesCommand", "selection", "helper", "IndentationToTabsCommand", "registerEditorContribution", "AutoIndentOnPaste", "registerEditorAction", "IndentationToSpacesAction", "IndentationToTabsAction", "IndentUsingTabs", "IndentUsingSpaces", "ChangeTabDisplaySize", "DetectIndentation", "ReindentLinesAction", "ReindentSelectedLinesAction", "init_editorExtensions", "init_dom", "init_arrays", "init_async", "init_cancellation", "init_errors", "init_lifecycle", "init_map", "init_types", "init_uri", "init_range", "init_languages", "init_model", "init_textModel", "init_languageFeatureDebounce", "init_languageFeatures", "init_resolverService", "init_errors", "init_lifecycle", "init_position", "init_range", "init_network", "init_uri", "InlayHintAnchor", "range", "direction", "InlayHintItem", "hint", "anchor", "provider", "delta", "result", "token", "_a", "_b", "_c", "newHint", "err", "onUnexpectedExternalError", "InlayHintsFragments", "registry", "model", "ranges", "data", "promises", "CancellationError", "DisposableStore", "items", "list", "position", "wordRange", "Range", "a", "b", "Position", "line", "word", "tokens", "offset", "idx", "start", "end", "asCommandLink", "command", "URI", "Schemas", "init_dom", "init_actions", "init_cancellation", "init_range", "init_resolverService", "init_actions", "init_commands", "init_contextkey", "init_instantiation", "showGoToContextMenu", "accessor", "editor", "anchor", "part", "_a", "resolverService", "ITextModelService", "contextMenuService", "IContextMenuService", "commandService", "ICommandService", "instaService", "IInstantiationService", "notificationService", "INotificationService", "CancellationToken", "location", "menuActions", "filter", "MenuRegistry", "MenuId", "item", "isIMenuItem", "generateUuid", "delegate", "SymbolNavigationAction", "Action", "MenuItemAction", "ref", "symbolAnchor", "SymbolNavigationAnchor", "Range", "range", "command", "Separator", "err", "Severity", "useShadowDOM", "box", "getDomNodePagePosition", "goToDefinitionWithLocation", "event", "openToSide", "contextKeyService", "IContextKeyService", "isInPeek", "PeekContext", "canPeek", "DefinitionAction", "init_commands", "init_extensions", "init_instantiation", "init_colorRegistry", "init_themeService", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlayHintsController_1", "InlayHintsCache", "LRUCache", "model", "value", "IInlayHintsCache", "createDecorator", "registerSingleton", "RenderedInlayHintLabelPart", "item", "index", "label", "ActiveInlayHintInfo", "part", "hasTriggerModifier", "InlayHintsController", "editor", "_a", "_editor", "_languageFeaturesService", "_featureDebounce", "_inlayHintsCache", "_commandService", "_notificationService", "_instaService", "DisposableStore", "DynamicCssRules", "e", "options", "defaultMode", "altMode", "ModifierKeyEmitter", "newRenderMode", "copies", "scheduler", "cached", "toDisposable", "cts", "watchedProviders", "RunOnceScheduler", "t1", "CancellationTokenSource", "listener", "myToken", "inlayHints", "InlayHintsFragments", "provider", "err", "onUnexpectedError", "delay", "store", "gesture", "ClickLinkGesture", "sessionStore", "mouseEvent", "labelPart", "lineNumber", "range", "Range", "lineHints", "goToDefinitionWithLocation", "Command", "data", "updateInlayHints", "CancellationToken", "isNonEmptyArray", "edits", "edit", "EditOperation", "showGoToContextMenu", "ModelDecorationInjectedTextOptions", "command", "Severity", "hints", "items", "id", "obj", "anchor", "InlayHintAnchor", "copy", "visibleRanges", "result", "extendedRange", "ranges", "_b", "newDecorationsData", "addInjectedText", "ref", "content", "cursorStops", "attachedData", "opts", "addInjectedWhitespace", "isLast", "marginRule", "fontSize", "InjectedTextCursorStops", "fontFamily", "padding", "isUniform", "fontFamilyVar", "currentLineInfo", "parts", "isFirst", "cssProperties", "EDITOR_FONT_DEFAULTS", "themeColorFromId", "editorActiveLinkForeground", "textlabel", "tooLong", "over", "fixSpace", "decorationIdsToReplace", "metadata", "r", "scrollState", "StableEditorScrollState", "accessor", "newDecorationIds", "props", "hint", "InlayHintKind", "editorInlayHintParameterBackground", "editorInlayHintParameterForeground", "editorInlayHintTypeBackground", "editorInlayHintTypeForeground", "editorInlayHintBackground", "editorInlayHintForeground", "editorFontSize", "editorFontFamily", "ILanguageFeaturesService", "ILanguageFeatureDebounceService", "ICommandService", "INotificationService", "IInstantiationService", "fixSpace", "str", "noBreakWhitespace", "CommandsRegistry", "accessor", "args", "uri", "range", "assertType", "URI", "Range", "inlayHintsProvider", "ILanguageFeaturesService", "ref", "ITextModelService", "model", "InlayHintsFragments", "CancellationToken", "result", "i", "init_async", "init_htmlContent", "init_position", "init_textModel", "init_language", "init_resolverService", "init_configuration", "init_languageFeatures", "init_nls", "init_platform", "init_arrays", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlayHintsHoverAnchor", "HoverForeignElementAnchor", "part", "owner", "initialMousePosX", "initialMousePosY", "InlayHintsHover", "MarkdownHoverParticipant", "editor", "languageService", "openerService", "configurationService", "_resolverService", "languageFeaturesService", "mouseEvent", "_a", "InlayHintsController", "options", "ModelDecorationInjectedTextOptions", "RenderedInlayHintLabelPart", "anchor", "_lineDecorations", "token", "AsyncIterableObject", "executor", "itemTooltip", "MarkdownString", "MarkdownHover", "isNonEmptyArray", "localize", "partTooltip", "linkHint", "kb", "isMacintosh", "asCommandLink", "iterable", "item", "uri", "range", "ref", "model", "getHover", "Position", "isEmptyMarkdownString", "ILanguageService", "IOpenerService", "IConfigurationService", "ITextModelService", "ILanguageFeaturesService", "registerEditorContribution", "InlayHintsController", "HoverParticipantRegistry", "InlayHintsHover", "import_inPlaceReplace", "init_editorExtensions", "init_editorContextKeys", "init_nls", "ExpandLineSelectionAction", "EditorAction", "localize", "EditorContextKeys", "_accessor", "editor", "args", "viewModel", "CursorMoveCommands", "registerEditorAction", "init_keyCodes", "init_editorExtensions", "init_strings", "init_range", "TrimTrailingWhitespaceCommand", "selection", "cursors", "model", "builder", "ops", "trimTrailingWhitespace", "i", "len", "op", "helper", "a", "b", "r", "rLen", "cursorIndex", "cursorLen", "lineNumber", "lineCount", "lineContent", "maxLineColumn", "minEditColumn", "lastNonWhitespaceIndex", "fromColumn", "EditOperation", "Range", "init_position", "init_range", "init_selection", "init_editorContextKeys", "init_range", "init_selection", "CopyLinesCommand", "selection", "isCopyingDown", "noop", "model", "builder", "s", "sourceLines", "i", "sourceText", "Range", "helper", "result", "startLineNumber", "startColumn", "endLineNumber", "endColumn", "Selection", "init_strings", "init_range", "init_selection", "init_languageConfiguration", "init_languageConfigurationRegistry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "MoveLinesCommand", "selection", "isMovingDown", "autoIndent", "_languageConfigurationService", "model", "builder", "modelLineCount", "s", "tabSize", "indentSize", "insertSpaces", "indentConverter", "virtualModel", "lineNumber", "column", "otherLineNumber", "Range", "Selection", "movingLineNumber", "movingLineText", "insertingText", "movingLineMatchResult", "oldIndentation", "getLeadingWhitespace", "newSpaceCnt", "getSpaceCnt", "generateIndent", "indentOfMovingLine", "getGoodIndentForLine", "oldSpaceCnt", "ret", "newIndentatOfMovingBlock", "spaceCntOffset", "indentOfFirstLine", "oldIndent", "indentation", "ShiftCommand", "line", "enter", "enterPrefix", "IndentAction", "newIndentation", "indentMetadataOfMovelingLine", "getIndentMetadata", "futureAboveLineNumber", "futureAboveLineText", "lastNonWhitespaceIndex", "maxColumn", "getEnterAction", "validPrecedingLine", "lineContent", "oneLineAbove", "previousLineText", "str", "languageAtSelectionStart", "languageAtSelectionEnd", "offset", "originalIndent", "newSpacesCnt", "newIndent", "helper", "result", "ILanguageConfigurationService", "init_range", "SortLinesCommand", "selection", "descending", "model", "builder", "op", "sortLines", "helper", "data", "getSortData", "i", "len", "startLineNumber", "endLineNumber", "linesToSort", "lineNumber", "sorted", "EditOperation", "Range", "init_nls", "init_actions", "init_languageConfigurationRegistry", "AbstractCopyLinesAction", "EditorAction", "down", "opts", "_accessor", "editor", "selections", "selection", "index", "a", "b", "Range", "prev", "i", "curr", "commands", "CopyLinesCommand", "CopyLinesUpAction", "localize", "EditorContextKeys", "MenuId", "CopyLinesDownAction", "DuplicateSelectionAction", "accessor", "args", "model", "insertSelection", "Selection", "ReplaceCommandThatSelectsText", "AbstractMoveLinesAction", "languageConfigurationService", "ILanguageConfigurationService", "autoIndent", "MoveLinesCommand", "MoveLinesUpAction", "MoveLinesDownAction", "AbstractSortLinesAction", "descending", "SortLinesCommand", "len", "SortLinesAscendingAction", "SortLinesDescendingAction", "DeleteDuplicateLinesAction", "edits", "endCursorState", "linesDeleted", "uniqueLines", "lines", "line", "selectionToReplace", "adjustedSelectionStart", "finalSelection", "EditOperation", "TrimTrailingWhitespaceAction", "KeyChord", "cursors", "s", "Position", "command", "TrimTrailingWhitespaceCommand", "DeleteLinesAction", "ops", "cursorState", "op", "startLineNumber", "endLineNumber", "startColumn", "endColumn", "operations", "mergedOperations", "previousOperation", "IndentLinesAction", "viewModel", "TypeOperations", "OutdentLinesAction", "CoreEditingCommands", "InsertLineBeforeAction", "InsertLineAfterAction", "AbstractDeleteAllToBoundaryAction", "primaryCursor", "rangesToDelete", "effectiveRanges", "count", "range", "nextRange", "DeleteAllLeftAction", "endPrimaryCursor", "deletedLines", "endCursor", "newStartLine", "deleteFromLine", "deleteFromColumn", "DeleteAllRightAction", "offset", "sel", "maxColumn", "JoinLinesAction", "reducedSelections", "lastSelection", "previousValue", "currentValue", "lineOffset", "columnDeltaOffset", "selectionEndPositionOffset", "position", "trimmedLinesContent", "lineText", "firstNonWhitespaceIdx", "insertSpace", "lineTextWithoutIndent", "deleteSelection", "resultSelection", "TransposeAction", "cursor", "chars", "ReplaceCommand", "ReplaceCommandThatPreservesSelection", "AbstractCaseAction", "wordSeparators", "textEdits", "word", "wordRange", "text", "UpperCaseAction", "LowerCaseAction", "BackwardsCompatibleRegExp", "_pattern", "_flags", "TitleCaseAction", "titleBoundary", "SnakeCaseAction", "caseBoundary", "singleLetters", "CamelCaseAction", "wordBoundary", "words", "KebabCaseAction", "regexp", "_", "underscoreBoundary", "registerEditorAction", "init_arrays", "init_async", "init_cancellation", "init_color", "init_errors", "init_event", "init_lifecycle", "init_strings", "init_uri", "init_editorExtensions", "init_codeEditorService", "init_position", "init_range", "init_editorContextKeys", "init_textModel", "init_languageConfigurationRegistry", "init_nls", "init_contextkey", "init_languageFeatures", "init_colorRegistry", "init_languageFeatureDebounce", "init_stopwatch", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "LinkedEditingContribution_1", "CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE", "RawContextKey", "DECORATION_CLASS_NAME", "LinkedEditingContribution", "Disposable", "editor", "contextKeyService", "languageFeaturesService", "languageConfigurationService", "languageFeatureDebounceService", "DisposableStore", "e", "forceRefresh", "model", "isEnabled", "Event", "rangeUpdateScheduler", "Delayer", "triggerRangeUpdate", "_a", "rangeSyncScheduler", "triggerRangeSync", "token", "referenceRange", "referenceValue", "match", "edits", "len", "mirrorRange", "oldValue", "newValue", "rangeStartColumn", "rangeEndColumn", "commonPrefixLength", "commonSuffixLength", "Range", "prevEditOperationType", "force", "position", "modelVersionId", "range", "currentRequestCts", "CancellationTokenSource", "sw", "StopWatch", "response", "getLinkedEditingRanges", "ranges", "foundReferenceRange", "decorations", "err", "isCancellationError", "onUnexpectedError", "ModelDecorationOptions", "IContextKeyService", "ILanguageFeaturesService", "ILanguageConfigurationService", "ILanguageFeatureDebounceService", "LinkedEditingAction", "EditorAction", "localize", "ContextKeyExpr", "EditorContextKeys", "accessor", "args", "editorService", "ICodeEditorService", "uri", "pos", "URI", "Position", "editor", "onUnexpectedError", "_accessor", "controller", "LinkedEditingContribution", "LinkedEditingCommand", "EditorCommand", "registerEditorCommand", "CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE", "x", "getLinkedEditingRanges", "providers", "model", "position", "token", "orderedByScore", "first", "provider", "e", "onUnexpectedExternalError", "result", "isNonEmptyArray", "editorLinkedEditingBackground", "registerColor", "Color", "registerModelAndPositionCommand", "linkedEditingRangeProvider", "ILanguageFeaturesService", "CancellationToken", "registerEditorContribution", "registerEditorAction", "init_async", "init_cancellation", "init_errors", "init_htmlContent", "init_lifecycle", "init_network", "init_platform", "init_resources", "init_stopwatch", "init_uri", "init_editorExtensions", "init_textModel", "init_languageFeatureDebounce", "init_languageFeatures", "init_arrays", "init_cancellation", "init_errors", "init_lifecycle", "init_types", "init_uri", "init_range", "init_model", "init_commands", "init_languageFeatures", "Link", "link", "provider", "token", "value", "LinksList", "tuples", "DisposableStore", "links", "list", "newLinks", "isDisposable", "oldLinks", "result", "oldIndex", "oldLen", "newIndex", "newLen", "oldLink", "newLink", "Range", "getLinks", "providers", "model", "lists", "promises", "i", "onUnexpectedExternalError", "coalesce", "CommandsRegistry", "accessor", "args", "uri", "resolveCount", "assertType", "URI", "linkProvider", "ILanguageFeaturesService", "IModelService", "CancellationToken", "init_nls", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "LinkDetector_1", "LinkDetector", "Disposable", "editor", "openerService", "notificationService", "languageFeaturesService", "languageFeatureDebounceService", "RunOnceScheduler", "clickLinkGesture", "ClickLinkGesture", "mouseEvent", "keyboardEvent", "e", "model", "createCancelablePromise", "token", "getLinks", "sw", "StopWatch", "err", "onUnexpectedError", "links", "useMetaKey", "oldDecorations", "keys", "decorationId", "occurence", "newDecorations", "link", "LinkOccurrence", "changeAccessor", "decorations", "len", "withKey", "occurrence", "openToSide", "fromUserGesture", "CancellationToken", "uri", "modelUri", "Schemas", "parsedUri", "URI", "fsPath", "originalFSPath", "relativePath", "joinPath", "messageOrError", "localize", "position", "decoration", "currentOccurrence", "_a", "IOpenerService", "INotificationService", "ILanguageFeaturesService", "ILanguageFeatureDebounceService", "decoration", "ModelDecorationOptions", "LinkOccurrence", "link", "useMetaKey", "isActive", "options", "getHoverMessage", "decorationId", "changeAccessor", "executeCmd", "label", "localize", "kb", "isMacintosh", "nativeLabel", "match", "commandId", "MarkdownString", "OpenLinkAction", "EditorAction", "accessor", "editor", "linkDetector", "LinkDetector", "selections", "sel", "registerEditorContribution", "registerEditorAction", "init_lifecycle", "init_editorExtensions", "LongLinesHelper", "Disposable", "_editor", "e", "stopRenderingLineAfter", "registerEditorContribution", "init_async", "init_keyCodes", "init_lifecycle", "init_editorExtensions", "init_range", "init_selection", "init_editorContextKeys", "init_nls", "init_actions", "init_contextkey", "init_languageFeatures", "init_model", "init_textModel", "init_languages", "init_nls", "init_colorRegistry", "init_themeService", "wordHighlightBackground", "registerColor", "localize", "wordHighlightBorder", "activeContrastBorder", "overviewRulerWordHighlightForeground", "overviewRulerWordHighlightStrongForeground", "overviewRulerWordHighlightTextForeground", "overviewRulerSelectionHighlightForeground", "_WRITE_OPTIONS", "ModelDecorationOptions", "themeColorFromId", "OverviewRulerLane", "minimapSelectionOccurrenceHighlight", "MinimapPosition", "_TEXT_OPTIONS", "_SELECTION_HIGHLIGHT_OPTIONS", "_SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW", "_REGULAR_OPTIONS", "getHighlightDecorationOptions", "kind", "DocumentHighlightKind", "getSelectionHighlightDecorationOptions", "hasSemanticHighlights", "registerThemingParticipant", "theme", "collector", "selectionHighlight", "editorSelectionHighlight", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SelectionHighlighter_1", "announceCursorChange", "previousCursorState", "cursorState", "cursorDiff", "cs", "pcs", "cursorPositions", "msg", "localize", "status", "InsertCursorAbove", "EditorAction", "EditorContextKeys", "MenuId", "accessor", "editor", "args", "useLogicalLine", "viewModel", "CursorMoveCommands", "InsertCursorBelow", "InsertCursorAtEndOfEachLineSelected", "selection", "model", "result", "currentLineMaxColumn", "Selection", "selections", "newSelections", "sel", "InsertCursorAtEndOfLineSelected", "lineCount", "InsertCursorAtTopOfLineSelected", "MultiCursorSessionResult", "revealRange", "revealScrollType", "MultiCursorSession", "findController", "findState", "isDisconnectedFromFindController", "wholeWord", "matchCase", "s", "searchText", "currentMatch", "word", "_editor", "nextMatch", "allSelections", "lastAddedSelection", "previousMatch", "searchScope", "editorModel", "MultiCursorSelectionController", "Disposable", "DisposableStore", "session", "newState", "e", "modelRangesContainSameText", "resultingSelections", "len", "matches", "editorSelection", "match", "m", "MultiCursorSelectionControllerAction", "multiCursorController", "CommonFindController", "newFindController", "IInstantiationService", "AddSelectionToNextFindMatchAction", "AddSelectionToPreviousFindMatchAction", "MoveSelectionToNextFindMatchAction", "KeyChord", "MoveSelectionToPreviousFindMatchAction", "SelectHighlightsAction", "CompatChangeAll", "ContextKeyExpr", "SelectionHighlighterState", "_model", "_searchText", "_matchCase", "_wordSeparators", "prevState", "Range", "SelectionHighlighter", "_languageFeaturesService", "RunOnceScheduler", "oldState", "isEnabled", "r", "caseSensitive", "findStateSearchString", "mySearchString", "allMatches", "j", "lenJ", "cmp", "occurrenceHighlighting", "hasSemanticHighlights", "decorations", "getSelectionHighlightDecorationOptions", "ILanguageFeaturesService", "modelRangesContainSameText", "model", "ranges", "matchCase", "selectedText", "getValueInRange", "i", "len", "range", "thisSelectedText", "toLowerCase", "text", "FocusNextCursor", "EditorAction", "localize", "accessor", "editor", "args", "viewModel", "previousCursorState", "firstCursor", "announceCursorChange", "FocusPreviousCursor", "registerEditorContribution", "MultiCursorSelectionController", "SelectionHighlighter", "registerEditorAction", "InsertCursorAbove", "InsertCursorBelow", "InsertCursorAtEndOfEachLineSelected", "AddSelectionToNextFindMatchAction", "AddSelectionToPreviousFindMatchAction", "MoveSelectionToNextFindMatchAction", "MoveSelectionToPreviousFindMatchAction", "SelectHighlightsAction", "CompatChangeAll", "InsertCursorAtEndOfLineSelected", "InsertCursorAtTopOfLineSelected", "init_editorExtensions", "init_editorExtensions", "init_editorContextKeys", "inlineEditAcceptId", "inlineEditRejectId", "inlineEditJumpToId", "inlineEditJumpBackId", "init_lifecycle", "init_observable", "init_position", "init_range", "init_lifecycle", "init_observable", "init_position", "init_range", "init_language", "init_model", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "INLINE_EDIT_DESCRIPTION", "GhostTextWidget", "Disposable", "editor", "model", "languageService", "observableValue", "observableFromEvent", "derived", "reader", "_a", "textModel", "ghostText", "range", "isSingleLine", "isPureRemove", "l", "inlineTexts", "additionalLines", "addToAdditionalLines", "lines", "className", "lastLine", "LineDecoration", "line", "textBufferLine", "hiddenTextStartColumn", "lastIdx", "part", "hiddenRange", "ColumnRange", "lineNumber", "uiState", "decorations", "ranges", "firstNonWhitespace", "lastNonWhitespace", "Range", "p", "Position", "InjectedTextCursorStops", "AdditionalLinesWidget", "toDisposable", "applyObservableDecorations", "viewZoneId", "ILanguageService", "init_contextkey", "init_instantiation", "init_languages", "init_languageFeatures", "init_cancellation", "init_commands", "init_dom", "init_actions", "init_arrays", "init_lifecycle", "init_observable", "init_platform", "init_position", "init_actions", "init_contextkey", "init_instantiation", "init_telemetry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlineEditHintsContentWidget_1", "InlineEditHintsWidget", "Disposable", "editor", "model", "instantiationService", "observableFromEvent", "derived", "reader", "_a", "_b", "_c", "ghostText", "firstColumn", "position", "Position", "autorunWithStore", "store", "contentWidget", "InlineEditHintsContentWidget", "toDisposable", "IInstantiationService", "InlineEditHintsContentWidget", "InlineEditHintsContentWidget_1", "Disposable", "editor", "withBorder", "_position", "instantiationService", "_contextKeyService", "_menuService", "h", "MenuId", "CustomizedMenuWorkbenchToolBar", "g", "action", "options", "MenuItemAction", "StatusBarViewItem", "e", "autorun", "reader", "extraActions", "_", "group", "Separator", "__decorate", "__param", "IInstantiationService", "IContextKeyService", "IMenuService", "StatusBarViewItem", "MenuEntryActionViewItem", "kb", "div", "h", "KeybindingLabel", "OS", "unthemedKeybindingLabelOptions", "CustomizedMenuWorkbenchToolBar", "WorkbenchToolBar", "container", "editor", "menuId", "options2", "menuService", "contextKeyService", "contextMenuService", "keybindingService", "telemetryService", "_a", "_b", "_c", "_d", "_e", "_f", "_g", "primary", "secondary", "createAndFillInActionBarActions", "actions", "equals", "a", "b", "__decorate", "__param", "IMenuService", "IContextKeyService", "IContextMenuService", "IKeybindingService", "ITelemetryService", "init_dom", "init_configuration", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlineEditController_1", "InlineEditWidget", "widget", "edit", "InlineEditController", "Disposable", "editor", "instantiationService", "contextKeyService", "languageFeaturesService", "_commandService", "_configurationService", "disposableObservableValue", "observableFromEvent", "modelChangedSignal", "observableSignalFromEvent", "autorun", "reader", "cursorPosition", "pos", "currentEdit", "editorBlurSingal", "_a", "editorFocusSignal", "styleElement", "createStyleSheet2", "fontFamily", "InlineEditHintsWidget", "position", "gt", "Range", "_b", "lastLine", "lastColumn", "lineLength", "auto", "model", "modelVersion", "providers", "provider", "CancellationTokenSource", "token", "triggerKind", "InlineEditTriggerKind", "wait", "line", "column", "ghostText", "GhostText", "GhostTextPart", "instance", "GhostTextWidget", "constObservable", "data", "text", "EditOperation", "Position", "sendRejection", "range", "p", "viewZoneId", "RawContextKey", "IInstantiationService", "IContextKeyService", "ILanguageFeaturesService", "ICommandService", "IConfigurationService", "wait", "ms", "cancellationToken", "resolve", "d", "handle", "init_actions", "init_contextkey", "AcceptInlineEdit", "EditorAction", "inlineEditAcceptId", "ContextKeyExpr", "EditorContextKeys", "InlineEditController", "MenuId", "accessor", "editor", "controller", "TriggerInlineEdit", "activeExpr", "JumpToInlineEdit", "inlineEditJumpToId", "JumpBackInlineEdit", "inlineEditJumpBackId", "RejectInlineEdit", "inlineEditRejectId", "init_lifecycle", "init_observable", "init_instantiation", "init_telemetry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "InlineEditHover", "owner", "range", "controller", "anchor", "InlineEditHoverParticipant", "_editor", "_instantiationService", "_telemetryService", "mouseEvent", "InlineEditController", "viewZoneData", "HoverForeignElementAnchor", "lineDecorations", "context", "hoverParts", "disposableStore", "DisposableStore", "w", "InlineEditHintsContentWidget", "constObservable", "IInstantiationService", "ITelemetryService", "registerEditorAction", "AcceptInlineEdit", "RejectInlineEdit", "JumpToInlineEdit", "JumpBackInlineEdit", "TriggerInlineEdit", "registerEditorContribution", "InlineEditController", "HoverParticipantRegistry", "InlineEditHoverParticipant", "init_lazy", "init_lifecycle", "init_editorExtensions", "init_editorContextKeys", "init_languages", "init_languageFeatures", "init_async", "init_errors", "init_event", "init_lifecycle", "init_characterClassifier", "init_languages", "init_cancellation", "init_errors", "init_types", "init_uri", "init_position", "init_languages", "init_languageFeatures", "init_resolverService", "init_commands", "init_contextkey", "Context", "RawContextKey", "provideSignatureHelp", "registry", "model", "position", "context", "token", "supports", "support", "result", "err", "onUnexpectedExternalError", "CommandsRegistry", "accessor", "args", "uri", "triggerCharacter", "assertType", "URI", "Position", "languageFeaturesService", "ILanguageFeaturesService", "ref", "ITextModelService", "SignatureHelpTriggerKind", "CancellationToken", "ParameterHintState", "Pending", "request", "previouslyActiveHints", "Active", "hints", "ParameterHintsModel", "Disposable", "editor", "providers", "delay", "Emitter", "MutableDisposable", "CharacterSet", "Delayer", "e", "_", "text", "value", "silent", "context", "model", "triggerId", "onUnexpectedError", "length", "activeSignature", "last", "cycle", "first", "isRetrigger", "activeSignatureHelp", "mergeTriggerContexts", "triggerContext", "position", "createCancelablePromise", "token", "provideSignatureHelp", "result", "error", "support", "ch", "charCode", "lastCharIndex", "triggerCharCode", "SignatureHelpTriggerKind", "previous", "current", "init_nls", "init_contextkey", "init_instantiation", "init_dom", "init_codicons", "init_event", "init_lifecycle", "init_strings", "init_types", "init_language", "init_nls", "init_contextkey", "init_colorRegistry", "init_themables", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ParameterHintsWidget_1", "$", "parameterHintsNextIcon", "registerIcon", "Codicon", "localize", "parameterHintsPreviousIcon", "ParameterHintsWidget", "Disposable", "editor", "model", "contextKeyService", "openerService", "languageService", "DisposableStore", "MarkdownRenderer", "Context", "element", "wrapper", "append", "controls", "previous", "ThemeIcon", "overloads", "next", "addDisposableListener", "e", "EventHelper", "body", "scrollbar", "DomScrollableElement", "signature", "docs", "updateFont", "fontInfo", "Event", "_a", "hints", "multiple", "code", "hasParameters", "activeParameterIndex", "label", "activeParameter", "documentation", "renderedContents", "hasDocs", "labelToAnnounce", "param", "alert", "markdown", "assertIsDefined", "parent", "start", "end", "beforeSpan", "paramSpan", "afterSpan", "paramIdx", "regex", "escapeRegExpCharacters", "idx", "maxHeight", "IContextKeyService", "IOpenerService", "ILanguageService", "registerColor", "listHighlightForeground", "localize", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ParameterHintsController_1", "ParameterHintsController", "Disposable", "editor", "instantiationService", "languageFeaturesService", "ParameterHintsModel", "newParameterHints", "_a", "Lazy", "ParameterHintsWidget", "context", "IInstantiationService", "ILanguageFeaturesService", "TriggerParameterHintsAction", "EditorAction", "localize", "EditorContextKeys", "accessor", "editor", "controller", "ParameterHintsController", "SignatureHelpTriggerKind", "registerEditorContribution", "registerEditorAction", "weight", "ParameterHintsCommand", "EditorCommand", "registerEditorCommand", "Context", "x", "ContextKeyExpr", "init_async", "init_cancellation", "init_errors", "init_lifecycle", "init_types", "init_uri", "init_editorExtensions", "init_codeEditorService", "init_position", "init_range", "init_editorContextKeys", "init_languageFeatures", "init_editorState", "init_nls", "init_actions", "init_configurationRegistry", "init_contextkey", "init_instantiation", "init_log", "init_platform", "init_telemetry", "init_dom", "init_iconLabels", "init_arrays", "init_async", "init_codicons", "init_lifecycle", "init_types", "init_position", "init_languages", "init_nls", "init_contextkey", "init_log", "init_colorRegistry", "init_themeService", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "_sticky", "CONTEXT_RENAME_INPUT_VISIBLE", "RawContextKey", "localize", "CONTEXT_RENAME_INPUT_FOCUSED", "RenameInputField", "_editor", "_acceptKeybindings", "_themeService", "_keybindingService", "contextKeyService", "_logService", "DisposableStore", "e", "addDisposableListener", "CandidatesView", "theme", "_a", "_b", "_c", "_d", "widgetShadowColor", "widgetShadow", "widgetBorderColor", "widgetBorder", "editorWidgetBackground", "inputForeground", "inputBackground", "border", "inputBorder", "fontInfo", "editorFontSize", "bodyBox", "getClientArea", "editorBox", "getDomNodePagePosition", "cursorBoxTop", "lineHeight", "candidateViewHeight", "CandidateView", "positionPreference", "accept", "preview", "position", "assertType", "inputBoxHeight", "getTotalHeight", "labelHeight", "totalHeightAvailable", "getTotalWidth", "wantsPreview", "focusEditor", "caller", "where", "value", "selectionStart", "selectionEnd", "supportPreview", "candidates", "cts", "Position", "disposeOnDone", "toDisposable", "resolve", "nRenameSuggestions", "newName", "source", "focusedCandidate", "currentName", "token", "trace", "args", "namesListResults", "raceCancellation", "newNames", "namesListResult", "isDefined", "distinctNames", "distinct", "v", "validDistinctNames", "newSymbolName", "visibleRanges", "firstLineInViewport", "IThemeService", "IKeybindingService", "IContextKeyService", "ILogService", "CandidatesView", "parent", "opts", "DisposableStore", "that", "virtualDelegate", "element", "renderer", "container", "CandidateView", "candidate", "index", "templateData", "List", "e", "defaultListStyles", "height", "width", "candidates", "status", "localize", "selectedElement", "focusedElement", "fontInfo", "focusedIx", "totalHeight", "nCandidates", "heightToFitAllCandidates", "MAX_N_CANDIDATES", "longestCandidateWidth", "c", "lineHeight", "value", "_a", "renderIcon", "Codicon", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "RenameController_1", "RenameSkeleton", "model", "position", "registry", "token", "rejects", "provider", "res", "word", "Range", "newName", "result", "localize", "rename", "skeleton", "loc", "CancellationToken", "RenameController", "editor", "_instaService", "_notificationService", "_bulkEditService", "_progressService", "_logService", "_configService", "_languageFeaturesService", "_telemetryService", "DisposableStore", "CancellationTokenSource", "RenameInputField", "_a", "_b", "trace", "cts1", "EditorStateCancellationTokenSource", "resolveLocationOperation", "e", "MessageController", "cts2", "renameCandidatesCts", "newSymbolNamesProviders", "newSymbolNameProvidersResults", "p", "selection", "selectionStart", "selectionEnd", "supportPreview", "inputFieldResult", "renameOperation", "raceCancellation", "renameResult", "alert", "err", "wantsPreview", "nRenameSuggestionProviders", "languageId", "value", "IInstantiationService", "INotificationService", "IBulkEditService", "IEditorProgressService", "ILogService", "ITextResourceConfigurationService", "ILanguageFeaturesService", "ITelemetryService", "RenameAction", "EditorAction", "ContextKeyExpr", "EditorContextKeys", "accessor", "args", "editorService", "ICodeEditorService", "uri", "pos", "URI", "Position", "onUnexpectedError", "logService", "controller", "registerEditorContribution", "registerEditorAction", "RenameCommand", "EditorCommand", "registerEditorCommand", "CONTEXT_RENAME_INPUT_VISIBLE", "x", "registerAction2", "Action2", "localize2", "currentEditor", "CONTEXT_RENAME_INPUT_FOCUSED", "registerModelAndPositionCommand", "assertType", "renameProvider", "Registry", "Extensions", "init_lifecycle", "init_errors", "init_model", "init_configuration", "init_async", "init_cancellation", "init_themeService", "init_cancellation", "init_errors", "init_uri", "init_model", "init_commands", "init_types", "init_buffer", "init_platform", "reverseEndianness", "arr", "i", "len", "b0", "b1", "b2", "b3", "toLittleEndianBuffer", "uint8Arr", "isLittleEndian", "VSBuffer", "encodeSemanticTokensDto", "semanticTokens", "dest", "encodeSemanticTokensDtoSize", "offset", "delta", "result", "init_range", "init_languageFeatures", "isSemanticTokens", "v", "isSemanticTokensEdits", "DocumentSemanticTokensResult", "provider", "tokens", "error", "hasDocumentSemanticTokensProvider", "registry", "model", "getDocumentSemanticTokensProviders", "groups", "getDocumentSemanticTokens", "lastProvider", "lastResultId", "token", "providers", "results", "result", "err", "_getDocumentSemanticTokensProviderHighestGroup", "DocumentRangeSemanticTokensResult", "hasDocumentRangeSemanticTokensProvider", "getDocumentRangeSemanticTokensProviders", "getDocumentRangeSemanticTokens", "range", "onUnexpectedExternalError", "CommandsRegistry", "accessor", "args", "uri", "assertType", "URI", "IModelService", "documentSemanticTokensProvider", "ILanguageFeaturesService", "ICommandService", "CancellationToken", "buff", "encodeSemanticTokensDto", "documentRangeSemanticTokensProvider", "Range", "init_languageFeatureDebounce", "init_stopwatch", "init_languageFeatures", "SEMANTIC_HIGHLIGHTING_SETTING_ID", "isSemanticColoringEnabled", "model", "themeService", "configurationService", "_a", "setting", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ModelSemanticColoring_1", "DocumentSemanticTokensFeature", "Disposable", "semanticTokensStylingService", "modelService", "themeService", "configurationService", "languageFeatureDebounceService", "languageFeaturesService", "register", "model", "ModelSemanticColoring", "deregister", "modelSemanticColoring", "handleSettingOrThemeChange", "curr", "isSemanticColoringEnabled", "e", "SEMANTIC_HIGHLIGHTING_SETTING_ID", "watcher", "ISemanticTokensStylingService", "IModelService", "IThemeService", "IConfigurationService", "ILanguageFeatureDebounceService", "ILanguageFeaturesService", "ModelSemanticColoring", "ModelSemanticColoring_1", "Disposable", "model", "_semanticTokensStylingService", "themeService", "languageFeatureDebounceService", "languageFeaturesService", "RunOnceScheduler", "bindDocumentChangeListeners", "dispose", "provider", "_", "hasDocumentSemanticTokensProvider", "cancellationTokenSource", "CancellationTokenSource", "lastProvider", "lastResultId", "request", "getDocumentSemanticTokens", "pendingChanges", "contentChangeListener", "e", "sw", "StopWatch", "res", "tokens", "styling", "err", "isCancellationError", "onUnexpectedError", "src", "srcOffset", "dest", "destOffset", "length", "i", "currentResponse", "rescheduleIfNeeded", "isSemanticTokensEdits", "deltaLength", "edit", "srcData", "destData", "srcLastStart", "destLastStart", "copyCount", "isSemanticTokens", "SemanticTokensResponse", "result", "toMultilineTokens2", "change", "area", "singleChange", "__decorate", "__param", "ISemanticTokensStylingService", "IThemeService", "ILanguageFeatureDebounceService", "ILanguageFeaturesService", "resultId", "data", "registerEditorFeature", "DocumentSemanticTokensFeature", "init_async", "init_lifecycle", "init_editorExtensions", "init_configuration", "init_themeService", "init_languageFeatureDebounce", "init_stopwatch", "init_languageFeatures", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ViewportSemanticTokensContribution", "Disposable", "editor", "_semanticTokensStylingService", "_themeService", "_configurationService", "languageFeatureDebounceService", "languageFeaturesService", "RunOnceScheduler", "scheduleTokenizeViewport", "e", "SEMANTIC_HIGHLIGHTING_SETTING_ID", "request", "req", "len", "model", "isSemanticColoringEnabled", "hasDocumentRangeSemanticTokensProvider", "visibleRanges", "range", "requestVersionId", "createCancelablePromise", "token", "getDocumentRangeSemanticTokens", "sw", "StopWatch", "r", "provider", "result", "styling", "toMultilineTokens2", "ISemanticTokensStylingService", "IThemeService", "IConfigurationService", "ILanguageFeatureDebounceService", "ILanguageFeaturesService", "registerEditorContribution", "ViewportSemanticTokensContribution", "init_arrays", "init_cancellation", "init_errors", "init_editorExtensions", "init_position", "init_range", "init_selection", "init_editorContextKeys", "init_strings", "init_range", "WordSelectionRangeProvider", "selectSubwords", "model", "positions", "result", "position", "bucket", "pos", "obj", "word", "startColumn", "offset", "start", "end", "lastCh", "ch", "isLowerAsciiLetter", "isUpperAsciiLetter", "Range", "init_nls", "init_actions", "init_commands", "init_languageFeatures", "init_resolverService", "init_types", "init_uri", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SmartSelectController_1", "SelectionRanges", "index", "ranges", "fwd", "res", "SmartSelectController", "editor", "_editor", "_languageFeaturesService", "_a", "forward", "selections", "model", "provideSelectionRanges", "s", "CancellationToken", "isNonEmptyArray", "equals", "b", "range", "state", "newSelections", "Selection", "ILanguageFeaturesService", "AbstractSmartSelect", "EditorAction", "forward", "opts", "_accessor", "editor", "controller", "SmartSelectController", "GrowSelectionAction", "localize", "EditorContextKeys", "MenuId", "CommandsRegistry", "ShrinkSelectionAction", "registerEditorContribution", "registerEditorAction", "provideSelectionRanges", "registry", "model", "positions", "options", "token", "providers", "WordSelectionRangeProvider", "BracketSelectionRangeProvider", "work", "allRawRanges", "provider", "allProviderRanges", "isNonEmptyArray", "i", "oneProviderRanges", "Range", "onUnexpectedExternalError", "oneRawRanges", "a", "b", "Position", "oneRanges", "last", "range", "oneRangesWithTrivia", "prev", "cur", "rangeNoWhitespace", "rangeFull", "accessor", "args", "resource", "assertType", "URI", "ILanguageFeaturesService", "reference", "ITextModelService", "CancellationToken", "init_editorExtensions", "init_editorExtensions", "init_nls", "init_nls", "Categories", "localize2", "init_actions", "init_configuration", "init_contextkey", "init_editorContextKeys", "init_lifecycle", "init_languageFeatures", "init_dom", "init_arrays", "init_lifecycle", "init_themables", "init_position", "init_stringBuilder", "StickyScrollWidgetState", "startLineNumbers", "endLineNumbers", "lastLineRelativePosition", "showEndForLine", "other", "equals", "_ttPolicy", "createTrustedTypesPolicy", "value", "STICKY_INDEX_ATTR", "STICKY_IS_LINE_ATTR", "STICKY_IS_LINE_NUMBER_ATTR", "STICKY_IS_FOLDING_ICON_ATTR", "StickyScrollWidget", "Disposable", "_editor", "DisposableStore", "EmbeddedCodeEditorWidget", "updateScrollLeftPosition", "e", "lineNumber", "stickyLine", "_state", "foldingModel", "_rebuildFromLine", "isWidgetHeightZero", "state", "rebuildFromLine", "futureWidgetHeight", "lineNumbers", "previousState", "indexOfLinesAlreadyRendered", "startLineNumber", "layoutInfo", "lineNumbersWidth", "clearFromLine", "i", "requireTransitions", "allVisible", "line", "foldingIcon", "linesToRender", "index", "widgetHeight", "l", "addDisposableListener", "EventType", "viewModel", "viewLineNumber", "Position", "lineRenderingData", "lineNumberOption", "actualInlineDecorations", "LineDecoration", "renderLineInput", "RenderLineInput", "sb", "StringBuilder", "renderOutput", "renderViewLine", "newLine", "lineHTMLNode", "lineNumberHTMLNode", "innerLineNumberHTML", "renderedLine", "RenderedStickyLine", "_a", "isLastLine", "lastLineZIndex", "intermediateLineZIndex", "lastLineTop", "intermediateLineTop", "showFoldingControls", "foldingRegions", "indexOfFoldingRegion", "isCollapsed", "StickyFoldingIcon", "spanDomNode", "renderedStickyLine", "column", "getColumnOfNodeOffset", "domNode", "_b", "lineIndex", "attribute", "lineDomNode", "lineNumberDomNode", "characterMapping", "scrollWidth", "foldingStartLine", "foldingEndLine", "dimension", "ThemeIcon", "foldingCollapsedIcon", "foldingExpandedIcon", "visible", "init_lifecycle", "init_languageFeatures", "init_cancellation", "init_async", "init_arrays", "init_event", "init_languageConfigurationRegistry", "init_lifecycle", "init_languageFeatures", "init_outlineModel", "init_async", "init_languageConfigurationRegistry", "init_errors", "StickyRange", "startLineNumber", "endLineNumber", "StickyElement", "range", "children", "parent", "StickyModel", "uri", "version", "element", "outlineProviderId", "init_iterator", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ModelProvider", "Status", "StickyModelProvider", "Disposable", "_editor", "_languageConfigurationService", "_languageFeaturesService", "defaultModel", "Delayer", "DisposableStore", "stickyModelFromCandidateOutlineProvider", "StickyModelFromCandidateOutlineProvider", "stickyModelFromSyntaxFoldingProvider", "StickyModelFromCandidateSyntaxFoldingProvider", "stickyModelFromIndentationFoldingProvider", "StickyModelFromCandidateIndentationFoldingProvider", "textModel", "textModelVersionId", "token", "modelProvider", "statusPromise", "modelPromise", "status", "error", "onUnexpectedError", "ILanguageConfigurationService", "ILanguageFeaturesService", "StickyModelCandidateProvider", "Status", "textModel", "modelVersionId", "token", "providerModelPromise", "createCancelablePromise", "providerModel", "err", "onUnexpectedError", "model", "StickyModelFromCandidateOutlineProvider", "_languageFeaturesService", "OutlineModel", "_a", "stickyOutlineElement", "providerID", "StickyModel", "outlineModel", "preferredProvider", "outlineElements", "Iterable", "OutlineGroup", "provider", "outlineGroupOfModel", "tempID", "maxTotalSumOfRanges", "optimalOutlineGroup", "_key", "outlineGroup", "totalSumRanges", "stickyChildren", "outlineElementsArray", "element1", "element2", "range1", "StickyRange", "range2", "outlineElement", "StickyElement", "previousStartLine", "children", "child", "subchild", "child1", "child2", "range", "outline", "res", "OutlineElement", "__decorate", "__param", "ILanguageFeaturesService", "StickyModelFromCandidateFoldingProvider", "editor", "RangesLimitReporter", "foldingElement", "foldingRegions", "length", "orderedStickyElements", "i", "parentIndex", "parentNode", "StickyModelFromCandidateIndentationFoldingProvider", "_languageConfigurationService", "IndentRangeProvider", "ILanguageConfigurationService", "StickyModelFromCandidateSyntaxFoldingProvider", "FoldingController", "selectedProviders", "SyntaxRangeProvider", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StickyLineCandidate", "startLineNumber", "endLineNumber", "nestingDepth", "StickyLineCandidateProvider", "Disposable", "editor", "_languageFeaturesService", "_languageConfigurationService", "Emitter", "DisposableStore", "RunOnceScheduler", "e", "StickyModelProvider", "_a", "CancellationTokenSource", "token", "textModel", "modelVersionId", "model", "index", "range", "outlineModel", "result", "depth", "lastStartLineNumber", "lastLine", "childrenStartLines", "child", "lowerBound", "binarySearch", "a", "b", "upperBound", "childStartLine", "childEndLine", "_b", "stickyLineCandidates", "hiddenRanges", "hiddenRange", "stickyLine", "ILanguageFeaturesService", "ILanguageConfigurationService", "init_instantiation", "init_actions", "init_contextkey", "init_editorContextKeys", "init_range", "init_position", "init_cancellation", "init_languageConfigurationRegistry", "init_languageFeatureDebounce", "init_dom", "init_mouseEvent", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StickyScrollController_1", "StickyScrollController", "Disposable", "_editor", "_contextMenuService", "_languageFeaturesService", "_instaService", "_languageConfigurationService", "_languageFeatureDebounceService", "_contextKeyService", "DisposableStore", "StickyScrollWidget", "StickyLineCandidateProvider", "StickyScrollWidgetState", "stickyScrollDomNode", "e", "addDisposableListener", "EventType", "event", "getWindow", "EditorContextKeys", "focusTracker", "trackFocus", "_", "editor", "_a", "direction", "lineNumbers", "position", "revealFunction", "Range", "sessionStore", "gesture", "ClickLinkGesture", "getMouseEventTarget", "mouseEvent", "mouseTargetElement", "stickyScrollWidgetDomNode", "addStandardDisposableListener", "lineIndex", "Position", "lineNumber", "currentEndForLineIndex", "_keyboardEvent", "mouseTarget", "range", "textElement", "cancellationToken", "CancellationTokenSource", "toDisposable", "currentHTMLChild", "getDefinitionsAtPosition", "candidateDefinitions", "childHTML", "goToDefinitionWithLocation", "targetWindow", "StandardMouseEvent", "MenuId", "line", "stickyLine", "foldingIcon", "toggleCollapseState", "scrollTop", "options", "stickyLineNumbers", "stickyLineNumber", "theoreticalLines", "rebuildFromLine", "_b", "model", "stickyLineVersion", "FoldingController", "focusedStickyElementLineNumber", "lineHeight", "maxNumberStickyLines", "lastLineRelativePosition", "startLineNumbers", "endLineNumbers", "arrayVisibleRanges", "fullVisibleRange", "StickyRange", "candidateRanges", "start", "end", "depth", "topOfElementAtDepth", "bottomOfElementAtDepth", "bottomOfBeginningLine", "topOfEndLine", "bottomOfEndLine", "IContextMenuService", "ILanguageFeaturesService", "IInstantiationService", "ILanguageConfigurationService", "ILanguageFeatureDebounceService", "IContextKeyService", "ToggleStickyScroll", "Action2", "localize2", "localize", "Categories", "ContextKeyExpr", "MenuId", "accessor", "configurationService", "IConfigurationService", "newValue", "weight", "FocusStickyScroll", "EditorAction2", "EditorContextKeys", "_accessor", "editor", "_a", "StickyScrollController", "SelectNextStickyScrollLine", "SelectPreviousStickyScrollLine", "GoToStickyScrollLine", "SelectEditor", "init_actions", "registerEditorContribution", "StickyScrollController", "registerAction2", "ToggleStickyScroll", "FocusStickyScroll", "SelectPreviousStickyScrollLine", "SelectNextStickyScrollLine", "GoToStickyScrollLine", "SelectEditor", "init_cancellation", "init_filters", "init_iterator", "init_lifecycle", "init_codeEditorService", "init_range", "init_languageFeatures", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "SuggestInlineCompletion", "range", "insertText", "filterText", "additionalTextEdits", "command", "completion", "InlineCompletionResults", "RefCountedDisposable", "model", "line", "word", "completionModel", "completions", "_suggestMemoryService", "_a", "result", "items", "selectedIndex", "first", "Iterable", "second", "resolveCount", "item", "FuzzyScore", "Range", "CancellationToken", "ISuggestMemoryService", "SuggestInlineCompletions", "Disposable", "_languageFeatureService", "_clipboardService", "_editorService", "position", "context", "token", "editor", "candidate", "config", "QuickSuggestionsOptions", "lineTokens", "tokenType", "wordInfo", "triggerCharacterInfo", "leadingLineContents", "newLineContext", "LineContext", "provideSuggestionItems", "CompletionOptions", "SuggestModel", "clipboardText", "CompletionModel", "WordDistance", "_completions", "ch", "providers", "provider", "ILanguageFeaturesService", "IClipboardService", "ICodeEditorService", "registerEditorFeature", "SuggestInlineCompletions", "init_stopwatch", "init_editorExtensions", "init_nls", "ForceRetokenizeAction", "EditorAction", "localize", "accessor", "editor", "model", "sw", "StopWatch", "registerEditorAction", "init_nls", "init_actions", "ToggleTabFocusModeAction", "Action2", "localize2", "newValue", "TabFocus", "alert", "localize", "registerAction2", "init_async", "init_codicons", "init_htmlContent", "init_lifecycle", "init_platform", "init_strings", "init_editorExtensions", "init_textModel", "init_editorWorker", "init_language", "init_dom", "init_actions", "init_lifecycle", "init_instantiation", "init_dom", "init_keyboardEvent", "init_event", "init_lifecycle", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "Link", "Disposable", "enabled", "container", "_link", "options", "openerService", "_a", "append", "$", "onClickEmitter", "DomEmitter", "onKeyPress", "onEnterPress", "Event", "e", "StandardKeyboardEvent", "onTap", "EventType", "Gesture", "onOpen", "EventHelper", "IOpenerService", "init_themables", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "BANNER_ELEMENT_HEIGHT", "BannerController", "Disposable", "_editor", "instantiationService", "Banner", "item", "_a", "IInstantiationService", "Banner", "Disposable", "instantiationService", "MarkdownRenderer", "$", "item", "message", "element", "clearNode", "ariaLabel", "iconContainer", "append", "ThemeIcon", "messageContainer", "action", "Link", "actionBarContainer", "ActionBar", "Action", "widgetClose", "__decorate", "__param", "IInstantiationService", "init_nls", "init_configuration", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "warningIcon", "registerIcon", "Codicon", "localize", "UnicodeHighlighter", "Disposable", "_editor", "_editorWorkerService", "_workspaceTrustService", "instantiationService", "state", "max", "data", "DisableHighlightingOfNonBasicAsciiCharactersAction", "DisableHighlightingOfAmbiguousCharactersAction", "DisableHighlightingOfInvisibleCharactersAction", "BannerController", "e", "options", "resolveOptions", "option", "highlightOptions", "locale", "language", "DocumentUnicodeHighlighter", "ViewportUnicodeHighlighter", "decoration", "IEditorWorkerService", "IWorkspaceTrustManagementService", "IInstantiationService", "resolveOptions", "trusted", "options", "inUntrustedWorkspace", "DocumentUnicodeHighlighter", "Disposable", "_editor", "_options", "_updateState", "_editorWorkerService", "RunOnceScheduler", "modelVersionId", "info", "decorations", "range", "Decorations", "decoration", "model", "isModelDecorationVisible", "text", "computeReason", "isModelDecorationInComment", "isModelDecorationInString", "__decorate", "__param", "IEditorWorkerService", "ViewportUnicodeHighlighter", "ranges", "totalResult", "result", "UnicodeTextModelHighlighter", "r", "configureUnicodeHighlightOptionsStr", "localize", "UnicodeHighlighterHoverParticipant", "_languageService", "_openerService", "anchor", "lineDecorations", "unicodeHighlighter", "UnicodeHighlighter", "existedReason", "index", "d", "highlightInfo", "codePoint", "codePointStr", "formatCodePointMarkdown", "reason", "isBasicASCII", "adjustSettingsArgs", "adjustSettings", "uri", "ShowExcludeOptions", "markdown", "MarkdownString", "MarkdownHover", "context", "hoverParts", "renderMarkdownHovers", "ILanguageService", "IOpenerService", "codePointToHex", "codePoint", "formatCodePointMarkdown", "value", "InvisibleCharacters", "renderCodePointAsInlineCode", "computeReason", "char", "options", "UnicodeTextModelHighlighter", "Decorations", "hideInComments", "hideInStrings", "key", "ModelDecorationOptions", "DisableHighlightingInCommentsAction", "EditorAction", "DisableHighlightingOfAmbiguousCharactersAction", "localize", "accessor", "editor", "args", "configurationService", "IConfigurationService", "unicodeHighlightConfigKeys", "DisableHighlightingInStringsAction", "DisableHighlightingOfInvisibleCharactersAction", "DisableHighlightingOfNonBasicAsciiCharactersAction", "ShowExcludeOptions", "reason", "inString", "inComment", "quickPickService", "IQuickInputService", "getExcludeCharFromBeingHighlightedLabel", "locale", "excludeLocaleFromBeingHighlighted", "excludeCharFromBeingHighlighted", "action", "expectNever", "result", "configureUnicodeHighlightOptionsStr", "charCodes", "existingValue", "charCode", "locales", "_a", "registerEditorAction", "registerEditorContribution", "UnicodeHighlighter", "HoverParticipantRegistry", "UnicodeHighlighterHoverParticipant", "init_lifecycle", "init_resources", "init_editorExtensions", "init_codeEditorService", "init_nls", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "ignoreUnusualLineTerminators", "writeIgnoreState", "codeEditorService", "model", "state", "readIgnoreState", "UnusualLineTerminatorsDetector", "Disposable", "_editor", "_dialogService", "_codeEditorService", "e", "result", "localize", "basename", "IDialogService", "ICodeEditorService", "registerEditorContribution", "UnusualLineTerminatorsDetector", "init_nls", "init_arrays", "init_async", "init_cancellation", "init_errors", "init_lifecycle", "init_editorExtensions", "init_codeEditorService", "init_range", "init_editorContextKeys", "init_languages", "init_model", "init_languageFeatures", "init_contextkey", "init_network", "init_map", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "WordHighlighter_1", "WordHighlighterContribution_1", "ctxHasWordHighlights", "RawContextKey", "getOccurrencesAtPosition", "registry", "model", "position", "token", "orderedByScore", "first", "provider", "onUnexpectedExternalError", "isNonEmptyArray", "result", "map", "ResourceMap", "getOccurrencesAcrossMultipleModels", "wordSeparators", "otherModels", "filteredModels", "otherModel", "shouldSynchronizeModel", "score", "t", "OccurenceAtPositionRequest", "_model", "_selection", "_wordSeparators", "createCancelablePromise", "selection", "word", "Range", "decorations", "lineNumber", "startColumn", "endColumn", "currentWordRange", "requestIsValid", "len", "range", "SemanticOccurenceAtPositionRequest", "providers", "value", "MultiModelOccurenceRequest", "TextualOccurenceRequest", "timeout", "wordResult", "allModels", "highlights", "m", "DocumentHighlightKind", "currentSelectionIsEmpty", "computeOccurencesAtPosition", "computeOccurencesMultiModel", "registerModelAndPositionCommand", "accessor", "languageFeaturesService", "ILanguageFeaturesService", "CancellationToken", "WordHighlighter", "editor", "multiProviders", "contextKeyService", "codeEditorService", "DisposableStore", "e", "newValue", "newIndex", "dest", "lineContent", "alert", "currentDecorationIDs", "currentEditors", "deleteURI", "editorHighlighterContrib", "WordHighlighterContribution", "uri", "_a", "_b", "_c", "_d", "Schemas", "editorSelection", "currentModels", "tempModel", "isDiffEditor", "diffModel", "workerRequestIsValid", "myRequestId", "otherModelsToHighlight", "data", "onUnexpectedError", "currentTime", "minimumRenderTime", "newDecorations", "oldDecorationIDs", "newDocumentHighlights", "highlight", "getHighlightDecorationOptions", "newDecorationIDs", "changeAccessor", "ICodeEditorService", "Disposable", "createWordHighlighterIfPossible", "state", "IContextKeyService", "WordHighlightNavigationAction", "EditorAction", "next", "opts", "accessor", "editor", "controller", "WordHighlighterContribution", "NextWordHighlightAction", "localize", "ctxHasWordHighlights", "EditorContextKeys", "PrevWordHighlightAction", "TriggerWordHighlightAction", "args", "registerEditorContribution", "registerEditorAction", "init_editorExtensions", "init_wordCharacterClassifier", "init_position", "init_range", "init_selection", "init_editorContextKeys", "init_languageConfigurationRegistry", "init_nls", "init_contextkey", "MoveWordCommand", "EditorCommand", "opts", "accessor", "editor", "args", "wordSeparators", "getMapForWordSeparators", "model", "result", "sel", "inPosition", "Position", "outPosition", "r", "CursorState", "pos", "from", "to", "inSelectionMode", "Selection", "WordLeftCommand", "position", "wordNavigationType", "WordOperations", "WordRightCommand", "CursorWordStartLeft", "CursorWordEndLeft", "CursorWordLeft", "_a", "ContextKeyExpr", "EditorContextKeys", "CONTEXT_ACCESSIBILITY_MODE_ENABLED", "IsWindowsContext", "CursorWordStartLeftSelect", "CursorWordEndLeftSelect", "CursorWordLeftSelect", "CursorWordAccessibilityLeft", "_", "EditorOptions", "CursorWordAccessibilityLeftSelect", "CursorWordStartRight", "CursorWordEndRight", "CursorWordRight", "CursorWordStartRightSelect", "CursorWordEndRightSelect", "CursorWordRightSelect", "CursorWordAccessibilityRight", "CursorWordAccessibilityRightSelect", "DeleteWordCommand", "languageConfigurationService", "ILanguageConfigurationService", "selections", "autoClosingBrackets", "autoClosingQuotes", "autoClosingPairs", "viewModel", "commands", "deleteRange", "ReplaceCommand", "DeleteWordLeftCommand", "ctx", "Range", "DeleteWordRightCommand", "lineCount", "maxColumn", "DeleteWordStartLeft", "DeleteWordEndLeft", "DeleteWordLeft", "DeleteWordStartRight", "DeleteWordEndRight", "DeleteWordRight", "DeleteInsideWord", "EditorAction", "localize", "registerEditorCommand", "registerEditorAction", "init_editorExtensions", "init_range", "init_editorContextKeys", "init_commands", "DeleteWordPartLeft", "DeleteWordCommand", "EditorContextKeys", "ctx", "wordNavigationType", "r", "WordPartOperations", "Range", "DeleteWordPartRight", "lineCount", "maxColumn", "WordPartLeftCommand", "MoveWordCommand", "wordSeparators", "model", "position", "CursorWordPartLeft", "CommandsRegistry", "CursorWordPartLeftSelect", "WordPartRightCommand", "CursorWordPartRight", "CursorWordPartRightSelect", "registerEditorCommand", "init_htmlContent", "init_lifecycle", "init_editorExtensions", "init_nls", "ReadOnlyMessageController", "Disposable", "editor", "messageController", "MessageController", "message", "MarkdownString", "localize", "registerEditorContribution", "import_contribution", "init_standaloneStrings", "init_dom", "init_lifecycle", "init_editorExtensions", "init_platform", "IPadShowKeyboard", "Disposable", "editor", "isIOS", "shouldHaveWidget", "ShowKeyboardWidget", "addDisposableListener", "e", "registerEditorContribution", "import_inspectTokens", "init_platform", "init_standaloneStrings", "init_nls", "init_platform", "init_lifecycle", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "HelpQuickAccessProvider_1", "HelpQuickAccessProvider", "quickInputService", "keybindingService", "Registry", "Extensions", "picker", "disposables", "DisposableStore", "item", "value", "providerDescriptor", "p", "providerA", "providerB", "provider", "helpEntry", "prefix", "label", "localize", "IQuickInputService", "IKeybindingService", "Registry", "Extensions", "HelpQuickAccessProvider", "QuickHelpNLS", "init_lifecycle", "init_functional", "init_lifecycle", "init_model", "init_editorColorRegistry", "init_themeService", "AbstractEditorNavigationQuickAccessProvider", "options", "picker", "token", "_a", "disposables", "DisposableStore", "pickerDisposable", "MutableDisposable", "editor", "context", "codeEditor", "getCodeEditor", "lastKnownEditorViewState", "createSingleCallFunction", "toDisposable", "model", "status", "isDiffEditor", "range", "changeAccessor", "deleteDecorations", "newDecorations", "themeColorFromId", "overviewRulerRangeHighlight", "OverviewRulerLane", "rangeHighlightId", "overviewRulerDecorationId", "rangeHighlightDecorationId", "init_nls", "AbstractGotoLineQuickAccessProvider", "AbstractEditorNavigationQuickAccessProvider", "picker", "label", "localize", "Disposable", "context", "token", "editor", "disposables", "DisposableStore", "event", "item", "updatePickerAndEditor", "position", "range", "codeEditor", "getCodeEditor", "toDisposable", "lineNumber", "column", "value", "numbers", "part", "endLine", "lineCount", "model", "positionCandidate", "_a", "_b", "init_platform", "init_codeEditorService", "init_standaloneStrings", "init_event", "init_editorExtensions", "init_editorContextKeys", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StandaloneGotoLineQuickAccessProvider", "AbstractGotoLineQuickAccessProvider", "editorService", "Event", "_a", "ICodeEditorService", "GotoLineAction", "EditorAction", "GoToLineNLS", "EditorContextKeys", "accessor", "IQuickInputService", "StandaloneGotoLineQuickAccessProvider", "registerEditorAction", "Registry", "Extensions", "init_async", "init_cancellation", "init_codicons", "init_themables", "init_filters", "init_path", "init_platform", "init_strings", "NO_SCORE2", "scoreFuzzy2", "target", "query", "patternStart", "wordStart", "preparedQuery", "doScoreFuzzy2Multiple", "doScoreFuzzy2Single", "totalScore", "totalMatches", "queryPiece", "score", "matches", "normalizeMatches", "fuzzyScore", "createMatches", "NO_ITEM_SCORE", "sortedMatches", "matchA", "matchB", "normalizedMatches", "currentMatch", "match", "matchOverlaps", "queryExpectsExactMatch", "MULTIPLE_QUERY_VALUES_SEPARATOR", "prepareQuery", "original", "originalLowercase", "pathNormalized", "normalized", "normalizedLowercase", "normalizeQuery", "containsPathSeparator", "sep", "expectExactMatch", "values", "originalSplit", "originalPiece", "expectExactMatchPiece", "pathNormalizedPiece", "normalizedPiece", "normalizedLowercasePiece", "isWindows", "stripWildcards", "pieceToQuery", "arg1", "piece", "init_lifecycle", "init_strings", "init_range", "init_languages", "init_outlineModel", "init_nls", "init_languageFeatures", "init_arraysFind", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "AbstractGotoSymbolQuickAccessProvider_1", "AbstractGotoSymbolQuickAccessProvider", "AbstractEditorNavigationQuickAccessProvider", "_languageFeaturesService", "_outlineModelService", "options", "picker", "localize", "Disposable", "context", "token", "editor", "model", "disposables", "DisposableStore", "label", "symbolProviderRegistryPromise", "DeferredPromise", "symbolProviderListener", "toDisposable", "_a", "event", "item", "symbolsPromise", "picksCts", "updatePickerItems", "positionToEnclose", "CancellationTokenSource", "query", "prepareQuery", "items", "candidate", "findLast", "Range", "_b", "symbols", "filterBySymbolKind", "filterPos", "symbolQuery", "containerQuery", "pieceToQuery", "buttons", "openSideBySideDirection", "ThemeIcon", "Codicon", "filteredSymbolPicks", "index", "symbol", "symbolLabel", "trim", "symbolLabelWithIcon", "SymbolKinds", "symbolLabelIconOffset", "containerLabel", "symbolScore", "symbolMatches", "containerScore", "containerMatches", "skipContainerQuery", "scoreFuzzy2", "deprecated", "getAriaLabelForSymbol", "sortedFilteredSymbolPicks", "symbolA", "symbolB", "symbolPicks", "updateLastSeparatorLabel", "lastSeparator", "lastSymbolKind", "lastSymbolKindCounter", "format", "NLS_SYMBOL_KIND_CACHE", "FALLBACK_NLS_SYMBOL_KIND", "symbolPick", "kindA", "kindB", "result", "document", "ILanguageFeaturesService", "IOutlineModelService", "FALLBACK_NLS_SYMBOL_KIND", "localize", "NLS_SYMBOL_KIND_CACHE", "init_platform", "init_codeEditorService", "init_standaloneStrings", "init_event", "init_editorExtensions", "init_editorContextKeys", "init_outlineModel", "init_languageFeatures", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StandaloneGotoSymbolQuickAccessProvider", "AbstractGotoSymbolQuickAccessProvider", "editorService", "languageFeaturesService", "outlineModelService", "Event", "_a", "ICodeEditorService", "ILanguageFeaturesService", "IOutlineModelService", "GotoSymbolAction", "EditorAction", "QuickOutlineNLS", "EditorContextKeys", "accessor", "IQuickInputService", "AbstractGotoSymbolQuickAccessProvider", "ItemActivation", "registerEditorAction", "Registry", "Extensions", "StandaloneGotoSymbolQuickAccessProvider", "init_platform", "init_standaloneStrings", "init_codeEditorService", "init_iconLabels", "init_arrays", "init_types", "init_nls", "exceptionToErrorMessage", "exception", "verbose", "localize", "detectSystemErrorMessage", "stackToString", "stack", "toErrorMessage", "error", "errors", "coalesce", "msg", "isString", "detail", "init_errors", "init_filters", "init_functional", "init_lifecycle", "init_map", "countMapFrom", "values", "_a", "map", "value", "TfIdfCalculator", "query", "token", "embedding", "idfCache", "scores", "key", "doc", "chunk", "score", "input", "normalize", "word", "camelParts", "part", "documents", "chunks", "text", "tf", "term", "currentOccurrences", "newOccurrences", "queryEmbedding", "sum", "termTfidf", "chunkTf", "chunkIdf", "chunkTfidf", "chunkOccurrences", "termFrequencies", "occurrences", "idf", "normalizeTfIdfScores", "_b", "result", "a", "b", "max", "init_nls", "init_commands", "init_configuration", "init_instantiation", "init_async", "init_cancellation", "init_lifecycle", "init_types", "TriggerAction", "isPicksWithActive", "obj", "candidate", "isFastAndSlowPicks", "PickerQuickAccessProvider", "Disposable", "prefix", "options", "picker", "token", "runOptions", "_a", "disposables", "DisposableStore", "picksCts", "picksDisposable", "MutableDisposable", "updatePickerItems", "picksDisposables", "CancellationTokenSource", "picksToken", "picksFilter", "providedPicks", "applyPicks", "picks", "skipEmpty", "items", "activeItem", "isFunction", "applyFastAndSlowPicks", "fastAndSlowPicks", "fastPicksApplied", "slowPicksApplied", "timeout", "awaitedAdditionalPicks", "activePick", "additionalPicks", "additionalActivePick", "fallbackActivePick", "fallbackActivePickCandidate", "awaitedPicks", "event", "item", "button", "_b", "buttonIndex", "result", "action", "index", "removed", "activeItems", "keepScrollPositionBefore", "init_telemetry", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "AbstractCommandsQuickAccessProvider_1", "CommandsHistory_1", "AbstractCommandsQuickAccessProvider", "PickerQuickAccessProvider", "options", "instantiationService", "keybindingService", "commandService", "telemetryService", "dialogService", "CommandsHistory", "filter", "_disposables", "token", "runOptions", "_a", "_b", "_c", "_d", "allCommandPicks", "runTfidf", "createSingleCallFunction", "tfidf", "TfIdfCalculator", "commandPick", "result", "normalizeTfIdfScores", "score", "filteredCommandPicks", "labelHighlights", "aliasHighlights", "tfidfScore", "mapLabelToCommand", "existingCommandForLabel", "commandPickA", "commandPickB", "commandACounter", "commandBCounter", "commandASuggestion", "commandBSuggestion", "commandPicks", "addOtherSeparator", "addSuggestedSeparator", "addCommonlyUsedSeparator", "localize", "additionalCommandPicks", "keybinding", "ariaLabel", "error", "isCancellationError", "toErrorMessage", "label", "commandAlias", "commandDescription", "chunk", "or", "matchesPrefix", "matchesWords", "matchesContiguousSubString", "IInstantiationService", "IKeybindingService", "ICommandService", "ITelemetryService", "IDialogService", "CommandsHistory", "CommandsHistory_1", "Disposable", "storageService", "configurationService", "WillSaveStateReason", "raw", "serializedCache", "cache", "LRUCache", "entries", "a", "b", "entry", "commandId", "_a", "value", "key", "_b", "configuredCommandHistoryLength", "__decorate", "__param", "IStorageService", "IConfigurationService", "AbstractEditorCommandsQuickAccessProvider", "AbstractCommandsQuickAccessProvider", "options", "instantiationService", "keybindingService", "commandService", "telemetryService", "dialogService", "activeTextEditorControl", "editorCommandPicks", "editorAction", "stripIcons", "init_instantiation", "init_commands", "init_telemetry", "init_editorExtensions", "init_editorContextKeys", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StandaloneCommandsQuickAccessProvider", "AbstractEditorCommandsQuickAccessProvider", "_a", "instantiationService", "codeEditorService", "keybindingService", "commandService", "telemetryService", "dialogService", "IInstantiationService", "ICodeEditorService", "IKeybindingService", "ICommandService", "ITelemetryService", "IDialogService", "GotoLineAction", "EditorAction", "QuickCommandNLS", "EditorContextKeys", "accessor", "IQuickInputService", "StandaloneCommandsQuickAccessProvider", "registerEditorAction", "Registry", "Extensions", "init_editorExtensions", "init_codeEditorService", "init_configuration", "init_contextkey", "init_instantiation", "__decorate", "decorators", "target", "key", "desc", "c", "d", "i", "__param", "paramIndex", "decorator", "StandaloneReferencesController", "ReferencesController", "editor", "contextKeyService", "editorService", "notificationService", "instantiationService", "storageService", "configurationService", "IContextKeyService", "ICodeEditorService", "INotificationService", "IInstantiationService", "IStorageService", "IConfigurationService", "registerEditorContribution", "ReferencesController", "StandaloneReferencesController", "init_editorExtensions", "init_standaloneTheme", "init_standaloneStrings", "init_theme", "ToggleHighContrast", "EditorAction", "ToggleHighContrastNLS", "accessor", "editor", "standaloneThemeService", "IStandaloneThemeService", "currentTheme", "isHighContrast", "isDark", "VS_DARK_THEME_NAME", "VS_LIGHT_THEME_NAME", "HC_BLACK_THEME_NAME", "HC_LIGHT_THEME_NAME", "registerEditorAction", "monacoEditor", "getMonaco", "setMonaco", "monaco", "toMarkerSeverity", "severity", "MarkerSeverity", "getMonaco", "toMarkerTag", "tag", "fromRange", "range", "toRange", "toRelatedInformation", "relatedInformation", "Uri", "getMonaco", "toRange", "toMarkerData", "diagnostic", "options", "_a", "MarkerSeverity", "Uri", "getMonaco", "markerData", "toRange", "toMarkerSeverity", "toRelatedInformation", "toMarkerTag", "fromCommand", "command", "result", "toCommand", "toColor", "color", "toColorInformation", "colorInformation", "toRange", "toColor", "fromCompletionTriggerKind", "kind", "CompletionTriggerKind", "getMonaco", "fromCompletionContext", "completionContext", "result", "fromCompletionTriggerKind", "fromCompletionItemKind", "kind", "CompletionItemKind", "getMonaco", "toCompletionItemKind", "fromCompletionItemTag", "tag", "toCompletionItemTag", "fromMarkdownString", "markdownString", "toMarkdownString", "markupContent", "fromSingleEditOperation", "singleEditOperation", "_a", "fromRange", "toSingleEditOperation", "textEdit", "toRange", "fromCompletionItemRange", "edit", "newText", "fromRange", "fromCompletionItem", "completionItem", "CompletionItemInsertTextRule", "getMonaco", "result", "fromCompletionItemKind", "fromSingleEditOperation", "fromCommand", "fromMarkdownString", "fromCompletionItemTag", "toCompletionItemRange", "toRange", "toCompletionItem", "options", "_a", "_b", "_c", "_d", "_e", "CompletionItemKind", "itemDefaults", "textEdit", "commitCharacters", "insertTextFormat", "insertTextMode", "text", "range", "toCompletionItemKind", "toSingleEditOperation", "toCommand", "toMarkdownString", "toCompletionItemTag", "toCompletionList", "completionList", "options", "item", "toCompletionItem", "getDeprecatedMarkupValue", "value", "toHoverContents", "contents", "toMarkdownString", "toHover", "hover", "result", "toRange", "fromPosition", "position", "registerMarkerDataProvider", "monaco", "languageSelector", "provider", "listeners", "matchesLanguage", "model", "languageId", "doValidate", "markers", "onModelAdd", "handle", "onModelRemoved", "uriStr", "listener", "disposables", "event", "uri", "createWorkerManager", "monaco", "options", "createData", "interval", "label", "moduleId", "stopWhenIdleFor", "worker", "lastUsedTime", "disposed", "stopWorker", "intervalId", "resources", "newCreateData", "bound01", "n", "max", "isOnePointZero", "isPercent", "isPercentage", "clamp01", "val", "boundAlpha", "a", "convertToPercentage", "pad2", "c", "rgbToRgb", "r", "g", "b", "bound01", "rgbToHsl", "max", "min", "h", "l", "d", "hue2rgb", "p", "q", "hslToRgb", "s", "rgbToHsv", "v", "hsvToRgb", "f", "t", "mod", "rgbToHex", "allow3Char", "hex", "pad2", "rgbaToHex", "a", "allow4Char", "convertDecimalToHex", "convertDecimalToHex", "d", "convertHexToDecimal", "h", "parseIntFromHex", "val", "numberInputToObject", "color", "names", "inputToRGB", "color", "rgb", "a", "s", "v", "l", "ok", "format", "stringInputToObject", "isValidCSSUnit", "rgbToRgb", "convertToPercentage", "hsvToRgb", "hslToRgb", "boundAlpha", "CSS_INTEGER", "CSS_NUMBER", "CSS_UNIT", "PERMISSIVE_MATCH3", "PERMISSIVE_MATCH4", "matchers", "named", "names", "match", "parseIntFromHex", "convertHexToDecimal", "TinyColor", "color", "opts", "_a", "numberInputToObject", "rgb", "inputToRGB", "R", "G", "B", "RsRGB", "GsRGB", "BsRGB", "alpha", "boundAlpha", "s", "hsv", "rgbToHsv", "h", "v", "hsl", "rgbToHsl", "l", "allow3Char", "rgbToHex", "allow4Char", "rgbaToHex", "allowShortChar", "r", "g", "b", "fmt", "x", "bound01", "rnd", "hex", "_i", "names", "_b", "key", "value", "format", "formatSet", "formattedString", "hasAlpha", "needsAlphaFormat", "amount", "clamp01", "hue", "rgb1", "rgb2", "p", "rgba", "results", "slices", "part", "ret", "res", "modification", "background", "fg", "bg", "n", "result", "increment", "i", "fromRatio", "ratio", "opts", "newColor", "convertToPercentage", "TinyColor", "colorNames", "names", "editableColorRegex", "stylesheet", "colorValueToHex", "value", "createColorClass", "color", "hex", "className", "selector", "rule", "createColorProvider", "monaco", "getWorker", "modelMap", "model", "worker", "editableColors", "nonEditableColors", "colors", "lsColor", "monacoColor", "toColorInformation", "text", "range", "colorInformation", "match", "currentColor", "isNamedColor", "fromRatio", "hexValue", "rgbValue", "hslValue", "prefix", "createHoverProvider", "position", "hover", "fromPosition", "toHover", "createCompletionItemProvider", "context", "completionList", "fromCompletionContext", "wordInfo", "toCompletionList", "item", "result", "fromCompletionItem", "toCompletionItem", "createMarkerDataProvider", "diagnostic", "toMarkerData", "createTailwindDirective", "name", "tailwindDirective", "layerDirective", "applyDirective", "configDirective", "defaultLanguageSelector", "configureMonacoTailwindcss", "monaco", "languageSelector", "tailwindConfig", "setMonaco", "workerManager", "createWorkerManager", "disposables", "createColorProvider", "createCompletionItemProvider", "createHoverProvider", "language", "registerMarkerDataProvider", "createMarkerDataProvider", "disposable", "newTailwindConfig", "css", "contents", "content", "isNumber$1", "code", "isAlpha$1", "from", "to", "isAlphaNumericWord", "isAlphaWord", "isUmlaut", "isWhiteSpace$3", "isSpace", "isQuote$2", "Scanner", "str", "start", "end", "match", "ch", "ok", "n", "message", "pos", "ScannerError", "tokenScanner$1", "tokens", "peek$3", "scanner", "next", "slice", "readable$1", "consume$2", "test", "token", "error$1", "err", "abbreviation", "abbr", "options", "result", "statements", "ctx", "node", "stack", "element$2", "group", "isChildOperator", "isSiblingOperator$1", "isClimbOperator", "isGroupStart", "isBracket$2", "repeater$1", "attr", "elem", "elementName", "isEmpty", "isRepeater", "text", "getText", "shortAttribute", "attributeSet", "isCloseOperator", "isAttributeSetStart", "attributes", "attribute", "isAttributeSetEnd", "isWhiteSpace$2", "type", "isOperator$1", "count", "createLiteral$1", "literal$1$1", "quoted", "name", "value", "isEquals", "quote", "isQuote$1", "allowBrackets", "brackets", "isCapitalizedLiteral", "isClassNameOperator", "isElementName$1", "isTextStart", "context", "isOpen", "isSingle", "isLiteral$2", "Chars$3", "Chars", "escaped", "tokenize$1", "source", "getToken$1", "field$2", "repeaterPlaceholder", "repeaterNumber", "repeater", "whiteSpace$1", "literal$2", "operator$1", "bracket$1", "expressionStart", "prev", "isAllowedOperator", "isElementName", "isAllowedSpace", "isAllowedRepeater", "bracketType", "isOpenBracket$2", "op", "operatorType$1", "implicit", "size", "reverse", "base", "parent", "index", "consumePlaceholder$2", "stream", "operators", "tokenVisitor", "state", "lastIx", "parentIx", "parentRepeater", "stringify$1", "urlRegex", "emailRegex", "convert", "textInserted", "cleanText", "s", "convertGroup", "_a", "varValue", "deepest", "deepestNode", "last$1", "insertText", "insertHref", "convertStatement", "original", "repeat", "items", "i", "isGroup", "convertElement", "target", "children", "stringifyName", "stringifyValue$1", "child", "convertAttribute", "isField$1", "attachRepeater", "implied", "isBoolean", "valueType", "arr", "href", "hrefAttribute", "item", "parseAbbreviation", "OperatorType", "Chars$2", "tokenize", "isValue", "getToken", "mergeTokens", "shouldConsumeDashAfter", "operator", "short", "field$1", "customProperty", "numberValue", "colorValue", "stringValue", "bracket", "whiteSpace", "literal$1", "consumePlaceholder$1", "isIdentPrefix", "isKeyword", "isLiteral$1", "createLiteral", "consumeNumber", "rawValue", "finished", "valueStart", "color", "alpha", "isHex", "colorAlpha", "g", "b", "a", "parseColor", "isBracket$1", "operatorType", "afterNegative", "hasDecimal", "prevPos", "hasFloat", "r", "last", "tokenScanner", "peek$2", "readable", "consume$1", "error", "parser", "property", "consumeProperty", "isSiblingOperator", "important", "valueFragment", "valueMode", "isLiteral", "isFunctionStart", "isValueDelimiter", "isWhiteSpace$1", "isImportant", "consumeValue", "isFragmentDelimiter", "inArgument", "args", "consumeArguments", "isOpenBracket$1", "isCloseBracket$1", "isArgumentDelimiter", "isBracket", "open", "isOperator", "t1", "t2", "parse$2", "mergeAttributes", "config", "lookup", "attrName", "mergeValue", "mergeDeclarations", "glue", "append", "t", "dest", "src", "walk$1", "fn", "ancestors", "callback", "findDeepest", "isNode", "resolveSnippets", "reversed", "resolve", "snippet", "snippetAbbr", "walkResolve", "topNode", "mergeNodes", "resolved", "expressionEnd", "createOutputStream", "level", "push", "processText", "_push", "pushString", "lines", "splitByLines$1", "il", "pushNewline", "indent", "baseIndent", "newline", "pushIndent", "pushField", "placeholder", "field", "tagName", "strCase", "attrQuote", "isBooleanAttribute", "selfClose", "isInline", "elementMap", "implicitTag", "resolveImplicitTag", "getParentElement", "contextName", "parentName", "lowercase", "latin", "ru", "sp", "vocabularies", "reLorem", "lorem", "m", "db", "minWordCount", "maxWordCount", "wordCount", "rand", "findRepeater", "paragraph", "sample", "len", "iterations", "choice", "val", "sentence", "words", "capitalize", "word", "insertCommas", "hasComma", "totalCommas", "dict", "startWithCommon", "totalWords", "element", "xsl", "matchesName", "isAllowed", "reElement", "reModifier", "blockCandidates1", "className", "blockCandidates2", "bem", "expandClassNames", "expandShortNotation", "data", "getBEMData", "classNames", "cl", "ix", "uniqueClass", "findBlockName", "updateClass", "path", "prefix", "originalClass", "getBlockName", "arrClassNames", "classValue", "stringifyValue", "parseBEM", "getBEMDataFromContext", "depth", "find", "filter", "walk", "visitor", "current", "createWalkState", "caret", "isSnippet", "isInlineElement", "isField", "pushTokens", "out", "largestIndex", "splitByLines", "line", "shouldOutputAttribute", "TemplateChars", "template", "offset", "consumePlaceholder", "peek$1", "namePos", "afterPos", "isTokenStart", "isToken", "createCommentState", "commentNodeBefore", "shouldComment", "output", "commentNodeAfter", "comment", "attrs", "htmlTagRegex", "reservedKeywords", "html", "element$1", "format", "shouldFormat$1", "getIndent", "pushAttribute", "pushSnippet", "innerFormat", "hasNewline", "startsWithBlockTag", "valuePrefix", "lQuote", "rQuote", "getMultiValue", "isPropKey", "fieldIx", "adjacentInline", "before", "after", "matches", "key", "multiple", "indentFormat", "primary", "secondary", "collectAttributes", "shouldFormat", "pushPrimaryAttributes", "pushSecondaryAttributes", "pushValue", "isPrimaryAttribute", "lineLengths", "maxLength", "valueLength", "haml", "slim", "pug", "formatters", "parse$1", "oldTextValue", "parseOpt", "transform", "stringify", "CSSSnippetType", "reProperty", "opt", "createSnippet", "keywords", "parsed", "parseValue", "cssVal", "collectKeywords", "nest", "snippets", "snippetsSort", "cur", "isProperty", "v", "scoreMatch", "str1", "str2", "partialMatch", "str1Len", "str2Len", "minLength", "j", "score", "ch1", "ch2", "found", "acronym", "matchRatio", "delta", "maxScore", "sum", "shortHex", "asHex", "asRGB", "isShortHex", "toShortHex", "toHex", "values", "frac", "num", "digits", "hex", "pad", "CSSAbbreviationScope", "css", "isJSON", "toCamelCase", "propertyValue", "outputImportant", "outputToken", "getSingleNumeric", "getQuote", "outputValue", "separator", "prevEnd", "_", "letter", "gradientName", "parse", "convertSnippets", "isValueScope", "filteredSnippets", "getSnippetsForScope", "resolveNode", "resolveGradient", "propName", "resolveValueKeywords", "findBestMatch", "resolveAsProperty", "resolveAsSnippet", "resolveNumericValue", "gradientFn", "cssValue", "inlineValue", "getUnmatchedPart", "kw", "resolveKeyword", "defaultValue", "hasField", "wrapWithField", "minScore", "reField", "inputValue", "literal", "tail", "matchedItem", "getScoringPart", "lastPos", "ref", "dep", "aliases", "unitless", "q", "markupSnippets", "stylesheetSnippets", "xslSnippets", "pugSnippets", "variables", "defaultSyntaxes", "defaultOptions$1", "defaultConfig", "syntaxConfig", "parseSnippets", "k", "resolveConfig", "globals", "syntax", "mergedData", "typeDefaults", "typeOverride", "syntaxDefaults", "syntaxOverride", "backwardScanner", "sol", "peek", "previous", "consume", "consumeWhile", "Chars$1", "isQuote", "c", "consumeQuoted", "Brackets", "bracePairs", "isHtml", "isWhiteSpace", "consumeIdent", "consumeAttributeWithUnquotedValue", "consumeAttribute", "consumeAttributeWithQuotedValue", "isCloseBracket", "isOpenBracket", "isUnquotedValue", "isIdent", "isAlpha", "isNumber", "specialChars", "defaultOptions", "extractAbbreviation$1", "offsetPastAutoClosed", "getStartOffset", "isCloseBrace", "isOpenBrace", "isAbbreviation", "compiledPrefix", "consumePair", "consumeArray", "close", "consumed", "expandAbbreviation$1", "resolvedConfig", "stylesheet", "markup", "cssData", "htmlData", "snippetKeyCache", "markupSnippetKeys", "stylesheetCustomSnippetsKeyCache", "htmlAbbreviationStartRegex", "jsxAbbreviationStartRegex", "cssAbbreviationRegex", "htmlAbbreviationRegex", "commonlyUsedTags", "bemFilterSuffix", "filterDelimitor", "trimFilterSuffix", "commentFilterSuffix", "maxFilters", "doComplete", "monaco", "model", "position", "emmetConfig", "isStyleSheetRes", "isStyleSheet", "registry", "getDefaultSnippets", "customSnippetsRegistry", "extractOptions", "getSyntaxType", "extractedValue", "extractAbbreviation", "abbreviationRange", "currentLineTillPosition", "getCurrentWord", "expandOptions", "getExpandOptions", "expandedText", "expandedAbbr", "completionItems", "isAbbreviationValid", "isExpandedTextNoise", "replaceTabStopsWithCursors", "escapeNonTabStopDollar", "addFinalTabStop", "x", "removeTabStops", "stylesheetCustomSnippetsKeys", "makeSnippetSuggestion", "abbrRegex", "tagToFindMoreSuggestionsFor", "newTagMatches", "commonlyUsedTagSuggestions", "abbreviationSuggestions", "snippetKeys", "snippetDetail", "skipFullMatch", "snippetCompletions", "snippetKey", "currentAbbr", "expandedWord", "maxTabStop", "maxTabStopRanges", "foundLastStop", "replaceWithLastStop", "numberStart", "numberEnd", "currentTabStop", "foundPlaceholder", "rangeStart", "rangeEnd", "emmetSnippetField", "getDefaultSyntax", "emptyUserConfig", "getFilters", "currentLine", "lengthOccupiedByFilter", "_b", "between", "endPrefixIndex", "tag", "dotMatches", "filters", "bemEnabled", "commentEnabled", "combinedOptions", "baseSyntax", "isValidEmmetToken", "tokens", "index", "syntax", "language", "currentTokenType", "tokenEnvCache", "getTokenizationEnv", "model", "_tokenization", "_tokenizationStateStore", "_t", "val", "_tokenizationSupport", "env", "isValidLocationForEmmetAbbreviation", "position", "_a", "column", "lineNumber", "_stateStore", "_support", "state", "valid", "i", "LANGUAGE_MODES", "MAPPED_MODES", "DEFAULT_CONFIG", "registerProvider", "monaco", "languages", "providers", "doComplete", "provider", "emmetHTML", "emmetCSS", "registerDocumentationForFusionObjects", "monaco", "fusionObjects", "languageId", "fusionObjectsWithDoc", "documentation", "name", "regex", "model", "position", "currentLine", "currentCursor", "line", "matches", "match", "matchedTag", "startPosition", "endPosition", "isValidEmmetToken", "tokens", "index", "syntax", "language", "currentTokenType", "tokenEnvCache", "getTokenizationEnv", "model", "_tokenization", "_tokenizationStateStore", "_t", "val", "_tokenizationSupport", "env", "isValidLocationForEmmetAbbreviation", "position", "column", "lineNumber", "_stateStore", "_support", "state", "valid", "i", "registerCompletionForFusionObjects", "monaco", "fusionObjects", "languageId", "fusionObjectsWithSnippet", "snippet", "model", "position", "word", "range", "isValidLocationForEmmetAbbreviation", "label", "documentation", "initializeMonacoFromConfig", "packageConfig", "_workerId", "label", "languages", "afxMappedLanguageId", "language", "conf", "fusionObjectsConfig", "registerDocumentationForFusionObjects", "editor_main_exports", "registerCompletionForFusionObjects", "monacoTailwindCss", "configureMonacoTailwindcss", "emmetHTML", "emmetCSS"]
}
